function __cons(t,a){return eval("new t("+a.map(function(e,t){return"a["+t+"]"}).join(",")+")")}var Laya=window.Laya=function(e,t){var i={__internals:[],__packages:{},__classmap:{Object:Object,Function:Function,Array:Array,String:String},__sysClass:{object:"Object",array:"Array",string:"String",dictionary:"Dictionary"},__propun:{writable:!0,enumerable:!1,configurable:!0},__presubstr:String.prototype.substr,__substr:function(e,t){return 1==arguments.length?i.__presubstr.call(this,e):i.__presubstr.call(this,e,t>0?t:this.length+t)},__init:function(e){e.forEach(function(e){e.__init$&&e.__init$()})},__isClass:function(e){return e&&(e.__isclass||e==Object||e==String||e==Array)},__newvec:function(e,t){var i=[];i.length=e;for(var n=0;n<e;n++)i[n]=t;return i},__extend:function(e,t){function n(){i.un(this,"constructor",e)}for(var a in t)if(t.hasOwnProperty(a)){var r=Object.getOwnPropertyDescriptor(t,a),o=r.get,s=r.set;o||s?o&&s?Object.defineProperty(e,a,r):(o&&Object.defineProperty(e,a,o),s&&Object.defineProperty(e,a,s)):e[a]=t[a]}n.prototype=t.prototype,e.prototype=new n,i.un(e.prototype,"__imps",i.__copy({},t.prototype.__imps))},__copy:function(e,t){if(!t)return null;e=e||{};for(var i in t)e[i]=t[i];return e},__package:function(t,n){if(!i.__packages[t]){i.__packages[t]=!0;var a=e,r=t.split(".");if(r.length>1)for(var o=0,s=r.length-1;o<s;o++){var h=a[r[o]];a=h||(a[r[o]]={})}a[r[r.length-1]]||(a[r[r.length-1]]=n||{})}},__hasOwnProperty:function(e,t){function i(e,t){if(Object.hasOwnProperty.call(t.prototype,e))return!0;var n=t.prototype.__super;return null==n?null:i(e,n)}return t=t||this,Object.hasOwnProperty.call(t,e)||i(e,t.__class)},__typeof:function(e,t){if(!e||!t)return!1;if(t===String)return"string"==typeof e;if(t===Number)return"number"==typeof e;if(t.__interface__)t=t.__interface__;else if("string"!=typeof t)return e instanceof t;return e.__imps&&e.__imps[t]||e.__class==t},__as:function(e,t){return this.__typeof(e,t)?e:null},__int:function(e){return e?parseInt(e):0},interface:function(t,n){i.__package(t,{});var a=i.__internals,r=a[t]=a[t]||{self:t};if(n){var o=n.split(",");r.extend=[];for(c=0;c<o.length;c++){var s=o[c];a[s]=a[s]||{self:s},r.extend.push(a[s])}}for(var h=e,l=t.split("."),c=0;c<l.length-1;c++)h=h[l[c]];h[l[l.length-1]]={__interface__:t}},class:function(t,n,a,r){if(a&&i.__extend(t,a),n)if(i.__package(n,t),i.__classmap[n]=t,n.indexOf(".")>0){if(0==n.indexOf("laya.")){var o=n.split(".");r=r||o[o.length-1],i[r]&&console.log("Warning!,this class["+r+"] already exist:",i[r]),i[r]=t}}else"Main"==n?e.Main=t:(i[n]&&console.log("Error!,this class["+n+"] already exist:",i[n]),i[n]=t);var s=i.un,h=t.prototype;s(h,"hasOwnProperty",i.__hasOwnProperty),s(h,"__class",t),s(h,"__super",a),s(h,"__className",n),s(t,"__super",a),s(t,"__className",n),s(t,"__isclass",!0),s(t,"super",function(e){this.__super.call(e)})},imps:function(e,t){function n(e){var t,r;if((t=i.__internals[e])&&(a[e]=!0,r=t.extend))for(var o=0;o<r.length;o++)n(r[o].self)}if(!t)return null;var a=e.__imps||i.un(e,"__imps",{});for(var r in t)n(r)},superSet:function(e,t,i,n){var a=e.prototype["_$set_"+i];a&&a.call(t,n)},superGet:function(e,t,i){var n=e.prototype["_$get_"+i];return n?n.call(t):null},getset:function(e,t,n,a,r){e?(a&&(t["_$GET_"+n]=a),r&&(t["_$SET_"+n]=r)):(a&&i.un(t,"_$get_"+n,a),r&&i.un(t,"_$set_"+n,r)),a&&r?Object.defineProperty(t,n,{get:a,set:r,enumerable:!1,configurable:!0}):(a&&Object.defineProperty(t,n,{get:a,enumerable:!1,configurable:!0}),r&&Object.defineProperty(t,n,{set:r,enumerable:!1,configurable:!0}))},static:function(e,t){for(var i=0,n=t.length;i<n;i+=2)"length"==t[i]?e.length=t[i+1].call(e):function(){var n=t[i],a=t[i+1];Object.defineProperty(e,n,{get:function(){return delete this[n],this[n]=a.call(this)},set:function(e){delete this[n],this[n]=e},enumerable:!0,configurable:!0})}()},un:function(e,t,n){return n||(n=e[t]),i.__propun.value=n,Object.defineProperty(e,t,i.__propun),n},uns:function(e,t){t.forEach(function(t){i.un(e,t)})}};return e.console=e.console||{log:function(){}},e.trace=e.console.log,Error.prototype.throwError=function(){throw arguments},Object.defineProperty(Array.prototype,"fixed",{enumerable:!1}),i}(window,document);!function(e,t,i){i.un,i.uns,i.static,i.class,i.getset,i.__newvec}(window,document,Laya),function(e,t,i){i.un,i.uns;var n=i.static,a=i.class,r=i.getset;i.__newvec;i.interface("laya.runtime.IMarket"),i.interface("laya.filters.IFilter"),i.interface("laya.display.ILayout"),i.interface("laya.resource.IDispose"),i.interface("laya.runtime.IPlatform"),i.interface("laya.resource.IDestroy"),i.interface("laya.runtime.IConchNode"),i.interface("laya.filters.IFilterAction"),i.interface("laya.runtime.ICPlatformClass"),i.interface("laya.resource.ICreateResource"),i.interface("laya.runtime.IConchRenderObject"),i.interface("laya.runtime.IPlatformClass","laya.runtime.IPlatform");var o=function(){function t(){}return a(t,"laya.utils.RunDriver"),t.FILTER_ACTIONS=[],t.pixelRatio=-1,t._charSizeTestDiv=null,t.now=function(){return Date.now()},t.getWindow=function(){return e},t.getPixelRatio=function(){if(t.pixelRatio<0){var e=O.context,i=e.backingStorePixelRatio||e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;(t.pixelRatio=(O.window.devicePixelRatio||1)/i)<1&&(t.pixelRatio=1)}return t.pixelRatio},t.getIncludeStr=function(e){return null},t.createShaderCondition=function(e){var t="(function() {return "+e+";})";return i._runScript(t)},t.fontMap=[],t.measureText=function(e,i){var n=t.hanzi.test(e);if(n&&t.fontMap[i])return t.fontMap[i];var a=O.context;a.font=i;var r=a.measureText(e);return n&&(t.fontMap[i]=r),r},t.getWebGLContext=function(e){},t.beginFlush=function(){},t.endFinish=function(){},t.addToAtlas=null,t.flashFlushImage=function(e){},t.drawToCanvas=function(e,t,i,n,a,r){var o=xe.create("2D"),s=new A(i,n,o);return R.renders[t]._fun(e,s,a,r),o},t.createParticleTemplate2D=null,t.createGLTextur=null,t.createWebGLContext2D=null,t.changeWebGLSize=function(e,t){},t.createRenderSprite=function(e,t){return new R(e,t)},t.createFilterAction=function(e){return new b},t.createGraphics=function(){return new _},t.clear=function(e){N._context.ctx.clear()},t.cancelLoadByUrl=function(e){},t.clearAtlas=function(e){},t.isAtlas=function(e){return!1},t.addTextureToAtlas=function(e){},t.getTexturePixels=function(e,t,i,n,a){return null},t.skinAniSprite=function(){return null},t.update3DLoop=function(){},n(t,["hanzi",function(){return this.hanzi=new RegExp("^[一-龥]$")}]),t}(),s=(r(1,i,"alertGlobalError",null,function(e){var t=0;O.window.onerror=e?function(e,i,n,a,r){t++<5&&r&&alert("出错啦，请把此信息截图给研发商\n"+e+"\n"+r.stack||r)}:null}),i.init=function(e,t,n){for(var a=[],r=2,o=arguments.length;r<o;r++)a.push(arguments[r]);if(!i._isinit){ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=i._arrayBufferSlice),i._isinit=!0,O.__init__(),B.__init__(),_.__init__(),i.timer=new W,i.scaleTimer=new W,i.loader=new se,Z.__init__();for(var r=0,s=a.length;r<s;r++)a[r].enable&&a[r].enable();return u.__init__(),p.__init__(),P.__init__(),U.beginCheck(),i._currentStage=i.stage=new ye,i.stage.conchModel&&i.stage.conchModel.setRootNode(),i.getUrlPath(),i.render=new N(0,0),i.stage.size(e,t),R.__init__(),g.__init__(),y.instance.__init__(i.stage,N.canvas),we.__init__(),E.autoStopMusic=!0,T.__init__(),N.canvas}},i.getUrlPath=function(){var e=O.window.location,t=e.pathname;t=":"==t.charAt(2)?t.substring(1):t,D.rootPath=D.basePath=D.getPath("file:"==e.protocol?t:e.protocol+"//"+e.host+e.pathname)},i._arrayBufferSlice=function(e,t){var i=new Uint8Array(this,e,t-e),n=new Uint8Array(i.length);return n.set(i),n.buffer},i._runScript=function(e){return O.window["e"+String.fromCharCode(118)+"al"](e)},i.stage=null,i.timer=null,i.scaleTimer=null,i.loader=null,i.version="1.7.19.1beta",i.render=null,i._currentStage=null,i._isinit=!1,i.MiniAdpter={init:function(){e.navigator&&e.navigator.userAgent&&e.navigator.userAgent.indexOf("MiniGame")>-1&&console.error("请先引用小游戏适配库laya.wxmini.js,详细教程：https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0")}},n(i,["conchMarket",function(){return this.conchMarket=e.conch?conchMarket:null},"PlatformClass",function(){return this.PlatformClass=e.PlatformClass}]),function(){function e(){}return a(e,"Config"),e.WebGLTextCacheCount=500,e.atlasEnable=!1,e.showCanvasMark=!1,e.animationInterval=50,e.isAntialias=!1,e.isAlpha=!1,e.premultipliedAlpha=!0,e.isStencil=!0,e.preserveDrawingBuffer=!1,e}()),h=function(){function e(){this._events=null}var t;a(e,"laya.events.EventDispatcher");var i=e.prototype;return i.hasListener=function(e){return!!(this._events&&this._events[e])},i.event=function(e,t){if(!this._events||!this._events[e])return!1;var i=this._events[e];if(i.run)i.once&&delete this._events[e],null!=t?i.runWith(t):i.run();else{for(var n=0,a=i.length;n<a;n++){var r=i[n];r&&(null!=t?r.runWith(t):r.run()),r&&!r.once||(i.splice(n,1),n--,a--)}0===i.length&&this._events&&delete this._events[e]}return!0},i.on=function(e,t,i,n){return this._createListener(e,t,i,n,!1)},i.once=function(e,t,i,n){return this._createListener(e,t,i,n,!0)},i._createListener=function(e,i,n,a,r,o){void 0===o&&(o=!0),o&&this.off(e,i,n,r);var s=t.create(i||this,n,a,r);this._events||(this._events={});var h=this._events;return h[e]?h[e].run?h[e]=[h[e],s]:h[e].push(s):h[e]=s,this},i.off=function(e,t,i,n){if(void 0===n&&(n=!1),!this._events||!this._events[e])return this;var a=this._events[e];if(null!=i)if(a.run)t&&a.caller!==t||a.method!==i||n&&!a.once||(delete this._events[e],a.recover());else{for(var r=0,o=0,s=a.length;o<s;o++){var h=a[o];h?!h||t&&h.caller!==t||h.method!==i||n&&!h.once||(r++,a[o]=null,h.recover()):r++}r===s&&delete this._events[e]}return this},i.offAll=function(e){var t=this._events;if(!t)return this;if(e)this._recoverHandlers(t[e]),delete t[e];else{for(var i in t)this._recoverHandlers(t[i]);this._events=null}return this},i._recoverHandlers=function(e){if(e)if(e.run)e.recover();else for(var t=e.length-1;t>-1;t--)e[t]&&(e[t].recover(),e[t]=null)},i.isMouseEvent=function(t){return e.MOUSE_EVENTS[t]},e.MOUSE_EVENTS={rightmousedown:!0,rightmouseup:!0,rightclick:!0,mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0},e.__init$=function(){Object.defineProperty(laya.events.EventDispatcher.prototype,"_events",{enumerable:!1,writable:!0}),t=function(e){function t(e,i,n,a){t.__super.call(this,e,i,n,a)}a(t,"",l);return t.prototype.recover=function(){this._id>0&&(this._id=0,t._pool.push(this.clear()))},t.create=function(e,i,n,a){return void 0===a&&(a=!0),t._pool.length?t._pool.pop().setTo(e,i,n,a):new t(e,i,n,a)},t._pool=[],t}()},e}(),l=function(){function e(e,t,i,n){this.once=!1,this._id=0,void 0===n&&(n=!1),this.setTo(e,t,i,n)}a(e,"laya.utils.Handler");var t=e.prototype;return t.setTo=function(t,i,n,a){return this._id=e._gid++,this.caller=t,this.method=i,this.args=n,this.once=a,this},t.run=function(){if(null==this.method)return null;var e=this._id,t=this.method.apply(this.caller,this.args);return this._id===e&&this.once&&this.recover(),t},t.runWith=function(e){if(null==this.method)return null;var t=this._id;if(null==e)var i=this.method.apply(this.caller,this.args);else i=this.args||e.unshift?this.args?this.method.apply(this.caller,this.args.concat(e)):this.method.apply(this.caller,e):this.method.call(this.caller,e);return this._id===t&&this.once&&this.recover(),i},t.clear=function(){return this.caller=null,this.method=null,this.args=null,this},t.recover=function(){this._id>0&&(this._id=0,e._pool.push(this.clear()))},e.create=function(t,i,n,a){return void 0===a&&(a=!0),e._pool.length?e._pool.pop().setTo(t,i,n,a):new e(t,i,n,a)},e._pool=[],e._gid=1,e}(),c=function(){function e(){this._texture=null,this._fontCharDic={},this._fontWidthMap={},this._complete=null,this._path=null,this._maxWidth=0,this._spaceWidth=10,this._padding=null,this.fontSize=12,this.autoScaleSize=!1,this.letterSpacing=0}a(e,"laya.display.BitmapFont");var t=e.prototype;return t.loadFont=function(e,t){this._path=e,this._complete=t,i.loader.load([{url:this._path,type:"xml"},{url:this._path.replace(".fnt",".png"),type:"image"}],l.create(this,this.onLoaded))},t.onLoaded=function(){this.parseFont(oe.getRes(this._path),oe.getRes(this._path.replace(".fnt",".png"))),this._complete&&this._complete.runWith(this._texture?this:null)},t.parseFont=function(e,t){if(null!=e&&null!=t){this._texture=t;var i=e.getElementsByTagName("info");if(!i[0].getAttributeNode)return this.parseFont2(e,t);this.fontSize=parseInt(i[0].getAttributeNode("size").nodeValue);var n=i[0].getAttributeNode("padding").nodeValue.split(",");this._padding=[parseInt(n[0]),parseInt(n[1]),parseInt(n[2]),parseInt(n[3])];var a;a=e.getElementsByTagName("char");var r=0;for(r=0;r<a.length;r++){var o=a[r],s=parseInt(o.getAttributeNode("id").nodeValue),h=parseInt(o.getAttributeNode("xoffset").nodeValue)/1,l=parseInt(o.getAttributeNode("yoffset").nodeValue)/1,c=parseInt(o.getAttributeNode("xadvance").nodeValue)/1,p=new k;p.x=parseInt(o.getAttributeNode("x").nodeValue),p.y=parseInt(o.getAttributeNode("y").nodeValue),p.width=parseInt(o.getAttributeNode("width").nodeValue),p.height=parseInt(o.getAttributeNode("height").nodeValue);var u=ce.create(t,p.x,p.y,p.width,p.height,h,l);this._maxWidth=Math.max(this._maxWidth,c+this.letterSpacing),this._fontCharDic[s]=u,this._fontWidthMap[s]=c}}},t.parseFont2=function(e,t){if(null!=e&&null!=t){this._texture=t;var i=e.getElementsByTagName("info");this.fontSize=parseInt(i[0].attributes.size.nodeValue);var n=i[0].attributes.padding.nodeValue.split(",");this._padding=[parseInt(n[0]),parseInt(n[1]),parseInt(n[2]),parseInt(n[3])];var a=e.getElementsByTagName("char"),r=0;for(r=0;r<a.length;r++){var o=a[r].attributes,s=parseInt(o.id.nodeValue),h=parseInt(o.xoffset.nodeValue)/1,l=parseInt(o.yoffset.nodeValue)/1,c=parseInt(o.xadvance.nodeValue)/1,p=new k;p.x=parseInt(o.x.nodeValue),p.y=parseInt(o.y.nodeValue),p.width=parseInt(o.width.nodeValue),p.height=parseInt(o.height.nodeValue);var u=ce.create(t,p.x,p.y,p.width,p.height,h,l);this._maxWidth=Math.max(this._maxWidth,c+this.letterSpacing),this._fontCharDic[s]=u,this._fontWidthMap[s]=c}}},t.getCharTexture=function(e){return this._fontCharDic[e.charCodeAt(0)]},t.destroy=function(){if(this._texture){for(var e in this._fontCharDic){var t=this._fontCharDic[e];t&&t.destroy()}this._texture.destroy(),this._fontCharDic=null,this._fontWidthMap=null,this._texture=null}},t.setSpaceWidth=function(e){this._spaceWidth=e},t.getCharWidth=function(e){var t=e.charCodeAt(0);return this._fontWidthMap[t]?this._fontWidthMap[t]+this.letterSpacing:" "==e?this._spaceWidth+this.letterSpacing:0},t.getTextWidth=function(e){for(var t=0,i=0,n=e.length;i<n;i++)t+=this.getCharWidth(e.charAt(i));return t},t.getMaxWidth=function(){return this._maxWidth},t.getMaxHeight=function(){return this.fontSize},t.drawText=function(e,t,i,n,a,r){var o,s=this.getTextWidth(e),h=0;"center"===a&&(h=(r-s)/2),"right"===a&&(h=r-s);for(var l=0,c=0,p=e.length;c<p;c++)(o=this.getCharTexture(e.charAt(c)))&&(t.graphics.drawTexture(o,i+l+h,n),l+=this.getCharWidth(e.charAt(c)))},e}(),p=function(){function e(){this.alpha=1,this.visible=!0,this.scrollRect=null,this.blendMode=null,this._type=0,this._tf=e._TF_EMPTY}a(e,"laya.display.css.Style");var t=e.prototype;return t.getTransform=function(){return this._tf},t.setTransform=function(t){this._tf="none"!==t&&t?t:e._TF_EMPTY},t.setTranslateX=function(t){this._tf===e._TF_EMPTY&&(this._tf=new d),this._tf.translateX=t},t.setTranslateY=function(t){this._tf===e._TF_EMPTY&&(this._tf=new d),this._tf.translateY=t},t.setScaleX=function(t){this._tf===e._TF_EMPTY&&(this._tf=new d),this._tf.scaleX=t},t.setScale=function(t,i){this._tf===e._TF_EMPTY&&(this._tf=new d),this._tf.scaleX=t,this._tf.scaleY=i},t.setScaleY=function(t){this._tf===e._TF_EMPTY&&(this._tf=new d),this._tf.scaleY=t},t.setRotate=function(t){this._tf===e._TF_EMPTY&&(this._tf=new d),this._tf.rotate=t},t.setSkewX=function(t){this._tf===e._TF_EMPTY&&(this._tf=new d),this._tf.skewX=t},t.setSkewY=function(t){this._tf===e._TF_EMPTY&&(this._tf=new d),this._tf.skewY=t},t.destroy=function(){this.scrollRect=null},t.render=function(e,t,i,n){},t.getCSSStyle=function(){return ee.EMPTY},t._enableLayout=function(){return!1},r(0,t,"scaleX",function(){return this._tf.scaleX},function(e){this.setScaleX(e)}),r(0,t,"transform",function(){return this.getTransform()},function(e){this.setTransform(e)}),r(0,t,"translateX",function(){return this._tf.translateX},function(e){this.setTranslateX(e)}),r(0,t,"translateY",function(){return this._tf.translateY},function(e){this.setTranslateY(e)}),r(0,t,"scaleY",function(){return this._tf.scaleY},function(e){this.setScaleY(e)}),r(0,t,"block",function(){return 0!=(1&this._type)}),r(0,t,"skewY",function(){return this._tf.skewY},function(e){this.setSkewY(e)}),r(0,t,"rotate",function(){return this._tf.rotate},function(e){this.setRotate(e)}),r(0,t,"skewX",function(){return this._tf.skewX},function(e){this.setSkewX(e)}),r(0,t,"paddingLeft",function(){return 0}),r(0,t,"paddingTop",function(){return 0}),r(0,t,"absolute",function(){return!0}),e.__init__=function(){e._TF_EMPTY=new d,e.EMPTY=new e},e.EMPTY=null,e._TF_EMPTY=null,e}(),u=function(){function e(t){this._type=0,this._weight=0,this._decoration=null,this._text=null,this.indent=0,this._color=H.create(e.defaultColor),this.family=e.defaultFamily,this.stroke=e._STROKE,this.size=e.defaultSize,t&&t!==e.EMPTY&&t.copyTo(this)}a(e,"laya.display.css.Font");var t=e.prototype;return t.set=function(e){this._text=null;for(var t=e.split(" "),i=0,n=t.length;i<n;i++){var a=t[i];switch(a){case"italic":this.italic=!0;continue;case"bold":this.bold=!0;continue}a.indexOf("px")>0&&(this.size=parseInt(a),this.family=t[i+1],i++)}},t.toString=function(){return this._text="",this.italic&&(this._text+="italic "),this.bold&&(this._text+="bold "),this._text+=this.size+"px "+this.family},t.copyTo=function(t){t._type=this._type,t._text=this._text,t._weight=this._weight,t._color=this._color,t.family=this.family,t.stroke=this.stroke!=e._STROKE?this.stroke.slice():e._STROKE,t.indent=this.indent,t.size=this.size},r(0,t,"password",function(){return 0!=(1024&this._type)},function(e){e?this._type|=1024:this._type&=-1025}),r(0,t,"color",function(){return this._color.strColor},function(e){this._color=H.create(e)}),r(0,t,"italic",function(){return 0!=(512&this._type)},function(e){e?this._type|=512:this._type&=-513}),r(0,t,"bold",function(){return 0!=(2048&this._type)},function(e){e?this._type|=2048:this._type&=-2049}),r(0,t,"weight",function(){return""+this._weight},function(e){var t=0;switch(e){case"normal":break;case"bold":this.bold=!0,t=700;break;case"bolder":t=800;break;case"lighter":t=100;break;default:t=parseInt(e)}this._weight=t,this._text=null}),r(0,t,"decoration",function(){return this._decoration?this._decoration.value:"none"},function(e){var t=e.split(" ");switch(this._decoration||(this._decoration={}),t[0]){case"_":this._decoration.type="underline";break;case"-":this._decoration.type="line-through";break;case"overline":this._decoration.type="overline";break;default:this._decoration.type=t[0]}t[1]&&(this._decoration.color=H.create(t)),this._decoration.value=e}),e.__init__=function(){e.EMPTY=new e(null)},e.EMPTY=null,e.defaultColor="#000000",e.defaultSize=12,e.defaultFamily="Arial",e.defaultFont="12px Arial",e._STROKE=[0,"#000000"],e._ITALIC=512,e._PASSWORD=1024,e._BOLD=2048,e}(),d=function(){function e(){this.translateX=0,this.translateY=0,this.scaleX=1,this.scaleY=1,this.rotate=0,this.skewX=0,this.skewY=0}return a(e,"laya.display.css.TransformInfo"),e}(),_=function(){function t(){if(this._one=null,this._cmds=null,this._render=this._renderEmpty,N.isConchNode){this._nativeObj=new e._conchGraphics,this.id=this._nativeObj.conchID}}a(t,"laya.display.Graphics");var n=t.prototype;return n.destroy=function(){this.clear(),this._graphicBounds&&this._graphicBounds.destroy(),this._graphicBounds=null,this._vectorgraphArray=null,this._sp&&(this._sp._renderType=0),this._sp=null},n.clear=function(e){void 0===e&&(e=!1);var i=0,n=0;if(e){var a=this._one;if(this._cmds){for(n=this._cmds.length,i=0;i<n;i++)!(a=this._cmds[i])||a.callee!==N._context._drawTexture&&a.callee!==N._context._drawTextureWithTransform||(a[0]=null,t._cache.push(a));this._cmds.length=0}else a&&(!a||a.callee!==N._context._drawTexture&&a.callee!==N._context._drawTextureWithTransform||(a[0]=null,t._cache.push(a)))}else this._cmds=null;if(this._one=null,this._render=this._renderEmpty,this._sp&&(this._sp._renderType&=-514),this._repaint(),this._vectorgraphArray){for(i=0,n=this._vectorgraphArray.length;i<n;i++)J.getInstance().deleteShape(this._vectorgraphArray[i]);this._vectorgraphArray.length=0}},n._clearBoundsCache=function(){this._graphicBounds&&this._graphicBounds.reset()},n._initGraphicBounds=function(){this._graphicBounds||(this._graphicBounds=new m,this._graphicBounds._graphics=this)},n._repaint=function(){this._clearBoundsCache(),this._sp&&this._sp.repaint()},n._isOnlyOne=function(){return!this._cmds||0===this._cmds.length},n.getBounds=function(e){return void 0===e&&(e=!1),this._initGraphicBounds(),this._graphicBounds.getBounds(e)},n.getBoundPoints=function(e){return void 0===e&&(e=!1),this._initGraphicBounds(),this._graphicBounds.getBoundPoints(e)},n._addCmd=function(e){this._cmds=this._cmds||[],e.callee=e.shift(),this._cmds.push(e)},n.setFilters=function(e){this._saveToCmd(N._context._setFilters,e)},n.drawTexture=function(e,i,n,a,r,o,s){if(void 0===i&&(i=0),void 0===n&&(n=0),void 0===a&&(a=0),void 0===r&&(r=0),void 0===s&&(s=1),!e||s<.01)return null;a||(a=e.sourceWidth),r||(r=e.sourceHeight),s=s<0?0:s>1?1:s;var h=!N.isWebGL&&(O.onFirefox||O.onEdge||O.onIE||O.onSafari)?.5:0,l=a/e.sourceWidth,c=r/e.sourceHeight;if(a=e.width*l,r=e.height*c,e.loaded&&(a<=0||r<=0))return null;i+=e.offsetX*l,n+=e.offsetY*c,this._sp&&(this._sp._renderType|=512);var p;return i-=h,n-=h,a+=2*h,r+=2*h,t._cache.length?((p=t._cache.pop())[0]=e,p[1]=i,p[2]=n,p[3]=a,p[4]=r,p[5]=o,p[6]=s):p=[e,i,n,a,r,o,s],p.callee=o||1!=s?N._context._drawTextureWithTransform:N._context._drawTexture,null!=this._one||o||1!=s?this._saveToCmd(p.callee,p):(this._one=p,this._render=this._renderOneImg),e.loaded||e.once("loaded",this,this._textureLoaded,[e,p]),this._repaint(),p},n.cleanByTexture=function(e,t,i,n,a){if(void 0===n&&(n=0),void 0===a&&(a=0),!e)return this.clear();if(this._one&&this._render===this._renderOneImg){n||(n=e.sourceWidth),a||(a=e.sourceHeight);var r=n/e.sourceWidth,o=a/e.sourceHeight;n=e.width*r,a=e.height*o,t+=e.offsetX*r,i+=e.offsetY*o,this._one[0]=e,this._one[1]=t,this._one[2]=i,this._one[3]=n,this._one[4]=a,this._repaint()}else this.clear(),e&&this.drawTexture(e,t,i,n,a)},n.drawTextures=function(e,t){e&&this._saveToCmd(N._context._drawTextures,[e,t])},n.fillTexture=function(e,t,i,n,a,r,o){if(void 0===n&&(n=0),void 0===a&&(a=0),void 0===r&&(r="repeat"),e){var s=[e,t,i,n,a,r,o||C.EMPTY,{}];e.loaded||e.once("loaded",this,this._textureLoaded,[e,s]),this._saveToCmd(N._context._fillTexture,s)}},n._textureLoaded=function(e,t){t[3]=t[3]||e.width,t[4]=t[4]||e.height,this._repaint()},n.fillCircle=function(e,t,i,n,a,r,o){i.bitmap.enableMerageInAtlas=!1;var s=new Float32Array(2*(o+1)),h=new Float32Array(2*(o+1)),l=new Uint16Array(3*o),c=2*Math.PI/o,p=0;s[0]=n,s[1]=a,h[0]=n/i.width,h[1]=a/i.height;for(var u=2,d=0;d<o;d++){var _=r*Math.cos(p)+n,m=r*Math.sin(p)+a;s[u]=_,s[u+1]=m,h[u]=_/i.width,h[u+1]=m/i.height,p+=c,u+=2}for(u=0,d=0;d<o;d++)l[u++]=0,l[u++]=d+1,l[u++]=d+2>=o+1?1:d+2;this.drawTriangles(i,e,t,s,h,l)},n.drawTriangles=function(e,t,i,n,a,r,o,s,h,l){void 0===s&&(s=1),this._saveToCmd(N._context.drawTriangles,[e,t,i,n,a,r,o,s,h,l])},n._saveToCmd=function(e,t){return this._sp&&(this._sp._renderType|=512),null==this._one?(this._one=t,this._render=this._renderOne):(this._sp&&(this._sp._renderType&=-2),this._render=this._renderAll,0===(this._cmds||(this._cmds=[])).length&&this._cmds.push(this._one),this._cmds.push(t)),t.callee=e,this._repaint(),t},n.clipRect=function(e,t,i,n){this._saveToCmd(N._context._clipRect,[e,t,i,n])},n.fillText=function(e,t,i,n,a,r,o){void 0===o&&(o=0),this._saveToCmd(N._context._fillText,[e,t,i,n||u.defaultFont,a,r])},n.fillBorderText=function(e,t,i,n,a,r,o,s){this._saveToCmd(N._context._fillBorderText,[e,t,i,n||u.defaultFont,a,r,o,s])},n.strokeText=function(e,t,i,n,a,r,o){this._saveToCmd(N._context._strokeText,[e,t,i,n||u.defaultFont,a,r,o])},n.alpha=function(e){e=e<0?0:e>1?1:e,this._saveToCmd(N._context._alpha,[e])},n.setAlpha=function(e){e=e<0?0:e>1?1:e,this._saveToCmd(N._context._setAlpha,[e])},n.transform=function(e,t,i){void 0===t&&(t=0),void 0===i&&(i=0),this._saveToCmd(N._context._transform,[e,t,i])},n.rotate=function(e,t,i){void 0===t&&(t=0),void 0===i&&(i=0),this._saveToCmd(N._context._rotate,[e,t,i])},n.scale=function(e,t,i,n){void 0===i&&(i=0),void 0===n&&(n=0),this._saveToCmd(N._context._scale,[e,t,i,n])},n.translate=function(e,t){this._saveToCmd(N._context._translate,[e,t])},n.save=function(){this._saveToCmd(N._context._save,[])},n.restore=function(){this._saveToCmd(N._context._restore,[])},n.replaceText=function(e){this._repaint();var t=this._cmds;if(t){for(var i=t.length-1;i>-1;i--)if(this._isTextCmd(t[i].callee))return t[i][0].toUpperCase?t[i][0]=e:t[i][0].setText(e),!0}else if(this._one&&this._isTextCmd(this._one.callee))return this._one[0].toUpperCase?this._one[0]=e:this._one[0].setText(e),!0;return!1},n._isTextCmd=function(e){return e===N._context._fillText||e===N._context._fillBorderText||e===N._context._strokeText},n.replaceTextColor=function(e){this._repaint();var t=this._cmds;if(t)for(var i=t.length-1;i>-1;i--)this._isTextCmd(t[i].callee)&&(t[i][4]=e,t[i][0].toUpperCase||(t[i][0].changed=!0));else this._one&&this._isTextCmd(this._one.callee)&&(this._one[4]=e,this._one[0].toUpperCase||(this._one[0].changed=!0))},n.loadImage=function(e,t,n,a,r,o){function s(e){e&&(h.drawTexture(e,t,n,a,r),null!=o&&o.call(h._sp,e))}var h=this;void 0===t&&(t=0),void 0===n&&(n=0),void 0===a&&(a=0),void 0===r&&(r=0);var c=oe.getRes(e);c?s(c):i.loader.load(e,l.create(null,s),null,"image")},n._renderEmpty=function(e,t,i,n){},n._renderAll=function(e,t,i,n){for(var a,r=this._cmds,o=0,s=r.length;o<s;o++)(a=r[o]).callee.call(t,i,n,a)},n._renderOne=function(e,t,i,n){this._one.callee.call(t,i,n,this._one)},n._renderOneImg=function(e,t,i,n){this._one.callee.call(t,i,n,this._one),2305!==e._renderType&&(e._renderType|=1)},n.drawLine=function(e,t,i,n,a,r){void 0===r&&(r=1);var o=0;N.isWebGL&&(o=J.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(o));var s=r%2==0?0:.5,h=[e+s,t+s,i+s,n+s,a,r,o];this._saveToCmd(N._context._drawLine,h)},n.drawLines=function(e,t,i,n,a){void 0===a&&(a=1);var r=0;if(i&&!(i.length<4)){N.isWebGL&&(r=J.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(r));var o=a%2==0?0:.5,s=[e+o,t+o,i,n,a,r];this._saveToCmd(N._context._drawLines,s)}},n.drawCurves=function(e,t,i,n,a){void 0===a&&(a=1);var r=[e,t,i,n,a];this._saveToCmd(N._context._drawCurves,r)},n.drawRect=function(e,t,i,n,a,r,o){void 0===o&&(o=1);var s=r?o/2:0,h=r?o:0,l=[e+s,t+s,i-h,n-h,a,r,o];this._saveToCmd(N._context._drawRect,l)},n.drawCircle=function(e,t,i,n,a,r){void 0===r&&(r=1);var o=a?r/2:0,s=0;N.isWebGL&&(s=J.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(s));var h=[e,t,i-o,n,a,r,s];this._saveToCmd(N._context._drawCircle,h)},n.drawPie=function(e,t,i,n,a,r,o,s){void 0===s&&(s=1);var h=o?s/2:0,l=o?s:0,c=0;N.isWebGL&&(c=J.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(c));var p=[e+h,t+h,i-l,n,a,r,o,s,c];p[3]=K.toRadian(n),p[4]=K.toRadian(a),this._saveToCmd(N._context._drawPie,p)},n.drawPoly=function(e,t,i,n,a,r){void 0===r&&(r=1);var o=0,s=!1;N.isWebGL&&(o=J.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(o),s=!(i.length>6));var h=a?r%2==0?0:.5:0,l=[e+h,t+h,i,n,a,r,o,s];this._saveToCmd(N._context._drawPoly,l)},n.drawPath=function(e,t,i,n,a){var r=[e,t,i,n,a];this._saveToCmd(N._context._drawPath,r)},r(0,n,"cmds",function(){return this._cmds},function(e){this._sp&&(this._sp._renderType|=512),this._cmds=e,this._render=this._renderAll,this._repaint()}),t.__init__=function(){if(N.isConchNode){for(var e=laya.display.Graphics.prototype,t=O.window.ConchGraphics.prototype,i=["clear","destroy","alpha","rotate","transform","scale","translate","save","restore","clipRect","blendMode","fillText","fillBorderText","_fands","drawRect","drawCircle","drawPie","drawPoly","drawPath","drawImageM","drawLine","drawLines","_drawPs","drawCurves","replaceText","replaceTextColor","_fillImage","fillTexture","setSkinMesh","drawParticle","drawImageS"],n=0,a=i.length;n<=a;n++){var r=i[n];e[r]=t[r]}e._saveToCmd=null,t.drawImageS&&(e.drawTextures=function(e,t){if(e&&e.loaded&&e.bitmap&&e.source){var i=e.uv,n=e.bitmap.width,a=e.bitmap.height;this.drawImageS(e.bitmap.source,i[0]*n,i[1]*a,(i[2]-i[0])*n,(i[5]-i[3])*a,e.offsetX,e.offsetY,e.width,e.height,t)}}),e.drawTexture=function(e,t,i,n,a,r,o){if(void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=0),void 0===a&&(a=0),void 0===o&&(o=1),e)if(e.loaded){if(e.loaded&&e.bitmap&&e.source&&(n||(n=e.sourceWidth),a||(a=e.sourceHeight),o=o<0?0:o>1?1:o,n=n-e.sourceWidth+e.width,a=a-e.sourceHeight+e.height,!(n<=0||a<=0))){t+=e.offsetX,i+=e.offsetY;var s=e.uv,h=e.bitmap.width,l=e.bitmap.height;this.drawImageM(e.bitmap.source,s[0]*h,s[1]*l,(s[2]-s[0])*h,(s[5]-s[3])*l,t,i,n,a,r,o),this._repaint()}}else e.once("loaded",this,function(){this.drawTexture(e,t,i,n,a,r)})},e.fillTexture=function(e,t,i,n,a,r,o){if(void 0===n&&(n=0),void 0===a&&(a=0),void 0===r&&(r="repeat"),e&&e.loaded){var s,h=N._context.ctx,l=e.bitmap.width,c=e.bitmap.height,p=e.uv;s=e.uv!=ce.DEF_UV?h.createPattern(e.bitmap.source,r,p[0]*l,p[1]*c,(p[2]-p[0])*l,(p[5]-p[3])*c):h.createPattern(e.bitmap.source,r);var u=0,d=0;o&&(t+=o.x%e.width,i+=o.y%e.height,u-=o.x%e.width,d-=o.y%e.height),this._fillImage(s,t,i,u,d,n,a)}}}},t._cache=[],t}(),m=function(){function e(){this._cacheBoundsType=!1}a(e,"laya.display.GraphicsBounds");var t=e.prototype;return t.destroy=function(){this._graphics=null,this._temp=null,this._rstBoundPoints=null,this._bounds=null},t.reset=function(){this._temp&&(this._temp.length=0)},t.getBounds=function(e){return void 0===e&&(e=!1),(!this._bounds||!this._temp||this._temp.length<1||e!=this._cacheBoundsType)&&(this._bounds=k._getWrapRec(this.getBoundPoints(e),this._bounds)),this._cacheBoundsType=e,this._bounds},t.getBoundPoints=function(e){return void 0===e&&(e=!1),(!this._temp||this._temp.length<1||e!=this._cacheBoundsType)&&(this._temp=this._getCmdPoints(e)),this._cacheBoundsType=e,this._rstBoundPoints=K.copyArray(this._rstBoundPoints,this._temp)},t._getCmdPoints=function(t){void 0===t&&(t=!1);var i,n=N._context,a=this._graphics.cmds;if(i=this._temp||(this._temp=[]),i.length=0,a||null==this._graphics._one||(e._tempCmds.length=0,e._tempCmds.push(this._graphics._one),a=e._tempCmds),!a)return i;var r;(r=e._tempMatrixArrays).length=0;var o=e._initMatrix;o.identity();for(var s,h,l=e._tempMatrix,c=NaN,p=NaN,u=NaN,d=NaN,_=NaN,m=NaN,f=0,g=a.length;f<g;f++)if((s=a[f]).callee)switch(s.callee){case n._save:case 7:r.push(o),o=o.clone();break;case n._restore:case 8:o=r.pop();break;case n._scale:case 5:l.identity(),l.translate(-s[2],-s[3]),l.scale(s[0],s[1]),l.translate(s[2],s[3]),this._switchMatrix(o,l);break;case n._rotate:case 3:l.identity(),l.translate(-s[1],-s[2]),l.rotate(s[0]),l.translate(s[1],s[2]),this._switchMatrix(o,l);break;case n._translate:case 6:l.identity(),l.translate(s[0],s[1]),this._switchMatrix(o,l);break;case n._transform:case 4:l.identity(),l.translate(-s[1],-s[2]),l.concat(s[0]),l.translate(s[1],s[2]),this._switchMatrix(o,l);break;case 16:case 24:e._addPointArrToRst(i,k._getBoundPointS(s[0],s[1],s[2],s[3]),o);break;case 17:o.copyTo(l),l.concat(s[4]),e._addPointArrToRst(i,k._getBoundPointS(s[0],s[1],s[2],s[3]),l);break;case n._drawTexture:h=s[0],t?s[3]&&s[4]?e._addPointArrToRst(i,k._getBoundPointS(s[1],s[2],s[3],s[4]),o):(h=s[0],e._addPointArrToRst(i,k._getBoundPointS(s[1],s[2],h.width,h.height),o)):(c=(s[3]||h.sourceWidth)/h.width,p=(s[4]||h.sourceHeight)/h.height,u=c*h.sourceWidth,d=p*h.sourceHeight,_=h.offsetX>0?h.offsetX:0,m=h.offsetY>0?h.offsetY:0,_*=c,m*=p,e._addPointArrToRst(i,k._getBoundPointS(s[1]-_,s[2]-m,u,d),o));break;case n._fillTexture:s[3]&&s[4]?e._addPointArrToRst(i,k._getBoundPointS(s[1],s[2],s[3],s[4]),o):(h=s[0],e._addPointArrToRst(i,k._getBoundPointS(s[1],s[2],h.width,h.height),o));break;case n._drawTextureWithTransform:var y;s[5]?(o.copyTo(l),l.concat(s[5]),y=l):y=o,t?s[3]&&s[4]?e._addPointArrToRst(i,k._getBoundPointS(s[1],s[2],s[3],s[4]),y):(h=s[0],e._addPointArrToRst(i,k._getBoundPointS(s[1],s[2],h.width,h.height),y)):(h=s[0],c=(s[3]||h.sourceWidth)/h.width,p=(s[4]||h.sourceHeight)/h.height,u=c*h.sourceWidth,d=p*h.sourceHeight,_=h.offsetX>0?h.offsetX:0,m=h.offsetY>0?h.offsetY:0,_*=c,m*=p,e._addPointArrToRst(i,k._getBoundPointS(s[1]-_,s[2]-m,u,d),y));break;case n._drawRect:case 13:e._addPointArrToRst(i,k._getBoundPointS(s[0],s[1],s[2],s[3]),o);break;case n._drawCircle:case n._fillCircle:case 14:e._addPointArrToRst(i,k._getBoundPointS(s[0]-s[2],s[1]-s[2],s[2]+s[2],s[2]+s[2]),o);break;case n._drawLine:case 20:e._tempPoints.length=0;var v=NaN;v=.5*s[5],s[0]==s[2]?e._tempPoints.push(s[0]+v,s[1],s[2]+v,s[3],s[0]-v,s[1],s[2]-v,s[3]):s[1]==s[3]?e._tempPoints.push(s[0],s[1]+v,s[2],s[3]+v,s[0],s[1]-v,s[2],s[3]-v):e._tempPoints.push(s[0],s[1],s[2],s[3]),e._addPointArrToRst(i,e._tempPoints,o);break;case n._drawCurves:case 22:e._addPointArrToRst(i,w.I.getBezierPoints(s[2]),o,s[0],s[1]);break;case n._drawPoly:case n._drawLines:case 18:e._addPointArrToRst(i,s[2],o,s[0],s[1]);break;case n._drawPath:case 19:e._addPointArrToRst(i,this._getPathPoints(s[2]),o,s[0],s[1]);break;case n._drawPie:case 15:e._addPointArrToRst(i,this._getPiePoints(s[0],s[1],s[2],s[3],s[4]),o)}return i.length>200?i=K.copyArray(i,k._getWrapRec(i)._getBoundPoints()):i.length>8&&(i=S.scanPList(i)),i},t._switchMatrix=function(e,t){t.concat(e),t.copyTo(e)},t._getPiePoints=function(t,i,n,a,r){var o=e._tempPoints;e._tempPoints.length=0,o.push(t,i);var s=(r-a)%(2*Math.PI)/10,h=NaN,l=a;for(h=0;h<=10;h++)o.push(t+n*Math.cos(l),i+n*Math.sin(l)),l+=s;return o},t._getPathPoints=function(t){var i=0,n=0,a=e._tempPoints;a.length=0,n=t.length;var r;for(i=0;i<n;i++)(r=t[i]).length>1&&(a.push(r[1],r[2]),r.length>3&&a.push(r[3],r[4]));return a},e._addPointArrToRst=function(t,i,n,a,r){void 0===a&&(a=0),void 0===r&&(r=0);var o=0,s=0;for(s=i.length,o=0;o<s;o+=2)e._addPointToRst(t,i[o]+a,i[o+1]+r,n)},e._addPointToRst=function(e,t,i,n){var a=C.TEMP;a.setTo(t||0,i||0),n.transformPoint(a),e.push(a.x,a.y)},e._tempPoints=[],e._tempMatrixArrays=[],e._tempCmds=[],n(e,["_tempMatrix",function(){return this._tempMatrix=new M},"_initMatrix",function(){return this._initMatrix=new M}]),e}(),f=function(){function e(){}a(e,"laya.events.Event");var t=e.prototype;return t.setTo=function(e,t,i){return this.type=e,this.currentTarget=t,this.target=i,this},t.stopPropagation=function(){this._stoped=!0},r(0,t,"stageY",function(){return i.stage.mouseY}),r(0,t,"charCode",function(){return this.nativeEvent.charCode}),r(0,t,"touches",function(){var e=this.nativeEvent.touches;if(e)for(var t=i.stage,n=0,a=e.length;n<a;n++){var r=e[n],o=C.TEMP;o.setTo(r.clientX,r.clientY),t._canvasTransform.invertTransformPoint(o),t.transform.invertTransformPoint(o),r.stageX=o.x,r.stageY=o.y}return e}),r(0,t,"keyLocation",function(){return this.nativeEvent.keyLocation}),r(0,t,"ctrlKey",function(){return this.nativeEvent.ctrlKey}),r(0,t,"altKey",function(){return this.nativeEvent.altKey}),r(0,t,"shiftKey",function(){return this.nativeEvent.shiftKey}),r(0,t,"stageX",function(){return i.stage.mouseX}),e.EMPTY=new e,e.MOUSE_DOWN="mousedown",e.MOUSE_UP="mouseup",e.CLICK="click",e.RIGHT_MOUSE_DOWN="rightmousedown",e.RIGHT_MOUSE_UP="rightmouseup",e.RIGHT_CLICK="rightclick",e.MOUSE_MOVE="mousemove",e.MOUSE_OVER="mouseover",e.MOUSE_OUT="mouseout",e.MOUSE_WHEEL="mousewheel",e.ROLL_OVER="mouseover",e.ROLL_OUT="mouseout",e.DOUBLE_CLICK="doubleclick",e.CHANGE="change",e.CHANGED="changed",e.RESIZE="resize",e.ADDED="added",e.REMOVED="removed",e.DISPLAY="display",e.UNDISPLAY="undisplay",e.ERROR="error",e.COMPLETE="complete",e.LOADED="loaded",e.PROGRESS="progress",e.INPUT="input",e.RENDER="render",e.OPEN="open",e.MESSAGE="message",e.CLOSE="close",e.KEY_DOWN="keydown",e.KEY_PRESS="keypress",e.KEY_UP="keyup",e.FRAME="enterframe",e.DRAG_START="dragstart",e.DRAG_MOVE="dragmove",e.DRAG_END="dragend",e.ENTER="enter",e.SELECT="select",e.BLUR="blur",e.FOCUS="focus",e.VISIBILITY_CHANGE="visibilitychange",e.FOCUS_CHANGE="focuschange",e.PLAYED="played",e.PAUSED="paused",e.STOPPED="stopped",e.START="start",e.END="end",e.ENABLE_CHANGED="enablechanged",e.ACTIVE_IN_HIERARCHY_CHANGED="activeinhierarchychanged",e.COMPONENT_ADDED="componentadded",e.COMPONENT_REMOVED="componentremoved",e.LAYER_CHANGED="layerchanged",e.HIERARCHY_LOADED="hierarchyloaded",e.RECOVERED="recovered",e.RELEASED="released",e.LINK="link",e.LABEL="label",e.FULL_SCREEN_CHANGE="fullscreenchange",e.DEVICE_LOST="devicelost",e.MESH_CHANGED="meshchanged",e.MATERIAL_CHANGED="materialchanged",e.WORLDMATRIX_NEEDCHANGE="worldmatrixneedchanged",e.ANIMATION_CHANGED="animationchanged",e.TRIGGER_ENTER="triggerenter",e.TRIGGER_STAY="triggerstay",e.TRIGGER_EXIT="triggerexit",e.TRAIL_FILTER_CHANGE="trailfilterchange",e.DOMINO_FILTER_CHANGE="dominofilterchange",e}(),g=(function(){function e(){}a(e,"laya.events.Keyboard"),e.NUMBER_0=48,e.NUMBER_1=49,e.NUMBER_2=50,e.NUMBER_3=51,e.NUMBER_4=52,e.NUMBER_5=53,e.NUMBER_6=54,e.NUMBER_7=55,e.NUMBER_8=56,e.NUMBER_9=57,e.A=65,e.B=66,e.C=67,e.D=68,e.E=69,e.F=70,e.G=71,e.H=72,e.I=73,e.J=74,e.K=75,e.L=76,e.M=77,e.N=78,e.O=79,e.P=80,e.Q=81,e.R=82,e.S=83,e.T=84,e.U=85,e.V=86,e.W=87,e.X=88,e.Y=89,e.Z=90,e.F1=112,e.F2=113,e.F3=114,e.F4=115,e.F5=116,e.F6=117,e.F7=118,e.F8=119,e.F9=120,e.F10=121,e.F11=122,e.F12=123,e.F13=124,e.F14=125,e.F15=126,e.NUMPAD=21,e.NUMPAD_0=96,e.NUMPAD_1=97,e.NUMPAD_2=98,e.NUMPAD_3=99,e.NUMPAD_4=100,e.NUMPAD_5=101,e.NUMPAD_6=102,e.NUMPAD_7=103,e.NUMPAD_8=104,e.NUMPAD_9=105,e.NUMPAD_ADD=107,e.NUMPAD_DECIMAL=110,e.NUMPAD_DIVIDE=111,e.NUMPAD_ENTER=108,e.NUMPAD_MULTIPLY=106,e.NUMPAD_SUBTRACT=109,e.SEMICOLON=186,e.EQUAL=187,e.COMMA=188,e.MINUS=189,e.PERIOD=190,e.SLASH=191,e.BACKQUOTE=192,e.LEFTBRACKET=219,e.BACKSLASH=220,e.RIGHTBRACKET=221,e.QUOTE=222,e.ALTERNATE=18,e.BACKSPACE=8,e.CAPS_LOCK=20,e.COMMAND=15,e.CONTROL=17,e.DELETE=46,e.ENTER=13,e.ESCAPE=27,e.PAGE_UP=33,e.PAGE_DOWN=34,e.END=35,e.HOME=36,e.LEFT=37,e.UP=38,e.RIGHT=39,e.DOWN=40,e.SHIFT=16,e.SPACE=32,e.TAB=9,e.INSERT=45}(),function(){function e(){}return a(e,"laya.events.KeyBoardManager"),e.__init__=function(){e._addEvent("keydown"),e._addEvent("keypress"),e._addEvent("keyup")},e._addEvent=function(e){O.document.addEventListener(e,function(t){laya.events.KeyBoardManager._dispatch(t,e)},!0)},e._dispatch=function(t,n){if(e.enabled){e._event._stoped=!1,e._event.nativeEvent=t,e._event.keyCode=t.keyCode||t.which||t.charCode,"keydown"===n?e._pressKeys[e._event.keyCode]=!0:"keyup"===n&&(e._pressKeys[e._event.keyCode]=null);for(var a=i.stage.focus&&null!=i.stage.focus.event&&i.stage.focus.displayedInStage?i.stage.focus:i.stage,r=a;r;)r.event(n,e._event.setTo(n,r,a)),r=r.parent}},e.hasKeyDown=function(t){return e._pressKeys[t]},e._pressKeys={},e.enabled=!0,n(e,["_event",function(){return this._event=new f}]),e}()),y=(function(){function e(){}a(e,"laya.events.KeyLocation"),e.STANDARD=0,e.LEFT=1,e.RIGHT=2,e.NUM_PAD=3}(),function(){function e(){this.mouseX=0,this.mouseY=0,this.disableMouseEvent=!1,this.mouseDownTime=0,this.mouseMoveAccuracy=2,this._stage=null,this._target=null,this._lastMoveTimer=0,this._isLeftMouse=!1,this._eventList=[],this._touchIDs={},this._id=1,this._tTouchID=0,this._event=new f,this._matrix=new M,this._point=new C,this._rect=new k,this._prePoint=new C,this._curTouchID=NaN}a(e,"laya.events.MouseManager");var t=e.prototype;return t.__init__=function(t,i){var n=this;this._stage=t;var a=this,r=this._eventList;i.oncontextmenu=function(t){if(e.enabled)return!1},i.addEventListener("mousedown",function(t){e.enabled&&(O.onIE||t.preventDefault(),r.push(t),a.mouseDownTime=O.now())}),i.addEventListener("mouseup",function(t){e.enabled&&(t.preventDefault(),r.push(t),a.mouseDownTime=-O.now())},!0),i.addEventListener("mousemove",function(t){if(e.enabled){t.preventDefault();var i=O.now();if(i-a._lastMoveTimer<10)return;a._lastMoveTimer=i,r.push(t)}},!0),i.addEventListener("mouseout",function(t){e.enabled&&r.push(t)}),i.addEventListener("mouseover",function(t){e.enabled&&r.push(t)}),i.addEventListener("touchstart",function(t){e.enabled&&(r.push(t),e._isFirstTouch||we.isInputting||t.preventDefault(),a.mouseDownTime=O.now())}),i.addEventListener("touchend",function(t){e.enabled?(e._isFirstTouch||we.isInputting||t.preventDefault(),e._isFirstTouch=!1,r.push(t),a.mouseDownTime=-O.now()):n._curTouchID=NaN},!0),i.addEventListener("touchmove",function(t){e.enabled&&(t.preventDefault(),r.push(t))},!0),i.addEventListener("touchcancel",function(t){e.enabled?(t.preventDefault(),r.push(t)):n._curTouchID=NaN},!0),i.addEventListener("mousewheel",function(t){e.enabled&&r.push(t)}),i.addEventListener("DOMMouseScroll",function(t){e.enabled&&r.push(t)})},t.initEvent=function(e,t){this._event._stoped=!1,this._event.nativeEvent=t||e,this._target=null,this._point.setTo(e.pageX||e.clientX,e.pageY||e.clientY),this._stage._canvasTransform.invertTransformPoint(this._point),this.mouseX=this._point.x,this.mouseY=this._point.y,this._event.touchId=e.identifier||0,this._tTouchID=this._event.touchId;var i;(i=v.I._event)._stoped=!1,i.nativeEvent=this._event.nativeEvent,i.touchId=this._event.touchId},t.checkMouseWheel=function(e){this._event.delta=e.wheelDelta?.025*e.wheelDelta:-e.detail;for(var t=v.I.getLastOvers(),i=0,n=t.length;i<n;i++){var a=t[i];a.event("mousewheel",this._event.setTo("mousewheel",a,this._target))}},t.onMouseMove=function(e){v.I.onMouseMove(e,this._tTouchID)},t.onMouseDown=function(e){if(we.isInputting&&i.stage.focus&&i.stage.focus.focus&&!i.stage.focus.contains(this._target)){var t=i.stage.focus._tf||i.stage.focus,n=e._tf||e;n instanceof laya.display.Input&&n.multiline==t.multiline?t._focusOut():t.focus=!1}v.I.onMouseDown(e,this._tTouchID,this._isLeftMouse)},t.onMouseUp=function(e){v.I.onMouseUp(e,this._tTouchID,this._isLeftMouse)},t.check=function(e,t,i,n){this._point.setTo(t,i),e.fromParentPoint(this._point),t=this._point.x,i=this._point.y;var a=e.scrollRect;if(a&&(this._rect.setTo(a.x,a.y,a.width,a.height),!this._rect.contains(t,i)))return!1;if(!this.disableMouseEvent){if(e.hitTestPrior&&!e.mouseThrough&&!this.hitTest(e,t,i))return!1;for(var r=e._childs.length-1;r>-1;r--){var o=e._childs[r];if(!o.destroyed&&o.mouseEnabled&&o.visible&&this.check(o,t,i,n))return!0}}var s=!(!e.hitTestPrior||e.mouseThrough||this.disableMouseEvent)||this.hitTest(e,t,i);return s?(this._target=e,n.call(this,e)):n===this.onMouseUp&&e===this._stage&&(this._target=this._stage,n.call(this,this._target)),s},t.hitTest=function(e,t,i){var n=!1;if(e.scrollRect&&(t-=e.scrollRect.x,i-=e.scrollRect.y),e.hitArea instanceof laya.utils.HitArea)return e.hitArea.isHit(t,i);if(e.width>0&&e.height>0||e.mouseThrough||e.hitArea)if(e.mouseThrough)n=e.getGraphicBounds().contains(t,i);else{var a=this._rect;e.hitArea?a=e.hitArea:a.setTo(0,0,e.width,e.height),n=a.contains(t,i)}return n},t.runEvent=function(){var t=this._eventList.length;if(t){for(var i,n=0,a=0,r=0;n<t;){var o=this._eventList[n];switch("mousemove"!==o.type&&(this._prePoint.x=this._prePoint.y=-1e6),o.type){case"mousedown":this._touchIDs[0]=this._id++,e._isTouchRespond?e._isTouchRespond=!1:(this._isLeftMouse=0===o.button,this.initEvent(o),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseDown));break;case"mouseup":this._isLeftMouse=0===o.button,this.initEvent(o),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseUp);break;case"mousemove":Math.abs(this._prePoint.x-o.clientX)+Math.abs(this._prePoint.y-o.clientY)>=this.mouseMoveAccuracy&&(this._prePoint.x=o.clientX,this._prePoint.y=o.clientY,this.initEvent(o),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseMove));break;case"touchstart":e._isTouchRespond=!0,this._isLeftMouse=!0;var s=o.changedTouches;for(a=0,r=s.length;a<r;a++)i=s[a],(e.multiTouchEnabled||isNaN(this._curTouchID))&&(this._curTouchID=i.identifier,this._id%200==0&&(this._touchIDs={}),this._touchIDs[i.identifier]=this._id++,this.initEvent(i,o),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseDown));break;case"touchend":case"touchcancel":e._isTouchRespond=!0,this._isLeftMouse=!0;var h=o.changedTouches;for(a=0,r=h.length;a<r;a++)if(i=h[a],e.multiTouchEnabled||i.identifier==this._curTouchID){this._curTouchID=NaN,this.initEvent(i,o);this.check(this._stage,this.mouseX,this.mouseY,this.onMouseUp)||this.onMouseUp(null)}break;case"touchmove":var l=o.changedTouches;for(a=0,r=l.length;a<r;a++)i=l[a],(e.multiTouchEnabled||i.identifier==this._curTouchID)&&(this.initEvent(i,o),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseMove));break;case"wheel":case"mousewheel":case"DOMMouseScroll":this.checkMouseWheel(o);break;case"mouseout":v.I.stageMouseOut();break;case"mouseover":this._stage.event("mouseover",this._event.setTo("mouseover",this._stage,this._stage))}n++}this._eventList.length=0}},e.enabled=!0,e.multiTouchEnabled=!0,e._isTouchRespond=!1,e._isFirstTouch=!0,n(e,["instance",function(){return this.instance=new e}]),e}()),v=function(){function e(){this.preOvers=[],this.preDowns=[],this.preRightDowns=[],this.enable=!0,this._lastClickTime=0,this._event=new f}a(e,"laya.events.TouchManager");var t=e.prototype;return t._clearTempArrs=function(){e._oldArr.length=0,e._newArr.length=0,e._tEleArr.length=0},t.getTouchFromArr=function(e,t){var i=0,n=0;n=t.length;var a;for(i=0;i<n;i++)if((a=t[i]).id==e)return a;return null},t.removeTouchFromArr=function(e,t){var i=0;for(i=t.length-1;i>=0;i--)t[i].id==e&&t.splice(i,1)},t.createTouchO=function(e,t){var i;return i=G.getItem("TouchData")||{},i.id=t,i.tar=e,i},t.onMouseDown=function(t,i,n){if(void 0===n&&(n=!1),this.enable){var a,r,o;a=this.getTouchFromArr(i,this.preOvers),o=this.getEles(t,null,e._tEleArr),a?a.tar=t:(r=this.createTouchO(t,i),this.preOvers.push(r)),O.onMobile&&this.sendEvents(o,"mouseover",i);var s;s=n?this.preDowns:this.preRightDowns,(a=this.getTouchFromArr(i,s))?a.tar=t:(r=this.createTouchO(t,i),s.push(r)),this.sendEvents(o,n?"mousedown":"rightmousedown",i),this._clearTempArrs()}},t.sendEvents=function(e,t,i){void 0===i&&(i=0);var n=0,a=0;a=e.length,this._event._stoped=!1;var r;r=e[0];var o;for(n=0;n<a;n++){if((o=e[n]).destroyed)return;if(o.event(t,this._event.setTo(t,o,r)),this._event._stoped)break}},t.getEles=function(e,t,i){for(i?i.length=0:i=[];e&&e!=t;)i.push(e),e=e.parent;return i},t.checkMouseOutAndOverOfMove=function(t,i,n){if(void 0===n&&(n=0),i!=t){var a,r,o=0,s=0;if(i.contains(t))r=this.getEles(t,i,e._tEleArr),this.sendEvents(r,"mouseover",n);else if(t.contains(i))r=this.getEles(i,t,e._tEleArr),this.sendEvents(r,"mouseout",n);else{(r=e._tEleArr).length=0;var h;h=this.getEles(i,null,e._oldArr);var l;l=this.getEles(t,null,e._newArr),s=h.length;var c=0;for(o=0;o<s;o++){if(a=h[o],(c=l.indexOf(a))>=0){l.splice(c,l.length-c);break}r.push(a)}r.length>0&&this.sendEvents(r,"mouseout",n),l.length>0&&this.sendEvents(l,"mouseover",n)}}},t.onMouseMove=function(t,i){if(this.enable){var n,a;(n=this.getTouchFromArr(i,this.preOvers))?(this.checkMouseOutAndOverOfMove(t,n.tar),n.tar=t,a=this.getEles(t,null,e._tEleArr)):(a=this.getEles(t,null,e._tEleArr),this.sendEvents(a,"mouseover",i),this.preOvers.push(this.createTouchO(t,i))),this.sendEvents(a,"mousemove",i),this._clearTempArrs()}},t.getLastOvers=function(){return e._tEleArr.length=0,this.preOvers.length>0&&this.preOvers[0].tar?this.getEles(this.preOvers[0].tar,null,e._tEleArr):(e._tEleArr.push(i.stage),e._tEleArr)},t.stageMouseOut=function(){var e;e=this.getLastOvers(),this.preOvers.length=0,this.sendEvents(e,"mouseout",0)},t.onMouseUp=function(t,i,n){if(void 0===n&&(n=!1),this.enable){var a,r,o,s,h,l=0,c=0,p=O.onMobile;r=this.getEles(t,null,e._tEleArr),this.sendEvents(r,n?"mouseup":"rightmouseup",i);var u;if(u=n?this.preDowns:this.preRightDowns,a=this.getTouchFromArr(i,u)){var d=!1,_=O.now();if(d=_-this._lastClickTime<300,this._lastClickTime=_,t==a.tar)h=r;else for(o=this.getEles(a.tar,null,e._oldArr),(h=e._newArr).length=0,c=o.length,l=0;l<c;l++)s=o[l],r.indexOf(s)>=0&&h.push(s);h.length>0&&this.sendEvents(h,n?"click":"rightclick",i),n&&d&&this.sendEvents(h,"doubleclick",i),this.removeTouchFromArr(i,u),a.tar=null,G.recover("TouchData",a)}else;(a=this.getTouchFromArr(i,this.preOvers))&&p&&((h=this.getEles(a.tar,null,h))&&h.length>0&&this.sendEvents(h,"mouseout",i),this.removeTouchFromArr(i,this.preOvers),a.tar=null,G.recover("TouchData",a)),this._clearTempArrs()}},e._oldArr=[],e._newArr=[],e._tEleArr=[],n(e,["I",function(){return this.I=new e}]),e}(),x=function(){function e(){this._action=null}a(e,"laya.filters.Filter");var t=e.prototype;return i.imps(t,{"laya.filters.IFilter":!0}),t.callNative=function(e){},r(0,t,"type",function(){return-1}),r(0,t,"action",function(){return this._action}),e.BLUR=16,e.COLOR=32,e.GLOW=8,e._filterStart=null,e._filterEnd=null,e._EndTarget=null,e._recycleScope=null,e._filter=null,e._useSrc=null,e._endSrc=null,e._useOut=null,e._endOut=null,e}(),b=function(){function e(){this.data=null}a(e,"laya.filters.ColorFilterAction");var t=e.prototype;return i.imps(t,{"laya.filters.IFilterAction":!0}),t.apply=function(e){var t=e.ctx.ctx,i=e.ctx.ctx.canvas;if(0==i.width||0==i.height)return i;for(var n,a=t.getImageData(0,0,i.width,i.height),r=a.data,o=0,s=r.length;o<s;o+=4)n=this.getColor(r[o],r[o+1],r[o+2],r[o+3]),0!=r[o+3]&&(r[o]=n[0],r[o+1]=n[1],r[o+2]=n[2],r[o+3]=n[3]);return t.putImageData(a,0,0),e},t.getColor=function(e,t,i,n){var a=[];if(this.data._mat&&this.data._alpha){var r=this.data._mat,o=this.data._alpha;a[0]=r[0]*e+r[1]*t+r[2]*i+r[3]*n+o[0],a[1]=r[4]*e+r[5]*t+r[6]*i+r[7]*n+o[1],a[2]=r[8]*e+r[9]*t+r[10]*i+r[11]*n+o[2],a[3]=r[12]*e+r[13]*t+r[14]*i+r[15]*n+o[3]}return a},e}(),w=(function(){function e(){}a(e,"laya.maths.Arith"),e.formatR=function(e){return e>Math.PI&&(e-=2*Math.PI),e<-Math.PI&&(e+=2*Math.PI),e},e.isPOT=function(e,t){return e>0&&0==(e&e-1)&&t>0&&0==(t&t-1)},e.setMatToArray=function(e,t){e.a,e.b,e.c,e.d,e.tx,e.ty,t[0]=e.a,t[1]=e.b,t[4]=e.c,t[5]=e.d,t[12]=e.tx,t[13]=e.ty}}(),function(){function e(){this._controlPoints=[new C,new C,new C],this._calFun=this.getPoint2}a(e,"laya.maths.Bezier");var t=e.prototype;return t._switchPoint=function(e,t){var i=this._controlPoints.shift();i.setTo(e,t),this._controlPoints.push(i)},t.getPoint2=function(e,t){var i=this._controlPoints[0],n=this._controlPoints[1],a=this._controlPoints[2],r=Math.pow(1-e,2)*i.x+2*e*(1-e)*n.x+Math.pow(e,2)*a.x,o=Math.pow(1-e,2)*i.y+2*e*(1-e)*n.y+Math.pow(e,2)*a.y;t.push(r,o)},t.getPoint3=function(e,t){var i=this._controlPoints[0],n=this._controlPoints[1],a=this._controlPoints[2],r=this._controlPoints[3],o=Math.pow(1-e,3)*i.x+3*n.x*e*(1-e)*(1-e)+3*a.x*e*e*(1-e)+r.x*Math.pow(e,3),s=Math.pow(1-e,3)*i.y+3*n.y*e*(1-e)*(1-e)+3*a.y*e*e*(1-e)+r.y*Math.pow(e,3);t.push(o,s)},t.insertPoints=function(e,t){var i=NaN,n=NaN;for(n=1/(e=e>0?e:5),i=0;i<=1;i+=n)this._calFun(i,t)},t.getBezierPoints=function(e,t,i){void 0===t&&(t=5),void 0===i&&(i=2);var n=0,a=0;if((a=e.length)<2*(i+1))return[];var r;switch(r=[],i){case 2:this._calFun=this.getPoint2;break;case 3:this._calFun=this.getPoint3;break;default:return[]}for(;this._controlPoints.length<=i;)this._controlPoints.push(new C);for(n=0;n<2*i;n+=2)this._switchPoint(e[n],e[n+1]);for(n=2*i;n<a;n+=2)this._switchPoint(e[n],e[n+1]),n/2%i==0&&this.insertPoints(t,r);return r},n(e,["I",function(){return this.I=new e}]),e}()),S=function(){function e(){}return a(e,"laya.maths.GrahamScan"),e.multiply=function(e,t,i){return(e.x-i.x)*(t.y-i.y)-(t.x-i.x)*(e.y-i.y)},e.dis=function(e,t){return(e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y)},e._getPoints=function(t,i,n){for(void 0===i&&(i=!1),e._mPointList||(e._mPointList=[]);e._mPointList.length<t;)e._mPointList.push(new C);return n||(n=[]),n.length=0,i?e.getFrom(n,e._mPointList,t):e.getFromR(n,e._mPointList,t),n},e.getFrom=function(e,t,i){var n=0;for(n=0;n<i;n++)e.push(t[n]);return e},e.getFromR=function(e,t,i){var n=0;for(n=0;n<i;n++)e.push(t.pop());return e},e.pListToPointList=function(t,i){void 0===i&&(i=!1);var n=0,a=t.length/2,r=e._getPoints(a,i,e._tempPointList);for(n=0;n<a;n++)r[n].setTo(t[n+n],t[n+n+1]);return r},e.pointListToPlist=function(t){var i,n=0,a=t.length,r=e._temPList;for(r.length=0,n=0;n<a;n++)i=t[n],r.push(i.x,i.y);return r},e.scanPList=function(t){return K.copyArray(t,e.pointListToPlist(e.scan(e.pListToPointList(t,!0))))},e.scan=function(t){var i,n,a,r=0,o=0,s=0,h=t.length,l={};for((n=e._temArr).length=0,r=(h=t.length)-1;r>=0;r--)a=(i=t[r]).x+"_"+i.y,l.hasOwnProperty(a)||(l[a]=!0,n.push(i));for(h=n.length,K.copyArray(t,n),r=1;r<h;r++)(t[r].y<t[s].y||t[r].y==t[s].y&&t[r].x<t[s].x)&&(s=r);for(i=t[0],t[0]=t[s],t[s]=i,r=1;r<h-1;r++){for(s=r,o=r+1;o<h;o++)(e.multiply(t[o],t[s],t[0])>0||0==e.multiply(t[o],t[s],t[0])&&e.dis(t[0],t[o])<e.dis(t[0],t[s]))&&(s=o);i=t[r],t[r]=t[s],t[s]=i}if(n=e._temArr,n.length=0,t.length<3)return K.copyArray(n,t);for(n.push(t[0],t[1],t[2]),r=3;r<h;r++){for(;n.length>=2&&e.multiply(t[r],n[n.length-1],n[n.length-2])>=0;)n.pop();t[r]&&n.push(t[r])}return n},e._mPointList=null,e._tempPointList=[],e._temPList=[],e._temArr=[],e}(),I=function(){function e(){}return a(e,"laya.maths.MathUtil"),e.subtractVector3=function(e,t,i){i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2]},e.lerp=function(e,t,i){return e*(1-i)+t*i},e.scaleVector3=function(e,t,i){i[0]=e[0]*t,i[1]=e[1]*t,i[2]=e[2]*t},e.lerpVector3=function(e,t,i,n){var a=e[0],r=e[1],o=e[2];n[0]=a+i*(t[0]-a),n[1]=r+i*(t[1]-r),n[2]=o+i*(t[2]-o)},e.lerpVector4=function(e,t,i,n){var a=e[0],r=e[1],o=e[2],s=e[3];n[0]=a+i*(t[0]-a),n[1]=r+i*(t[1]-r),n[2]=o+i*(t[2]-o),n[3]=s+i*(t[3]-s)},e.slerpQuaternionArray=function(e,t,i,n,a,r,o){var s,h,l,c,p,u=e[t+0],d=e[t+1],_=e[t+2],m=e[t+3],f=i[n+0],g=i[n+1],y=i[n+2],v=i[n+3];return(h=u*f+d*g+_*y+m*v)<0&&(h=-h,f=-f,g=-g,y=-y,v=-v),1-h>1e-6?(s=Math.acos(h),l=Math.sin(s),c=Math.sin((1-a)*s)/l,p=Math.sin(a*s)/l):(c=1-a,p=a),r[o+0]=c*u+p*f,r[o+1]=c*d+p*g,r[o+2]=c*_+p*y,r[o+3]=c*m+p*v,r},e.getRotation=function(e,t,i,n){return Math.atan2(n-t,i-e)/Math.PI*180},e.sortBigFirst=function(e,t){return e==t?0:t>e?1:-1},e.sortSmallFirst=function(e,t){return e==t?0:t>e?-1:1},e.sortNumBigFirst=function(e,t){return parseFloat(t)-parseFloat(e)},e.sortNumSmallFirst=function(e,t){return parseFloat(e)-parseFloat(t)},e.sortByKey=function(t,i,n){void 0===i&&(i=!1),void 0===n&&(n=!0);var a;return a=i?n?e.sortNumBigFirst:e.sortBigFirst:n?e.sortNumSmallFirst:e.sortSmallFirst,function(e,i){return a(e[t],i[t])}},e}(),M=function(){function e(e,t,i,n,a,r){this.inPool=!1,this.bTransform=!1,void 0===e&&(e=1),void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=1),void 0===a&&(a=0),void 0===r&&(r=0),this.a=e,this.b=t,this.c=i,this.d=n,this.tx=a,this.ty=r,this._checkTransform()}a(e,"laya.maths.Matrix");var t=e.prototype;return t.identity=function(){return this.a=this.d=1,this.b=this.tx=this.ty=this.c=0,this.bTransform=!1,this},t._checkTransform=function(){return this.bTransform=1!==this.a||0!==this.b||0!==this.c||1!==this.d},t.setTranslate=function(e,t){return this.tx=e,this.ty=t,this},t.translate=function(e,t){return this.tx+=e,this.ty+=t,this},t.scale=function(e,t){this.a*=e,this.d*=t,this.c*=e,this.b*=t,this.tx*=e,this.ty*=t,this.bTransform=!0},t.rotate=function(e){var t=Math.cos(e),i=Math.sin(e),n=this.a,a=this.c,r=this.tx;this.a=n*t-this.b*i,this.b=n*i+this.b*t,this.c=a*t-this.d*i,this.d=a*i+this.d*t,this.tx=r*t-this.ty*i,this.ty=r*i+this.ty*t,this.bTransform=!0},t.skew=function(e,t){var i=Math.tan(e),n=Math.tan(t),a=this.a,r=this.b;return this.a+=n*this.c,this.b+=n*this.d,this.c+=i*a,this.d+=i*r,this},t.invertTransformPoint=function(e){var t=this.a,i=this.b,n=this.c,a=this.d,r=this.tx,o=t*a-i*n,s=a/o,h=-i/o,l=-n/o,c=t/o,p=(n*this.ty-a*r)/o,u=-(t*this.ty-i*r)/o;return e.setTo(s*e.x+l*e.y+p,h*e.x+c*e.y+u)},t.transformPoint=function(e){return e.setTo(this.a*e.x+this.c*e.y+this.tx,this.b*e.x+this.d*e.y+this.ty)},t.transformPointN=function(e){return e.setTo(this.a*e.x+this.c*e.y,this.b*e.x+this.d*e.y)},t.transformPointArray=function(e,t){for(var i=e.length,n=0;n<i;n+=2){var a=e[n],r=e[n+1];t[n]=this.a*a+this.c*r+this.tx,t[n+1]=this.b*a+this.d*r+this.ty}return t},t.transformPointArrayScale=function(e,t){for(var i=e.length,n=0;n<i;n+=2){var a=e[n],r=e[n+1];t[n]=this.a*a+this.c*r,t[n+1]=this.b*a+this.d*r}return t},t.getScaleX=function(){return 0===this.b?this.a:Math.sqrt(this.a*this.a+this.b*this.b)},t.getScaleY=function(){return 0===this.c?this.d:Math.sqrt(this.c*this.c+this.d*this.d)},t.invert=function(){var e=this.a,t=this.b,i=this.c,n=this.d,a=this.tx,r=e*n-t*i;return this.a=n/r,this.b=-t/r,this.c=-i/r,this.d=e/r,this.tx=(i*this.ty-n*a)/r,this.ty=-(e*this.ty-t*a)/r,this},t.setTo=function(e,t,i,n,a,r){return this.a=e,this.b=t,this.c=i,this.d=n,this.tx=a,this.ty=r,this},t.concat=function(e){var t=this.a,i=this.c,n=this.tx;return this.a=t*e.a+this.b*e.c,this.b=t*e.b+this.b*e.d,this.c=i*e.a+this.d*e.c,this.d=i*e.b+this.d*e.d,this.tx=n*e.a+this.ty*e.c+e.tx,this.ty=n*e.b+this.ty*e.d+e.ty,this},t.scaleEx=function(e,t){var i=this.a,n=this.b,a=this.c,r=this.d;0!==n||0!==a?(this.a=e*i,this.b=e*n,this.c=t*a,this.d=t*r):(this.a=e*i,this.b=0*r,this.c=0*i,this.d=t*r),this.bTransform=!0},t.rotateEx=function(e){var t=Math.cos(e),i=Math.sin(e),n=this.a,a=this.b,r=this.c,o=this.d;0!==a||0!==r?(this.a=t*n+i*r,this.b=t*a+i*o,this.c=-i*n+t*r,this.d=-i*a+t*o):(this.a=t*n,this.b=i*o,this.c=-i*n,this.d=t*o),this.bTransform=!0},t.clone=function(){var t=e.create();return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t.bTransform=this.bTransform,t},t.copyTo=function(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e.bTransform=this.bTransform,e},t.toString=function(){return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty},t.destroy=function(){if(!this.inPool){var t=e._cache;this.inPool=!0,t._length||(t._length=0),t[t._length++]=this,this.a=this.d=1,this.b=this.c=this.tx=this.ty=0,this.bTransform=!1}},e.mul=function(e,t,i){var n=e.a,a=e.b,r=e.c,o=e.d,s=e.tx,h=e.ty,l=t.a,c=t.b,p=t.c,u=t.d,d=t.tx,_=t.ty;return 0!==c||0!==p?(i.a=n*l+a*p,i.b=n*c+a*u,i.c=r*l+o*p,i.d=r*c+o*u,i.tx=l*s+p*h+d,i.ty=c*s+u*h+_):(i.a=n*l,i.b=a*u,i.c=r*l,i.d=o*u,i.tx=l*s+d,i.ty=u*h+_),i},e.mul16=function(e,t,i){var n=e.a,a=e.b,r=e.c,o=e.d,s=e.tx,h=e.ty,l=t.a,c=t.b,p=t.c,u=t.d,d=t.tx,_=t.ty;return 0!==c||0!==p?(i[0]=n*l+a*p,i[1]=n*c+a*u,i[4]=r*l+o*p,i[5]=r*c+o*u,i[12]=l*s+p*h+d,i[13]=c*s+u*h+_):(i[0]=n*l,i[1]=a*u,i[4]=r*l,i[5]=o*u,i[12]=l*s+d,i[13]=u*h+_),i},e.mulPre=function(e,t,i,n,a,r,o,s){var h=e.a,l=e.b,c=e.c,p=e.d,u=e.tx,d=e.ty;return 0!==i||0!==n?(s.a=h*t+l*n,s.b=h*i+l*a,s.c=c*t+p*n,s.d=c*i+p*a,s.tx=t*u+n*d+r,s.ty=i*u+a*d+o):(s.a=h*t,s.b=l*a,s.c=c*t,s.d=p*a,s.tx=t*u+r,s.ty=a*d+o),s},e.mulPos=function(e,t,i,n,a,r,o,s){var h=e.a,l=e.b,c=e.c,p=e.d,u=e.tx,d=e.ty;return 0!==l||0!==c?(s.a=t*h+i*c,s.b=t*l+i*p,s.c=n*h+a*c,s.d=n*l+a*p,s.tx=h*r+c*o+u,s.ty=l*r+p*o+d):(s.a=t*h,s.b=i*p,s.c=n*h,s.d=a*p,s.tx=h*r+u,s.ty=p*o+d),s},e.preMul=function(e,t,i){var n=e.a,a=e.b,r=e.c,o=e.d,s=t.a,h=t.b,l=t.c,c=t.d,p=t.tx,u=t.ty;return i.a=s*n,i.b=i.c=0,i.d=c*o,i.tx=p*n+e.tx,i.ty=u*o+e.ty,0===h&&0===l&&0===a&&0===r||(i.a+=h*r,i.d+=l*a,i.b+=s*a+h*o,i.c+=l*n+c*r,i.tx+=u*r,i.ty+=p*a),i},e.preMulXY=function(e,t,i,n){var a=e.a,r=e.b,o=e.c,s=e.d;return n.a=a,n.b=r,n.c=o,n.d=s,n.tx=t*a+e.tx+i*o,n.ty=i*s+e.ty+t*r,n},e.create=function(){var t=e._cache,i=t._length?t[--t._length]:new e;return i.inPool=!1,i},e.EMPTY=new e,e.TEMP=new e,e._cache=[],e}(),C=function(){function e(e,t){void 0===e&&(e=0),void 0===t&&(t=0),this.x=e,this.y=t}a(e,"laya.maths.Point");var t=e.prototype;return t.setTo=function(e,t){return this.x=e,this.y=t,this},t.distance=function(e,t){return Math.sqrt((this.x-e)*(this.x-e)+(this.y-t)*(this.y-t))},t.toString=function(){return this.x+","+this.y},t.normalize=function(){var e=Math.sqrt(this.x*this.x+this.y*this.y);if(e>0){var t=1/e;this.x*=t,this.y*=t}},e.TEMP=new e,e.EMPTY=new e,e}(),k=function(){function e(e,t,i,n){void 0===e&&(e=0),void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=0),this.x=e,this.y=t,this.width=i,this.height=n}a(e,"laya.maths.Rectangle");var t=e.prototype;return t.setTo=function(e,t,i,n){return this.x=e,this.y=t,this.width=i,this.height=n,this},t.copyFrom=function(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this},t.contains=function(e,t){return!(this.width<=0||this.height<=0)&&(e>=this.x&&e<this.right&&t>=this.y&&t<this.bottom)},t.intersects=function(e){return!(e.x>this.x+this.width||e.x+e.width<this.x||e.y>this.y+this.height||e.y+e.height<this.y)},t.intersection=function(t,i){return this.intersects(t)?(i||(i=new e),i.x=Math.max(this.x,t.x),i.y=Math.max(this.y,t.y),i.width=Math.min(this.right,t.right)-i.x,i.height=Math.min(this.bottom,t.bottom)-i.y,i):null},t.union=function(t,i){return i||(i=new e),this.clone(i),t.width<=0||t.height<=0?i:(i.addPoint(t.x,t.y),i.addPoint(t.right,t.bottom),this)},t.clone=function(t){return t||(t=new e),t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},t.toString=function(){return this.x+","+this.y+","+this.width+","+this.height},t.equals=function(e){return!(!e||e.x!==this.x||e.y!==this.y||e.width!==this.width||e.height!==this.height)},t.addPoint=function(e,t){return this.x>e&&(this.width+=this.x-e,this.x=e),this.y>t&&(this.height+=this.y-t,this.y=t),this.width<e-this.x&&(this.width=e-this.x),this.height<t-this.y&&(this.height=t-this.y),this},t._getBoundPoints=function(){var t=e._temB;return t.length=0,0==this.width||0==this.height?t:(t.push(this.x,this.y,this.x+this.width,this.y,this.x,this.y+this.height,this.x+this.width,this.y+this.height),t)},t.isEmpty=function(){return this.width<=0||this.height<=0},r(0,t,"right",function(){return this.x+this.width}),r(0,t,"bottom",function(){return this.y+this.height}),e._getBoundPointS=function(t,i,n,a){var r=e._temA;return r.length=0,0==n||0==a?r:(r.push(t,i,t+n,i,t,i+a,t+n,i+a),r)},e._getWrapRec=function(t,i){if(!t||t.length<1)return i?i.setTo(0,0,0,0):e.TEMP.setTo(0,0,0,0);i=i||new e;var n,a,r,o,s,h=t.length,l=C.TEMP;for(r=s=-(a=o=99999),n=0;n<h;n+=2)l.x=t[n],l.y=t[n+1],a=a<l.x?a:l.x,o=o<l.y?o:l.y,r=r>l.x?r:l.x,s=s>l.y?s:l.y;return i.setTo(a,o,r-a,s-o)},e.EMPTY=new e,e.TEMP=new e,e._temB=[],e._temA=[],e}(),E=function(){function e(){}return a(e,"laya.media.SoundManager"),r(1,e,"useAudioMusic",function(){return e._useAudioMusic},function(t){e._useAudioMusic=t,e._musicClass=t?te:null}),r(1,e,"autoStopMusic",function(){return e._autoStopMusic},function(t){i.stage.off("blur",null,e._stageOnBlur),i.stage.off("focus",null,e._stageOnFocus),i.stage.off("visibilitychange",null,e._visibilityChange),e._autoStopMusic=t,t&&(i.stage.on("blur",null,e._stageOnBlur),i.stage.on("focus",null,e._stageOnFocus),i.stage.on("visibilitychange",null,e._visibilityChange))}),r(1,e,"muted",function(){return e._muted},function(t){t!=e._muted&&(t&&e.stopAllSound(),e.musicMuted=t,e._muted=t)}),r(1,e,"musicMuted",function(){return e._musicMuted},function(t){t!=e._musicMuted&&(t?(e._tMusic&&e._musicChannel&&!e._musicChannel.isStopped?e._musicChannel.pause():e._musicChannel=null,e._musicMuted=t):(e._musicMuted=t,e._tMusic&&e._musicChannel&&e._musicChannel.resume()))}),r(1,e,"soundMuted",function(){return e._soundMuted},function(t){e._soundMuted=t}),e.addChannel=function(t){e._channels.indexOf(t)>=0||e._channels.push(t)},e.removeChannel=function(t){var i=0;for(i=e._channels.length-1;i>=0;i--)e._channels[i]==t&&e._channels.splice(i,1)},e.disposeSoundIfNotUsed=function(t){var i=0;for(i=e._channels.length-1;i>=0;i--)if(e._channels[i].url==t)return;e.destroySound(t)},e._visibilityChange=function(){i.stage.isVisibility?e._stageOnFocus():e._stageOnBlur()},e._stageOnBlur=function(){e._isActive=!1,e._musicChannel&&(e._musicChannel.isStopped||(e._blurPaused=!0,e._musicChannel.pause())),e.stopAllSound(),i.stage.once("mousedown",null,e._stageOnFocus)},e._recoverWebAudio=function(){ae.ctx&&"running"!=ae.ctx.state&&ae.ctx.resume()},e._stageOnFocus=function(){e._isActive=!0,e._recoverWebAudio(),i.stage.off("mousedown",null,e._stageOnFocus),e._blurPaused&&e._musicChannel&&e._musicChannel.isStopped&&(e._blurPaused=!1,e._musicChannel.resume())},e.playSound=function(t,n,a,r,o){if(void 0===n&&(n=1),void 0===o&&(o=0),!e._isActive||!t)return null;if(e._muted)return null;if(e._recoverWebAudio(),(t=D.formatURL(t))==e._tMusic){if(e._musicMuted)return null}else{if(N.isConchApp){var s=K.getFileExtension(t);if("wav"!=s&&"ogg"!=s)return alert("The sound only supports wav or ogg format,for optimal performance reason,please refer to the official website document."),null}if(e._soundMuted)return null}var h;O.onMiniGame||(h=i.loader.getRes(t)),r||(r=e._soundClass),h||((h=new r).load(t),oe.cacheRes(t,h));var l;return(l=h.play(o,n))?(l.url=t,l.volume=t==e._tMusic?e.musicVolume:e.soundVolume,l.completeHandler=a,l):null},e.destroySound=function(e){var t=i.loader.getRes(e);t&&(oe.clearRes(e),t.dispose())},e.playMusic=function(t,i,n,a){return void 0===i&&(i=0),void 0===a&&(a=0),t=D.formatURL(t),e._tMusic=t,e._musicChannel&&e._musicChannel.stop(),e._musicChannel=e.playSound(t,i,n,e._musicClass,a)},e.stopSound=function(t){t=D.formatURL(t);var i,n=0;for(n=e._channels.length-1;n>=0;n--)(i=e._channels[n]).url==t&&i.stop()},e.stopAll=function(){e._tMusic=null;var t=0;for(t=e._channels.length-1;t>=0;t--)e._channels[t].stop()},e.stopAllSound=function(){var t,i=0;for(i=e._channels.length-1;i>=0;i--)(t=e._channels[i]).url!=e._tMusic&&t.stop()},e.stopMusic=function(){e._musicChannel&&e._musicChannel.stop(),e._tMusic=null},e.setSoundVolume=function(t,i){if(i)i=D.formatURL(i),e._setVolume(i,t);else{e.soundVolume=t;var n,a=0;for(a=e._channels.length-1;a>=0;a--)(n=e._channels[a]).url!=e._tMusic&&(n.volume=t)}},e.setMusicVolume=function(t){e.musicVolume=t,e._setVolume(e._tMusic,t)},e._setVolume=function(t,i){t=D.formatURL(t);var n,a=0;for(a=e._channels.length-1;a>=0;a--)(n=e._channels[a]).url==t&&(n.volume=i)},e.musicVolume=1,e.soundVolume=1,e.playbackRate=1,e._useAudioMusic=!0,e._muted=!1,e._soundMuted=!1,e._musicMuted=!1,e._tMusic=null,e._musicChannel=null,e._channels=[],e._autoStopMusic=!1,e._blurPaused=!1,e._isActive=!0,e._soundClass=null,e._musicClass=null,e.autoReleaseSound=!0,e}(),T=function(){function t(){}var i;return a(t,"laya.net.LocalStorage"),t.__init__=function(){t._baseClass||(t._baseClass=i,i.init()),t.items=t._baseClass.items,t.support=t._baseClass.support},t.setItem=function(e,i){t._baseClass.setItem(e,i)},t.getItem=function(e){return t._baseClass.getItem(e)},t.setJSON=function(e,i){t._baseClass.setJSON(e,i)},t.getJSON=function(e){return t._baseClass.getJSON(e)},t.removeItem=function(e){t._baseClass.removeItem(e)},t.clear=function(){t._baseClass.clear()},t._baseClass=null,t.items=null,t.support=!1,t.__init$=function(){i=function(){function t(){}return a(t,""),t.init=function(){try{t.items=e.localStorage,t.setItem("laya","1"),t.removeItem("laya"),t.support=!0}catch(e){}t.support||console.log("LocalStorage is not supprot or browser is private mode.")},t.setItem=function(e,i){try{t.support&&t.items.setItem(e,i)}catch(e){console.warn("set localStorage failed",e)}},t.getItem=function(e){return t.support?t.items.getItem(e):null},t.setJSON=function(e,i){try{t.support&&t.items.setItem(e,JSON.stringify(i))}catch(e){console.warn("set localStorage failed",e)}},t.getJSON=function(e){return JSON.parse(t.support?t.items.getItem(e):null)},t.removeItem=function(e){t.support&&t.items.removeItem(e)},t.clear=function(){t.support&&t.items.clear()},t.items=null,t.support=!1,t}()},t}(),L=(function(){function e(){}a(e,"laya.net.ResourceVersion"),e.enable=function(t,n,a){void 0===a&&(a=2),laya.net.ResourceVersion.type=a,i.loader.load(t,l.create(null,e.onManifestLoaded,[n]),null,"json"),D.customFormat=e.addVersionPrefix},e.onManifestLoaded=function(t,i){e.manifest=i,t.run(),i||console.warn("资源版本清单文件不存在，不使用资源版本管理。忽略ERR_FILE_NOT_FOUND错误。")},e.addVersionPrefix=function(t){return e.manifest&&e.manifest[t]?2==e.type?e.manifest[t]:e.manifest[t]+"/"+t:t},e.FOLDER_VERSION=1,e.FILENAME_VERSION=2,e.manifest=null,e.type=1}(),function(){function e(){this.fontName=null,this.complete=null,this.err=null,this._fontTxt=null,this._url=null,this._div=null,this._txtWidth=NaN,this._http=null}a(e,"laya.net.TTFLoader");var t=e.prototype;return t.load=function(e){this._url=e;var t=e.split(".ttf")[0].split("/");this.fontName=t[t.length-1],O.window.conch?this._loadConch():O.window.FontFace?this._loadWithFontFace():this._loadWithCSS()},t._loadConch=function(){this._http=new re,this._http.on("error",this,this._onErr),this._http.on("complete",this,this._onHttpLoaded),this._http.send(this._url,null,"get","arraybuffer")},t._onHttpLoaded=function(e){O.window.conch.setFontFaceFromBuffer(this.fontName,e),this._clearHttp(),this._complete()},t._clearHttp=function(){this._http&&(this._http.off("error",this,this._onErr),this._http.off("complete",this,this._onHttpLoaded),this._http=null)},t._onErr=function(){this._clearHttp(),this.err&&(this.err.runWith("fail:"+this._url),this.err=null)},t._complete=function(){i.timer.clear(this,this._complete),i.timer.clear(this,this._checkComplete),this._div&&this._div.parentNode&&(this._div.parentNode.removeChild(this._div),this._div=null),this.complete&&(this.complete.runWith(this),this.complete=null)},t._checkComplete=function(){o.measureText("LayaTTFFont",this._fontTxt).width!=this._txtWidth&&this._complete()},t._loadWithFontFace=function(){var e=new O.window.FontFace(this.fontName,"url('"+this._url+"')");O.window.document.fonts.add(e);var t=this;e.loaded.then(function(){t._complete()}),e.load()},t._createDiv=function(){this._div=O.createElement("div"),this._div.innerHTML="laya";var e=this._div.style;e.fontFamily=this.fontName,e.position="absolute",e.left="-100px",e.top="-100px",O.document.body.appendChild(this._div)},t._loadWithCSS=function(){var e=this,t=O.createElement("style");t.type="text/css",O.document.body.appendChild(t),t.textContent="@font-face { font-family:'"+this.fontName+"'; src:url('"+this._url+"');}",this._fontTxt="40px "+this.fontName,this._txtWidth=o.measureText("LayaTTFFont",this._fontTxt).width;var n=this;t.onload=function(){i.timer.once(1e4,n,e._complete)},i.timer.loop(20,this,this._checkComplete),this._createDiv()},e._testString="LayaTTFFont",e}()),D=function(){function e(t){this._url=null,this._path=null,this._url=e.formatURL(t),this._path=e.getPath(t)}a(e,"laya.net.URL");var t=e.prototype;return r(0,t,"path",function(){return this._path}),r(0,t,"url",function(){return this._url}),e.formatURL=function(t,i){if(!t)return"null path";if(t.indexOf(":")>0)return t;null!=e.customFormat&&(t=e.customFormat(t,i));var n=t.charAt(0);if("."===n)return e.formatRelativePath((i||e.basePath)+t);if("~"===n)return e.rootPath+t.substring(1);if("d"===n){if(0===t.indexOf("data:image"))return t}else if("/"===n)return t;return(i||e.basePath)+t},e.formatRelativePath=function(e){for(var t=e.split("/"),i=0,n=t.length;i<n;i++)".."==t[i]&&(t.splice(i-1,2),i-=2);return t.join("/")},e.isAbsolute=function(e){return e.indexOf(":")>0||"/"==e.charAt(0)},e.getPath=function(e){var t=e.lastIndexOf("/");return t>0?e.substr(0,t+1):""},e.getPathcaps=function(e){var t=e.indexOf("/");if(t>0){var i=e.substr(0,t);return"v"==i[0]&&i.indexOf(".")>0&&("a"==i[i.length-1]||"w"==i[i.length-1])?this.getPath(e.substr(t+1)):this.getPath(e)}return this.getPath(e)},e.getFileName=function(e){var t=e.lastIndexOf("/");return t>0?e.substr(t+1):e},e.version={},e.basePath="",e.rootPath="",e.customFormat=function(t){var i=e.version[t];return!N.isConchApp&&i&&(t+="?v="+i),t},e}(),N=function(){function t(e,n){function a(){i.stage._loop(),O.window.requestAnimationFrame(a)}this._timeId=0;var r=t._mainCanvas.source.style;r.position="absolute",r.top=r.left="0px",r.background="#000000",t._mainCanvas.source.id="layaCanvas";var o=laya.renders.Render.isWebGL;t._mainCanvas.source.width=e,t._mainCanvas.source.height=n,o&&t.WebGL.init(t._mainCanvas,e,n),O.container.appendChild(t._mainCanvas.source),(t._context=new A(e,n,o?null:t._mainCanvas)).ctx.setIsMainContext(),O.window.requestAnimationFrame(a),i.stage.on("visibilitychange",this,this._onVisibilitychange)}a(t,"laya.renders.Render");var n=t.prototype;return n._onVisibilitychange=function(){i.stage.isVisibility?0!=this._timeId&&O.window.clearInterval(this._timeId):this._timeId=O.window.setInterval(this._enterFrame,1e3)},n._enterFrame=function(e){i.stage._loop()},r(1,t,"context",function(){return t._context}),r(1,t,"canvas",function(){return t._mainCanvas.source}),t._context=null,t._mainCanvas=null,t.WebGL=null,t.isConchNode=!1,t.isConchApp=!1,t.isConchWebGL=!1,t.isWebGL=!1,t.is3DMode=!1,t.optimizeTextureMemory=function(e,t){return!0},t.__init$=function(){e.ConchRenderType=e.ConchRenderType||1,e.ConchRenderType|=e.conch?4:0,t.isConchNode=5==(5&e.ConchRenderType),t.isConchApp=4==(4&e.ConchRenderType),t.isConchWebGL=6==e.ConchRenderType},t}(),A=function(){function e(t,i,n){this.x=0,this.y=0,this._drawTexture=function(e,t,i){i[0].loaded&&this.ctx.drawTexture(i[0],i[1],i[2],i[3],i[4],e,t)},this._fillTexture=function(e,t,i){i[0].loaded&&this.ctx.fillTexture(i[0],i[1]+e,i[2]+t,i[3],i[4],i[5],i[6],i[7])},this._drawTextureWithTransform=function(e,t,i){i[0].loaded&&this.ctx.drawTextureWithTransform(i[0],i[1],i[2],i[3],i[4],i[5],e,t,i[6])},this._fillQuadrangle=function(e,t,i){this.ctx.fillQuadrangle(i[0],i[1],i[2],i[3],i[4])},this._drawRect=function(e,t,i){var n=this.ctx;null!=i[4]&&(n.fillStyle=i[4],n.fillRect(e+i[0],t+i[1],i[2],i[3],null)),null!=i[5]&&(n.strokeStyle=i[5],n.lineWidth=i[6],n.strokeRect(e+i[0],t+i[1],i[2],i[3],i[6]))},this._drawPie=function(e,t,i){var n=this.ctx;N.isWebGL&&n.setPathId(i[8]),n.beginPath(),N.isWebGL?(n.movePath(i[0]+e,i[1]+t),n.moveTo(0,0)):n.moveTo(e+i[0],t+i[1]),n.arc(e+i[0],t+i[1],i[2],i[3],i[4]),n.closePath(),this._fillAndStroke(i[5],i[6],i[7],!0)},this._clipRect=function(e,t,i){this.ctx.clipRect(e+i[0],t+i[1],i[2],i[3])},this._fillRect=function(e,t,i){this.ctx.fillRect(e+i[0],t+i[1],i[2],i[3],i[4])},this._drawCircle=function(t,i,n){var a=this.ctx;N.isWebGL&&a.setPathId(n[6]),j.drawCall++,a.beginPath(),N.isWebGL&&a.movePath(n[0]+t,n[1]+i),a.arc(n[0]+t,n[1]+i,n[2],0,e.PI2),a.closePath(),this._fillAndStroke(n[3],n[4],n[5],!0)},this._fillCircle=function(t,i,n){j.drawCall++;var a=this.ctx;a.beginPath(),a.fillStyle=n[3],a.arc(n[0]+t,n[1]+i,n[2],0,e.PI2),a.fill()},this._setShader=function(e,t,i){this.ctx.setShader(i[0])},this._drawLine=function(e,t,i){var n=this.ctx;N.isWebGL&&n.setPathId(i[6]),n.beginPath(),n.strokeStyle=i[4],n.lineWidth=i[5],N.isWebGL?(n.movePath(e,t),n.moveTo(i[0],i[1]),n.lineTo(i[2],i[3])):(n.moveTo(e+i[0],t+i[1]),n.lineTo(e+i[2],t+i[3])),n.stroke()},this._drawLines=function(e,t,i){var n=this.ctx;N.isWebGL&&n.setPathId(i[5]),n.beginPath(),e+=i[0],t+=i[1],N.isWebGL&&n.movePath(e,t),n.strokeStyle=i[3],n.lineWidth=i[4];var a=i[2],r=2,o=a.length;if(N.isWebGL)for(n.moveTo(a[0],a[1]);r<o;)n.lineTo(a[r++],a[r++]);else for(n.moveTo(e+a[0],t+a[1]);r<o;)n.lineTo(e+a[r++],t+a[r++]);n.stroke()},this._drawLinesWebGL=function(e,t,i){this.ctx.drawLines(e+this.x+i[0],t+this.y+i[1],i[2],i[3],i[4])},this._drawCurves=function(e,t,i){this.ctx.drawCurves(e,t,i)},this._draw=function(e,t,i){i[0].call(null,this,e,t)},this._transformByMatrix=function(e,t,i){this.ctx.transformByMatrix(i[0])},this._setTransform=function(e,t,i){this.ctx.setTransform(i[0],i[1],i[2],i[3],i[4],i[5])},this._setTransformByMatrix=function(e,t,i){this.ctx.setTransformByMatrix(i[0])},this._save=function(e,t,i){this.ctx.save()},this._restore=function(e,t,i){this.ctx.restore()},this._translate=function(e,t,i){this.ctx.translate(i[0],i[1])},this._transform=function(e,t,i){this.ctx.translate(i[1]+e,i[2]+t);var n=i[0];this.ctx.transform(n.a,n.b,n.c,n.d,n.tx,n.ty),this.ctx.translate(-e-i[1],-t-i[2])},this._rotate=function(e,t,i){this.ctx.translate(i[1]+e,i[2]+t),this.ctx.rotate(i[0]),this.ctx.translate(-e-i[1],-t-i[2])},this._scale=function(e,t,i){this.ctx.translate(i[2]+e,i[3]+t),this.ctx.scale(i[0],i[1]),this.ctx.translate(-e-i[2],-t-i[3])},this._alpha=function(e,t,i){this.ctx.globalAlpha*=i[0]},this._setAlpha=function(e,t,i){this.ctx.globalAlpha=i[0]},this._fillText=function(e,t,i){this.ctx.fillText(i[0],i[1]+e,i[2]+t,i[3],i[4],i[5])},this._strokeText=function(e,t,i){this.ctx.strokeText(i[0],i[1]+e,i[2]+t,i[3],i[4],i[5],i[6])},this._fillBorderText=function(e,t,i){this.ctx.fillBorderText(i[0],i[1]+e,i[2]+t,i[3],i[4],i[5],i[6],i[7])},this._blendMode=function(e,t,i){this.ctx.globalCompositeOperation=i[0]},this._beginClip=function(e,t,i){this.ctx.beginClip&&this.ctx.beginClip(e+i[0],t+i[1],i[2],i[3])},this._setIBVB=function(e,t,i){this.ctx.setIBVB(i[0]+e,i[1]+t,i[2],i[3],i[4],i[5],i[6],i[7])},this._fillTrangles=function(e,t,i){this.ctx.fillTrangles(i[0],i[1]+e,i[2]+t,i[3],i[4])},this._drawPath=function(e,t,i){var n=this.ctx;N.isWebGL&&n.setPathId(-1),n.beginPath(),e+=i[0],t+=i[1],N.isWebGL&&n.movePath(e,t);for(var a=i[2],r=0,o=a.length;r<o;r++){var s=a[r];switch(s[0]){case"moveTo":N.isWebGL?n.moveTo(s[1],s[2]):n.moveTo(e+s[1],t+s[2]);break;case"lineTo":N.isWebGL?n.lineTo(s[1],s[2]):n.lineTo(e+s[1],t+s[2]);break;case"arcTo":N.isWebGL?n.arcTo(s[1],s[2],s[3],s[4],s[5]):n.arcTo(e+s[1],t+s[2],e+s[3],t+s[4],s[5]);break;case"closePath":n.closePath()}}var h=i[3];null!=h&&(n.fillStyle=h.fillStyle,n.fill());var l=i[4];null!=l&&(n.strokeStyle=l.strokeStyle,n.lineWidth=l.lineWidth||1,n.lineJoin=l.lineJoin,n.lineCap=l.lineCap,n.miterLimit=l.miterLimit,n.stroke())},this.drawPoly=function(e,t,i){this.ctx.drawPoly(e+this.x+i[0],t+this.y+i[1],i[2],i[3],i[4],i[5],i[6])},this._drawPoly=function(e,t,i){var n=this.ctx,a=i[2],r=2,o=a.length;if(N.isWebGL)for(n.setPathId(i[6]),n.beginPath(),e+=i[0],t+=i[1],n.movePath(e,t),n.moveTo(a[0],a[1]);r<o;)n.lineTo(a[r++],a[r++]);else for(n.beginPath(),e+=i[0],t+=i[1],n.moveTo(e+a[0],t+a[1]);r<o;)n.lineTo(e+a[r++],t+a[r++]);n.closePath(),this._fillAndStroke(i[3],i[4],i[5],i[7])},this._drawSkin=function(e,t,i){var n=i[0];if(n){var a=this.ctx;n.render(a,e,t)}},this._drawParticle=function(e,t,i){this.ctx.drawParticle(e+this.x,t+this.y,i[0])},this._setFilters=function(e,t,i){this.ctx.setFilters(i)},n?this.ctx=n.getContext("2d"):(n=xe.create("3D"),this.ctx=o.createWebGLContext2D(n),n._setContext(this.ctx)),n.size(t,i),this.canvas=n}a(e,"laya.renders.RenderContext");var t=e.prototype;return t.destroy=function(){this.canvas&&(this.canvas.destroy(),this.canvas=null,this.ctx=null),this.ctx&&(this.ctx.destroy(),this.ctx=null)},t.drawTexture=function(e,t,i,n,a){e.loaded&&this.ctx.drawTexture(e,t,i,n,a,this.x,this.y)},t._drawTextures=function(e,t,i){i[0].loaded&&this.ctx.drawTextures(i[0],i[1],e+this.x,t+this.y)},t.drawTextureWithTransform=function(e,t,i,n,a,r,o){e.loaded&&this.ctx.drawTextureWithTransform(e,t,i,n,a,r,this.x,this.y,o)},t.fillQuadrangle=function(e,t,i,n,a){this.ctx.fillQuadrangle(e,t,i,n,a)},t.drawCanvas=function(e,t,i,n,a){this.ctx.drawCanvas(e,t+this.x,i+this.y,n,a)},t.drawRect=function(e,t,i,n,a,r){void 0===r&&(r=1);var o=this.ctx;o.strokeStyle=a,o.lineWidth=r,o.strokeRect(e+this.x,t+this.y,i,n,r)},t._fillAndStroke=function(e,t,i,n){void 0===n&&(n=!1);var a=this.ctx;null!=e&&(a.fillStyle=e,N.isWebGL?a.fill(n):a.fill()),null!=t&&i>0&&(a.strokeStyle=t,a.lineWidth=i,a.stroke())},t.clipRect=function(e,t,i,n){this.ctx.clipRect(e+this.x,t+this.y,i,n)},t.fillRect=function(e,t,i,n,a){this.ctx.fillRect(e+this.x,t+this.y,i,n,a)},t.drawCircle=function(t,i,n,a,r){void 0===r&&(r=1),j.drawCall++;var o=this.ctx;o.beginPath(),o.strokeStyle=a,o.lineWidth=r,o.arc(t+this.x,i+this.y,n,0,e.PI2),o.stroke()},t.drawTriangles=function(e,t,i){if(N.isWebGL)this.ctx.drawTriangles(i[0],e+i[1],t+i[2],i[3],i[4],i[5],i[6],i[7],i[8],i[9]);else{var n=i[5],a=0,r=n.length,o=this.ctx;for(a=0;a<r;a+=3){var s=2*n[a],h=2*n[a+1],l=2*n[a+2];o.drawTriangle(i[0],i[3],i[4],s,h,l,i[6],!0)}}},t.fillCircle=function(t,i,n,a){j.drawCall++;var r=this.ctx;r.beginPath(),r.fillStyle=a,r.arc(t+this.x,i+this.y,n,0,e.PI2),r.fill()},t.setShader=function(e){this.ctx.setShader(e)},t.drawLine=function(e,t,i,n,a,r){void 0===r&&(r=1);var o=this.ctx;o.beginPath(),o.strokeStyle=a,o.lineWidth=r,o.moveTo(this.x+e,this.y+t),o.lineTo(this.x+i,this.y+n),o.stroke()},t.clear=function(){this.ctx.clear()},t.transformByMatrix=function(e){this.ctx.transformByMatrix(e)},t.setTransform=function(e,t,i,n,a,r){this.ctx.setTransform(e,t,i,n,a,r)},t.setTransformByMatrix=function(e){this.ctx.setTransformByMatrix(e)},t.save=function(){this.ctx.save()},t.restore=function(){this.ctx.restore()},t.translate=function(e,t){this.ctx.translate(e,t)},t.transform=function(e,t,i,n,a,r){this.ctx.transform(e,t,i,n,a,r)},t.rotate=function(e){this.ctx.rotate(e)},t.scale=function(e,t){this.ctx.scale(e,t)},t.alpha=function(e){this.ctx.globalAlpha*=e},t.setAlpha=function(e){this.ctx.globalAlpha=e},t.fillWords=function(e,t,i,n,a,r){void 0===r&&(r=0),this.ctx.fillWords(e,t,i,n,a,r)},t.fillBorderWords=function(e,t,i,n,a,r,o){this.ctx.fillBorderWords(e,t,i,n,a,r,o)},t.fillText=function(e,t,i,n,a,r){this.ctx.fillText(e,t+this.x,i+this.y,n,a,r)},t.strokeText=function(e,t,i,n,a,r,o){this.ctx.strokeText(e,t+this.x,i+this.y,n,a,r,o)},t.blendMode=function(e){this.ctx.globalCompositeOperation=e},t.flush=function(){this.ctx.flush&&this.ctx.flush()},t.addRenderObject=function(e){this.ctx.addRenderObject(e)},t.beginClip=function(e,t,i,n){this.ctx.beginClip&&this.ctx.beginClip(e,t,i,n)},t.endClip=function(){this.ctx.endClip&&this.ctx.endClip()},t.fillTrangles=function(e,t,i){this.ctx.fillTrangles(i[0],i[1],i[2],i[3],i.length>4?i[4]:null)},e.PI2=2*Math.PI,e}(),R=function(){function e(t,i){switch(this._next=i||e.NORENDER,t){case 0:return void(this._fun=this._no);case 1:return void(this._fun=this._image);case 2:return void(this._fun=this._alpha);case 4:return void(this._fun=this._transform);case 8:return void(this._fun=this._blend);case 16:return void(this._fun=this._canvas);case 64:return void(this._fun=this._mask);case 128:return void(this._fun=this._clip);case 256:return void(this._fun=this._style);case 512:return void(this._fun=this._graphics);case 2048:return void(this._fun=this._childs);case 1024:return void(this._fun=this._custom);case 513:case 517:return void(this._fun=this._image2);case 32:return void(this._fun=x._filter);case 69905:return void(this._fun=e._initRenderFun)}this.onCreate(t)}a(e,"laya.renders.RenderSprite");var t=e.prototype;return t.onCreate=function(e){},t._style=function(e,t,i,n){e._style.render(e,t,i,n);var a=this._next;a._fun.call(a,e,t,i,n)},t._no=function(e,t,i,n){},t._custom=function(e,t,i,n){e.customRender(t,i,n);var a=e._style._tf;this._next._fun.call(this._next,e,t,i-a.translateX,n-a.translateY)},t._clip=function(t,i,n,a){var r=this._next;if(r!=e.NORENDER){var o=t._style.scrollRect;i.ctx.save(),i.ctx.clipRect(n,a,o.width,o.height),r._fun.call(r,t,i,n-o.x,a-o.y),i.ctx.restore()}},t._blend=function(e,t,i,n){var a=e._style;a.blendMode&&(t.ctx.globalCompositeOperation=a.blendMode);var r=this._next;r._fun.call(r,e,t,i,n),t.ctx.globalCompositeOperation="source-over"},t._mask=function(e,t,i,n){var a=this._next;a._fun.call(a,e,t,i,n);var r=e.mask;r&&(t.ctx.globalCompositeOperation="destination-in",(r.numChildren>0||!r.graphics._isOnlyOne())&&(r.cacheAsBitmap=!0),r.render(t,i-e.pivotX,n-e.pivotY)),t.ctx.globalCompositeOperation="source-over"},t._graphics=function(e,t,i,n){var a=e._style._tf;e._graphics&&e._graphics._render(e,t,i-a.translateX,n-a.translateY);var r=this._next;r._fun.call(r,e,t,i,n)},t._image=function(e,t,i,n){var a=e._style;t.ctx.drawTexture2(i,n,a._tf.translateX,a._tf.translateY,e.transform,a.alpha,a.blendMode,e._graphics._one)},t._image2=function(e,t,i,n){var a=e._style._tf;t.ctx.drawTexture2(i,n,a.translateX,a.translateY,e.transform,1,null,e._graphics._one)},t._alpha=function(e,t,i,n){var a;if((a=e._style.alpha)>.01||e._needRepaint()){var r=t.ctx.globalAlpha;t.ctx.globalAlpha*=a;var o=this._next;o._fun.call(o,e,t,i,n),t.ctx.globalAlpha=r}},t._transform=function(t,i,n,a){var r=t.transform,o=this._next;r&&o!=e.NORENDER?(i.save(),i.transform(r.a,r.b,r.c,r.d,r.tx+n,r.ty+a),o._fun.call(o,t,i,0,0),i.restore()):o._fun.call(o,t,i,n,a)},t._childs=function(e,t,i,n){var a=e._style,r=a._tf;if(i=i-r.translateX+a.paddingLeft,n=n-r.translateY+a.paddingTop,a._calculation){var o=e._getWords();if(o){var s=a;s&&(s.stroke?t.fillBorderWords(o,i,n,s.font,s.color,s.strokeColor,s.stroke):t.fillWords(o,i,n,s.font,s.color,"none"!=s.textDecoration&&s.underLine?1:0))}}var h,l=e._childs,c=l.length;if(e.viewport||e.optimizeScrollRect&&e._style.scrollRect){var p=e.viewport||e._style.scrollRect,u=p.x,d=p.y,_=p.right,m=p.bottom,f=NaN,g=NaN;for(y=0;y<c;++y)(h=l[y]).visible&&(f=h._x)<_&&f+h.width>u&&(g=h._y)<m&&g+h.height>d&&h.render(t,i,n)}else for(var y=0;y<c;++y)(h=l[y])._style.visible&&h.render(t,i,n)},t._canvas=function(e,t,i,n){var a=e._$P.cacheCanvas;if(a){"bitmap"===a.type?j.canvasBitmap++:j.canvasNormal++;var r=a.ctx;if(e._needRepaint()||!r)this._canvas_repaint(e,t,i,n);else{var o=a._cacheRec;t.drawCanvas(r.canvas,i+o.x,n+o.y,o.width,o.height)}}else this._next._fun.call(this._next,e,t,i,n)},t._canvas_repaint=function(e,t,n,a){var r=e._$P.cacheCanvas,o=this._next;if(r){var s,h,l,c,p=r.ctx,u=e._needRepaint()||!p,d=r.type;if("bitmap"===d?j.canvasBitmap++:j.canvasNormal++,u){r._cacheRec||(r._cacheRec=new k);var _,m;N.isWebGL&&"bitmap"!==d?r._cacheRec.setTo(-e.pivotX,-e.pivotY,1,1):((c=e.getSelfBounds()).x=c.x-e.pivotX,c.y=c.y-e.pivotY,c.x=c.x-16,c.y=c.y-16,c.width=c.width+32,c.height=c.height+32,c.x=Math.floor(c.x+n)-n,c.y=Math.floor(c.y+a)-a,c.width=Math.floor(c.width),c.height=Math.floor(c.height),r._cacheRec.copyFrom(c)),c=r._cacheRec;var f=N.isWebGL?1:O.pixelRatio*i.stage.clientScaleX,g=N.isWebGL?1:O.pixelRatio*i.stage.clientScaleY;if(!N.isWebGL){var y,v=1,x=1;for(y=e;y&&y!=i.stage;)v*=y.scaleX,x*=y.scaleY,y=y.parent;N.isWebGL?(v<1&&(f*=v),x<1&&(g*=x)):(v>1&&(f*=v),x>1&&(g*=x))}if(e.scrollRect){var b=e.scrollRect;c.x-=b.x,c.y-=b.y}if(_=c.width*f,m=c.height*g,h=c.x,l=c.y,N.isWebGL&&"bitmap"===d&&(_>2048||m>2048))return console.warn("cache bitmap size larger than 2048,cache ignored"),r.ctx&&(G.recover("RenderContext",r.ctx),r.ctx.canvas.size(0,0),r.ctx=null),void o._fun.call(o,e,t,n,a);p||(p=r.ctx=G.getItem("RenderContext")||new A(_,m,xe.create("AUTO"))),p.ctx.sprite=e,(s=p.canvas).clear(),(s.width!=_||s.height!=m)&&s.size(_,m),"bitmap"===d?s.context.asBitmap=!0:"normal"===d&&(s.context.asBitmap=!1);var w;if(1!=f||1!=g){var S=p.ctx;S.save(),S.scale(f,g),!N.isConchWebGL&&N.isConchApp&&(w=e._$P.cf)&&S.setFilterMatrix&&S.setFilterMatrix(w._mat,w._alpha),o._fun.call(o,e,p,-h,-l),S.restore(),N.isConchApp&&!N.isConchWebGL||e._applyFilters()}else S=p.ctx,!N.isConchWebGL&&N.isConchApp&&(w=e._$P.cf)&&S.setFilterMatrix&&S.setFilterMatrix(w._mat,w._alpha),o._fun.call(o,e,p,-h,-l),N.isConchApp&&!N.isConchWebGL||e._applyFilters();e._$P.staticCache&&(r.reCache=!1),j.canvasReCache++}else h=(c=r._cacheRec).x,l=c.y,s=p.canvas;t.drawCanvas(s,n+h,a+l,c.width,c.height)}else o._fun.call(o,e,p,n,a)},e.__init__=function(){var t,i=0,n=0;for(t=o.createRenderSprite(69905,null),n=e.renders.length=4096,i=0;i<n;i++)e.renders[i]=t;e.renders[0]=o.createRenderSprite(0,null),function(t,i){for(var n=0,a=0;a<t.length;a++)n|=t[a],e.renders[n]=i}([1,512,4,2],new e(1,null)),e.renders[513]=o.createRenderSprite(513,null),e.renders[517]=new e(517,null)},e._initRenderFun=function(t,i,n,a){var r=t._renderType;(e.renders[r]=e._getTypeRender(r))._fun(t,i,n,a)},e._getTypeRender=function(e){for(var t=null,i=2048;i>1;)i&e&&(t=o.createRenderSprite(i,t)),i>>=1;return t},e.IMAGE=1,e.ALPHA=2,e.TRANSFORM=4,e.BLEND=8,e.CANVAS=16,e.FILTERS=32,e.MASK=64,e.CLIP=128,e.STYLE=256,e.GRAPHICS=512,e.CUSTOM=1024,e.CHILDS=2048,e.INIT=69905,e.renders=[],e.NORENDER=new e(0,null),e}(),B=function(){function e(){this._repaint=!1}a(e,"laya.resource.Context");var t=e.prototype;return t.replaceReset=function(){var t=0,i=0;i=e.replaceKeys.length;var n;for(t=0;t<i;t++)n=e.replaceKeys[t],this[e.newKeys[t]]=this[n]},t.replaceResotre=function(){this.__restore(),this.__reset()},t.setIsMainContext=function(){},t.drawTextures=function(e,t,i,n){j.drawCall+=t.length/2;for(var a=e.width,r=e.height,o=0,s=t.length;o<s;o+=2)this.drawTexture(e,t[o],t[o+1],a,r,i,n)},t.drawCanvas=function(e,t,i,n,a){j.drawCall++,this.drawImage(e.source,t,i,n,a)},t.fillRect=function(e,t,i,n,a){j.drawCall++,a&&(this.fillStyle=a),this.__fillRect(e,t,i,n)},t.fillText=function(e,t,i,n,a,r){j.drawCall++,arguments.length>3&&null!=n&&(this.font=n,this.fillStyle=a,this.textAlign=r,this.textBaseline="top"),this.__fillText(e,t,i)},t.fillBorderText=function(e,t,i,n,a,r,o,s){j.drawCall++,this.font=n,this.fillStyle=a,this.textBaseline="top",this.strokeStyle=r,this.lineWidth=o,this.textAlign=s,this.__strokeText(e,t,i),this.__fillText(e,t,i)},t.strokeText=function(e,t,i,n,a,r,o){j.drawCall++,arguments.length>3&&null!=n&&(this.font=n,this.strokeStyle=a,this.lineWidth=r,this.textAlign=o,this.textBaseline="top"),this.__strokeText(e,t,i)},t.transformByMatrix=function(e){this.transform(e.a,e.b,e.c,e.d,e.tx,e.ty)},t.setTransformByMatrix=function(e){this.setTransform(e.a,e.b,e.c,e.d,e.tx,e.ty)},t.clipRect=function(e,t,i,n){j.drawCall++,this.beginPath(),this.rect(e,t,i,n),this.clip()},t.drawTexture=function(e,t,i,n,a,r,o){j.drawCall++;var s=e.uv,h=e.bitmap.width,l=e.bitmap.height;this.drawImage(e.source,s[0]*h,s[1]*l,(s[2]-s[0])*h,(s[5]-s[3])*l,t+r,i+o,n,a)},t.drawTextureWithTransform=function(e,t,i,n,a,r,o,s,h){j.drawCall++;var l=e.uv,c=e.bitmap.width,p=e.bitmap.height;this.save(),1!=h&&(this.globalAlpha*=h),r?(this.transform(r.a,r.b,r.c,r.d,r.tx+o,r.ty+s),this.drawImage(e.source,l[0]*c,l[1]*p,(l[2]-l[0])*c,(l[5]-l[3])*p,t,i,n,a)):this.drawImage(e.source,l[0]*c,l[1]*p,(l[2]-l[0])*c,(l[5]-l[3])*p,t+o,i+s,n,a),this.restore()},t.drawTexture2=function(e,t,i,n,a,r,o,s){var h=s[0];if(h.loaded&&h.bitmap&&h.source){j.drawCall++;var l=1!==r;if(l){var c=this.globalAlpha;this.globalAlpha*=r}var p=h.uv,u=h.bitmap.width,d=h.bitmap.height;a?(this.save(),this.transform(a.a,a.b,a.c,a.d,a.tx+e,a.ty+t),this.drawImage(h.source,p[0]*u,p[1]*d,(p[2]-p[0])*u,(p[5]-p[3])*d,s[1]-i,s[2]-n,s[3],s[4]),this.restore()):this.drawImage(h.source,p[0]*u,p[1]*d,(p[2]-p[0])*u,(p[5]-p[3])*d,s[1]-i+e,s[2]-n+t,s[3],s[4]),l&&(this.globalAlpha=c)}},t.fillTexture=function(e,t,i,n,a,r,o,s){if(!s.pat){if(e.uv!=ce.DEF_UV){var h=new xe("2D");h.getContext("2d"),h.size(e.width,e.height),h.context.drawTexture(e,0,0,e.width,e.height,0,0),e=new ce(h)}s.pat=this.createPattern(e.bitmap.source,r)}var l=t,c=i,p=0,u=0;o&&(l+=o.x%e.width,c+=o.y%e.height,p-=o.x%e.width,u-=o.y%e.height),this.translate(l,c),this.fillRect(p,u,n,a,s.pat),this.translate(-l,-c)},t.drawTriangle=function(e,t,i,n,a,r,o,s){var h=e.bitmap,l=h.source,c=e.width,p=e.height,u=h.width,d=h.height,_=i[n]*u,m=i[a]*u,f=i[r]*u,g=i[n+1]*d,y=i[a+1]*d,v=i[r+1]*d,x=t[n],b=t[a],w=t[r],S=t[n+1],I=t[a+1],M=t[r+1];if(s){var C=(x+b+w)/3,k=(S+I+M)/3,E=x-C,T=S-k,L=Math.sqrt(E*E+T*T);x=C+E/L*(L+1),S=k+T/L*(L+1),T=I-k,b=C+(E=b-C)/(L=Math.sqrt(E*E+T*T))*(L+1),I=k+T/L*(L+1),T=M-k,w=C+(E=w-C)/(L=Math.sqrt(E*E+T*T))*(L+1),M=k+T/L*(L+1)}this.save(),o&&this.transform(o.a,o.b,o.c,o.d,o.tx,o.ty),this.beginPath(),this.moveTo(x,S),this.lineTo(b,I),this.lineTo(w,M),this.closePath(),this.clip();var D=1/(_*y+g*f+m*v-y*f-g*m-_*v),N=x*y+g*w+b*v-y*w-g*b-x*v,A=_*b+x*f+m*w-b*f-x*m-_*w,R=_*y*w+g*b*f+x*m*v-x*y*f-g*m*w-_*b*v,B=S*y+g*M+I*v-y*M-g*I-S*v,P=_*I+S*f+m*M-I*f-S*m-_*M,O=_*y*M+g*I*f+S*m*v-S*y*f-g*m*M-_*I*v;this.transform(N*D,B*D,A*D,P*D,R*D,O*D),this.drawImage(l,e.uv[0]*u,e.uv[1]*d,c,p,e.uv[0]*u,e.uv[1]*d,c,p),this.restore()},t.flush=function(){return 0},t.fillWords=function(e,t,i,n,a,r){n&&(this.font=n),a&&(this.fillStyle=a);this.textBaseline="top",this.textAlign="left";for(var o=0,s=e.length;o<s;o++){var h=e[o];if(this.__fillText(h.char,h.x+t,h.y+i),1===r){var l=h.height,c=.5*h.style.letterSpacing;c||(c=0),this.beginPath(),this.strokeStyle=a,this.lineWidth=1,this.moveTo(t+h.x-c+.5,i+h.y+l+.5),this.lineTo(t+h.x+h.width+c+.5,i+h.y+l+.5),this.stroke()}}},t.fillBorderWords=function(e,t,i,n,a,r,o){n&&(this.font=n),a&&(this.fillStyle=a),this.textBaseline="top",this.lineWidth=o,this.textAlign="left",this.strokeStyle=r;for(var s=0,h=e.length;s<h;s++){var l=e[s];this.__strokeText(l.char,l.x+t,l.y+i),this.__fillText(l.char,l.x+t,l.y+i)}},t.destroy=function(){this.canvas.width=this.canvas.height=0},t.clear=function(){this.clearRect(0,0,this._canvas.width,this._canvas.height),this._repaint=!1},t.drawCurves=function(e,t,i){this.beginPath(),this.strokeStyle=i[3],this.lineWidth=i[4];var n=i[2];e+=i[0],t+=i[1],this.moveTo(e+n[0],t+n[1]);for(var a=2,r=n.length;a<r;)this.quadraticCurveTo(e+n[a++],t+n[a++],e+n[a++],t+n[a++]);this.stroke()},e.__init__=function(e){var t=laya.resource.Context.prototype;if(!(e=e||CanvasRenderingContext2D.prototype).inited){e.inited=!0,e.__fillText=e.fillText,e.__fillRect=e.fillRect,e.__strokeText=e.strokeText;["drawTextures","drawTriangle","fillWords","fillBorderWords","setIsMainContext","fillRect","strokeText","fillTexture","fillText","transformByMatrix","setTransformByMatrix","clipRect","drawTexture","drawTexture2","drawTextureWithTransform","flush","clear","destroy","drawCanvas","fillBorderText","drawCurves"].forEach(function(i){e[i]=t[i]})}},e.replaceCanvasGetSet=function(e,t){var i=Object.getOwnPropertyDescriptor(e,t);if(!i||!i.configurable)return!1;var n,a={};for(n in i)"set"!=n&&(a[n]=i[n]);var r=i.set;return a.set=function(e){r.call(this,e);var t=this.getContext("2d");t&&"__reset"in t&&t.__reset()},Object.defineProperty(e,t,a),!0},e.replaceGetSet=function(t,i){var n=Object.getOwnPropertyDescriptor(t,i);if(!n||!n.configurable)return!1;var a,r={};for(a in n)"set"!=a&&(r[a]=n[a]);var o=n.set,s="___"+i+"__";return e.newKeys.push(s),r.set=function(e){e!=this[s]&&(this[s]=e,o.call(this,e))},Object.defineProperty(t,i,r),!0},e._default=new e,e.newKeys=[],n(e,["replaceKeys",function(){return this.replaceKeys=["font","fillStyle","textBaseline"]}]),e}(),P=function(){function e(t){this._id=0,this._name=null,this._resources=null,this._memorySize=0,this._garbageCollectionRate=NaN,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=0,this._id=++e._uniqueIDCounter,this._name=t||"Content Manager",e._isResourceManagersSorted=!1,this._memorySize=0,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=536870912,this._garbageCollectionRate=.2,e._resourceManagers.push(this),this._resources=[]}a(e,"laya.resource.ResourceManager");var t=e.prototype;return i.imps(t,{"laya.resource.IDispose":!0}),t.getResourceByIndex=function(e){return this._resources[e]},t.getResourcesLength=function(){return this._resources.length},t.addResource=function(e){e.resourceManager&&e.resourceManager.removeResource(e);return-1===this._resources.indexOf(e)&&(e._resourceManager=this,this._resources.push(e),this.addSize(e.memorySize),!0)},t.removeResource=function(e){var t=this._resources.indexOf(e);return-1!==t&&(this._resources.splice(t,1),e._resourceManager=null,this._memorySize-=e.memorySize,!0)},t.unload=function(){for(var e=this._resources.slice(0,this._resources.length),t=0;t<e.length;t++){e[t].destroy()}e.length=0},t.dispose=function(){if(this===e._systemResourceManager)throw new Error("systemResourceManager不能被释放！");e._resourceManagers.splice(e._resourceManagers.indexOf(this),1),e._isResourceManagersSorted=!1;for(var t=this._resources.slice(0,this._resources.length),i=0;i<t.length;i++){var n=t[i];n.resourceManager.removeResource(n),n.destroy()}t.length=0},t.addSize=function(e){e&&(this.autoRelease&&e>0&&this._memorySize+e>this.autoReleaseMaxSize&&this.garbageCollection((1-this._garbageCollectionRate)*this.autoReleaseMaxSize),this._memorySize+=e)},t.garbageCollection=function(e){var t=this._resources;(t=t.slice()).sort(function(e,t){if(!e||!t)throw new Error("a或b不能为空！");return e.released&&t.released?0:e.released?1:t.released?-1:e._lastUseFrameCount-t._lastUseFrameCount});for(var i=j.loopCount,n=0,a=t.length;n<a;n++){var r=t[n];if(!(i-r._lastUseFrameCount>1))return void(this._memorySize>=e&&(this._isOverflow=!0));if(r.releaseResource(),this._memorySize<e)return void(this._isOverflow=!1)}},r(0,t,"id",function(){return this._id}),r(0,t,"name",function(){return this._name},function(t){!t&&""===t||this._name===t||(this._name=t,e._isResourceManagersSorted=!1)}),r(0,t,"memorySize",function(){return this._memorySize}),r(1,e,"systemResourceManager",function(){return e._systemResourceManager}),e.__init__=function(){e.currentResourceManager=e.systemResourceManager},e.getLoadedResourceManagerByIndex=function(t){return e._resourceManagers[t]},e.getLoadedResourceManagersCount=function(){return e._resourceManagers.length},e.recreateContentManagers=function(t){void 0===t&&(t=!1);for(var i=e.currentResourceManager,n=0;n<e._resourceManagers.length;n++){e.currentResourceManager=e._resourceManagers[n];for(var a=0;a<e.currentResourceManager._resources.length;a++)e.currentResourceManager._resources[a].releaseResource(t),e.currentResourceManager._resources[a].activeResource(t)}e.currentResourceManager=i},e.releaseContentManagers=function(t){void 0===t&&(t=!1);for(var i=e.currentResourceManager,n=0;n<e._resourceManagers.length;n++){e.currentResourceManager=e._resourceManagers[n];for(var a=0;a<e.currentResourceManager._resources.length;a++){var r=e.currentResourceManager._resources[a];!r.released&&r.releaseResource(t)}}e.currentResourceManager=i},e._uniqueIDCounter=0,e._isResourceManagersSorted=!1,e._resourceManagers=[],n(e,["_systemResourceManager",function(){return this._systemResourceManager=new e("System Resource Manager")},"currentResourceManager",function(){return this.currentResourceManager=e._systemResourceManager}]),e}(),O=(function(){function e(){}a(e,"laya.system.System"),e.changeDefinition=function(e,t){i[e]=t;var n=e+"=classObj";i._runScript(n)},e.__init__=function(){N.isConchApp&&(conch.disableConchResManager(),conch.disableConchAutoRestoreLostedDevice())}}(),function(){function n(){}return a(n,"laya.utils.Browser"),r(1,n,"pixelRatio",function(){return n.__init__(),n.userAgent.indexOf("Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)")>-1?2:o.getPixelRatio()}),r(1,n,"height",function(){return n.__init__(),(i.stage&&i.stage.canvasRotation?n.clientWidth:n.clientHeight)*n.pixelRatio}),r(1,n,"clientWidth",function(){return n.__init__(),n.window.innerWidth||n.document.body.clientWidth}),r(1,n,"window",function(){return n.__init__(),n._window}),r(1,n,"clientHeight",function(){return n.__init__(),n.window.innerHeight||n.document.body.clientHeight||n.document.documentElement.clientHeight}),r(1,n,"width",function(){return n.__init__(),(i.stage&&i.stage.canvasRotation?n.clientHeight:n.clientWidth)*n.pixelRatio}),r(1,n,"container",function(){return n.__init__(),n._container||((n._container=n.createElement("div")).id="layaContainer",n.document.body.appendChild(n._container)),n._container},function(e){n._container=e}),r(1,n,"document",function(){return n.__init__(),n._document}),n.__init__=function(){if(!n._window){n._window=o.getWindow(),n._document=n.window.document,n._window.addEventListener("message",function(e){laya.utils.Browser._onMessage(e)},!1),n.document.__createElement=n.document.createElement,e.requestAnimationFrame=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(t){return e.setTimeout(t,1e3/60)};var i=e.document.body.style;i["-webkit-user-select"]="none",i["-webkit-tap-highlight-color"]="rgba(200,200,200,0)",n.userAgent=n.window.navigator.userAgent,n.onIOS=!!(n.u=n.userAgent).match(/\(i[^;]+;(U;)? CPU.+Mac OS X/),n.onMobile=n.u.indexOf("Mobile")>-1,n.onIPhone=n.u.indexOf("iPhone")>-1,n.onMac=n.u.indexOf("Mac OS X")>-1,n.onIPad=n.u.indexOf("iPad")>-1,n.onAndroid=n.u.indexOf("Android")>-1||n.u.indexOf("Adr")>-1,n.onWP=n.u.indexOf("Windows Phone")>-1,n.onQQBrowser=n.u.indexOf("QQBrowser")>-1,n.onMQQBrowser=n.u.indexOf("MQQBrowser")>-1||n.u.indexOf("Mobile")>-1&&n.u.indexOf("QQ")>-1,n.onIE=!!n.window.ActiveXObject||"ActiveXObject"in n.window,n.onWeiXin=n.u.indexOf("MicroMessenger")>-1,n.onPC=!n.onMobile,n.onSafari=n.u.indexOf("Safari")>-1,n.onFirefox=n.u.indexOf("Firefox")>-1,n.onEdge=n.u.indexOf("Edge")>-1,n.onMiniGame=n.u.indexOf("MiniGame")>-1,n.onLimixiu=n.u.indexOf("limixiu")>-1,n.httpProtocol="http:"==n.window.location.protocol,n.onMiniGame&&null==n.window.focus&&console.error("请先初始化小游戏适配库，详细教程https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0"),n.webAudioEnabled=!!(n.window.AudioContext||n.window.webkitAudioContext||n.window.mozAudioContext),n.soundType=n.webAudioEnabled?"WEBAUDIOSOUND":"AUDIOSOUND",ne=n.webAudioEnabled?ae:te,n.webAudioEnabled&&ae.initWebAudio(),te._initMusicAudio(),n.enableTouch="ontouchstart"in e||e.DocumentTouch&&t instanceof DocumentTouch,e.focus(),E._soundClass=ne,E._musicClass=te,N._mainCanvas=N._mainCanvas||xe.create("2D"),n.canvas||(n.canvas=xe.create("2D"),n.context=n.canvas.getContext("2d"))}},n._onMessage=function(e){if(e.data&&"size"==e.data.name){if(n.window.innerWidth=e.data.width,n.window.innerHeight=e.data.height,n.window.__innerHeight=e.data.clientHeight,!n.document.createEvent)return void console.warn("no document.createEvent");var t=n.document.createEvent("HTMLEvents");return t.initEvent("resize",!1,!1),void n.window.dispatchEvent(t)}},n.createElement=function(e){return n.__init__(),n.document.__createElement(e)},n.getElementById=function(e){return n.__init__(),n.document.getElementById(e)},n.removeElement=function(e){e&&e.parentNode&&e.parentNode.removeChild(e)},n.now=function(){return o.now()},n._window=null,n._document=null,n._container=null,n.userAgent=null,n.u=null,n.onIOS=!1,n.onMac=!1,n.onMobile=!1,n.onIPhone=!1,n.onIPad=!1,n.onAndroid=!1,n.onWP=!1,n.onQQBrowser=!1,n.onMQQBrowser=!1,n.onSafari=!1,n.onFirefox=!1,n.onEdge=!1,n.onIE=!1,n.onWeiXin=!1,n.onMiniGame=!1,n.onLimixiu=!1,n.onPC=!1,n.httpProtocol=!1,n.webAudioEnabled=!1,n.soundType=null,n.enableTouch=!1,n.canvas=null,n.context=null,n.__init$=function(){},n}()),V=function(){function e(e){this._xd_=!0,this._allocated_=8,this._pos_=0,this._length=0,e?(this._u8d_=new Uint8Array(e),this._d_=new DataView(this._u8d_.buffer),this._length=this._d_.byteLength):this.___resizeBuffer(this._allocated_)}a(e,"laya.utils.Byte");var t=e.prototype;return t.___resizeBuffer=function(e){try{var t=new Uint8Array(e);null!=this._u8d_&&(this._u8d_.length<=e?t.set(this._u8d_):t.set(this._u8d_.subarray(0,e))),this._u8d_=t,this._d_=new DataView(t.buffer)}catch(t){throw"___resizeBuffer err:"+e}},t.getString=function(){return this.rUTF(this.getUint16())},t.getFloat32Array=function(e,t){var i=e+t;i=i>this._length?this._length:i;var n=new Float32Array(this._d_.buffer.slice(e,i));return this._pos_=i,n},t.getUint8Array=function(e,t){var i=e+t;i=i>this._length?this._length:i;var n=new Uint8Array(this._d_.buffer.slice(e,i));return this._pos_=i,n},t.getInt16Array=function(e,t){var i=e+t;i=i>this._length?this._length:i;var n=new Int16Array(this._d_.buffer.slice(e,i));return this._pos_=i,n},t.getFloat32=function(){if(this._pos_+4>this._length)throw"getFloat32 error - Out of bounds";var e=this._d_.getFloat32(this._pos_,this._xd_);return this._pos_+=4,e},t.getFloat64=function(){if(this._pos_+8>this._length)throw"getFloat64 error - Out of bounds";var e=this._d_.getFloat64(this._pos_,this._xd_);return this._pos_+=8,e},t.writeFloat32=function(e){this.ensureWrite(this._pos_+4),this._d_.setFloat32(this._pos_,e,this._xd_),this._pos_+=4},t.writeFloat64=function(e){this.ensureWrite(this._pos_+8),this._d_.setFloat64(this._pos_,e,this._xd_),this._pos_+=8},t.getInt32=function(){if(this._pos_+4>this._length)throw"getInt32 error - Out of bounds";var e=this._d_.getInt32(this._pos_,this._xd_);return this._pos_+=4,e},t.getUint32=function(){if(this._pos_+4>this._length)throw"getUint32 error - Out of bounds";var e=this._d_.getUint32(this._pos_,this._xd_);return this._pos_+=4,e},t.writeInt32=function(e){this.ensureWrite(this._pos_+4),this._d_.setInt32(this._pos_,e,this._xd_),this._pos_+=4},t.writeUint32=function(e){this.ensureWrite(this._pos_+4),this._d_.setUint32(this._pos_,e,this._xd_),this._pos_+=4},t.getInt16=function(){if(this._pos_+2>this._length)throw"getInt16 error - Out of bounds";var e=this._d_.getInt16(this._pos_,this._xd_);return this._pos_+=2,e},t.getUint16=function(){if(this._pos_+2>this._length)throw"getUint16 error - Out of bounds";var e=this._d_.getUint16(this._pos_,this._xd_);return this._pos_+=2,e},t.writeUint16=function(e){this.ensureWrite(this._pos_+2),this._d_.setUint16(this._pos_,e,this._xd_),this._pos_+=2},t.writeInt16=function(e){this.ensureWrite(this._pos_+2),this._d_.setInt16(this._pos_,e,this._xd_),this._pos_+=2},t.getUint8=function(){if(this._pos_+1>this._length)throw"getUint8 error - Out of bounds";return this._d_.getUint8(this._pos_++)},t.writeUint8=function(e){this.ensureWrite(this._pos_+1),this._d_.setUint8(this._pos_,e),this._pos_++},t._getUInt8=function(e){return this._d_.getUint8(e)},t._getUint16=function(e){return this._d_.getUint16(e,this._xd_)},t._getMatrix=function(){return new M(this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32())},t.rUTF=function(e){for(var t="",i=this._pos_+e,n=0,a=String.fromCharCode,r=this._u8d_;this._pos_<i;)(n=r[this._pos_++])<128?0!=n&&(t+=a(n)):t+=a(n<224?(63&n)<<6|127&r[this._pos_++]:n<240?(31&n)<<12|(127&r[this._pos_++])<<6|127&r[this._pos_++]:(15&n)<<18|(127&r[this._pos_++])<<12|r[this._pos_++]<<6&127|127&r[this._pos_++]),0;return t},t.getCustomString=function(e){for(var t="",i=0,n=0,a=String.fromCharCode,r=this._u8d_;e>0;)if((n=r[this._pos_])<128)t+=a(n),this._pos_++,e--;else for(i=n-128,this._pos_++,e-=i;i>0;)n=r[this._pos_++],t+=a(r[this._pos_++]<<8|n),i--;return t},t.clear=function(){this._pos_=0,this.length=0},t.__getBuffer=function(){return this._d_.buffer},t.writeUTFBytes=function(e){for(var t=0,i=(e+="").length;t<i;t++){var n=e.charCodeAt(t);n<=127?this.writeByte(n):n<=2047?(this.ensureWrite(this._pos_+2),this._u8d_.set([192|n>>6,128|63&n],this._pos_),this._pos_+=2):n<=65535?(this.ensureWrite(this._pos_+3),this._u8d_.set([224|n>>12,128|n>>6&63,128|63&n],this._pos_),this._pos_+=3):(this.ensureWrite(this._pos_+4),this._u8d_.set([240|n>>18,128|n>>12&63,128|n>>6&63,128|63&n],this._pos_),this._pos_+=4)}},t.writeUTFString=function(e){var t=this.pos;this.writeUint16(1),this.writeUTFBytes(e);var i=this.pos-t-2;if(i>=65536)throw"writeUTFString byte len more than 65536";this._d_.setUint16(t,i,this._xd_)},t.readUTFString=function(){return this.readUTFBytes(this.getUint16())},t.getUTFString=function(){return this.readUTFString()},t.readUTFBytes=function(e){if(void 0===e&&(e=-1),0==e)return"";var t=this.bytesAvailable;if(e>t)throw"readUTFBytes error - Out of bounds";return e=e>0?e:t,this.rUTF(e)},t.getUTFBytes=function(e){return void 0===e&&(e=-1),this.readUTFBytes(e)},t.writeByte=function(e){this.ensureWrite(this._pos_+1),this._d_.setInt8(this._pos_,e),this._pos_+=1},t.readByte=function(){if(this._pos_+1>this._length)throw"readByte error - Out of bounds";return this._d_.getInt8(this._pos_++)},t.getByte=function(){return this.readByte()},t.ensureWrite=function(e){this._length<e&&(this._length=e),this._allocated_<e&&(this.length=e)},t.writeArrayBuffer=function(e,t,i){if(void 0===t&&(t=0),void 0===i&&(i=0),t<0||i<0)throw"writeArrayBuffer error - Out of bounds";0==i&&(i=e.byteLength-t),this.ensureWrite(this._pos_+i);var n=new Uint8Array(e);this._u8d_.set(n.subarray(t,t+i),this._pos_),this._pos_+=i},r(0,t,"buffer",function(){var e=this._d_.buffer;return e.byteLength==this.length?e:e.slice(0,this.length)}),r(0,t,"endian",function(){return this._xd_?"littleEndian":"bigEndian"},function(e){this._xd_="littleEndian"==e}),r(0,t,"length",function(){return this._length},function(e){this._allocated_<e?this.___resizeBuffer(this._allocated_=Math.floor(Math.max(e,2*this._allocated_))):this._allocated_>e&&this.___resizeBuffer(this._allocated_=e),this._length=e}),r(0,t,"pos",function(){return this._pos_},function(e){this._pos_=e}),r(0,t,"bytesAvailable",function(){return this._length-this._pos_}),e.getSystemEndian=function(){if(!e._sysEndian){var t=new ArrayBuffer(2);new DataView(t).setInt16(0,256,!0),e._sysEndian=256===new Int16Array(t)[0]?"littleEndian":"bigEndian"}return e._sysEndian},e.BIG_ENDIAN="bigEndian",e.LITTLE_ENDIAN="littleEndian",e._sysEndian=null,e}(),U=function(){function e(){}return a(e,"laya.utils.CacheManager"),e.regCacheByFunction=function(t,i){e.unRegCacheByFunction(t,i);var n;n={tryDispose:t,getCacheList:i},e._cacheList.push(n)},e.unRegCacheByFunction=function(t,i){var n=0,a=0;for(a=e._cacheList.length,n=0;n<a;n++)if(e._cacheList[n].tryDispose==t&&e._cacheList[n].getCacheList==i)return void e._cacheList.splice(n,1)},e.forceDispose=function(){var t=0,i=e._cacheList.length;for(t=0;t<i;t++)e._cacheList[t].tryDispose(!0)},e.beginCheck=function(t){void 0===t&&(t=15e3),i.timer.loop(t,null,e._checkLoop)},e.stopCheck=function(){i.timer.clear(null,e._checkLoop)},e._checkLoop=function(){var t=e._cacheList;if(!(t.length<1)){var i=O.now(),n=0,a=0;for(a=n=t.length;n>0&&(e._index++,e._index=e._index%a,t[e._index].tryDispose(!1),!(O.now()-i>e.loopTimeLimit));)n--}},e.loopTimeLimit=2,e._cacheList=[],e._index=0,e}(),F=function(){function e(){}return a(e,"laya.utils.ClassUtils"),e.regClass=function(t,i){e._classMap[t]=i},e.getRegClass=function(t){return e._classMap[t]},e.getInstance=function(t){var i=e.getClass(t);return i?new i:(console.warn("[error] Undefined class:",t),null)},e.createByJson=function(t,i,n,a,r){"string"==typeof t&&(t=JSON.parse(t));var o=t.props;if(!i&&!(i=r?r.runWith(t):e.getInstance(o.runtime||t.type)))return null;var s=t.child;if(s)for(var h=0,l=s.length;h<l;h++){var c=s[h];if("render"!==c.props.name&&"render"!==c.props.renderType||!i._$set_itemRender)if("Graphic"==c.type)e.addGraphicsToSprite(c,i);else if(e.isDrawType(c.type))e.addGraphicToSprite(c,i,!0);else{var p=e.createByJson(c,null,n,a,r);"Script"==c.type?p.hasOwnProperty("owner")?p.owner=i:p.hasOwnProperty("target")&&(p.target=i):"mask"==c.props.renderType?i.mask=p:i.addChild(p)}else i.itemRender=c}if(o)for(var u in o){var d=o[u];"var"===u&&n?n[d]=i:d instanceof Array&&"function"==typeof i[u]?i[u].apply(i,d):i[u]=d}return a&&t.customProps&&a.runWith([i,t]),i.created&&i.created(),i},e.addGraphicsToSprite=function(t,i){var n;if((n=t.child)&&!(n.length<1)){var a;a=e._getGraphicsFromSprite(t,i);var r=0,o=0;t.props&&(r=e._getObjVar(t.props,"x",0),o=e._getObjVar(t.props,"y",0)),0!=r&&0!=o&&a.translate(r,o);var s=0,h=0;for(h=n.length,s=0;s<h;s++)e._addGraphicToGraphics(n[s],a);0!=r&&0!=o&&a.translate(-r,-o)}},e.addGraphicToSprite=function(t,i,n){void 0===n&&(n=!1);var a;a=n?e._getGraphicsFromSprite(t,i):i.graphics,e._addGraphicToGraphics(t,a)},e._getGraphicsFromSprite=function(e,t){var i;if(!e||!e.props)return t.graphics;var n;switch(n=e.props.renderType){case"hit":case"unHit":var a;t.hitArea||(t.hitArea=new Y),(a=t.hitArea)[n]||(a[n]=new _),i=a[n]}return i||(i=t.graphics),i},e._getTransformData=function(t){var i;(t.hasOwnProperty("pivotX")||t.hasOwnProperty("pivotY"))&&(i=i||new M).translate(-e._getObjVar(t,"pivotX",0),-e._getObjVar(t,"pivotY",0));var n=e._getObjVar(t,"scaleX",1),a=e._getObjVar(t,"scaleY",1),r=e._getObjVar(t,"rotation",0);e._getObjVar(t,"skewX",0),e._getObjVar(t,"skewY",0);return 1==n&&1==a&&0==r||((i=i||new M).scale(n,a),i.rotate(.0174532922222222*r)),i},e._addGraphicToGraphics=function(t,i){var n;if(n=t.props){var a;if(a=e.DrawTypeDic[t.type]){var r;r=i;var o,s=e._getParams(n,a[1],a[2],a[3]);((o=e._tM)||1!=e._alpha)&&(r.save(),o&&r.transform(o),1!=e._alpha&&r.alpha(e._alpha)),r[a[0]].apply(r,s),(o||1!=e._alpha)&&r.restore()}}},e._adptLineData=function(e){return e[2]=parseFloat(e[0])+parseFloat(e[2]),e[3]=parseFloat(e[1])+parseFloat(e[3]),e},e._adptTextureData=function(e){return e[0]=oe.getRes(e[0]),e},e._adptLinesData=function(t){return t[2]=e._getPointListByStr(t[2]),t},e.isDrawType=function(t){return"Image"!=t&&e.DrawTypeDic.hasOwnProperty(t)},e._getParams=function(t,i,n,a){void 0===n&&(n=0);var r;(r=e._temParam).length=i.length;var o=0,s=0;for(s=i.length,o=0;o<s;o++)r[o]=e._getObjVar(t,i[o][0],i[o][1]);e._alpha=e._getObjVar(t,"alpha",1);var h;return(h=e._getTransformData(t))?(n||(n=0),h.translate(r[n],r[n+1]),r[n]=r[n+1]=0,e._tM=h):e._tM=null,a&&e[a]&&(r=e[a](r)),r},e._getPointListByStr=function(e){var t,i=0,n=0;for(n=(t=e.split(",")).length,i=0;i<n;i++)t[i]=parseFloat(t[i]);return t},e._getObjVar=function(e,t,i){return e.hasOwnProperty(t)?e[t]:i},e._temParam=[],e._classMap={Sprite:"laya.display.Sprite",Text:"laya.display.Text",Animation:"laya.display.Animation",Skeleton:"laya.ani.bone.Skeleton",Particle2D:"laya.particle.Particle2D",div:"laya.html.dom.HTMLDivElement",p:"laya.html.dom.HTMLElement",img:"laya.html.dom.HTMLImageElement",span:"laya.html.dom.HTMLElement",br:"laya.html.dom.HTMLBrElement",style:"laya.html.dom.HTMLStyleElement",font:"laya.html.dom.HTMLElement",a:"laya.html.dom.HTMLElement","#text":"laya.html.dom.HTMLElement"},e.getClass=function(t){var n=e._classMap[t]||t;return"string"==typeof n?i.__classmap[n]:n},e._tM=null,e._alpha=NaN,n(e,["DrawTypeDic",function(){return this.DrawTypeDic={Rect:["drawRect",[["x",0],["y",0],["width",0],["height",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Circle:["drawCircle",[["x",0],["y",0],["radius",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Pie:["drawPie",[["x",0],["y",0],["radius",0],["startAngle",0],["endAngle",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Image:["drawTexture",[["x",0],["y",0],["width",0],["height",0]]],Texture:["drawTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0]],1,"_adptTextureData"],FillTexture:["fillTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0],["repeat",null]],1,"_adptTextureData"],FillText:["fillText",[["text",""],["x",0],["y",0],["font",null],["color",null],["textAlign",null]],1],Line:["drawLine",[["x",0],["y",0],["toX",0],["toY",0],["lineColor",null],["lineWidth",0]],0,"_adptLineData"],Lines:["drawLines",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Curves:["drawCurves",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Poly:["drawPoly",[["x",0],["y",0],["points",""],["fillColor",null],["lineColor",null],["lineWidth",1]],0,"_adptLinesData"]}}]),e}(),H=function(){function e(t){if(this._color=[],"string"==typeof t){this.strColor=t,null===t&&(t="#000000"),"#"==t.charAt(0)&&(t=t.substr(1));var i=t.length;if(3==i||4==i){for(var n="",a=0;a<i;a++)n+=t[a]+t[a];t=n}var r=this.numColor=parseInt(t,16);if(8==t.length)return void(this._color=[parseInt(t.substr(0,2),16)/255,((16711680&r)>>16)/255,((65280&r)>>8)/255,(255&r)/255])}else r=this.numColor=t,this.strColor=K.toHexColor(r);this._color=[((16711680&r)>>16)/255,((65280&r)>>8)/255,(255&r)/255,1],this._color.__id=++e._COLODID}return a(e,"laya.utils.Color"),e._initDefault=function(){e._DEFAULT={};for(var t in e._COLOR_MAP)e._SAVE[t]=e._DEFAULT[t]=new e(e._COLOR_MAP[t]);return e._DEFAULT},e._initSaveMap=function(){e._SAVE_SIZE=0,e._SAVE={};for(var t in e._DEFAULT)e._SAVE[t]=e._DEFAULT[t]},e.create=function(t){var i=e._SAVE[t+""];return null!=i?i:(e._SAVE_SIZE<1e3||e._initSaveMap(),e._SAVE[t+""]=new e(t))},e._SAVE={},e._SAVE_SIZE=0,e._COLOR_MAP={white:"#FFFFFF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",black:"#000000",yellow:"#FFFF00",gray:"#AAAAAA"},e._DEFAULT=e._initDefault(),e._COLODID=1,e}(),z=(function(){function e(){this._values=[],this._keys=[]}a(e,"laya.utils.Dictionary");var t=e.prototype;t.set=function(e,t){var i=this.indexOf(e);i>=0?this._values[i]=t:(this._keys.push(e),this._values.push(t))},t.indexOf=function(e){var t=this._keys.indexOf(e);return t>=0?t:(e="string"==typeof e?Number(e):"number"==typeof e?e.toString():e,this._keys.indexOf(e))},t.get=function(e){var t=this.indexOf(e);return t<0?null:this._values[t]},t.remove=function(e){var t=this.indexOf(e);return t>=0&&(this._keys.splice(t,1),this._values.splice(t,1),!0)},t.clear=function(){this._values.length=0,this._keys.length=0},r(0,t,"values",function(){return this._values}),r(0,t,"keys",function(){return this._keys})}(),function(){function e(){this.ratio=.92,this.maxOffset=60,this._dragging=!1,this._clickOnly=!0}a(e,"laya.utils.Dragging");var t=e.prototype;return t.start=function(e,t,n,a,r,o,s,h){void 0===h&&(h=.92),this.clearTimer(),this.target=e,this.area=t,this.hasInertia=n,this.elasticDistance=t?a:0,this.elasticBackTime=r,this.data=o,this._disableMouseEvent=s,this.ratio=h,1!=e.globalScaleX||1!=e.globalScaleY?this._parent=e.parent:this._parent=i.stage,this._clickOnly=!0,this._dragging=!0,this._elasticRateX=this._elasticRateY=1,this._lastX=this._parent.mouseX,this._lastY=this._parent.mouseY,i.stage.on("mouseup",this,this.onStageMouseUp),i.stage.on("mouseout",this,this.onStageMouseUp),i.timer.frameLoop(1,this,this.loop)},t.clearTimer=function(){i.timer.clear(this,this.loop),i.timer.clear(this,this.tweenMove),this._tween&&(this._tween.recover(),this._tween=null)},t.stop=function(){this._dragging&&(y.instance.disableMouseEvent=!1,i.stage.off("mouseup",this,this.onStageMouseUp),i.stage.off("mouseout",this,this.onStageMouseUp),this._dragging=!1,this.target&&this.area&&this.backToArea(),this.clear())},t.loop=function(){var e=this._parent.getMousePoint(),t=e.x,n=e.y,a=t-this._lastX,r=n-this._lastY;if(this._clickOnly){if(!(Math.abs(a*i.stage._canvasTransform.getScaleX())>1||Math.abs(r*i.stage._canvasTransform.getScaleY())>1))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this.target.event("dragstart",this.data),y.instance.disableMouseEvent=this._disableMouseEvent,this.target._set$P("$_MOUSEDOWN",!1)}else this._offsets.push(a,r);0===a&&0===r||(this._lastX=t,this._lastY=n,this.target.x+=a*this._elasticRateX,this.target.y+=r*this._elasticRateY,this.area&&this.checkArea(),this.target.event("dragmove",this.data))},t.checkArea=function(){if(this.elasticDistance<=0)this.backToArea();else{if(this.target.x<this.area.x)var e=this.area.x-this.target.x;else e=this.target.x>this.area.x+this.area.width?this.target.x-this.area.x-this.area.width:0;if(this._elasticRateX=Math.max(0,1-e/this.elasticDistance),this.target.y<this.area.y)var t=this.area.y-this.target.y;else t=this.target.y>this.area.y+this.area.height?this.target.y-this.area.y-this.area.height:0;this._elasticRateY=Math.max(0,1-t/this.elasticDistance)}},t.backToArea=function(){this.target.x=Math.min(Math.max(this.target.x,this.area.x),this.area.x+this.area.width),this.target.y=Math.min(Math.max(this.target.y,this.area.y),this.area.y+this.area.height)},t.onStageMouseUp=function(e){if(y.instance.disableMouseEvent=!1,i.stage.off("mouseup",this,this.onStageMouseUp),i.stage.off("mouseout",this,this.onStageMouseUp),i.timer.clear(this,this.loop),!this._clickOnly&&this.target)if(this.hasInertia){this._offsets.length<1&&this._offsets.push(this._parent.mouseX-this._lastX,this._parent.mouseY-this._lastY),this._offsetX=this._offsetY=0;for(var t=this._offsets.length,n=Math.min(t,6),a=this._offsets.length-n,r=t-1;r>a;r--)this._offsetY+=this._offsets[r--],this._offsetX+=this._offsets[r];this._offsetX=this._offsetX/n*2,this._offsetY=this._offsetY/n*2,Math.abs(this._offsetX)>this.maxOffset&&(this._offsetX=this._offsetX>0?this.maxOffset:-this.maxOffset),Math.abs(this._offsetY)>this.maxOffset&&(this._offsetY=this._offsetY>0?this.maxOffset:-this.maxOffset),i.timer.frameLoop(1,this,this.tweenMove)}else this.elasticDistance>0?this.checkElastic():this.clear()},t.checkElastic=function(){var e=NaN,t=NaN;if(this.target.x<this.area.x?e=this.area.x:this.target.x>this.area.x+this.area.width&&(e=this.area.x+this.area.width),this.target.y<this.area.y?t=this.area.y:this.target.y>this.area.y+this.area.height&&(t=this.area.y+this.area.height),isNaN(e)&&isNaN(t))this.clear();else{var i={};isNaN(e)||(i.x=e),isNaN(t)||(i.y=t),this._tween=q.to(this.target,i,this.elasticBackTime,X.sineOut,l.create(this,this.clear),0,!1,!1)}},t.tweenMove=function(){this._offsetX*=this.ratio*this._elasticRateX,this._offsetY*=this.ratio*this._elasticRateY,this.target.x+=this._offsetX,this.target.y+=this._offsetY,this.area&&this.checkArea(),this.target.event("dragmove",this.data),(Math.abs(this._offsetX)<1&&Math.abs(this._offsetY)<1||this._elasticRateX<.5||this._elasticRateY<.5)&&(i.timer.clear(this,this.tweenMove),this.elasticDistance>0?this.checkElastic():this.clear())},t.clear=function(){if(this.target){this.clearTimer();var e=this.target;this.target=null,this._parent=null,e.event("dragend",this.data)}},e}()),X=function(){function e(){}return a(e,"laya.utils.Ease"),e.linearNone=function(e,t,i,n){return i*e/n+t},e.linearIn=function(e,t,i,n){return i*e/n+t},e.linearInOut=function(e,t,i,n){return i*e/n+t},e.linearOut=function(e,t,i,n){return i*e/n+t},e.bounceIn=function(t,i,n,a){return n-e.bounceOut(a-t,0,n,a)+i},e.bounceInOut=function(t,i,n,a){return t<.5*a?.5*e.bounceIn(2*t,0,n,a)+i:.5*e.bounceOut(2*t-a,0,n,a)+.5*n+i},e.bounceOut=function(e,t,i,n){return(e/=n)<1/2.75?i*(7.5625*e*e)+t:e<2/2.75?i*(7.5625*(e-=1.5/2.75)*e+.75)+t:e<2.5/2.75?i*(7.5625*(e-=2.25/2.75)*e+.9375)+t:i*(7.5625*(e-=2.625/2.75)*e+.984375)+t},e.backIn=function(e,t,i,n,a){return void 0===a&&(a=1.70158),i*(e/=n)*e*((a+1)*e-a)+t},e.backInOut=function(e,t,i,n,a){return void 0===a&&(a=1.70158),(e/=.5*n)<1?.5*i*(e*e*((1+(a*=1.525))*e-a))+t:i/2*((e-=2)*e*((1+(a*=1.525))*e+a)+2)+t},e.backOut=function(e,t,i,n,a){return void 0===a&&(a=1.70158),i*((e=e/n-1)*e*((a+1)*e+a)+1)+t},e.elasticIn=function(t,i,n,a,r,o){void 0===r&&(r=0),void 0===o&&(o=0);var s;return 0==t?i:1==(t/=a)?i+n:(o||(o=.3*a),!r||n>0&&r<n||n<0&&r<-n?(r=n,s=o/4):s=o/e.PI2*Math.asin(n/r),-r*Math.pow(2,10*(t-=1))*Math.sin((t*a-s)*e.PI2/o)+i)},e.elasticInOut=function(t,i,n,a,r,o){void 0===r&&(r=0),void 0===o&&(o=0);var s;return 0==t?i:2==(t/=.5*a)?i+n:(o||(o=a*(.3*1.5)),!r||n>0&&r<n||n<0&&r<-n?(r=n,s=o/4):s=o/e.PI2*Math.asin(n/r),t<1?r*Math.pow(2,10*(t-=1))*Math.sin((t*a-s)*e.PI2/o)*-.5+i:r*Math.pow(2,-10*(t-=1))*Math.sin((t*a-s)*e.PI2/o)*.5+n+i)},e.elasticOut=function(t,i,n,a,r,o){void 0===r&&(r=0),void 0===o&&(o=0);var s;return 0==t?i:1==(t/=a)?i+n:(o||(o=.3*a),!r||n>0&&r<n||n<0&&r<-n?(r=n,s=o/4):s=o/e.PI2*Math.asin(n/r),r*Math.pow(2,-10*t)*Math.sin((t*a-s)*e.PI2/o)+n+i)},e.strongIn=function(e,t,i,n){return i*(e/=n)*e*e*e*e+t},e.strongInOut=function(e,t,i,n){return(e/=.5*n)<1?.5*i*e*e*e*e*e+t:.5*i*((e-=2)*e*e*e*e+2)+t},e.strongOut=function(e,t,i,n){return i*((e=e/n-1)*e*e*e*e+1)+t},e.sineInOut=function(e,t,i,n){return.5*-i*(Math.cos(Math.PI*e/n)-1)+t},e.sineIn=function(t,i,n,a){return-n*Math.cos(t/a*e.HALF_PI)+n+i},e.sineOut=function(t,i,n,a){return n*Math.sin(t/a*e.HALF_PI)+i},e.quintIn=function(e,t,i,n){return i*(e/=n)*e*e*e*e+t},e.quintInOut=function(e,t,i,n){return(e/=.5*n)<1?.5*i*e*e*e*e*e+t:.5*i*((e-=2)*e*e*e*e+2)+t},e.quintOut=function(e,t,i,n){return i*((e=e/n-1)*e*e*e*e+1)+t},e.quartIn=function(e,t,i,n){return i*(e/=n)*e*e*e+t},e.quartInOut=function(e,t,i,n){return(e/=.5*n)<1?.5*i*e*e*e*e+t:.5*-i*((e-=2)*e*e*e-2)+t},e.quartOut=function(e,t,i,n){return-i*((e=e/n-1)*e*e*e-1)+t},e.cubicIn=function(e,t,i,n){return i*(e/=n)*e*e+t},e.cubicInOut=function(e,t,i,n){return(e/=.5*n)<1?.5*i*e*e*e+t:.5*i*((e-=2)*e*e+2)+t},e.cubicOut=function(e,t,i,n){return i*((e=e/n-1)*e*e+1)+t},e.quadIn=function(e,t,i,n){return i*(e/=n)*e+t},e.quadInOut=function(e,t,i,n){return(e/=.5*n)<1?.5*i*e*e+t:.5*-i*(--e*(e-2)-1)+t},e.quadOut=function(e,t,i,n){return-i*(e/=n)*(e-2)+t},e.expoIn=function(e,t,i,n){return 0==e?t:i*Math.pow(2,10*(e/n-1))+t-.001*i},e.expoInOut=function(e,t,i,n){return 0==e?t:e==n?t+i:(e/=.5*n)<1?.5*i*Math.pow(2,10*(e-1))+t:.5*i*(2-Math.pow(2,-10*--e))+t},e.expoOut=function(e,t,i,n){return e==n?t+i:i*(1-Math.pow(2,-10*e/n))+t},e.circIn=function(e,t,i,n){return-i*(Math.sqrt(1-(e/=n)*e)-1)+t},e.circInOut=function(e,t,i,n){return(e/=.5*n)<1?.5*-i*(Math.sqrt(1-e*e)-1)+t:.5*i*(Math.sqrt(1-(e-=2)*e)+1)+t},e.circOut=function(e,t,i,n){return i*Math.sqrt(1-(e=e/n-1)*e)+t},e.HALF_PI=.5*Math.PI,e.PI2=2*Math.PI,e}(),Y=function(){function e(){this._hit=null,this._unHit=null}a(e,"laya.utils.HitArea");var t=e.prototype;return t.isHit=function(t,i){return!!e.isHitGraphic(t,i,this.hit)&&!e.isHitGraphic(t,i,this.unHit)},t.contains=function(e,t){return this.isHit(e,t)},r(0,t,"hit",function(){return this._hit||(this._hit=new _),this._hit},function(e){this._hit=e}),r(0,t,"unHit",function(){return this._unHit||(this._unHit=new _),this._unHit},function(e){this._unHit=e}),e.isHitGraphic=function(t,i,n){if(!n)return!1;var a;if(!(a=n.cmds)&&n._one&&((a=e._cmds).length=1,a[0]=n._one),!a)return!1;var r=0,o=0;o=a.length;var s;for(r=0;r<o;r++)if(s=a[r]){var h=N._context;switch(s.callee){case h._translate:case 6:t-=s[0],i-=s[1]}if(e.isHitCmd(t,i,s))return!0}return!1},e.isHitCmd=function(t,i,n){if(!n)return!1;var a=N._context,r=!1;switch(n.callee){case a._drawRect:case 13:e._rec.setTo(n[0],n[1],n[2],n[3]),r=e._rec.contains(t,i);break;case a._drawCircle:case a._fillCircle:case 14:r=(t-=n[0])*t+(i-=n[1])*i<n[2]*n[2];break;case a._drawPoly:case 18:t-=n[0],i-=n[1],r=e.ptInPolygon(t,i,n[2])}return r},e.ptInPolygon=function(t,i,n){var a;(a=e._ptPoint).setTo(t,i);var r=0,o=NaN,s=NaN,h=NaN,l=NaN,c=0;c=n.length;for(var p=0;p<c;p+=2)if(o=n[p],s=n[p+1],h=n[(p+2)%c],l=n[(p+3)%c],s!=l&&!(a.y<Math.min(s,l)||a.y>=Math.max(s,l))){(a.y-s)*(h-o)/(l-s)+o>a.x&&r++}return r%2==1},e._cmds=[],n(e,["_rec",function(){return this._rec=new k},"_ptPoint",function(){return this._ptPoint=new C}]),e}(),G=(function(){function e(t,i,n,a){this.char=t,this.charNum=t.charCodeAt(0),this._x=this._y=0,this.width=i,this.height=n,this.style=a,this.isWord=!e._isWordRegExp.test(t)}a(e,"laya.utils.HTMLChar");var t=e.prototype;i.imps(t,{"laya.display.ILayout":!0}),t.setSprite=function(e){this._sprite=e},t.getSprite=function(){return this._sprite},t._isChar=function(){return!0},t._getCSSStyle=function(){return this.style},r(0,t,"width",function(){return this._w},function(e){this._w=e}),r(0,t,"x",function(){return this._x},function(e){this._sprite&&(this._sprite.x=e),this._x=e}),r(0,t,"y",function(){return this._y},function(e){this._sprite&&(this._sprite.y=e),this._y=e}),r(0,t,"height",function(){return this._h},function(e){this._h=e}),e._isWordRegExp=new RegExp("[\\w.]","")}(),function(){function e(){}a(e,"laya.utils.Log"),e.enable=function(){e._logdiv||(e._logdiv=O.window.document.createElement("div"),O.window.document.body.appendChild(e._logdiv),e._logdiv.style.cssText="pointer-events:none;border:white;overflow:hidden;z-index:1000000;background:rgba(100,100,100,0.6);color:white;position: absolute;left:0px;top:0px;width:50%;height:50%;")},e.toggle=function(){var t=e._logdiv.style;"1px"==t.width?t.width=t.height="50%":t.width=t.height="1px"},e.print=function(t){e._logdiv&&(e._count>=e.maxCount&&e.clear(),e._count++,e._logdiv.innerText+=t+"\n",e._logdiv.scrollTop=e._logdiv.scrollHeight)},e.clear=function(){e._logdiv.innerText="",e._count=0},e._logdiv=null,e._count=0,e.maxCount=20}(),function(){function e(){}a(e,"laya.utils.Mouse"),r(1,e,"cursor",function(){return e._style.cursor},function(t){e._style.cursor=t}),e.hide=function(){"none"!=e.cursor&&(e._preCursor=e.cursor,e.cursor="none")},e.show=function(){"none"==e.cursor&&(e.cursor=e._preCursor?e._preCursor:"auto")},e._preCursor=null,n(e,["_style",function(){return this._style=O.document.body.style}])}(),function(){function e(){}return a(e,"laya.utils.Pool"),e.getPoolBySign=function(t){return e._poolDic[t]||(e._poolDic[t]=[])},e.clearBySign=function(t){e._poolDic[t]&&(e._poolDic[t].length=0)},e.recover=function(t,i){i.__InPool||(i.__InPool=!0,e.getPoolBySign(t).push(i))},e.getItemByClass=function(t,i){var n=e.getPoolBySign(t),a=n.length?n.pop():new i;return a.__InPool=!1,a},e.getItemByCreateFun=function(t,i){var n=e.getPoolBySign(t),a=n.length?n.pop():i();return a.__InPool=!1,a},e.getItem=function(t){var i=e.getPoolBySign(t),n=i.length?i.pop():null;return n&&(n.__InPool=!1),n},e._poolDic={},e.InPoolSign="__InPool",e}()),j=(function(){function e(){this.sign=null,this.maxCount=1e3}a(e,"laya.utils.PoolCache");var t=e.prototype;t.getCacheList=function(){return G.getPoolBySign(this.sign)},t.tryDispose=function(e){var t;(t=G.getPoolBySign(this.sign)).length>this.maxCount&&t.splice(this.maxCount,t.length-this.maxCount)},e.addPoolCacheManager=function(t,i){void 0===i&&(i=100);var n;(n=new e).sign=t,n.maxCount=i,U.regCacheByFunction(K.bind(n.tryDispose,n),K.bind(n.getCacheList,n))}}(),function(){function e(){}return a(e,"laya.utils.Stat"),r(1,e,"onclick",null,function(t){e._sp&&e._sp.on("click",e._sp,t),e._canvas&&(e._canvas.source.onclick=t,e._canvas.source.style.pointerEvents="")}),e.show=function(t,i){void 0===t&&(t=0),void 0===i&&(i=0),!N.isConchApp||N.isConchWebGL?(N.isConchWebGL||O.onMiniGame||O.onLimixiu||(e._useCanvas=!0),e._show=!0,e._fpsData.length=60,e._view[0]={title:"FPS(Canvas)",value:"_fpsStr",color:"yellow",units:"int"},e._view[1]={title:"Sprite",value:"_spriteStr",color:"white",units:"int"},e._view[2]={title:"DrawCall",value:"drawCall",color:"white",units:"int"},e._view[3]={title:"CurMem",value:"currentMemorySize",color:"yellow",units:"M"},N.isWebGL?(e._view[4]={title:"Shader",value:"shaderCall",color:"white",units:"int"},N.is3DMode?(e._view[0].title="FPS(3D)",e._view[5]={title:"TriFaces",value:"trianglesFaces",color:"white",units:"int"},e._view[6]={title:"treeNodeColl",value:"treeNodeCollision",color:"white",units:"int"},e._view[7]={title:"treeSpriteColl",value:"treeSpriteCollision",color:"white",units:"int"}):(e._view[0].title="FPS(WebGL)",e._view[5]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"})):e._view[4]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"},e._useCanvas?e.createUIPre(t,i):e.createUI(t,i),e.enable()):O.window.conch.showFPS&&O.window.conch.showFPS(t,i)},e.createUIPre=function(t,i){var n=O.pixelRatio;e._width=130*n,e._vx=75*n,e._height=n*(12*e._view.length+3*n)+4,e._fontSize=12*n;for(var a=0;a<e._view.length;a++)e._view[a].x=4,e._view[a].y=a*e._fontSize+2*n;e._canvas||((e._canvas=new xe("2D")).size(e._width,e._height),(e._ctx=e._canvas.getContext("2d")).textBaseline="top",e._ctx.font=e._fontSize+"px Sans-serif",e._canvas.source.style.cssText="pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:"+t+"px;top:"+i+"px;width:"+e._width/n+"px;height:"+e._height/n+"px;"),e._first=!0,e.loop(),e._first=!1,O.container.appendChild(e._canvas.source)},e.createUI=function(t,i){var n=e._sp,a=O.pixelRatio;n||(n=new ue,(e._leftText=new ge).pos(5,5),e._leftText.color="#ffffff",n.addChild(e._leftText),(e._txt=new ge).pos(80*a,5),e._txt.color="#ffffff",n.addChild(e._txt),e._sp=n),n.pos(t,i);for(var r="",o=0;o<e._view.length;o++){r+=e._view[o].title+"\n"}e._leftText.text=r;var s=138*a,h=a*(12*e._view.length+3*a)+4;e._txt.fontSize=e._fontSize*a,e._leftText.fontSize=e._fontSize*a,n.size(s,h),n.graphics.clear(),n.graphics.setAlpha(.5),n.graphics.drawRect(0,0,s,h,"#999999"),n.graphics.setAlpha(1),e.loop()},e.enable=function(){i.timer.frameLoop(1,e,e.loop)},e.hide=function(){e._show=!1,i.timer.clear(e,e.loop),e._canvas&&O.removeElement(e._canvas.source)},e.clear=function(){e.trianglesFaces=e.drawCall=e.shaderCall=e.spriteCount=e.spriteRenderUseCacheCount=e.treeNodeCollision=e.treeSpriteCollision=e.canvasNormal=e.canvasBitmap=e.canvasReCache=0},e.loop=function(){e._count++;var t=O.now();if(!(t-e._timer<1e3)){var i=e._count;if(e.FPS=Math.round(1e3*i/(t-e._timer)),e._show){e.trianglesFaces=Math.round(e.trianglesFaces/i),e._useCanvas?(e.drawCall=Math.round(e.drawCall/i)-2,e.shaderCall=Math.round(e.shaderCall/i),e.spriteCount=Math.round(e.spriteCount/i)-1):(e.drawCall=Math.round(e.drawCall/i)-2,e.shaderCall=Math.round(e.shaderCall/i)-4,e.spriteCount=Math.round(e.spriteCount/i)-4),e.spriteRenderUseCacheCount=Math.round(e.spriteRenderUseCacheCount/i),e.canvasNormal=Math.round(e.canvasNormal/i),e.canvasBitmap=Math.round(e.canvasBitmap/i),e.canvasReCache=Math.ceil(e.canvasReCache/i),e.treeNodeCollision=Math.round(e.treeNodeCollision/i),e.treeSpriteCollision=Math.round(e.treeSpriteCollision/i);var n=e.FPS>0?Math.floor(1e3/e.FPS).toString():" ";e._fpsStr=e.FPS+(e.renderSlow?" slow":"")+" "+n,e._spriteStr=e.spriteCount+(e.spriteRenderUseCacheCount?"/"+e.spriteRenderUseCacheCount:""),e._canvasStr=e.canvasReCache+"/"+e.canvasNormal+"/"+e.canvasBitmap,e.currentMemorySize=P.systemResourceManager.memorySize,e._useCanvas?e.renderInfoPre():e.renderInfo(),e.clear()}e._count=0,e._timer=t}},e.renderInfoPre=function(){if(e._canvas){var t=e._ctx;t.clearRect(e._first?0:e._vx,0,e._width,e._height);for(var i=0;i<e._view.length;i++){var n=e._view[i];e._first&&(t.fillStyle="white",t.fillText(n.title,n.x,n.y,null,null,null)),t.fillStyle=n.color;var a=e[n.value];"M"==n.units&&(a=Math.floor(a/1048576*100)/100+" M"),t.fillText(a+"",n.x+e._vx,n.y,null,null,null)}}},e.renderInfo=function(){for(var t="",i=0;i<e._view.length;i++){var n=e._view[i],a=e[n.value];"M"==n.units&&(a=Math.floor(a/1048576*100)/100+" M"),"K"==n.units&&(a=Math.floor(a/1024*100)/100+" K"),t+=a+"\n"}e._txt.text=t},e.FPS=0,e.loopCount=0,e.shaderCall=0,e.drawCall=0,e.trianglesFaces=0,e.spriteCount=0,e.spriteRenderUseCacheCount=0,e.treeNodeCollision=0,e.treeSpriteCollision=0,e.canvasNormal=0,e.canvasBitmap=0,e.canvasReCache=0,e.renderSlow=!1,e.currentMemorySize=0,e._fpsStr=null,e._canvasStr=null,e._spriteStr=null,e._fpsData=[],e._timer=0,e._count=0,e._view=[],e._fontSize=12,e._txt=null,e._leftText=null,e._sp=null,e._show=!1,e._useCanvas=!1,e._canvas=null,e._ctx=null,e._first=!1,e._vx=NaN,e._width=0,e._height=100,e}()),W=(function(){function e(){this._strsToID={},this._idToStrs=[],this._length=0}a(e,"laya.utils.StringKey");var t=e.prototype;t.add=function(e){var t=this._strsToID[e];return null!=t?t:(this._idToStrs[this._length]=e,this._strsToID[e]=this._length++)},t.getID=function(e){var t=this._strsToID[e];return null==t?-1:t},t.getName=function(e){var t=this._idToStrs[e];return null==t?void 0:t}}(),function(){function e(){this._delta=0,this.scale=1,this.currFrame=0,this._mid=1,this._map=[],this._laters=[],this._handlers=[],this._temp=[],this._count=0,this.currTimer=this._now(),this._lastTimer=this._now(),this._init()}var t;a(e,"laya.utils.Timer");var n=e.prototype;return n._init=function(){i.timer&&i.timer.frameLoop(1,this,this._update)},n._now=function(){return Date.now()},n._update=function(){if(this.scale<=0)this._lastTimer=this._now();else{var e=this.currFrame=this.currFrame+this.scale,t=this._now();this._delta=(t-this._lastTimer)*this.scale;var i=this.currTimer=this.currTimer+this._delta;this._lastTimer=t;var n=this._handlers;for(this._count=0,o=0,s=n.length;o<s;o++)if(null!==(h=n[o]).method){var a=h.userFrame?e:i;if(a>=h.exeTime)if(h.repeat)if(h.jumpFrame)for(;a>=h.exeTime;)h.exeTime+=h.delay,h.run(!1);else h.exeTime+=h.delay,h.run(!1),a>h.exeTime&&(h.exeTime+=Math.ceil((a-h.exeTime)/h.delay)*h.delay);else h.run(!0)}else this._count++;(this._count>30||e%200==0)&&this._clearHandlers();for(var r=this._laters,o=0,s=r.length-1;o<=s;o++){var h=r[o];null!==h.method&&(this._map[h.key]=null,h.run(!1)),this._recoverHandler(h),o===s&&(s=r.length-1)}r.length=0}},n._clearHandlers=function(){for(var e=this._handlers,t=0,i=e.length;t<i;t++){var n=e[t];null!==n.method?this._temp.push(n):this._recoverHandler(n)}this._handlers=this._temp,this._temp=e,this._temp.length=0},n._recoverHandler=function(t){this._map[t.key]==t&&(this._map[t.key]=null),t.clear(),e._pool.push(t)},n._create=function(i,n,a,r,o,s,h){if(!a)return o.apply(r,s),null;if(h){var l=this._getHandler(r,o);if(l)return l.repeat=n,l.userFrame=i,l.delay=a,l.caller=r,l.method=o,l.args=s,l.exeTime=a+(i?this.currFrame:this.currTimer+this._now()-this._lastTimer),l}return l=e._pool.length>0?e._pool.pop():new t,l.repeat=n,l.userFrame=i,l.delay=a,l.caller=r,l.method=o,l.args=s,l.exeTime=a+(i?this.currFrame:this.currTimer+this._now()-this._lastTimer)+1,this._indexHandler(l),this._handlers.push(l),l},n._indexHandler=function(e){var t=e.caller,i=e.method,n=t?t.$_GID||(t.$_GID=K.getGID()):0,a=i.$_TID||(i.$_TID=1e5*this._mid++);e.key=n+a,this._map[e.key]=e},n.once=function(e,t,i,n,a){void 0===a&&(a=!0),this._create(!1,!1,e,t,i,n,a)},n.loop=function(e,t,i,n,a,r){void 0===a&&(a=!0),void 0===r&&(r=!1);var o=this._create(!1,!0,e,t,i,n,a);o&&(o.jumpFrame=r)},n.frameOnce=function(e,t,i,n,a){void 0===a&&(a=!0),this._create(!0,!1,e,t,i,n,a)},n.frameLoop=function(e,t,i,n,a){void 0===a&&(a=!0),this._create(!0,!0,e,t,i,n,a)},n.toString=function(){return"callLater:"+this._laters.length+" handlers:"+this._handlers.length+" pool:"+e._pool.length},n.clear=function(e,t){var i=this._getHandler(e,t);i&&(this._map[i.key]=null,i.key=0,i.clear())},n.clearAll=function(e){if(e)for(var t=0,i=this._handlers.length;t<i;t++){var n=this._handlers[t];n.caller===e&&(this._map[n.key]=null,n.key=0,n.clear())}},n._getHandler=function(e,t){var i=e?e.$_GID||(e.$_GID=K.getGID()):0,n=t.$_TID||(t.$_TID=1e5*this._mid++);return this._map[i+n]},n.callLater=function(i,n,a){if(null==this._getHandler(i,n)){if(e._pool.length)var r=e._pool.pop();else r=new t;r.caller=i,r.method=n,r.args=a,this._indexHandler(r),this._laters.push(r)}},n.runCallLater=function(e,t){var i=this._getHandler(e,t);i&&null!=i.method&&(this._map[i.key]=null,i.run(!0))},n.runTimer=function(e,t){this.runCallLater(e,t)},r(0,n,"delta",function(){return this._delta}),e._pool=[],e.__init$=function(){t=function(){function e(){this.key=0,this.repeat=!1,this.delay=0,this.userFrame=!1,this.exeTime=0,this.caller=null,this.method=null,this.args=null,this.jumpFrame=!1}a(e,"");var t=e.prototype;return t.clear=function(){this.caller=null,this.method=null,this.args=null},t.run=function(e){var t=this.caller;if(t&&t.destroyed)return this.clear();var i=this.method,n=this.args;e&&this.clear(),null!=i&&(n?i.apply(t,n):i.call(t))},e}()},e}()),q=function(){function e(){this.gid=0}a(e,"laya.utils.Tween");var t=e.prototype;return t.to=function(e,t,i,n,a,r,o){return void 0===r&&(r=0),void 0===o&&(o=!1),this._create(e,t,i,n,a,r,o,!0,!1,!0)},t.from=function(e,t,i,n,a,r,o){return void 0===r&&(r=0),void 0===o&&(o=!1),this._create(e,t,i,n,a,r,o,!1,!1,!0)},t._create=function(t,n,a,r,o,s,h,l,c,p){if(!t)throw new Error("Tween:target is null");this._target=t,this._duration=a,this._ease=r||n.ease||e.easeNone,this._complete=o||n.complete,this._delay=s,this._props=[],this._usedTimer=0,this._startTimer=O.now(),this._usedPool=c,this._delayParam=null,this.update=n.update;var u=t.$_GID||(t.$_GID=K.getGID());return e.tweenMap[u]?(h&&e.clearTween(t),e.tweenMap[u].push(this)):e.tweenMap[u]=[this],p?s<=0?this.firstStart(t,n,l):(this._delayParam=[t,n,l],i.scaleTimer.once(s,this,this.firstStart,this._delayParam)):this._initProps(t,n,l),this},t.firstStart=function(e,t,i){this._delayParam=null,e.destroyed?this.clear():(this._initProps(e,t,i),this._beginLoop())},t._initProps=function(e,t,i){for(var n in t)if("number"==typeof e[n]){var a=i?e[n]:t[n],r=i?t[n]:e[n];this._props.push([n,a,r-a]),i||(e[n]=a)}},t._beginLoop=function(){i.scaleTimer.frameLoop(1,this,this._doEase)},t._doEase=function(){this._updateEase(O.now())},t._updateEase=function(t){var i=this._target;if(i){if(i.destroyed)return e.clearTween(i);var n=this._usedTimer=t-this._startTimer-this._delay;if(!(n<0)){if(n>=this._duration)return this.complete();for(var a=n>0?this._ease(n,0,1,this._duration):0,r=this._props,o=0,s=r.length;o<s;o++){var h=r[o];i[h[0]]=h[1]+a*h[2]}this.update&&this.update.run()}}},t.complete=function(){if(this._target){i.scaleTimer.runTimer(this,this.firstStart);for(var e=this._target,t=this._props,n=this._complete,a=0,r=t.length;a<r;a++){var o=t[a];e[o[0]]=o[1]+o[2]}this.update&&this.update.run(),this.clear(),n&&n.run()}},t.pause=function(){i.scaleTimer.clear(this,this._beginLoop),i.scaleTimer.clear(this,this._doEase),i.scaleTimer.clear(this,this.firstStart);var e=NaN;(e=O.now()-this._startTimer-this._delay)<0&&(this._usedTimer=e)},t.setStartTime=function(e){this._startTimer=e},t.clear=function(){this._target&&(this._remove(),this._clear())},t._clear=function(){this.pause(),i.scaleTimer.clear(this,this.firstStart),this._complete=null,this._target=null,this._ease=null,this._props=null,this._delayParam=null,this._usedPool&&(this.update=null,G.recover("tween",this))},t.recover=function(){this._usedPool=!0,this._clear()},t._remove=function(){var t=e.tweenMap[this._target.$_GID];if(t)for(var i=0,n=t.length;i<n;i++)if(t[i]===this){t.splice(i,1);break}},t.restart=function(){if(this.pause(),this._usedTimer=0,this._startTimer=O.now(),this._delayParam)i.scaleTimer.once(this._delay,this,this.firstStart,this._delayParam);else{for(var e=this._props,t=0,n=e.length;t<n;t++){var a=e[t];this._target[a[0]]=a[1]}i.scaleTimer.once(this._delay,this,this._beginLoop)}},t.resume=function(){this._usedTimer>=this._duration||(this._startTimer=O.now()-this._usedTimer-this._delay,this._delayParam?this._usedTimer<0?i.scaleTimer.once(-this._usedTimer,this,this.firstStart,this._delayParam):this.firstStart.apply(this,this._delayParam):this._beginLoop())},r(0,t,"progress",null,function(e){var t=e*this._duration;this._startTimer=O.now()-this._delay-t}),e.to=function(t,i,n,a,r,o,s,h){return void 0===o&&(o=0),void 0===s&&(s=!1),void 0===h&&(h=!0),G.getItemByClass("tween",e)._create(t,i,n,a,r,o,s,!0,h,!0)},e.from=function(t,i,n,a,r,o,s,h){return void 0===o&&(o=0),void 0===s&&(s=!1),void 0===h&&(h=!0),G.getItemByClass("tween",e)._create(t,i,n,a,r,o,s,!1,h,!0)},e.clearAll=function(t){if(t&&t.$_GID){var i=e.tweenMap[t.$_GID];if(i){for(var n=0,a=i.length;n<a;n++)i[n]._clear();i.length=0}}},e.clear=function(e){e.clear()},e.clearTween=function(t){e.clearAll(t)},e.easeNone=function(e,t,i,n){return i*e/n+t},e.tweenMap={},e}(),K=function(){function e(){}return a(e,"laya.utils.Utils"),e.toRadian=function(t){return t*e._pi2},e.toAngle=function(t){return t*e._pi},e.toHexColor=function(e){if(e<0||isNaN(e))return null;for(var t=e.toString(16);t.length<6;)t="0"+t;return"#"+t},e.getGID=function(){return e._gid++},e.concatArray=function(e,t){if(!t)return e;if(!e)return t;var i=0,n=t.length;for(i=0;i<n;i++)e.push(t[i]);return e},e.clearArray=function(e){return e?(e.length=0,e):e},e.copyArray=function(e,t){if(e||(e=[]),!t)return e;e.length=t.length;var i=0,n=t.length;for(i=0;i<n;i++)e[i]=t[i];return e},e.getGlobalRecByPoints=function(e,t,i,n,a){var r;r=new C(t,i),r=e.localToGlobal(r);var o;return o=new C(n,a),o=e.localToGlobal(o),k._getWrapRec([r.x,r.y,o.x,o.y])},e.getGlobalPosAndScale=function(t){return e.getGlobalRecByPoints(t,0,0,1,1)},e.bind=function(e,t){return e.bind(t)},e.measureText=function(e,t){return o.measureText(e,t)},e.updateOrder=function(e){if(!e||e.length<2)return!1;for(var t,i=1,n=0,a=e.length,r=NaN;i<a;){for(t=e[n=i],r=e[n]._zOrder;--n>-1&&e[n]._zOrder>r;)e[n+1]=e[n];e[n+1]=t,i++}var o=t.parent.conchModel;if(o)if(null!=o.updateZOrder)o.updateZOrder();else{for(i=0;i<a;i++)o.removeChild(e[i].conchModel);for(i=0;i<a;i++)o.addChildAt(e[i].conchModel,i)}return!0},e.transPointList=function(e,t,i){var n=0,a=e.length;for(n=0;n<a;n+=2)e[n]+=t,e[n+1]+=i},e.parseInt=function(e,t){void 0===t&&(t=0);var i=O.window.parseInt(e,t);return isNaN(i)?0:i},e.getFileExtension=function(t){e._extReg.lastIndex=t.lastIndexOf(".");var i=e._extReg.exec(t);return i&&i.length>1?i[1].toLowerCase():null},e.getTransformRelativeToWindow=function(e,t,n){var a=i.stage,r=laya.utils.Utils.getGlobalPosAndScale(e),o=a._canvasTransform.clone(),s=o.tx,h=o.ty;o.rotate(-Math.PI/180*i.stage.canvasDegree),o.scale(i.stage.clientScaleX,i.stage.clientScaleY);var l=i.stage.canvasDegree%180!=0,c=NaN,p=NaN;l?(c=n+r.y,p=t+r.x,c*=o.d,p*=o.a,90==i.stage.canvasDegree?(c=s-c,p+=h):(c+=s,p=h-p)):(c=t+r.x,p=n+r.y,c*=o.a,p*=o.d,c+=s,p+=h);var u=NaN,d=NaN;return l?(u=o.d*r.height,d=o.a*r.width):(u=o.a*r.width,d=o.d*r.height),{x:c,y:p,scaleX:u,scaleY:d}},e.fitDOMElementInArea=function(t,n,a,r,o,s){t._fitLayaAirInitialized||(t._fitLayaAirInitialized=!0,t.style.transformOrigin=t.style.webKittransformOrigin="left top",t.style.position="absolute");var h=e.getTransformRelativeToWindow(n,a,r);t.style.transform=t.style.webkitTransform="scale("+h.scaleX+","+h.scaleY+") rotate("+i.stage.canvasDegree+"deg)",t.style.width=o+"px",t.style.height=s+"px",t.style.left=h.x+"px",t.style.top=h.y+"px"},e.isOkTextureList=function(e){if(!e)return!1;var t,i=0,n=e.length;for(i=0;i<n;i++)if(!(t=e[i])||!t.source)return!1;return!0},e.isOKCmdList=function(e){if(!e)return!1;var t,i,n=0,a=e.length,r=N._context;for(n=0;n<a;n++)switch((t=e[n]).callee){case r._drawTexture:case r._fillTexture:case r._drawTextureWithTransform:if(!(i=t[0])||!i.source)return!1}return!0},e._gid=1,e._pi=180/Math.PI,e._pi2=Math.PI/180,e._extReg=/\.(\w+)\??/g,e.parseXMLFromString=function(e){var t;if(e=e.replace(/>\s+</g,"><"),(t=(new DOMParser).parseFromString(e,"text/xml")).firstChild.textContent.indexOf("This page contains the following errors")>-1)throw new Error(t.firstChild.firstChild.textContent);return t},e}(),J=function(){function e(){this.useDic={},this.shapeDic={},this.shapeLineDic={},this._id=0,this._checkKey=!1,this._freeIdArray=[],N.isWebGL&&U.regCacheByFunction(K.bind(this.startDispose,this),K.bind(this.getCacheList,this))}a(e,"laya.utils.VectorGraphManager");var t=e.prototype;return t.getId=function(){return this._id++},t.addShape=function(e,t){this.shapeDic[e]=t,this.useDic[e]||(this.useDic[e]=!0)},t.addLine=function(e,t){this.shapeLineDic[e]=t,this.shapeLineDic[e]||(this.shapeLineDic[e]=!0)},t.getShape=function(e){this._checkKey&&null!=this.useDic[e]&&(this.useDic[e]=!0)},t.deleteShape=function(e){this.shapeDic[e]&&(this.shapeDic[e]=null,delete this.shapeDic[e]),this.shapeLineDic[e]&&(this.shapeLineDic[e]=null,delete this.shapeLineDic[e]),null!=this.useDic[e]&&delete this.useDic[e]},t.getCacheList=function(){var e,t=[];for(e in this.shapeDic)t.push(this.shapeDic[e]);for(e in this.shapeLineDic)t.push(this.shapeLineDic[e]);return t},t.startDispose=function(e){var t;for(t in this.useDic)this.useDic[t]=!1;this._checkKey=!0},t.endDispose=function(){if(this._checkKey){var e;for(e in this.useDic)this.useDic[e]||this.deleteShape(e);this._checkKey=!1}},e.getInstance=function(){return e.instance=e.instance||new e},e.instance=null,e}(),Z=function(){function e(){this._obj=null,this._obj=e.supportWeakMap?new O.window.WeakMap:{},e.supportWeakMap||e._maps.push(this)}a(e,"laya.utils.WeakObject");var t=e.prototype;return t.set=function(t,i){if(null!=t)if(e.supportWeakMap){var n=t;"string"!=typeof t&&"number"!=typeof t||(n=e._keys[t])||(n=e._keys[t]={k:t}),this._obj.set(n,i)}else"string"==typeof t||"number"==typeof t?this._obj[t]=i:(t.$_GID||(t.$_GID=K.getGID()),this._obj[t.$_GID]=i)},t.get=function(t){if(null==t)return null;if(e.supportWeakMap){var i="string"==typeof t||"number"==typeof t?e._keys[t]:t;return i?this._obj.get(i):null}return"string"==typeof t||"number"==typeof t?this._obj[t]:this._obj[t.$_GID]},t.del=function(t){if(null!=t)if(e.supportWeakMap){var i="string"==typeof t||"number"==typeof t?e._keys[t]:t;if(!i)return;this._obj.delete(i)}else"string"==typeof t||"number"==typeof t?delete this._obj[t]:delete this._obj[this._obj.$_GID]},t.has=function(t){if(null==t)return!1;if(e.supportWeakMap){var i="string"==typeof t||"number"==typeof t?e._keys[t]:t;return this._obj.has(i)}return"string"==typeof t||"number"==typeof t?null!=this._obj[t]:null!=this._obj[this._obj.$_GID]},e.__init__=function(){(e.supportWeakMap=null!=O.window.WeakMap)||i.timer.loop(e.delInterval,null,e.clearCache)},e.clearCache=function(){for(var t=0,i=e._maps.length;t<i;t++){e._maps[t]._obj={}}},e.supportWeakMap=!1,e.delInterval=3e5,e._keys={},e._maps=[],n(e,["I",function(){return this.I=new e}]),e}(),Q=function(){function e(){this.id=NaN,this.save=[],this.toUpperCase=null,this.changed=!1,this._text=null}a(e,"laya.utils.WordText");var t=e.prototype;return t.setText=function(e){this.changed=!0,this._text=e},t.toString=function(){return this._text},t.charCodeAt=function(e){return this._text?this._text.charCodeAt(e):NaN},t.charAt=function(e){return this._text?this._text.charAt(e):null},r(0,t,"length",function(){return this._text?this._text.length:0}),e}(),$=function(e){function t(){this._bits=0,this._displayedInStage=!1,this._parent=null,this.conchModel=null,this.name="",this._destroyed=!1,t.__super.call(this),this._childs=t.ARRAY_EMPTY,this._$P=t.PROP_EMPTY,this.timer=i.scaleTimer,this.conchModel=N.isConchNode?this.createConchModel():null}a(t,"laya.display.Node",h);var n=t.prototype;return n._setBit=function(e,t){if(1==e){this._getBit(e)!=t&&this._updateDisplayedInstage()}t?this._bits|=e:this._bits&=~e},n._getBit=function(e){return 0!=(this._bits&e)},n._setUpNoticeChain=function(){this._getBit(1)&&this._setUpNoticeType(1)},n._setUpNoticeType=function(e){var t=this;for(t._setBit(e,!0),t=t.parent;t;){if(t._getBit(e))return;t._setBit(e,!0),t=t.parent}},n.on=function(e,t,i,n){return"display"!==e&&"undisplay"!==e||this._getBit(1)||this._setUpNoticeType(1),this._createListener(e,t,i,n,!1)},n.once=function(e,t,i,n){return"display"!==e&&"undisplay"!==e||this._getBit(1)||this._setUpNoticeType(1),this._createListener(e,t,i,n,!0)},n.createConchModel=function(){return null},n.destroy=function(e){void 0===e&&(e=!0),this._destroyed=!0,this._parent&&this._parent.removeChild(this),this._childs&&(e?this.destroyChildren():this.removeChildren()),this._childs=null,this._$P=null,this.offAll(),this.timer.clearAll(this)},n.destroyChildren=function(){if(this._childs)for(var e=this._childs.length-1;e>-1;e--)this._childs[e].destroy(!0)},n.addChild=function(e){if(!e||this.destroyed||e===this)return e;if(e.zOrder&&this._set$P("hasZorder",!0),e._parent===this){var i=this.getChildIndex(e);i!==this._childs.length-1&&(this._childs.splice(i,1),this._childs.push(e),this.conchModel&&(this.conchModel.removeChild(e.conchModel),this.conchModel.addChildAt(e.conchModel,this._childs.length-1)),this._childChanged())}else e.parent&&e.parent.removeChild(e),this._childs===t.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(e),this.conchModel&&this.conchModel.addChildAt(e.conchModel,this._childs.length-1),e.parent=this,this._childChanged();return e},n.addChildren=function(e){for(var t=arguments,i=0,n=t.length;i<n;)this.addChild(t[i++])},n.addChildAt=function(e,i){if(!e||this.destroyed||e===this)return e;if(e.zOrder&&this._set$P("hasZorder",!0),i>=0&&i<=this._childs.length){if(e._parent===this){var n=this.getChildIndex(e);this._childs.splice(n,1),this._childs.splice(i,0,e),this.conchModel&&(this.conchModel.removeChild(e.conchModel),this.conchModel.addChildAt(e.conchModel,i)),this._childChanged()}else e.parent&&e.parent.removeChild(e),this._childs===t.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(i,0,e),this.conchModel&&this.conchModel.addChildAt(e.conchModel,i),e.parent=this;return e}throw new Error("appendChildAt:The index is out of bounds")},n.getChildIndex=function(e){return this._childs.indexOf(e)},n.getChildByName=function(e){var t=this._childs;if(t)for(var i=0,n=t.length;i<n;i++){var a=t[i];if(a.name===e)return a}return null},n._get$P=function(e){return this._$P[e]},n._set$P=function(e,i){return this.destroyed||(this._$P===t.PROP_EMPTY&&(this._$P={}),this._$P[e]=i),i},n.getChildAt=function(e){return this._childs[e]},n.setChildIndex=function(e,t){var i=this._childs;if(t<0||t>=i.length)throw new Error("setChildIndex:The index is out of bounds.");var n=this.getChildIndex(e);if(n<0)throw new Error("setChildIndex:node is must child of this object.");return i.splice(n,1),i.splice(t,0,e),this.conchModel&&(this.conchModel.removeChild(e.conchModel),this.conchModel.addChildAt(e.conchModel,t)),this._childChanged(),e},n._childChanged=function(e){},n.removeChild=function(e){if(!this._childs)return e;var t=this._childs.indexOf(e);return this.removeChildAt(t)},n.removeSelf=function(){return this._parent&&this._parent.removeChild(this),this},n.removeChildByName=function(e){var t=this.getChildByName(e);return t&&this.removeChild(t),t},n.removeChildAt=function(e){var t=this.getChildAt(e);return t&&(this._childs.splice(e,1),this.conchModel&&this.conchModel.removeChild(t.conchModel),t.parent=null),t},n.removeChildren=function(e,i){if(void 0===e&&(e=0),void 0===i&&(i=2147483647),this._childs&&this._childs.length>0){var n=this._childs;if(0===e&&i>=o){var a=n;this._childs=t.ARRAY_EMPTY}else a=n.splice(e,i-e);for(var r=0,o=a.length;r<o;r++)a[r].parent=null,this.conchModel&&this.conchModel.removeChild(a[r].conchModel)}return this},n.replaceChild=function(e,t){var i=this._childs.indexOf(t);return i>-1?(this._childs.splice(i,1,e),this.conchModel&&(this.conchModel.removeChild(t.conchModel),this.conchModel.addChildAt(e.conchModel,i)),t.parent=null,e.parent=this,e):null},n._updateDisplayedInstage=function(){var e;e=this;var t=i.stage;for(this._displayedInStage=!1;e;){if(e._getBit(1)){this._displayedInStage=e._displayedInStage;break}if(e==t||e._displayedInStage){this._displayedInStage=!0;break}e=e.parent}},n._setDisplay=function(e){this._displayedInStage!==e&&(this._displayedInStage=e,e?this.event("display"):this.event("undisplay"))},n._displayChild=function(e,t){var i=e._childs;if(i)for(var n=0,a=i.length;n<a;n++){var r=i[n];r._getBit(1)&&(r._childs.length>0?this._displayChild(r,t):r._setDisplay(t))}e._setDisplay(t)},n.contains=function(e){if(e===this)return!0;for(;e;){if(e.parent===this)return!0;e=e.parent}return!1},n.timerLoop=function(e,t,i,n,a,r){void 0===a&&(a=!0),void 0===r&&(r=!1),this.timer.loop(e,t,i,n,a,r)},n.timerOnce=function(e,t,i,n,a){void 0===a&&(a=!0),this.timer._create(!1,!1,e,t,i,n,a)},n.frameLoop=function(e,t,i,n,a){void 0===a&&(a=!0),this.timer._create(!0,!0,e,t,i,n,a)},n.frameOnce=function(e,t,i,n,a){void 0===a&&(a=!0),this.timer._create(!0,!1,e,t,i,n,a)},n.clearTimer=function(e,t){this.timer.clear(e,t)},r(0,n,"numChildren",function(){return this._childs.length}),r(0,n,"destroyed",function(){return this._destroyed}),r(0,n,"parent",function(){return this._parent},function(e){this._parent!==e&&(e?(this._parent=e,this.event("added"),this._getBit(1)&&(this._setUpNoticeChain(),e.displayedInStage&&this._displayChild(this,!0)),e._childChanged(this)):(this.event("removed"),this._parent._childChanged(),this._getBit(1)&&this._displayChild(this,!1),this._parent=e))}),r(0,n,"displayedInStage",function(){return this._getBit(1)?this._displayedInStage:(this._setUpNoticeType(1),this._displayedInStage)}),t.ARRAY_EMPTY=[],t.PROP_EMPTY={},t.NOTICE_DISPLAY=1,t.MOUSEENABLE=2,t}(),ee=function(e){function t(e){this._bgground=null,this._border=null,this._rect=null,this.underLine=0,this.lineHeight=0,t.__super.call(this),this._padding=t._PADDING,this._spacing=t._SPACING,this._aligns=t._ALIGNS,this._font=u.EMPTY,this._ower=e}a(t,"laya.display.css.CSSStyle",e);var i=t.prototype;return i.destroy=function(){this._ower=null,this._font=null,this._rect=null},i.inherit=function(e){this._font=e._font,this._spacing=e._spacing===t._SPACING?t._SPACING:e._spacing.slice(),this.lineHeight=e.lineHeight},i._widthAuto=function(){return 0!=(262144&this._type)},i.widthed=function(e){return 0!=(8&this._type)},i._calculation=function(e,t){function i(e,t,i){return e*i[0]+t*i[1]+i[2]}function n(e){var t=r.width,n=a.width;o.width&&(a.width=i(t,n,o.width)),o.height&&(a.height=i(t,n,o.height)),o.left&&(a.x=i(t,n,o.left)),o.top&&(a.y=i(t,n,o.top))}if(t.indexOf("%")<0)return!1;var a=this._ower,r=a.parent,o=this._rect;null===o&&(r._getCSSStyle()._type|=524288,r.on("resize",this,n),this._rect=o={input:{}});var s=t.split(" ");return s[0]=parseFloat(s[0])/100,1==s.length?s[1]=s[2]=0:(s[1]=parseFloat(s[1])/100,s[2]=parseFloat(s[2])),o[e]=s,o.input[e]=t,n(),!0},i.heighted=function(e){return 0!=(8192&this._type)},i.size=function(e,t){var i=this._ower,n=!1;-1!==e&&e!=this._ower.width&&(this._type|=8,this._ower.width=e,n=!0),-1!==t&&t!=this._ower.height&&(this._type|=8192,this._ower.height=t,n=!0),n&&(i._layoutLater(),524288&this._type&&i.event("resize",this))},i._getAlign=function(){return this._aligns[0]},i._getValign=function(){return this._aligns[1]},i._getCssFloat=function(){return 0!=(32768&this._type)?32768:0},i._createFont=function(){return 4096&this._type?this._font:(this._type|=4096,this._font=new u(this._font))},i.render=function(e,t,i,n){var a=e.width,r=e.height;i-=e.pivotX,n-=e.pivotY,this._bgground&&null!=this._bgground.color&&t.ctx.fillRect(i,n,a,r,this._bgground.color),this._border&&this._border.color&&t.drawRect(i,n,a,r,this._border.color.strColor,this._border.size)},i.getCSSStyle=function(){return this},i.cssText=function(e){this.attrs(t.parseOneCSS(e,";"))},i.attrs=function(e){if(e)for(var t=0,i=e.length;t<i;t++){var n=e[t];this[n[0]]=n[1]}},i.setTransform=function(e){"none"===e?this._tf=p._TF_EMPTY:this.attrs(t.parseOneCSS(e,","))},i.translate=function(e,t){this._tf===p._TF_EMPTY&&(this._tf=new d),this._tf.translateX=e,this._tf.translateY=t},i.scale=function(e,t){this._tf===p._TF_EMPTY&&(this._tf=new d),this._tf.scaleX=e,this._tf.scaleY=t},i._enableLayout=function(){return 0==(2&this._type)&&0==(4&this._type)},r(0,i,"block",e.prototype._$get_block,function(e){e?this._type|=1:this._type&=-2}),r(0,i,"valign",function(){return t._valigndef[this._aligns[1]]},function(e){this._aligns===t._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[1]=t._valigndef[e]}),r(0,i,"height",null,function(e){if(this._type|=8192,"string"==typeof e){if(this._calculation("height",e))return;e=parseInt(e)}this.size(-1,e)}),r(0,i,"width",null,function(e){if(this._type|=8,"string"==typeof e){var t=e.indexOf("auto");if(t>=0&&(this._type|=262144,e=e.substr(0,t)),this._calculation("width",e))return;e=parseInt(e)}this.size(e,-1)}),r(0,i,"fontWeight",function(){return this._font.weight},function(e){this._createFont().weight=e}),r(0,i,"left",null,function(e){var t=this._ower;if("string"==typeof e){if("center"===e?e="50% -50% 0":"right"===e&&(e="100% -100% 0"),this._calculation("left",e))return;e=parseInt(e)}t.x=e}),r(0,i,"_translate",null,function(e){this.translate(e[0],e[1])}),r(0,i,"absolute",function(){return 0!=(4&this._type)}),r(0,i,"top",null,function(e){var t=this._ower;if("string"==typeof e){if("middle"===e?e="50% -50% 0":"bottom"===e&&(e="100% -100% 0"),this._calculation("top",e))return;e=parseInt(e)}t.y=e}),r(0,i,"align",function(){return t._aligndef[this._aligns[0]]},function(e){this._aligns===t._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[0]=t._aligndef[e]}),r(0,i,"bold",function(){return this._font.bold},function(e){this._createFont().bold=e}),r(0,i,"padding",function(){return this._padding},function(e){this._padding=e}),r(0,i,"leading",function(){return this._spacing[1]},function(e){"string"==typeof e&&(e=parseInt(e+"")),this._spacing===t._SPACING&&(this._spacing=[0,0]),this._spacing[1]=e}),r(0,i,"lineElement",function(){return 0!=(65536&this._type)},function(e){e?this._type|=65536:this._type&=-65537}),r(0,i,"cssFloat",function(){return 0!=(32768&this._type)?"right":"left"},function(e){this.lineElement=!1,"right"===e?this._type|=32768:this._type&=-32769}),r(0,i,"textDecoration",function(){return this._font.decoration},function(e){this._createFont().decoration=e}),r(0,i,"whiteSpace",function(){return 131072&this._type?"nowrap":""},function(e){"nowrap"===e&&(this._type|=131072),"none"===e&&(this._type&=-131073)}),r(0,i,"background",null,function(e){e?(this._bgground||(this._bgground={}),this._bgground.color=e,this._ower.conchModel&&this._ower.conchModel.bgColor(e),this._type|=16384,this._ower._renderType|=256):this._bgground=null}),r(0,i,"wordWrap",function(){return 0==(131072&this._type)},function(e){e?this._type&=-131073:this._type|=131072}),r(0,i,"color",function(){return this._font.color},function(e){this._createFont().color=e}),r(0,i,"password",function(){return this._font.password},function(e){this._createFont().password=e}),r(0,i,"backgroundColor",function(){return this._bgground?this._bgground.color:null},function(e){"none"===e?this._bgground=null:(this._bgground||(this._bgground={}),this._bgground.color=e),this._ower.conchModel&&this._ower.conchModel.bgColor(e),this._ower._renderType|=256}),r(0,i,"font",function(){return this._font.toString()},function(e){this._createFont().set(e)}),r(0,i,"weight",null,function(e){this._createFont().weight=e}),r(0,i,"letterSpacing",function(){return this._spacing[0]},function(e){"string"==typeof e&&(e=parseInt(e+"")),this._spacing===t._SPACING&&(this._spacing=[0,0]),this._spacing[0]=e}),r(0,i,"fontSize",function(){return this._font.size},function(e){this._createFont().size=e}),r(0,i,"italic",function(){return this._font.italic},function(e){this._createFont().italic=e}),r(0,i,"fontFamily",function(){return this._font.family},function(e){this._createFont().family=e}),r(0,i,"stroke",function(){return this._font.stroke[0]},function(e){this._createFont().stroke===u._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[0]=e}),r(0,i,"strokeColor",function(){return this._font.stroke[1]},function(e){this._createFont().stroke===u._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[1]=e}),r(0,i,"border",function(){return this._border?this._border.value:""},function(e){if("none"!=e){this._border||(this._border={}),this._border.value=e;var t=e.split(" ");if(this._border.color=H.create(t[t.length-1]),1==t.length)return this._border.size=1,void(this._border.type="solid");var i=0;t[0].indexOf("px")>0?(this._border.size=parseInt(t[0]),i++):this._border.size=1,this._border.type=t[i],this._ower._renderType|=256}else this._border=null}),r(0,i,"borderColor",function(){return this._border&&this._border.color?this._border.color.strColor:null},function(e){e?(this._border||(this._border={size:1,type:"solid"}),this._border.color=null==e?null:H.create(e),this._ower.conchModel&&this._ower.conchModel.border(this._border.color.strColor),this._ower._renderType|=256):this._border=null}),r(0,i,"position",function(){return 4&this._type?"absolute":""},function(e){"absolute"==e?this._type|=4:this._type&=-5}),r(0,i,"display",null,function(e){switch(e){case"":this._type&=-3,this.visible=!0;break;case"none":this._type|=2,this.visible=!1,this._ower._layoutLater()}}),r(0,i,"paddingLeft",function(){return this.padding[3]}),r(0,i,"paddingTop",function(){return this.padding[0]}),r(0,i,"_scale",null,function(e){this._ower.scale(e[0],e[1])}),r(0,i,"_rotate",null,function(e){this._ower.rotation=e}),t.parseOneCSS=function(e,i){for(var n,a=[],r=e.split(i),o=0,s=r.length;o<s;o++){var h=r[o],l=h.indexOf(":"),c=h.substr(0,l).replace(/^\s+|\s+$/g,"");if(0!=c.length){var p=h.substr(l+1).replace(/^\s+|\s+$/g,""),u=[c,p];switch(c){case"italic":case"bold":u[1]="true"==p;break;case"line-height":u[0]="lineHeight",u[1]=parseInt(p);break;case"font-size":u[0]="fontSize",u[1]=parseInt(p);break;case"padding":(n=p.split(" ")).length>1||(n[1]=n[2]=n[3]=n[0]),u[1]=[parseInt(n[0]),parseInt(n[1]),parseInt(n[2]),parseInt(n[3])];break;case"rotate":u[0]="_rotate",u[1]=parseFloat(p);break;case"scale":n=p.split(" "),u[0]="_scale",u[1]=[parseFloat(n[0]),parseFloat(n[1])];break;case"translate":n=p.split(" "),u[0]="_translate",u[1]=[parseInt(n[0]),parseInt(n[1])];break;default:(u[0]=t._CSSTOVALUE[c])||(u[0]=c)}a.push(u)}}return a},t.parseCSS=function(e,i){for(var n;null!=(n=t._parseCSSRegExp.exec(e));)t.styleSheets[n[1]]=t.parseOneCSS(n[2],";")},t.EMPTY=new t(null),t._CSSTOVALUE={"letter-spacing":"letterSpacing","line-spacing":"lineSpacing","white-space":"whiteSpace","line-height":"lineHeight","scale-x":"scaleX","scale-y":"scaleY","translate-x":"translateX","translate-y":"translateY","font-family":"fontFamily","font-weight":"fontWeight","vertical-align":"valign","text-decoration":"textDecoration","background-color":"backgroundColor","border-color":"borderColor",float:"cssFloat"},t._parseCSSRegExp=new RegExp("([.#]\\w+)\\s*{([\\s\\S]*?)}","g"),t._aligndef={left:0,center:1,right:2,0:"left",1:"center",2:"right"},t._valigndef={top:0,middle:1,bottom:2,0:"top",1:"middle",2:"bottom"},t.styleSheets={},t.ALIGN_CENTER=1,t.ALIGN_RIGHT=2,t.VALIGN_MIDDLE=1,t.VALIGN_BOTTOM=2,t._CSS_BLOCK=1,t._DISPLAY_NONE=2,t._ABSOLUTE=4,t._WIDTH_SET=8,t._PADDING=[0,0,0,0],t._RECT=[-1,-1,-1,-1],t._SPACING=[0,0],t._ALIGNS=[0,0,0],t.ADDLAYOUTED=512,t._NEWFONT=4096,t._HEIGHT_SET=8192,t._BACKGROUND_SET=16384,t._FLOAT_RIGHT=32768,t._LINE_ELEMENT=65536,t._NOWARP=131072,t._WIDTHAUTO=262144,t._LISTERRESZIE=524288,t}(p),te=function(e){function t(){this.url=null,this.audio=null,this.loaded=!1,t.__super.call(this)}a(t,"laya.media.h5audio.AudioSound",h);var i=t.prototype;return i.dispose=function(){var e=t._audioCache[this.url];e&&(e.src="",delete t._audioCache[this.url])},i.load=function(e){function i(){a(),o.loaded=!0,o.event("complete")}function n(){r.load=null,a(),o.event("error")}function a(){r.removeEventListener("canplaythrough",i),r.removeEventListener("error",n)}e=D.formatURL(e),this.url=e;var r;if(e==E._tMusic?(t._initMusicAudio(),(r=t._musicAudio).src!=e&&(t._audioCache[r.src]=null,r=null)):r=t._audioCache[e],r&&r.readyState>=2)this.event("complete");else{r||(e==E._tMusic?(t._initMusicAudio(),r=t._musicAudio):r=O.createElement("audio"),t._audioCache[e]=r,r.src=e),r.addEventListener("canplaythrough",i),r.addEventListener("error",n);var o=this;this.audio=r,r.load?r.load():n()}},i.play=function(e,i){if(void 0===e&&(e=0),void 0===i&&(i=0),!this.url)return null;var n;if(!(n=this.url==E._tMusic?t._musicAudio:t._audioCache[this.url]))return null;var a;a=G.getItem("audio:"+this.url),N.isConchApp?a||((a=O.createElement("audio")).src=this.url):this.url==E._tMusic?(t._initMusicAudio(),(a=t._musicAudio).src=this.url):a=a||n.cloneNode(!0);var r=new de(a);return r.url=this.url,r.loops=i,r.startTime=e,r.play(),E.addChannel(r),r},r(0,i,"duration",function(){var e;return(e=t._audioCache[this.url])?e.duration:0}),t._initMusicAudio=function(){t._musicAudio||(t._musicAudio||(t._musicAudio=O.createElement("audio")),N.isConchApp||O.document.addEventListener("mousedown",t._makeMusicOK))},t._makeMusicOK=function(){O.document.removeEventListener("mousedown",t._makeMusicOK),t._musicAudio.src?t._musicAudio.play():(t._musicAudio.src="",t._musicAudio.load())},t._audioCache={},t._musicAudio=null,t}(),ie=function(e){function t(){this.url=null,this.loops=0,this.startTime=NaN,this.isStopped=!1,this.completeHandler=null,t.__super.call(this)}a(t,"laya.media.SoundChannel",h);var i=t.prototype;return i.play=function(){},i.stop=function(){},i.pause=function(){},i.resume=function(){},i.__runComplete=function(e){e&&e.run()},r(0,i,"volume",function(){return 1},function(e){}),r(0,i,"position",function(){return 0}),r(0,i,"duration",function(){return 0}),t}(),ne=function(e){function t(){t.__super.call(this)}a(t,"laya.media.Sound",h);var i=t.prototype;return i.load=function(e){},i.play=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=0),null},i.dispose=function(){},r(0,i,"duration",function(){return 0}),t}(),ae=function(e){function t(){this.url=null,this.loaded=!1,this.data=null,this.audioBuffer=null,this.__toPlays=null,this._disposed=!1,t.__super.call(this)}a(t,"laya.media.webaudio.WebAudioSound",h);var i=t.prototype;return i.load=function(e){var i=this;if(e=D.formatURL(e),this.url=e,this.audioBuffer=t._dataCache[e],this.audioBuffer)this._loaded(this.audioBuffer);else if(t.e.on("loaded:"+e,this,this._loaded),t.e.on("err:"+e,this,this._err),!t.__loadingSound[e]){t.__loadingSound[e]=!0;var n=new O.window.XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=function(){i._disposed?i._removeLoadEvents():(i.data=n.response,t.buffs.push({buffer:i.data,url:i.url}),t.decode())},n.onerror=function(e){i._err()},n.send()}},i._err=function(){this._removeLoadEvents(),t.__loadingSound[this.url]=!1,this.event("error")},i._loaded=function(e){this._removeLoadEvents(),this._disposed||(this.audioBuffer=e,t._dataCache[this.url]=this.audioBuffer,this.loaded=!0,this.event("complete"))},i._removeLoadEvents=function(){t.e.off("loaded:"+this.url,this,this._loaded),t.e.off("err:"+this.url,this,this._err)},i.__playAfterLoaded=function(){if(this.__toPlays){var e,t=0,i=0;i=(e=this.__toPlays).length;var n;for(t=0;t<i;t++)(n=e[t])[2]&&!n[2].isStopped&&this.play(n[0],n[1],n[2]);this.__toPlays.length=0}},i.play=function(e,t,i){return void 0===e&&(e=0),void 0===t&&(t=0),i=i||new _e,this.audioBuffer||this.url&&(this.__toPlays||(this.__toPlays=[]),this.__toPlays.push([e,t,i]),this.once("complete",this,this.__playAfterLoaded),this.load(this.url)),i.url=this.url,i.loops=t,i.audioBuffer=this.audioBuffer,i.startTime=e,i.play(),E.addChannel(i),i},i.dispose=function(){this._disposed=!0,delete t._dataCache[this.url],delete t.__loadingSound[this.url],this.audioBuffer=null,this.data=null,this.__toPlays=[]},r(0,i,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),t.decode=function(){t.buffs.length<=0||t.isDecoding||(t.isDecoding=!0,t.tInfo=t.buffs.shift(),t.ctx.decodeAudioData(t.tInfo.buffer,t._done,t._fail))},t._done=function(e){t.e.event("loaded:"+t.tInfo.url,e),t.isDecoding=!1,t.decode()},t._fail=function(){t.e.event("err:"+t.tInfo.url,null),t.isDecoding=!1,t.decode()},t._playEmptySound=function(){if(null!=t.ctx){var e=t.ctx.createBufferSource();e.buffer=t._miniBuffer,e.connect(t.ctx.destination),e.start(0,0,0)}},t._unlock=function(){t._unlocked||(t._playEmptySound(),"running"==t.ctx.state&&(O.document.removeEventListener("mousedown",t._unlock,!0),O.document.removeEventListener("touchend",t._unlock,!0),t._unlocked=!0))},t.initWebAudio=function(){"running"!=t.ctx.state&&(t._unlock(),O.document.addEventListener("mousedown",t._unlock,!0),O.document.addEventListener("touchend",t._unlock,!0))},t._dataCache={},t.buffs=[],t.isDecoding=!1,t._unlocked=!1,t.tInfo=null,t.__loadingSound={},n(t,["window",function(){return this.window=O.window},"webAudioEnabled",function(){return this.webAudioEnabled=t.window.AudioContext||t.window.webkitAudioContext||t.window.mozAudioContext},"ctx",function(){return this.ctx=t.webAudioEnabled?new(t.window.AudioContext||t.window.webkitAudioContext||t.window.mozAudioContext):void 0},"_miniBuffer",function(){return this._miniBuffer=t.ctx.createBuffer(1,1,22050)},"e",function(){return this.e=new h}]),t}(),re=function(e){function t(){this._responseType=null,this._data=null,t.__super.call(this),this._http=new O.window.XMLHttpRequest}a(t,"laya.net.HttpRequest",h);var i=t.prototype;return i.send=function(e,t,i,n,a){void 0===i&&(i="get"),void 0===n&&(n="text"),this._responseType=n,this._data=null;var r=this,o=this._http;if(o.open(i,e,!0),a)for(var s=0;s<a.length;s++)o.setRequestHeader(a[s++],a[s]);else N.isConchApp||(t&&"string"!=typeof t?o.setRequestHeader("Content-Type","application/json"):o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));o.responseType="arraybuffer"!==n?"text":"arraybuffer",o.onerror=function(e){r._onError(e)},o.onabort=function(e){r._onAbort(e)},o.onprogress=function(e){r._onProgress(e)},o.onload=function(e){r._onLoad(e)},o.send(t)},i._onProgress=function(e){e&&e.lengthComputable&&this.event("progress",e.loaded/e.total)},i._onAbort=function(e){this.error("Request was aborted by user")},i._onError=function(e){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText)},i._onLoad=function(e){var t=this._http,i=void 0!==t.status?t.status:200;200===i||204===i||0===i?this.complete():this.error("["+t.status+"]"+t.statusText+":"+t.responseURL)},i.error=function(e){this.clear(),this.event("error",e)},i.complete=function(){this.clear();var e=!0;try{"json"===this._responseType?this._data=JSON.parse(this._http.responseText):"xml"===this._responseType?this._data=K.parseXMLFromString(this._http.responseText):this._data=this._http.response||this._http.responseText}catch(t){e=!1,this.error(t.message)}e&&this.event("complete",this._data instanceof Array?[this._data]:this._data)},i.clear=function(){var e=this._http;e.onerror=e.onabort=e.onprogress=e.onload=null},r(0,i,"url",function(){return this._http.responseURL}),r(0,i,"http",function(){return this._http}),r(0,i,"data",function(){return this._data}),t}(),oe=function(e){function t(){this._data=null,this._class=null,this._url=null,this._type=null,this._cache=!1,this._http=null,this._customParse=!1,t.__super.call(this)}a(t,"laya.net.Loader",h);var n=t.prototype;return n.load=function(e,i,n,a,r){if(void 0===n&&(n=!0),void 0===r&&(r=!1),this._url=e,0===e.indexOf("data:image")?this._type=i="image":(this._type=i||(i=this.getTypeFromUrl(e)),e=D.formatURL(e)),this._cache=n,this._data=null,!r&&t.loadedMap[e])return this._data=t.loadedMap[e],this.event("progress",1),void this.event("complete",this._data);if(a&&t.setGroup(e,a),null!=t.parserMap[i])return this._customParse=!0,void(t.parserMap[i]instanceof laya.utils.Handler?t.parserMap[i].runWith(this):t.parserMap[i].call(null,this));if("image"===i||"htmlimage"===i||"nativeimage"===i)return this._loadImage(e);if("sound"===i)return this._loadSound(e);if("ttf"===i)return this._loadTTF(e);var o;switch(i){case"atlas":case"plf":o="json";break;case"font":o="xml";break;case"pkm":o="arraybuffer";break;default:o=i}t.preLoadedMap[e]?this.onLoaded(t.preLoadedMap[e]):(this._http||(this._http=new re,this._http.on("progress",this,this.onProgress),this._http.on("error",this,this.onError),this._http.on("complete",this,this.onLoaded)),this._http.send(e,null,"get",o))},n.getTypeFromUrl=function(e){var i=K.getFileExtension(e);return i?t.typeMap[i]:(console.warn("Not recognize the resources suffix",e),"text")},n._loadTTF=function(e){e=D.formatURL(e);var t=new L;t.complete=l.create(this,this.onLoaded),t.load(e)},n._loadImage=function(e){function i(){n.onload=null,n.onerror=null,delete t.imgCache[e]}e=D.formatURL(e);var n,a=this,r=function(){i(),a.onLoaded(n)},o=function(){i(),a.event("error","Load image failed")};"nativeimage"===this._type?((n=new O.window.Image).crossOrigin="",n.onload=r,n.onerror=o,n.src=e,t.imgCache[e]=n):new Se.create(e,{onload:r,onerror:o,onCreate:function(i){n=i,t.imgCache[e]=i}})},n._loadSound=function(e){function t(){i.offAll()}var i=new E._soundClass,n=this;i.on("complete",this,function(){t(),n.onLoaded(i)}),i.on("error",this,function(){t(),i.dispose(),n.event("error","Load sound failed")}),i.load(e)},n.onProgress=function(e){"atlas"===this._type?this.event("progress",.3*e):this.event("progress",e)},n.onError=function(e){this.event("error",e)},n.onLoaded=function(e){var i=this._type;if("plf"==i)this.parsePLFData(e),this.complete(e);else if("image"===i){var n=new ce(e);n.url=this._url,this.complete(n)}else if("sound"===i||"htmlimage"===i||"nativeimage"===i)this.complete(e);else if("atlas"===i){if(!e.src&&!e._setContext){if(!this._data){if(this._data=e,e.meta&&e.meta.image)for(var a=e.meta.image.split(","),r=this._url.indexOf("/")>=0?"/":"\\",o=this._url.lastIndexOf(r),s=o>=0?this._url.substr(0,o+1):"",h=0,l=a.length;h<l;h++)a[h]=s+a[h];else a=[this._url.replace(".json",".png")];a.reverse(),e.toLoads=a,e.pics=[]}return this.event("progress",.3+1/a.length*.6),this._loadImage(a.pop())}if(this._data.pics.push(e),this._data.toLoads.length>0)return this.event("progress",.3+1/this._data.toLoads.length*.6),this._loadImage(this._data.toLoads.pop());var p=this._data.frames,u=this._url.split("?")[0],d=this._data.meta&&this._data.meta.prefix?this._data.meta.prefix:u.substring(0,u.lastIndexOf("."))+"/",_=this._data.pics,m=D.formatURL(this._url),f=t.atlasMap[m]||(t.atlasMap[m]=[]);f.dir=d;var g=1;if(this._data.meta&&this._data.meta.scale&&1!=this._data.meta.scale){g=parseFloat(this._data.meta.scale);for(var y in p){var v=p[y],x=_[v.frame.idx?v.frame.idx:0],b=D.formatURL(d+y);x.scaleRate=g,t.cacheRes(b,ce.create(x,v.frame.x,v.frame.y,v.frame.w,v.frame.h,v.spriteSourceSize.x,v.spriteSourceSize.y,v.sourceSize.w,v.sourceSize.h)),t.loadedMap[b].url=b,f.push(b)}}else for(y in p)x=_[(v=p[y]).frame.idx?v.frame.idx:0],b=D.formatURL(d+y),t.cacheRes(b,ce.create(x,v.frame.x,v.frame.y,v.frame.w,v.frame.h,v.spriteSourceSize.x,v.spriteSourceSize.y,v.sourceSize.w,v.sourceSize.h)),t.loadedMap[b].url=b,f.push(b);delete this._data.pics,this.complete(this._data)}else if("font"==i){if(!e.src)return this._data=e,this.event("progress",.5),this._loadImage(this._url.replace(".fnt",".png"));var w=new c;w.parseFont(this._data,e);var S=this._url.split(".fnt")[0].split("/"),I=S[S.length-1];ge.registerBitmapFont(I,w),this._data=w,this.complete(this._data)}else if("pkm"==i){var M=Se.create(e,this._url),C=new ce(M);C.url=this._url,this.complete(C)}else this.complete(e)},n.parsePLFData=function(e){var i,n,a;for(i in e)switch(a=e[i],i){case"json":case"text":for(n in a)t.preLoadedMap[D.formatURL(n)]=a[n];break;default:for(n in a)t.preLoadedMap[D.formatURL(n)]=a[n]}},n.complete=function(e){this._data=e,this._customParse?this.event("loaded",e instanceof Array?[e]:e):(t._loaders.push(this),t._isWorking||t.checkNext())},n.endLoad=function(e){e&&(this._data=e),this._cache&&t.cacheRes(this._url,this._data),this.event("progress",1),this.event("complete",this.data instanceof Array?[this.data]:this.data)},r(0,n,"url",function(){return this._url}),r(0,n,"data",function(){return this._data}),r(0,n,"cache",function(){return this._cache}),r(0,n,"type",function(){return this._type}),t.checkNext=function(){t._isWorking=!0;for(var e=O.now();t._startIndex<t._loaders.length;)if(O.now(),t._loaders[t._startIndex].endLoad(),t._startIndex++,O.now()-e>t.maxTimeOut)return console.warn("loader callback cost a long time:"+(O.now()-e)+" url="+t._loaders[t._startIndex-1].url),void i.timer.frameOnce(1,null,t.checkNext);t._loaders.length=0,t._startIndex=0,t._isWorking=!1},t.clearRes=function(e,i){void 0===i&&(i=!1),e=D.formatURL(e);var n=t.getAtlas(e);if(n){for(var a=0,r=n.length;a<r;a++){var o=n[a],s=t.getRes(o);delete t.loadedMap[o],s&&s.destroy(i)}n.length=0,delete t.atlasMap[e],delete t.loadedMap[e]}else{var h=t.loadedMap[e];h&&(delete t.loadedMap[e],h instanceof laya.resource.Texture&&h.bitmap&&h.destroy(i))}},t.clearTextureRes=function(e){e=D.formatURL(e);var t=laya.net.Loader.getAtlas(e);if(t&&t.length>0)for(var i=0;i<t.length;i++){(n=laya.net.Loader.getRes(t[i]))&&n.bitmap&&(N.isConchApp&&!N.isConchWebGL?n.bitmap.source.releaseTexture&&n.bitmap.source.releaseTexture():null==n.bitmap._atlaser&&n.bitmap.releaseResource(!0))}else{var n=laya.net.Loader.getRes(e);n&&n.bitmap&&(N.isConchApp&&!N.isConchWebGL?n.bitmap.source.releaseTexture&&n.bitmap.source.releaseTexture():null==n.bitmap._atlaser&&n.bitmap.releaseResource(!0))}},t.getRes=function(e){return t.loadedMap[D.formatURL(e)]},t.getAtlas=function(e){return t.atlasMap[D.formatURL(e)]},t.cacheRes=function(e,i){e=D.formatURL(e),null!=t.loadedMap[e]?console.warn("Resources already exist,is repeated loading:",e):t.loadedMap[e]=i},t.setGroup=function(e,i){t.groupMap[i]||(t.groupMap[i]=[]),t.groupMap[i].push(e)},t.clearResByGroup=function(e){if(t.groupMap[e]){var i=t.groupMap[e],n=0,a=i.length;for(n=0;n<a;n++)t.clearRes(i[n]);i.length=0}},t.TEXT="text",t.JSON="json",t.XML="xml",t.BUFFER="arraybuffer",t.IMAGE="image",t.SOUND="sound",t.ATLAS="atlas",t.FONT="font",t.TTF="ttf",t.PLF="plf",t.PKM="pkm",t.typeMap={png:"image",jpg:"image",jpeg:"image",txt:"text",json:"json",xml:"xml",als:"atlas",atlas:"atlas",mp3:"sound",ogg:"sound",wav:"sound",part:"json",fnt:"font",pkm:"pkm",ttf:"ttf",plf:"plf"},t.parserMap={},t.groupMap={},t.maxTimeOut=100,t.loadedMap={},t.preLoadedMap={},t.atlasMap={},t._loaders=[],t._isWorking=!1,t._startIndex=0,t.imgCache={},t}(),se=function(e){function t(){this.retryNum=1,this.retryDelay=0,this.maxLoader=5,this._loaders=[],this._loaderCount=0,this._resInfos=[],this._infoPool=[],this._maxPriority=5,this._failRes={},t.__super.call(this);for(var e=0;e<this._maxPriority;e++)this._resInfos[e]=[]}var r;a(t,"laya.net.LoaderManager",h);var o=t.prototype;return o.create=function(e,t,i,n,a,r,o,s){if(void 0===r&&(r=1),void 0===o&&(o=!0),e instanceof Array){var h=e,c=h.length,p=0;if(i)var u=l.create(i.caller,i.method,i.args,!1);for(var d=0;d<c;d++){var _=h[d];"string"==typeof _&&(_=h[d]={url:_}),_.progress=0}for(d=0;d<c;d++){_=h[d];var m=i?l.create(null,function(e,t){e.progress=t;for(var i=0,n=0;n<c;n++)i+=h[n].progress;var a=i/c;u.runWith(a)},[_],!1):null,f=i||t?l.create(null,function(e,i){p++,e.progress=1,p===c&&t&&t.run()},[_]):null;this._create(_.url,f,m,_.clas||n,_.params||a,_.priority||r,o,_.group||s)}return!0}return this._create(e,t,i,n,a,r,o,s)},o._create=function(e,n,a,r,o,s,h,c){void 0===s&&(s=1),void 0===h&&(h=!0);var p=D.formatURL(e),u=this.getRes(p);if(u)!u.hasOwnProperty("loaded")||u.loaded?(a&&a.runWith(1),n&&n.run()):n&&i.loader._createListener(e,n.caller,n.method,n.args,!0,!1);else{var d=K.getFileExtension(e),_=t.createMap[d];if(!_)throw new Error("LoaderManager:unknown file("+e+") extension with: "+d+".");r||(r=_[0]);var m=_[1];"atlas"==d?this.load(e,n,a,m,s,h):(r===ce&&(m="htmlimage"),(u=r?new r:null).hasOwnProperty("_loaded")&&(u._loaded=!1),u._setUrl(e),c&&u._setGroup(c),this._createLoad(u,e,l.create(null,function(t){u&&!u.destroyed&&t&&u.onAsynLoaded.call(u,e,t,o),n&&n.run(),i.loader.event(e)}),a,m,s,!1,c,!0),h&&this.cacheRes(p,u))}return u},o.load=function(e,n,a,o,s,h,l,c){var p=this;if(void 0===s&&(s=1),void 0===h&&(h=!0),void 0===c&&(c=!1),e instanceof Array)return this._loadAssets(e,n,a,o,s,h,l);var u=oe.getRes(e);if(null!=u)i.timer.frameOnce(1,null,function(){a&&a.runWith(1),n&&n.runWith(u),p._loaderCount||p.event("complete")});else{var d=t._resMap[e];d?(n&&d._createListener("complete",n.caller,n.method,n.args,!1,!1),a&&d._createListener("progress",a.caller,a.method,a.args,!1,!1)):((d=this._infoPool.length?this._infoPool.pop():new r).url=e,d.type=o,d.cache=h,d.group=l,d.ignoreCache=c,n&&d.on("complete",n.caller,n.method,n.args),a&&d.on("progress",a.caller,a.method,a.args),t._resMap[e]=d,s=s<this._maxPriority?s:this._maxPriority-1,this._resInfos[s].push(d),this._next())}return this},o._createLoad=function(e,n,a,o,s,h,l,c,p){var u=this;if(void 0===h&&(h=1),void 0===l&&(l=!0),void 0===p&&(p=!1),n instanceof Array)return this._loadAssets(n,a,o,s,h,l,c);var d=oe.getRes(n);if(null!=d)i.timer.frameOnce(1,null,function(){o&&o.runWith(1),a&&a.runWith(d),u._loaderCount||u.event("complete")});else{var _=t._resMap[n];_?(a&&_._createListener("complete",a.caller,a.method,a.args,!1,!1),o&&_._createListener("progress",o.caller,o.method,o.args,!1,!1)):((_=this._infoPool.length?this._infoPool.pop():new r).url=n,_.clas=e,_.type=s,_.cache=l,_.group=c,_.ignoreCache=p,a&&_.on("complete",a.caller,a.method,a.args),o&&_.on("progress",o.caller,o.method,o.args),t._resMap[n]=_,h=h<this._maxPriority?h:this._maxPriority-1,this._resInfos[h].push(_),this._next())}return this},o._next=function(){if(!(this._loaderCount>=this.maxLoader)){for(var e=0;e<this._maxPriority;e++)for(var t=this._resInfos[e];t.length>0;){var i=t.shift();if(i)return this._doLoad(i)}this._loaderCount||this.event("complete")}},o._doLoad=function(e){function t(t){i.offAll(),i._data=null,i._customParse=!1,n._loaders.push(i),n._endLoad(e,t instanceof Array?[t]:t),n._loaderCount--,n._next()}this._loaderCount++;var i=this._loaders.length?this._loaders.pop():new oe;i.on("complete",null,t),i.on("progress",null,function(t){e.event("progress",t)}),i.on("error",null,function(e){t(null)});var n=this;i._class=e.clas,i.load(e.url,e.type,e.cache,e.group,e.ignoreCache)},o._endLoad=function(e,n){var a=e.url;if(null==n){var r=this._failRes[a]||0;if(r<this.retryNum)return console.warn("[warn]Retry to load:",a),this._failRes[a]=r+1,void i.timer.once(this.retryDelay,this,this._addReTry,[e],!1);console.warn("[error]Failed to load:",a),this.event("error",a)}this._failRes[a]&&(this._failRes[a]=0),delete t._resMap[a],e.event("complete",n),e.offAll(),this._infoPool.push(e)},o._addReTry=function(e){this._resInfos[this._maxPriority-1].push(e),this._next()},o.clearRes=function(e,t){void 0===t&&(t=!1),oe.clearRes(e,t)},o.getRes=function(e){return oe.getRes(e)},o.cacheRes=function(e,t){oe.cacheRes(e,t)},o.clearTextureRes=function(e){oe.clearTextureRes(e)},o.setGroup=function(e,t){oe.setGroup(e,t)},o.clearResByGroup=function(e){oe.clearResByGroup(e)},o.clearUnLoaded=function(){for(var e=0;e<this._maxPriority;e++){for(var i=this._resInfos[e],n=i.length-1;n>-1;n--){var a=i[n];a&&(a.offAll(),this._infoPool.push(a))}i.length=0}this._loaderCount=0,t._resMap={}},o.cancelLoadByUrls=function(e){if(e)for(var t=0,i=e.length;t<i;t++)this.cancelLoadByUrl(e[t])},o.cancelLoadByUrl=function(e){for(var i=0;i<this._maxPriority;i++)for(var n=this._resInfos[i],a=n.length-1;a>-1;a--){var r=n[a];r&&r.url===e&&(n[a]=null,r.offAll(),this._infoPool.push(r))}t._resMap[e]&&delete t._resMap[e]},o._loadAssets=function(e,t,i,n,a,r,o){void 0===a&&(a=1),void 0===r&&(r=!0);for(var s=e.length,h=0,c=0,p=[],u=!0,d=0;d<s;d++){var _=e[d];"string"==typeof _&&(_={url:_,type:n,size:1,priority:a}),_.size||(_.size=1),_.progress=0,c+=_.size,p.push(_);var m=i?l.create(null,function(e,t){if(null!=i){e.progress=t;for(var n=0,a=0;a<p.length;a++){var r=p[a];n+=r.size*r.progress}var o=n/c;i.runWith(o)}},[_],!1):null,f=t||i?l.create(null,function(e,i){h++,e.progress=1,i||(u=!1),h===s&&t&&t.runWith(u)},[_]):null;this.load(_.url,f,m,_.type,_.priority||1,r,_.group||o)}return this},t.cacheRes=function(e,t){oe.cacheRes(e,t)},t._resMap={},n(t,["createMap",function(){return this.createMap={atlas:[null,"atlas"]}}]),t.__init$=function(){r=function(e){function t(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,t.__super.call(this)}return a(t,"",h),t}()},t}(),he=function(e){function t(e){t.__super.call(this),e||(e=[.3,.59,.11,0,0,.3,.59,.11,0,0,.3,.59,.11,0,0,0,0,0,1,0]),this._mat=new Float32Array(16),this._alpha=new Float32Array(4);for(var i=0,n=0,a=0;a<20;a++)a%5!=4?this._mat[i++]=e[a]:this._alpha[n++]=e[a];this._action=o.createFilterAction(32),this._action.data=this}a(t,"laya.filters.ColorFilter",x);var n=t.prototype;return i.imps(n,{"laya.filters.IFilter":!0}),n.callNative=function(e){e._$P.cf=this;e.conchModel&&e.conchModel.setFilterMatrix&&e.conchModel.setFilterMatrix(this._mat,this._alpha)},r(0,n,"type",function(){return 32}),r(0,n,"action",function(){return this._action}),t}(),le=(function(e){function t(e,i,n){this._endian=null,this._stamp=NaN,this._socket=null,this._connected=!1,this._addInputPosition=0,this._input=null,this._output=null,this.timeout=0,this.objectEncoding=0,this.disableInput=!1,this._byteClass=null,this.protocols=[],void 0===i&&(i=0),t.__super.call(this),this._byteClass=n||V,this.endian="bigEndian",this.timeout=2e4,this._addInputPosition=0,e&&i>0&&i<65535&&this.connect(e,i)}a(t,"laya.net.Socket",h);var i=t.prototype;i.connect=function(e,t){var i="ws://"+e+":"+t;i="https:"==O.window.location.protocol?"wss://"+e+":"+t:"ws://"+e+":"+t,this.connectByUrl(i)},i.connectByUrl=function(e){var t=this;null!=this._socket&&this.close(),this._socket&&this.cleanSocket(),this.protocols&&0!=this.protocols.length?this._socket=new O.window.WebSocket(e,this.protocols):this._socket=new O.window.WebSocket(e),this._socket.binaryType="arraybuffer",this._output=new this._byteClass,this._output.endian=this.endian,this._input=new this._byteClass,this._input.endian=this.endian,this._addInputPosition=0,this._socket.onopen=function(e){t._onOpen(e)},this._socket.onmessage=function(e){t._onMessage(e)},this._socket.onclose=function(e){t._onClose(e)},this._socket.onerror=function(e){t._onError(e)}},i.cleanSocket=function(){try{this._socket.close()}catch(e){}this._connected=!1,this._socket.onopen=null,this._socket.onmessage=null,this._socket.onclose=null,this._socket.onerror=null,this._socket=null},i.close=function(){if(null!=this._socket)try{this._socket.close()}catch(e){}},i._onOpen=function(e){this._connected=!0,this.event("open",e)},i._onMessage=function(e){if(e&&e.data){var t=e.data;if(this.disableInput&&t)this.event("message",t);else{this._input.length>0&&this._input.bytesAvailable<1&&(this._input.clear(),this._addInputPosition=0);var i=this._input.pos;!this._addInputPosition&&(this._addInputPosition=0),this._input.pos=this._addInputPosition,t&&("string"==typeof t?this._input.writeUTFBytes(t):this._input.writeArrayBuffer(t),this._addInputPosition=this._input.pos,this._input.pos=i),this.event("message",t)}}},i._onClose=function(e){this._connected=!1,this.event("close",e)},i._onError=function(e){this.event("error",e)},i.send=function(e){this._socket.send(e)},i.flush=function(){if(this._output&&this._output.length>0){var e;try{this._socket&&this._socket.send(this._output.__getBuffer().slice(0,this._output.length))}catch(t){e=t}this._output.endian=this.endian,this._output.clear(),e&&this.event("error",e)}},r(0,i,"input",function(){return this._input}),r(0,i,"output",function(){return this._output}),r(0,i,"connected",function(){return this._connected}),r(0,i,"endian",function(){return this._endian},function(e){this._endian=e,null!=this._input&&(this._input.endian=e),null!=this._output&&(this._output.endian=e)}),t.LITTLE_ENDIAN="littleEndian",t.BIG_ENDIAN="bigEndian"}(),function(e){function t(){this.worker=null,t.__super.call(this);var e=this;this.worker=new O.window.Worker(t.workerPath),this.worker.onmessage=function(t){e.workerMessage(t.data)}}a(t,"laya.net.WorkerLoader",h);var i=t.prototype;i.workerMessage=function(e){if(e)switch(e.type){case"Image":this.imageLoaded(e);break;case"Msg":this.event("image_msg",e.msg)}},i.imageLoaded=function(e){if(e&&e.buffer&&e.buffer.length<10)return t._enable=!1,this._myTrace("buffer lost when postmessage ,disable workerloader"),this.event(e.url,null),void this.event("image_err",e.url+"\n"+e.msg);if(!e.dataType)return this.event(e.url,null),void this.event("image_err",e.url+"\n"+e.msg);var i,n,a;switch(e.dataType){case"buffer":(a=(n=(i=new xe("2D")).source.getContext("2d")).createImageData(e.width,e.height)).data.set(e.buffer),i.size(a.width,a.height),n.putImageData(a,0,0),i.memorySize=0;break;case"imagedata":n=(i=new xe("2D")).source.getContext("2d"),a=e.imagedata,i.size(a.width,a.height),n.putImageData(a,0,0),a=e.imagedata,i.memorySize=0;break;case"imageBitmap":a=e.imageBitmap,N.isWebGL?i=a:(n=(i=new xe("2D")).source.getContext("2d"),i.size(a.width,a.height),n.drawImage(a,0,0),i.src=e.url)}N.isWebGL&&(i=new laya.webgl.resource.WebGLImage(i,e.url)),this.event(e.url,i)},i._myTrace=function(e){var t=arguments,i=[],n=0,a=t.length;for(n=0;n<a;n++)i.push(t[n]);this.event("image_msg",i.join(" "))},i.loadImage=function(e){var t;(t={}).type="load",t.url=e,this.worker.postMessage(t)},i._loadImage=function(e){var i=this;if(!t._enable||e.toLowerCase().indexOf(".png")<0)t._preLoadFun.call(i,e);else{e=D.formatURL(e);var n=function(a){laya.net.WorkerLoader.I.off(e,i,n),a?i.onLoaded(a):t._preLoadFun.call(i,e)};laya.net.WorkerLoader.I.on(e,i,n),laya.net.WorkerLoader.I.loadImage(e)}},r(1,t,"enable",function(){return t._enable},function(e){t.disableJSDecode&&!O.window.createImageBitmap||(t._enable=e)&&null==t._preLoadFun&&(t._enable=t.__init__())}),t.__init__=function(){return null==t._preLoadFun&&(!!O.window.Worker&&(t._preLoadFun=oe.prototype._loadImage,oe.prototype._loadImage=t.prototype._loadImage,t.I||(t.I=new t),!0))},t.workerSupported=function(){return!!O.window.Worker},t.IMAGE_LOADED="image_loaded",t.IMAGE_ERR="image_err",t.IMAGE_MSG="image_msg",t.I=null,t._preLoadFun=null,t._enable=!1,t.workerPath="libs/worker.js",t.disableJSDecode=!0}(),function(e){function t(){t.__super.call(this),this._$1__id=++t._uniqueIDCounter,this.__loaded=!0,this._destroyed=!1,this._referenceCount=0,t._idResourcesMap[this.id]=this,this._released=!0,this.lock=!1,this._memorySize=0,this._lastUseFrameCount=-1,P.currentResourceManager&&P.currentResourceManager.addResource(this)}a(t,"laya.resource.Resource",h);var n=t.prototype;return i.imps(n,{"laya.resource.ICreateResource":!0,"laya.resource.IDispose":!0}),n._setUrl=function(e){if(this._url!==e){var i;this._url&&((i=t._urlResourcesMap[this._url]).splice(i.indexOf(this),1),0===i.length&&delete t._urlResourcesMap[this._url]),e&&((i=t._urlResourcesMap[e])||(t._urlResourcesMap[e]=i=[]),i.push(this)),this._url=e}},n._getGroup=function(){return this._group},n._setGroup=function(e){if(this._group!==e){var i;this._group&&((i=t._groupResourcesMap[this._group]).splice(i.indexOf(this),1),0===i.length&&delete t._groupResourcesMap[this._group]),e&&((i=t._groupResourcesMap[e])||(t._groupResourcesMap[e]=i=[]),i.push(this)),this._group=e}},n._addReference=function(){this._referenceCount++},n._removeReference=function(){this._referenceCount--},n._clearReference=function(){this._referenceCount=0},n._endLoaded=function(){this.__loaded=!0,this.event("loaded",this)},n.recreateResource=function(){this.completeCreate()},n.disposeResource=function(){},n.activeResource=function(e){void 0===e&&(e=!1),this._lastUseFrameCount=j.loopCount,!this._destroyed&&this.__loaded&&(this._released||e)&&this.recreateResource()},n.releaseResource=function(e){return void 0===e&&(e=!1),!(!e&&this.lock)&&(!(this._released&&!e)&&(this.disposeResource(),this._released=!0,this._lastUseFrameCount=-1,this.event("released",this),!0))},n.onAsynLoaded=function(e,t,i){throw new Error("Resource: must override this function!")},n.destroy=function(){if(!this._destroyed){null!==this._resourceManager&&this._resourceManager.removeResource(this),this._destroyed=!0,this.lock=!1,this.releaseResource(),delete t._idResourcesMap[this.id];var e;this._url&&((e=t._urlResourcesMap[this._url])&&(e.splice(e.indexOf(this),1),0===e.length&&delete t._urlResourcesMap[this.url]),oe.clearRes(this._url),this.__loaded||o.cancelLoadByUrl(this._url)),this._group&&((e=t._groupResourcesMap[this._group]).splice(e.indexOf(this),1),0===e.length&&delete t._groupResourcesMap[this.url])}},n.completeCreate=function(){this._released=!1,this.event("recovered",this)},n.dispose=function(){this.destroy()},r(0,n,"memorySize",function(){return this._memorySize},function(e){var t=e-this._memorySize;this._memorySize=e,this.resourceManager&&this.resourceManager.addSize(t)}),r(0,n,"_loaded",null,function(e){this.__loaded=e}),r(0,n,"loaded",function(){return this.__loaded}),r(0,n,"id",function(){return this._$1__id}),r(0,n,"destroyed",function(){return this._destroyed}),r(0,n,"group",function(){return this._getGroup()},function(e){this._setGroup(e)}),r(0,n,"resourceManager",function(){return this._resourceManager}),r(0,n,"url",function(){return this._url}),r(0,n,"released",function(){return this._released}),r(0,n,"referenceCount",function(){return this._referenceCount}),t.getResourceByID=function(e){return t._idResourcesMap[e]},t.getResourceByURL=function(e,i){return void 0===i&&(i=0),t._urlResourcesMap[e][i]},t.getResourceCountByURL=function(e){return t._urlResourcesMap[e].length},t.destroyUnusedResources=function(e){var i;if(e){var n=t._groupResourcesMap[e];if(n)for(var a=n.slice(),r=0,o=a.length;r<o;r++)(i=a[r]).lock||0!==i._referenceCount||i.destroy()}else for(var s in t._idResourcesMap)(i=t._idResourcesMap[s]).lock||0!==i._referenceCount||i.destroy()},t._uniqueIDCounter=0,t._idResourcesMap={},t._urlResourcesMap={},t._groupResourcesMap={},t}()),ce=function(t){function n(e,t){this.offsetX=0,this.offsetY=0,this.sourceWidth=0,this.sourceHeight=0,this._w=0,this._h=0,this._uvID=0,this._atlasID=-1,this.scaleRate=1,n.__super.call(this),e&&null!=e._addReference&&e._addReference(),this.setTo(e,t)}a(n,"laya.resource.Texture",h);var s=n.prototype;return s._setUrl=function(e){this.url=e},s.setTo=function(t,i){if(t instanceof e.HTMLElement){var a=xe.create("2D",t);this.bitmap=a}else this.bitmap=t;if(this.uv=i||n.DEF_UV,t){this._w=t.width,this._h=t.height,this.sourceWidth=this.sourceWidth||this._w,this.sourceHeight=this.sourceHeight||this._h,this._loaded=this._w>0;var r=this;if(this._loaded)o.addToAtlas&&o.addToAtlas(r);else{var s=t;s instanceof laya.resource.HTMLImage&&s.image&&s.image.addEventListener("load",function(e){o.addToAtlas&&o.addToAtlas(r)},!1)}}},s.active=function(){this.bitmap&&this.bitmap.activeResource()},s.destroy=function(e){if(void 0===e&&(e=!1),this.bitmap&&this.bitmap.referenceCount>0){var t=this.bitmap;e?(N.isConchApp&&t.source&&t.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,t.dispose(),t._clearReference()):(t._removeReference(),0==t.referenceCount&&(N.isConchApp&&t.source&&t.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,t.dispose())),this.url&&this===i.loader.getRes(this.url)&&i.loader.clearRes(this.url,e),this._loaded=!1}},s.load=function(e){var t=this;this._loaded=!1,e=D.customFormat(e);var i=this.bitmap||(this.bitmap=Se.create(e));i&&i._addReference();var n=this;i.onload=function(){i.onload=null,n._loaded=!0,t.sourceWidth=t._w=i.width,t.sourceHeight=t._h=i.height,n.event("loaded",this),o.addToAtlas&&o.addToAtlas(n)}},s.addTextureToAtlas=function(e){o.addTextureToAtlas(this)},s.getPixels=function(e,t,i,n){if(N.isConchApp){var a=this.bitmap;if(a.source&&a.source.getImageData){var r=a.source.getImageData(e,t,i,n),s=new Uint8Array(r);return Array.from(s)}return null}if(N.isWebGL)return o.getTexturePixels(this,e,t,i,n);O.canvas.size(i,n),O.canvas.clear(),O.context.drawTexture(this,-e,-t,this.width,this.height,0,0);return O.context.getImageData(0,0,i,n).data},s.onAsynLoaded=function(e,t){t&&t._addReference(),this.setTo(t,this.uv)},r(0,s,"source",function(){return this.bitmap?(this.bitmap.activeResource(),this.bitmap.source):null}),r(0,s,"loaded",function(){return this._loaded}),r(0,s,"released",function(){return!this.bitmap||this.bitmap.released}),r(0,s,"width",function(){return this._w?this._w:this.uv&&this.uv!==n.DEF_UV?(this.uv[2]-this.uv[0])*this.bitmap.width:this.bitmap.width},function(e){this._w=e,this.sourceWidth||(this.sourceWidth=e)}),r(0,s,"repeat",function(){return!N.isWebGL||!this.bitmap||this.bitmap.repeat},function(e){e&&N.isWebGL&&this.bitmap&&(this.bitmap.repeat=e,e&&(this.bitmap.enableMerageInAtlas=!1))}),r(0,s,"height",function(){return this._h?this._h:this.uv&&this.uv!==n.DEF_UV?(this.uv[5]-this.uv[1])*this.bitmap.height:this.bitmap.height},function(e){this._h=e,this.sourceHeight||(this.sourceHeight=e)}),r(0,s,"isLinearSampling",function(){return!N.isWebGL||9728!=this.bitmap.minFifter},function(e){!e&&N.isWebGL&&(e||-1!=this.bitmap.minFifter||-1!=this.bitmap.magFifter||(this.bitmap.minFifter=9728,this.bitmap.magFifter=9728,this.bitmap.enableMerageInAtlas=!1))}),n.moveUV=function(e,t,i){for(var n=0;n<8;n+=2)i[n]+=e,i[n+1]+=t;return i},n.create=function(e,t,i,a,r,s,h,l,c){void 0===s&&(s=0),void 0===h&&(h=0),void 0===l&&(l=0),void 0===c&&(c=0);var p=e instanceof laya.resource.Texture,u=p?e.uv:n.DEF_UV,d=p?e.bitmap:e,_=o.isAtlas(d);if(_){var m=d._atlaser,f=e._atlasID;if(-1==f)throw new Error("create texture error");d=m._inAtlasTextureBitmapValue[f],u=m._inAtlasTextureOriUVValue[f]}var g=new n(d,null);d.width&&t+a>d.width&&(a=d.width-t),d.height&&i+r>d.height&&(r=d.height-i),g.width=a,g.height=r,g.offsetX=s,g.offsetY=h,g.sourceWidth=l||a,g.sourceHeight=c||r;var y=1/d.width,v=1/d.height;t*=y,i*=v,a*=y,r*=v;var x=g.uv[0],b=g.uv[1],w=g.uv[4],S=g.uv[5],I=w-x,M=S-b,C=n.moveUV(u[0],u[1],[t,i,t+a,i,t+a,i+r,t,i+r]);g.uv=[x+C[0]*I,b+C[1]*M,w-(1-C[2])*I,b+C[3]*M,w-(1-C[4])*I,S-(1-C[5])*M,x+C[6]*I,S-(1-C[7])*M],_&&g.addTextureToAtlas();var k=d.scaleRate;return k&&1!=k?(g.sourceWidth/=k,g.sourceHeight/=k,g.width/=k,g.height/=k,g.scaleRate=k,g.offsetX/=k,g.offsetY/=k):g.scaleRate=1,g},n.createFromTexture=function(e,t,i,a,r){var o=e.scaleRate;1!=o&&(t*=o,i*=o,a*=o,r*=o);var s=k.TEMP.setTo(t-e.offsetX,i-e.offsetY,a,r),h=s.intersection(n._rect1.setTo(0,0,e.width,e.height),n._rect2);if(!h)return null;var l=n.create(e,h.x,h.y,h.width,h.height,h.x-s.x,h.y-s.y,a,r);return l.bitmap._removeReference(),l},n.DEF_UV=[0,0,1,0,1,1,0,1],n.INV_UV=[0,1,1,1,1,0,0,0],n._rect1=new k,n._rect2=new k,n}(),pe=function(e){function t(){this._labelDic=null,this._tweenDic={},this._tweenDataList=[],this._endTweenDataList=null,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this._firstTweenDic={},this._startTimeSort=!1,this._endTimeSort=!1,this._loopKey=!1,this.scale=1,this._frameRate=60,this._frameIndex=0,this._total=0,t.__super.call(this)}var n;a(t,"laya.utils.TimeLine",h);var o=t.prototype;return o.to=function(e,t,i,n,a){return void 0===a&&(a=0),this._create(e,t,i,n,a,!0)},o.from=function(e,t,i,n,a){return void 0===a&&(a=0),this._create(e,t,i,n,a,!1)},o._create=function(e,t,i,a,r,o){var s=G.getItemByClass("tweenData",n);return s.isTo=o,s.type=0,s.target=e,s.duration=i,s.data=t,s.startTime=this._startTime+r,s.endTime=s.startTime+s.duration,s.ease=a,this._startTime=Math.max(s.endTime,this._startTime),this._tweenDataList.push(s),this._startTimeSort=!0,this._endTimeSort=!0,this},o.addLabel=function(e,t){var i=G.getItemByClass("tweenData",n);return i.type=1,i.data=e,i.endTime=i.startTime=this._startTime+t,this._labelDic||(this._labelDic={}),this._labelDic[e]=i,this._tweenDataList.push(i),this},o.removeLabel=function(e){if(this._labelDic&&this._labelDic[e]){var t=this._labelDic[e];if(t){var i=this._tweenDataList.indexOf(t);i>-1&&this._tweenDataList.splice(i,1)}delete this._labelDic[e]}},o.gotoTime=function(e){if(null!=this._tweenDataList&&0!=this._tweenDataList.length){var t,i;for(var n in this._firstTweenDic)if(i=this._firstTweenDic[n])for(var a in i)i.diyTarget.hasOwnProperty(a)&&(i.diyTarget[a]=i[a]);for(n in this._tweenDic)(t=this._tweenDic[n]).clear(),delete this._tweenDic[n];this._index=0,this._gidIndex=0,this._currTime=e,this._lastTime=O.now();var r;null==this._endTweenDataList||this._endTimeSort?(this._endTimeSort=!1,this._endTweenDataList=r=this._tweenDataList.concat(),r.sort(function(e,t){return e.endTime>t.endTime?1:e.endTime<t.endTime?-1:0})):r=this._endTweenDataList;for(var o,s=0,h=r.length;s<h;s++)if(0==(o=r[s]).type){if(!(e>=o.endTime))break;this._index=Math.max(this._index,s+1);var c=o.data;if(o.isTo)for(var p in c)o.target[p]=c[p]}for(s=0,h=this._tweenDataList.length;s<h;s++)0==(o=this._tweenDataList[s]).type&&e>=o.startTime&&e<o.endTime&&(this._index=Math.max(this._index,s+1),this._gidIndex++,(t=G.getItemByClass("tween",q))._create(o.target,o.data,o.duration,o.ease,l.create(this,this._animComplete,[this._gidIndex]),0,!1,o.isTo,!0,!1),t.setStartTime(this._currTime-(e-o.startTime)),t._updateEase(this._currTime),t.gid=this._gidIndex,this._tweenDic[this._gidIndex]=t)}},o.gotoLabel=function(e){if(null!=this._labelDic){var t=this._labelDic[e];t&&this.gotoTime(t.startTime)}},o.pause=function(){i.timer.clear(this,this._update)},o.resume=function(){this.play(this._currTime,this._loopKey)},o.play=function(e,t){if(void 0===e&&(e=0),void 0===t&&(t=!1),this._tweenDataList){if(this._startTimeSort){this._startTimeSort=!1,this._tweenDataList.sort(function(e,t){return e.startTime>t.startTime?1:e.startTime<t.startTime?-1:0});for(var n=0,a=this._tweenDataList.length;n<a;n++){var r=this._tweenDataList[n];if(null!=r&&0==r.type){var o=r.target,s=o.$_GID||(o.$_GID=K.getGID()),h=null;null==this._firstTweenDic[s]?((h={}).diyTarget=o,this._firstTweenDic[s]=h):h=this._firstTweenDic[s];for(var l in r.data)null==h[l]&&(h[l]=o[l])}}}"string"==typeof e?this.gotoLabel(e):this.gotoTime(e),this._loopKey=t,this._lastTime=O.now(),i.timer.frameLoop(1,this,this._update)}},o._update=function(){if(this._currTime>=this._startTime){if(!this._loopKey){for(var e in this._tweenDic)(a=this._tweenDic[e]).complete();return this._complete(),void this.pause()}if(this._complete(),!this._tweenDataList)return;this.gotoTime(0)}var t=O.now(),i=t-this._lastTime,n=this._currTime+=i*this.scale;this._lastTime=t;for(e in this._tweenDic)(a=this._tweenDic[e])._updateEase(n);var a;if(0!=this._tweenDataList.length&&this._index<this._tweenDataList.length){var r=this._tweenDataList[this._index];n>=r.startTime&&(this._index++,0==r.type?(this._gidIndex++,(a=G.getItemByClass("tween",q))._create(r.target,r.data,r.duration,r.ease,l.create(this,this._animComplete,[this._gidIndex]),0,!1,r.isTo,!0,!1),a.setStartTime(n),a.gid=this._gidIndex,this._tweenDic[this._gidIndex]=a,a._updateEase(n)):this.event("label",r.data))}},o._animComplete=function(e){this._tweenDic[e]&&delete this._tweenDic[e]},o._complete=function(){this.event("complete")},o.reset=function(){var e;if(this._labelDic)for(e in this._labelDic)delete this._labelDic[e];for(e in this._tweenDic)this._tweenDic[e].clear(),delete this._tweenDic[e];for(e in this._firstTweenDic)delete this._firstTweenDic[e];if(this._endTweenDataList=null,this._tweenDataList&&this._tweenDataList.length){var t=0,n=0;for(n=this._tweenDataList.length,t=0;t<n;t++)this._tweenDataList[t]&&this._tweenDataList[t].destroy()}this._tweenDataList.length=0,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this.scale=1,i.timer.clear(this,this._update)},o.destroy=function(){this.reset(),this._labelDic=null,this._tweenDic=null,this._tweenDataList=null,this._firstTweenDic=null},r(0,o,"index",function(){return this._frameIndex},function(e){this._frameIndex=e,this.gotoTime(this._frameIndex/this._frameRate*1e3)}),r(0,o,"total",function(){return this._total=Math.floor(this._startTime/1e3*this._frameRate),this._total}),t.to=function(e,i,n,a,r){return void 0===r&&(r=0),(new t).to(e,i,n,a,r)},t.from=function(e,i,n,a,r){return void 0===r&&(r=0),(new t).from(e,i,n,a,r)},t.__init$=function(){n=function(){function e(){this.type=0,this.isTo=!0,this.startTime=NaN,this.endTime=NaN,this.target=null,this.duration=NaN,this.ease=null,this.data=null}a(e,"");return e.prototype.destroy=function(){this.target=null,this.ease=null,this.data=null,this.isTo=!0,this.type=0,G.recover("tweenData",this)},e}()},t}(),ue=function(t){function s(){this._transform=null,this._tfChanged=!1,this._x=0,this._y=0,this._width=0,this._height=0,this._repaint=1,this._mouseEnableState=0,this._zOrder=0,this._graphics=null,this._renderType=0,this._optimizeScrollRect=!1,this._texture=null,this.mouseThrough=!1,this.autoSize=!1,this.hitTestPrior=!1,this.viewport=null,s.__super.call(this),this._style=p.EMPTY}a(s,"laya.display.Sprite",t);var h=s.prototype;return i.imps(h,{"laya.display.ILayout":!0}),h.createConchModel=function(){return new ConchNode},h.destroy=function(e){void 0===e&&(e=!0),this._releaseMem(),t.prototype.destroy.call(this,e),this._style&&this._style.destroy(),this._transform&&this._transform.destroy(),this._transform=null,this._style=null,this._graphics=null},h.updateZOrder=function(){K.updateOrder(this._childs)&&this.repaint()},h.reCache=function(){this._$P.cacheCanvas&&(this._$P.cacheCanvas.reCache=!0),this._repaint=1},h.setBounds=function(e){this._set$P("uBounds",e)},h.getBounds=function(){return this._$P.mBounds||this._set$P("mBounds",new k),k._getWrapRec(this._boundPointsToParent(),this._$P.mBounds)},h.getSelfBounds=function(){return this._$P.uBounds?this._$P.uBounds:(this._$P.mBounds||this._set$P("mBounds",new k),k._getWrapRec(this._getBoundPointsM(!1),this._$P.mBounds))},h._boundPointsToParent=function(e){void 0===e&&(e=!1);var t=0,i=0;this._style&&(t=this._style._tf.translateX,i=this._style._tf.translateY,e=e||0!==this._style._tf.rotate,this._style.scrollRect&&(t+=this._style.scrollRect.x,i+=this._style.scrollRect.y));var n=this._getBoundPointsM(e);if(!n||n.length<1)return n;if(8!=n.length&&(n=e?S.scanPList(n):k._getWrapRec(n,k.TEMP)._getBoundPoints()),!this.transform)return K.transPointList(n,this._x-t,this._y-i),n;var a=C.TEMP,r=0,o=n.length;for(r=0;r<o;r+=2)a.x=n[r],a.y=n[r+1],this.toParentPoint(a),n[r]=a.x,n[r+1]=a.y;return n},h.getGraphicBounds=function(e){return void 0===e&&(e=!1),this._graphics?this._graphics.getBounds(e):k.TEMP.setTo(0,0,0,0)},h._getBoundPointsM=function(e){if(void 0===e&&(e=!1),this._$P.uBounds)return this._$P.uBounds._getBoundPoints();if(this._$P.temBM||this._set$P("temBM",[]),this.scrollRect){var t=K.clearArray(this._$P.temBM),i=k.TEMP;return i.copyFrom(this.scrollRect),K.concatArray(t,i._getBoundPoints()),t}for(var n,a,r,o=this._graphics?this._graphics.getBoundPoints():K.clearArray(this._$P.temBM),s=0,h=(r=this._childs).length;s<h;s++)(n=r[s])instanceof laya.display.Sprite&&1==n.visible&&(a=n._boundPointsToParent(e))&&(o=o?K.concatArray(o,a):a);return o},h.getStyle=function(){return this._style===p.EMPTY&&(this._style=new p),this._style},h.setStyle=function(e){this._style=e},h._adjustTransform=function(){this._tfChanged=!1;var e,t=this._style._tf,i=t.scaleX,n=t.scaleY;if(t.rotate||1!==i||1!==n||t.skewX||t.skewY){(e=this._transform||(this._transform=M.create())).bTransform=!0;var a=.0174532922222222*(t.rotate-t.skewX),r=.0174532922222222*(t.rotate+t.skewY),o=Math.cos(r),s=Math.sin(r),h=Math.sin(a),l=Math.cos(a);return e.a=i*o,e.b=i*s,e.c=-n*h,e.d=n*l,e.tx=e.ty=0,e}return this._transform&&this._transform.destroy(),this._transform=null,this._renderType&=-5,e},h.pos=function(e,t,i){if(void 0===i&&(i=!1),this._x!==e||this._y!==t){if(this.destroyed)return this;if(i){this._x=e,this._y=t,this.conchModel&&this.conchModel.pos(this._x,this._y);var n=this._parent;n&&0===n._repaint&&(n._repaint=1,n.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}else this.x=e,this.y=t}return this},h.pivot=function(e,t){return this.pivotX=e,this.pivotY=t,this},h.size=function(e,t){return this.width=e,this.height=t,this},h.scale=function(e,t,i){void 0===i&&(i=!1);var n=this.getStyle(),a=n._tf;if(a.scaleX!=e||a.scaleY!=t){if(this.destroyed)return this;if(i){n.setScale(e,t),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(e,t),this._renderType|=4;var r=this._parent;r&&0===r._repaint&&(r._repaint=1,r.parentRepaint())}else this.scaleX=e,this.scaleY=t}return this},h.skew=function(e,t){return this.skewX=e,this.skewY=t,this},h.render=function(e,t,i){j.spriteCount++,R.renders[this._renderType]._fun(this,e,t+this._x,i+this._y),this._repaint=0},h.drawToCanvas=function(e,t,i,n){if(N.isConchNode){var a=xe.create("2D");return new A(e,t,a).ctx.setCanvasType(1),this.conchModel.drawToCanvas(a.source,i,n),a}return o.drawToCanvas(this,this._renderType,e,t,i,n)},h.customRender=function(e,t,i){this._renderType|=1024},h._applyFilters=function(){if(!N.isWebGL){var e;if((e=this._$P.filters)&&!(e.length<1))for(var t=0,i=e.length;t<i;t++)e[t].action.apply(this._$P.cacheCanvas)}},h._isHaveGlowFilter=function(){var e=0,t=0;if(this.filters)for(e=0;e<this.filters.length;e++)if(8==this.filters[e].type)return!0;for(e=0,t=this._childs.length;e<t;e++)if(this._childs[e]._isHaveGlowFilter())return!0;return!1},h.localToGlobal=function(e,t){void 0===t&&(t=!1),!0===t&&(e=new C(e.x,e.y));for(var n=this;n&&n!=i.stage;)e=n.toParentPoint(e),n=n.parent;return e},h.globalToLocal=function(e,t){void 0===t&&(t=!1),t&&(e=new C(e.x,e.y));for(var n=this,a=[];n&&n!=i.stage;)a.push(n),n=n.parent;for(var r=a.length-1;r>=0;)e=(n=a[r]).fromParentPoint(e),r--;return e},h.toParentPoint=function(e){if(!e)return e;e.x-=this.pivotX,e.y-=this.pivotY,this.transform&&this._transform.transformPoint(e),e.x+=this._x,e.y+=this._y;var t=this._style.scrollRect;return t&&(e.x-=t.x,e.y-=t.y),e},h.fromParentPoint=function(e){if(!e)return e;e.x-=this._x,e.y-=this._y;var t=this._style.scrollRect;return t&&(e.x+=t.x,e.y+=t.y),this.transform&&this._transform.invertTransformPoint(e),e.x+=this.pivotX,e.y+=this.pivotY,e},h.on=function(e,i,n,a){return 1!==this._mouseEnableState&&this.isMouseEvent(e)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(e,i,n,a,!1)):t.prototype.on.call(this,e,i,n,a)},h.once=function(e,i,n,a){return 1!==this._mouseEnableState&&this.isMouseEvent(e)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(e,i,n,a,!0)):t.prototype.once.call(this,e,i,n,a)},h._$2__onDisplay=function(){if(1!==this._mouseEnableState){var e=this;for(e=e.parent;e&&1!==e._mouseEnableState&&!e._getBit(2);)e.mouseEnabled=!0,e._setBit(2,!0),e=e.parent}},h.loadImage=function(e,t,i,n,a,r){var o=this;return void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=0),void 0===a&&(a=0),this.graphics.loadImage(e,t,i,n,a,function(e){o.destroyed||(o.size(t+(n||e.width),i+(a||e.height)),o.repaint(),r&&r.runWith(e))}),this},h.repaint=function(){this.conchModel&&this.conchModel.repaint&&this.conchModel.repaint(),0===this._repaint&&(this._repaint=1,this.parentRepaint()),this._$P&&this._$P.maskParent&&this._$P.maskParent.repaint()},h._needRepaint=function(){return 0!==this._repaint&&this._$P.cacheCanvas&&this._$P.cacheCanvas.reCache},h._childChanged=function(e){this._childs.length?this._renderType|=2048:this._renderType&=-2049,e&&this._get$P("hasZorder")&&i.timer.callLater(this,this.updateZOrder),this.repaint()},h.parentRepaint=function(){var e=this._parent;e&&0===e._repaint&&(e._repaint=1,e.parentRepaint())},h.startDrag=function(e,t,i,n,a,r,o){void 0===t&&(t=!1),void 0===i&&(i=0),void 0===n&&(n=300),void 0===r&&(r=!1),void 0===o&&(o=.92),this._$P.dragging||this._set$P("dragging",new z),this._$P.dragging.start(this,e,t,i,n,a,r,o)},h.stopDrag=function(){this._$P.dragging&&this._$P.dragging.stop()},h._releaseMem=function(){if(this._$P){var e=this._$P.cacheCanvas;e&&e.ctx&&(G.recover("RenderContext",e.ctx),e.ctx.canvas.size(0,0),e.ctx=null);var t=this._$P._filterCache;t&&(t.destroy(),t.recycle(),this._set$P("_filterCache",null)),this._$P._isHaveGlowFilter&&this._set$P("_isHaveGlowFilter",!1),this._$P._isHaveGlowFilter=null}},h._setDisplay=function(e){e||this._releaseMem(),t.prototype._setDisplay.call(this,e)},h.hitTestPoint=function(e,t){var i=this.globalToLocal(C.TEMP.setTo(e,t));e=i.x,t=i.y;return(this._$P.hitArea?this._$P.hitArea:this._width>0&&this._height>0?k.TEMP.setTo(0,0,this._width,this._height):this.getSelfBounds()).contains(e,t)},h.getMousePoint=function(){return this.globalToLocal(C.TEMP.setTo(i.stage.mouseX,i.stage.mouseY))},h._getWords=function(){return null},h._addChildsToLayout=function(e){var t=this._getWords();if(null==t&&0==this._childs.length)return!1;if(t)for(var i=0,n=t.length;i<n;i++)e.push(t[i]);return this._childs.forEach(function(t,i,n){t._style._enableLayout()&&t._addToLayout(e)}),!0},h._addToLayout=function(e){this._style.absolute||(this._style.block?e.push(this):this._addChildsToLayout(e)&&(this.x=this.y=0))},h._isChar=function(){return!1},h._getCSSStyle=function(){return this._style.getCSSStyle()},h._setAttributes=function(e,t){switch(e){case"x":this.x=parseFloat(t);break;case"y":this.y=parseFloat(t);break;case"width":this.width=parseFloat(t);break;case"height":this.height=parseFloat(t);break;default:this[e]=t}},h._layoutLater=function(){this.parent&&this.parent._layoutLater()},r(0,h,"optimizeScrollRect",function(){return this._optimizeScrollRect},function(e){this._optimizeScrollRect!=e&&(this._optimizeScrollRect=e,this.conchModel&&this.conchModel.optimizeScrollRect(e))}),r(0,h,"customRenderEnable",null,function(e){if(e&&(this._renderType|=1024,N.isConchNode)){s.CustomList.push(this);var t=new xe("2d");t._setContext(new CanvasRenderingContext2D),this.customContext=new A(0,0,t),t.context.setCanvasType&&t.context.setCanvasType(2),this.conchModel.custom(t.context)}}),r(0,h,"cacheAsBitmap",function(){return"none"!==this.cacheAs},function(e){this.cacheAs=e?this._$P.hasFilter?"none":"normal":"none"}),r(0,h,"cacheAs",function(){return null==this._$P.cacheCanvas?"none":this._$P.cacheCanvas.type},function(e){var t=this._$P.cacheCanvas;if(e!==(t?t.type:"none")){if("none"!==e)this._getBit(1)||this._setUpNoticeType(1),t||(t=this._set$P("cacheCanvas",G.getItemByClass("cacheCanvas",Object))),t.type=e,t.reCache=!0,this._renderType|=16,"bitmap"==e&&this.conchModel&&this.conchModel.cacheAs(1),this._set$P("cacheForFilters",!1);else if(this._$P._mask);else if(this._$P.hasFilter)this._set$P("cacheForFilters",!0);else{if(t){var i=t;i&&i.ctx&&(G.recover("RenderContext",i.ctx),i.ctx.canvas.size(0,0),i.ctx=null),G.recover("cacheCanvas",t)}this._$P.cacheCanvas=null,this._renderType&=-17,this.conchModel&&this.conchModel.cacheAs(0)}this.repaint()}}),r(0,h,"zOrder",function(){return this._zOrder},function(e){this._zOrder!=e&&(this._zOrder=e,this.conchModel&&this.conchModel.setZOrder&&this.conchModel.setZOrder(e),this._parent&&(e&&this._parent._set$P("hasZorder",!0),i.timer.callLater(this._parent,this.updateZOrder)))}),r(0,h,"rotation",function(){return this._style._tf.rotate},function(e){var t=this.getStyle();if(t._tf.rotate!==e){t.setRotate(e),this._tfChanged=!0,this.conchModel&&this.conchModel.rotate(e),this._renderType|=4;var i=this._parent;i&&0===i._repaint&&(i._repaint=1,i.parentRepaint())}}),r(0,h,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(e){this._width!==e&&(this._width=e,this.conchModel&&this.conchModel.size(e,this._height),this.repaint())}),r(0,h,"x",function(){return this._x},function(e){if(this._x!==e){if(this.destroyed)return;this._x=e,this.conchModel&&this.conchModel.pos(e,this._y);var t=this._parent;t&&0===t._repaint&&(t._repaint=1,t.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),r(0,h,"globalScaleY",function(){for(var e=1,t=this;t&&t!==i.stage;)e*=t.scaleY,t=t.parent;return e}),r(0,h,"hitArea",function(){return this._$P.hitArea},function(e){this._set$P("hitArea",e)}),r(0,h,"staticCache",function(){return this._$P.staticCache},function(e){this._set$P("staticCache",e),e||this.reCache()}),r(0,h,"texture",function(){return this._texture},function(e){this._texture!=e&&(this._texture=e,this.graphics.cleanByTexture(e,0,0))}),r(0,h,"y",function(){return this._y},function(e){if(this._y!==e){if(this.destroyed)return;this._y=e,this.conchModel&&this.conchModel.pos(this._x,e);var t=this._parent;t&&0===t._repaint&&(t._repaint=1,t.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),r(0,h,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(e){this._height!==e&&(this._height=e,this.conchModel&&this.conchModel.size(this._width,e),this.repaint())}),r(0,h,"blendMode",function(){return this._style.blendMode},function(e){this.getStyle().blendMode=e,this.conchModel&&this.conchModel.blendMode(e),e&&"source-over"!=e?this._renderType|=8:this._renderType&=-9,this.parentRepaint()}),r(0,h,"scaleX",function(){return this._style._tf.scaleX},function(e){var t=this.getStyle();if(t._tf.scaleX!==e){t.setScaleX(e),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(e,t._tf.scaleY),this._renderType|=4;var i=this._parent;i&&0===i._repaint&&(i._repaint=1,i.parentRepaint())}}),r(0,h,"scaleY",function(){return this._style._tf.scaleY},function(e){var t=this.getStyle();if(t._tf.scaleY!==e){t.setScaleY(e),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(t._tf.scaleX,e),this._renderType|=4;var i=this._parent;i&&0===i._repaint&&(i._repaint=1,i.parentRepaint())}}),r(0,h,"stage",function(){return i.stage}),r(0,h,"skewX",function(){return this._style._tf.skewX},function(e){var t=this.getStyle();if(t._tf.skewX!==e){t.setSkewX(e),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(e,t._tf.skewY),this._renderType|=4;var i=this._parent;i&&0===i._repaint&&(i._repaint=1,i.parentRepaint())}}),r(0,h,"scrollRect",function(){return this._style.scrollRect},function(e){this.getStyle().scrollRect=e,this.repaint(),e?(this._renderType|=128,this.conchModel&&this.conchModel.scrollRect(e.x,e.y,e.width,e.height)):(this._renderType&=-129,this.conchModel&&(s.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(64):this.conchModel.removeType(128)))}),r(0,h,"skewY",function(){return this._style._tf.skewY},function(e){var t=this.getStyle();if(t._tf.skewY!==e){t.setSkewY(e),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(t._tf.skewX,e),this._renderType|=4;var i=this._parent;i&&0===i._repaint&&(i._repaint=1,i.parentRepaint())}}),r(0,h,"transform",function(){return this._tfChanged?this._adjustTransform():this._transform},function(e){this._tfChanged=!1,this._transform=e,e&&(this._x=e.tx,this._y=e.ty,e.tx=e.ty=0,this.conchModel&&this.conchModel.transform(e.a,e.b,e.c,e.d,this._x,this._y)),e?this._renderType|=4:(this._renderType&=-5,this.conchModel&&this.conchModel.removeType(4)),this.parentRepaint()}),r(0,h,"pivotX",function(){return this._style._tf.translateX},function(e){this.getStyle().setTranslateX(e),this.conchModel&&this.conchModel.pivot(e,this._style._tf.translateY),this.repaint()}),r(0,h,"pivotY",function(){return this._style._tf.translateY},function(e){this.getStyle().setTranslateY(e),this.conchModel&&this.conchModel.pivot(this._style._tf.translateX,e),this.repaint()}),r(0,h,"alpha",function(){return this._style.alpha},function(e){this._style&&this._style.alpha!==e&&(e=e<0?0:e>1?1:e,this.getStyle().alpha=e,this.conchModel&&this.conchModel.alpha(e),1!==e?this._renderType|=2:this._renderType&=-3,this.parentRepaint())}),r(0,h,"visible",function(){return this._style.visible},function(e){this._style&&this._style.visible!==e&&(this.getStyle().visible=e,this.conchModel&&this.conchModel.visible(e),this.parentRepaint())}),r(0,h,"graphics",function(){return this._graphics||(this.graphics=o.createGraphics())},function(e){this._graphics&&(this._graphics._sp=null),this._graphics=e,e?(this._renderType&=-2,this._renderType|=512,e._sp=this,this.conchModel&&this.conchModel.graphics(this._graphics)):(this._renderType&=-513,this._renderType&=-2,this.conchModel&&(s.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(256):this.conchModel.removeType(512))),this.repaint()}),r(0,h,"filters",function(){return this._$P.filters},function(e){e&&0===e.length&&(e=null),this._$P.filters!=e&&(this._set$P("filters",e?e.slice():null),N.isConchApp&&(this.conchModel&&(s.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(16):this.conchModel.removeType(32)),this._$P.filters&&1==this._$P.filters.length&&this._$P.filters[0].callNative(this)),N.isWebGL&&(e&&e.length?this._renderType|=32:this._renderType&=-33),e&&e.length>0?(this._getBit(1)||this._setUpNoticeType(1),N.isWebGL&&1==e.length&&e[0]instanceof laya.filters.ColorFilter||("bitmap"!=this.cacheAs&&(N.isConchNode||(this.cacheAs="bitmap"),this._set$P("cacheForFilters",!0)),this._set$P("hasFilter",!0))):(this._set$P("hasFilter",!1),this._$P.cacheForFilters&&"bitmap"==this.cacheAs&&(this.cacheAs="none")),this.repaint())}),r(0,h,"parent",t.prototype._$get_parent,function(e){i.superSet($,this,"parent",e),e&&this._getBit(2)&&this._$2__onDisplay()}),r(0,h,"mask",function(){return this._$P._mask},function(e){e&&this.mask&&this.mask._$P.maskParent||(e?(this.cacheAs="bitmap",this._set$P("_mask",e),e._set$P("maskParent",this)):(this.mask&&this.mask._set$P("maskParent",null),this._set$P("_mask",e),this.cacheAs="none"),this.conchModel&&this.conchModel.mask(e?e.conchModel:null),this._renderType|=64,this.parentRepaint())}),r(0,h,"mouseEnabled",function(){return this._mouseEnableState>1},function(e){this._mouseEnableState=e?2:1}),r(0,h,"globalScaleX",function(){for(var e=1,t=this;t&&t!==i.stage;)e*=t.scaleX,t=t.parent;return e}),r(0,h,"mouseX",function(){return this.getMousePoint().x}),r(0,h,"mouseY",function(){return this.getMousePoint().y}),s.fromImage=function(e){return(new s).loadImage(e)},s.CustomList=[],n(s,["RUNTIMEVERION",function(){return this.RUNTIMEVERION=e.conch?conchConfig.getRuntimeVersion().substr(conchConfig.getRuntimeVersion().lastIndexOf("-")+1):""}]),s}($),de=function(e){function t(e){this._audio=null,this._onEnd=null,this._resumePlay=null,t.__super.call(this),this._onEnd=K.bind(this.__onEnd,this),this._resumePlay=K.bind(this.__resumePlay,this),e.addEventListener("ended",this._onEnd),this._audio=e}a(t,"laya.media.h5audio.AudioSoundChannel",ie);var n=t.prototype;return n.__onEnd=function(){if(1==this.loops)return this.completeHandler&&(i.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");this.loops>0&&this.loops--,this.startTime=0,this.play()},n.__resumePlay=function(){this._audio&&this._audio.removeEventListener("canplay",this._resumePlay);try{this._audio.currentTime=this.startTime,O.container.appendChild(this._audio),this._audio.play()}catch(e){this.event("error")}},n.play=function(){this.isStopped=!1;try{this._audio.playbackRate=E.playbackRate,this._audio.currentTime=this.startTime}catch(e){return void this._audio.addEventListener("canplay",this._resumePlay)}E.addChannel(this),O.container.appendChild(this._audio),"play"in this._audio&&this._audio.play()},n.stop=function(){this.isStopped=!0,E.removeChannel(this),this.completeHandler=null,this._audio&&("pause"in this._audio&&N.isConchApp&&this._audio.stop(),this._audio.pause(),this._audio.removeEventListener("ended",this._onEnd),this._audio.removeEventListener("canplay",this._resumePlay),O.onIE||this._audio!=te._musicAudio&&G.recover("audio:"+this.url,this._audio),O.removeElement(this._audio),this._audio=null)},n.pause=function(){this.isStopped=!0,E.removeChannel(this),"pause"in this._audio&&this._audio.pause()},n.resume=function(){this._audio&&(this.isStopped=!1,E.addChannel(this),"play"in this._audio&&this._audio.play())},r(0,n,"position",function(){return this._audio?this._audio.currentTime:0}),r(0,n,"duration",function(){return this._audio?this._audio.duration:0}),r(0,n,"volume",function(){return this._audio?this._audio.volume:1},function(e){this._audio&&(this._audio.volume=e)}),t}(),_e=function(e){function t(){this.audioBuffer=null,this.gain=null,this.bufferSource=null,this._currentTime=0,this._volume=1,this._startTime=0,this._pauseTime=0,this._onPlayEnd=null,this.context=ae.ctx,t.__super.call(this),this._onPlayEnd=K.bind(this.__onPlayEnd,this),this.context.createGain?this.gain=this.context.createGain():this.gain=this.context.createGainNode()}a(t,"laya.media.webaudio.WebAudioSoundChannel",ie);var n=t.prototype;return n.play=function(){if(E.addChannel(this),this.isStopped=!1,this._clearBufferSource(),this.audioBuffer){var e=this.context,t=this.gain,i=e.createBufferSource();this.bufferSource=i,i.buffer=this.audioBuffer,i.connect(t),t&&t.disconnect(),t.connect(e.destination),i.onended=this._onPlayEnd,this.startTime>=this.duration&&(this.startTime=0),this._startTime=O.now(),this.gain.gain.value=this._volume,0==this.loops&&(i.loop=!0),i.playbackRate.value=E.playbackRate,i.start(0,this.startTime),this._currentTime=0}},n.__onPlayEnd=function(){if(1==this.loops)return this.completeHandler&&(i.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");this.loops>0&&this.loops--,this.startTime=0,this.play()},n._clearBufferSource=function(){if(this.bufferSource){var e=this.bufferSource;e.stop?e.stop(0):e.noteOff(0),e.disconnect(0),e.onended=null,t._tryCleanFailed||this._tryClearBuffer(e),this.bufferSource=null}},n._tryClearBuffer=function(e){if(O.onMac)try{e.buffer=ae._miniBuffer}catch(e){t._tryCleanFailed=!0}else try{e.buffer=null}catch(e){t._tryCleanFailed=!0}},n.stop=function(){this._clearBufferSource(),this.audioBuffer=null,this.gain&&this.gain.disconnect(),this.isStopped=!0,E.removeChannel(this),this.completeHandler=null,E.autoReleaseSound&&i.timer.once(5e3,null,E.disposeSoundIfNotUsed,[this.url],!1)},n.pause=function(){this.isStopped||(this._pauseTime=this.position),this._clearBufferSource(),this.gain&&this.gain.disconnect(),this.isStopped=!0,E.removeChannel(this),E.autoReleaseSound&&i.timer.once(5e3,null,E.disposeSoundIfNotUsed,[this.url],!1)},n.resume=function(){this.startTime=this._pauseTime,this.play()},r(0,n,"position",function(){return this.bufferSource?(O.now()-this._startTime)/1e3+this.startTime:0}),r(0,n,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),r(0,n,"volume",function(){return this._volume},function(e){this.isStopped||(this._volume=e,this.gain.gain.value=e)}),t._tryCleanFailed=!1,t}(),me=function(e){function t(){t.__super.call(this),this._w=0,this._h=0}a(t,"laya.resource.Bitmap",le);var i=t.prototype;return r(0,i,"width",function(){return this._w}),r(0,i,"height",function(){return this._h}),r(0,i,"source",function(){return this._source}),t}(),fe=function(e){function t(){this.loop=!1,this.wrapMode=0,this._index=0,this._count=0,this._isPlaying=!1,this._labels=null,this._isReverse=!1,this._frameRateChanged=!1,this._controlNode=null,this._actionName=null,t.__super.call(this),this._interval=s.animationInterval,this._setUpNoticeType(1)}a(t,"laya.display.AnimationPlayerBase",e);var i=t.prototype;return i.play=function(e,t,i,n){void 0===e&&(e=0),void 0===t&&(t=!0),void 0===i&&(i=""),void 0===n&&(n=!0),this._isPlaying=!0,this.index="string"==typeof e?this._getFrameByLabel(e):e,this.loop=t,this._actionName=i,this._isReverse=1==this.wrapMode,this.interval>0&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},i._getFrameByLabel=function(e){var t=0;for(t=0;t<this._count;t++)if(this._labels[t]&&this._labels[t].indexOf(e)>=0)return t;return 0},i._frameLoop=function(){if(this._isReverse){if(this._index--,this._index<0){if(!this.loop)return this._index=0,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=this._count>0?1:0,this._isReverse=!1):this._index=this._count-1,this.event("complete")}}else if(this._index++,this._index>=this._count){if(!this.loop)return this._index--,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=this._count-2>=0?this._count-2:0,this._isReverse=!0):this._index=0,this.event("complete")}this.index=this._index},i._setControlNode=function(e){this._controlNode&&(this._controlNode.off("display",this,this._checkResumePlaying),this._controlNode.off("undisplay",this,this._checkResumePlaying)),this._controlNode=e,e&&e!=this&&(e.on("display",this,this._checkResumePlaying),e.on("undisplay",this,this._checkResumePlaying))},i._setDisplay=function(t){e.prototype._setDisplay.call(this,t),this._checkResumePlaying()},i._checkResumePlaying=function(){this._isPlaying&&(this._controlNode.displayedInStage?this.play(this._index,this.loop,this._actionName):this.clearTimer(this,this._frameLoop))},i.stop=function(){this._isPlaying=!1,this.clearTimer(this,this._frameLoop)},i.addLabel=function(e,t){this._labels||(this._labels={}),this._labels[t]||(this._labels[t]=[]),this._labels[t].push(e)},i.removeLabel=function(e){if(e){if(this._labels)for(var t in this._labels)this._removeLabelFromLabelList(this._labels[t],e)}else this._labels=null},i._removeLabelFromLabelList=function(e,t){if(e)for(var i=e.length-1;i>=0;i--)e[i]==t&&e.splice(i,1)},i.gotoAndStop=function(e){this.index="string"==typeof e?this._getFrameByLabel(e):e,this.stop()},i._displayToIndex=function(e){},i.clear=function(){this.stop(),this._labels=null},r(0,i,"interval",function(){return this._interval},function(e){this._interval!=e&&(this._frameRateChanged=!0,this._interval=e,this._isPlaying&&e>0&&this.timerLoop(e,this,this._frameLoop,null,!0,!0))}),r(0,i,"isPlaying",function(){return this._isPlaying}),r(0,i,"index",function(){return this._index},function(e){if(this._index=e,this._displayToIndex(e),this._labels&&this._labels[e])for(var t=this._labels[e],i=0,n=t.length;i<n;i++)this.event("label",t[i])}),r(0,i,"count",function(){return this._count}),t.WRAP_POSITIVE=0,t.WRAP_REVERSE=1,t.WRAP_PINGPONG=2,t}(ue),ge=function(e){function t(){this._clipPoint=null,this._currBitmapFont=null,this._text=null,this._isChanged=!1,this._isColorChanged=!1,this._textWidth=0,this._textHeight=0,this._lines=[],this._lineWidths=[],this._startX=NaN,this._startY=NaN,this._lastVisibleLineIndex=-1,this._words=null,this._charSize={},this.underline=!1,this._underlineColor=null,t.__super.call(this),this.overflow=t.VISIBLE,this._style=new ee(this),this._style.wordWrap=!1}a(t,"laya.display.Text",e);var o=t.prototype;return o.destroy=function(t){void 0===t&&(t=!0),e.prototype.destroy.call(this,t),this._lines=null,this._words&&(this._words.length=0,this._words=null)},o._getBoundPointsM=function(e){void 0===e&&(e=!1);var t=k.TEMP;return t.setTo(0,0,this.width,this.height),t._getBoundPoints()},o.getGraphicBounds=function(e){void 0===e&&(e=!1);var t=k.TEMP;return t.setTo(0,0,this.width,this.height),t},o._getCSSStyle=function(){return this._style},o.lang=function(e,i,n,a,r,o,s,h,l,c,p){if(e=t.langPacks&&t.langPacks[e]?t.langPacks[e]:e,arguments.length<2)this._text=e;else{for(var u=0,d=arguments.length;u<d;u++)e=e.replace("{"+u+"}",arguments[u+1]);this._text=e}},o._isPassWordMode=function(){var e=this._style.password;return"prompt"in this&&this.prompt==this._text&&(e=!1),e},o._getPassWordTxt=function(e){var t;t="";for(var i=e.length;i>0;i--)t+="●";return t},o.renderText=function(e,t){var i=this.graphics;i.clear(!0);var n=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+(O.onIPhone?laya.display.Text._fontFamilyMap[this.font]||this.font:this.font);O.context.font=n;var a=this.padding,r=a[3],o="left",s=this._lines,h=this.leading+this._charSize.height,l=this._currBitmapFont;l&&(h=this.leading+l.getMaxHeight());var c=a[0];if(!l&&this._width>0&&this._textWidth<=this._width&&("right"==this.align?(o="right",r=this._width-a[1]):"center"==this.align&&(o="center",r=.5*this._width+a[3]-a[1])),this._height>0){var p=this._textHeight>this._height?"top":this.valign;"middle"===p?c=.5*(this._height-t*h)+a[0]-a[2]:"bottom"===p&&(c=this._height-t*h-a[2])}var u=this._style;if(l&&l.autoScaleSize)var d=l.fontSize/this.fontSize;if(this._clipPoint)if(i.save(),l&&l.autoScaleSize){var _=0,m=0;_=this._width?this._width-a[3]-a[1]:this._textWidth,m=this._height?this._height-a[0]-a[2]:this._textHeight,_*=d,m*=d,i.clipRect(a[3],a[0],_,m)}else i.clipRect(a[3],a[0],this._width?this._width-a[3]-a[1]:this._textWidth,this._height?this._height-a[0]-a[2]:this._textHeight);var f=u.password;"prompt"in this&&this.prompt==this._text&&(f=!1);for(var g=0,y=0,v=Math.min(this._lines.length,t+e)||1,x=e;x<v;x++){var b,w=s[x];if(f){var S=w.length;w="";for(var I=S;I>0;I--)w+="●"}if(g=r-(this._clipPoint?this._clipPoint.x:0),y=c+h*x-(this._clipPoint?this._clipPoint.y:0),this.underline&&this.drawUnderline(o,g,y,x),l){var M=this.width;l.autoScaleSize&&(M=this.width*d),l.drawText(w,this,g,y,this.align,M)}else N.isWebGL?(this._words||(this._words=[]),(b=this._words.length>x-e?this._words[x-e]:new Q).setText(w)):b=w,u.stroke?i.fillBorderText(b,g,y,n,this.color,u.strokeColor,u.stroke,o):i.fillText(b,g,y,n,this.color,o)}if(l&&l.autoScaleSize){var C=1/d;this.scale(C,C)}this._clipPoint&&i.restore(),this._startX=r,this._startY=c},o.drawUnderline=function(e,t,i,n){var a=this._lineWidths[n];switch(e){case"center":t-=a/2;break;case"right":t-=a}i+=this._charSize.height,this._graphics.drawLine(t,i,t+a,i,this.underlineColor||this.color,1)},o.typeset=function(){if(this._isChanged=!1,this._isColorChanged&&(this._isColorChanged=!1,this._currBitmapFont)){var e=parseInt(this.color.substring(1),16),i=new he([((16711680&e)>>16)/255,0,0,0,0,0,((65280&e)>>8)/255,0,0,0,0,0,(255&e)/255,0,0,0,0,0,1,0]);this.filters=[i]}if(!this._text)return this._clipPoint=null,this._textWidth=this._textHeight=0,void this.graphics.clear(!0);O.context.font=this._getCSSStyle().font,this._lines.length=0,this._lineWidths.length=0,this._isPassWordMode()?this.parseLines(this._getPassWordTxt(this._text)):this.parseLines(this._text),this.evalTextSize(),this.checkEnabledViewportOrNot()?this._clipPoint||(this._clipPoint=new C(0,0)):this._clipPoint=null;var n=this._lines.length;if(this.overflow!=t.VISIBLE){var a=this.overflow==t.HIDDEN?Math.floor:Math.ceil;n=Math.min(n,a((this.height-this.padding[0]-this.padding[2])/(this.leading+this._charSize.height)))}var r=this.scrollY/(this._charSize.height+this.leading)|0;this.renderText(r,n),this.repaint()},o.evalTextSize=function(){var e=NaN,t=NaN;e=Math.max.apply(this,this._lineWidths),t=this._currBitmapFont?this._lines.length*(this._currBitmapFont.getMaxHeight()+this.leading)+this.padding[0]+this.padding[2]:this._lines.length*(this._charSize.height+this.leading)+this.padding[0]+this.padding[2],e==this._textWidth&&t==this._textHeight||(this._textWidth=e,this._textHeight=t,this._width&&this._height||this.conchModel&&this.conchModel.size(this._width||this._textWidth,this._height||this._textHeight))},o.checkEnabledViewportOrNot=function(){return this.overflow==t.SCROLL&&(this._width>0&&this._textWidth>this._width||this._height>0&&this._textHeight>this._height)},o.changeText=function(e){this._text!==e&&(this.lang(e+""),this._graphics&&this._graphics.replaceText(this._text)||this.typeset())},o.parseLines=function(e){var i=this.wordWrap||this.overflow==t.HIDDEN;if(i)var n=this.getWordWrapWidth();if(this._currBitmapFont)this._charSize.width=this._currBitmapFont.getMaxWidth(),this._charSize.height=this._currBitmapFont.getMaxHeight();else{var a=O.context.measureText(t._testWord);N.isConchApp&&0===a.width&&0===a.height&&(a=O.context.measureText("W")),this._charSize.width=a.width,this._charSize.height=a.height||this.fontSize}for(var r=e.replace(/\r\n/g,"\n").split("\n"),o=0,s=r.length;o<s;o++){var h=r[o];i?this.parseLine(h,n):(this._lineWidths.push(this.getTextWidth(h)),this._lines.push(h))}},o.parseLine=function(e,i){O.context;var n,a=this._lines,r=0,o=NaN,s=NaN,h=0;if((o=this.getTextWidth(e))<=i)return a.push(e),void this._lineWidths.push(o);o=this._charSize.width,0==(r=Math.floor(i/o))&&(r=1),s=o=this.getTextWidth(e.substring(0,r));for(var l=r,c=e.length;l<c;l++)if(o=this.getTextWidth(e.charAt(l)),(s+=o)>i)if(this.wordWrap){var p=e.substring(h,l);if(p.charCodeAt(p.length-1)<255?(n=/(?:\w|-)+$/.exec(p))&&(l=n.index+h,0==n.index?l+=p.length:p=e.substring(h,l)):t.RightToLeft&&(n=/([\u0600-\u06FF])+$/.exec(p))&&(l=n.index+h,0==n.index?l+=p.length:p=e.substring(h,l)),a.push(p),this._lineWidths.push(s-o),h=l,!(l+r<c)){a.push(e.substring(h,c)),this._lineWidths.push(this.getTextWidth(a[a.length-1])),h=-1;break}l+=r,s=o=this.getTextWidth(e.substring(h,l)),l--}else if(this.overflow==t.HIDDEN)return a.push(e.substring(0,l)),void this._lineWidths.push(this.getTextWidth(a[a.length-1]));this.wordWrap&&-1!=h&&(a.push(e.substring(h,c)),this._lineWidths.push(this.getTextWidth(a[a.length-1])))},o.getTextWidth=function(e){return this._currBitmapFont?this._currBitmapFont.getTextWidth(e):O.context.measureText(e).width},o.getWordWrapWidth=function(){var e=this.padding,t=NaN;return(t=this._currBitmapFont&&this._currBitmapFont.autoScaleSize?this._width*(this._currBitmapFont.fontSize/this.fontSize):this._width)<=0&&(t=this.wordWrap?100:O.width),t<=0&&(t=100),t-e[3]-e[1]},o.getCharPoint=function(e,t){this._isChanged&&i.timer.runCallLater(this,this.typeset);for(var n=0,a=this._lines,r=0,o=0,s=a.length;o<s;o++){if(n+=a[o].length,e<n){var h=o;break}r=n}var l=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+this.font;O.context.font=l;var c=this.getTextWidth(this._text.substring(r,e));return(t||new C).setTo(this._startX+c-(this._clipPoint?this._clipPoint.x:0),this._startY+h*(this._charSize.height+this.leading)-(this._clipPoint?this._clipPoint.y:0))},r(0,o,"width",function(){return this._width?this._width:this.textWidth+this.padding[1]+this.padding[3]},function(e){e!=this._width&&(i.superSet(ue,this,"width",e),this.isChanged=!0)}),r(0,o,"textWidth",function(){return this._isChanged&&i.timer.runCallLater(this,this.typeset),this._textWidth}),r(0,o,"height",function(){return this._height?this._height:this.textHeight+this.padding[0]+this.padding[2]},function(e){e!=this._height&&(i.superSet(ue,this,"height",e),this.isChanged=!0)}),r(0,o,"textHeight",function(){return this._isChanged&&i.timer.runCallLater(this,this.typeset),this._textHeight}),r(0,o,"padding",function(){return this._getCSSStyle().padding},function(e){this._getCSSStyle().padding=e,this.isChanged=!0}),r(0,o,"bold",function(){return this._getCSSStyle().bold},function(e){this._getCSSStyle().bold=e,this.isChanged=!0}),r(0,o,"text",function(){return this._text||""},function(e){this._text!==e&&(this.lang(e+""),this.isChanged=!0,this.event("change"))}),r(0,o,"color",function(){return this._getCSSStyle().color},function(e){this._getCSSStyle().color!=e&&(this._getCSSStyle().color=e,this._isChanged||!this._graphics||this._currBitmapFont?(this.isChanged=!0,this._isColorChanged=!0):this._graphics.replaceTextColor(this.color))}),r(0,o,"font",function(){return this._getCSSStyle().fontFamily},function(e){this._currBitmapFont&&(this._currBitmapFont=null,this.scale(1,1)),t._bitmapFonts&&t._bitmapFonts[e]&&(this._currBitmapFont=t._bitmapFonts[e]),this._getCSSStyle().fontFamily=e,this.isChanged=!0}),r(0,o,"fontSize",function(){return this._getCSSStyle().fontSize},function(e){this._getCSSStyle().fontSize=e,this.isChanged=!0}),r(0,o,"italic",function(){return this._getCSSStyle().italic},function(e){this._getCSSStyle().italic=e,this.isChanged=!0}),r(0,o,"align",function(){return this._getCSSStyle().align},function(e){this._getCSSStyle().align=e,this.isChanged=!0}),r(0,o,"valign",function(){return this._getCSSStyle().valign},function(e){this._getCSSStyle().valign=e,this.isChanged=!0}),r(0,o,"wordWrap",function(){return this._getCSSStyle().wordWrap},function(e){this._getCSSStyle().wordWrap=e,this.isChanged=!0}),r(0,o,"leading",function(){return this._getCSSStyle().leading},function(e){this._getCSSStyle().leading=e,this.isChanged=!0}),r(0,o,"bgColor",function(){return this._getCSSStyle().backgroundColor},function(e){this._getCSSStyle().backgroundColor=e,this.isChanged=!0}),r(0,o,"borderColor",function(){return this._getCSSStyle().borderColor},function(e){this._getCSSStyle().borderColor=e,this.isChanged=!0}),r(0,o,"stroke",function(){return this._getCSSStyle().stroke},function(e){this._getCSSStyle().stroke=e,this.isChanged=!0}),r(0,o,"strokeColor",function(){return this._getCSSStyle().strokeColor},function(e){this._getCSSStyle().strokeColor=e,this.isChanged=!0}),r(0,o,"isChanged",null,function(e){this._isChanged!==e&&(this._isChanged=e,e&&i.timer.callLater(this,this.typeset))}),r(0,o,"scrollX",function(){return this._clipPoint?this._clipPoint.x:0},function(e){if(!(this.overflow!=t.SCROLL||this.textWidth<this._width)&&this._clipPoint){e=e<this.padding[3]?this.padding[3]:e;var i=this._textWidth-this._width;e=e>i?i:e;var n=this._height/(this._charSize.height+this.leading)|1;this._clipPoint.x=e,this.renderText(this._lastVisibleLineIndex,n)}}),r(0,o,"scrollY",function(){return this._clipPoint?this._clipPoint.y:0},function(e){if(!(this.overflow!=t.SCROLL||this.textHeight<this._height)&&this._clipPoint){e=e<this.padding[0]?this.padding[0]:e;var i=this._textHeight-this._height,n=(e=e>i?i:e)/(this._charSize.height+this.leading)|0;this._lastVisibleLineIndex=n;var a=1+(this._height/(this._charSize.height+this.leading)|0);this._clipPoint.y=e,this.renderText(n,a)}}),r(0,o,"maxScrollX",function(){return this.textWidth<this._width?0:this._textWidth-this._width}),r(0,o,"maxScrollY",function(){return this.textHeight<this._height?0:this._textHeight-this._height}),r(0,o,"lines",function(){return this._isChanged&&this.typeset(),this._lines}),r(0,o,"underlineColor",function(){return this._underlineColor},function(e){this._underlineColor=e,this._isChanged=!0,this.typeset()}),t.registerBitmapFont=function(e,i){t._bitmapFonts||(t._bitmapFonts={}),t._bitmapFonts[e]=i},t.unregisterBitmapFont=function(e,i){if(void 0===i&&(i=!0),t._bitmapFonts&&t._bitmapFonts[e]){var n=t._bitmapFonts[e];i&&n.destroy(),delete t._bitmapFonts[e]}},t.setTextRightToLeft=function(){var e;(e=O.canvas.source.style).display="none",e.position="absolute",e.direction="rtl",N._mainCanvas.source.style.direction="rtl",laya.display.Text.RightToLeft=!0,O.document.body.appendChild(O.canvas.source)},t.supportFont=function(e){O.context.font="10px sans-serif";var t=O.context.measureText("abcji").width;O.context.font="10px "+e;var i=O.context.measureText("abcji").width;return console.log(t,i),t!==i},t._testWord="游",t.langPacks=null,t.VISIBLE="visible",t.SCROLL="scroll",t.HIDDEN="hidden",t.CharacterCache=!0,t.RightToLeft=!1,t._bitmapFonts=null,n(t,["_fontFamilyMap",function(){return this._fontFamilyMap={"报隶":"报隶-简","黑体":"黑体-简","楷体":"楷体-简","兰亭黑":"兰亭黑-简","隶变":"隶变-简","凌慧体":"凌慧体-简","翩翩体":"翩翩体-简","苹方":"苹方-简","手札体":"手札体-简","宋体":"宋体-简","娃娃体":"娃娃体-简","魏碑":"魏碑-简","行楷":"行楷-简","雅痞":"雅痞-简","圆体":"圆体-简"}}]),t}(ue),ye=function(e){function t(){this.focus=null,this.designWidth=0,this.designHeight=0,this.canvasRotation=!1,this.canvasDegree=0,this.renderingEnabled=!0,this.screenAdaptationEnabled=!0,this._screenMode="none",this._scaleMode="noscale",this._alignV="top",this._alignH="left",this._bgColor="black",this._mouseMoveTime=0,this._renderCount=0,this._frameStartTime=NaN,this._isFocused=!1,this._isVisibility=!1,this._scenes=null,this._frameRate="fast",t.__super.call(this),this.offset=new C,this._canvasTransform=new M,this._previousOrientation=O.window.orientation;var e=this;this.transform=M.create(),this._scenes=[],this.mouseEnabled=!0,this.hitTestPrior=!0,this.autoSize=!1,this._displayedInStage=!0,this._isFocused=!0,this._isVisibility=!0;var i=O.window,n=this;i.addEventListener("focus",function(){e._isFocused=!0,n.event("focus"),n.event("focuschange")}),i.addEventListener("blur",function(){e._isFocused=!1,n.event("blur"),n.event("focuschange"),n._isInputting()&&(we.inputElement.target.focus=!1)});var a="visibilityState",r="visibilitychange",o=i.document;void 0!==o.hidden?(r="visibilitychange",a="visibilityState"):void 0!==o.mozHidden?(r="mozvisibilitychange",a="mozVisibilityState"):void 0!==o.msHidden?(r="msvisibilitychange",a="msVisibilityState"):void 0!==o.webkitHidden&&(r="webkitvisibilitychange",a="webkitVisibilityState"),i.document.addEventListener(r,function(){"hidden"==O.document[a]?n._setStageVisible(!1):n._setStageVisible(!0)}),i.document.addEventListener("qbrowserVisibilityChange",function(e){n._setStageVisible(!e.hidden)}),i.addEventListener("resize",function(){var t=O.window.orientation;null!=t&&t!=e._previousOrientation&&n._isInputting()&&(we.inputElement.target.focus=!1),e._previousOrientation=t,n._isInputting()||n._resetCanvas()}),i.addEventListener("orientationchange",function(e){n._resetCanvas()}),this.on("mousemove",this,this._onmouseMove),O.onMobile&&this.on("mousedown",this,this._onmouseMove)}a(t,"laya.display.Stage",e);var s=t.prototype;return s._setStageVisible=function(e){this._isVisibility!=e&&(this._isVisibility=e,this._isVisibility||this._isInputting()&&(we.inputElement.target.focus=!1),this.event("visibilitychange"))},s._isInputting=function(){return O.onMobile&&we.isInputting},s._changeCanvasSize=function(){this.setScreenSize(O.clientWidth*O.pixelRatio,O.clientHeight*O.pixelRatio)},s._resetCanvas=function(){if(this.screenAdaptationEnabled){var e=N._mainCanvas;e.source.style;e.size(1,1),i.timer.once(100,this,this._changeCanvasSize)}},s.setScreenSize=function(e,t){var i=!1;if("none"!==this._screenMode){if(i=(e/t<1?"vertical":"horizontal")!==this._screenMode){var n=t;t=e,e=n}}this.canvasRotation=i;var a=N._mainCanvas,r=a.source.style,s=this._canvasTransform.identity(),h=this._scaleMode,l=e/this.designWidth,c=t/this.designHeight,p=this.designWidth,u=this.designHeight,d=e,_=t,m=O.pixelRatio;switch(this._width=this.designWidth,this._height=this.designHeight,h){case"noscale":l=c=1,d=this.designWidth,_=this.designHeight;break;case"showall":l=c=Math.min(l,c),p=d=Math.round(this.designWidth*l),u=_=Math.round(this.designHeight*c);break;case"noborder":l=c=Math.max(l,c),d=Math.round(this.designWidth*l),_=Math.round(this.designHeight*c);break;case"full":l=c=1,this._width=p=e,this._height=u=t;break;case"fixedwidth":c=l,this._height=u=Math.round(t/l);break;case"fixedheight":l=c,this._width=p=Math.round(e/c);break;case"fixedauto":e/t<this.designWidth/this.designHeight?(c=l,this._height=u=Math.round(t/l)):(l=c,this._width=p=Math.round(e/c))}this.conchModel&&this.conchModel.size(this._width,this._height),l*=this.scaleX,c*=this.scaleY,1===l&&1===c?this.transform.identity():(this.transform.a=this._formatData(l/(d/p)),this.transform.d=this._formatData(c/(_/u)),this.conchModel&&this.conchModel.scale(this.transform.a,this.transform.d)),a.size(p,u),o.changeWebGLSize(p,u),s.scale(d/p/m,_/u/m),"left"===this._alignH?this.offset.x=0:"right"===this._alignH?this.offset.x=(e-d)/m:this.offset.x=.5*(e-d)/m,"top"===this._alignV?this.offset.y=0:"bottom"===this._alignV?this.offset.y=(t-_)/m:this.offset.y=.5*(t-_)/m,this.offset.x=Math.round(this.offset.x),this.offset.y=Math.round(this.offset.y),s.translate(this.offset.x,this.offset.y),this.canvasDegree=0,i&&("horizontal"===this._screenMode?(s.rotate(Math.PI/2),s.translate(t/m,0),this.canvasDegree=90):(s.rotate(-Math.PI/2),s.translate(0,e/m),this.canvasDegree=-90)),s.a=this._formatData(s.a),s.d=this._formatData(s.d),s.tx=this._formatData(s.tx),s.ty=this._formatData(s.ty),r.transformOrigin=r.webkitTransformOrigin=r.msTransformOrigin=r.mozTransformOrigin=r.oTransformOrigin="0px 0px 0px",r.transform=r.webkitTransform=r.msTransform=r.mozTransform=r.oTransform="matrix("+s.toString()+")",s.translate(parseInt(r.left)||0,parseInt(r.top)||0),this.visible=!0,this._repaint=1,this.event("resize")},s._formatData=function(e){return Math.abs(e)<1e-6?0:Math.abs(1-e)<.001?e>0?1:-1:e},s.getMousePoint=function(){return C.TEMP.setTo(this.mouseX,this.mouseY)},s.repaint=function(){this._repaint=1},s.parentRepaint=function(){},s._loop=function(){return this.render(N.context,0,0),!0},s._onmouseMove=function(e){this._mouseMoveTime=O.now()},s.getTimeFromFrameStart=function(){return O.now()-this._frameStartTime},s.render=function(t,n,a){if("sleep"===this._frameRate&&!N.isConchApp){var r=O.now();if(!(r-this._frameStartTime>=1e3))return;this._frameStartTime=r}if(this._renderCount++,N.isFlash&&this.repaint(),this._style.visible){this._frameStartTime=O.now();var s="slow"!==("mouse"===this._frameRate?this._frameStartTime-this._mouseMoveTime<2e3?"fast":"slow":this._frameRate),h=this._renderCount%2==0;if(j.renderSlow=!s,s||h||N.isConchApp){j.loopCount++,y.instance.runEvent(),i.timer._update(),o.update3DLoop();var l,c=0,p=0;if(N.isConchNode)for(c=0,p=this._scenes.length;c<p;c++)(l=this._scenes[c])&&l._updateSceneConch();else for(c=0,p=this._scenes.length;c<p;c++)(l=this._scenes[c])&&l._updateScene();if(N.isConchNode){var u=ue.CustomList;for(c=0,p=u.length;c<p;c++){var d=u[c];d.customRender(d.customContext,0,0)}return}}N.isConchNode||this.renderingEnabled&&(s||!h||N.isConchWebGL)&&(N.isWebGL?(t.clear(),e.prototype.render.call(this,t,n,a),j._show&&j._sp&&j._sp.render(t,n,a),o.clear(this._bgColor),o.beginFlush(),t.flush(),o.endFinish(),J.instance&&J.getInstance().endDispose()):(o.clear(this._bgColor),e.prototype.render.call(this,t,n,a),j._show&&j._sp&&j._sp.render(t,n,a)))}else this._renderCount%5==0&&(j.loopCount++,y.instance.runEvent(),i.timer._update())},s._requestFullscreen=function(){var e=O.document.documentElement;e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()},s._fullScreenChanged=function(){i.stage.event("fullscreenchange")},s.exitFullscreen=function(){var e=O.document;e.exitFullscreen?e.exitFullscreen():e.mozCancelFullScreen?e.mozCancelFullScreen():e.webkitExitFullscreen&&e.webkitExitFullscreen()},r(0,s,"clientScaleX",function(){return this._transform?this._transform.getScaleX():1}),r(0,s,"desginHeight",function(){return console.debug("desginHeight已经弃用，请使用designHeight代替"),this.designHeight}),r(0,s,"frameRate",function(){return this._frameRate},function(e){if(this._frameRate=e,N.isConchApp)switch(this._frameRate){case"slow":O.window.conch&&O.window.conchConfig.setSlowFrame&&O.window.conchConfig.setSlowFrame(!0);break;case"fast":O.window.conch&&O.window.conchConfig.setSlowFrame&&O.window.conchConfig.setSlowFrame(!1);break;case"mouse":O.window.conch&&O.window.conchConfig.setMouseFrame&&O.window.conchConfig.setMouseFrame(2e3);break;case"sleep":O.window.conch&&O.window.conchConfig.setLimitFPS&&O.window.conchConfig.setLimitFPS(1);break;default:throw new Error("Stage:frameRate invalid.")}}),r(0,s,"clientScaleY",function(){return this._transform?this._transform.getScaleY():1}),r(0,s,"width",e.prototype._$get_width,function(e){this.designWidth=e,i.superSet(ue,this,"width",e),i.timer.callLater(this,this._changeCanvasSize)}),r(0,s,"alignH",function(){return this._alignH},function(e){this._alignH=e,i.timer.callLater(this,this._changeCanvasSize)}),r(0,s,"isFocused",function(){return this._isFocused}),r(0,s,"height",e.prototype._$get_height,function(e){this.designHeight=e,i.superSet(ue,this,"height",e),i.timer.callLater(this,this._changeCanvasSize)}),r(0,s,"transform",function(){return this._tfChanged&&this._adjustTransform(),this._transform=this._transform||M.create()},e.prototype._$set_transform),r(0,s,"isVisibility",function(){return this._isVisibility}),r(0,s,"desginWidth",function(){return console.debug("desginWidth已经弃用，请使用designWidth代替"),this.designWidth}),r(0,s,"scaleMode",function(){return this._scaleMode},function(e){this._scaleMode=e,i.timer.callLater(this,this._changeCanvasSize)}),r(0,s,"alignV",function(){return this._alignV},function(e){this._alignV=e,i.timer.callLater(this,this._changeCanvasSize)}),r(0,s,"bgColor",function(){return this._bgColor},function(e){this._bgColor=e,this.conchModel&&this.conchModel.bgColor(e),N.isWebGL&&(e?t._wgColor=H.create(e)._color:O.onMiniGame||(t._wgColor=null)),O.onLimixiu?t._wgColor=H.create(e)._color:N.canvas.style.background=e||"none"}),r(0,s,"mouseX",function(){return Math.round(y.instance.mouseX/this.clientScaleX)}),r(0,s,"mouseY",function(){return Math.round(y.instance.mouseY/this.clientScaleY)}),r(0,s,"screenMode",function(){return this._screenMode},function(e){this._screenMode=e}),r(0,s,"visible",e.prototype._$get_visible,function(e){if(this.visible!==e){i.superSet(ue,this,"visible",e);N._mainCanvas.source.style.visibility=e?"visible":"hidden"}}),r(0,s,"fullScreenEnabled",null,function(e){var t=O.document,i=N.canvas;e?(i.addEventListener("mousedown",this._requestFullscreen),i.addEventListener("touchstart",this._requestFullscreen),t.addEventListener("fullscreenchange",this._fullScreenChanged),t.addEventListener("mozfullscreenchange",this._fullScreenChanged),t.addEventListener("webkitfullscreenchange",this._fullScreenChanged),t.addEventListener("msfullscreenchange",this._fullScreenChanged)):(i.removeEventListener("mousedown",this._requestFullscreen),i.removeEventListener("touchstart",this._requestFullscreen),t.removeEventListener("fullscreenchange",this._fullScreenChanged),t.removeEventListener("mozfullscreenchange",this._fullScreenChanged),t.removeEventListener("webkitfullscreenchange",this._fullScreenChanged),t.removeEventListener("msfullscreenchange",this._fullScreenChanged))}),t.SCALE_NOSCALE="noscale",t.SCALE_EXACTFIT="exactfit",t.SCALE_SHOWALL="showall",t.SCALE_NOBORDER="noborder",t.SCALE_FULL="full",t.SCALE_FIXED_WIDTH="fixedwidth",t.SCALE_FIXED_HEIGHT="fixedheight",t.SCALE_FIXED_AUTO="fixedauto",t.ALIGN_LEFT="left",t.ALIGN_RIGHT="right",t.ALIGN_CENTER="center",t.ALIGN_TOP="top",t.ALIGN_MIDDLE="middle",t.ALIGN_BOTTOM="bottom",t.SCREEN_NONE="none",t.SCREEN_HORIZONTAL="horizontal",t.SCREEN_VERTICAL="vertical",t.FRAME_FAST="fast",t.FRAME_SLOW="slow",t.FRAME_MOUSE="mouse",t.FRAME_SLEEP="sleep",t.FRAME_MOUSE_THREDHOLD=2e3,n(t,["_wgColor",function(){return this._wgColor=[0,0,0,1]}]),t}(ue),ve=(function(e){function t(){this.url=null,this._channel=null,this._tar=null,this._playEvents=null,this._stopEvents=null,t.__super.call(this),this.visible=!1,this.on("added",this,this._onParentChange),this.on("removed",this,this._onParentChange)}a(t,"laya.media.SoundNode",ue);var i=t.prototype;i._onParentChange=function(){this.target=this.parent},i.play=function(e,t){void 0===e&&(e=1),isNaN(e)&&(e=1),this.url&&(this.stop(),this._channel=E.playSound(this.url,e,t))},i.stop=function(){this._channel&&!this._channel.isStopped&&this._channel.stop(),this._channel=null},i._setPlayAction=function(e,t,i,n){void 0===n&&(n=!0),this[i]&&e&&(n?e.on(t,this,this[i]):e.off(t,this,this[i]))},i._setPlayActions=function(e,t,i,n){if(void 0===n&&(n=!0),e&&t){var a=t.split(","),r=0,o=0;for(o=a.length,r=0;r<o;r++)this._setPlayAction(e,a[r],i,n)}},r(0,i,"playEvent",null,function(e){this._playEvents=e,e&&this._tar&&this._setPlayActions(this._tar,e,"play")}),r(0,i,"target",null,function(e){this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!1),this._setPlayActions(this._tar,this._stopEvents,"stop",!1)),this._tar=e,this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!0),this._setPlayActions(this._tar,this._stopEvents,"stop",!0))}),r(0,i,"stopEvent",null,function(e){this._stopEvents=e,e&&this._tar&&this._setPlayActions(this._tar,e,"stop")})}(),function(e){function t(){this._src=null,this._onload=null,this._onerror=null,t.__super.call(this)}a(t,"laya.resource.FileBitmap",me);var i=t.prototype;return r(0,i,"src",function(){return this._src},function(e){this._src=e}),r(0,i,"onload",null,function(e){}),r(0,i,"onerror",null,function(e){}),t}()),xe=function(e){function t(e,i){this._is2D=!1,t.__super.call(this);var n=this;if(this._source=this,"2D"===e||"AUTO"===e&&!N.isWebGL){this._is2D=!0,this._source=i||O.createElement("canvas"),this._w=this._source.width,this._h=this._source.height;var a=this;a.getContext=function(e,t){if(n._ctx)return n._ctx;var i=n._ctx=n._source.getContext(e,t);return i&&(i._canvas=a,N.isFlash||O.onLimixiu||(i.size=function(e,t){})),i}}this.lock=!0}a(t,"laya.resource.HTMLCanvas",me);var i=t.prototype;return i.clear=function(){this._ctx&&this._ctx.clear()},i.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},i.release=function(){},i._setContext=function(e){this._ctx=e},i.getContext=function(e,i){return this._ctx?this._ctx:this._ctx=t._createContext(this)},i.getMemSize=function(){return 0},i.size=function(e,t){(this._w!=e||this._h!=t||this._source&&(this._source.width!=e||this._source.height!=t))&&(this._w=e,this._h=t,this.memorySize=this._w*this._h*4,this._ctx&&this._ctx.size(e,t),this._source&&(this._source.height=t,this._source.width=e))},i.getCanvas=function(){return this._source},i.toBase64=function(e,t,i){if(this._source)if(N.isConchApp&&this._source.toBase64)this._source.toBase64(e,t,i);else{var n=this._source.toDataURL(e,t);i.call(this,n)}},r(0,i,"context",function(){return this._ctx}),r(0,i,"asBitmap",null,function(e){}),t.create=function(e,i){return new t(e,i)},t.TYPE2D="2D",t.TYPE3D="3D",t.TYPEAUTO="AUTO",t._createContext=null,t}(),be=(function(e){function t(e,i,n,a,r,o,s,h){throw t.__super.call(this),new Error("不允许new！")}a(t,"laya.resource.HTMLSubImage",me),t.create=function(e,i,n,a,r,o,s,h){return void 0===h&&(h=!1),new t(e,i,n,a,r,o,s,h)}}(),function(e){function t(){this._frames=null,this._url=null,t.__super.call(this),this._setControlNode(this)}a(t,"laya.display.Animation",e);var n=t.prototype;n.destroy=function(e){void 0===e&&(e=!0),this.stop(),laya.display.Sprite.prototype.destroy.call(this,e),this._frames=null,this._labels=null},n.play=function(e,t,i,n){void 0===e&&(e=0),void 0===t&&(t=!0),void 0===i&&(i=""),void 0===n&&(n=!0),i&&this._setFramesFromCache(i,n),this._isPlaying=!0,this.index="string"==typeof e?this._getFrameByLabel(e):e,this.loop=t,this._actionName=i,this._isReverse=1==this.wrapMode,this._frames&&this.interval>0&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},n._setFramesFromCache=function(e,i){if(void 0===i&&(i=!1),this._url&&(e=this._url+"#"+e),e&&t.framesMap[e]){var n;return(n=t.framesMap[e])instanceof Array?(this._frames=t.framesMap[e],this._count=this._frames.length):(n.nodeRoot&&(t.framesMap[e]=this._parseGraphicAnimationByData(n),n=t.framesMap[e]),this._frames=n.frames,this._count=this._frames.length,this._frameRateChanged||(this._interval=n.interval),this._labels=this._copyLabels(n.labels)),!0}return i&&console.log("ani not found:",e),!1},n._copyLabels=function(e){if(!e)return null;var t;t={};var i;for(i in e)t[i]=K.copyArray([],e[i]);return t},n._frameLoop=function(){this._style.visible&&this._style.alpha>.01&&e.prototype._frameLoop.call(this)},n._displayToIndex=function(e){this._frames&&(this.graphics=this._frames[e])},n.clear=function(){this.stop(),this.graphics=null,this._frames=null,this._labels=null},n.loadImages=function(e,i){return void 0===i&&(i=""),this._url="",this._setFramesFromCache(i)||(this.frames=t.framesMap[i]?t.framesMap[i]:t.createFrames(e,i)),this},n.loadAtlas=function(e,n,a){function r(i){e===i&&(o.frames=t.framesMap[a]?t.framesMap[a]:t.createFrames(e,a),n&&n.run())}void 0===a&&(a=""),this._url="";var o=this;return o._setFramesFromCache(a)||(oe.getAtlas(e)?r(e):i.loader.load(e,l.create(null,r,[e]),null,"atlas")),this},n.loadAnimation=function(e,t,n){this._url=e;return this._actionName||(this._actionName=""),this._setFramesFromCache("")?(this._setFramesFromCache(this._actionName,!0),this.index=0,t&&t.run()):!n||oe.getAtlas(n)?this._loadAnimationData(e,t,n):i.loader.load(n,l.create(this,this._loadAnimationData,[e,t,n]),null,"atlas"),this},n._loadAnimationData=function(e,n,a){function r(i){if(oe.getRes(i)&&e===i){var a;if(t.framesMap[e+"#"])s._setFramesFromCache(o._actionName,!0),o.index=0,o._checkResumePlaying();else{var r=s._parseGraphicAnimation(oe.getRes(e));if(!r)return;var h,l=r.animationList,c=0,p=l.length;for(c=0;c<p;c++)a=l[c],t.framesMap[e+"#"+a.name]=a,h||(h=a);h&&(t.framesMap[e+"#"]=h,s._setFramesFromCache(o._actionName,!0),o.index=0),o._checkResumePlaying()}n&&n.run()}}var o=this;if(!a||oe.getAtlas(a)){var s=this;oe.getRes(e)?r(e):i.loader.load(e,l.create(null,r,[e]),null,"json"),oe.clearRes(e)}else console.warn("atlas load fail:"+a)},n._parseGraphicAnimation=function(e){return Ie.parseAnimationData(e)},n._parseGraphicAnimationByData=function(e){return Ie.parseAnimationByData(e)},r(0,n,"frames",function(){return this._frames},function(e){this._frames=e,e&&(this._count=e.length,this._isPlaying?this.play(this._index,this.loop,this._actionName):this.index=this._index)}),r(0,n,"autoPlay",null,function(e){e?this.play():this.stop()}),r(0,n,"source",null,function(e){e.indexOf(".ani")>-1?this.loadAnimation(e):e.indexOf(".json")>-1||e.indexOf("als")>-1||e.indexOf("atlas")>-1?this.loadAtlas(e):this.loadImages(e.split(","))}),r(0,n,"autoAnimation",null,function(e){this.play(0,!0,e,!1)}),t.createFrames=function(e,i){var n,a,r=0,s=0;if("string"==typeof e){var h=oe.getAtlas(e);if(h&&h.length)for(n=[],r=0,s=h.length;r<s;r++)(a=new o.createGraphics).drawTexture(oe.getRes(h[r]),0,0),n.push(a)}else if(e instanceof Array)for(n=[],r=0,s=e.length;r<s;r++)(a=new o.createGraphics).loadImage(e[r],0,0),n.push(a);return i&&(t.framesMap[i]=n),n},t.clearCache=function(e){var i,n=t.framesMap,a=e+"#";for(i in n)i!==e&&0!=i.indexOf(a)||delete t.framesMap[i]},t.framesMap={}}(fe),function(e){function t(){this._targetDic=null,this._animationData=null,this._animationNewFrames=null,t.__super.call(this),null==t._sortIndexFun&&(t._sortIndexFun=I.sortByKey("index",!1,!0))}a(t,"laya.display.FrameAnimation",e);var n=t.prototype;return n._setUp=function(e,t){for(var n="fast"==i.stage.frameRate?60:30,a=n/t.frameRate,r=0;r<t.nodes.length;r++){var o=t.nodes[r].keyframes;for(var s in o)for(var h=o[s],l=0;l<h.length;l++)h[l].index=Math.floor(h[l].index*a+.5)}this._labels=null,this._animationNewFrames=null,this._targetDic=e,this._animationData=t,this.interval=1e3/n,t.parsed?(this._count=t.count,this._labels=t.labels,this._animationNewFrames=t.animationNewFrames):(this._animationNewFrames=[],this._calculateDatas()),t.parsed=!0,t.labels=this._labels,t.count=this._count,t.animationNewFrames=this._animationNewFrames},n.clear=function(){e.prototype.clear.call(this),this._targetDic=null,this._animationData=null},n._displayToIndex=function(e){if(this._animationData){e<0&&(e=0),e>this._count&&(e=this._count);var t=this._animationData.nodes,i=0,n=t.length;for(i=0;i<n;i++)this._displayNodeToFrame(t[i],e)}},n._displayNodeToFrame=function(e,t,i){i||(i=this._targetDic);var n=i[e.target];if(n){var a,r,o,s=e.frames,h=e.keys,l=0,c=h.length;for(l=0;l<c;l++)o=(r=s[a=h[l]]).length>t?r[t]:r[r.length-1],n[a]=o}},n._calculateDatas=function(){if(this._animationData){var e,t=this._animationData.nodes,i=0,n=t.length;for(this._count=0,i=0;i<n;i++)e=t[i],this._calculateNodeKeyFrames(e);this._count+=1}},n._calculateNodeKeyFrames=function(e){var i,n,a=e.keyframes,r=e.target;e.frames||(e.frames={}),e.keys?e.keys.length=0:e.keys=[],e.initValues||(e.initValues={});for(i in a)n=a[i],e.frames[i]||(e.frames[i]=[]),this._targetDic&&this._targetDic[r]&&(e.initValues[i]=this._targetDic[r][i]),n.sort(t._sortIndexFun),e.keys.push(i),this._calculateNodePropFrames(n,e.frames[i],i,r)},n.resetToInitState=function(){if(this._targetDic&&this._animationData){var e,t,i=this._animationData.nodes,n=0,a=i.length;for(n=0;n<a;n++)if(e=i[n],t=e.initValues){var r=this._targetDic[e.target];if(r){var o;for(o in t)r[o]=t[o]}}}},n._calculateNodePropFrames=function(e,t,i,n){var a=0,r=e.length-1;for(t.length=e[r].index+1,a=0;a<r;a++)this._dealKeyFrame(e[a]),this._calculateFrameValues(e[a],e[a+1],t);0==r&&(t[0]=e[0].value,this._animationNewFrames&&(this._animationNewFrames[e[0].index]=!0)),this._dealKeyFrame(e[a])},n._dealKeyFrame=function(e){e.label&&""!=e.label&&this.addLabel(e.label,e.index)},n._calculateFrameValues=function(e,t,i){var n,a=0,r=e.index,o=t.index,s=e.value,h=t.value-e.value,l=o-r;if(o>this._count&&(this._count=o),e.tween)for(null==(n=X[e.tweenMethod])&&(n=X.linearNone),a=r;a<o;a++)i[a]=n(a-r,s,h,l),this._animationNewFrames&&(this._animationNewFrames[a]=!0);else for(a=r;a<o;a++)i[a]=s;this._animationNewFrames&&(this._animationNewFrames[e.index]=!0,this._animationNewFrames[t.index]=!0),i[t.index]=t.value},t._sortIndexFun=null,t}(fe)),we=function(e){function t(){this._focus=!1,this._multiline=!1,this._editable=!0,this._restrictPattern=null,this._type="text",this._prompt="",this._promptColor="#A9A9A9",this._originColor="#000000",this._content="",t.__super.call(this),this._maxChars=1e5,this._width=100,this._height=20,this.multiline=!1,this.overflow=ge.SCROLL,this.on("mousedown",this,this._onMouseDown),this.on("undisplay",this,this._onUnDisplay)}a(t,"laya.display.Input",e);var o=t.prototype;return o.setSelection=function(e,t){this.focus=!0,laya.display.Input.inputElement.selectionStart=e,laya.display.Input.inputElement.selectionEnd=t},o._onUnDisplay=function(e){this.focus=!1},o._onMouseDown=function(e){this.focus=!0},o._syncInputTransform=function(){var e=this.nativeInput,n=K.getTransformRelativeToWindow(this,this.padding[3],this.padding[0]),a=this._width-this.padding[1]-this.padding[3],r=this._height-this.padding[0]-this.padding[2];N.isConchApp?(e.setScale(n.scaleX,n.scaleY),e.setSize(a,r),e.setPos(n.x,n.y)):(t.inputContainer.style.transform=t.inputContainer.style.webkitTransform="scale("+n.scaleX+","+n.scaleY+") rotate("+i.stage.canvasDegree+"deg)",e.style.width=a+"px",e.style.height=r+"px",t.inputContainer.style.left=n.x+"px",t.inputContainer.style.top=n.y+"px")},o.select=function(){this.nativeInput.select()},o._setInputMethod=function(){t.input.parentElement&&t.inputContainer.removeChild(t.input),t.area.parentElement&&t.inputContainer.removeChild(t.area),t.inputElement=this._multiline?t.area:t.input,t.inputContainer.appendChild(t.inputElement),ge.RightToLeft&&(t.inputElement.style.direction="rtl")},o._focusIn=function(){laya.display.Input.isInputting=!0;var e=this.nativeInput;this._focus=!0;var t=e.style;t.whiteSpace=this.wordWrap?"pre-wrap":"nowrap",this._setPromptColor(),e.readOnly=!this._editable,N.isConchApp&&(e.setType(this._type),e.setForbidEdit(!this._editable)),e.maxLength=this._maxChars;this.padding;if(e.type=this._type,e.value=this._content,e.placeholder=this._prompt,i.stage.off("keydown",this,this._onKeyDown),i.stage.on("keydown",this,this._onKeyDown),i.stage.focus=this,this.event("focus"),O.onPC&&e.focus(),!O.onMiniGame){this._text;this._text=null}this.typeset(),e.setColor(this._originColor),e.setFontSize(this.fontSize),e.setFontFace(O.onIPhone?ge._fontFamilyMap[this.font]||this.font:this.font),N.isConchApp&&e.setMultiAble&&e.setMultiAble(this._multiline),t.lineHeight=this.leading+this.fontSize+"px",t.fontStyle=this.italic?"italic":"normal",t.fontWeight=this.bold?"bold":"normal",t.textAlign=this.align,t.padding="0 0",this._syncInputTransform(),!N.isConchApp&&O.onPC&&i.timer.frameLoop(1,this,this._syncInputTransform)},o._setPromptColor=function(){(t.promptStyleDOM=O.getElementById("promptStyle"))||((t.promptStyleDOM=O.createElement("style")).setAttribute("id","promptStyle"),O.document.head.appendChild(t.promptStyleDOM)),t.promptStyleDOM.innerText="input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {color:"+this._promptColor+"}input:-moz-placeholder, textarea:-moz-placeholder {color:"+this._promptColor+"}input::-moz-placeholder, textarea::-moz-placeholder {color:"+this._promptColor+"}input:-ms-input-placeholder, textarea:-ms-input-placeholder {color:"+this._promptColor+"}"},o._focusOut=function(){laya.display.Input.isInputting=!1,this._focus=!1,this._text=null,this._content=this.nativeInput.value,this._content?(i.superSet(ge,this,"text",this._content),i.superSet(ge,this,"color",this._originColor)):(i.superSet(ge,this,"text",this._prompt),i.superSet(ge,this,"color",this._promptColor)),i.stage.off("keydown",this,this._onKeyDown),i.stage.focus=null,this.event("blur"),N.isConchApp&&this.nativeInput.blur(),O.onPC&&i.timer.clear(this,this._syncInputTransform)},o._onKeyDown=function(e){13===e.keyCode&&(O.onMobile&&!this._multiline&&(this.focus=!1),this.event("enter"))},o.changeText=function(t){this._content=t,this._focus?(this.nativeInput.value=t||"",this.event("change")):e.prototype.changeText.call(this,t)},r(0,o,"color",e.prototype._$get_color,function(e){this._focus&&this.nativeInput.setColor(e),i.superSet(ge,this,"color",this._content?e:this._promptColor),this._originColor=e}),r(0,o,"inputElementYAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。"),0},function(e){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。")}),r(0,o,"multiline",function(){return this._multiline},function(e){this._multiline=e,this.valign=e?"top":"middle"}),r(0,o,"maxChars",function(){return this._maxChars},function(e){e<=0&&(e=1e5),this._maxChars=e}),r(0,o,"text",function(){return this._focus?this.nativeInput.value:this._content||""},function(e){i.superSet(ge,this,"color",this._originColor),e+="",this._focus?(this.nativeInput.value=e||"",this.event("change")):(this._multiline||(e=e.replace(/\r?\n/g,"")),this._content=e,e?i.superSet(ge,this,"text",e):(i.superSet(ge,this,"text",this._prompt),i.superSet(ge,this,"color",this.promptColor)))}),r(0,o,"nativeInput",function(){return this._multiline?t.area:t.input}),r(0,o,"prompt",function(){return this._prompt},function(e){!this._text&&e&&i.superSet(ge,this,"color",this._promptColor),this.promptColor=this._promptColor,this._text?i.superSet(ge,this,"text",this._text==this._prompt?e:this._text):i.superSet(ge,this,"text",e),this._prompt=ge.langPacks&&ge.langPacks[e]?ge.langPacks[e]:e}),r(0,o,"focus",function(){return this._focus},function(e){var i=this.nativeInput;this._focus!==e&&(e?(i.target?i.target._focusOut():this._setInputMethod(),i.target=this,this._focusIn()):(i.target=null,this._focusOut(),O.document.body.scrollTop=0,i.blur(),N.isConchApp?i.setPos(-1e4,-1e4):t.inputContainer.contains(i)&&t.inputContainer.removeChild(i)))}),r(0,o,"restrict",function(){return this._restrictPattern?this._restrictPattern.source:""},function(e){e?((e="[^"+e+"]").indexOf("^^")>-1&&(e=e.replace("^^","")),this._restrictPattern=new RegExp(e,"g")):this._restrictPattern=null}),r(0,o,"editable",function(){return this._editable},function(e){this._editable=e,N.isConchApp&&t.input.setForbidEdit(!e)}),r(0,o,"promptColor",function(){return this._promptColor},function(e){this._promptColor=e,this._content||i.superSet(ge,this,"color",e)}),r(0,o,"type",function(){return this._type},function(e){this._getCSSStyle().password="password"==e,this._type=e,N.isConchApp&&this.nativeInput.setType(e)}),r(0,o,"inputElementXAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。"),0},function(e){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。")}),r(0,o,"asPassword",function(){return this._getCSSStyle().password},function(e){this._getCSSStyle().password=e,this._type="password",console.warn('deprecated: 使用type="password"替代设置asPassword, asPassword将在下次重大更新时删去'),this.isChanged=!0}),t.__init__=function(){t._createInputElement(),O.onMobile&&N.canvas.addEventListener(t.IOS_IFRAME?O.onMiniGame?"touchend":"click":"touchend",t._popupInputMethod)},t._popupInputMethod=function(e){if(laya.display.Input.isInputting){laya.display.Input.inputElement.focus()}},t._createInputElement=function(){t._initInput(t.area=O.createElement("textarea")),t._initInput(t.input=O.createElement("input")),(t.inputContainer=O.createElement("div")).style.position="absolute",t.inputContainer.style.zIndex=1e5,O.container.appendChild(t.inputContainer),t.inputContainer.setPos=function(e,i){t.inputContainer.style.left=e+"px",t.inputContainer.style.top=i+"px"}},t._initInput=function(e){var i=e.style;i.cssText="position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;",i.resize="none",i.backgroundColor="transparent",i.border="none",i.outline="none",i.zIndex=1,e.addEventListener("input",t._processInputting),e.addEventListener("mousemove",t._stopEvent),e.addEventListener("mousedown",t._stopEvent),e.addEventListener("touchmove",t._stopEvent),e.setFontFace=function(t){e.style.fontFamily=t},N.isConchApp||(e.setColor=function(t){e.style.color=t},e.setFontSize=function(t){e.style.fontSize=t+"px"})},t._processInputting=function(e){var t=laya.display.Input.inputElement.target;if(t){var i=laya.display.Input.inputElement.value;t._restrictPattern&&(i=i.replace(/\u2006|\x27/g,""),t._restrictPattern.test(i)&&(i=i.replace(t._restrictPattern,""),laya.display.Input.inputElement.value=i)),t._text=i,t.event("input")}},t._stopEvent=function(e){"touchmove"==e.type&&e.preventDefault(),e.stopPropagation&&e.stopPropagation()},t.TYPE_TEXT="text",t.TYPE_PASSWORD="password",t.TYPE_EMAIL="email",t.TYPE_URL="url",t.TYPE_NUMBER="number",t.TYPE_RANGE="range",t.TYPE_DATE="date",t.TYPE_MONTH="month",t.TYPE_WEEK="week",t.TYPE_TIME="time",t.TYPE_DATE_TIME="datetime",t.TYPE_DATE_TIME_LOCAL="datetime-local",t.TYPE_SEARCH="search",t.input=null,t.area=null,t.inputElement=null,t.inputContainer=null,t.confirmButton=null,t.promptStyleDOM=null,t.inputHeight=45,t.isInputting=!1,t.stageMatrix=null,n(t,["IOS_IFRAME",function(){return this.IOS_IFRAME=O.onIOS&&O.window.top!=O.window.self}]),t}(ge),Se=function(e){function t(e,i){this._recreateLock=!1,this._needReleaseAgain=!1,this._enableMerageInAtlas=!0,t.__super.call(this),this._init_(e,i)}a(t,"laya.resource.HTMLImage",ve);var i=t.prototype;return i._init_=function(e,t){this._src=e,this._source=new O.window.Image,t&&(t.onload&&(this.onload=t.onload),t.onerror&&(this.onerror=t.onerror),t.onCreate&&t.onCreate(this)),0!=e.indexOf("data:image")&&(this._source.crossOrigin=""),e&&(this._source.src=e)},i.recreateResource=function(){var e=this;if(""===this._src)throw new Error("src no null！");if(this._needReleaseAgain=!1,this._source){if(this._recreateLock)return;this.memorySize=this._w*this._h*4,this._recreateLock=!1,this.completeCreate()}else{this._recreateLock=!0;var t=this;this._source=new O.window.Image,this._source.crossOrigin="",this._source.onload=function(){if(t._needReleaseAgain)return t._needReleaseAgain=!1,t._source.onload=null,void(t._source=null);t._source.onload=null,t.memorySize=e._w*e._h*4,t._recreateLock=!1,t.completeCreate()},this._source.src=this._src}},i.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(this._source=null,this.memorySize=0)},i.onresize=function(){this._w=this._source.width,this._h=this._source.height},r(0,i,"onload",null,function(e){var t=this;this._onload=e,this._source&&(this._source.onload=null!=this._onload?function(){t.onresize(),t._onload()}:null)}),r(0,i,"onerror",null,function(e){var t=this;this._onerror=e,this._source&&(this._source.onerror=null!=this._onerror?function(){t._onerror()}:null)}),r(0,i,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(e){this._enableMerageInAtlas=e,N.isConchApp&&this._source&&(this._source.enableMerageInAtlas=e)}),t.create=function(e,i){return new t(e,i)},t}(),Ie=(function(e){function t(){this._target=null,this._playEvents=null,this._initData={},this._aniKeys=null,this._effectClass=null,t.__super.call(this)}a(t,"laya.display.EffectAnimation",e);var i=t.prototype;i._onOtherBegin=function(e){e!=this&&this.stop()},i.addEvent=function(){this._target&&this._playEvents&&(this._setControlNode(this._target),this._target.on(this._playEvents,this,this._onPlayAction))},i._onPlayAction=function(){this.play(0,!1)},i.play=function(e,t,i,n){void 0===e&&(e=0),void 0===t&&(t=!0),void 0===i&&(i=""),void 0===n&&(n=!0),this._target&&(this._target.event("effectanimationbegin",[this]),this._recordInitData(),laya.display.AnimationPlayerBase.prototype.play.call(this,e,t,i,n))},i._recordInitData=function(){if(this._aniKeys){var e=0,t=0;t=this._aniKeys.length;var i;for(e=0;e<t;e++)i=this._aniKeys[e],this._initData[i]=this._target[i]}},i._displayToIndex=function(e){if(this._animationData){e<0&&(e=0),e>this._count&&(e=this._count);var t=this._animationData.nodes,i=0,n=t.length;for(n=n>1?1:n,i=0;i<n;i++)this._displayNodeToFrame(t[i],e)}},i._displayNodeToFrame=function(e,t,i){if(this._target){var n;n=this._target;var a,r,o,s,h=e.frames,l=e.keys,c=0,p=l.length;s=e.secondFrames;var u,d,_,m,f=0;for(c=0;c<p;c++)r=h[a=l[c]],-1==(f=s[a])?o=this._initData[a]:t<f?(_=(d=e.keyframes[a])[0]).tween?(null==(u=X[_.tweenMethod])&&(u=X.linearNone),m=d[1],o=u(t,this._initData[a],m.value-this._initData[a],m.index)):o=this._initData[a]:o=r.length>t?r[t]:r[r.length-1],n[a]=o}},i._calculateNodeKeyFrames=function(t){e.prototype._calculateNodeKeyFrames.call(this,t);var i,n,a,r=t.keyframes;t.target;a={},t.secondFrames=a;for(i in r)(n=r[i]).length<=1?a[i]=-1:a[i]=n[1].index},r(0,i,"target",function(){return this._target},function(e){this._target&&this._target.off("effectanimationbegin",this,this._onOtherBegin),this._target=e,this._target&&this._target.on("effectanimationbegin",this,this._onOtherBegin),this.addEvent()}),r(0,i,"playEvent",null,function(e){this._playEvents=e,e&&this.addEvent()}),r(0,i,"effectData",null,function(e){if(e){var t;(t=e.animations)&&t[0]&&(this._setUp({},t[0]),t[0].nodes&&t[0].nodes[0]&&(this._aniKeys=t[0].nodes[0].keys))}}),r(0,i,"effectClass",null,function(e){if(this._effectClass=F.getClass(e),this._effectClass){var t;if(t=this._effectClass.uiView){var i;(i=t.animations)&&i[0]&&(this._setUp({},i[0]),i[0].nodes&&i[0].nodes[0]&&(this._aniKeys=i[0].nodes[0].keys))}}}),t.EffectAnimationBegin="effectanimationbegin"}(be),function(e){function t(){this.animationList=null,this.animationDic=null,this._nodeList=null,this._nodeDefaultProps=null,this._gList=null,this._nodeIDAniDic={},this._rootNode=null,this._nodeGDic=null,t.__super.call(this)}var i;a(t,"laya.utils.GraphicAnimation",e);var r=t.prototype;return r._parseNodeList=function(e){this._nodeList||(this._nodeList=[]),this._nodeDefaultProps[e.compId]=e.props,e.compId&&this._nodeList.push(e.compId);var t=e.child;if(t){var i=0,n=t.length;for(i=0;i<n;i++)this._parseNodeList(t[i])}},r._calGraphicData=function(e){if(this._setUp(null,e),this._createGraphicData(),this._nodeIDAniDic){var t;for(t in this._nodeIDAniDic)this._nodeIDAniDic[t]=null}},r._createGraphicData=function(){var e=[],t=0,i=this.count,n=this._animationNewFrames;n||(n=[]);var a;for(t=0;t<i;t++)!n[t]&&a||(a=this._createFrameGraphic(t)),e.push(a);this._gList=e},r._createFrameGraphic=function(e){var i=o.createGraphics();return t._rootMatrix||(t._rootMatrix=new M),this._updateNodeGraphic(this._rootNode,e,t._rootMatrix,i),i},r._updateNodeGraphic=function(e,t,i,n,a){void 0===a&&(a=1);var r,o=(r=this._nodeGDic[e.compId]=this._getNodeGraphicData(e.compId,t,this._nodeGDic[e.compId])).alpha*a;if(!(o<.01)){r.resultTransform||(r.resultTransform=M.create());var s;s=r.resultTransform,M.mul(r.transform,i,s);var h;r.skin&&(h=this._getTextureByUrl(r.skin))&&(s._checkTransform()?(n.drawTexture(h,0,0,r.width,r.height,s,o),r.resultTransform=null):n.drawTexture(h,s.tx,s.ty,r.width,r.height,null,o));var l;if(l=e.child){var c=0,p=0;for(p=l.length,c=0;c<p;c++)this._updateNodeGraphic(l[c],t,s,n,o)}}},r._updateNoChilds=function(e,t){if(e.skin){var i=this._getTextureByUrl(e.skin);if(i){var n=e.transform;n._checkTransform();!n.bTransform?t.drawTexture(i,n.tx,n.ty,e.width,e.height,null,e.alpha):t.drawTexture(i,0,0,e.width,e.height,n.clone(),e.alpha)}}},r._updateNodeGraphic2=function(e,t,i){var n;if(n=this._nodeGDic[e.compId]=this._getNodeGraphicData(e.compId,t,this._nodeGDic[e.compId]),e.child){var a=n.transform;a._checkTransform();var r=!1,o=!1;o=(r=!a.bTransform)&&(0!=a.tx||0!=a.ty);var s=!1;(s=a.bTransform||1!=n.alpha)&&i.save(),1!=n.alpha&&i.alpha(n.alpha),r?o&&i.translate(a.tx,a.ty):i.transform(a.clone());var h;h=e.child;var l;if(n.skin&&(l=this._getTextureByUrl(n.skin))&&i.drawTexture(l,0,0,n.width,n.height),h){var c=0,p=0;for(p=h.length,c=0;c<p;c++)this._updateNodeGraphic2(h[c],t,i)}s?i.restore():r?o&&i.translate(-a.tx,-a.ty):i.transform(a.clone().invert())}else this._updateNoChilds(n,i)},r._calculateNodeKeyFrames=function(t){e.prototype._calculateNodeKeyFrames.call(this,t),this._nodeIDAniDic[t.target]=t},r.getNodeDataByID=function(e){return this._nodeIDAniDic[e]},r._getParams=function(e,i,n,a){var r=t._temParam;r.length=i.length;var o=0,s=i.length;for(o=0;o<s;o++)r[o]=this._getObjVar(e,i[o][0],n,i[o][1],a);return r},r._getObjVar=function(e,t,i,n,a){if(e.hasOwnProperty(t)){var r=e[t];return i>=r.length&&(i=r.length-1),e[t][i]}return a.hasOwnProperty(t)?a[t]:n},r._getNodeGraphicData=function(e,n,a){a||(a=i.create()),a.transform?a.transform.identity():a.transform=M.create();var r=this.getNodeDataByID(e);if(!r)return a;var o=r.frames,s=this._getParams(o,t._drawTextureCmd,n,this._nodeDefaultProps[e]),h=s[0],l=NaN,c=NaN,p=s[5],u=s[6],d=s[13],_=s[14],m=s[7],f=s[8],g=s[9],y=s[11],v=s[12];l=s[3],c=s[4],0!=l&&0!=c||(h=null),-1==l&&(l=0),-1==c&&(c=0);var x;a.skin=h,a.width=l,a.height=c,h&&((x=this._getTextureByUrl(h))?(l||(l=x.sourceWidth),c||(c=x.sourceHeight)):console.warn("lost skin:",h,",you may load pics first")),a.alpha=s[10];var b;b=a.transform,0!=d&&(p=d*l),0!=_&&(u=_*c),0==p&&0==u||b.translate(-p,-u);var w=null;if(g||1!==m||1!==f||y||v){(w=t._tempMt).identity(),w.bTransform=!0;var S=.0174532922222222*(g-y),I=.0174532922222222*(g+v),C=Math.cos(I),k=Math.sin(I),E=Math.sin(S),T=Math.cos(S);w.a=m*C,w.b=m*k,w.c=-f*E,w.d=f*T,w.tx=w.ty=0}return w&&(b=M.mul(b,w,b)),b.translate(s[1],s[2]),a},r._getTextureByUrl=function(e){return oe.getRes(e)},r.setAniData=function(e,i){if(e.animations){this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=e,this._parseNodeList(e);var n,a={},r=[],o=e.animations,s=0,h=o.length;for(s=0;s<h;s++)if(n=o[s],this._labels=null,(!i||i==n.name)&&n){try{this._calGraphicData(n)}catch(e){console.warn("parse animation fail:"+n.name+",empty animation created"),this._gList=[]}var l={};l.interval=1e3/n.frameRate,l.frames=this._gList,l.labels=this._labels,l.name=n.name,r.push(l),a[n.name]=l}this.animationList=r,this.animationDic=a}t._temParam.length=0},r.parseByData=function(e){var t,i;t=e.nodeRoot,i=e.aniO,delete e.nodeRoot,delete e.aniO,this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=t,this._parseNodeList(t),this._labels=null;try{this._calGraphicData(i)}catch(e){console.warn("parse animation fail:"+i.name+",empty animation created"),this._gList=[]}var n=e;return n.interval=1e3/i.frameRate,n.frames=this._gList,n.labels=this._labels,n.name=i.name,n},r.setUpAniData=function(e){if(e.animations){var t,i={},n=[],a=e.animations,r=0,o=a.length;for(r=0;r<o;r++)if(t=a[r]){var s={};s.name=t.name,s.aniO=t,s.nodeRoot=e,n.push(s),i[t.name]=s}this.animationList=n,this.animationDic=i}},r._clear=function(){if(this.animationList=null,this.animationDic=null,this._gList=null,this._nodeGDic){var e,t;for(e in this._nodeGDic)(t=this._nodeGDic[e])&&t.recover()}this._nodeGDic=null},t.parseAnimationByData=function(e){t._I||(t._I=new t);var i;return i=t._I.parseByData(e),t._I._clear(),i},t.parseAnimationData=function(e){t._I||(t._I=new t),t._I.setUpAniData(e);var i;return i={},i.animationList=t._I.animationList,i.animationDic=t._I.animationDic,t._I._clear(),i},t._drawTextureCmd=[["skin",null],["x",0],["y",0],["width",-1],["height",-1],["pivotX",0],["pivotY",0],["scaleX",1],["scaleY",1],["rotation",0],["alpha",1],["skewX",0],["skewY",0],["anchorX",0],["anchorY",0]],t._temParam=[],t._I=null,t._rootMatrix=null,n(t,["_tempMt",function(){return this._tempMt=new M}]),t.__init$=function(){i=function(){function e(){this.skin=null,this.transform=null,this.resultTransform=null,this.width=NaN,this.height=NaN,this.alpha=1}a(e,"");return e.prototype.recover=function(){this.skin=null,this.width=0,this.height=0,this.alpha=1,this.transform&&(this.transform.destroy(),this.transform=null),this.resultTransform&&(this.resultTransform.destroy(),this.resultTransform=null),G.recover("GraphicNode",this)},e.create=function(){return G.getItemByClass("GraphicNode",e)},e}()},t}(be));i.__init([h,se,N,O,W,T,pe,Ie])}(window,document,Laya),function(e,t,i){i.un,i.uns,i.static;var n=i.class;i.getset,i.__newvec;new(function(){function e(){}return n(e,"LayaMain"),e}())}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});for(var i in Laya){var n=Laya[i];n&&n.__isclass&&(t[i]=n)}}),function(e,t,i){i.un,i.uns;var n=i.static,a=i.class,r=i.getset,o=(i.__newvec,laya.utils.Browser),s=(laya.events.Event,laya.events.EventDispatcher),h=laya.resource.HTMLImage,l=laya.utils.Handler,c=laya.display.Input,p=laya.net.Loader,u=laya.net.LocalStorage,d=(laya.maths.Matrix,laya.renders.Render),_=laya.utils.RunDriver,m=laya.media.SoundChannel,f=laya.media.SoundManager,g=laya.net.URL,y=laya.utils.Utils,v=function(){function t(){}return a(t,"laya.wx.mini.MiniAdpter"),t.getJson=function(e){return JSON.parse(e)},t.init=function(n,a){if(void 0===n&&(n=!1),void 0===a&&(a=!1),!(t._inited||(t._inited=!0,(t.window=e).navigator.userAgent.indexOf("MiniGame")<0))){t.isZiYu=a,t.isPosMsgYu=n,t.EnvConfig={};try{laya.webgl.resource.WebGLCanvas.premulAlpha=!0}catch(e){}t.isZiYu||(x.setNativeFileDir("/layaairGame"),x.existDir(x.fileNativeDir,l.create(t,t.onMkdirCallBack))),t.systemInfo=wx.getSystemInfoSync(),t.window.focus=function(){},i.getUrlPath=function(){},t.window.logtime=function(e){},t.window.alertTimeLog=function(e){},t.window.resetShareInfo=function(){},t.window.CanvasRenderingContext2D=function(){},t.window.CanvasRenderingContext2D.prototype=t.window.wx.createCanvas().getContext("2d").__proto__,t.window.document.body.appendChild=function(){},t.EnvConfig.pixelRatioInt=0,_.getPixelRatio=t.pixelRatio,t._preCreateElement=o.createElement,o.createElement=t.createElement,_.createShaderCondition=t.createShaderCondition,y.parseXMLFromString=t.parseXMLFromString,c._createInputElement=w._createInputElement,t.EnvConfig.load=p.prototype.load,p.prototype.load=I.prototype.load,p.prototype._loadImage=b.prototype._loadImage,S.__init__(),u._baseClass=S}},t.getUrlEncode=function(e,t){return-1!=e.indexOf(".fnt")?"utf8":"arraybuffer"==t?"":"ascii"},t.downLoadFile=function(e,t,i,n){void 0===t&&(t=""),void 0===n&&(n="ascii");x.getFileInfo(e)?null!=i&&i.runWith([0]):x.downLoadFile(e,t,i,n)},t.remove=function(e,t){x.deleteFile("",e,t,"",0)},t.removeAll=function(){x.deleteAll()},t.hasNativeFile=function(e){return x.isLocalNativeFile(e)},t.getFileInfo=function(e){return x.getFileInfo(e)},t.getFileList=function(){return x.filesListObj},t.exitMiniProgram=function(){t.window.wx.exitMiniProgram()},t.onMkdirCallBack=function(e,t){e||(x.filesListObj=JSON.parse(t.data))},t.pixelRatio=function(){if(!t.EnvConfig.pixelRatioInt)try{return t.EnvConfig.pixelRatioInt=t.systemInfo.pixelRatio,t.systemInfo.pixelRatio}catch(e){}return t.EnvConfig.pixelRatioInt},t.createElement=function(i){if("canvas"==i){var n;return 1==t.idx?t.isZiYu?(n=sharedCanvas).style={}:n=e.canvas:n=e.wx.createCanvas(),t.idx++,n}if("textarea"==i||"input"==i)return t.onCreateInput(i);if("div"==i){var a=t._preCreateElement(i);return a.contains=function(e){return null},a.removeChild=function(e){},a}return t._preCreateElement(i)},t.onCreateInput=function(e){var i=t._preCreateElement(e);return i.focus=w.wxinputFocus,i.blur=w.wxinputblur,i.style={},i.value=0,i.parentElement={},i.placeholder={},i.type={},i.setColor=function(e){},i.setType=function(e){},i.setFontFace=function(e){},i.addEventListener=function(e){},i.contains=function(e){return null},i.removeChild=function(e){},i},t.createShaderCondition=function(e){var t=this;return function(){return t[e.replace("this.","")]}},t.EnvConfig=null,t.window=null,t._preCreateElement=null,t._inited=!1,t.systemInfo=null,t.isZiYu=!1,t.isPosMsgYu=!1,t.autoCacheFile=!0,t.minClearSize=5242880,t.parseXMLFromString=function(t){var i;t=t.replace(/>\s+</g,"><");try{i=(new e.Parser.DOMParser).parseFromString(t,"text/xml")}catch(e){throw"需要引入xml解析库文件"}return i},t.idx=1,n(t,["nativefiles",function(){return this.nativefiles=["layaNativeDir","wxlocal"]}]),t}(),x=function(){function e(){}return a(e,"laya.wx.mini.MiniFileMgr"),e.isLocalNativeFile=function(e){for(var t=0,i=v.nativefiles.length;t<i;t++)if(-1!=e.indexOf(v.nativefiles[t]))return!0;return!1},e.getFileInfo=function(t){var i=t.split("?")[0],n=e.filesListObj[i];return null==n?null:n},e.read=function(t,i,n,a,r,o){void 0===i&&(i="ascill"),void 0===a&&(a=""),void 0===r&&(r=!1),void 0===o&&(o="");var s;s=""==a||-1==a.indexOf("http://")&&-1==a.indexOf("https://")?t:e.getFileNativePath(t),e.fs.readFile({filePath:s,encoding:i,success:function(e){null!=n&&n.runWith([0,e])},fail:function(t){t&&""!=a?e.downFiles(a,i,n,a,r,o):null!=n&&n.runWith([1])}})},e.downFiles=function(t,i,n,a,r,o){void 0===i&&(i="ascii"),void 0===a&&(a=""),void 0===r&&(r=!1),void 0===o&&(o="");e.wxdown({url:t,success:function(t){200===t.statusCode&&e.readFile(t.tempFilePath,i,n,a,r,o)},fail:function(e){null!=n&&n.runWith([1,e])}}).onProgressUpdate(function(e){null!=n&&n.runWith([2,e.progress])})},e.readFile=function(t,i,n,a,r,o){void 0===i&&(i="ascill"),void 0===a&&(a=""),void 0===r&&(r=!1),void 0===o&&(o=""),e.fs.readFile({filePath:t,encoding:i,success:function(o){-1!=t.indexOf("http://")||-1!=t.indexOf("https://")?(v.autoCacheFile||r)&&e.copyFile(t,a,n,i):null!=n&&n.runWith([0,o])},fail:function(e){e&&null!=n&&n.runWith([1,e])}})},e.downOtherFiles=function(t,i,n,a){void 0===n&&(n=""),void 0===a&&(a=!1),e.wxdown({url:t,success:function(t){200===t.statusCode&&((v.autoCacheFile||a)&&-1==n.indexOf("wx.qlogo.cn")?e.copyFile(t.tempFilePath,n,i):null!=i&&i.runWith([0,t.tempFilePath]))},fail:function(e){null!=i&&i.runWith([1,e])}})},e.downLoadFile=function(t,i,n,a){void 0===i&&(i=""),void 0===a&&(a="ascii"),"image"==i||"sound"==i?e.downOtherFiles(t,n,t,!0):e.downFiles(t,a,n,t,!0,i)},e.copyFile=function(t,i,n,a){void 0===a&&(a="");var r=t.split("/"),o=r[r.length-1],s=(i.split("?")[0],e.getFileInfo(i)),h=e.getFileNativePath(o),l=e.getCacheUseSize();s?s.readyUrl!=i?e.fs.getFileInfo({filePath:t,success:function(t){l+4194304+t.size>=52428800&&(t.size>v.minClearSize&&(v.minClearSize=t.size),e.onClearCacheRes()),e.deleteFile(o,i,n,a,t.size)},fail:function(e){null!=n&&n.runWith([1,e])}}):null!=n&&n.runWith([0]):e.fs.getFileInfo({filePath:t,success:function(r){l+4194304+r.size>=52428800&&(r.size>v.minClearSize&&(v.minClearSize=r.size),e.onClearCacheRes()),e.fs.copyFile({srcPath:t,destPath:h,success:function(t){e.onSaveFile(i,o,!0,a,n,r.size)},fail:function(e){null!=n&&n.runWith([1,e])}})},fail:function(e){null!=n&&n.runWith([1,e])}})},e.onClearCacheRes=function(){var t=v.minClearSize,i=[];for(var n in e.filesListObj)i.push(e.filesListObj[n]);e.sortOn(i,"time",16);for(var a=0,r=1,o=i.length;r<o;r++){var s=i[r];if(a>=t)break;a+=s.size,e.deleteFile("",s.readyUrl)}},e.sortOn=function(e,t,i){return void 0===i&&(i=0),16==i?e.sort(function(e,i){return e[t]-i[t]}):18==i?e.sort(function(e,i){return i[t]-e[t]}):e.sort(function(e,i){return e[t]-i[t]})},e.getFileNativePath=function(e){return laya.wx.mini.MiniFileMgr.fileNativeDir+"/"+e},e.deleteFile=function(t,i,n,a,r){void 0===i&&(i=""),void 0===a&&(a=""),void 0===r&&(r=0);var o=e.getFileInfo(i),s=e.getFileNativePath(o.md5);e.fs.unlink({filePath:s,success:function(o){var s=""!=t;if(""!=t){var h=e.getFileNativePath(t);e.fs.copyFile({srcPath:t,destPath:h,success:function(r){e.onSaveFile(i,t,s,a,n,r.size)},fail:function(e){null!=n&&n.runWith([1,e])}})}else e.onSaveFile(i,t,s,a,n,r)},fail:function(e){}})},e.deleteAll=function(){var t=[];for(var i in e.filesListObj)t.push(e.filesListObj[i]);for(var n=1,a=t.length;n<a;n++){var r=t[n];e.deleteFile("",r.readyUrl)}},e.onSaveFile=function(t,i,n,a,r,s){void 0===n&&(n=!0),void 0===a&&(a=""),void 0===s&&(s=0);var h=t.split("?")[0];if(null==e.filesListObj.fileUsedSize&&(e.filesListObj.fileUsedSize=0),n){e.getFileNativePath(i);e.filesListObj[h]={md5:i,readyUrl:t,size:s,times:o.now(),encoding:a},e.filesListObj.fileUsedSize=parseInt(e.filesListObj.fileUsedSize)+s,e.writeFilesList(h,JSON.stringify(e.filesListObj),!0),null!=r&&r.runWith([0])}else if(e.filesListObj[h]){var l=parseInt(e.filesListObj[h].size);e.filesListObj.fileUsedSize=parseInt(e.filesListObj.fileUsedSize)-l,delete e.filesListObj[h],e.writeFilesList(h,JSON.stringify(e.filesListObj),!1),null!=r&&r.runWith([0])}},e.writeFilesList=function(t,i,n){var a=e.fileNativeDir+"/"+e.fileListName;e.fs.writeFile({filePath:a,encoding:"utf8",data:i,success:function(e){},fail:function(e){}}),!v.isZiYu&&v.isPosMsgYu&&wx.postMessage({url:t,data:e.filesListObj[t],isLoad:"filenative",isAdd:n})},e.getCacheUseSize=function(){return e.filesListObj&&e.filesListObj.fileUsedSize?e.filesListObj.fileUsedSize:0},e.existDir=function(t,i){e.fs.mkdir({dirPath:t,success:function(e){null!=i&&i.runWith([0,{data:JSON.stringify({})}])},fail:function(t){-1!=t.errMsg.indexOf("file already exists")?e.readSync(e.fileListName,"utf8",i):null!=i&&i.runWith([1,t])}})},e.readSync=function(t,i,n,a){void 0===i&&(i="ascill"),void 0===a&&(a="");var r,o=e.getFileNativePath(t);try{r=e.fs.readFileSync(o,i),null!=n&&n.runWith([0,{data:r}])}catch(e){null!=n&&n.runWith([1])}},e.setNativeFileDir=function(t){e.fileNativeDir=wx.env.USER_DATA_PATH+t},e.filesListObj={},e.fileNativeDir=null,e.fileListName="layaairfiles.txt",e.ziyuFileData={},e.loadPath="",e.DESCENDING=2,e.NUMERIC=16,n(e,["fs",function(){return this.fs=wx.getFileSystemManager()},"wxdown",function(){return this.wxdown=wx.downloadFile}]),e}(),b=function(){function e(){}a(e,"laya.wx.mini.MiniImage");return e.prototype._loadImage=function(t){if(v.isZiYu)e.onCreateImage(t,this,!0);else{var i=!1;if(x.isLocalNativeFile(t)){if(-1!=t.indexOf("http://")||-1!=t.indexOf("https://"))if(""!=x.loadPath)t=t.split(x.loadPath)[1];else{var n=""!=g.rootPath?g.rootPath:g.basePath;""!=n&&(t=t.split(n)[1])}}else i=!0,t=g.formatURL(t);x.getFileInfo(t)?e.onCreateImage(t,this,!i):-1!=t.indexOf("http://")||-1!=t.indexOf("https://")?v.isZiYu?e.onCreateImage(t,this,!0):x.downOtherFiles(t,new l(e,e.onDownImgCallBack,[t,this]),t):e.onCreateImage(t,this,!0)}},e.onDownImgCallBack=function(t,i,n,a){void 0===a&&(a=""),n?i.onError(null):e.onCreateImage(t,i,!1,a)},e.onCreateImage=function(e,t,i,n){function a(){l.onload=null,l.onerror=null,delete t.imgCache[e]}void 0===i&&(i=!1),void 0===n&&(n="");var r;if(v.autoCacheFile)if(i)r=e;else if(""!=n)r=n;else{var s=x.getFileInfo(e).md5;r=x.getFileNativePath(s)}else r=i?e:n;null==t.imgCache&&(t.imgCache={});var l,c=function(){a(),t._url=g.formatURL(t._url),t.onLoaded(l)},p=function(){a(),t.event("error","Load image failed")};"nativeimage"==t._type?((l=new o.window.Image).crossOrigin="",l.onload=c,l.onerror=p,l.src=r,t.imgCache[e]=l):new h.create(r,{onload:c,onerror:p,onCreate:function(i){l=i,t.imgCache[e]=i}})},e}(),w=function(){function t(){}return a(t,"laya.wx.mini.MiniInput"),t._createInputElement=function(){c._initInput(c.area=o.createElement("textarea")),c._initInput(c.input=o.createElement("input")),c.inputContainer=o.createElement("div"),c.inputContainer.style.position="absolute",c.inputContainer.style.zIndex=1e5,o.container.appendChild(c.inputContainer),c.inputContainer.setPos=function(e,t){c.inputContainer.style.left=e+"px",c.inputContainer.style.top=t+"px"},i.stage.on("resize",null,t._onStageResize),wx.onWindowResize&&wx.onWindowResize(function(t){e.dispatchEvent&&e.dispatchEvent("resize")}),f._soundClass=M,f._musicClass=M;var n=v.systemInfo.model,a=v.systemInfo.system;-1!=n.indexOf("iPhone")&&(o.onIPhone=!0,o.onIOS=!0,o.onIPad=!0,o.onAndroid=!1),-1==a.indexOf("Android")&&-1==a.indexOf("Adr")||(o.onAndroid=!0,o.onIPhone=!1,o.onIOS=!1,o.onIPad=!1)},t._onStageResize=function(){i.stage._canvasTransform.identity().scale(o.width/d.canvas.width/_.getPixelRatio(),o.height/d.canvas.height/_.getPixelRatio())},t.wxinputFocus=function(e){var t=c.inputElement.target;t&&!t.editable||(v.window.wx.offKeyboardConfirm(),v.window.wx.offKeyboardInput(),v.window.wx.showKeyboard({defaultValue:t.text,maxLength:t.maxChars,multiple:t.multiline,confirmHold:!0,confirmType:"done",success:function(e){},fail:function(e){}}),v.window.wx.onKeyboardConfirm(function(e){var i=e?e.value:"";t.text=i,t.event("input"),laya.wx.mini.MiniInput.inputEnter()}),v.window.wx.onKeyboardInput(function(e){var i=e?e.value:"";t.multiline||-1==i.indexOf("\n")?(t.text=i,t.event("input")):laya.wx.mini.MiniInput.inputEnter()}))},t.inputEnter=function(){c.inputElement.target.focus=!1},t.wxinputblur=function(){t.hideKeyboard()},t.hideKeyboard=function(){v.window.wx.offKeyboardConfirm(),v.window.wx.offKeyboardInput(),v.window.wx.hideKeyboard({success:function(e){console.log("隐藏键盘")},fail:function(e){console.log("隐藏键盘出错:"+(e?e.errMsg:""))}})},t}(),S=function(){function e(){}return a(e,"laya.wx.mini.MiniLocalStorage"),e.__init__=function(){e.items=e},e.setItem=function(e,t){wx.setStorageSync(e,t)},e.getItem=function(e){return wx.getStorageSync(e)},e.setJSON=function(t,i){e.setItem(t,i)},e.getJSON=function(t){return e.getItem(t)},e.removeItem=function(e){wx.removeStorageSync(e)},e.clear=function(){wx.clearStorageSync()},e.getStorageInfoSync=function(){try{var e=wx.getStorageInfoSync();return console.log(e.keys),console.log(e.currentSize),console.log(e.limitSize),e}catch(e){}return null},e.support=!0,e.items=null,e}(),I=(function(){function e(){}a(e,"laya.wx.mini.MiniLocation"),e.__init__=function(){v.window.navigator.geolocation.getCurrentPosition=e.getCurrentPosition,v.window.navigator.geolocation.watchPosition=e.watchPosition,v.window.navigator.geolocation.clearWatch=e.clearWatch},e.getCurrentPosition=function(e,t,i){var n;(n={}).success=function(t){null!=e&&e(t)},n.fail=t,v.window.wx.getLocation(n)},e.watchPosition=function(t,n,a){e._curID++;var r;return r={},r.success=t,r.error=n,e._watchDic[e._curID]=r,i.timer.loop(1e3,null,e._myLoop),e._curID},e.clearWatch=function(t){delete e._watchDic[t],e._hasWatch()||i.timer.clear(null,e._myLoop)},e._hasWatch=function(){var t;for(t in e._watchDic)if(e._watchDic[t])return!0;return!1},e._myLoop=function(){e.getCurrentPosition(e._mySuccess,e._myError)},e._mySuccess=function(t){var i={};i.coords=t,i.timestamp=o.now();var n;for(n in e._watchDic)e._watchDic[n].success&&e._watchDic[n].success(i)},e._myError=function(t){var i;for(i in e._watchDic)e._watchDic[i].error&&e._watchDic[i].error(t)},e._watchDic={},e._curID=0}(),function(e){function t(){t.__super.call(this)}a(t,"laya.wx.mini.MiniAccelerator",e);var i=t.prototype;i.on=function(i,n,a,r){return e.prototype.on.call(this,i,n,a,r),t.startListen(this.onDeviceOrientationChange),this},i.off=function(i,n,a,r){return void 0===r&&(r=!1),this.hasListener(i)||t.stopListen(),e.prototype.off.call(this,i,n,a,r)},t.__init__=function(){try{var e;if(!(e=laya.device.motion.Accelerator))return;e.prototype.on=t.prototype.on,e.prototype.off=t.prototype.off}catch(e){}},t.startListen=function(e){if(t._callBack=e,!t._isListening){t._isListening=!0;try{wx.onAccelerometerChange(t.onAccelerometerChange)}catch(e){}}},t.stopListen=function(){t._isListening=!1;try{wx.stopAccelerometer({})}catch(e){}},t.onAccelerometerChange=function(e){var i;(i={}).acceleration=e,i.accelerationIncludingGravity=e,i.rotationRate={},null!=t._callBack&&t._callBack(i)},t._isListening=!1,t._callBack=null}(s),function(e){function t(){t.__super.call(this)}a(t,"laya.wx.mini.MiniLoader",s);return t.prototype.load=function(e,i,n,a,r){void 0===n&&(n=!0),void 0===r&&(r=!1);if(this._url=e,0===e.indexOf("data:image")?this._type=i="image":this._type=i||(i=this.getTypeFromUrl(e)),this._cache=n,this._data=null,!r&&p.loadedMap[g.formatURL(e)])return this._data=p.loadedMap[g.formatURL(e)],this.event("progress",1),void this.event("complete",this._data);if(null!=p.parserMap[i])return this._customParse=!0,void(p.parserMap[i]instanceof laya.utils.Handler?p.parserMap[i].runWith(this):p.parserMap[i].call(null,this));var o=v.getUrlEncode(e,i),s=y.getFileExtension(e);if(-1!=t._fileTypeArr.indexOf(s))v.EnvConfig.load.call(this,e,i,n,a,r);else{if(v.isZiYu&&x.ziyuFileData[e]){var h=x.ziyuFileData[e];return void this.onLoaded(h)}if(x.getFileInfo(e)){var c=x.getFileInfo(e);c.encoding=null==c.encoding?"ascii":c.encoding,x.readFile(e,c.encoding,new l(t,t.onReadNativeCallBack,[o,e,i,n,a,r,this]),e)}else{if(x.isLocalNativeFile(e))return void x.read(e,o,new l(t,t.onReadNativeCallBack,[o,e,i,n,a,r,this]));var u=e;-1!=(e=g.formatURL(e)).indexOf("http://")||-1!=e.indexOf("https://")?v.EnvConfig.load.call(this,u,i,n,a,r):x.readFile(e,o,new l(t,t.onReadNativeCallBack,[o,e,i,n,a,r,this]),e)}}},t.onReadNativeCallBack=function(e,t,i,n,a,r,o,s,h){if(void 0===n&&(n=!0),void 0===r&&(r=!1),void 0===s&&(s=0),s)1==s&&v.EnvConfig.load.call(o,t,i,n,a,r);else{var l;l="json"==i||"atlas"==i?v.getJson(h.data):"xml"==i?y.parseXMLFromString(h.data):h.data,!v.isZiYu&&v.isPosMsgYu&&"arraybuffer"!=i&&wx.postMessage({url:t,data:l,isLoad:"filedata"}),o.onLoaded(l)}},n(t,["_fileTypeArr",function(){return this._fileTypeArr=["png","jpg","bmp","jpeg","gif"]}]),t}()),M=function(e){function t(){this._sound=null,this.url=null,this.loaded=!1,this.readyUrl=null,t.__super.call(this)}a(t,"laya.wx.mini.MiniSound",s);var i=t.prototype;return i.load=function(e){e=g.formatURL(e),this.url=e,this.readyUrl=e,t._audioCache[this.readyUrl]?this.event("complete"):v.autoCacheFile&&x.getFileInfo(e)?this.onDownLoadCallBack(e,0):v.autoCacheFile?x.downOtherFiles(e,l.create(this,this.onDownLoadCallBack,[e]),e):this.onDownLoadCallBack(e,0)},i.onDownLoadCallBack=function(e,i){if(i)this.event("error");else{var n;if(v.autoCacheFile){var a=x.getFileInfo(e).md5;n=x.getFileNativePath(a),this._sound=t._createSound(),this._sound.src=this.url=n}else this._sound=t._createSound(),this._sound.src=e;this._sound.onCanplay(t.bindToThis(this.onCanPlay,this)),this._sound.onError(t.bindToThis(this.onError,this))}},i.onError=function(e){try{console.log("-----1---------------minisound-----id:"+t._id),console.log(e)}catch(e){console.log("-----2---------------minisound-----id:"+t._id),console.log(e)}this.event("error"),this._sound.offError(null)},i.onCanPlay=function(){this.loaded=!0,this.event("complete"),t._audioCache[this.readyUrl]=this,this._sound.offCanplay(null)},i.play=function(e,i){void 0===e&&(e=0),void 0===i&&(i=0);var n;if(this.url==f._tMusic?(t._musicAudio||(t._musicAudio=t._createSound()),n=t._musicAudio):n=t._audioCache[this.readyUrl]?t._audioCache[this.readyUrl]._sound:t._createSound(),v.autoCacheFile&&x.getFileInfo(this.url)){var a=x.getFileInfo(this.url).md5;n.src=this.url=x.getFileNativePath(a)}else n.src=this.url;var r=new C(n,this);return r.url=this.url,r.loops=i,r.loop=0===i,r.startTime=e,r.play(),f.addChannel(r),r},i.dispose=function(){var e=t._audioCache[this.readyUrl];e&&(e.src="",e._sound&&(e._sound.destroy(),e._sound=null,e=null),delete t._audioCache[this.readyUrl])},r(0,i,"duration",function(){return this._sound.duration}),t._createSound=function(){return t._id++,v.window.wx.createInnerAudioContext()},t.bindToThis=function(e,t){return e.bind(t)},t._musicAudio=null,t._id=0,t._audioCache={},t}(),C=function(e){function t(e,i){this._audio=null,this._onEnd=null,this._miniSound=null,t.__super.call(this),this._audio=e,this._miniSound=i,this._onEnd=t.bindToThis(this.__onEnd,this),e.onEnded(this._onEnd)}a(t,"laya.wx.mini.MiniSoundChannel",m);var n=t.prototype;return n.__onEnd=function(){if(1==this.loops)return this.completeHandler&&(i.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");this.loops>0&&this.loops--,this.startTime=0,this.play()},n.play=function(){this.isStopped=!1,f.addChannel(this),this._audio.play()},n.stop=function(){this.isStopped=!0,f.removeChannel(this),this.completeHandler=null,this._audio&&(this._audio.pause(),this._audio.offEnded(null),this._audio=null,this._miniSound=null,this._onEnd=null)},n.pause=function(){this.isStopped=!0,this._audio.pause()},n.resume=function(){this._audio&&(this.isStopped=!1,f.addChannel(this),this._audio.play())},r(0,n,"autoplay",function(){return this._audio.autoplay},function(e){this._audio.autoplay=e}),r(0,n,"position",function(){return this._audio?this._audio.currentTime:0}),r(0,n,"duration",function(){return this._audio?this._audio.duration:0}),r(0,n,"loop",function(){return this._audio.loop},function(e){this._audio.loop=e}),r(0,n,"volume",function(){return this._audio?this._audio.volume:1},function(e){this._audio&&(this._audio.volume=e)}),t.bindToThis=function(e,t){return e.bind(t)},t}()}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});for(var i in Laya){var n=Laya[i];n&&n.__isclass&&(t[i]=n)}}),function(e,t,i){i.un,i.uns;var n=i.static,a=i.class,r=i.getset,o=i.__newvec,s=laya.maths.Arith,h=laya.maths.Bezier,l=laya.resource.Bitmap,c=laya.utils.Browser,p=laya.utils.Byte,u=laya.utils.Color,d=(laya.filters.ColorFilter,i.Config),_=laya.resource.Context,m=(laya.events.Event,laya.filters.Filter),f=laya.display.Graphics,g=laya.resource.HTMLCanvas,y=(laya.utils.HTMLChar,laya.resource.HTMLImage),v=laya.resource.HTMLSubImage,x=(laya.utils.Handler,laya.net.Loader,laya.maths.Matrix),b=laya.maths.Point,w=laya.maths.Rectangle,S=laya.renders.Render,I=(laya.renders.RenderContext,laya.renders.RenderSprite),M=laya.resource.Resource,C=laya.resource.ResourceManager,k=laya.utils.RunDriver,E=laya.display.Sprite,T=laya.display.Stage,L=laya.utils.Stat,D=laya.utils.StringKey,N=(laya.display.css.Style,laya.system.System),A=laya.display.Text,R=laya.resource.Texture,B=(laya.display.css.TransformInfo,laya.net.URL,laya.utils.Utils),P=laya.utils.VectorGraphManager;laya.utils.WordText;i.interface("laya.webgl.shapes.IShape"),i.interface("laya.webgl.submit.ISubmit"),i.interface("laya.webgl.text.ICharSegment"),i.interface("laya.webgl.canvas.save.ISaveData"),i.interface("laya.webgl.resource.IMergeAtlasBitmap"),i.interface("laya.filters.IFilterActionGL","laya.filters.IFilterAction");var O=function(){function e(){}a(e,"laya.filters.webgl.FilterActionGL");var t=e.prototype;return i.imps(t,{"laya.filters.IFilterActionGL":!0}),t.setValue=function(e){},t.setValueMix=function(e){},t.apply3d=function(e,t,i,n,a){return null},t.apply=function(e){return null},r(0,t,"typeMix",function(){return 0}),e}(),V=function(){function e(){}return a(e,"laya.webgl.shader.ShaderValue"),e}(),U=function(){function e(e,t,n){this._atlasID=0,this._width=0,this._height=0,this._texCount=0,this._rowInfo=null,this._cells=null,this._failSize=new i,void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0),this._cells=null,this._rowInfo=null,this._init(e,t),this._atlasID=n}var t,i;a(e,"laya.webgl.atlas.AtlasGrid");var n=e.prototype;return n.getAltasID=function(){return this._atlasID},n.setAltasID=function(e){e>=0&&(this._atlasID=e)},n.addTex=function(e,t,i){var n=this._get(t,i);return 0==n.ret?n:(this._fill(n.x,n.y,t,i,e),this._texCount++,n)},n._release=function(){null!=this._cells&&(this._cells.length=0,this._cells=null),this._rowInfo&&(this._rowInfo.length=0,this._rowInfo=null)},n._init=function(e,i){if(this._width=e,this._height=i,this._release(),0==this._width)return!1;this._cells=new Uint8Array(this._width*this._height*3),this._rowInfo=o(this._height);for(var n=0;n<this._height;n++)this._rowInfo[n]=new t;return this._clear(),!0},n._get=function(e,t){var i=new H;if(e>=this._failSize.width&&t>=this._failSize.height)return i;for(var n=-1,a=-1,r=this._width,o=this._height,s=this._cells,h=0;h<o;h++)if(!(this._rowInfo[h].spaceCount<e))for(var l=0;l<r;){var c=3*(h*r+l);if(0!=s[c]||s[c+1]<e||s[c+2]<t)l+=s[c+1];else{n=l,a=h;for(var p=0;p<e;p++)if(s[3*p+c+2]<t){n=-1;break}if(!(n<0))return i.ret=!0,i.x=n,i.y=a,i;l+=s[c+1]}}return i},n._fill=function(e,t,i,n,a){var r=this._width,o=this._height;this._check(e+i<=r&&t+n<=o);for(var s=t;s<n+t;++s){this._check(this._rowInfo[s].spaceCount>=i),this._rowInfo[s].spaceCount-=i;for(var h=0;h<i;h++){var l=3*(e+s*r+h);this._check(0==this._cells[l]),this._cells[l]=a,this._cells[l+1]=i,this._cells[l+2]=n}}if(e>0)for(s=0;s<n;++s){var c=0;for(h=e-1;h>=0&&0==this._cells[3*((t+s)*r+h)];--h,++c);for(h=c;h>0;--h)this._cells[3*((t+s)*r+e-h)+1]=h,this._check(h>0)}if(t>0)for(h=e;h<e+i;++h){for(c=0,s=t-1;s>=0&&0==this._cells[3*(h+s*r)];--s,c++);for(s=c;s>0;--s)this._cells[3*(h+(t-s)*r)+2]=s,this._check(s>0)}},n._check=function(e){0==e&&console.log("xtexMerger 错误啦")},n._clear=function(){this._texCount=0;for(var e=0;e<this._height;e++)this._rowInfo[e].spaceCount=this._width;for(var t=0;t<this._height;t++)for(var i=0;i<this._width;i++){var n=3*(t*this._width+i);this._cells[n]=0,this._cells[n+1]=this._width-i,this._cells[n+2]=this._width-t}this._failSize.width=this._width+1,this._failSize.height=this._height+1},e.__init$=function(){t=function(){function e(){this.spaceCount=0}return a(e,""),e}(),i=function(){function e(){this.width=0,this.height=0}return a(e,""),e}()},e}(),F=function(){function e(e,t,i,n){this._currentAtlasCount=0,this._maxAtlaserCount=0,this._width=0,this._height=0,this._gridSize=0,this._gridNumX=0,this._gridNumY=0,this._init=!1,this._curAtlasIndex=0,this._setAtlasParam=!1,this._atlaserArray=null,this._needGC=!1,this._setAtlasParam=!0,this._width=e,this._height=t,this._gridSize=i,this._maxAtlaserCount=n,this._gridNumX=e/i,this._gridNumY=t/i,this._curAtlasIndex=0,this._atlaserArray=[]}a(e,"laya.webgl.atlas.AtlasResourceManager");var t=e.prototype;return t.setAtlasParam=function(t,i,n,a){if(1==this._setAtlasParam)return e._sid_=0,this._width=t,this._height=i,this._gridSize=n,this._maxAtlaserCount=a,this._gridNumX=t/n,this._gridNumY=i/n,this._curAtlasIndex=0,this.freeAll(),!0;throw console.log("设置大图合集参数错误，只能在开始页面设置各种参数"),-1},t.pushData=function(t){var i=t.bitmap,n=-1,a=null,r=0,o=0,s=0;for(r=0,o=this._atlaserArray.length;r<o&&(s=(this._curAtlasIndex+r)%o,a=this._atlaserArray[s],-1==(n=a.findBitmapIsExist(i)));r++);if(-1!=n){var h=a.InAtlasWebGLImagesOffsetValue[n];return m=h[0],f=h[1],a.addToAtlas(t,m,f),!0}this._setAtlasParam=!1;for(var l=Math.ceil((t.bitmap.width+2)/this._gridSize),c=Math.ceil((t.bitmap.height+2)/this._gridSize),p=!1,u=0;u<2;u++){var d=this._maxAtlaserCount;for(r=0;r<d;r++){s=(this._curAtlasIndex+r)%d,this._atlaserArray.length-1>=s||this._atlaserArray.push(new ke(this._gridNumX,this._gridNumY,this._width,this._height,e._sid_++));var _=this._atlaserArray[s],m=0,f=0,g=_.addTex(1,l,c);if(g.ret){m=g.x*this._gridSize+1,f=g.y*this._gridSize+1,i.lock=!0,_.addToAtlasTexture(i,m,f),_.addToAtlas(t,m,f),p=!0,this._curAtlasIndex=s;break}}if(p)break;this._atlaserArray.push(new ke(this._gridNumX,this._gridNumY,this._width,this._height,e._sid_++)),this._needGC=!0,this.garbageCollection(),this._curAtlasIndex=this._atlaserArray.length-1}return p||console.log(">>>AtlasManager pushData error"),p},t.addToAtlas=function(e){laya.webgl.atlas.AtlasResourceManager.instance.pushData(e)},t.garbageCollection=function(){if(!0===this._needGC){for(var e=this._atlaserArray.length-this._maxAtlaserCount,t=0;t<e;t++)this._atlaserArray[t].dispose(),console.log("AtlasResourceManager:Dispose the inner Atlas。");console.log(">>>>altas garbageCollection ="+e),this._atlaserArray.splice(0,e),this._needGC=!1}return!0},t.freeAll=function(){for(var e=0,t=this._atlaserArray.length;e<t;e++)this._atlaserArray[e].dispose();this._atlaserArray.length=0,this._curAtlasIndex=0},t.getAtlaserCount=function(){return this._atlaserArray.length},t.getAtlaserByIndex=function(e){return this._atlaserArray[e]},r(1,e,"instance",function(){return e._Instance||(e._Instance=new e(laya.webgl.atlas.AtlasResourceManager.atlasTextureWidth,laya.webgl.atlas.AtlasResourceManager.atlasTextureHeight,16,laya.webgl.atlas.AtlasResourceManager.maxTextureCount)),e._Instance}),r(1,e,"enabled",function(){return d.atlasEnable}),r(1,e,"atlasLimitWidth",function(){return e._atlasLimitWidth},function(t){e._atlasLimitWidth=t}),r(1,e,"atlasLimitHeight",function(){return e._atlasLimitHeight},function(t){e._atlasLimitHeight=t}),e._enable=function(){d.atlasEnable=!0},e._disable=function(){d.atlasEnable=!1},e.__init__=function(){e.atlasTextureWidth=2048,e.atlasTextureHeight=2048,e.maxTextureCount=6,e.atlasLimitWidth=512,e.atlasLimitHeight=512},e._atlasLimitWidth=0,e._atlasLimitHeight=0,e.gridSize=16,e.atlasTextureWidth=0,e.atlasTextureHeight=0,e.maxTextureCount=0,e._atlasRestore=0,e.BOARDER_TYPE_NO=0,e.BOARDER_TYPE_RIGHT=1,e.BOARDER_TYPE_LEFT=2,e.BOARDER_TYPE_BOTTOM=4,e.BOARDER_TYPE_TOP=8,e.BOARDER_TYPE_ALL=15,e._sid_=0,e._Instance=null,e}(),H=function(){function e(){this.x=0,this.y=0,this.ret=!1,this.ret=!1,this.x=0,this.y=0}return a(e,"laya.webgl.atlas.MergeFillInfo"),e}(),z=function(){function e(){}return a(e,"laya.webgl.canvas.BlendMode"),e._init_=function(t){e.fns=[e.BlendNormal,e.BlendAdd,e.BlendMultiply,e.BlendScreen,e.BlendOverlay,e.BlendLight,e.BlendMask,e.BlendDestinationOut],e.targetFns=[e.BlendNormalTarget,e.BlendAddTarget,e.BlendMultiplyTarget,e.BlendScreenTarget,e.BlendOverlayTarget,e.BlendLightTarget,e.BlendMask,e.BlendDestinationOut]},e.BlendNormal=function(e){e.blendFunc(1,771)},e.BlendAdd=function(e){e.blendFunc(1,772)},e.BlendMultiply=function(e){e.blendFunc(774,771)},e.BlendScreen=function(e){e.blendFunc(1,1)},e.BlendOverlay=function(e){e.blendFunc(1,769)},e.BlendLight=function(e){e.blendFunc(1,1)},e.BlendNormalTarget=function(e){e.blendFunc(1,771)},e.BlendAddTarget=function(e){e.blendFunc(1,772)},e.BlendMultiplyTarget=function(e){e.blendFunc(774,771)},e.BlendScreenTarget=function(e){e.blendFunc(1,1)},e.BlendOverlayTarget=function(e){e.blendFunc(1,769)},e.BlendLightTarget=function(e){e.blendFunc(1,1)},e.BlendMask=function(e){e.blendFunc(0,770)},e.BlendDestinationOut=function(e){e.blendFunc(0,0)},e.activeBlendFunction=null,e.NAMES=["normal","add","multiply","screen","overlay","light","mask","destination-out"],e.TOINT={normal:0,add:1,multiply:2,screen:3,lighter:1,overlay:4,light:5,mask:6,"destination-out":7},e.NORMAL="normal",e.ADD="add",e.MULTIPLY="multiply",e.SCREEN="screen",e.LIGHT="light",e.OVERLAY="overlay",e.DESTINATIONOUT="destination-out",e.fns=[],e.targetFns=[],e}(),X=function(){function e(e){this._color=u.create("black"),this.setValue(e)}a(e,"laya.webgl.canvas.DrawStyle");var t=e.prototype;return t.setValue=function(e){if(e){if("string"==typeof e)return void(this._color=u.create(e));if(e instanceof laya.utils.Color)return void(this._color=e)}},t.reset=function(){this._color=u.create("black")},t.equal=function(e){return"string"==typeof e?this._color.strColor===e:e instanceof laya.utils.Color&&this._color.numColor===e.numColor},t.toColorStr=function(){return this._color.strColor},e.create=function(t){if(t){var i;if("string"==typeof t?i=u.create(t):t instanceof laya.utils.Color&&(i=t),i)return i._drawStyle||(i._drawStyle=new e(t))}return laya.webgl.canvas.DrawStyle.DEFAULT},n(e,["DEFAULT",function(){return this.DEFAULT=new e("#000000")}]),e}(),Y=function(){function e(){this._x=0,this._y=0,this.dirty=!1,this.offset=0,this.count=0,this.geoStart=0,this.tempArray=[],this.closePath=!1,this.geomatrys=[];xe.mainContext;this.ib=Qe.create(35048),this.vb=$e.create(5)}a(e,"laya.webgl.canvas.Path");var t=e.prototype;return t.addPoint=function(e,t){this.tempArray.push(e,t)},t.getEndPointX=function(){return this.tempArray[this.tempArray.length-2]},t.getEndPointY=function(){return this.tempArray[this.tempArray.length-1]},t.polygon=function(e,t,i,n,a,r){var o;return this.geomatrys.push(this._curGeomatry=o=new De(e,t,i,n,a,r)),n||(o.fill=!1),void 0==r&&(o.borderWidth=0),o},t.setGeomtry=function(e){this.geomatrys.push(this._curGeomatry=e)},t.drawLine=function(e,t,i,n,a){var r;return this.closePath?this.geomatrys.push(this._curGeomatry=r=new Le(e,t,i,n,a)):this.geomatrys.push(this._curGeomatry=r=new Te(e,t,i,n,a)),r.fill=!1,r},t.update=function(){var e=this.ib._byteLength,t=this.geomatrys.length;this.offset=e;for(var i=this.geoStart;i<t;i++)this.geomatrys[i].getData(this.ib,this.vb,this.vb._byteLength/20);this.geoStart=t,this.count=(this.ib._byteLength-e)/me.BYTES_PIDX},t.reset=function(){this.vb.clear(),this.ib.clear(),this.offset=this.count=this.geoStart=0,this.geomatrys.length=0},t.recover=function(){this._curGeomatry=null,this.vb.destory(),this.vb=null,this.ib.destory(),this.ib=null},e}(),G=function(){function e(){}a(e,"laya.webgl.canvas.save.SaveBase");var t=e.prototype;return i.imps(t,{"laya.webgl.canvas.save.ISaveData":!0}),t.isSaveMark=function(){return!1},t.restore=function(t){this._dataObj[this._valueName]=this._value,e._cache[e._cache._length++]=this,this._newSubmit&&(t._curSubmit=re.RENDERBASE,t._renderKey=0)},e._createArray=function(){var e=[];return e._length=0,e},e._init=function(){var t=e._namemap={};return t[1]="ALPHA",t[2]="fillStyle",t[8]="font",t[256]="lineWidth",t[512]="strokeStyle",t[8192]="_mergeID",t[1024]=t[2048]=t[4096]=[],t[16384]="textBaseline",t[32768]="textAlign",t[65536]="_nBlendType",t[1048576]="shader",t[2097152]="filters",t},e.save=function(t,i,n,a){if((t._saveMark._saveuse&i)!==i){t._saveMark._saveuse|=i;var r=e._cache,o=r._length>0?r[--r._length]:new e;o._value=n[o._valueName=e._namemap[i]],o._dataObj=n,o._newSubmit=a;var s=t._save;s[s._length++]=o}},e._cache=laya.webgl.canvas.save.SaveBase._createArray(),e._namemap=e._init(),e}(),j=function(){function e(){this._clipRect=new w}a(e,"laya.webgl.canvas.save.SaveClipRect");var t=e.prototype;return i.imps(t,{"laya.webgl.canvas.save.ISaveData":!0}),t.isSaveMark=function(){return!1},t.restore=function(t){t._clipRect=this._clipSaveRect,e._cache[e._cache._length++]=this,this._submitScissor.submitLength=t._submits._length-this._submitScissor.submitIndex,t._curSubmit=re.RENDERBASE,t._renderKey=0},e.save=function(t,i){if(131072!=(131072&t._saveMark._saveuse)){t._saveMark._saveuse|=131072;var n=e._cache,a=n._length>0?n[--n._length]:new e;a._clipSaveRect=t._clipRect,t._clipRect=a._clipRect.copyFrom(t._clipRect),a._submitScissor=i;var r=t._save;r[r._length++]=a}},n(e,["_cache",function(){return this._cache=G._createArray()}]),e}(),W=function(){function e(){this._contextX=0,this._contextY=0,this._clipRect=new w,this._rect=new w,this._matrix=new x}a(e,"laya.webgl.canvas.save.SaveClipRectStencil");var t=e.prototype;return i.imps(t,{"laya.webgl.canvas.save.ISaveData":!0}),t.isSaveMark=function(){return!1},t.restore=function(t){ce.restore(t,this._rect,this._saveMatrix,this._contextX,this._contextY),t._clipRect=this._clipSaveRect,t._curMat=this._saveMatrix,t._x=this._contextX,t._y=this._contextY,e._cache[e._cache._length++]=this,t._curSubmit=re.RENDERBASE},e.save=function(t,i,n,a,r,o,s,h,l,c){if(262144!=(262144&t._saveMark._saveuse)){t._saveMark._saveuse|=262144;var p=e._cache,u=p._length>0?p[--p._length]:new e;u._clipSaveRect=t._clipRect,u._clipRect.setTo(s,h,l,c),t._clipRect=u._clipRect,u._rect.x=n,u._rect.y=a,u._rect.width=r,u._rect.height=o,u._contextX=t._x,u._contextY=t._y,u._saveMatrix=t._curMat,t._curMat.copyTo(u._matrix),t._curMat=u._matrix,u._submitStencil=i;var d=t._save;d[d._length++]=u}},n(e,["_cache",function(){return this._cache=G._createArray()}]),e}(),q=function(){function e(){this._saveuse=0}a(e,"laya.webgl.canvas.save.SaveMark");var t=e.prototype;return i.imps(t,{"laya.webgl.canvas.save.ISaveData":!0}),t.isSaveMark=function(){return!0},t.restore=function(t){t._saveMark=this._preSaveMark,e._no[e._no._length++]=this},e.Create=function(t){var i=e._no,n=i._length>0?i[--i._length]:new e;return n._saveuse=0,n._preSaveMark=t._saveMark,t._saveMark=n,n},n(e,["_no",function(){return this._no=G._createArray()}]),e}(),K=function(){function e(){this._matrix=new x}a(e,"laya.webgl.canvas.save.SaveTransform");var t=e.prototype;return i.imps(t,{"laya.webgl.canvas.save.ISaveData":!0}),t.isSaveMark=function(){return!1},t.restore=function(t){t._curMat=this._savematrix,e._no[e._no._length++]=this},e.save=function(t){var i=t._saveMark;if(2048!=(2048&i._saveuse)){i._saveuse|=2048;var n=e._no,a=n._length>0?n[--n._length]:new e;a._savematrix=t._curMat,t._curMat=t._curMat.copyTo(a._matrix);var r=t._save;r[r._length++]=a}},n(e,["_no",function(){return this._no=G._createArray()}]),e}(),J=function(){function e(){}a(e,"laya.webgl.canvas.save.SaveTranslate");var t=e.prototype;return i.imps(t,{"laya.webgl.canvas.save.ISaveData":!0}),t.isSaveMark=function(){return!1},t.restore=function(t){t._curMat;t._x=this._x,t._y=this._y,e._no[e._no._length++]=this},e.save=function(t){var i=e._no,n=i._length>0?i[--i._length]:new e;n._x=t._x,n._y=t._y;var a=t._save;a[a._length++]=n},n(e,["_no",function(){return this._no=G._createArray()}]),e}(),Z=function(){function e(){this.target=null,this.repaint=!1,this._width=NaN,this._height=NaN,this._sp=null,this._clipRect=new w}a(e,"laya.webgl.resource.RenderTargetMAX");var t=e.prototype;return t.setSP=function(e){this._sp=e},t.size=function(e,t){var n=this;this._width!==e||this._height!==t?(this.repaint=!0,this._width=e,this._height=t,this.target?this.target.size(e,t):this.target=Pe.create(e,t),this.target.hasListener("recovered")||this.target.on("recovered",this,function(e){i.timer.callLater(n._sp,n._sp.repaint)})):this.target.size(e,t)},t._flushToTarget=function(e,t){if(!t._destroy){var i=ye.worldScissorTest,n=ye.worldClipRect;ye.worldClipRect=this._clipRect,this._clipRect.x=this._clipRect.y=0,this._clipRect.width=this._width,this._clipRect.height=this._height,ye.worldScissorTest=!1,xe.mainContext.disable(3089);var a=ye.worldAlpha,r=ye.worldMatrix4,o=ye.worldMatrix,s=ye.worldFilters,h=ye.worldShaderDefines;if(ye.worldMatrix=x.EMPTY,ye.restoreTempArray(),ye.worldMatrix4=ye.TEMPMAT4_ARRAY,ye.worldAlpha=1,ye.worldFilters=null,ye.worldShaderDefines=null,Be.activeShader=null,t.start(),d.showCanvasMark?t.clear(0,1,0,.3):t.clear(0,0,0,0),e.flush(),t.end(),Be.activeShader=null,ye.worldAlpha=a,ye.worldMatrix4=r,ye.worldMatrix=o,ye.worldFilters=s,ye.worldShaderDefines=h,ye.worldScissorTest=i,i){var l=ye.height-n.y-n.height;xe.mainContext.scissor(n.x,l,n.width,n.height),xe.mainContext.enable(3089)}ye.worldClipRect=n}},t.flush=function(e){this.repaint&&(this._flushToTarget(e,this.target),this.repaint=!1)},t.drawTo=function(e,t,i,n,a){e.drawTexture(this.target.getTexture(),t,i,n,a,0,0)},t.destroy=function(){this.target&&(this.target.destroy(),this.target=null,this._sp=null)},e}(),Q=function(){function e(){this.ALPHA=1,this.shaderType=0,this.defines=new Ee}a(e,"laya.webgl.shader.d2.Shader2D");return e.prototype.destroy=function(){this.defines=null,this.filters=null,this.glTexture=null,this.strokeStyle=null,this.fillStyle=null},e.__init__=function(){qe.addInclude("parts/ColorFilter_ps_uniform.glsl","uniform vec4 colorAlpha;\nuniform mat4 colorMat;"),qe.addInclude("parts/ColorFilter_ps_logic.glsl","mat4 alphaMat =colorMat;\n\nalphaMat[0][3] *= gl_FragColor.a;\nalphaMat[1][3] *= gl_FragColor.a;\nalphaMat[2][3] *= gl_FragColor.a;\n\ngl_FragColor = gl_FragColor * alphaMat;\ngl_FragColor += colorAlpha/255.0*gl_FragColor.a;\n"),qe.addInclude("parts/GlowFilter_ps_uniform.glsl","uniform vec4 u_color;\nuniform float u_strength;\nuniform float u_blurX;\nuniform float u_blurY;\nuniform float u_offsetX;\nuniform float u_offsetY;\nuniform float u_textW;\nuniform float u_textH;"),qe.addInclude("parts/GlowFilter_ps_logic.glsl","const float c_IterationTime = 10.0;\nfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\nvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\nvec2 vec2FilterDir = vec2(-(u_offsetX)/u_textW,-(u_offsetY)/u_textH);\nvec2 vec2FilterOff = vec2(u_blurX/u_textW/c_IterationTime * 2.0,u_blurY/u_textH/c_IterationTime * 2.0);\nfloat maxNum = u_blurX * u_blurY;\nvec2 vec2Off = vec2(0.0,0.0);\nfloat floatOff = c_IterationTime/2.0;\nfor(float i = 0.0;i<=c_IterationTime; ++i){\n\tfor(float j = 0.0;j<=c_IterationTime; ++j){\n\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\n\t\tvec4Color += texture2D(texture, v_texcoord + vec2FilterDir + vec2Off)/floatIterationTotalTime;\n\t}\n}\ngl_FragColor = vec4(u_color.rgb,vec4Color.a * u_strength);\ngl_FragColor.rgb *= gl_FragColor.a;"),qe.addInclude("parts/BlurFilter_ps_logic.glsl","gl_FragColor =   blur();\ngl_FragColor.w*=alpha;"),qe.addInclude("parts/BlurFilter_ps_uniform.glsl","uniform vec4 strength_sig2_2sig2_gauss1;\nuniform vec2 blurInfo;\n\n#define PI 3.141593\n\n//float sigma=strength/3.0;//3σ以外影响很小。即当σ=1的时候，半径为3\n//float sig2 = sigma*sigma;\n//float _2sig2 = 2.0*sig2;\n//return 1.0/(2*PI*sig2)*exp(-(x*x+y*y)/_2sig2)\n//float gauss1 = 1.0/(2.0*PI*sig2);\n\nfloat getGaussian(float x, float y){\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\n}\n\nvec4 blur(){\n    const float blurw = 9.0;\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \n    vec2 startpos=v_texcoord-halfsz;\n    vec2 ctexcoord = startpos;\n    vec2 step = 1.0/blurInfo;  //每个像素      \n    \n    for(float y = 0.0;y<=blurw; ++y){\n        ctexcoord.x=startpos.x;\n        for(float x = 0.0;x<=blurw; ++x){\n            //TODO 纹理坐标的固定偏移应该在vs中处理\n            vec4Color += texture2D(texture, ctexcoord)*getGaussian(x-blurw/2.0,y-blurw/2.0);\n            ctexcoord.x+=step.x;\n        }\n        ctexcoord.y+=step.y;\n    }\n    return vec4Color;\n}"),qe.addInclude("parts/ColorAdd_ps_uniform.glsl","uniform vec4 colorAdd;\n"),qe.addInclude("parts/ColorAdd_ps_logic.glsl","gl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\ngl_FragColor.xyz *= colorAdd.a;");var e,t;e="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",t='precision mediump float;\n//precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\nuniform float alpha;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec4 color= texture2D(texture, v_texcoord);\n   color.a*=alpha;\n   color.rgb*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',qe.preCompile2D(0,1,e,t,null),e="attribute vec4 position;\nuniform vec2 size;\nuniform mat4 mmat;\nvoid main() {\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n}",t='precision mediump float;\nuniform vec4 color;\nuniform float alpha;\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\nvoid main() {\n\tvec4 a = vec4(color.r, color.g, color.b, color.a);\n\ta.w = alpha;\n\ta.xyz *= alpha;\n\tgl_FragColor = a;\n\t#include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n}',qe.preCompile2D(0,2,e,t,null),e="attribute vec4 position;\nattribute vec3 a_color;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nuniform vec2 u_pos;\nuniform vec2 size;\nvarying vec3 color;\nvoid main(){\n  vec4 tPos = vec4(position.x + u_pos.x,position.y + u_pos.y,position.z,position.w);\n  vec4 pos=mmat*u_mmat2*tPos;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  color=a_color;\n}",t="precision mediump float;\n//precision mediump float;\nvarying vec3 color;\nuniform float alpha;\nvoid main(){\n\t//vec4 a=vec4(color.r, color.g, color.b, 1);\n\t//a.a*=alpha;\n    gl_FragColor=vec4(color.r, color.g, color.b, alpha);\n\tgl_FragColor.rgb*=alpha;\n}",qe.preCompile2D(0,4,e,t,null),e="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",t='#ifdef FSHIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n//precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\nuniform float alpha;\nuniform vec4 u_TexRange;\nuniform vec2 u_offset;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec2 newTexCoord;\n   newTexCoord.x = mod(u_offset.x + v_texcoord.x,u_TexRange.y) + u_TexRange.x;\n   newTexCoord.y = mod(u_offset.y + v_texcoord.y,u_TexRange.w) + u_TexRange.z;\n   vec4 color= texture2D(texture, newTexCoord);\n   color.a*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',qe.preCompile2D(0,256,e,t,null),e="attribute vec2 position;\nattribute vec2 texcoord;\nattribute vec4 color;\nuniform vec2 size;\nuniform float offsetX;\nuniform float offsetY;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nvoid main() {\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  v_color = color;\n  v_color.rgb *= v_color.a;\n  v_texcoord = texcoord;  \n}",t="precision mediump float;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nuniform sampler2D texture;\nuniform float alpha;\nvoid main() {\n\tvec4 t_color = texture2D(texture, v_texcoord);\n\tgl_FragColor = t_color.rgba * v_color;\n\tgl_FragColor *= alpha;\n}",qe.preCompile2D(0,512,e,t,null)},e}(),$=function(){function e(e,t,i){this._value=0,this._name2int=e,this._int2name=t,this._int2nameMap=i}a(e,"laya.webgl.shader.ShaderDefines");var t=e.prototype;return t.add=function(e){return"string"==typeof e&&(e=this._name2int[e]),this._value|=e,this._value},t.addInt=function(e){return this._value|=e,this._value},t.remove=function(e){return"string"==typeof e&&(e=this._name2int[e]),this._value&=~e,this._value},t.isDefine=function(e){return(this._value&e)===e},t.getValue=function(){return this._value},t.setValue=function(e){this._value=e},t.toNameDic=function(){var t=this._int2nameMap[this._value];return t||e._toText(this._value,this._int2name,this._int2nameMap)},e._reg=function(e,t,i,n){i[e]=t,n[t]=e},e._toText=function(e,t,i){var n=i[e];if(n)return n;for(var a={},r=1,o=0;o<32&&!((r=1<<o)>e);o++)if(e&r){var s=t[r];s&&(a[s]="")}return i[e]=a,a},e._toInt=function(e,t){for(var i=e.split("."),n=0,a=0,r=i.length;a<r;a++){var o=t[i[a]];if(!o)throw new Error("Defines to int err:"+e+"/"+i[a]);n|=o}return n},e}(),ee=function(){function e(){this.mVBBuffer=null,this.mIBBuffer=null,this.mVBData=null,this.mIBData=null,this.mEleNum=0,this.mTexture=null,this.transform=null,this._vs=null,this._ps=null,this._indexStart=-1,this._verticles=null,this._uvs=null,this._tempMatrix=new x}a(e,"laya.webgl.shader.d2.skinAnishader.SkinMesh");var t=e.prototype;return t.init=function(t,i,n){if(i)this._vs=i;else{this._vs=[];var a=t.width,r=t.height;this._vs.push(0,0,0,0,1,1,1,1),this._vs.push(a,0,1,0,1,1,1,1),this._vs.push(a,r,1,1,1,1,1,1),this._vs.push(0,r,0,1,1,1,1,1)}n?this._ps=n:(e._defaultPS||(e._defaultPS=[]).push(0,1,3,3,1,2),this._ps=e._defaultPS),this.mVBData=new Float32Array(this._vs),this.mIBData=new Uint16Array(this._ps.length),this.mIBData.start=-1,this.mEleNum=this._ps.length,this.mTexture=t},t.init2=function(e,t,i,n,a){this.transform&&(this.transform=null),i?this._ps=i:(this._ps=[],this._ps.push(0,1,3,3,1,2)),this._verticles=n,this._uvs=a,this.mEleNum=this._ps.length,this.mTexture=e,(S.isConchNode||S.isConchApp)&&(this._initMyData(),this.mVBData=new Float32Array(this._vs))},t._initMyData=function(){var t=0,i=0,n=4*this._verticles.length;this._vs=e._tempVS;var a=!1;if(S.isConchNode||S.isConchApp?(this._vs.length=n,a=!0):this._vs.length<n&&(this._vs.length=n,a=!0),e._tVSLen=n,a)for(;t<n;)this._vs[t]=this._verticles[i],this._vs[t+1]=this._verticles[i+1],this._vs[t+2]=this._uvs[i],this._vs[t+3]=this._uvs[i+1],this._vs[t+4]=1,this._vs[t+5]=1,this._vs[t+6]=1,this._vs[t+7]=1,t+=8,i+=2;else for(;t<n;)this._vs[t]=this._verticles[i],this._vs[t+1]=this._verticles[i+1],this._vs[t+2]=this._uvs[i],this._vs[t+3]=this._uvs[i+1],t+=8,i+=2},t.getData2=function(t,i,n){this.mVBBuffer=t,this.mIBBuffer=i,this._initMyData(),t.appendEx2(this._vs,Float32Array,e._tVSLen,4),this._indexStart=i._byteLength;var a;(a=e._tempIB).length<this._ps.length&&(a.length=this._ps.length);for(var r=0,o=this._ps.length;r<o;r++)a[r]=this._ps[r]+n;i.appendEx2(a,Uint16Array,this._ps.length,2)},t.getData=function(e,t,i){if(this.mVBBuffer=e,this.mIBBuffer=t,e.append(this.mVBData),this._indexStart=t._byteLength,this.mIBData.start!=i){for(var n=0,a=this._ps.length;n<a;n++)this.mIBData[n]=this._ps[n]+i;this.mIBData.start=i}t.append(this.mIBData)},t.render=function(e,t,i){if(S.isWebGL&&this.mTexture){e._renderKey=0,e._shader2D.glTexture=null,te.getInstance().addSkinMesh(this);var n=re.createShape(e,this.mIBBuffer,this.mVBBuffer,this.mEleNum,this._indexStart,Ie.create(512,0));this.transform||(this.transform=x.EMPTY),this.transform.translate(t,i),x.mul(this.transform,e._curMat,this._tempMatrix),this.transform.translate(-t,-i);var a=n.shaderValue,r=a.u_mmat2||ye.getMatrArray();ye.mat2MatArray(this._tempMatrix,r),a.textureHost=this.mTexture,a.offsetX=0,a.offsetY=0,a.u_mmat2=r,a.ALPHA=e._shader2D.ALPHA,e._submits[e._submits._length++]=n}else S.isConchApp&&this.mTexture&&(this.transform||(this.transform=x.EMPTY),e.setSkinMesh&&e.setSkinMesh(t,i,this._ps,this.mVBData,this.mEleNum,0,this.mTexture,this.transform))},e._tempVS=[],e._tempIB=[],e._defaultPS=null,e._tVSLen=0,e}(),te=function(){function e(){this.ib=null,this.vb=null;xe.mainContext;this.ib=Qe.create(35048),this.vb=$e.create(8)}a(e,"laya.webgl.shader.d2.skinAnishader.SkinMeshBuffer");var t=e.prototype;return t.addSkinMesh=function(e){e.getData2(this.vb,this.ib,this.vb._byteLength/32)},t.reset=function(){this.vb.clear(),this.ib.clear()},e.getInstance=function(){return e.instance=e.instance||new e},e.instance=null,e}(),ie=function(){function e(e,t,i,n,a,r,o,s,h){this.r0=0,this.fill=!0,this.r1=Math.PI/2,void 0===h&&(h=0),this.x=e,this.y=t,this.width=i,this.height=n,this.edges=a,this.color=r,this.borderWidth=o,this.borderColor=s}a(e,"laya.webgl.shapes.BasePoly");var t=e.prototype;return i.imps(t,{"laya.webgl.shapes.IShape":!0}),t.getData=function(e,t,i){},t.rebuild=function(e){},t.setMatrix=function(e){},t.needUpdate=function(e){return!0},t.sector=function(e,t,i){var n=this.x,a=this.y,r=this.edges,o=(this.r1-this.r0)/r,s=this.width,h=this.height,l=this.color,c=(l>>16&255)/255,p=(l>>8&255)/255,u=(255&l)/255;e.push(n,a,c,p,u);for(var d=0;d<r+1;d++)e.push(n+Math.sin(o*d+this.r0)*s,a+Math.cos(o*d+this.r0)*h),e.push(c,p,u);for(d=0;d<r;d++)t.push(i,i+d+1,i+d+2)},t.createLine2=function(e,t,i,n,a,r){var o,s,h,l,c,p,u,d,_,m,f,g,y,v,x,b,w,S,I,M,C=e.concat(),k=a,E=this.borderColor,T=(E>>16&255)/255,L=(E>>8&255)/255,D=(255&E)/255,N=C.length/2,A=n,R=i/2;h=C[0],l=C[1],m=h-(c=C[2]),_=(_=-(l-(p=C[3])))/(M=Math.sqrt(_*_+m*m))*R,m=m/M*R,k.push(h-_+this.x,l-m+this.y,T,L,D,h+_+this.x,l+m+this.y,T,L,D);for(var B=1;B<N-1;B++)h=C[2*(B-1)],l=C[2*(B-1)+1],c=C[2*B],p=C[2*B+1],u=C[2*(B+1)],d=C[2*(B+1)+1],m=h-c,g=c-u,x=(-(_=(_=-(l-p))/(M=Math.sqrt(_*_+m*m))*R)+h)*(-(m=m/M*R)+p)-(-_+c)*(-m+l),S=(-(f=(f=-(p-d))/(M=Math.sqrt(f*f+g*g))*R)+u)*(-(g=g/M*R)+p)-(-f+c)*(-g+d),I=(y=-m+l-(-m+p))*(w=-f+c-(-f+u))-(b=-g+d-(-g+p))*(v=-_+c-(-_+h)),Math.abs(I)<.1?(I+=10.1,k.push(c-_+this.x,p-m+this.y,T,L,D,c+_+this.x,p+m+this.y,T,L,D)):(((o=(v*S-w*x)/I)-c)*(o-c)+((s=(b*x-y*S)/I)-p)+(s-p),k.push(o+this.x,s+this.y,T,L,D,c-(o-c)+this.x,p-(s-p)+this.y,T,L,D));h=C[C.length-4],l=C[C.length-3],m=h-(c=C[C.length-2]),_=(_=-(l-(p=C[C.length-1])))/(M=Math.sqrt(_*_+m*m))*R,m=m/M*R,k.push(c-_+this.x,p-m+this.y,T,L,D,c+_+this.x,p+m+this.y,T,L,D);var P=r;for(B=1;B<P;B++)t.push(A+2*(B-1),A+2*(B-1)+1,A+2*B+1,A+2*B+1,A+2*B,A+2*(B-1));return k},t.createLine=function(e,t,i,n){var a=e.concat(),r=e,o=this.borderColor,s=(o>>16&255)/255,h=(o>>8&255)/255,l=(255&o)/255;a.splice(0,5);var c,p,u,d,_,m,f,g,y,v,x,b,w,S,I,M,C,k,E,T,L=a.length/5,D=n,N=i/2;u=a[0],d=a[1],v=u-(_=a[5]),y=(y=-(d-(m=a[6])))/(T=Math.sqrt(y*y+v*v))*N,v=v/T*N,r.push(u-y,d-v,s,h,l,u+y,d+v,s,h,l);for(var A=1;A<L-1;A++)u=a[5*(A-1)],d=a[5*(A-1)+1],_=a[5*A],m=a[5*A+1],f=a[5*(A+1)],g=a[5*(A+1)+1],v=u-_,b=_-f,I=(-(y=(y=-(d-m))/(T=Math.sqrt(y*y+v*v))*N)+u)*(-(v=v/T*N)+m)-(-y+_)*(-v+d),k=(-(x=(x=-(m-g))/(T=Math.sqrt(x*x+b*b))*N)+f)*(-(b=b/T*N)+m)-(-x+_)*(-b+g),E=(w=-v+d-(-v+m))*(C=-x+_-(-x+f))-(M=-b+g-(-b+m))*(S=-y+_-(-y+u)),Math.abs(E)<.1?(E+=10.1,r.push(_-y,m-v,s,h,l,_+y,m+v,s,h,l)):(((c=(S*k-C*I)/E)-_)*(c-_)+((p=(M*I-w*k)/E)-m)+(p-m),r.push(c,p,s,h,l,_-(c-_),m-(p-m),s,h,l));u=a[a.length-10],d=a[a.length-9],v=u-(_=a[a.length-5]),y=(y=-(d-(m=a[a.length-4])))/(T=Math.sqrt(y*y+v*v))*N,v=v/T*N,r.push(_-y,m-v,s,h,l,_+y,m+v,s,h,l);var R=this.edges+1;for(A=1;A<R;A++)t.push(D+2*(A-1),D+2*(A-1)+1,D+2*A+1,D+2*A+1,D+2*A,D+2*(A-1));return r},t.createLoopLine=function(e,t,i,n,a,r){var o=e.concat(),s=a||e,h=this.borderColor,l=(h>>16&255)/255,c=(h>>8&255)/255,p=(255&h)/255;o.splice(0,5);var u=[o[0],o[1]],d=[o[o.length-5],o[o.length-4]],_=d[0]+.5*(u[0]-d[0]),m=d[1]+.5*(u[1]-d[1]);o.unshift(_,m,0,0,0),o.push(_,m,0,0,0);var f,g,y,v,x,b,w,S,I,M,C,k,E,T,L,D,N,A,R,B,P=o.length/5,O=n,V=i/2;y=o[0],v=o[1],M=y-(x=o[5]),I=(I=-(v-(b=o[6])))/(B=Math.sqrt(I*I+M*M))*V,M=M/B*V,s.push(y-I,v-M,l,c,p,y+I,v+M,l,c,p);for(var U=1;U<P-1;U++)y=o[5*(U-1)],v=o[5*(U-1)+1],x=o[5*U],b=o[5*U+1],w=o[5*(U+1)],S=o[5*(U+1)+1],M=y-x,k=x-w,L=(-(I=(I=-(v-b))/(B=Math.sqrt(I*I+M*M))*V)+y)*(-(M=M/B*V)+b)-(-I+x)*(-M+v),A=(-(C=(C=-(b-S))/(B=Math.sqrt(C*C+k*k))*V)+w)*(-(k=k/B*V)+b)-(-C+x)*(-k+S),R=(E=-M+v-(-M+b))*(N=-C+x-(-C+w))-(D=-k+S-(-k+b))*(T=-I+x-(-I+y)),Math.abs(R)<.1?(R+=10.1,s.push(x-I,b-M,l,c,p,x+I,b+M,l,c,p)):(((f=(T*A-N*L)/R)-x)*(f-x)+((g=(D*L-E*A)/R)-b)+(g-b),s.push(f,g,l,c,p,x-(f-x),b-(g-b),l,c,p));r&&(t=r);var F=this.edges+1;for(U=1;U<F;U++)t.push(O+2*(U-1),O+2*(U-1)+1,O+2*U+1,O+2*U+1,O+2*U,O+2*(U-1));return t.push(O+2*(U-1),O+2*(U-1)+1,O+1,O+1,O,O+2*(U-1)),s},e}(),ne=function(){function e(){}return a(e,"laya.webgl.shapes.Earcut"),e.earcut=function(t,i,n){n=n||2;var a=i&&i.length,r=a?i[0]*n:t.length,o=e.linkedList(t,0,r,n,!0),s=[];if(!o)return s;var h,l,c,p,u,d,_;if(a&&(o=e.eliminateHoles(t,i,o,n)),t.length>80*n){h=c=t[0],l=p=t[1];for(var m=n;m<r;m+=n)u=t[m],d=t[m+1],u<h&&(h=u),d<l&&(l=d),u>c&&(c=u),d>p&&(p=d);_=0!==(_=Math.max(c-h,p-l))?1/_:0}return e.earcutLinked(o,s,n,h,l,_),s},e.linkedList=function(t,i,n,a,r){var o,s;if(r===e.signedArea(t,i,n,a)>0)for(o=i;o<n;o+=a)s=e.insertNode(o,t[o],t[o+1],s);else for(o=n-a;o>=i;o-=a)s=e.insertNode(o,t[o],t[o+1],s);return s&&e.equals(s,s.next)&&(e.removeNode(s),s=s.next),s},e.filterPoints=function(t,i){if(!t)return t;i||(i=t);var n,a=t;do{if(n=!1,a.steiner||!e.equals(a,a.next)&&0!==e.area(a.prev,a,a.next))a=a.next;else{if(e.removeNode(a),(a=i=a.prev)===a.next)break;n=!0}}while(n||a!==i);return i},e.earcutLinked=function(t,i,n,a,r,o,s){if(t){!s&&o&&e.indexCurve(t,a,r,o);for(var h,l,c=t;t.prev!==t.next;)if(h=t.prev,l=t.next,o?e.isEarHashed(t,a,r,o):e.isEar(t))i.push(h.i/n),i.push(t.i/n),i.push(l.i/n),e.removeNode(t),t=l.next,c=l.next;else if((t=l)===c){s?1===s?(t=e.cureLocalIntersections(t,i,n),e.earcutLinked(t,i,n,a,r,o,2)):2===s&&e.splitEarcut(t,i,n,a,r,o):e.earcutLinked(e.filterPoints(t,null),i,n,a,r,o,1);break}}},e.isEar=function(t){var i=t.prev,n=t,a=t.next;if(e.area(i,n,a)>=0)return!1;for(var r=t.next.next;r!==t.prev;){if(e.pointInTriangle(i.x,i.y,n.x,n.y,a.x,a.y,r.x,r.y)&&e.area(r.prev,r,r.next)>=0)return!1;r=r.next}return!0},e.isEarHashed=function(t,i,n,a){var r=t.prev,o=t,s=t.next;if(e.area(r,o,s)>=0)return!1;for(var h=r.x<o.x?r.x<s.x?r.x:s.x:o.x<s.x?o.x:s.x,l=r.y<o.y?r.y<s.y?r.y:s.y:o.y<s.y?o.y:s.y,c=r.x>o.x?r.x>s.x?r.x:s.x:o.x>s.x?o.x:s.x,p=r.y>o.y?r.y>s.y?r.y:s.y:o.y>s.y?o.y:s.y,u=e.zOrder(h,l,i,n,a),d=e.zOrder(c,p,i,n,a),_=t.nextZ;_&&_.z<=d;){if(_!==t.prev&&_!==t.next&&e.pointInTriangle(r.x,r.y,o.x,o.y,s.x,s.y,_.x,_.y)&&e.area(_.prev,_,_.next)>=0)return!1;_=_.nextZ}for(_=t.prevZ;_&&_.z>=u;){if(_!==t.prev&&_!==t.next&&e.pointInTriangle(r.x,r.y,o.x,o.y,s.x,s.y,_.x,_.y)&&e.area(_.prev,_,_.next)>=0)return!1;_=_.prevZ}return!0},e.cureLocalIntersections=function(t,i,n){var a=t;do{var r=a.prev,o=a.next.next;!e.equals(r,o)&&e.intersects(r,a,a.next,o)&&e.locallyInside(r,o)&&e.locallyInside(o,r)&&(i.push(r.i/n),i.push(a.i/n),i.push(o.i/n),e.removeNode(a),e.removeNode(a.next),a=t=o),a=a.next}while(a!==t);return a},e.splitEarcut=function(t,i,n,a,r,o){var s=t;do{for(var h=s.next.next;h!==s.prev;){if(s.i!==h.i&&e.isValidDiagonal(s,h)){var l=e.splitPolygon(s,h);return s=e.filterPoints(s,s.next),l=e.filterPoints(l,l.next),e.earcutLinked(s,i,n,a,r,o),void e.earcutLinked(l,i,n,a,r,o)}h=h.next}s=s.next}while(s!==t)},e.eliminateHoles=function(t,i,n,a){var r,o,s,h,l,c=[];for(r=0,o=i.length;r<o;r++)s=i[r]*a,h=r<o-1?i[r+1]*a:t.length,(l=e.linkedList(t,s,h,a,!1))===l.next&&(l.steiner=!0),c.push(e.getLeftmost(l));for(c.sort(e.compareX),r=0;r<c.length;r++)e.eliminateHole(c[r],n),n=e.filterPoints(n,n.next);return n},e.compareX=function(e,t){return e.x-t.x},e.eliminateHole=function(t,i){if(i=e.findHoleBridge(t,i)){var n=e.splitPolygon(i,t);e.filterPoints(n,n.next)}},e.findHoleBridge=function(t,i){var n,a=i,r=t.x,o=t.y,s=-1/0;do{if(o<=a.y&&o>=a.next.y&&a.next.y!==a.y){var h=a.x+(o-a.y)*(a.next.x-a.x)/(a.next.y-a.y);if(h<=r&&h>s){if(s=h,h===r){if(o===a.y)return a;if(o===a.next.y)return a.next}n=a.x<a.next.x?a:a.next}}a=a.next}while(a!==i);if(!n)return null;if(r===s)return n.prev;var l,c=n,p=n.x,u=n.y,d=1/0;for(a=n.next;a!==c;)r>=a.x&&a.x>=p&&r!==a.x&&e.pointInTriangle(o<u?r:s,o,p,u,o<u?s:r,o,a.x,a.y)&&((l=Math.abs(o-a.y)/(r-a.x))<d||l===d&&a.x>n.x)&&e.locallyInside(a,t)&&(n=a,d=l),a=a.next;return n},e.indexCurve=function(t,i,n,a){var r=t;do{null===r.z&&(r.z=e.zOrder(r.x,r.y,i,n,a)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,e.sortLinked(r)},e.sortLinked=function(e){var t,i,n,a,r,o,s,h,l=1;do{for(i=e,e=null,r=null,o=0;i;){for(o++,n=i,s=0,t=0;t<l&&(s++,n=n.nextZ);t++);for(h=l;s>0||h>0&&n;)0!==s&&(0===h||!n||i.z<=n.z)?(a=i,i=i.nextZ,s--):(a=n,n=n.nextZ,h--),r?r.nextZ=a:e=a,a.prevZ=r,r=a;i=n}r.nextZ=null,l*=2}while(o>1);return e},e.zOrder=function(e,t,i,n,a){return e=32767*(e-i)*a,t=32767*(t-n)*a,e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e|t<<1},e.getLeftmost=function(e){var t=e,i=e;do{t.x<i.x&&(i=t),t=t.next}while(t!==e);return i},e.pointInTriangle=function(e,t,i,n,a,r,o,s){return(a-o)*(t-s)-(e-o)*(r-s)>=0&&(e-o)*(n-s)-(i-o)*(t-s)>=0&&(i-o)*(r-s)-(a-o)*(n-s)>=0},e.isValidDiagonal=function(t,i){return t.next.i!==i.i&&t.prev.i!==i.i&&!e.intersectsPolygon(t,i)&&e.locallyInside(t,i)&&e.locallyInside(i,t)&&e.middleInside(t,i)},e.area=function(e,t,i){return(t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y)},e.equals=function(e,t){return e.x===t.x&&e.y===t.y},e.intersects=function(t,i,n,a){return!!(e.equals(t,i)&&e.equals(n,a)||e.equals(t,a)&&e.equals(n,i))||e.area(t,i,n)>0!=e.area(t,i,a)>0&&e.area(n,a,t)>0!=e.area(n,a,i)>0},e.intersectsPolygon=function(t,i){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==i.i&&n.next.i!==i.i&&e.intersects(n,n.next,t,i))return!0;n=n.next}while(n!==t);return!1},e.locallyInside=function(t,i){return e.area(t.prev,t,t.next)<0?e.area(t,i,t.next)>=0&&e.area(t,t.prev,i)>=0:e.area(t,i,t.prev)<0||e.area(t,t.next,i)<0},e.middleInside=function(e,t){var i=e,n=!1,a=(e.x+t.x)/2,r=(e.y+t.y)/2;do{i.y>r!=i.next.y>r&&i.next.y!==i.y&&a<(i.next.x-i.x)*(r-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next}while(i!==e);return n},e.splitPolygon=function(e,t){var i=new ae(e.i,e.x,e.y),n=new ae(t.i,t.x,t.y),a=e.next,r=t.prev;return e.next=t,t.prev=e,i.next=a,a.prev=i,n.next=i,i.prev=n,r.next=n,n.prev=r,n},e.insertNode=function(e,t,i,n){var a=new ae(e,t,i);return n?(a.next=n.next,a.prev=n,n.next.prev=a,n.next=a):(a.prev=a,a.next=a),a},e.removeNode=function(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)},e.signedArea=function(e,t,i,n){for(var a=0,r=t,o=i-n;r<i;r+=n)a+=(e[o]-e[r])*(e[r+1]+e[o+1]),o=r;return a},e}(),ae=function(){function e(e,t,i){this.i=null,this.x=null,this.y=null,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=null,this.i=e,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}return a(e,"laya.webgl.shapes.EarcutNode"),e}(),re=(function(){function e(e,t,i,n,a,r,o){this.lineWidth=e,this.lineColor=t,this.lineAlpha=i,this.fillColor=n,this.fillAlpha=a,this.shape=o,this.fill=r}a(e,"laya.webgl.shapes.GeometryData");var t=e.prototype;t.clone=function(){return new e(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)},t.getIndexData=function(){return null},t.getVertexData=function(){return null},t.destroy=function(){this.shape=null}}(),function(){function e(e){if(e instanceof Float32Array)this.points=e;else if(e instanceof Array){e.length;this.points=new Float32Array(e)}}a(e,"laya.webgl.shapes.Vertex");var t=e.prototype;i.imps(t,{"laya.webgl.shapes.IShape":!0}),t.getData=function(e,t,i){},t.needUpdate=function(e){return!1},t.rebuild=function(e){},t.setMatrix=function(e){}}(),function(){function e(e){void 0===e&&(e=1e4),this._renderType=e}a(e,"laya.webgl.submit.Submit");var t=e.prototype;return i.imps(t,{"laya.webgl.submit.ISubmit":!0}),t.releaseRender=function(){var t=e._cache;t[t._length++]=this,this.shaderValue.release(),this._vb=null},t.getRenderType=function(){return this._renderType},t.renderSubmit=function(){if(0===this._numEle)return 1;var e=this.shaderValue.textureHost;if(e){var t=e.source;if(!e.bitmap||!t)return 1;this.shaderValue.texture=t}this._vb.bind_upload(this._ib);var i=xe.mainContext;return this.shaderValue.upload(),z.activeBlendFunction!==this._blendFn&&(i.enable(3042),this._blendFn(i),z.activeBlendFunction=this._blendFn),L.drawCall++,L.trianglesFaces+=this._numEle/3,i.drawElements(4,this._numEle,5123,this._startIdx),1},e.__init__=function(){var t=e.RENDERBASE=new e(-1);t.shaderValue=new Ie(0,0),t.shaderValue.ALPHA=-1234},e.createSubmit=function(t,i,n,a,r){var o=e._cache._length?e._cache[--e._cache._length]:new e;null==n&&((n=o._selfVb||(o._selfVb=$e.create(-1))).clear(),a=0),o._ib=i,o._vb=n,o._startIdx=a*me.BYTES_PIDX,o._numEle=0;var s=t._nBlendType;o._blendFn=t._targets?z.targetFns[s]:z.fns[s],o.shaderValue=r,o.shaderValue.setValue(t._shader2D);var h=t._shader2D.filters;return h&&o.shaderValue.setFilters(h),o},e.createShape=function(t,i,n,a,r,o){var s=e._cache._length?e._cache[--e._cache._length]:new e;s._ib=i,s._vb=n,s._numEle=a,s._startIdx=r,s.shaderValue=o,s.shaderValue.setValue(t._shader2D);var h=t._nBlendType;return s._blendFn=t._targets?z.targetFns[h]:z.fns[h],s},e.TYPE_2D=1e4,e.TYPE_CANVAS=10003,e.TYPE_CMDSETRT=10004,e.TYPE_CUSTOM=10005,e.TYPE_BLURRT=10006,e.TYPE_CMDDESTORYPRERT=10007,e.TYPE_DISABLESTENCIL=10008,e.TYPE_OTHERIBVB=10009,e.TYPE_PRIMITIVE=10010,e.TYPE_RT=10011,e.TYPE_BLUR_RT=10012,e.TYPE_TARGET=10013,e.TYPE_CHANGE_VALUE=10014,e.TYPE_SHAPE=10015,e.TYPE_TEXTURE=10016,e.TYPE_FILLTEXTURE=10017,e.RENDERBASE=null,e._cache=(e._cache=[],e._cache._length=0,e._cache),e}()),oe=function(){function e(){this.fun=null,this.args=null}a(e,"laya.webgl.submit.SubmitCMD");var t=e.prototype;return i.imps(t,{"laya.webgl.submit.ISubmit":!0}),t.renderSubmit=function(){return this.fun.apply(null,this.args),1},t.getRenderType=function(){return 0},t.releaseRender=function(){var t=e._cache;t[t._length++]=this},e.create=function(t,i){var n=e._cache._length?e._cache[--e._cache._length]:new e;return n.fun=i,n.args=t,n},e._cache=(e._cache=[],e._cache._length=0,e._cache),e}(),se=function(){function e(){this.variables={}}a(e,"laya.webgl.submit.SubmitCMDScope");var t=e.prototype;return t.getValue=function(e){return this.variables[e]},t.addValue=function(e,t){return this.variables[e]=t},t.setValue=function(e,t){return this.variables.hasOwnProperty(e)?this.variables[e]=t:null},t.clear=function(){for(var e in this.variables)delete this.variables[e]},t.recycle=function(){this.clear(),e.POOL.push(this)},e.create=function(){var t=e.POOL.pop();return t||(t=new e),t},e.POOL=[],e}(),he=function(){function e(){this.offset=0,this.startIndex=0,this._mat=x.create()}a(e,"laya.webgl.submit.SubmitOtherIBVB");var t=e.prototype;return i.imps(t,{"laya.webgl.submit.ISubmit":!0}),t.releaseRender=function(){var t=e._cache;t[t._length++]=this},t.getRenderType=function(){return 10009},t.renderSubmit=function(){var t=this._shaderValue.textureHost;if(t){var i=t.source;if(!t.bitmap||!i)return 1;this._shaderValue.texture=i}this._vb.bind_upload(this._ib);var n=ye.worldMatrix4,a=x.TEMP;x.mulPre(this._mat,n[0],n[1],n[4],n[5],n[12],n[13],a);var r=ye.worldMatrix4=e.tempMatrix4;r[0]=a.a,r[1]=a.b,r[4]=a.c,r[5]=a.d,r[12]=a.tx,r[13]=a.ty,this._shader._offset=this.offset,this._shaderValue.refresh(),this._shader.upload(this._shaderValue),this._shader._offset=0;var o=xe.mainContext;return z.activeBlendFunction!==this._blendFn&&(o.enable(3042),this._blendFn(o),z.activeBlendFunction=this._blendFn),L.drawCall++,L.trianglesFaces+=this._numEle/3,o.drawElements(4,this._numEle,5123,this.startIndex),ye.worldMatrix4=n,Be.activeShader=null,1},e.create=function(t,i,n,a,r,o,s,h,l){void 0===l&&(l=0);var c=e._cache._length?e._cache[--e._cache._length]:new e;c._ib=n,c._vb=i,c._numEle=a,c._shader=r,c._shaderValue=o;var p=t._nBlendType;switch(c._blendFn=t._targets?z.targetFns[p]:z.fns[p],l){case 0:c.offset=0,c.startIndex=h/(me.BYTES_PE*i.vertexStride)*1.5,c.startIndex*=me.BYTES_PIDX;break;case 1:c.startIndex=s,c.offset=h}return c},e._cache=(e._cache=[],e._cache._length=0,e._cache),e.tempMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e}(),le=function(){function e(){this.submitIndex=0,this.submitLength=0,this.context=null,this.clipRect=new w,this.screenRect=new w}a(e,"laya.webgl.submit.SubmitScissor");var t=e.prototype;return i.imps(t,{"laya.webgl.submit.ISubmit":!0}),t._scissor=function(e,t,i,n){var a=ye.worldMatrix4,r=a[0],o=a[5];if(e=e*r+a[12],t=t*o+a[13],i*=r,n*=o,i<1||n<1)return!1;var s=e+i,h=t+n;e<0&&(e=0,i=s-e),t<0&&(t=0,n=h-t);var l=ye.worldClipRect;if(e=Math.max(e,l.x),t=Math.max(t,l.y),i=Math.min(s,l.right)-e,n=Math.min(h,l.bottom)-t,i<1||n<1)return!1;var c=ye.worldScissorTest;return this.screenRect.copyFrom(l),l.x=e,l.y=t,l.width=i,l.height=n,ye.worldScissorTest=!0,t=ye.height-t-n,xe.mainContext.scissor(e,t,i,n),xe.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),c?(t=ye.height-this.screenRect.y-this.screenRect.height,xe.mainContext.scissor(this.screenRect.x,t,this.screenRect.width,this.screenRect.height),xe.mainContext.enable(3089)):(xe.mainContext.disable(3089),ye.worldScissorTest=!1),l.copyFrom(this.screenRect),!0},t._scissorWithTagart=function(e,t,i,n){if(i<1||n<1)return!1;var a=e+i,r=t+n;e<0&&(e=0,i=a-e),t<0&&(t=0,n=r-t);var o=ye.worldClipRect;if(e=Math.max(e,o.x),t=Math.max(t,o.y),i=Math.min(a,o.right)-e,n=Math.min(r,o.bottom)-t,i<1||n<1)return!1;var s=ye.worldScissorTest;return this.screenRect.copyFrom(o),ye.worldScissorTest=!0,o.x=e,o.y=t,o.width=i,o.height=n,t=ye.height-t-n,xe.mainContext.scissor(e,t,i,n),xe.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),s?(t=ye.height-this.screenRect.y-this.screenRect.height,xe.mainContext.scissor(this.screenRect.x,t,this.screenRect.width,this.screenRect.height),xe.mainContext.enable(3089)):(xe.mainContext.disable(3089),ye.worldScissorTest=!1),o.copyFrom(this.screenRect),!0},t.renderSubmit=function(){return this.submitLength=Math.min(this.context._submits._length-1,this.submitLength),this.submitLength<1||this.clipRect.width<1||this.clipRect.height<1?this.submitLength+1:(this.context._targets?this._scissorWithTagart(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height):this._scissor(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height),this.submitLength+1)},t.getRenderType=function(){return 0},t.releaseRender=function(){var t=e._cache;t[t._length++]=this,this.context=null},e.create=function(t){var i=e._cache._length?e._cache[--e._cache._length]:new e;return i.context=t,i},e._cache=(e._cache=[],e._cache._length=0,e._cache),e}(),ce=function(){function e(){this.step=0,this.blendMode=null,this.level=0}a(e,"laya.webgl.submit.SubmitStencil");var t=e.prototype;return i.imps(t,{"laya.webgl.submit.ISubmit":!0}),t.renderSubmit=function(){switch(this.step){case 1:this.do1();break;case 2:this.do2();break;case 3:this.do3();break;case 4:this.do4();break;case 5:this.do5();break;case 6:this.do6();break;case 7:this.do7();break;case 8:this.do8()}return 1},t.getRenderType=function(){return 0},t.releaseRender=function(){var t=e._cache;t[t._length++]=this},t.do1=function(){var e=xe.mainContext;e.enable(2960),e.clear(1024),e.colorMask(!1,!1,!1,!1),e.stencilFunc(514,this.level,255),e.stencilOp(7680,7680,7682)},t.do2=function(){var e=xe.mainContext;e.stencilFunc(514,this.level+1,255),e.colorMask(!0,!0,!0,!0),e.stencilOp(7680,7680,7680)},t.do3=function(){var e=xe.mainContext;e.colorMask(!0,!0,!0,!0),e.stencilOp(7680,7680,7680),e.clear(1024),e.disable(2960)},t.do4=function(){var e=xe.mainContext;0==this.level&&(e.enable(2960),e.clear(1024)),e.colorMask(!1,!1,!1,!1),e.stencilFunc(519,0,255),e.stencilOp(7680,7680,7682)},t.do5=function(){var e=xe.mainContext;e.stencilFunc(514,this.level,255),e.colorMask(!0,!0,!0,!0),e.stencilOp(7680,7680,7680)},t.do6=function(){var e=xe.mainContext;z.targetFns[z.TOINT[this.blendMode]](e)},t.do7=function(){var e=xe.mainContext;e.colorMask(!1,!1,!1,!1),e.stencilOp(7680,7680,7683)},t.do8=function(){var e=xe.mainContext;e.colorMask(!0,!0,!0,!0),e.stencilFunc(514,this.level,255),e.stencilOp(7680,7680,7680)},e.restore=function(t,i,n,a,r){var o;if(t._renderKey=0,e._mask>0&&e._mask--,0==e._mask)o=laya.webgl.submit.SubmitStencil.create(3),t.addRenderObject(o),t._curSubmit=re.RENDERBASE;else{o=laya.webgl.submit.SubmitStencil.create(7),t.addRenderObject(o);var s=t._vb;s._byteLength;if(fe.fillRectImgVb(s,null,i.x,i.y,i.width,i.height,R.DEF_UV,n,a,r,0,0)){t._shader2D.glTexture=null;var h=t._curSubmit=re.createSubmit(t,t._ib,s,(s._byteLength-64)/32*3,Ie.create(2,0));h.shaderValue.ALPHA=1,t._submits[t._submits._length++]=h,t._curSubmit._numEle+=6,t._curSubmit=re.RENDERBASE}else alert("clipRect calc stencil rect error");o=laya.webgl.submit.SubmitStencil.create(8),t.addRenderObject(o)}},e.restore2=function(t,i){var n;t._renderKey=0,e._mask>0&&e._mask--,0==e._mask?(n=laya.webgl.submit.SubmitStencil.create(3),t.addRenderObject(n),t._curSubmit=re.RENDERBASE):(n=laya.webgl.submit.SubmitStencil.create(7),t.addRenderObject(n),t._submits[t._submits._length++]=i,n=laya.webgl.submit.SubmitStencil.create(8),t.addRenderObject(n))},e.create=function(t){var i=e._cache._length?e._cache[--e._cache._length]:new e;return i.step=t,5==t&&++e._mask,i.level=e._mask,i},e._cache=(e._cache=[],e._cache._length=0,e._cache),e._mask=0,e}(),pe=function(){function e(){this._renderType=0,this._vb=null,this._ib=null,this._startIdx=0,this._numEle=0,this.shaderValue=null,this.blendType=0,this.proName=null,this.scope=null}a(e,"laya.webgl.submit.SubmitTarget");var t=e.prototype;return i.imps(t,{"laya.webgl.submit.ISubmit":!0}),t.renderSubmit=function(){this._vb.bind_upload(this._ib);var e=this.scope.getValue(this.proName);return e&&(this.shaderValue.texture=e.source,this.shaderValue.strength&&!this.shaderValue.blurInfo&&(this.shaderValue.blurInfo=[e.width,e.height]),this.shaderValue.upload(),this.blend(),L.drawCall++,L.trianglesFaces+=this._numEle/3,xe.mainContext.drawElements(4,this._numEle,5123,this._startIdx)),1},t.blend=function(){if(z.activeBlendFunction!==z.fns[this.blendType]){var e=xe.mainContext;e.enable(3042),z.fns[this.blendType](e),z.activeBlendFunction=z.fns[this.blendType]}},t.getRenderType=function(){return 0},t.releaseRender=function(){var t=e._cache;t[t._length++]=this},e.create=function(t,i,n,a,r,o){var s=e._cache._length?e._cache[--e._cache._length]:new e;return s._ib=i,s._vb=n,s.proName=o,s._startIdx=a*me.BYTES_PIDX,s._numEle=0,s.blendType=t._nBlendType,s.shaderValue=r,s.shaderValue.setValue(t._shader2D),s},e._cache=(e._cache=[],e._cache._length=0,e._cache),e}(),ue=function(){function e(){this._sourceStr=null}a(e,"laya.webgl.text.CharSegment");var t=e.prototype;return i.imps(t,{"laya.webgl.text.ICharSegment":!0}),t.textToSpit=function(e){this._sourceStr=e},t.getChar=function(e){return this._sourceStr.charAt(e)},t.getCharCode=function(e){return this._sourceStr.charCodeAt(e)},t.length=function(){return this._sourceStr.length},e}(),de=function(){function e(){}var t;return a(e,"laya.webgl.text.DrawText"),e.__init__=function(){e._charsTemp=new Array,e._drawValue=new t,e._charSeg=new ue},e.customCharSeg=function(t){e._charSeg=t},e.getChar=function(t,i,n){var a=Ge.createOneChar(t,n);return-1!=i&&(e._charsCache[i]=a),a},e._drawSlow=function(t,i,n,a,r,o,s,h,l,c,p,u,d,_,m){var f,g,y=e._drawValue.value(o,h,l,c,d,_,m),v=0,x=0,b=e._charsTemp,w=0,S=NaN;if(a)for(b.length=a.length,v=0,x=a.length;v<x;v++)S=(g=a[v]).charNum+y.txtID,b[v]=f=e._charsCache[S]||e.getChar(g.char,S,y),f.active();else{var I=n instanceof laya.utils.WordText?n.toString():n;if(A.CharacterCache){e._charSeg.textToSpit(I);var M=e._charSeg.length();for(b.length=M,v=0,x=M;v<x;v++)S=e._charSeg.getCharCode(v)+y.txtID,b[v]=f=e._charsCache[S]||e.getChar(e._charSeg.getChar(v),S,y),f.active(),w+=f.cw}else b.length=0,(f=e.getChar(I,-1,y)).active(),w+=f.cw,b[0]=f}var C=0;null!==s&&"left"!==s&&(C=-("center"==s?w/2:w));var k,E,T=NaN,L=0;if(a)for(v=0,x=b.length;v<x;v++)(f=b[v]).isSpace||(g=a[v],T=f.borderSize,k=f.texture,i._drawText(k,p+C+g.x*d-T,u+g.y*_-T,k.width,k.height,r,0,0,0,0));else{for(v=0,x=b.length;v<x;v++)(f=b[v]).isSpace||(T=f.borderSize,k=f.texture,i._drawText(k,p+C-T,u-T,k.width,k.height,r,0,0,0,0),t&&((E=t[L++])||(E=t[L-1]=[]),E[0]=k,E[1]=C-T,E[2]=-T)),C+=f.cw;t&&(t.length=L)}},e._drawFast=function(e,t,i,n,a){for(var r,o,s=0,h=e.length;s<h;s++)(r=(o=e[s])[0]).active(),t._drawText(r,n+o[1],a+o[2],r.width,r.height,i,0,0,0,0)},e.drawText=function(t,n,a,r,o,s,h,l,c,p,u,_){if(void 0===_&&(_=0),!(n&&0===n.length||a&&0===a.length)){var m=r.a,f=r.d;(0!==r.b||0!==r.c)&&(m=f=1);var g=1!==m||1!==f;if(g&&i.stage.transform){var y=i.stage.transform;g=y.a===m&&y.d===f}else g=!1;if(g){var v=(r=r.copyTo(Se._tmpMatrix)).tx,x=r.ty;r.scale(1/m,1/f),r._checkTransform(),p*=m,u*=f,p+=v-r.tx,u+=x-r.ty}else m=f=1;if(a)e._drawSlow(null,t,n,a,r,o,s,h,l,c,p,u,m,f,_);else{if(null===n.toUpperCase){var b=m+1e5*f,w=n;return void(w.changed||w.id!==b?(w.id=b,w.changed=!1,e._drawSlow(w.save,t,n,a,r,o,s,h,l,c,p,u,m,f,_)):e._drawFast(w.save,t,r,p,u))}var S=n+o.toString()+h+l+c+m+f+s,I=e._textsCache[S];A.CharacterCache?I?e._drawFast(I,t,r,p,u):(e._textsCache.__length||(e._textsCache.__length=0),e._textsCache.__length>d.WebGLTextCacheCount&&((e._textsCache={}).__length=0,e._curPoolIndex=0),e._textCachesPool[e._curPoolIndex]?(I=e._textsCache[S]=e._textCachesPool[e._curPoolIndex],I.length=0):e._textCachesPool[e._curPoolIndex]=I=e._textsCache[S]=[],e._textsCache.__length++,e._curPoolIndex++,e._drawSlow(I,t,n,a,r,o,s,h,l,c,p,u,m,f,_)):e._drawSlow(I,t,n,a,r,o,s,h,l,c,p,u,m,f,_)}}},e._charsTemp=null,e._textCachesPool=[],e._curPoolIndex=0,e._charsCache={},e._textsCache={},e._drawValue=null,e.d=[],e._charSeg=null,e.__init$=function(){t=function(){function e(){}a(e,"");return e.prototype.value=function(t,i,n,a,r,o,s){this.font=t,this.fillColor=i,this.borderColor=n,this.lineWidth=a,this.scaleX=r,this.scaleY=o,this.underLine=s;var h=t.toString()+r+o+a+i+n+s;return this.txtID=e._keymap[h],this.txtID||(this.txtID=1e-7*++e._keymapCount,e._keymap[h]=this.txtID),this},e.clear=function(){e._keymap={},e._keymapCount=1},e._keymap={},e._keymapCount=1,e}()},e}(),_e=function(){function e(t){this._index=0,this._size=14,this._italic=-2,e._cache2=e._cache2||[],this.setFont(t||"14px Arial")}a(e,"laya.webgl.text.FontInContext");var t=e.prototype;return t.setFont=function(t){var i=e._cache2[t];if(i)this._words=i[0],this._size=i[1];else{this._words=t.split(" ");for(var n=0,a=this._words.length;n<a;n++)if(this._words[n].indexOf("px")>0){this._index=n;break}this._size=parseInt(this._words[this._index]),e._cache2[t]=[this._words,this._size]}this._text=null,this._italic=-2},t.getItalic=function(){return-2===this._italic&&(this._italic=this.hasType("italic")),this._italic},t.hasType=function(e){for(var t=0,i=this._words.length;t<i;t++)if(this._words[t]===e)return t;return-1},t.removeType=function(e){for(var t=0,i=this._words.length;t<i;t++)if(this._words[t]===e){this._words.splice(t,1),this._index>t&&this._index--;break}this._text=null,this._italic=-2},t.copyTo=function(e){return e._text=this._text,e._size=this._size,e._index=this._index,e._words=this._words.slice(),e._italic=-2,e},t.toString=function(){return this._text?this._text:this._text=this._words.join(" ")},r(0,t,"size",function(){return this._size},function(e){this._size=e,this._words[this._index]=e+"px",this._text=null}),e.create=function(t){var i=e._cache[t];return i||(i=e._cache[t]=new e(t))},e.EMPTY=new e,e._cache={},e._cache2=null,e}(),me=function(){function e(){}return a(e,"laya.webgl.utils.CONST3D2D"),e.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1],e.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0],e._TMPARRAY=[],e._OFFSETX=0,e._OFFSETY=0,n(e,["BYTES_PE",function(){return this.BYTES_PE=Float32Array.BYTES_PER_ELEMENT},"BYTES_PIDX",function(){return this.BYTES_PIDX=Uint16Array.BYTES_PER_ELEMENT}]),e}(),fe=function(){function e(){}return a(e,"laya.webgl.utils.GlUtils"),e.make2DProjection=function(e,t,i){return[2/e,0,0,0,0,-2/t,0,0,0,0,2/i,0,-1,1,0,1]},e.fillIBQuadrangle=function(e,t){if(t>65535/4)throw Error("IBQuadrangle count:"+t+" must<:"+Math.floor(65535/4));t=Math.floor(t),e._resizeBuffer(6*(t+1)*2,!1),e.byteLength=e.bufferLength;for(var i=e.getUint16Array(),n=0,a=0;a<t;a++)i[n++]=4*a,i[n++]=4*a+2,i[n++]=4*a+1,i[n++]=4*a,i[n++]=4*a+3,i[n++]=4*a+2;return e.setNeedUpload(),!0},e.expandIBQuadrangle=function(t,i){t.bufferLength>=6*i*2||e.fillIBQuadrangle(t,i)},e.mathCeilPowerOfTwo=function(e){return e--,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,++e},e.fillQuadrangleImgVb=function(e,t,i,n,a,r,o,s){var h=16+(e._byteLength>>2);e.byteLength=h<<2;var l=e.getFloat32Array();l[(h-=16)+2]=a[0],l[h+3]=a[1],l[h+6]=a[2],l[h+7]=a[3],l[h+10]=a[4],l[h+11]=a[5],l[h+14]=a[6],l[h+15]=a[7];var c=r.a,p=r.b,u=r.c,d=r.d;if(1!==c||0!==p||0!==u||1!==d){r.bTransform=!0;var _=r.tx+o,m=r.ty+s;l[h]=(n[0]+t)*c+(n[1]+i)*u+_,l[h+1]=(n[0]+t)*p+(n[1]+i)*d+m,l[h+4]=(n[2]+t)*c+(n[3]+i)*u+_,l[h+5]=(n[2]+t)*p+(n[3]+i)*d+m,l[h+8]=(n[4]+t)*c+(n[5]+i)*u+_,l[h+9]=(n[4]+t)*p+(n[5]+i)*d+m,l[h+12]=(n[6]+t)*c+(n[7]+i)*u+_,l[h+13]=(n[6]+t)*p+(n[7]+i)*d+m}else r.bTransform=!1,t+=r.tx+o,i+=r.ty+s,l[h]=t+n[0],l[h+1]=i+n[1],l[h+4]=t+n[2],l[h+5]=i+n[3],l[h+8]=t+n[4],l[h+9]=i+n[5],l[h+12]=t+n[6],l[h+13]=i+n[7];return e._upload=!0,!0},e.fillTranglesVB=function(e,t,i,n,a,r,o){var s=(e._byteLength>>2)+n.length;e.byteLength=s<<2;var h=e.getFloat32Array();s-=n.length;for(var l=n.length,c=a.a,p=a.b,u=a.c,d=a.d,_=0;_<l;_+=4)if(h[s+_+2]=n[_+2],h[s+_+3]=n[_+3],1!==c||0!==p||0!==u||1!==d){a.bTransform=!0;var m=a.tx+r,f=a.ty+o;h[s+_]=(n[_]+t)*c+(n[_+1]+i)*u+m,h[s+_+1]=(n[_]+t)*p+(n[_+1]+i)*d+f}else a.bTransform=!1,t+=a.tx+r,i+=a.ty+o,h[s+_]=t+n[_],h[s+_+1]=i+n[_+1];return e._upload=!0,!0},e.copyPreImgVb=function(e,t,i){var n=e._byteLength>>2;e.byteLength=n+16<<2;for(var a=e.getFloat32Array(),r=0,o=n-16;r<4;r++)a[n]=a[o]+t,++o,a[++n]=a[o]+i,++o,a[++n]=a[o],++o,a[++n]=a[o],++n,++o;e._upload=!0},e.fillRectImgVb=function(e,t,i,n,a,r,o,s,h,l,c,p,u){void 0===u&&(u=!1);var d,_,m,f,g,y,v,x,b,w,S,I,M,C,k,E,T=1,L=s.a,D=s.b,N=s.c,A=s.d,R=t&&t.width<99999999;if(1!==L||0!==D||0!==N||1!==A?(s.bTransform=!0,0===D&&0===N&&(T=23,b=a+i,w=r+n,d=L*i+(S=s.tx+h),m=L*b+S,_=A*n+(I=s.ty+l),f=A*w+I)):(T=23,s.bTransform=!1,m=(d=i+s.tx+h)+a,f=(_=n+s.ty+l)+r),R&&(g=t.x,y=t.y,v=t.width+g,x=t.height+y),1!==T){if(Math.min(d,m)>=v)return!1;if(Math.min(_,f)>=x)return!1;if(Math.max(m,d)<=g)return!1;if(Math.max(f,_)<=y)return!1}var B=e._byteLength>>2;e.byteLength=B+16<<2;var P=e.getFloat32Array();switch(P[B+2]=o[0],P[B+3]=o[1],P[B+6]=o[2],P[B+7]=o[3],P[B+10]=o[4],P[B+11]=o[5],P[B+14]=o[6],P[B+15]=o[7],T){case 1:S=s.tx+h,I=s.ty+l;var O=L*i,V=N*n,U=A*n,F=D*i,H=L*(b=a+i),z=N*(w=r+n),X=A*w,Y=D*b;u?(M=O+V+S,k=Math.round(M)-M,C=U+F+I,E=Math.round(C)-C,P[B]=M+k,P[B+1]=C+E,P[B+4]=H+V+S+k,P[B+5]=U+Y+I+E,P[B+8]=H+z+S+k,P[B+9]=X+Y+I+E,P[B+12]=O+z+S+k,P[B+13]=X+F+I+E):(P[B]=O+V+S,P[B+1]=U+F+I,P[B+4]=H+V+S,P[B+5]=U+Y+I,P[B+8]=H+z+S,P[B+9]=X+Y+I,P[B+12]=O+z+S,P[B+13]=X+F+I);break;case 23:u?(M=d+c,k=Math.round(M)-M,C=_,E=Math.round(C)-C,P[B]=M+k,P[B+1]=C+E,P[B+4]=m+c+k,P[B+5]=_+E,P[B+8]=m+k,P[B+9]=f+E,P[B+12]=d+k,P[B+13]=f+E):(P[B]=d+c,P[B+1]=_,P[B+4]=m+c,P[B+5]=_,P[B+8]=m,P[B+9]=f,P[B+12]=d,P[B+13]=f)}return e._upload=!0,!0},e.fillLineVb=function(t,i,n,a,r,o,s,h){var l=.5*s,c=e._fillLineArray,p=-(a-o),u=n-r,d=Math.sqrt(p*p+u*u);p/=d,u/=d,p*=l,u*=l,c[0]=n-p,c[1]=a-u,c[4]=n+p,c[5]=a+u,c[8]=r+p,c[9]=o+u,c[12]=r-p,c[13]=o-u,h&&h.transformPointArray(c,c);var _=16+(t._byteLength>>2);return t.byteLength=_<<2,t.insertData(c,_-16),!0},e._fillLineArray=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e}(),ge=(function(){function e(){}a(e,"laya.webgl.utils.MatirxArray"),e.ArrayMul=function(t,i,n){if(t)if(i)for(var a=NaN,r=NaN,o=NaN,s=NaN,h=0;h<4;h++)a=t[h],r=t[h+4],o=t[h+8],s=t[h+12],n[h]=a*i[0]+r*i[1]+o*i[2]+s*i[3],n[h+4]=a*i[4]+r*i[5]+o*i[6]+s*i[7],n[h+8]=a*i[8]+r*i[9]+o*i[10]+s*i[11],n[h+12]=a*i[12]+r*i[13]+o*i[14]+s*i[15];else e.copyArray(t,n);else e.copyArray(i,n)},e.copyArray=function(e,t){if(e&&t)for(var i=0;i<e.length;i++)t[i]=e[i]}}(),function(){function e(e,t,i){this._stride=0,this.vertNum=0,this.indexNum=0,this._applied=!1,this._vb=null,this._ib=null,this._vao=null,this._attribInfo=null,this._quadNum=0,this.canReuse=!1,this._stride=e,this._vb=new $e(e,35048),t&&this._vb._resizeBuffer(t,!1),this._ib=new Qe,i&&this._ib._resizeBuffer(i,!1)}a(e,"laya.webgl.utils.Mesh2D");var t=e.prototype;return t.cloneWithNewVB=function(){var t=new e(this._stride,0,0);return t._ib=this._ib,t._quadNum=this._quadNum,t._attribInfo=this._attribInfo,t},t.cloneWithNewVBIB=function(){var t=new e(this._stride,0,0);return t._attribInfo=this._attribInfo,t},t.getVBW=function(){return this._vb.setNeedUpload(),this._vb},t.getVBR=function(){return this._vb},t.getIBR=function(){return this._ib},t.getIBW=function(){return this._ib.setNeedUpload(),this._ib},t.createQuadIB=function(e){this._quadNum=e,this._ib._resizeBuffer(6*e*2,!1),this._ib.byteLength=this._ib.bufferLength;for(var t=this._ib.getUint16Array(),i=0,n=0,a=0;a<e;a++)t[i++]=n,t[i++]=n+2,t[i++]=n+1,t[i++]=n,t[i++]=n+3,t[i++]=n+2,n+=4;this._ib.setNeedUpload()},t.setAttributes=function(e){if(this._attribInfo=e,this._attribInfo.length%3!=0)throw"Mesh2D setAttributes error!"},t.getEleNum=function(){return this._ib.getBuffer().byteLength/2},t.releaseMesh=function(){},t.destroy=function(){},t.clearVB=function(){this._vb.clear()},e._gvaoid=0,e}()),ye=function(){function e(){}return a(e,"laya.webgl.utils.RenderState2D"),e.getMatrArray=function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},e.mat2MatArray=function(t,i){var n=t,a=i;return a[0]=n.a,a[1]=n.b,a[2]=e.EMPTYMAT4_ARRAY[2],a[3]=e.EMPTYMAT4_ARRAY[3],a[4]=n.c,a[5]=n.d,a[6]=e.EMPTYMAT4_ARRAY[6],a[7]=e.EMPTYMAT4_ARRAY[7],a[8]=e.EMPTYMAT4_ARRAY[8],a[9]=e.EMPTYMAT4_ARRAY[9],a[10]=e.EMPTYMAT4_ARRAY[10],a[11]=e.EMPTYMAT4_ARRAY[11],a[12]=n.tx,a[13]=n.ty,a[14]=e.EMPTYMAT4_ARRAY[14],a[15]=e.EMPTYMAT4_ARRAY[15],i},e.restoreTempArray=function(){e.TEMPMAT4_ARRAY[0]=1,e.TEMPMAT4_ARRAY[1]=0,e.TEMPMAT4_ARRAY[4]=0,e.TEMPMAT4_ARRAY[5]=1,e.TEMPMAT4_ARRAY[12]=0,e.TEMPMAT4_ARRAY[13]=0},e.clear=function(){e.worldScissorTest=!1,e.worldShaderDefines=null,e.worldFilters=null,e.worldAlpha=1,e.worldClipRect.x=e.worldClipRect.y=0,e.worldClipRect.width=e.width,e.worldClipRect.height=e.height,e.curRenderTarget=null},e._MAXSIZE=99999999,e.EMPTYMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e.worldMatrix4=e.TEMPMAT4_ARRAY,e.worldAlpha=1,e.worldScissorTest=!1,e.worldFilters=null,e.worldShaderDefines=null,e.curRenderTarget=null,e.width=0,e.height=0,n(e,["worldMatrix",function(){return this.worldMatrix=new x},"worldClipRect",function(){return this.worldClipRect=new w(0,0,99999999,99999999)}]),e}(),ve=function(){function e(e,i,n,a,r){function o(e){var i=[],n=new t(i);return s._compileToTree(n,e.split("\n"),0,i,r),n}var s=this,h=c.now();this._VS=o(i),this._PS=o(n),this._nameMap=a,c.now()-h>2&&console.log("ShaderCompile use time:"+(c.now()-h)+"  size:"+i.length+"/"+n.length)}var t,i;a(e,"laya.webgl.utils.ShaderCompile");var r=e.prototype;return r._compileToTree=function(i,n,a,r,o){var s,h,l,c,p,u,d,_=0,m=0,f=0,g=0;for(m=a;m<n.length;m++)if(!((l=n[m]).length<1)&&0!==(_=l.indexOf("//"))){if(_>=0&&(l=l.substr(0,_)),s=d||new t(r),d=null,s.text=l,s.noCompile=!0,(_=l.indexOf("#"))>=0){for(c="#",g=_+1,f=l.length;g<f;g++){var y=l.charAt(g);if(" "===y||"\t"===y||"?"===y)break;c+=y}switch(s.name=c,c){case"#ifdef":case"#ifndef":if(s.src=l,s.noCompile=null!=l.match(/[!&|()=<>]/),s.noCompile?console.log("function():Boolean{return "+l.substr(_+s.name.length)+"}"):(u=l.replace(/^\s*/,"").split(/\s+/),s.setCondition(u[1],"#ifdef"===c?1:2),s.text="//"+s.text),s.setParent(i),i=s,o)for(u=l.substr(g).split(e._splitToWordExps3),g=0;g<u.length;g++)(l=u[g]).length&&(o[l]=!0);continue;case"#if":if(s.src=l,s.noCompile=!0,s.setParent(i),i=s,o)for(u=l.substr(g).split(e._splitToWordExps3),g=0;g<u.length;g++)(l=u[g]).length&&"defined"!=l&&(o[l]=!0);continue;case"#else":s.src=l,h=(i=i.parent).childs[i.childs.length-1],s.noCompile=h.noCompile,s.noCompile||(s.condition=h.condition,s.conditionType=1==h.conditionType?2:1,s.text="//"+s.text+" "+h.text+" "+s.conditionType),s.setParent(i),i=s;continue;case"#endif":h=(i=i.parent).childs[i.childs.length-1],s.noCompile=h.noCompile,s.noCompile||(s.text="//"+s.text),s.setParent(i);continue;case"#include":u=e.splitToWords(l,null);var v=e.includes[u[1]];if(!v)throw"ShaderCompile error no this include file:"+u[1];if((_=u[0].indexOf("?"))<0){s.setParent(i),l=v.getWith("with"==u[2]?u[3]:null),this._compileToTree(s,l.split("\n"),0,r,o),s.text="";continue}s.setCondition(u[0].substr(_+1),1),s.text=v.getWith("with"==u[2]?u[3]:null);break;case"#import":p=(u=e.splitToWords(l,null))[1],r.push({node:s,file:e.includes[p],ofs:s.text.length});continue}}else{if((h=i.childs[i.childs.length-1])&&!h.name){r.length>0&&e.splitToWords(l,h),d=s,h.text+="\n"+l;continue}r.length>0&&e.splitToWords(l,s)}s.setParent(i)}},r.createShader=function(e,t,i){var n={},a="";if(e)for(var r in e)a+="#define "+r+"\n",n[r]=!0;var o=this._VS.toscript(n,[]),s=this._PS.toscript(n,[]);return(i||qe.create)(a+o.join("\n"),a+s.join("\n"),t,this._nameMap)},e._parseOne=function(t,i,n,a,r,o){var s={type:e.shaderParamsMap[n[a+1]],name:n[a+2],size:isNaN(parseInt(n[a+3]))?1:parseInt(n[a+3])};return o&&("attribute"==r?t.push(s):i.push(s)),":"==n[a+3]&&(s.type=n[a+4],a+=2),a+=2},e.addInclude=function(t,n){if(!n||0===n.length)throw new Error("add shader include file err:"+t);if(e.includes[t])throw new Error("add shader include file err, has add:"+t);e.includes[t]=new i(n)},e.preGetParams=function(t,i){var n=[t,i],a={},r=[],o=[],s={},h=[];a.attributes=r,a.uniforms=o,a.defines=s;for(var l=0,c=0,p=0;p<2;p++){n[p]=n[p].replace(e._removeAnnotation,"");var u,d=n[p].match(e._reg);for(l=0,c=d.length;l<c;l++){var _=d[l];if("attribute"==_||"uniform"==_)l=e._parseOne(r,o,d,l,_,!0);else{if("#define"==_){h[_=d[++l]]=1;continue}if("#ifdef"==_){s[u=d[++l]]=s[u]||[];for(l++;l<c;l++)if("attribute"==(_=d[l])||"uniform"==_)l=e._parseOne(r,o,d,l,_,h[u]);else if("#else"==_)for(l++;l<c;l++)if("attribute"==(_=d[l])||"uniform"==_)l=e._parseOne(r,o,d,l,_,!h[u]);else if("#endif"==_)break}}}}return a},e.splitToWords=function(e,t){for(var i,n,a=[],r=-1,o=0,s=e.length;o<s;o++)if(i=e.charAt(o)," \t=+-*/&%!<>()'\",;".indexOf(i)>=0){if(r>=0&&o-r>1&&(n=e.substr(r,o-r),a.push(n)),'"'==i||"'"==i){var h=e.indexOf(i,o+1);if(h<0)throw"Sharder err:"+e;a.push(e.substr(o+1,h-o-1)),o=h,r=-1;continue}"("==i&&t&&a.length>0&&(n=a[a.length-1]+";","vec4;main;".indexOf(n)<0&&(t.useFuns+=n)),r=-1}else r<0&&(r=o);return r<s&&s-r>1&&(n=e.substr(r,s-r),a.push(n)),a},e.IFDEF_NO=0,e.IFDEF_YES=1,e.IFDEF_ELSE=2,e.IFDEF_PARENT=3,e._removeAnnotation=new RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)","g"),e._reg=new RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])","g"),e._splitToWordExps=new RegExp("[(\".*\")]+|[('.*')]+|([ \\t=\\+\\-*/&%!<>!%(),;])","g"),e.includes={},n(e,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"_splitToWordExps3",function(){return this._splitToWordExps3=new RegExp("[ \\t=\\+\\-*/&%!<>!%(),;\\|]","g")}]),e.__init$=function(){t=function(){function e(e){this.childs=[],this.text="",this.parent=null,this.name=null,this.noCompile=!1,this.includefiles=null,this.condition=null,this.conditionType=0,this.useFuns="",this.z=0,this.src=null,this.includefiles=e}a(e,"");var t=e.prototype;return t.setParent=function(e){e.childs.push(this),this.z=e.z+1,this.parent=e},t.setCondition=function(e,t){e&&(this.conditionType=t,e=e.replace(/(\s*$)/g,""),this.condition=function(){return this[e]},this.condition.__condition=e)},t.toscript=function(t,i){return this._toscript(t,i,++e.__id)},t._toscript=function(e,t,i){if(this.childs.length<1&&!this.text)return t;t.length;if(this.condition){var n=!!this.condition.call(e);if(2===this.conditionType&&(n=!n),!n)return t}if(this.text&&t.push(this.text),this.childs.length>0&&this.childs.forEach(function(n,a,r){n._toscript(e,t,i)}),this.includefiles.length>0&&this.useFuns.length>0)for(var a,r=0,o=this.includefiles.length;r<o;r++)this.includefiles[r].curUseID!=i&&(a=this.includefiles[r].file.getFunsScript(this.useFuns)).length>0&&(this.includefiles[r].curUseID=i,t[0]=a+t[0]);return t},e.__id=1,e}(),i=function(){function t(t){this.script=null,this.codes={},this.funs={},this.curUseID=-1,this.funnames="",this.script=t;for(var i=0,n=0,a=0;;){if((i=t.indexOf("#begin",i))<0)break;for(a=i+5;;){if((a=t.indexOf("#end",a))<0)break;if("i"!==t.charAt(a+4))break;a+=5}if(a<0)throw"add include err,no #end:"+t;n=t.indexOf("\n",i);var r=e.splitToWords(t.substr(i,n-i),null);"code"==r[1]?this.codes[r[2]]=t.substr(n+1,a-n-1):"function"==r[1]&&(n=t.indexOf("function",i),n+="function".length,this.funs[r[3]]=t.substr(n+1,a-n-1),this.funnames+=r[3]+";"),i=a+1}}a(t,"");var i=t.prototype;return i.getWith=function(e){var t=e?this.codes[e]:this.script;if(!t)throw"get with error:"+e;return t},i.getFunsScript=function(e){var t="";for(var i in this.funs)e.indexOf(i+";")>=0&&(t+=this.funs[i]);return t},t}()},e}(),xe=function(){function e(){}return a(e,"laya.webgl.WebGL"),e._uint8ArraySlice=function(){for(var e=this.length,t=new Uint8Array(this.length),i=0;i<e;i++)t[i]=this[i];return t},e._float32ArraySlice=function(){for(var e=this.length,t=new Float32Array(this.length),i=0;i<e;i++)t[i]=this[i];return t},e._uint16ArraySlice=function(e){var t,i=arguments,n=0,a=0;if(0===i.length)for(n=this.length,t=new Uint16Array(n),a=0;a<n;a++)t[a]=this[a];else if(2===i.length){var r=i[0],o=i[1];if(o>r)for(n=o-r,t=new Uint16Array(n),a=r;a<o;a++)t[a-r]=this[a];else t=new Uint16Array(0)}return t},e.expandContext=function(){var e=_.prototype,t=CanvasRenderingContext2D.prototype;t.fillTrangles=e.fillTrangles,Ke.__int__(null),t.setIBVB=function(e,t,i,n,a,r,o,s,h,l){void 0===h&&(h=0),void 0===l&&(l=0),null===i&&(this._ib=this._ib||Qe.QuadrangleIB,i=this._ib,fe.expandIBQuadrangle(i,n._byteLength/64+8)),this._setIBVB(e,t,i,n,a,r,o,s,h,l)},t.fillTrangles=function(e,t,i,n,a){this._curMat=this._curMat||x.create(),this._vb=this._vb||$e.create(),this._ib||(this._ib=Qe.create(),fe.fillIBQuadrangle(this._ib,o/4));var r=this._vb,o=n.length>>4;fe.fillTranglesVB(r,t,i,n,a||this._curMat,0,0),fe.expandIBQuadrangle(this._ib,r._byteLength/64+8);var s=new Ie(1,0);s.textureHost=e;var h=new Ze("attribute vec2 position; attribute vec2 texcoord; uniform vec2 size; uniform mat4 mmat; varying vec2 v_texcoord; void main() { vec4 p=vec4(position.xy,0.0,1.0);vec4 pos=mmat*p; gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0); v_texcoord = texcoord; }","precision mediump float; varying vec2 v_texcoord; uniform sampler2D texture; void main() {vec4 color= texture2D(texture, v_texcoord); color.a*=1.0; gl_FragColor= color;}");r._vertType=3,this._setIBVB(t,i,this._ib,r,6*o,a,h,s,0,0)}},e.enable=function(){if(c.__init__(),S.isConchApp&&!S.isConchWebGL)return k.skinAniSprite=function(){return new ee},e.expandContext(),!1;if(k.getWebGLContext=function(e){for(var t,i=["webgl","experimental-webgl","webkit-3d","moz-webgl"],n=0;n<i.length;n++){try{t=e.getContext(i[n],{stencil:d.isStencil,alpha:d.isAlpha,antialias:d.isAntialias,premultipliedAlpha:d.premultipliedAlpha,preserveDrawingBuffer:d.preserveDrawingBuffer})}catch(e){}if(t)return t}return null},null==(e.mainContext=k.getWebGLContext(S._mainCanvas)))return!1;if(S.isWebGL)return!0;y.create=function(e,t){return new et(e,t)},v.create=function(e,t,i,n,a,r,o){return new We(e,t,i,n,a,r,o)},S.WebGL=e,S.isWebGL=!0,de.__init__(),k.createRenderSprite=function(e,t){return new Me(e,t)},k.createWebGLContext2D=function(e){return new Se(e)},k.changeWebGLSize=function(e,t){laya.webgl.WebGL.onStageResize(e,t)},k.createGraphics=function(){return new we};var t=k.createFilterAction;return k.createFilterAction=t||function(e){return new Ce},k.clear=function(e){ye.worldScissorTest&&laya.webgl.WebGL.mainContext.disable(3089);var t=S.context.ctx,i=0==t._submits._length||d.preserveDrawingBuffer?u.create(e)._color:T._wgColor;i&&t.clearBG(i[0],i[1],i[2],i[3]),ye.clear()},k.addToAtlas=function(e,t){void 0===t&&(t=!1);var n=e.bitmap;S.optimizeTextureMemory(e.url,e)?i.__typeof(n,"laya.webgl.resource.IMergeAtlasBitmap")&&n.allowMerageInAtlas&&n.on("recovered",e,e.addTextureToAtlas):n.enableMerageInAtlas=!1},k.isAtlas=function(e){return e instanceof laya.webgl.atlas.AtlasWebGLCanvas},F._enable(),k.beginFlush=function(){for(var e=F.instance,t=e.getAtlaserCount(),i=0;i<t;i++){var n=e.getAtlaserByIndex(i).texture;n._flashCacheImageNeedFlush&&k.flashFlushImage(n)}},k.drawToCanvas=function(e,t,i,n,a,r){(i<=0||n<=0)&&console.log("[error] canvasWidth and canvasHeight should greater than zero"),a-=e.x,r-=e.y,i|=1,n|=1,a|=1,r|=1;var o=Pe.create(i,n,6408,5121,0,!1);o.start(),o.clear(0,0,0,0),S.context.clear(),I.renders[t]._fun(e,S.context,a,ye.height-n+r),S.context.flush(),o.end();var s=o.getData(0,0,i,n);if(o.recycle(),s.byteLength==i*n*4){var h=new Ye;h._canvas=c.createElement("canvas"),h.size(i,n);var l=h._canvas.getContext("2d");c.canvas.size(i,n);var p=c.context,u=p.createImageData(i,n);return u.data.set(new Uint8ClampedArray(s.buffer)),h._imgData=u,p.putImageData(u,0,0),l.save(),l.translate(0,n),l.scale(1,-1),l.drawImage(c.canvas.source,0,0),l.restore(),h}console.log("drawToCanvas error: w:"+i+",h:"+n+",datalen:"+s.byteLength)},k.createFilterAction=function(e){var t;switch(e){case 32:t=new Ce}return t},k.addTextureToAtlas=function(e){e._uvID++,F._atlasRestore++,e.bitmap.enableMerageInAtlas&&F.instance.addToAtlas(e)},k.getTexturePixels=function(e,t,i,n,a){S.context.ctx.clear();var r=new E;r.graphics.drawTexture(e,-t,-i);var o=Pe.create(n,a);o.start(),o.clear(0,0,0,0),r.render(S.context,0,0),S.context.ctx.flush(),o.end();for(var s=o.getData(0,0,n,a),h=[],l=0,c=a-1;c>=0;c--)for(var p=0;p<n;p++)l=4*(c*n+p),h.push(s[l]),h.push(s[l+1]),h.push(s[l+2]),h.push(s[l+3]);return h},k.skinAniSprite=function(){return new ee},g.create=function(e,t){var i=new Ye;return i._imgData=t,i.flipY=!1,i},m._filterStart=function(e,t,i,n,a){var r=e.getValue("bounds"),o=Pe.create(r.width,r.height);if(o.start(),o.clear(0,0,0,0),e.addValue("src",o),e.addValue("ScissorTest",ye.worldScissorTest),ye.worldScissorTest){var s=new w;s.copyFrom(i.ctx._clipRect),e.addValue("clipRect",s),ye.worldScissorTest=!1,laya.webgl.WebGL.mainContext.disable(3089)}},m._filterEnd=function(e,t,i,n,a){var r=e.getValue("bounds");e.getValue("src").end();var o=Pe.create(r.width,r.height);o.start(),o.clear(0,0,0,0),e.addValue("out",o),t._set$P("_filterCache",o),t._set$P("_isHaveGlowFilter",e.getValue("_isHaveGlowFilter"))},m._EndTarget=function(e,t){e.getValue("src").recycle();e.getValue("out").end();if(e.getValue("ScissorTest")){ye.worldScissorTest=!0,laya.webgl.WebGL.mainContext.enable(3089),t.ctx.save();var i=e.getValue("clipRect");t.ctx.clipRect(i.x,i.y,i.width,i.height)}},m._useSrc=function(e){var t=e.getValue("out");t.end(),(t=e.getValue("src")).start(),t.clear(0,0,0,0)},m._endSrc=function(e){e.getValue("src").end()},m._useOut=function(e){var t=e.getValue("src");t.end(),(t=e.getValue("out")).start(),t.clear(0,0,0,0)},m._endOut=function(e){e.getValue("out").end()},m._recycleScope=function(e){e.recycle()},m._filter=function(e,t,i,n){var a=this._next;if(a){var r=e.filters,o=r.length;if(1==o&&32==r[0].type)return t.ctx.save(),t.ctx.setFilters([r[0]]),a._fun.call(a,e,t,i,n),void t.ctx.restore();var s,h,l=se.create(),c=b.TEMP,p=t.ctx._getTransformMatrix(),u=x.create();p.copyTo(u);var d=0,_=0,f=!1,g=e._$P._filterCache?e._$P._filterCache:null;if(!g||e._repaint){f=e._isHaveGlowFilter(),l.addValue("_isHaveGlowFilter",f),f&&(d=50,_=25),(h=new w).copyFrom(e.getSelfBounds()),h.x+=e.x,h.y+=e.y,h.x-=e.pivotX+4,h.y-=e.pivotY+4;var y=h.x,v=h.y;if(h.width+=d+8,h.height+=d+8,c.x=h.x*u.a+h.y*u.c,c.y=h.y*u.d+h.x*u.b,h.x=c.x,h.y=c.y,c.x=h.width*u.a+h.height*u.c,c.y=h.height*u.d+h.width*u.b,h.width=c.x,h.height=c.y,h.width<=0||h.height<=0)return;g&&g.recycle(),l.addValue("bounds",h);var S=oe.create([l,e,t,0,0],m._filterStart);t.addRenderObject(S),t.ctx._renderKey=0,t.ctx._shader2D.glTexture=null;var I=e.x-y+_,M=e.y-v+_;a._fun.call(a,e,t,I,M),S=oe.create([l,e,t,0,0],m._filterEnd),t.addRenderObject(S);for(var C=0;C<o;C++){0!=C&&(S=oe.create([l],m._useSrc),t.addRenderObject(S),s=Ie.create(1,0),x.TEMP.identity(),t.ctx.drawTarget(l,0,0,h.width,h.height,x.TEMP,"out",s,null,z.TOINT.overlay),S=oe.create([l],m._useOut),t.addRenderObject(S));r[C].action.apply3d(l,e,t,0,0)}S=oe.create([l,t],m._EndTarget),t.addRenderObject(S)}else{if((f=!!e._$P._isHaveGlowFilter&&e._$P._isHaveGlowFilter)&&(d=50,_=25),(h=e.getBounds()).width<=0||h.height<=0)return;h.width+=d,h.height+=d,c.x=h.x*u.a+h.y*u.c,c.y=h.y*u.d+h.x*u.b,h.x=c.x,h.y=c.y,c.x=h.width*u.a+h.height*u.c,c.y=h.height*u.d+h.width*u.b,h.width=c.x,h.height=c.y,l.addValue("out",g)}i=i-_-e.x,n=n-_-e.y,c.setTo(i,n),u.transformPoint(c),i=c.x+h.x,n=c.y+h.y,s=Ie.create(1,0),x.TEMP.identity(),t.ctx.drawTarget(l,i,n,h.width,h.height,x.TEMP,"out",s,null,z.TOINT.overlay),S=oe.create([l],m._recycleScope),t.addRenderObject(S),u.destroy()}},Float32Array.prototype.slice||(Float32Array.prototype.slice=e._float32ArraySlice),Uint16Array.prototype.slice||(Uint16Array.prototype.slice=e._uint16ArraySlice),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=e._uint8ArraySlice),!0},e.onStageResize=function(t,i){null!=e.mainContext&&(e.mainContext.viewport(0,0,t,i),ye.width=t,ye.height=i)},e.onInvalidGLRes=function(){F.instance.freeAll(),C.releaseContentManagers(!0),e.doNodeRepaint(i.stage),e.mainContext.viewport(0,0,ye.width,ye.height),i.stage.event("devicelost")},e.doNodeRepaint=function(t){0==t.numChildren&&t.repaint();for(var i=0;i<t.numChildren;i++)e.doNodeRepaint(t.getChildAt(i))},e.init=function(t,i,n){e.mainCanvas=t,g._createContext=function(e){return new Se(e)},Ye._createContext=function(e){return new Se(e)};var a=laya.webgl.WebGL.mainContext;if(null!=a.getShaderPrecisionFormat){var r=a.getShaderPrecisionFormat(35633,36338),o=a.getShaderPrecisionFormat(35632,36338);e.shaderHighPrecision=!(!r.precision||!o.precision)}else e.shaderHighPrecision=!1;if(e.compressAstc=a.getExtension("WEBGL_compressed_texture_astc"),e.compressAtc=a.getExtension("WEBGL_compressed_texture_atc"),e.compressEtc=a.getExtension("WEBGL_compressed_texture_etc"),e.compressEtc1=a.getExtension("WEBGL_compressed_texture_etc1"),e.compressPvrtc=a.getExtension("WEBGL_compressed_texture_pvrtc"),e.compressS3tc=a.getExtension("WEBGL_compressed_texture_s3tc"),e.compressS3tc_srgb=a.getExtension("WEBGL_compressed_texture_s3tc_srgb"),a.deleteTexture1=a.deleteTexture,a.deleteTexture=function(e){e==be.curBindTexValue&&(be.curBindTexValue=null),a.deleteTexture1(e)},e.onStageResize(i,n),null==e.mainContext)throw new Error("webGL getContext err!");N.__init__(),F.__init__(),Ee.__init__(),re.__init__(),Se.__init__(),Ie.__init__(),Q.__init__(),Ke.__int__(a),z._init_(a),S.isConchApp&&conch.setOnInvalidGLRes(e.onInvalidGLRes)},e.compressAstc=null,e.compressAtc=null,e.compressEtc=null,e.compressEtc1=null,e.compressPvrtc=null,e.compressS3tc=null,e.compressS3tc_srgb=null,e.mainCanvas=null,e.mainContext=null,e.antialias=!0,e.shaderHighPrecision=!1,e._bg_null=[0,0,0,0],e}(),be=function(){function e(){}return a(e,"laya.webgl.WebGLContext"),e.UseProgram=function(t){return e._useProgram!==t&&(xe.mainContext.useProgram(t),e._useProgram=t,!0)},e.setDepthTest=function(t,i){i!==e._depthTest&&(e._depthTest=i,i?t.enable(2929):t.disable(2929))},e.setDepthMask=function(t,i){i!==e._depthMask&&(e._depthMask=i,t.depthMask(i))},e.setDepthFunc=function(t,i){i!==e._depthFunc&&(e._depthFunc=i,t.depthFunc(i))},e.setBlend=function(t,i){i!==e._blend&&(e._blend=i,i?t.enable(3042):t.disable(3042))},e.setBlendFunc=function(t,i,n){(i!==e._sFactor||n!==e._dFactor)&&(e._sFactor=i,e._dFactor=n,t.blendFunc(i,n))},e.setCullFace=function(t,i){i!==e._cullFace&&(e._cullFace=i,i?t.enable(2884):t.disable(2884))},e.setFrontFace=function(t,i){i!==e._frontFace&&(e._frontFace=i,t.frontFace(i))},e.bindTexture=function(t,i,n){t.bindTexture(i,n),e.curBindTexTarget=i,e.curBindTexValue=n},e.DEPTH_BUFFER_BIT=256,e.STENCIL_BUFFER_BIT=1024,e.COLOR_BUFFER_BIT=16384,e.POINTS=0,e.LINES=1,e.LINE_LOOP=2,e.LINE_STRIP=3,e.TRIANGLES=4,e.TRIANGLE_STRIP=5,e.TRIANGLE_FAN=6,e.ZERO=0,e.ONE=1,e.SRC_COLOR=768,e.ONE_MINUS_SRC_COLOR=769,e.SRC_ALPHA=770,e.ONE_MINUS_SRC_ALPHA=771,e.DST_ALPHA=772,e.ONE_MINUS_DST_ALPHA=773,e.DST_COLOR=774,e.ONE_MINUS_DST_COLOR=775,e.SRC_ALPHA_SATURATE=776,e.FUNC_ADD=32774,e.BLEND_EQUATION=32777,e.BLEND_EQUATION_RGB=32777,e.BLEND_EQUATION_ALPHA=34877,e.FUNC_SUBTRACT=32778,e.FUNC_REVERSE_SUBTRACT=32779,e.BLEND_DST_RGB=32968,e.BLEND_SRC_RGB=32969,e.BLEND_DST_ALPHA=32970,e.BLEND_SRC_ALPHA=32971,e.CONSTANT_COLOR=32769,e.ONE_MINUS_CONSTANT_COLOR=32770,e.CONSTANT_ALPHA=32771,e.ONE_MINUS_CONSTANT_ALPHA=32772,e.BLEND_COLOR=32773,e.ARRAY_BUFFER=34962,e.ELEMENT_ARRAY_BUFFER=34963,e.ARRAY_BUFFER_BINDING=34964,e.ELEMENT_ARRAY_BUFFER_BINDING=34965,e.STREAM_DRAW=35040,e.STATIC_DRAW=35044,e.DYNAMIC_DRAW=35048,e.BUFFER_SIZE=34660,e.BUFFER_USAGE=34661,e.CURRENT_VERTEX_ATTRIB=34342,e.FRONT=1028,e.BACK=1029,e.CULL_FACE=2884,e.FRONT_AND_BACK=1032,e.BLEND=3042,e.DITHER=3024,e.STENCIL_TEST=2960,e.DEPTH_TEST=2929,e.SCISSOR_TEST=3089,e.POLYGON_OFFSET_FILL=32823,e.SAMPLE_ALPHA_TO_COVERAGE=32926,e.SAMPLE_COVERAGE=32928,e.NO_ERROR=0,e.INVALID_ENUM=1280,e.INVALID_VALUE=1281,e.INVALID_OPERATION=1282,e.OUT_OF_MEMORY=1285,e.CW=2304,e.CCW=2305,e.LINE_WIDTH=2849,e.ALIASED_POINT_SIZE_RANGE=33901,e.ALIASED_LINE_WIDTH_RANGE=33902,e.CULL_FACE_MODE=2885,e.FRONT_FACE=2886,e.DEPTH_RANGE=2928,e.DEPTH_WRITEMASK=2930,e.DEPTH_CLEAR_VALUE=2931,e.DEPTH_FUNC=2932,e.STENCIL_CLEAR_VALUE=2961,e.STENCIL_FUNC=2962,e.STENCIL_FAIL=2964,e.STENCIL_PASS_DEPTH_FAIL=2965,e.STENCIL_PASS_DEPTH_PASS=2966,e.STENCIL_REF=2967,e.STENCIL_VALUE_MASK=2963,e.STENCIL_WRITEMASK=2968,e.STENCIL_BACK_FUNC=34816,e.STENCIL_BACK_FAIL=34817,e.STENCIL_BACK_PASS_DEPTH_FAIL=34818,e.STENCIL_BACK_PASS_DEPTH_PASS=34819,e.STENCIL_BACK_REF=36003,e.STENCIL_BACK_VALUE_MASK=36004,e.STENCIL_BACK_WRITEMASK=36005,e.VIEWPORT=2978,e.SCISSOR_BOX=3088,e.COLOR_CLEAR_VALUE=3106,e.COLOR_WRITEMASK=3107,e.UNPACK_ALIGNMENT=3317,e.PACK_ALIGNMENT=3333,e.MAX_TEXTURE_SIZE=3379,e.MAX_VIEWPORT_DIMS=3386,e.SUBPIXEL_BITS=3408,e.RED_BITS=3410,e.GREEN_BITS=3411,e.BLUE_BITS=3412,e.ALPHA_BITS=3413,e.DEPTH_BITS=3414,e.STENCIL_BITS=3415,e.POLYGON_OFFSET_UNITS=10752,e.POLYGON_OFFSET_FACTOR=32824,e.TEXTURE_BINDING_2D=32873,e.SAMPLE_BUFFERS=32936,e.SAMPLES=32937,e.SAMPLE_COVERAGE_VALUE=32938,e.SAMPLE_COVERAGE_INVERT=32939,e.NUM_COMPRESSED_TEXTURE_FORMATS=34466,e.COMPRESSED_TEXTURE_FORMATS=34467,e.DONT_CARE=4352,e.FASTEST=4353,e.NICEST=4354,e.GENERATE_MIPMAP_HINT=33170,e.BYTE=5120,e.UNSIGNED_BYTE=5121,e.SHORT=5122,e.UNSIGNED_SHORT=5123,e.INT=5124,e.UNSIGNED_INT=5125,e.FLOAT=5126,e.DEPTH_COMPONENT=6402,e.ALPHA=6406,e.RGB=6407,e.RGBA=6408,e.LUMINANCE=6409,e.LUMINANCE_ALPHA=6410,e.UNSIGNED_SHORT_4_4_4_4=32819,e.UNSIGNED_SHORT_5_5_5_1=32820,e.UNSIGNED_SHORT_5_6_5=33635,e.FRAGMENT_SHADER=35632,e.VERTEX_SHADER=35633,e.MAX_VERTEX_ATTRIBS=34921,e.MAX_VERTEX_UNIFORM_VECTORS=36347,e.MAX_VARYING_VECTORS=36348,e.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,e.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,e.MAX_TEXTURE_IMAGE_UNITS=34930,e.MAX_FRAGMENT_UNIFORM_VECTORS=36349,e.SHADER_TYPE=35663,e.DELETE_STATUS=35712,e.LINK_STATUS=35714,e.VALIDATE_STATUS=35715,e.ATTACHED_SHADERS=35717,e.ACTIVE_UNIFORMS=35718,e.ACTIVE_ATTRIBUTES=35721,e.SHADING_LANGUAGE_VERSION=35724,e.CURRENT_PROGRAM=35725,e.NEVER=512,e.LESS=513,e.EQUAL=514,e.LEQUAL=515,e.GREATER=516,e.NOTEQUAL=517,e.GEQUAL=518,e.ALWAYS=519,e.KEEP=7680,e.REPLACE=7681,e.INCR=7682,e.DECR=7683,e.INVERT=5386,e.INCR_WRAP=34055,e.DECR_WRAP=34056,e.VENDOR=7936,e.RENDERER=7937,e.VERSION=7938,e.NEAREST=9728,e.LINEAR=9729,e.NEAREST_MIPMAP_NEAREST=9984,e.LINEAR_MIPMAP_NEAREST=9985,e.NEAREST_MIPMAP_LINEAR=9986,e.LINEAR_MIPMAP_LINEAR=9987,e.TEXTURE_MAG_FILTER=10240,e.TEXTURE_MIN_FILTER=10241,e.TEXTURE_WRAP_S=10242,e.TEXTURE_WRAP_T=10243,e.TEXTURE_2D=3553,e.TEXTURE=5890,e.TEXTURE_CUBE_MAP=34067,e.TEXTURE_BINDING_CUBE_MAP=34068,e.TEXTURE_CUBE_MAP_POSITIVE_X=34069,e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,e.MAX_CUBE_MAP_TEXTURE_SIZE=34076,e.TEXTURE0=33984,e.TEXTURE1=33985,e.TEXTURE2=33986,e.TEXTURE3=33987,e.TEXTURE4=33988,e.TEXTURE5=33989,e.TEXTURE6=33990,e.TEXTURE7=33991,e.TEXTURE8=33992,e.TEXTURE9=33993,e.TEXTURE10=33994,e.TEXTURE11=33995,e.TEXTURE12=33996,e.TEXTURE13=33997,e.TEXTURE14=33998,e.TEXTURE15=33999,e.TEXTURE16=34e3,e.TEXTURE17=34001,e.TEXTURE18=34002,e.TEXTURE19=34003,e.TEXTURE20=34004,e.TEXTURE21=34005,e.TEXTURE22=34006,e.TEXTURE23=34007,e.TEXTURE24=34008,e.TEXTURE25=34009,e.TEXTURE26=34010,e.TEXTURE27=34011,e.TEXTURE28=34012,e.TEXTURE29=34013,e.TEXTURE30=34014,e.TEXTURE31=34015,e.ACTIVE_TEXTURE=34016,e.REPEAT=10497,e.CLAMP_TO_EDGE=33071,e.MIRRORED_REPEAT=33648,e.FLOAT_VEC2=35664,e.FLOAT_VEC3=35665,e.FLOAT_VEC4=35666,e.INT_VEC2=35667,e.INT_VEC3=35668,e.INT_VEC4=35669,e.BOOL=35670,e.BOOL_VEC2=35671,e.BOOL_VEC3=35672,e.BOOL_VEC4=35673,e.FLOAT_MAT2=35674,e.FLOAT_MAT3=35675,e.FLOAT_MAT4=35676,e.SAMPLER_2D=35678,e.SAMPLER_CUBE=35680,e.VERTEX_ATTRIB_ARRAY_ENABLED=34338,e.VERTEX_ATTRIB_ARRAY_SIZE=34339,e.VERTEX_ATTRIB_ARRAY_STRIDE=34340,e.VERTEX_ATTRIB_ARRAY_TYPE=34341,e.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,e.VERTEX_ATTRIB_ARRAY_POINTER=34373,e.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,e.COMPILE_STATUS=35713,e.LOW_FLOAT=36336,e.MEDIUM_FLOAT=36337,e.HIGH_FLOAT=36338,e.LOW_INT=36339,e.MEDIUM_INT=36340,e.HIGH_INT=36341,e.FRAMEBUFFER=36160,e.RENDERBUFFER=36161,e.RGBA4=32854,e.RGB5_A1=32855,e.RGB565=36194,e.DEPTH_COMPONENT16=33189,e.STENCIL_INDEX=6401,e.STENCIL_INDEX8=36168,e.DEPTH_STENCIL=34041,e.RENDERBUFFER_WIDTH=36162,e.RENDERBUFFER_HEIGHT=36163,e.RENDERBUFFER_INTERNAL_FORMAT=36164,e.RENDERBUFFER_RED_SIZE=36176,e.RENDERBUFFER_GREEN_SIZE=36177,e.RENDERBUFFER_BLUE_SIZE=36178,e.RENDERBUFFER_ALPHA_SIZE=36179,e.RENDERBUFFER_DEPTH_SIZE=36180,e.RENDERBUFFER_STENCIL_SIZE=36181,e.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,e.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,e.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,e.COLOR_ATTACHMENT0=36064,e.DEPTH_ATTACHMENT=36096,e.STENCIL_ATTACHMENT=36128,e.DEPTH_STENCIL_ATTACHMENT=33306,e.NONE=0,e.FRAMEBUFFER_COMPLETE=36053,e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,e.FRAMEBUFFER_UNSUPPORTED=36061,e.FRAMEBUFFER_BINDING=36006,e.RENDERBUFFER_BINDING=36007,e.MAX_RENDERBUFFER_SIZE=34024,e.INVALID_FRAMEBUFFER_OPERATION=1286,e.UNPACK_FLIP_Y_WEBGL=37440,e.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441,e.CONTEXT_LOST_WEBGL=37442,e.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,e.BROWSER_DEFAULT_WEBGL=37444,e._useProgram=null,e._depthTest=!0,e._depthMask=!0,e._blend=!1,e._cullFace=!1,e.curBindTexTarget=null,e.curBindTexValue=null,n(e,["_depthFunc",function(){return this._depthFunc=513},"_sFactor",function(){return this._sFactor=1},"_dFactor",function(){return this._dFactor=0},"_frontFace",function(){return this._frontFace=2305}]),e}(),we=function(e){function t(){t.__super.call(this)}a(t,"laya.webgl.display.GraphicsGL",f);var i=t.prototype;return i.setShader=function(e){this._saveToCmd(S.context._setShader,[e])},i.setIBVB=function(e,t,i,n,a,r){this._saveToCmd(S.context._setIBVB,[e,t,i,n,a,r])},i.drawParticle=function(e,t,i){var n=k.createParticleTemplate2D(i);n.x=e,n.y=t,this._saveToCmd(S.context._drawParticle,[n])},t}(),Se=function(e){function t(e){this._x=0,this._y=0,this._id=++t._COUNT,this._path=null,this._drawCount=1,this._maxNumEle=0,this._clear=!1,this._isMain=!1,this._atlasResourceChange=0,this._submits=null,this._curSubmit=null,this._ib=null,this._vb=null,this._nBlendType=0,this._saveMark=null,this._shader2D=null,this.meshlist=[],this.mId=-1,this.mHaveKey=!1,this.mHaveLineKey=!1,this.mX=0,this.mY=0,t.__super.call(this),this._width=99999999,this._height=99999999,this._clipRect=t.MAXCLIPRECT,this.mOutPoint,this._canvas=e,t._contextcount++,S.isFlash?(this._ib=Qe.create(35044),fe.fillIBQuadrangle(this._ib,16)):this._ib=Qe.QuadrangleIB,this.clear()}var o;a(t,"laya.webgl.canvas.WebGLContext2D",_);var s=t.prototype;return s.setIsMainContext=function(){this._isMain=!0},s.clearBG=function(e,t,i,n){var a=xe.mainContext;a.clearColor(e,t,i,n),a.clear(16384)},s._getSubmits=function(){return this._submits},s._releaseMem=function(){if(this._submits){this._curMat.destroy(),this._curMat=null,this._shader2D.destroy(),this._shader2D=null;for(var e=0,t=this._submits._length;e<t;e++)this._submits[e].releaseRender();this._submits.length=0,this._submits._length=0,this._submits=null,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this._other&&(this._other.font=null),this._save=null,this._vb&&(this._vb.releaseResource(),this._vb.destroy(),this._vb.destory(),this._vb=null)}},s.destroy=function(){--t._contextcount,this.sprite=null,this._releaseMem(),this._targets&&this._targets.destroy(),this._targets=null,this._canvas=null,this._ib&&this._ib!=Qe.QuadrangleIB&&this._ib.releaseResource()},s.clear=function(){this._submits||(this._other=o.DEFAULT,this._curMat=x.create(),this._vb=$e.create(-1),this._submits=[],this._save=[q.Create(this)],this._save.length=10,this._shader2D=new Q,this._triangleMesh=Re.getAMesh()),this._vb.clear(),this._targets&&(this._targets.repaint=!0),this._other=o.DEFAULT,this._clear=!0,this._repaint=!1,this._drawCount=1,this._renderKey=0,this._other.lineWidth=this._shader2D.ALPHA=1,this._nBlendType=0,this._clipRect=t.MAXCLIPRECT,this._curSubmit=re.RENDERBASE,this._shader2D.glTexture=null,this._shader2D.fillStyle=this._shader2D.strokeStyle=X.DEFAULT;for(var e=0,i=this._submits._length;e<i;e++)this._submits[e].releaseRender();this._submits._length=0,this._curMat.identity(),this._other.clear(),this._saveMark=this._save[0],this._save._length=1},s.size=function(e,t){if(this._width!=e||this._height!=t)if(0==e||0==t){0!=this._vb._byteLength&&(this._width=e,this._height=t,this._vb.clear(),this._vb.upload());for(var i=0,n=this._submits._length;i<n;i++)this._submits[i].releaseRender();this._submits.length=0,this._submits._length=0,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this.sprite=null,this._targets&&this._targets.destroy(),this._targets=null}else this._width=e,this._height=t,this._targets&&this._targets.size(e,t),this._canvas.memorySize-=this._canvas.memorySize;0===e&&0===t&&this._releaseMem()},s._getTransformMatrix=function(){return this._curMat},s.translate=function(e,t){0===e&&0===t||(J.save(this),this._curMat.bTransform&&(K.save(this),this._curMat.transformPointN(b.TEMP.setTo(e,t)),e=b.TEMP.x,t=b.TEMP.y),this._x+=e,this._y+=t)},s.save=function(){this._save[this._save._length++]=q.Create(this)},s.restore=function(){var e=this._save._length;if(!(e<1))for(var t=e-1;t>=0;t--){var i=this._save[t];if(i.restore(this),i.isSaveMark())return void(this._save._length=t)}},s._fillText=function(e,t,i,n,a,r,o,s,h,l){void 0===l&&(l=0);var c=this._shader2D,p=this._curSubmit.shaderValue,d=a?_e.create(a):this._other.font;if(F.enabled)c.ALPHA!==p.ALPHA&&(c.glTexture=null),de.drawText(this,e,t,this._curMat,d,h||this._other.textAlign,r,o,s,i,n,l);else{this._shader2D.defines.getValue();var _=r?u.create(r)._color:c.colorAdd;c.ALPHA===p.ALPHA&&_===c.colorAdd&&p.colorAdd===c.colorAdd||(c.glTexture=null,c.colorAdd=_),de.drawText(this,e,t,this._curMat,d,h||this._other.textAlign,r,o,s,i,n,l)}},s.fillWords=function(e,t,i,n,a,r){this._fillText(null,e,t,i,n,a,null,-1,null,r)},s.fillBorderWords=function(e,t,i,n,a,r,o){this._fillBorderText(null,e,t,i,n,a,r,o,null)},s.fillText=function(e,t,i,n,a,r){this._fillText(e,null,t,i,n,a,null,-1,r)},s.strokeText=function(e,t,i,n,a,r,o){this._fillText(e,null,t,i,n,null,a,r||1,o)},s.fillBorderText=function(e,t,i,n,a,r,o,s){this._fillBorderText(e,null,t,i,n,a,r,o,s)},s._fillBorderText=function(e,i,n,a,r,o,s,h,l){if(!F.enabled)return this._fillText(e,i,n,a,r,null,s,h||1,l),void this._fillText(e,i,n,a,r,o,null,-1,l);var c=this._shader2D,p=this._curSubmit.shaderValue;c.ALPHA!==p.ALPHA&&(c.glTexture=null);var u=r?(t._fontTemp.setFont(r),t._fontTemp):this._other.font;de.drawText(this,e,i,this._curMat,u,l||this._other.textAlign,o,s,h||1,n,a,0)},s.fillRect=function(e,t,i,n,a){var r=this._vb;if(fe.fillRectImgVb(r,this._clipRect,e,t,i,n,R.DEF_UV,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var o=this._shader2D.fillStyle;a&&(this._shader2D.fillStyle=X.create(a));var s=this._shader2D,h=this._curSubmit.shaderValue;if(s.fillStyle!==h.fillStyle||s.ALPHA!==h.ALPHA){s.glTexture=null;var l=this._curSubmit=re.createSubmit(this,this._ib,r,(r._byteLength-64)/32*3,Ie.create(2,0));l.shaderValue.color=s.fillStyle._color._color,l.shaderValue.ALPHA=s.ALPHA,this._submits[this._submits._length++]=l}this._curSubmit._numEle+=6,this._shader2D.fillStyle=o}},s.fillTexture=function(e,t,n,a,r,o,s,h){if(e.loaded&&e.bitmap&&e.source){var l=this._vb,c=e.bitmap.width,p=e.bitmap.height,u=e.uv,d=s.x%e.width,_=s.y%e.height;if(c!=h.w||p!=h.h){if(!h.w&&!h.h)switch(h.oy=h.ox=0,o){case"repeat":h.width=a,h.height=r;break;case"repeat-x":h.width=a,_<0?e.height+_>r?h.height=r:h.height=e.height+_:(h.oy=_,e.height+_>r?h.height=r-_:h.height=e.height);break;case"repeat-y":d<0?e.width+d>a?h.width=a:h.width=e.width+d:(h.ox=d,e.width+d>a?h.width=a-d:h.width=e.width),h.height=r;break;default:h.width=a,h.height=r}h.w=c,h.h=p,h.uv=[0,0,h.width/c,0,h.width/c,h.height/p,0,h.height/p]}if(t+=h.ox,n+=h.oy,d-=h.ox,_-=h.oy,fe.fillRectImgVb(l,this._clipRect,t,n,h.width,h.height,h.uv,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var m=Ae.create(this,this._ib,l,(l._byteLength-64)/32*3,Ie.create(256,0));this._submits[this._submits._length++]=m;var f=m.shaderValue;f.textureHost=e;var g=u[0]*c,y=u[1]*p,v=(u[2]-u[0])*c,x=(u[5]-u[3])*p,b=-d/c,w=-_/p;f.u_TexRange[0]=g/c,f.u_TexRange[1]=v/c,f.u_TexRange[2]=y/p,f.u_TexRange[3]=x/p,f.u_offset[0]=b,f.u_offset[1]=w,F.enabled&&!this._isMain&&m.addTexture(e,(l._byteLength>>2)-16),this._curSubmit=m,m._renderType=10017,m._numEle+=6}}else this.sprite&&i.timer.callLater(this,this._repaintSprite)},s.setShader=function(e){G.save(this,1048576,this._shader2D,!0),this._shader2D.shader=e},s.setFilters=function(e){G.save(this,2097152,this._shader2D,!0),this._shader2D.filters=e,this._curSubmit=re.RENDERBASE,this._renderKey=0,this._drawCount++},s.drawTexture=function(e,t,i,n,a,r,o){this._drawTextureM(e,t,i,n,a,r,o,null,1)},s.addTextureVb=function(e,t,i){var n=this._curSubmit._vb||this._vb,a=n._byteLength>>2;n.byteLength=a+16<<2;for(var r=n.getFloat32Array(),o=0;o<16;o+=4)r[a++]=e[o]+t,r[a++]=e[o+1]+i,r[a++]=e[o+2],r[a++]=e[o+3];this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),n._upload=!0},s.willDrawTexture=function(e,t){if(!(e.loaded&&e.bitmap&&e.source))return this.sprite&&i.timer.callLater(this,this._repaintSprite),0;var n=e.bitmap,a=n.id+this._shader2D.ALPHA*t+10016;if(a==this._renderKey)return a;var r=this._shader2D,o=r.ALPHA,s=this._curSubmit.shaderValue;r.ALPHA*=t,this._renderKey=a,this._drawCount++,r.glTexture=n;var h=this._vb,l=null,c=h._byteLength/32*3;return l=Ae.create(this,this._ib,h,c,Ie.create(1,0)),this._submits[this._submits._length++]=l,l.shaderValue.textureHost=e,l._renderType=10016,l._preIsSameTextureShader=10016===this._curSubmit._renderType&&r.ALPHA===s.ALPHA,this._curSubmit=l,r.ALPHA=o,a},s.drawTextures=function(e,n,a,r){if(e.loaded&&e.bitmap&&e.source){var o=this._clipRect;if(this._clipRect=t.MAXCLIPRECT,this._drawTextureM(e,n[0],n[1],e.width,e.height,a,r,null,1)){if(this._clipRect=o,L.drawCall++,!(n.length<4)){for(var s=this._curSubmit._vb||this._vb,h=this._curMat.a,l=this._curMat.d,c=2,p=n.length;c<p;c+=2)fe.copyPreImgVb(s,(n[c]-n[c-2])*h,(n[c+1]-n[c-1])*l),this._curSubmit._numEle+=6;this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle)}}else alert("drawTextures err")}else this.sprite&&i.timer.callLater(this,this._repaintSprite)},s._drawTextureM=function(e,t,n,a,r,o,s,h,l){if(!e.loaded||!e.source)return this.sprite&&i.timer.callLater(this,this._repaintSprite),!1;var c=this._curSubmit._vb||this._vb,p=e.bitmap;t+=o,n+=s,this._drawCount++;var u=p.id+this._shader2D.ALPHA*l+10016;if(u!=this._renderKey){this._renderKey=u;var d=this._curSubmit.shaderValue,_=this._shader2D,m=_.ALPHA;_.ALPHA*=l,_.glTexture=p;var f=this._vb,g=null,y=f._byteLength/32*3;g=Ae.create(this,this._ib,f,y,Ie.create(1,0)),this._submits[this._submits._length++]=g,g.shaderValue.textureHost=e,g._renderType=10016,g._preIsSameTextureShader=10016===this._curSubmit._renderType&&_.ALPHA===d.ALPHA,this._curSubmit=g,c=this._curSubmit._vb||this._vb,_.ALPHA=m}return!!fe.fillRectImgVb(c,this._clipRect,t,n,a||e.width,r||e.height,e.uv,h||this._curMat,this._x,this._y,0,0)&&(F.enabled&&!this._isMain&&this._curSubmit.addTexture(e,(c._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0)},s._repaintSprite=function(){this.sprite&&this.sprite.repaint()},s._drawText=function(e,t,i,n,a,r,o,s,h,l){var c=e.bitmap;this._drawCount++;var p=c.id+this._shader2D.ALPHA+10016;if(p!=this._renderKey){this._renderKey=p;var u=this._curSubmit.shaderValue,d=this._shader2D;d.glTexture=c;var _=this._vb,m=null,f=_._byteLength/32*3;(m=F.enabled?Ae.create(this,this._ib,_,f,Ie.create(1,0)):Ae.create(this,this._ib,_,f,Je.create()))._preIsSameTextureShader=10016===this._curSubmit._renderType&&d.ALPHA===u.ALPHA,this._submits[this._submits._length++]=m,m.shaderValue.textureHost=e,m._renderType=10016,this._curSubmit=m}e.active();var g=this._curSubmit._vb||this._vb;fe.fillRectImgVb(g,this._clipRect,t+o,i+s,n||e.width,a||e.height,e.uv,r||this._curMat,this._x,this._y,h,l,!0)&&(F.enabled&&!this._isMain&&this._curSubmit.addTexture(e,(g._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle))},s.drawTextureWithTransform=function(e,i,n,a,r,o,s,h,l){if(o){var c=this._curMat,p=this._x,u=this._y;(0!==s||0!==h)&&(this._x=s*c.a+h*c.c,this._y=h*c.d+s*c.b),o&&c.bTransform?(x.mul(o,c,t._tmpMatrix),(o=t._tmpMatrix)._checkTransform()):(this._x+=c.tx,this._y+=c.ty),this._drawTextureM(e,i,n,a,r,0,0,o,l),this._x=p,this._y=u}else this._drawTextureM(e,i,n,a,r,s,h,null,l)},s.fillQuadrangle=function(e,t,i,n,a){var r=this._curSubmit,o=this._vb,s=this._shader2D,h=r.shaderValue;if(this._renderKey=0,e.bitmap){var l=e.bitmap;s.glTexture==l&&s.ALPHA===h.ALPHA||(s.glTexture=l,(r=this._curSubmit=re.createSubmit(this,this._ib,o,o._byteLength/32*3,Ie.create(1,0))).shaderValue.glTexture=l,this._submits[this._submits._length++]=r),fe.fillQuadrangleImgVb(o,t,i,n,e.uv,a||this._curMat,this._x,this._y)}else r.shaderValue.fillStyle&&r.shaderValue.fillStyle.equal(e)&&s.ALPHA===h.ALPHA||(s.glTexture=null,(r=this._curSubmit=re.createSubmit(this,this._ib,o,o._byteLength/32*3,Ie.create(2,0))).shaderValue.defines.add(2),r.shaderValue.fillStyle=X.create(e),this._submits[this._submits._length++]=r),fe.fillQuadrangleImgVb(o,t,i,n,R.DEF_UV,a||this._curMat,this._x,this._y);r._numEle+=6},s.drawTexture2=function(e,i,n,a,r,o,s,h){if(0!=o){var l=this._curMat;if(this._x=e*l.a+i*l.c,this._y=i*l.d+e*l.b,r&&(l.bTransform||r.bTransform?(x.mul(r,l,t._tmpMatrix),r=t._tmpMatrix):(this._x+=r.tx+l.tx,this._y+=r.ty+l.ty,r=x.EMPTY)),1!==o||s){var c=this._shader2D.ALPHA,p=this._nBlendType;this._shader2D.ALPHA=o,s&&(this._nBlendType=z.TOINT(s)),this._drawTextureM(h[0],h[1]-n,h[2]-a,h[3],h[4],0,0,r,1),this._shader2D.ALPHA=c,this._nBlendType=p}else this._drawTextureM(h[0],h[1]-n,h[2]-a,h[3],h[4],0,0,r,1);this._x=this._y=0}},s.drawCanvas=function(e,t,i,n,a){var r=e.context;if(this._renderKey=0,r._targets)this._submits[this._submits._length++]=Ne.create(r,0,null),this._curSubmit=re.RENDERBASE,r._targets.drawTo(this,t,i,n,a);else{var o=this._submits[this._submits._length++]=Ne.create(r,this._shader2D.ALPHA,this._shader2D.filters),s=n/e.width,h=a/e.height,l=o._matrix;this._curMat.copyTo(l),1!=s&&1!=h&&l.scale(s,h);var c=l.tx,p=l.ty;l.tx=l.ty=0,l.transformPoint(b.TEMP.setTo(t,i)),l.translate(b.TEMP.x+c,b.TEMP.y+p),this._curSubmit=re.RENDERBASE}d.showCanvasMark&&(this.save(),this.lineWidth=4,this.strokeStyle=r._targets?"yellow":"green",this.strokeRect(t-1,i-1,n+2,a+2,1),this.strokeRect(t,i,n,a,1),this.restore())},s.drawTarget=function(e,t,i,n,a,r,o,s,h,l){void 0===l&&(l=-1);var c=this._vb;if(fe.fillRectImgVb(c,this._clipRect,t,i,n,a,h||R.DEF_UV,r||this._curMat,this._x,this._y,0,0)){this._renderKey=0;this._shader2D.glTexture=null;this._curSubmit.shaderValue;var p=this._curSubmit=pe.create(this,this._ib,c,(c._byteLength-64)/32*3,s,o);p.blendType=-1==l?this._nBlendType:l,p.scope=e,this._submits[this._submits._length++]=p,this._curSubmit._numEle+=6}},s.mixRGBandAlpha=function(e){return this._mixRGBandAlpha(e,this._shader2D.ALPHA)},s._mixRGBandAlpha=function(e,t){var i=(4278190080&e)>>>24;return 0!=i?i*=t:i=255*t,16777215&e|i<<24},s.drawTriangles=function(e,n,a,r,o,s,h,l,c,p){if(!e.loaded||!e.source)return this.sprite&&i.timer.callLater(this,this._repaintSprite),!1;this._drawCount++;e.bitmap;var u=this._mixRGBandAlpha(4294967295,l),d=(r.length,s.length);this._renderKey=-1;var _=this._curSubmit=Ae.create(this,this._triangleMesh.getIBR(),this._triangleMesh.getVBR(),this._triangleMesh.indexNum,Ie.create(1,0));return _.shaderValue.textureHost=e,_._renderType=10016,this._submits[this._submits._length++]=_,h?(t._tmpMatrix.a=h.a,t._tmpMatrix.b=h.b,t._tmpMatrix.c=h.c,t._tmpMatrix.d=h.d,t._tmpMatrix.tx=h.tx+n,t._tmpMatrix.ty=h.ty+a,x.mul(t._tmpMatrix,this._curMat,t._tmpMatrix)):(t._tmpMatrix.a=this._curMat.a,t._tmpMatrix.b=this._curMat.b,t._tmpMatrix.c=this._curMat.c,t._tmpMatrix.d=this._curMat.d,t._tmpMatrix.tx=this._curMat.tx+n,t._tmpMatrix.ty=this._curMat.ty+a),this._triangleMesh.addData(r,o,s,t._tmpMatrix,u,this),this._curSubmit._numEle+=d,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0},s.transform=function(e,t,i,n,a,r){K.save(this),x.mul(x.TEMP.setTo(e,t,i,n,a,r),this._curMat,this._curMat),this._curMat._checkTransform()},s.setTransformByMatrix=function(e){e.copyTo(this._curMat)},s.transformByMatrix=function(e){K.save(this),x.mul(e,this._curMat,this._curMat),this._curMat._checkTransform()},s.rotate=function(e){K.save(this),this._curMat.rotateEx(e)},s.scale=function(e,t){K.save(this),this._curMat.scaleEx(e,t)},s.clipRect=function(e,t,i,n){if(0!=this._curMat.b||0!=this._curMat.c){this._renderKey=0;var a=ce.create(4);this.addRenderObject(a);var r=this._vb,o=r._byteLength>>2;if(fe.fillRectImgVb(r,null,e,t,i,n,R.DEF_UV,this._curMat,this._x,this._y,0,0)){this._shader2D.glTexture=null;var s=this._curSubmit=re.createSubmit(this,this._ib,r,(r._byteLength-64)/32*3,Ie.create(2,0));s.shaderValue.ALPHA=1,this._submits[this._submits._length++]=s,this._curSubmit._numEle+=6}else alert("clipRect calc stencil rect error");var h=ce.create(5);this.addRenderObject(h);var l=r.getFloat32Array(),c=Math.min(Math.min(Math.min(l[o+0],l[o+4]),l[o+8]),l[o+12]),p=Math.max(Math.max(Math.max(l[o+0],l[o+4]),l[o+8]),l[o+12]),u=Math.min(Math.min(Math.min(l[o+1],l[o+5]),l[o+9]),l[o+13]),d=Math.max(Math.max(Math.max(l[o+1],l[o+5]),l[o+9]),l[o+13]);W.save(this,h,e,t,i,n,c,u,p-c,d-u),this._curSubmit=re.RENDERBASE}else{i*=this._curMat.a,n*=this._curMat.d;var _=b.TEMP;this._curMat.transformPoint(_.setTo(e,t)),i<0&&(_.x=_.x+i,i=-i),n<0&&(_.y=_.y+n,n=-n),this._renderKey=0;var m=this._curSubmit=le.create(this);this._submits[this._submits._length++]=m,m.submitIndex=this._submits._length,m.submitLength=9999999,j.save(this,m);var f=this._clipRect,g=f.x,y=f.y,v=_.x+i,x=_.y+n;g<_.x&&(f.x=_.x),y<_.y&&(f.y=_.y),f.width=Math.min(v,g+f.width)-f.x,f.height=Math.min(x,y+f.height)-f.y,this._shader2D.glTexture=null,m.clipRect.copyFrom(f),this._curSubmit=re.RENDERBASE}},s.setIBVB=function(e,t,i,n,a,r,o,s,h,l,c){if(void 0===h&&(h=0),void 0===l&&(l=0),void 0===c&&(c=0),null===i){if(S.isFlash){var p=n;p._selfIB||(p._selfIB=Qe.create(35044)),p._selfIB.clear(),i=p._selfIB}else i=this._ib;fe.expandIBQuadrangle(i,n._byteLength/(4*n.vertexStride*4))}if(!s||!o)throw Error("setIBVB must input:shader shaderValues");var u=he.create(this,n,i,a,o,s,h,l,c);r||(r=x.EMPTY),r.translate(e,t),x.mul(r,this._curMat,u._mat),r.translate(-e,-t),this._submits[this._submits._length++]=u,this._curSubmit=re.RENDERBASE,this._renderKey=0},s.addRenderObject=function(e){this._submits[this._submits._length++]=e},s.fillTrangles=function(e,t,i,n,a){var r=this._curSubmit,o=this._vb,s=this._shader2D,h=r.shaderValue,l=n.length>>4,c=e.bitmap;this._renderKey=0,s.glTexture==c&&s.ALPHA===h.ALPHA||((r=this._curSubmit=re.createSubmit(this,this._ib,o,o._byteLength/32*3,Ie.create(1,0))).shaderValue.textureHost=e,this._submits[this._submits._length++]=r),fe.fillTranglesVB(o,t,i,n,a||this._curMat,this._x,this._y),r._numEle+=6*l},s.submitElement=function(e,t){var i=this._submits;for(t<0&&(t=i._length);e<t;)e+=i[e].renderSubmit()},s.finish=function(){xe.mainContext.finish()},s.flush=function(){var e=Math.max(this._vb._byteLength/64,this._maxNumEle/6)+8;if(e>this._ib.bufferLength/12&&fe.expandIBQuadrangle(this._ib,e),!this._isMain&&F.enabled&&F._atlasRestore>this._atlasResourceChange){this._atlasResourceChange=F._atlasRestore;for(var t=this._submits,i=0,n=t._length;i<n;i++){var a=t[i];10016===a.getRenderType()&&a.checkTexture()}}this.submitElement(0,this._submits._length),this._path&&this._path.reset(),te.instance&&te.getInstance().reset();var r=0;for(i=0,r=this.meshlist.length;i<r;i++){var o=this.meshlist[i];o.canReuse?o.releaseMesh():o.destroy()}return this.meshlist.length=0,this._curSubmit=re.RENDERBASE,this._renderKey=0,this._triangleMesh=Re.getAMesh(),this.meshlist.push(this._triangleMesh),this._submits._length},s.setPathId=function(e){if(this.mId=e,-1!=this.mId){this.mHaveKey=!1;var t=P.getInstance();t.shapeDic[this.mId]&&(this.mHaveKey=!0),this.mHaveLineKey=!1,t.shapeLineDic[this.mId]&&(this.mHaveLineKey=!0)}},s.movePath=function(e,t){var i=e,n=t;e=this._curMat.a*i+this._curMat.c*n+this._curMat.tx,t=this._curMat.b*i+this._curMat.d*n+this._curMat.ty,this.mX+=e,this.mY+=t},s.beginPath=function(){var e=this._getPath();e.tempArray.length=0,e.closePath=!1,this.mX=0,this.mY=0},s.closePath=function(){this._path.closePath=!0},s.fill=function(e){void 0===e&&(e=!1);var t=this._getPath();this.drawPoly(0,0,t.tempArray,this.fillStyle._color.numColor,0,0,e)},s.stroke=function(){var e=this._getPath();if(this.lineWidth>0){if(-1==this.mId)e.drawLine(0,0,e.tempArray,this.lineWidth,this.strokeStyle._color.numColor);else if(this.mHaveLineKey){var t=P.getInstance().shapeLineDic[this.mId];t.rebuild(e.tempArray),e.setGeomtry(t)}else P.getInstance().addLine(this.mId,e.drawLine(0,0,e.tempArray,this.lineWidth,this.strokeStyle._color.numColor));e.update();var i=[this.mX,this.mY],n=re.createShape(this,e.ib,e.vb,e.count,e.offset,Ie.create(4,0));n.shaderValue.ALPHA=this._shader2D.ALPHA,n.shaderValue.u_pos=i,n.shaderValue.u_mmat2=ye.TEMPMAT4_ARRAY,this._submits[this._submits._length++]=n,this._renderKey=-1}},s.line=function(e,t,i,n,a,r){var o=this._curSubmit,s=this._vb;if(fe.fillLineVb(s,this._clipRect,e,t,i,n,a,r)){this._renderKey=0;var h=this._shader2D,l=o.shaderValue;h.strokeStyle===l.strokeStyle&&h.ALPHA===l.ALPHA||(h.glTexture=null,(o=this._curSubmit=re.createSubmit(this,this._ib,s,(s._byteLength-64)/32*3,Ie.create(2,0))).shaderValue.strokeStyle=h.strokeStyle,o.shaderValue.mainID=2,o.shaderValue.ALPHA=h.ALPHA,this._submits[this._submits._length++]=o),o._numEle+=6}},s.moveTo=function(e,t,i){void 0===i&&(i=!0);var n=this._getPath();if(i){var a=e,r=t;e=this._curMat.a*a+this._curMat.c*r,t=this._curMat.b*a+this._curMat.d*r}n.addPoint(e,t)},s.lineTo=function(e,t,i){void 0===i&&(i=!0);var n=this._getPath();if(i){var a=e,r=t;e=this._curMat.a*a+this._curMat.c*r,t=this._curMat.b*a+this._curMat.d*r}n.addPoint(e,t)},s.drawCurves=function(e,t,i){this.setPathId(-1),this.beginPath(),this.strokeStyle=i[3],this.lineWidth=i[4];var n=i[2];e+=i[0],t+=i[1],this.movePath(e,t),this.moveTo(n[0],n[1]);for(var a=2,r=n.length;a<r;)this.quadraticCurveTo(n[a++],n[a++],n[a++],n[a++]);this.stroke()},s.arcTo=function(e,i,n,a,r){if(-1==this.mId||!this.mHaveKey){var o=0,s=0,h=0,l=this._getPath();this._curMat.copyTo(t._tmpMatrix),t._tmpMatrix.tx=t._tmpMatrix.ty=0,t._tempPoint.setTo(l.getEndPointX(),l.getEndPointY()),t._tmpMatrix.invertTransformPoint(t._tempPoint);var c=t._tempPoint.x-e,p=t._tempPoint.y-i,u=Math.sqrt(c*c+p*p);if(!(u<=1e-6)){var d=c/u,_=p/u,m=n-e,f=a-i,g=m*m+f*f,y=Math.sqrt(g);if(!(y<=1e-6)){var v=m/y,x=f/y,b=d+v,w=_+x,S=Math.sqrt(b*b+w*w);if(!(S<=1e-6)){var I=b/S,M=w/S,C=Math.acos(I*d+M*_),k=Math.PI/2-C,E=(u=r/Math.tan(k))*d+e,T=u*_+i,L=Math.sqrt(u*u+r*r),D=e+I*L,N=i+M*L,A=0,R=0,B=0;if(d*x-_*v>=0){var P=(A=2*k)/t.SEGNUM;R=Math.sin(P),B=Math.cos(P)}else P=(A=2*-k)/t.SEGNUM,R=Math.sin(P),B=Math.cos(P);s=this._curMat.a*E+this._curMat.c*T,h=this._curMat.b*E+this._curMat.d*T,s==this._path.getEndPointX()&&h==this._path.getEndPointY()||l.addPoint(s,h);var O=E-D,V=T-N;for(o=0;o<t.SEGNUM;o++){var U=O*B+V*R,F=-O*R+V*B;s=U+D,h=F+N,e=this._curMat.a*s+this._curMat.c*h,h=i=this._curMat.b*s+this._curMat.d*h,(s=e)==this._path.getEndPointX()&&h==this._path.getEndPointY()||l.addPoint(s,h),O=U,V=F}}}}}},s.arc=function(e,t,i,n,a,r,o){if(void 0===r&&(r=!1),void 0===o&&(o=!0),-1!=this.mId){var s=P.getInstance().shapeDic[this.mId];if(s&&this.mHaveKey&&!s.needUpdate(this._curMat))return;e=0,t=0}var h=0,l=0,c=0,p=0,u=0,d=0,_=0,m=0;if(l=a-n,r)if(Math.abs(l)>=2*Math.PI)l=2*-Math.PI;else for(;l>0;)l-=2*Math.PI;else if(Math.abs(l)>=2*Math.PI)l=2*Math.PI;else for(;l<0;)l+=2*Math.PI;c=l/(m=i<101?Math.max(10,l*i/5):i<201?Math.max(10,l*i/20):Math.max(10,l*i/40))/2,p=Math.abs(4/3*(1-Math.cos(c))/Math.sin(c)),r&&(p=-p);var f=this._getPath(),g=NaN,y=NaN;for(_=0;_<=m;_++)h=n+l*(_/m),u=e+Math.cos(h)*i,d=t+Math.sin(h)*i,o&&(g=u,y=d,u=this._curMat.a*g+this._curMat.c*y,d=this._curMat.b*g+this._curMat.d*y),u==this._path.getEndPointX()&&d==this._path.getEndPointY()||f.addPoint(u,d);u=e+Math.cos(a)*i,d=t+Math.sin(a)*i,o&&(g=u,y=d,u=this._curMat.a*g+this._curMat.c*y,d=this._curMat.b*g+this._curMat.d*y),u==this._path.getEndPointX()&&d==this._path.getEndPointY()||f.addPoint(u,d)},s.quadraticCurveTo=function(e,t,i,n){var a=h.I,r=i,o=n;i=this._curMat.a*r+this._curMat.c*o,n=this._curMat.b*r+this._curMat.d*o,r=e,o=t,e=this._curMat.a*r+this._curMat.c*o,t=this._curMat.b*r+this._curMat.d*o;for(var s=a.getBezierPoints([this._path.getEndPointX(),this._path.getEndPointY(),e,t,i,n],30,2),l=0,c=s.length/2;l<c;l++)this.lineTo(s[2*l],s[2*l+1],!1);this.lineTo(i,n,!1)},s.rect=function(e,t,i,n){this._other=this._other.make(),this._other.path||(this._other.path=new Y),this._other.path.rect(e,t,i,n)},s.strokeRect=function(e,t,i,n,a){var r=.5*a;this.line(e-r,t,e+i+r,t,a,this._curMat),this.line(e+i,t,e+i,t+n,a,this._curMat),this.line(e,t,e,t+n,a,this._curMat),this.line(e-r,t+n,e+i+r,t+n,a,this._curMat)},s.clip=function(){},s.drawPoly=function(e,t,i,n,a,r,o){void 0===o&&(o=!1),this._renderKey=0,this._shader2D.glTexture=null;var s=this._getPath();if(-1==this.mId)s.polygon(e,t,i,n,a||1,r);else if(this.mHaveKey){var h=P.getInstance().shapeDic[this.mId];h.setMatrix(this._curMat),h.rebuild(s.tempArray),s.setGeomtry(h)}else{var l=s.polygon(e,t,i,n,a||1,r);P.getInstance().addShape(this.mId,l),l.setMatrix(this._curMat)}s.update();var c,p=[this.mX,this.mY];if(c=re.createShape(this,s.ib,s.vb,s.count,s.offset,Ie.create(4,0)),c.shaderValue.ALPHA=this._shader2D.ALPHA,c.shaderValue.u_pos=p,c.shaderValue.u_mmat2=ye.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=c,a>0){if(this.mHaveLineKey){var u=P.getInstance().shapeLineDic[this.mId];u.rebuild(s.tempArray),s.setGeomtry(u)}else P.getInstance().addShape(this.mId,s.drawLine(e,t,i,a,r));s.update(),(c=re.createShape(this,s.ib,s.vb,s.count,s.offset,Ie.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,c.shaderValue.u_mmat2=ye.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=c}},s.drawParticle=function(e,t,i){i.x=e,i.y=t,this._submits[this._submits._length++]=i},s._getPath=function(){return this._path||(this._path=new Y)},r(0,s,"globalCompositeOperation",function(){return z.NAMES[this._nBlendType]},function(e){var t=z.TOINT[e];null==t||this._nBlendType===t||(G.save(this,65536,this,!0),this._curSubmit=re.RENDERBASE,this._renderKey=0,this._nBlendType=t)}),r(0,s,"strokeStyle",function(){return this._shader2D.strokeStyle},function(e){this._shader2D.strokeStyle.equal(e)||(G.save(this,512,this._shader2D,!1),this._shader2D.strokeStyle=X.create(e))}),r(0,s,"globalAlpha",function(){return this._shader2D.ALPHA},function(e){(e=Math.floor(1e3*e)/1e3)!=this._shader2D.ALPHA&&(G.save(this,1,this._shader2D,!0),this._shader2D.ALPHA=e)}),r(0,s,"asBitmap",null,function(e){if(e){if(this._targets||(this._targets=new Z),this._targets.repaint=!0,!this._width||!this._height)throw Error("asBitmap no size!");this._targets.setSP(this.sprite),this._targets.size(this._width,this._height)}else this._targets=null}),r(0,s,"fillStyle",function(){return this._shader2D.fillStyle},function(e){this._shader2D.fillStyle.equal(e)||(G.save(this,2,this._shader2D,!1),this._shader2D.fillStyle=X.create(e))}),r(0,s,"textAlign",function(){return this._other.textAlign},function(e){this._other.textAlign===e||(this._other=this._other.make(),G.save(this,32768,this._other,!1),this._other.textAlign=e)}),r(0,s,"lineWidth",function(){return this._other.lineWidth},function(e){this._other.lineWidth===e||(this._other=this._other.make(),G.save(this,256,this._other,!1),this._other.lineWidth=e)}),r(0,s,"textBaseline",function(){return this._other.textBaseline},function(e){this._other.textBaseline===e||(this._other=this._other.make(),G.save(this,16384,this._other,!1),this._other.textBaseline=e)}),r(0,s,"font",null,function(e){e!=this._other.font.toString()&&(this._other=this._other.make(),G.save(this,8,this._other,!1),this._other.font===_e.EMPTY?this._other.font=new _e(e):this._other.font.setFont(e))}),t.__init__=function(){o.DEFAULT=new o},t._tempPoint=new b,t._SUBMITVBSIZE=32e3,t._MAXSIZE=99999999,t._RECTVBSIZE=16,t.MAXCLIPRECT=new w(0,0,99999999,99999999),t._COUNT=0,t._tmpMatrix=new x,t.SEGNUM=32,t._contextcount=0,n(t,["_fontTemp",function(){return this._fontTemp=new _e},"_drawStyleTemp",function(){return this._drawStyleTemp=new X(null)}]),t.__init$=function(){o=function(){function e(){this.lineWidth=1,this.path=null,this.textAlign=null,this.textBaseline=null,this.font=_e.EMPTY}a(e,"");var t=e.prototype;return t.clear=function(){this.lineWidth=1,this.path&&this.path.clear(),this.textAlign=this.textBaseline=null,this.font=_e.EMPTY},t.make=function(){return this===e.DEFAULT?new e:this},e.DEFAULT=null,e}()},t}(),Ie=function(e){function t(e,i){this.size=[0,0],this.alpha=1,this.ALPHA=1,this.subID=0,this._cacheID=0,t.__super.call(this),this.defines=new Ee,this.position=t._POSITION,this.mainID=e,this.subID=i,this.textureHost=null,this.texture=null,this.fillStyle=null,this.color=null,this.strokeStyle=null,this.colorAdd=null,this.glTexture=null,this.u_mmat2=null,this._cacheID=e|i,this._inClassCache=t._cache[this._cacheID],e>0&&!this._inClassCache&&(this._inClassCache=t._cache[this._cacheID]=[],this._inClassCache._length=0),this.clear()}a(t,"laya.webgl.shader.d2.value.Value2D",V);var i=t.prototype;return i.setValue=function(e){},i.refresh=function(){var e=this.size;return e[0]=ye.width,e[1]=ye.height,this.alpha=this.ALPHA*ye.worldAlpha,this.mmat=ye.worldMatrix4,this},i._ShaderWithCompile=function(){return qe.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID|this.defines._value,Ze.create)},i._withWorldShaderDefines=function(){var e=ye.worldShaderDefines,t=qe.sharders[this.mainID|this.defines._value|e.getValue()];if(!t){var i,n,a={};i=this.defines.toNameDic();for(n in i)a[n]="";i=e.toNameDic();for(n in i)a[n]="";t=qe.withCompile2D(0,this.mainID,a,this.mainID|this.defines._value|e.getValue(),Ze.create)}var r=ye.worldFilters;if(!r)return t;for(var o,s=r.length,h=0;h<s;h++)(o=r[h])&&o.action.setValue(this);return t},i.upload=function(){var e=ye;this.alpha=this.ALPHA*e.worldAlpha,ye.worldMatrix4!==ye.TEMPMAT4_ARRAY&&this.defines.add(128),xe.shaderHighPrecision&&this.defines.add(1024);var t,i=e.worldShaderDefines?this._withWorldShaderDefines():qe.sharders[this.mainID|this.defines._value]||this._ShaderWithCompile();this.size[0]=e.width,this.size[1]=e.height,this.mmat=e.worldMatrix4,Be.activeShader!==i?(i._shaderValueWidth!==e.width||i._shaderValueHeight!==e.height?(i._shaderValueWidth=e.width,i._shaderValueHeight=e.height):t=i._params2dQuick2||i._make2dQuick2(),i.upload(this,t)):(i._shaderValueWidth!==e.width||i._shaderValueHeight!==e.height?(i._shaderValueWidth=e.width,i._shaderValueHeight=e.height):t=i._params2dQuick1||i._make2dQuick1(),i.upload(this,t))},i.setFilters=function(e){if(this.filters=e,e)for(var t,i=e.length,n=0;n<i;n++)(t=e[n])&&(this.defines.add(t.type),t.action.setValue(this))},i.clear=function(){this.defines.setValue(this.subID)},i.release=function(){this._inClassCache[this._inClassCache._length++]=this,this.fillStyle=null,this.strokeStyle=null,this.clear()},t._initone=function(e,i){t._typeClass[e]=i,t._cache[e]=[],t._cache[e]._length=0},t.__init__=function(){t._POSITION=[2,5126,!1,4*me.BYTES_PE,0],t._TEXCOORD=[2,5126,!1,4*me.BYTES_PE,2*me.BYTES_PE],t._initone(2,Ue),t._initone(4,ze),t._initone(256,Fe),t._initone(512,Ve),t._initone(1,He),t._initone(65,Je),t._initone(9,He)},t.create=function(e,i){var n=t._cache[e|i];return n._length?n[--n._length]:new t._typeClass[e|i](i)},t._POSITION=null,t._TEXCOORD=null,t._cache=[],t._typeClass=[],t.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],t}(),Me=function(e){function t(e,i){t.__super.call(this,e,i)}a(t,"laya.webgl.utils.RenderSprite3D",I);var i=t.prototype;return i.onCreate=function(e){switch(e){case 8:return void(this._fun=this._blend);case 4:return void(this._fun=this._transform)}},i._mask=function(e,i,n,a){var r,o,s=this._next,h=e.mask;if(h){i.ctx.save();var l=i.ctx.globalCompositeOperation,c=new w;if(c.copyFrom(h.getBounds()),c.width=Math.round(c.width),c.height=Math.round(c.height),c.x=Math.round(c.x),c.y=Math.round(c.y),c.width>0&&c.height>0){var p=e._style._tf,u=se.create();u.addValue("bounds",c),r=oe.create([u,i],laya.webgl.utils.RenderSprite3D.tmpTarget),i.addRenderObject(r),h.render(i,-c.x,-c.y),r=oe.create([u],laya.webgl.utils.RenderSprite3D.endTmpTarget),i.addRenderObject(r),i.ctx.save(),i.clipRect(n-p.translateX+c.x,a-p.translateY+c.y,c.width,c.height),s._fun.call(s,e,i,n,a),i.ctx.restore(),o=ce.create(6),l=i.ctx.globalCompositeOperation,o.blendMode="mask",i.addRenderObject(o),x.TEMP.identity();var d=Ie.create(1,0),_=R.INV_UV,m=c.width,f=c.height;(c.width<32||c.height<32)&&((_=t.tempUV)[0]=0,_[1]=0,_[2]=c.width>=32?1:c.width/32,_[3]=0,_[4]=c.width>=32?1:c.width/32,_[5]=c.height>=32?1:c.height/32,_[6]=0,_[7]=c.height>=32?1:c.height/32,c.width=c.width>=32?c.width:32,c.height=c.height>=32?c.height:32,_[1]*=-1,_[3]*=-1,_[5]*=-1,_[7]*=-1,_[1]+=1,_[3]+=1,_[5]+=1,_[7]+=1),i.ctx.drawTarget(u,n+c.x-p.translateX,a+c.y-p.translateY,m,f,x.TEMP,"tmpTarget",d,_,6),r=oe.create([u],laya.webgl.utils.RenderSprite3D.recycleTarget),i.addRenderObject(r),(o=ce.create(6)).blendMode=l,i.addRenderObject(o)}i.ctx.restore()}else s._fun.call(s,e,i,n,a)},i._blend=function(e,t,i,n){var a=e._style,r=this._next;a.blendMode?(t.ctx.save(),t.ctx.globalCompositeOperation=a.blendMode,r._fun.call(r,e,t,i,n),t.ctx.restore()):r._fun.call(r,e,t,i,n)},i._transform=function(e,t,i,n){var a=e.transform,r=this._next;if(a&&r!=I.NORENDER){var o=t.ctx;e._style;a.tx=i,a.ty=n;var s=o._getTransformMatrix(),h=s.clone();x.mul(a,s,s),s._checkTransform(),a.tx=a.ty=0,r._fun.call(r,e,t,0,0),h.copyTo(s),h.destroy()}else r._fun.call(r,e,t,i,n)},t.tmpTarget=function(e,t){var i=e.getValue("bounds"),n=Pe.create(i.width,i.height);n.start(),n.clear(0,0,0,0),e.addValue("tmpTarget",n)},t.endTmpTarget=function(e){e.getValue("tmpTarget").end()},t.recycleTarget=function(e){e.getValue("tmpTarget").recycle(),e.recycle()},n(t,["tempUV",function(){return this.tempUV=new Array(8)}]),t}(),Ce=function(e){function t(){this.data=null,t.__super.call(this)}a(t,"laya.filters.webgl.ColorFilterActionGL",O);var n=t.prototype;return i.imps(n,{"laya.filters.IFilterActionGL":!0}),n.setValue=function(e){e.colorMat=this.data._mat,e.colorAlpha=this.data._alpha},n.apply3d=function(e,t,i,n,a){var r=e.getValue("bounds"),o=Ie.create(1,0);o.setFilters([this.data]);var s=x.TEMP;s.identity(),i.ctx.drawTarget(e,0,0,r.width,r.height,s,"src",o)},t}(),ke=function(e){function t(e,i,n,a,r){this._atlasCanvas=null,this._inAtlasTextureKey=null,this._inAtlasTextureBitmapValue=null,this._inAtlasTextureOriUVValue=null,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue=null,t.__super.call(this,e,i,r),this._inAtlasTextureKey=[],this._inAtlasTextureBitmapValue=[],this._inAtlasTextureOriUVValue=[],this._InAtlasWebGLImagesKey={},this._InAtlasWebGLImagesOffsetValue=[],this._atlasCanvas=new Xe,this._atlasCanvas._atlaser=this,this._atlasCanvas.width=n,this._atlasCanvas.height=a,this._atlasCanvas.activeResource(),this._atlasCanvas.lock=!0}a(t,"laya.webgl.atlas.Atlaser",U);var i=t.prototype;return i.computeUVinAtlasTexture=function(e,t,i,n){var a=F.atlasTextureWidth,r=F.atlasTextureHeight,o=i/a,s=n/r,h=(i+e.bitmap.width)/a,l=(n+e.bitmap.height)/r,c=e.bitmap.width/a,p=e.bitmap.height/r;e.uv=[o+t[0]*c,s+t[1]*p,h-(1-t[2])*c,s+t[3]*p,h-(1-t[4])*c,l-(1-t[5])*p,o+t[6]*c,l-(1-t[7])*p]},i.findBitmapIsExist=function(e){if(e instanceof laya.webgl.resource.WebGLImage){var t=e,i=t.url,n=this._InAtlasWebGLImagesKey[i||t.id];if(n)return n.offsetInfoID}return-1},i.addToAtlasTexture=function(e,t,i){if(e instanceof laya.webgl.resource.WebGLImage){var n=e,a=n.url;this._InAtlasWebGLImagesKey[a||n.id]={bitmap:e,offsetInfoID:this._InAtlasWebGLImagesOffsetValue.length},this._InAtlasWebGLImagesOffsetValue.push([t,i])}this._atlasCanvas.texSubImage2D(t,i,e.atlasSource),e.clearAtlasSource()},i.addToAtlas=function(e,t,i){e._atlasID=this._inAtlasTextureKey.length;var n=e.uv.slice(),a=e.bitmap;this._inAtlasTextureKey.push(e),this._inAtlasTextureOriUVValue.push(n),this._inAtlasTextureBitmapValue.push(a),this.computeUVinAtlasTexture(e,n,t,i),e.bitmap=this._atlasCanvas},i.clear=function(){for(var e=0,t=this._inAtlasTextureKey.length;e<t;e++)this._inAtlasTextureKey[e].bitmap=this._inAtlasTextureBitmapValue[e],this._inAtlasTextureKey[e].uv=this._inAtlasTextureOriUVValue[e],this._inAtlasTextureKey[e]._atlasID=-1,this._inAtlasTextureKey[e].bitmap.lock=!1,this._inAtlasTextureKey[e].bitmap.releaseResource();this._inAtlasTextureKey.length=0,this._inAtlasTextureBitmapValue.length=0,this._inAtlasTextureOriUVValue.length=0,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue.length=0},i.dispose=function(){this.clear(),this._atlasCanvas.destroy()},r(0,i,"InAtlasWebGLImagesOffsetValue",function(){return this._InAtlasWebGLImagesOffsetValue}),r(0,i,"texture",function(){return this._atlasCanvas}),r(0,i,"inAtlasWebGLImagesKey",function(){return this._InAtlasWebGLImagesKey}),t}(),Ee=function(e){function t(){t.__super.call(this,t.__name2int,t.__int2name,t.__int2nameMap)}return a(t,"laya.webgl.shader.d2.ShaderDefines2D",$),t.__init__=function(){t.reg("TEXTURE2D",1),t.reg("COLOR2D",2),t.reg("PRIMITIVE",4),t.reg("GLOW_FILTER",8),t.reg("BLUR_FILTER",16),t.reg("COLOR_FILTER",32),t.reg("COLOR_ADD",64),t.reg("WORLDMAT",128),t.reg("FILLTEXTURE",256),t.reg("FSHIGHPRECISION",1024)},t.reg=function(e,i){$._reg(e,i,t.__name2int,t.__int2name)},t.toText=function(e,t,i){return $._toText(e,t,i)},t.toInt=function(e){return $._toInt(e,t.__name2int)},t.TEXTURE2D=1,t.COLOR2D=2,t.PRIMITIVE=4,t.FILTERGLOW=8,t.FILTERBLUR=16,t.FILTERCOLOR=32,t.COLORADD=64,t.WORLDMAT=128,t.FILLTEXTURE=256,t.SKINMESH=512,t.SHADERDEFINE_FSHIGHPRECISION=1024,t.__name2int={},t.__int2name=[],t.__int2nameMap=[],t}(),Te=(function(e){function t(e,i,n,a,r,o,s){t.__super.call(this,e,i,n,a,40,r,o,s)}a(t,"laya.webgl.shapes.Ellipse",ie)}(),function(e){function t(e,i,n,a,r){this._points=[],this.rebuild(n),t.__super.call(this,e,i,0,0,0,r,a,r,0)}a(t,"laya.webgl.shapes.Line",ie);var i=t.prototype;return i.rebuild=function(e){var t=e.length;t!=this._points.length&&(this.mUint16Array=new Uint16Array(6*(t/2-1)),this.mFloat32Array=new Float32Array(5*t)),this._points.length=0;for(var i=NaN,n=NaN,a=-1,r=-1,o=e.length/2,s=0;s<o;s++)i=e[2*s],n=e[2*s+1],(Math.abs(a-i)>.01||Math.abs(r-n)>.01)&&this._points.push(i,n),a=i,r=n},i.getData=function(e,t,i){var n=[],a=[];this.borderWidth>0&&this.createLine2(this._points,n,this.borderWidth,i,a,this._points.length/2),this.mUint16Array.set(n,0),this.mFloat32Array.set(a,0),e.append(this.mUint16Array),t.append(this.mFloat32Array)},t}()),Le=function(e){function t(e,i,n,a,r){this._points=[];for(var o=NaN,s=NaN,h=-1,l=-1,c=n.length/2-1,p=0;p<c;p++)o=n[2*p],s=n[2*p+1],(Math.abs(h-o)>.01||Math.abs(l-s)>.01)&&this._points.push(o,s),h=o,l=s;o=n[2*c],s=n[2*c+1],h=this._points[0],l=this._points[1],(Math.abs(h-o)>.01||Math.abs(l-s)>.01)&&this._points.push(o,s),t.__super.call(this,e,i,0,0,this._points.length/2,0,a,r)}a(t,"laya.webgl.shapes.LoopLine",ie);var i=t.prototype;return i.getData=function(e,t,i){if(this.borderWidth>0){for(var n=this.color,a=(n>>16&255)/255,r=(n>>8&255)/255,o=(255&n)/255,s=[],h=0,l=0,c=[],p=Math.floor(this._points.length/2),u=0;u<p;u++)h=this._points[2*u],l=this._points[2*u+1],s.push(this.x+h,this.y+l,a,r,o);this.createLoopLine(s,c,this.borderWidth,i+s.length/5),e.append(new Uint16Array(c)),t.append(new Float32Array(s))}},i.createLoopLine=function(e,t,i,n,a,r){e.length;var o=e.concat(),s=a||e,h=this.borderColor,l=(h>>16&255)/255,c=(h>>8&255)/255,p=(255&h)/255,u=[o[0],o[1]],d=[o[o.length-5],o[o.length-4]],_=d[0]+.5*(u[0]-d[0]),m=d[1]+.5*(u[1]-d[1]);o.unshift(_,m,0,0,0),o.push(_,m,0,0,0);var f,g,y,v,x,b,w,S,I,M,C,k,E,T,L,D,N,A,R,B,P=o.length/5,O=n,V=i/2;y=o[0],v=o[1],M=y-(x=o[5]),I=(I=-(v-(b=o[6])))/(B=Math.sqrt(I*I+M*M))*V,M=M/B*V,s.push(y-I,v-M,l,c,p,y+I,v+M,l,c,p);for(var U=1;U<P-1;U++)y=o[5*(U-1)],v=o[5*(U-1)+1],x=o[5*U],b=o[5*U+1],w=o[5*(U+1)],S=o[5*(U+1)+1],M=y-x,k=x-w,L=(-(I=(I=-(v-b))/(B=Math.sqrt(I*I+M*M))*V)+y)*(-(M=M/B*V)+b)-(-I+x)*(-M+v),A=(-(C=(C=-(b-S))/(B=Math.sqrt(C*C+k*k))*V)+w)*(-(k=k/B*V)+b)-(-C+x)*(-k+S),R=(E=-M+v-(-M+b))*(N=-C+x-(-C+w))-(D=-k+S-(-k+b))*(T=-I+x-(-I+y)),Math.abs(R)<.1?(R+=10.1,s.push(x-I,b-M,l,c,p,x+I,b+M,l,c,p)):(((f=(T*A-N*L)/R)-x)*(f-x)+((g=(D*L-E*A)/R)-b)+(g-b),s.push(f,g,l,c,p,x-(f-x),b-(g-b),l,c,p));r&&(t=r);var F=this.edges+1;for(U=1;U<F;U++)t.push(O+2*(U-1),O+2*(U-1)+1,O+2*U+1,O+2*U+1,O+2*U,O+2*(U-1));return t.push(O+2*(U-1),O+2*(U-1)+1,O+1,O+1,O,O+2*(U-1)),s},t}(),De=function(e){function t(e,i,n,a,r,o){this._points=null,this._start=-1,this._repaint=!1,this.earcutTriangles=null,this._mat=x.create(),this._points=n.slice(0,n.length),t.__super.call(this,e,i,0,0,this._points.length/2,a,r,o)}a(t,"laya.webgl.shapes.Polygon",ie);var i=t.prototype;return i.rebuild=function(e){this._repaint||(this._points.length=0,this._points=this._points.concat(e))},i.setMatrix=function(e){e.copyTo(this._mat)},i.needUpdate=function(e){return this._repaint=this._mat.a==e.a&&this._mat.b==e.b&&this._mat.c==e.c&&this._mat.d==e.d&&this._mat.tx==e.tx&&this._mat.ty==e.ty,!this._repaint},i.getData=function(e,t,i){var n,a=0,r=this._points,o=0;if(this.mUint16Array&&this.mFloat32Array&&this._repaint){if(this._start!=i){for(this._start=i,n=[],o=this.earcutTriangles.length,a=0;a<o;a++)n.push(this.earcutTriangles[a]+i);this.mUint16Array=new Uint16Array(n)}}else{this._start=i,n=[];var s=[],h=[],l=this.color,c=(l>>16&255)/255,p=(l>>8&255)/255,u=(255&l)/255;for(o=Math.floor(r.length/2),a=0;a<o;a++)s.push(this.x+r[2*a],this.y+r[2*a+1],c,p,u),h.push(this.x+r[2*a],this.y+r[2*a+1]);for(this.earcutTriangles=ne.earcut(h,null,2),o=this.earcutTriangles.length,a=0;a<o;a++)n.push(this.earcutTriangles[a]+i);this.mUint16Array=new Uint16Array(n),this.mFloat32Array=new Float32Array(s)}e.append(this.mUint16Array),t.append(this.mFloat32Array)},t}(),Ne=function(e){function t(){this._matrix=new x,this._matrix4=me.defaultMatrix4.concat(),t.__super.call(this,1e4),this.shaderValue=new Ie(0,0)}a(t,"laya.webgl.submit.SubmitCanvas",re);var i=t.prototype;return i.renderSubmit=function(){if(this._ctx_src._targets)return this._ctx_src._targets.flush(this._ctx_src),1;var e=ye.worldAlpha,t=ye.worldMatrix4,i=ye.worldMatrix,n=ye.worldFilters,a=ye.worldShaderDefines,r=this.shaderValue,o=this._matrix,s=this._matrix4,h=x.TEMP;return x.mul(o,i,h),s[0]=h.a,s[1]=h.b,s[4]=h.c,s[5]=h.d,s[12]=h.tx,s[13]=h.ty,ye.worldMatrix=h.clone(),ye.worldMatrix4=s,ye.worldAlpha=ye.worldAlpha*r.alpha,r.filters&&r.filters.length&&(ye.worldFilters=r.filters,ye.worldShaderDefines=r.defines),this._ctx_src.flush(),ye.worldAlpha=e,ye.worldMatrix4=t,ye.worldMatrix.destroy(),ye.worldMatrix=i,ye.worldFilters=n,ye.worldShaderDefines=a,1},i.releaseRender=function(){var e=t._cache;this._ctx_src=null,e[e._length++]=this},i.getRenderType=function(){return 10003},t.create=function(e,i,n){var a=t._cache._length?t._cache[--t._cache._length]:new t;a._ctx_src=e;var r=a.shaderValue;return r.alpha=i,r.defines.setValue(0),n&&n.length&&r.setFilters(n),a},t._cache=(t._cache=[],t._cache._length=0,t._cache),t}(),Ae=function(e){function t(e){this._preIsSameTextureShader=!1,this._isSameTexture=!0,this._texs=new Array,this._texsID=new Array,this._vbPos=new Array,void 0===e&&(e=1e4),t.__super.call(this,e)}a(t,"laya.webgl.submit.SubmitTexture",re);var i=t.prototype;return i.releaseRender=function(){var e=t._cache;e[e._length++]=this,this.shaderValue.release(),this._preIsSameTextureShader=!1,this._vb=null,this._texs.length=0,this._vbPos.length=0,this._isSameTexture=!0},i.addTexture=function(e,t){this._texsID[this._texs.length]=e._uvID,this._texs.push(e),this._vbPos.push(t)},i.checkTexture=function(){if(this._texs.length<1)this._isSameTexture=!0;else{var e=this.shaderValue.textureHost.bitmap;if(null!==e)for(var t=this._vb.getFloat32Array(),i=0,n=this._texs.length;i<n;i++){var a=this._texs[i];a.active();var r=a.uv;if(this._texsID[i]!==a._uvID){this._texsID[i]=a._uvID;var o=this._vbPos[i];t[o+2]=r[0],t[o+3]=r[1],t[o+6]=r[2],t[o+7]=r[3],t[o+10]=r[4],t[o+11]=r[5],t[o+14]=r[6],t[o+15]=r[7],this._vb.setNeedUpload()}a.bitmap!==e&&(this._isSameTexture=!1)}}},i.renderSubmit=function(){if(0===this._numEle)return t._shaderSet=!1,1;var e=this.shaderValue.textureHost;if(e){var i=e.source;if(!e.bitmap||!i)return t._shaderSet=!1,1;this.shaderValue.texture=i}this._vb.bind_upload(this._ib);var n=xe.mainContext;if(z.activeBlendFunction!==this._blendFn&&(n.enable(3042),this._blendFn(n),z.activeBlendFunction=this._blendFn),L.drawCall++,L.trianglesFaces+=this._numEle/3,this._preIsSameTextureShader&&Be.activeShader&&t._shaderSet?Be.activeShader.uploadTexture2D(this.shaderValue.texture):this.shaderValue.upload(),t._shaderSet=!0,this._texs.length>1&&!this._isSameTexture)for(var a=e.bitmap,r=0,o=Be.activeShader,s=0,h=this._texs.length;s<h;s++){var l=this._texs[s];l.bitmap===a&&s+1!==h||(o.uploadTexture2D(l.source),n.drawElements(4,6*(s-r+1),5123,this._startIdx+6*r*me.BYTES_PIDX),a=l.bitmap,r=s)}else n.drawElements(4,this._numEle,5123,this._startIdx);return 1},t.create=function(e,i,n,a,r){var o=t._cache._length?t._cache[--t._cache._length]:new t;null==n&&((n=o._selfVb||(o._selfVb=$e.create(-1))).clear(),a=0),o._ib=i,o._vb=n,o._startIdx=a*me.BYTES_PIDX,o._numEle=0;var s=e._nBlendType;o._blendFn=e._targets?z.targetFns[s]:z.fns[s],o.shaderValue=r,o.shaderValue.setValue(e._shader2D);var h=e._shader2D.filters;return h&&o.shaderValue.setFilters(h),o},t._cache=(t._cache=[],t._cache._length=0,t._cache),t._shaderSet=!0,t}(),Re=function(e){function t(){t.__super.call(this,laya.webgl.utils.MeshTexture.const_stride,0,0),this.canReuse=!0,this.setAttributes(laya.webgl.utils.MeshTexture._fixattriInfo)}a(t,"laya.webgl.utils.MeshTexture",ge);var i=t.prototype;return i.addData=function(e,i,n,a,r,o){for(var s=e.length/2,h=this._vb.needSize(s*t.const_stride)>>2,l=this._vb.getFloat32Array(),c=0,p=0;p<s;p++){var u=e[c],d=e[c+1],_=u*a.a+d*a.c+a.tx,m=u*a.b+d*a.d+a.ty;l[h++]=_,l[h++]=m,l[h++]=i[c],l[h++]=i[c+1],c+=2}this._vb.setNeedUpload();var f=this.vertNum;if(f>0){(s=n.length)>t.tmpIdx.length&&(t.tmpIdx=new Uint16Array(s));for(var g=0;g<s;g++)t.tmpIdx[g]=n[g]+f;this._ib.appendU16Array(t.tmpIdx,n.length)}else this._ib.append(n);this._ib.setNeedUpload(),this.vertNum+=s,this.indexNum+=n.length},i.releaseMesh=function(){this._vb._byteLength=0,this._ib._byteLength=0,this.vertNum=0,this.indexNum=0,laya.webgl.utils.MeshTexture._POOL.push(this)},i.destroy=function(){this._ib.destroy(),this._vb.destroy()},t.getAMesh=function(){return laya.webgl.utils.MeshTexture._POOL.length?laya.webgl.utils.MeshTexture._POOL.pop():new t},t.const_stride=16,t._POOL=[],n(t,["_fixattriInfo",function(){return this._fixattriInfo=[5126,2,0,5126,2,8]},"tmpIdx",function(){return this.tmpIdx=new Uint16Array(4)}]),t}(),Be=function(e){function t(){t.__super.call(this),this.lock=!0}return a(t,"laya.webgl.shader.BaseShader",M),t.activeShader=null,t.bindShader=null,t}(),Pe=function(e){function t(e,i,n,a,r,o,s,h,l){this._type=0,this._svWidth=NaN,this._svHeight=NaN,this._preRenderTarget=null,this._alreadyResolved=!1,this._looked=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._mipMap=!1,this._repeat=!1,this._minFifter=0,this._magFifter=0,this._destroy=!1,void 0===n&&(n=6408),void 0===a&&(a=5121),void 0===r&&(r=34041),void 0===o&&(o=!1),void 0===s&&(s=!1),void 0===h&&(h=-1),void 0===l&&(l=-1),this._type=1,this._w=e,this._h=i,this._surfaceFormat=n,this._surfaceType=a,this._depthStencilFormat=r,S.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipMap=o,this._repeat=s,this._minFifter=h,this._magFifter=l,this._createWebGLRenderTarget(),this.bitmap.lock=!0,t.__super.call(this,this.bitmap,R.INV_UV)}a(t,"laya.webgl.resource.RenderTarget2D",e);var n=t.prototype;return i.imps(n,{"laya.resource.IDispose":!0}),n.getType=function(){return this._type},n.getTexture=function(){return this},n.size=function(e,t){this._w==e&&this._h==t||(this._w=e,this._h=t,this.release(),0!=this._w&&0!=this._h&&this._createWebGLRenderTarget())},n.release=function(){this.destroy()},n.recycle=function(){t.POOL.push(this)},n.start=function(){var e=xe.mainContext;return this._preRenderTarget=ye.curRenderTarget,ye.curRenderTarget=this,e.bindFramebuffer(36160,this.bitmap.frameBuffer),this._alreadyResolved=!1,1==this._type&&(e.viewport(0,0,this._w,this._h),this._svWidth=ye.width,this._svHeight=ye.height,ye.width=this._w,ye.height=this._h,Be.activeShader=null),this},n.clear=function(e,t,i,n){void 0===e&&(e=0),void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=1);var a=xe.mainContext;a.clearColor(e,t,i,n);var r=16384;switch(this._depthStencilFormat){case 33189:r|=256;break;case 36168:r|=1024;break;case 34041:r|=256,r|=1024}a.clear(r)},n.end=function(){var e=xe.mainContext;e.bindFramebuffer(36160,this._preRenderTarget?this._preRenderTarget.bitmap.frameBuffer:null),this._alreadyResolved=!0,ye.curRenderTarget=this._preRenderTarget,1==this._type?(e.viewport(0,0,this._svWidth,this._svHeight),ye.width=this._svWidth,ye.height=this._svHeight,Be.activeShader=null):e.viewport(0,0,i.stage.width,i.stage.height)},n.getData=function(e,t,i,n){var a=xe.mainContext;a.bindFramebuffer(36160,this.bitmap.frameBuffer);if(!(36053===a.checkFramebufferStatus(36160)))return a.bindFramebuffer(36160,null),null;var r=new Uint8Array(this._w*this._h*4);return a.readPixels(e,t,i,n,this._surfaceFormat,this._surfaceType,r),a.bindFramebuffer(36160,null),r},n.destroy=function(t){void 0===t&&(t=!1),this._destroy||(this._loaded=!1,this.bitmap.offAll(),this.bitmap.disposeResource(),this.bitmap.dispose(),this.offAll(),this.bitmap=null,this._alreadyResolved=!1,this._destroy=!0,e.prototype.destroy.call(this))},n.dispose=function(){},n._createWebGLRenderTarget=function(){this.bitmap=new je(this.width,this.height,this._surfaceFormat,this._surfaceType,this._depthStencilFormat,this._mipMap,this._repeat,this._minFifter,this._magFifter),this.bitmap.activeResource(),this._alreadyResolved=!0,this._destroy=!1,this._loaded=!0,this.bitmap.on("recovered",this,function(e){this.event("recovered")})},r(0,n,"surfaceFormat",function(){return this._surfaceFormat}),r(0,n,"magFifter",function(){return this._magFifter}),r(0,n,"surfaceType",function(){return this._surfaceType}),r(0,n,"mipMap",function(){return this._mipMap}),r(0,n,"depthStencilFormat",function(){return this._depthStencilFormat}),r(0,n,"minFifter",function(){return this._minFifter}),r(0,n,"source",function(){return this._alreadyResolved?i.superGet(R,this,"source"):null}),t.create=function(e,i,n,a,r,o,s,h,l){void 0===n&&(n=6408),void 0===a&&(a=5121),void 0===r&&(r=34041),void 0===o&&(o=!1),void 0===s&&(s=!1),void 0===h&&(h=-1),void 0===l&&(l=-1);var c=t.POOL.pop();return c||(c=new t(e,i)),c.bitmap&&c._w==e&&c._h==i&&c._surfaceFormat==n&&c._surfaceType==a&&c._depthStencilFormat==r&&c._mipMap==o&&c._repeat==s&&c._minFifter==h&&c._magFifter==l||(c._w=e,c._h=i,c._surfaceFormat=n,c._surfaceType=a,c._depthStencilFormat=r,S.isConchWebGL&&34041===c._depthStencilFormat&&(c._depthStencilFormat=33189),c._mipMap=o,c._repeat=s,c._minFifter=h,c._magFifter=l,c.release(),c._createWebGLRenderTarget()),c},t.TYPE2D=1,t.TYPE3D=2,t.POOL=[],t}(R),Oe=function(e){function t(){this._glBuffer=null,this._buffer=null,this._bufferType=0,this._bufferUsage=0,this._byteLength=0,t.__super.call(this),t._gl=xe.mainContext}a(t,"laya.webgl.utils.Buffer",M);var i=t.prototype;return i._bind=function(){this.activeResource(),t._bindActive[this._bufferType]!==this._glBuffer&&(34962===this._bufferType&&(t._bindVertexBuffer=this._glBuffer),t._gl.bindBuffer(this._bufferType,t._bindActive[this._bufferType]=this._glBuffer),Be.activeShader=null)},i.recreateResource=function(){this._glBuffer||(this._glBuffer=t._gl.createBuffer()),this.completeCreate()},i.disposeResource=function(){this._glBuffer&&(xe.mainContext.deleteBuffer(this._glBuffer),this._glBuffer=null),this.memorySize=0},r(0,i,"bufferUsage",function(){return this._bufferUsage}),t._gl=null,t._bindActive={},t._bindVertexBuffer=null,t._enableAtributes=[],t}(),Ve=function(e){function t(e){this.texcoord=null,this.offsetX=300,this.offsetY=0,t.__super.call(this,512,0);var i=8*me.BYTES_PE;this.position=[2,5126,!1,i,0],this.texcoord=[2,5126,!1,i,2*me.BYTES_PE],this.color=[4,5126,!1,i,4*me.BYTES_PE]}return a(t,"laya.webgl.shader.d2.skinAnishader.SkinSV",Ie),t}(),Ue=function(e){function t(e){t.__super.call(this,2,0),this.color=[]}a(t,"laya.webgl.shader.d2.value.Color2dSV",Ie);return t.prototype.setValue=function(e){e.fillStyle&&(this.color=e.fillStyle._color._color),e.strokeStyle&&(this.color=e.strokeStyle._color._color)},t}(),Fe=function(e){function t(e){this.u_colorMatrix=null,this.strength=0,this.colorMat=null,this.colorAlpha=null,this.u_TexRange=[0,1,0,1],this.u_offset=[0,0],this.texcoord=Ie._TEXCOORD,t.__super.call(this,256,0)}a(t,"laya.webgl.shader.d2.value.FillTextureSV",Ie);var i=t.prototype;return i.setValue=function(e){this.ALPHA=e.ALPHA,e.filters&&this.setFilters(e.filters)},i.clear=function(){this.texture=null,this.shader=null,this.defines.setValue(0)},t}(),He=function(e){function t(e){this.u_colorMatrix=null,this.strength=0,this.blurInfo=null,this.colorMat=null,this.colorAlpha=null,this.texcoord=Ie._TEXCOORD,void 0===e&&(e=0),t.__super.call(this,1,e)}a(t,"laya.webgl.shader.d2.value.TextureSV",Ie);var i=t.prototype;return i.setValue=function(e){this.ALPHA=e.ALPHA,e.filters&&this.setFilters(e.filters)},i.clear=function(){this.texture=null,this.shader=null,this.defines.setValue(0)},t}(),ze=function(e){function t(e){this.a_color=null,this.u_pos=[0,0],t.__super.call(this,4,0),this.position=[2,5126,!1,5*me.BYTES_PE,0],this.a_color=[3,5126,!1,5*me.BYTES_PE,2*me.BYTES_PE]}return a(t,"laya.webgl.shader.d2.value.PrimitiveSV",Ie),t}(),Xe=function(e){function t(){this._atlaser=null,this._flashCacheImage=null,this._flashCacheImageNeedFlush=!1,t.__super.call(this)}a(t,"laya.webgl.atlas.AtlasWebGLCanvas",e);var i=t.prototype;return i.recreateResource=function(){var e=xe.mainContext,t=this._source=e.createTexture(),i=be.curBindTexTarget,n=be.curBindTexValue;be.bindTexture(e,3553,t),e.texImage2D(3553,0,6408,this._w,this._h,0,6408,5121,null),e.texParameteri(3553,10241,9729),e.texParameteri(3553,10240,9729),e.texParameteri(3553,10242,33071),e.texParameteri(3553,10243,33071),i&&n&&be.bindTexture(e,i,n),this.memorySize=this._w*this._h*4,this.completeCreate()},i.disposeResource=function(){this._source&&(xe.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},i.texSubImage2D=function(e,t,i){if(S.isFlash){this._flashCacheImage||(this._flashCacheImage=y.create(""),this._flashCacheImage._image.createCanvas(this._w,this._h));var n=i.bitmapdata;this._flashCacheImage._image.copyPixels(n,0,0,n.width,n.height,e,t),this._flashCacheImageNeedFlush||(this._flashCacheImageNeedFlush=!0)}else{var a=xe.mainContext,r=be.curBindTexTarget,o=be.curBindTexValue;be.bindTexture(a,3553,this._source),S.isConchWebGL?(i!==ConchTextCanvas&&(e-1>=0&&a.texSubImage2DEx(!0,3553,0,e-1,t,6408,5121,i),e+1<=this._w&&a.texSubImage2DEx(!0,3553,0,e+1,t,6408,5121,i),t-1>=0&&a.texSubImage2DEx(!0,3553,0,e,t-1,6408,5121,i),t+1<=this._h&&a.texSubImage2DEx(!0,3553,0,e,t+1,6408,5121,i)),a.texSubImage2DEx(!0,3553,0,e,t,6408,5121,i)):(a.pixelStorei(37441,!0),e-1>=0&&a.texSubImage2D(3553,0,e-1,t,6408,5121,i),e+1<=this._w&&a.texSubImage2D(3553,0,e+1,t,6408,5121,i),t-1>=0&&a.texSubImage2D(3553,0,e,t-1,6408,5121,i),t+1<=this._h&&a.texSubImage2D(3553,0,e,t+1,6408,5121,i),a.texSubImage2D(3553,0,e,t,6408,5121,i),a.pixelStorei(37441,!1)),r&&o&&be.bindTexture(a,r,o)}},i.texSubImage2DPixel=function(e,t,i,n,a){var r=xe.mainContext,o=be.curBindTexTarget,s=be.curBindTexValue;be.bindTexture(r,3553,this._source);var h=new Uint8Array(a.data);S.isConchWebGL?r.texSubImage2DEx(!0,3553,0,e,t,i,n,6408,5121,h):(r.pixelStorei(37441,!0),r.texSubImage2D(3553,0,e,t,i,n,6408,5121,h),r.pixelStorei(37441,!1)),o&&s&&be.bindTexture(r,o,s)},r(0,i,"width",e.prototype._$get_width,function(e){this._w=e}),r(0,i,"height",e.prototype._$get_height,function(e){this._h=e}),t}(l),Ye=function(e){function t(){this.flipY=!0,this.alwaysChange=!1,t.__super.call(this)}a(t,"laya.webgl.resource.WebGLCanvas",l);var i=t.prototype;return i.getCanvas=function(){return this._canvas},i.clear=function(){this._ctx&&this._ctx.clear()},i.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null},i._setContext=function(e){this._ctx=e},i.getContext=function(e,i){return this._ctx?this._ctx:this._ctx=t._createContext(this)},i.size=function(e,t){this._w==e&&this._h==t||(this._w=e,this._h=t,this._ctx&&this._ctx.size(e,t),this._canvas&&(this._canvas.height=t,this._canvas.width=e))},i.activeResource=function(e){void 0===e&&(e=!1),this._source||this.recreateResource()},i.recreateResource=function(){this.createWebGlTexture(),this.completeCreate()},i.disposeResource=function(){this._source&&!this.iscpuSource&&(xe.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},i.createWebGlTexture=function(){var e=xe.mainContext;this._canvas;var i=this._source=e.createTexture();this.iscpuSource=!1;var n=be.curBindTexTarget,a=be.curBindTexValue;be.bindTexture(e,3553,i),e.pixelStorei(37440,this.flipY?1:0),S.isConchWebGL?e.texImage2DEx(t.premulAlpha,3553,0,6408,6408,5121,this._imgData):(t.premulAlpha&&e.pixelStorei(37441,!0),e.texImage2D(3553,0,6408,6408,5121,this._imgData),t.premulAlpha&&e.pixelStorei(37441,!1)),e.texParameteri(3553,10240,9729),e.texParameteri(3553,10241,9729),e.texParameteri(3553,10242,33071),e.texParameteri(3553,10243,33071),e.pixelStorei(37440,0),this.memorySize=this._w*this._h*4,n&&a&&be.bindTexture(e,n,a)},i.reloadCanvasData=function(){var e=xe.mainContext;if(!this._source)throw"reloadCanvasData error, gl texture not created!";var i=be.curBindTexTarget,n=be.curBindTexValue;be.bindTexture(e,3553,this._source),S.isConchWebGL?e.texImage2DEx(t.premulAlpha,3553,0,6408,6408,5121,this._imgData):(t.premulAlpha&&e.pixelStorei(37441,!0),e.texImage2D(3553,0,6408,6408,5121,this._imgData),t.premulAlpha&&e.pixelStorei(37441,!1)),e.pixelStorei(37440,0),i&&n&&be.bindTexture(e,i,n)},i.texSubImage2D=function(e,t,i){var n=xe.mainContext,a=be.curBindTexTarget,r=be.curBindTexValue;be.bindTexture(n,3553,this._source),S.isConchWebGL?n.texSubImage2DEx(!0,3553,0,t,i,6408,5121,e._source):(n.pixelStorei(37441,!0),n.texSubImage2D(3553,0,t,i,6408,5121,e._source),n.pixelStorei(37441,!1)),a&&r&&be.bindTexture(n,a,r)},i.toBase64=function(e,t,i){var n=null;this._canvas&&(n=this._canvas.toDataURL(e,t)),i.call(this,n)},r(0,i,"context",function(){return this._ctx}),r(0,i,"source",function(){return this.alwaysChange&&this.reloadCanvasData(),this._source}),r(0,i,"asBitmap",null,function(e){this._ctx&&(this._ctx.asBitmap=e)}),t._createContext=null,t.premulAlpha=!1,t}(),Ge=function(e){function t(e,i){this.CborderSize=12,t.__super.call(this),this.char=e,this.isSpace=" "===e,this.xs=i.scaleX,this.ys=i.scaleY,this.font=i.font.toString(),this.fontSize=i.font.size,this.fillColor=i.fillColor,this.borderColor=i.borderColor,this.lineWidth=i.lineWidth,this.underLine=i.underLine;var n,a=S.isConchApp;a?((n=ConchTextCanvas)._source=ConchTextCanvas,n._source.canvas=ConchTextCanvas):n=c.canvas.source,this.canvas=n,this._enableMerageInAtlas=!0,this._ctx=a?n:this.canvas.getContext("2d",void 0);var r=B.measureText(this.char,this.font);this.cw=r.width*this.xs,this.ch=(r.height||this.fontSize)*this.ys,this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.texture=new R(this)}a(t,"laya.webgl.resource.WebGLCharImage",l);var n=t.prototype;return i.imps(n,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),n.active=function(){this.texture.active()},n.recreateResource=function(){var e=S.isConchApp;if(this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.canvas&&(this.canvas.height=this._h,this.canvas.width=this._w),e){var t=this.fontSize;1==this.xs&&1==this.ys||(t=parseInt(t*(this.xs>this.ys?this.xs:this.ys)+""));var i="normal 100 "+t+"px Arial";this.borderColor&&(i+=" 1 "+this.borderColor),this._ctx.font=i,this._ctx.textBaseline="top",this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,this.CborderSize,this.CborderSize,null,null,null)}else{if(this._ctx.save(),this._ctx.clearRect(0,0,this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this._ctx.font=this.font,A.RightToLeft&&(this._ctx.textAlign="end"),this._ctx.textBaseline="top",this._ctx.translate(this.CborderSize,this.CborderSize),1==this.xs&&1==this.ys||this._ctx.scale(this.xs,this.ys),this.fillColor&&this.borderColor?(this._ctx.strokeStyle=this.borderColor,this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null),this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,0,0,null,null,null)):-1===this.lineWidth?(this._ctx.fillStyle=this.fillColor?this.fillColor:"white",this._ctx.fillText(this.char,0,0,null,null,null)):(this._ctx.strokeStyle=this.borderColor?this.borderColor:"white",this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null)),this.underLine){this._ctx.lineWidth=1,this._ctx.strokeStyle=this.fillColor,this._ctx.beginPath(),this._ctx.moveTo(0,this.fontSize+1);var n=this._ctx.measureText(this.char).width+1;this._ctx.lineTo(n,this.fontSize+1),this._ctx.stroke()}this._ctx.restore()}this.borderSize=this.CborderSize,this.completeCreate()},n.onresize=function(e,t){this._w=e,this._h=t,this._allowMerageInAtlas=!0},n.clearAtlasSource=function(){},r(0,n,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),r(0,n,"atlasSource",function(){return this.canvas}),r(0,n,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(e){this._enableMerageInAtlas=e}),t.createOneChar=function(e,i){return new t(e,i)},t}(),je=function(e){function t(e,i,n,a,r,o,s,h,l){void 0===n&&(n=6408),void 0===a&&(a=5121),void 0===r&&(r=34041),void 0===o&&(o=!1),void 0===s&&(s=!1),void 0===h&&(h=-1),void 0===l&&(l=1),t.__super.call(this),this._w=e,this._h=i,this._surfaceFormat=n,this._surfaceType=a,this._depthStencilFormat=r,S.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipMap=o,this._repeat=s,this._minFifter=h,this._magFifter=l}a(t,"laya.webgl.resource.WebGLRenderTarget",l);var i=t.prototype;return i.recreateResource=function(){var e=xe.mainContext;this._frameBuffer||(this._frameBuffer=e.createFramebuffer()),this._source||(this._source=e.createTexture());var t=be.curBindTexTarget,i=be.curBindTexValue;be.bindTexture(e,3553,this._source),e.texImage2D(3553,0,6408,this._w,this._h,0,this._surfaceFormat,this._surfaceType,null);var n=this._minFifter,a=this._magFifter,r=this._repeat?10497:33071,o=s.isPOT(this._w,this._h);if(o?(this._mipMap?-1!==n||(n=9987):-1!==n||(n=9729),-1!==a||(a=9729),e.texParameteri(3553,10241,n),e.texParameteri(3553,10240,a),e.texParameteri(3553,10242,r),e.texParameteri(3553,10243,r),this._mipMap&&e.generateMipmap(3553)):(-1!==n||(n=9729),-1!==a||(a=9729),e.texParameteri(3553,10241,n),e.texParameteri(3553,10240,a),e.texParameteri(3553,10242,33071),e.texParameteri(3553,10243,33071)),e.bindFramebuffer(36160,this._frameBuffer),e.framebufferTexture2D(36160,36064,3553,this._source,0),this._depthStencilFormat)switch(this._depthStencilBuffer||(this._depthStencilBuffer=e.createRenderbuffer()),e.bindRenderbuffer(36161,this._depthStencilBuffer),e.renderbufferStorage(36161,this._depthStencilFormat,this._w,this._h),this._depthStencilFormat){case 33189:e.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:e.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:e.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}e.bindFramebuffer(36160,null),t&&i&&be.bindTexture(e,t,i),e.bindRenderbuffer(36161,null),o&&this._mipMap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this.completeCreate()},i.disposeResource=function(){this._frameBuffer&&(xe.mainContext.deleteTexture(this._source),xe.mainContext.deleteFramebuffer(this._frameBuffer),xe.mainContext.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0)},r(0,i,"depthStencilBuffer",function(){return this._depthStencilBuffer}),r(0,i,"frameBuffer",function(){return this._frameBuffer}),t}(),We=function(e){function t(e,i,n,a,r,o,s){this.offsetX=0,this.offsetY=0,t.__super.call(this),this.repeat=!0,this.mipmap=!1,this.minFifter=-1,this.magFifter=-1,this.atlasImage=o,this.canvas=e,this._ctx=e.getContext("2d",void 0),this._w=a,this._h=r,this.offsetX=i,this.offsetY=n,this.src=s,this._enableMerageInAtlas=!0,F.enabled&&this._w<F.atlasLimitWidth&&this._h<F.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}a(t,"laya.webgl.resource.WebGLSubImage",l);var n=t.prototype;return i.imps(n,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),n.size=function(e,t){this._w=e,this._h=t,this._ctx&&this._ctx.size(e,t),this.canvas&&(this.canvas.height=t,this.canvas.width=e)},n.recreateResource=function(){this.size(this._w,this._h),this._ctx.drawImage(this.atlasImage,this.offsetX,this.offsetY,this._w,this._h,0,0,this._w,this._h),this._allowMerageInAtlas&&this._enableMerageInAtlas?this.memorySize=0:this.createWebGlTexture(),this.completeCreate()},n.createWebGlTexture=function(){var e=xe.mainContext;if(!this.canvas)throw"create GLTextur err:no data:"+this.canvas;var t=this._source=e.createTexture(),i=be.curBindTexTarget,n=be.curBindTexValue;be.bindTexture(e,3553,t),S.isConchWebGL?e.texImage2DEx(!0,3553,0,6408,6408,5121,this.canvas):(e.pixelStorei(37441,!0),e.texImage2D(3553,0,6408,6408,5121,this.canvas),e.pixelStorei(37441,!1));var a=this.minFifter,r=this.magFifter,o=this.repeat?10497:33071,h=s.isPOT(this.width,this.height);h?(this.mipmap?-1!==a||(a=9987):-1!==a||(a=9729),-1!==r||(r=9729),e.texParameteri(3553,10240,r),e.texParameteri(3553,10241,a),e.texParameteri(3553,10242,o),e.texParameteri(3553,10243,o),this.mipmap&&e.generateMipmap(3553)):(-1!==a||(a=9729),-1!==r||(r=9729),e.texParameteri(3553,10241,a),e.texParameteri(3553,10240,r),e.texParameteri(3553,10242,33071),e.texParameteri(3553,10243,33071)),i&&n&&be.bindTexture(e,i,n),this.canvas=null,h&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4},n.disposeResource=function(){F.enabled&&this._allowMerageInAtlas||!this._source||(xe.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},n.clearAtlasSource=function(){},r(0,n,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),r(0,n,"atlasSource",function(){return this.canvas}),r(0,n,"enableMerageInAtlas",function(){return this._allowMerageInAtlas},function(e){this._allowMerageInAtlas=e}),t}(),qe=function(e){function t(e,i,n,a){if(this._curActTexIndex=0,this.tag={},this._program=null,this._params=null,this._paramsMap={},this._offset=0,t.__super.call(this),!e||!i)throw"Shader Error";this._id=++t._count,this._vs=e,this._ps=i,this._nameMap=a||{},null!=n&&(t.sharders[n]=this)}a(t,"laya.webgl.shader.Shader",Be);var i=t.prototype;return i.recreateResource=function(){this._compile(),this.completeCreate(),this.memorySize=0},i.disposeResource=function(){xe.mainContext.deleteShader(this._vshader),xe.mainContext.deleteShader(this._pshader),xe.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._params=null,this._paramsMap={},this.memorySize=0,this._curActTexIndex=0},i._compile=function(){if(this._vs&&this._ps&&!this._params){this._reCompile=!0,this._params=[];var e=[this._vs,this._ps],i=xe.mainContext;if(this._program=i.createProgram(),this._vshader=t._createShader(i,e[0],35633),this._pshader=t._createShader(i,e[1],35632),i.attachShader(this._program,this._vshader),i.attachShader(this._program,this._pshader),i.linkProgram(this._program),!S.isConchApp&&!i.getProgramParameter(this._program,35714))throw i.getProgramInfoLog(this._program);var n,a=0,r=0,o=0;for(o=S.isConchApp?i.getProgramParameterEx(this._vs,this._ps,"",35721):i.getProgramParameter(this._program,35721),a=0;a<o;a++){var s=null;n={vartype:"attribute",glfun:null,ivartype:0,attrib:s=S.isConchApp?i.getActiveAttribEx(this._vs,this._ps,"",a):i.getActiveAttrib(this._program,a),location:i.getAttribLocation(this._program,s.name),name:s.name,type:s.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._params.push(n)}var h=0;for(h=S.isConchApp?i.getProgramParameterEx(this._vs,this._ps,"",35718):i.getProgramParameter(this._program,35718),a=0;a<h;a++){var l=null;l=S.isConchApp?i.getActiveUniformEx(this._vs,this._ps,"",a):i.getActiveUniform(this._program,a),(n={vartype:"uniform",glfun:null,ivartype:1,attrib:s,location:i.getUniformLocation(this._program,l.name),name:l.name,type:l.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")>0&&(n.name=n.name.substr(0,n.name.length-3),n.isArray=!0,n.location=i.getUniformLocation(this._program,n.name)),this._params.push(n)}for(a=0,r=this._params.length;a<r;a++)if(n=this._params[a],n.indexOfParams=a,n.index=1,n.value=[n.location,null],n.codename=n.name,n.name=this._nameMap[n.codename]?this._nameMap[n.codename]:n.codename,this._paramsMap[n.name]=n,n._this=this,n.uploadedValue=[],"attribute"!==n.vartype)switch(n.type){case 5124:n.fun=n.isArray?this._uniform1iv:this._uniform1i;break;case 5126:n.fun=n.isArray?this._uniform1fv:this._uniform1f;break;case 35664:n.fun=n.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:n.fun=n.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:n.fun=n.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:n.fun=this._uniform_sampler2D;break;case 35680:n.fun=this._uniform_samplerCube;break;case 35676:n.glfun=i.uniformMatrix4fv,n.fun=this._uniformMatrix4fv;break;case 35670:n.fun=this._uniform1i;break;case 35674:case 35675:default:throw new Error("compile shader err!")}else n.fun=this._attribute}},i.getUniform=function(e){return this._paramsMap[e]},i._attribute=function(e,t){var i=xe.mainContext,n=Oe._enableAtributes,a=e.location;return n[a]||i.enableVertexAttribArray(a),i.vertexAttribPointer(a,t[0],t[1],t[2],t[3],t[4]+this._offset),n[a]=Oe._bindVertexBuffer,1},i._uniform1f=function(e,t){var i=e.uploadedValue;return i[0]!==t?(xe.mainContext.uniform1f(e.location,i[0]=t),1):0},i._uniform1fv=function(e,t){if(t.length<4){var i=e.uploadedValue;return i[0]!==t[0]||i[1]!==t[1]||i[2]!==t[2]||i[3]!==t[3]?(xe.mainContext.uniform1fv(e.location,t),i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],1):0}return xe.mainContext.uniform1fv(e.location,t),1},i._uniform_vec2=function(e,t){var i=e.uploadedValue;return i[0]!==t[0]||i[1]!==t[1]?(xe.mainContext.uniform2f(e.location,i[0]=t[0],i[1]=t[1]),1):0},i._uniform_vec2v=function(e,t){if(t.length<2){var i=e.uploadedValue;return i[0]!==t[0]||i[1]!==t[1]||i[2]!==t[2]||i[3]!==t[3]?(xe.mainContext.uniform2fv(e.location,t),i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],1):0}return xe.mainContext.uniform2fv(e.location,t),1},i._uniform_vec3=function(e,t){var i=e.uploadedValue;return i[0]!==t[0]||i[1]!==t[1]||i[2]!==t[2]?(xe.mainContext.uniform3f(e.location,i[0]=t[0],i[1]=t[1],i[2]=t[2]),1):0},i._uniform_vec3v=function(e,t){return xe.mainContext.uniform3fv(e.location,t),1},i._uniform_vec4=function(e,t){var i=e.uploadedValue;return i[0]!==t[0]||i[1]!==t[1]||i[2]!==t[2]||i[3]!==t[3]?(xe.mainContext.uniform4f(e.location,i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3]),1):0},i._uniform_vec4v=function(e,t){return xe.mainContext.uniform4fv(e.location,t),1},i._uniformMatrix2fv=function(e,t){return xe.mainContext.uniformMatrix2fv(e.location,!1,t),1},i._uniformMatrix3fv=function(e,t){return xe.mainContext.uniformMatrix3fv(e.location,!1,t),1},i._uniformMatrix4fv=function(e,t){return xe.mainContext.uniformMatrix4fv(e.location,!1,t),1},i._uniform1i=function(e,t){var i=e.uploadedValue;return i[0]!==t?(xe.mainContext.uniform1i(e.location,i[0]=t),1):0},i._uniform1iv=function(e,t){return xe.mainContext.uniform1iv(e.location,t),1},i._uniform_ivec2=function(e,t){var i=e.uploadedValue;return i[0]!==t[0]||i[1]!==t[1]?(xe.mainContext.uniform2i(e.location,i[0]=t[0],i[1]=t[1]),1):0},i._uniform_ivec2v=function(e,t){return xe.mainContext.uniform2iv(e.location,t),1},i._uniform_vec3i=function(e,t){var i=e.uploadedValue;return i[0]!==t[0]||i[1]!==t[1]||i[2]!==t[2]?(xe.mainContext.uniform3i(e.location,i[0]=t[0],i[1]=t[1],i[2]=t[2]),1):0},i._uniform_vec3vi=function(e,t){return xe.mainContext.uniform3iv(e.location,t),1},i._uniform_vec4i=function(e,t){var i=e.uploadedValue;return i[0]!==t[0]||i[1]!==t[1]||i[2]!==t[2]||i[3]!==t[3]?(xe.mainContext.uniform4i(e.location,i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3]),1):0},i._uniform_vec4vi=function(e,t){return xe.mainContext.uniform4iv(e.location,t),1},i._uniform_sampler2D=function(e,i){var n=xe.mainContext,a=e.uploadedValue;return null==a[0]?(a[0]=this._curActTexIndex,n.uniform1i(e.location,this._curActTexIndex),n.activeTexture(t._TEXTURES[this._curActTexIndex]),be.bindTexture(n,3553,i),this._curActTexIndex++,1):(n.activeTexture(t._TEXTURES[a[0]]),be.bindTexture(n,3553,i),0)},i._uniform_samplerCube=function(e,i){var n=xe.mainContext,a=e.uploadedValue;return null==a[0]?(a[0]=this._curActTexIndex,n.uniform1i(e.location,this._curActTexIndex),n.activeTexture(t._TEXTURES[this._curActTexIndex]),be.bindTexture(n,34067,i),this._curActTexIndex++,1):(n.activeTexture(t._TEXTURES[a[0]]),be.bindTexture(n,34067,i),0)},i._noSetValue=function(e){console.log("no....:"+e.name)},i.uploadOne=function(e,t){this.activeResource(),be.UseProgram(this._program);var i=this._paramsMap[e];i.fun.call(this,i,t)},i.uploadTexture2D=function(e){L.shaderCall++;var t=xe.mainContext;t.activeTexture(33984),be.bindTexture(t,3553,e)},i.upload=function(e,t){Be.activeShader=Be.bindShader=this,this._lastUseFrameCount===L.loopCount||this.activeResource(),be.UseProgram(this._program),this._reCompile?(t=this._params,this._reCompile=!1):t=t||this._params;xe.mainContext;for(var i,n,a=t.length,r=0,o=0;o<a;o++)null!==(n=e[(i=t[o]).name])&&(r+=i.fun.call(this,i,n));L.shaderCall+=r},i.uploadArray=function(e,t,i){Be.activeShader=this,Be.bindShader=this,this.activeResource(),be.UseProgram(this._program);this._params;for(var n,a,r=0,o=t-2;o>=0;o-=2)(a=this._paramsMap[e[o]])&&null!=(n=e[o+1])&&(i&&i[a.name]&&i[a.name].bind(),r+=a.fun.call(this,a,n));L.shaderCall+=r},i.getParams=function(){return this._params},t.getShader=function(e){return t.sharders[e]},t.create=function(e,i,n,a){return new t(e,i,n,a)},t.withCompile=function(e,i,n,a){if(n&&t.sharders[n])return t.sharders[n];var r=t._preCompileShader[2e-4*e];if(!r)throw new Error("withCompile shader err!"+e);return r.createShader(i,n,a)},t.withCompile2D=function(e,i,n,a,r){if(a&&t.sharders[a])return t.sharders[a];var o=t._preCompileShader[2e-4*e+i];if(!o)throw new Error("withCompile shader err!"+e+" "+i);return o.createShader(n,a,r)},t.addInclude=function(e,t){ve.addInclude(e,t)},t.preCompile=function(e,i,n,a){var r=2e-4*e;t._preCompileShader[r]=new ve(r,i,n,a)},t.preCompile2D=function(e,i,n,a,r){var o=2e-4*e+i;t._preCompileShader[o]=new ve(o,n,a,r)},t._createShader=function(e,t,i){var n=e.createShader(i);return e.shaderSource(n,t),e.compileShader(n),n},t._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,,33991,33992],t._count=0,t._preCompileShader={},t.SHADERNAME2ID=2e-4,t.sharders=(t.sharders=[],t.sharders.length=32,t.sharders),n(t,["nameKey",function(){return this.nameKey=new D}]),t}(),Ke=function(e){function t(){this._maxsize=0,this._upload=!0,this._uploadSize=0,t.__super.call(this),this.lock=!0}a(t,"laya.webgl.utils.Buffer2D",e);var i=t.prototype;return i.needSize=function(e){var t=this._byteLength;if(e){var i=this._byteLength+e;i<=this._buffer.byteLength||this._resizeBuffer(i<<1,!0),this._byteLength=i}return t},i._bufferData=function(){this._maxsize=Math.max(this._maxsize,this._byteLength),L.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,Oe._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),Oe._gl.bufferSubData(this._bufferType,0,this._buffer)},i._bufferSubData=function(e,t,i){if(void 0===e&&(e=0),void 0===t&&(t=0),void 0===i&&(i=0),this._maxsize=Math.max(this._maxsize,this._byteLength),L.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,Oe._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),t||i){var n=this._buffer.slice(t,i);Oe._gl.bufferSubData(this._bufferType,e,n)}else Oe._gl.bufferSubData(this._bufferType,e,this._buffer)},i._checkArrayUse=function(){},i._bind_upload=function(){return!!this._upload&&(this._upload=!1,this._bind(),this._bufferData(),!0)},i._bind_subUpload=function(e,t,i){return void 0===e&&(e=0),void 0===t&&(t=0),void 0===i&&(i=0),!!this._upload&&(this._upload=!1,this._bind(),this._bufferSubData(e,t,i),!0)},i._resizeBuffer=function(e,t){if(e<this._buffer.byteLength)return this;if(this.memorySize=e,t&&this._buffer&&this._buffer.byteLength>0){var i=new ArrayBuffer(e);new Uint8Array(i).set(new Uint8Array(this._buffer),0),this._buffer=i}else this._buffer=new ArrayBuffer(e);return this._checkArrayUse(),this._upload=!0,this},i.append=function(e){this._upload=!0;var t,i=0;i=e.byteLength,e instanceof Uint8Array?(this._resizeBuffer(this._byteLength+i,!0),t=new Uint8Array(this._buffer,this._byteLength)):e instanceof Uint16Array?(this._resizeBuffer(this._byteLength+i,!0),t=new Uint16Array(this._buffer,this._byteLength)):e instanceof Float32Array&&(this._resizeBuffer(this._byteLength+i,!0),t=new Float32Array(this._buffer,this._byteLength)),t.set(e,0),this._byteLength+=i,this._checkArrayUse()},i.appendU16Array=function(e,t){this._resizeBuffer(this._byteLength+2*t,!0);for(var i=new Uint16Array(this._buffer,this._byteLength,t),n=0;n<t;n++)i[n]=e[n];this._byteLength+=2*t,this._checkArrayUse()},i.appendEx=function(e,t){this._upload=!0;var i=0;i=e.byteLength,this._resizeBuffer(this._byteLength+i,!0),new t(this._buffer,this._byteLength).set(e,0),this._byteLength+=i,this._checkArrayUse()},i.appendEx2=function(e,t,i,n){void 0===n&&(n=1),this._upload=!0;var a,r=0;r=i*n,this._resizeBuffer(this._byteLength+r,!0),a=new t(this._buffer,this._byteLength);var o=0;for(o=0;o<i;o++)a[o]=e[o];this._byteLength+=r,this._checkArrayUse()},i.getBuffer=function(){return this._buffer},i.setNeedUpload=function(){this._upload=!0},i.getNeedUpload=function(){return this._upload},i.upload=function(){var e=this._bind_upload();return Oe._gl.bindBuffer(this._bufferType,null),Oe._bindActive[this._bufferType]=null,Be.activeShader=null,e},i.subUpload=function(e,t,i){void 0===e&&(e=0),void 0===t&&(t=0),void 0===i&&(i=0);var n=this._bind_subUpload();return Oe._gl.bindBuffer(this._bufferType,null),Oe._bindActive[this._bufferType]=null,Be.activeShader=null,n},i.disposeResource=function(){e.prototype.disposeResource.call(this),this._upload=!0,this._uploadSize=0},i.clear=function(){this._byteLength=0,this._upload=!0},r(0,i,"bufferLength",function(){return this._buffer.byteLength}),r(0,i,"byteLength",null,function(e){this._byteLength!==e&&(e<=this._buffer.byteLength||this._resizeBuffer(2*e+256,!0),this._byteLength=e)}),t.__int__=function(e){Qe.QuadrangleIB=Qe.create(35044),fe.fillIBQuadrangle(Qe.QuadrangleIB,16)},t.FLOAT32=4,t.SHORT=2,t}(Oe),Je=(function(e){function t(e){this.u_blurX=!1,this.u_color=null,this.u_offset=null,this.u_strength=NaN,this.u_texW=0,this.u_texH=0,t.__super.call(this,9)}a(t,"laya.webgl.shader.d2.value.GlowSV",e);var i=t.prototype;i.setValue=function(t){e.prototype.setValue.call(this,t)},i.clear=function(){e.prototype.clear.call(this)}}(He),function(e){function t(e){t.__super.call(this,64),this.defines.add(64)}a(t,"laya.webgl.shader.d2.value.TextSV",e);var i=t.prototype;return i.release=function(){t.pool[t._length++]=this,this.clear()},i.clear=function(){e.prototype.clear.call(this)},t.create=function(){return t._length?t.pool[--t._length]:new t(null)},t.pool=[],t._length=0,t}(He)),Ze=function(e){function t(e,i,n,a){this._params2dQuick1=null,this._params2dQuick2=null,this._shaderValueWidth=NaN,this._shaderValueHeight=NaN,t.__super.call(this,e,i,n,a)}a(t,"laya.webgl.shader.d2.Shader2X",e);var i=t.prototype;return i.upload2dQuick1=function(e){this.upload(e,this._params2dQuick1||this._make2dQuick1())},i._make2dQuick1=function(){if(!this._params2dQuick1){this.activeResource(),this._params2dQuick1=[];for(var e,t=this._params,i=0,n=t.length;i<n;i++)e=t[i],(S.isFlash||"size"!==e.name&&"position"!==e.name&&"texcoord"!==e.name)&&this._params2dQuick1.push(e)}return this._params2dQuick1},i.disposeResource=function(){e.prototype.disposeResource.call(this),this._params2dQuick1=null,this._params2dQuick2=null},i.upload2dQuick2=function(e){this.upload(e,this._params2dQuick2||this._make2dQuick2())},i._make2dQuick2=function(){if(!this._params2dQuick2){this.activeResource(),this._params2dQuick2=[];for(var e,t=this._params,i=0,n=t.length;i<n;i++)e=t[i],(S.isFlash||"size"!==e.name)&&this._params2dQuick2.push(e)}return this._params2dQuick2},t.create=function(e,i,n,a){return new t(e,i,n,a)},t}(qe),Qe=function(e){function t(e){this._uint8Array=null,this._uint16Array=null,void 0===e&&(e=35044),t.__super.call(this),this._bufferUsage=e,this._bufferType=34963,S.isFlash||(this._buffer=new ArrayBuffer(8))}a(t,"laya.webgl.utils.IndexBuffer2D",Ke);var i=t.prototype;return i._checkArrayUse=function(){this._uint8Array&&(this._uint8Array=new Uint8Array(this._buffer)),this._uint16Array&&(this._uint16Array=new Uint16Array(this._buffer))},i.getUint8Array=function(){return this._uint8Array||(this._uint8Array=new Uint8Array(this._buffer))},i.getUint16Array=function(){return this._uint16Array||(this._uint16Array=new Uint16Array(this._buffer))},i.destory=function(){this._uint16Array=null,this._uint8Array=null,this._buffer=null},t.QuadrangleIB=null,t.create=function(e){return void 0===e&&(e=35044),new t(e)},t}(),$e=function(e){function t(e,i){this._floatArray32=null,this._vertexStride=0,t.__super.call(this),this._vertexStride=e,this._bufferUsage=i,this._bufferType=34962,S.isFlash||(this._buffer=new ArrayBuffer(8)),this.getFloat32Array()}a(t,"laya.webgl.utils.VertexBuffer2D",e);var i=t.prototype;return i.getFloat32Array=function(){return this._floatArray32||(this._floatArray32=new Float32Array(this._buffer))},i.bind=function(e){e&&e._bind(),this._bind()},i.insertData=function(e,t){this.getFloat32Array().set(e,t),this._upload=!0},i.bind_upload=function(e){e._bind_upload()||e._bind(),this._bind_upload()||this._bind()},i._checkArrayUse=function(){this._floatArray32&&(this._floatArray32=new Float32Array(this._buffer))},i.disposeResource=function(){e.prototype.disposeResource.call(this);var t=Oe._enableAtributes;if(!S.isConchWebGL)for(var i=0;i<10;i++)xe.mainContext.disableVertexAttribArray(i),t[i]=null},i.destory=function(){this._byteLength=0,this._upload=!0,this._buffer=null,this._floatArray32=null},r(0,i,"vertexStride",function(){return this._vertexStride}),t.create=function(e,i){return void 0===i&&(i=35048),new t(e,i)},t}(Ke),et=function(e){function t(e,i,n,a){if(this._format=0,this._mipmap=!1,this._allowMerageInAtlas=!1,this._enableMerageInAtlas=!1,this.repeat=!1,this._image=null,this.minFifter=0,this.magFifter=0,void 0===n&&(n=6408),void 0===a&&(a=!0),t.__super.call(this,e,i),this._format=n,this._mipmap=a,this.repeat=!1,this.minFifter=-1,this.magFifter=-1,"string"==typeof e)this._url=e,this._src=e,this._image=new c.window.Image,i&&(i.onload&&(this.onload=i.onload),i.onerror&&(this.onerror=i.onerror),i.onCreate&&i.onCreate(this)),this._image.crossOrigin=e&&0==e.indexOf("data:")?null:"",e&&(this._image.src=e);else if(e instanceof ArrayBuffer){this._src=i,this._url=this._src;var r=new p(e);r.readUTFBytes(4),r.readUTFBytes(2),r.getInt16();r.endian="bigEndian",this._w=r.getInt16(),this._h=r.getInt16();r.getInt16(),r.getInt16();this._image=new Uint8Array(e,r.pos),this._format=xe.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL,F.enabled&&this._w<F.atlasLimitWidth&&this._h<F.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}else this._src=i,this._url=this._src,this._image=e.source||e,this.onresize();this._$5__enableMerageInAtlas=!0}a(t,"laya.webgl.resource.WebGLImage",y);var n=t.prototype;return i.imps(n,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),n._init_=function(e,t){},n._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var e=xe.mainContext,t=this._source=e.createTexture(),i=be.curBindTexTarget,n=be.curBindTexValue;if(be.bindTexture(e,3553,t),S.isConchWebGL)switch(this._format){case 6408:e.texImage2DEx(!0,3553,0,this._format,6408,5121,this._image);break;case xe.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:e.compressedTexImage2D(3553,0,this._format,this._w,this._h,0,this._image)}else{switch(e.pixelStorei(37441,!0),this._format){case 6408:e.texImage2D(3553,0,this._format,6408,5121,this._image);break;case xe.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:e.compressedTexImage2D(3553,0,this._format,this._w,this._h,0,this._image)}e.pixelStorei(37441,!1)}var a=this.minFifter,r=this.magFifter,o=this.repeat?10497:33071,h=s.isPOT(this._w,this._h);h?(this.mipmap?-1!==a||(a=9987):-1!==a||(a=9729),-1!==r||(r=9729),e.texParameteri(3553,10241,a),e.texParameteri(3553,10240,r),e.texParameteri(3553,10242,o),e.texParameteri(3553,10243,o),this.mipmap&&e.generateMipmap(3553)):(-1!==a||(a=9729),-1!==r||(r=9729),e.texParameteri(3553,10241,a),e.texParameteri(3553,10240,r),e.texParameteri(3553,10242,33071),e.texParameteri(3553,10243,33071)),i&&n&&be.bindTexture(e,i,n),this._image.onload=null,this._image=null,h&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this._recreateLock=!1},n.recreateResource=function(){var e=this;if(null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._image){if(this._recreateLock)return;this._allowMerageInAtlas&&this._$5__enableMerageInAtlas?(this.memorySize=0,this._recreateLock=!1):this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0;var t=this;this._image=new c.window.Image,this._image.crossOrigin=0==this._src.indexOf("data:")?null:"",this._image.onload=function(){if(t._needReleaseAgain)return t._needReleaseAgain=!1,t._image.onload=null,void(t._image=null);t._allowMerageInAtlas&&t._enableMerageInAtlas?(e.memorySize=0,e._recreateLock=!1):t._createWebGlTexture(),t.completeCreate()},this._image.src=this._src}},n.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(xe.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0)},n.onresize=function(){this._w=this._image.width,this._h=this._image.height,F.enabled&&this._w<F.atlasLimitWidth&&this._h<F.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1},n.clearAtlasSource=function(){this._image=null},r(0,n,"format",function(){return this._format}),r(0,n,"enableMerageInAtlas",function(){return this._$5__enableMerageInAtlas},function(e){this._$5__enableMerageInAtlas=e}),r(0,n,"mipmap",function(){return this._mipmap}),r(0,n,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),r(0,n,"atlasSource",function(){return this._image}),r(0,n,"onload",null,function(e){var t=this;this._onload=e,this._image&&(this._image.onload=null!=this._onload?function(){t.onresize(),t._onload()}:null)}),r(0,n,"onerror",null,function(e){var t=this;this._onerror=e,this._image&&(this._image.onerror=null!=this._onerror?function(){t._onerror()}:null)}),t}();i.__init([de,U,Se,ve])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});for(var i in Laya){var n=Laya[i];n&&n.__isclass&&(t[i]=n)}}),function(e,t,i){i.un,i.uns;var n=i.static,a=i.class,r=i.getset,o=i.__newvec,s=laya.maths.Bezier,h=laya.utils.Browser,l=laya.utils.Byte,c=(laya.events.Event,laya.events.EventDispatcher),p=laya.display.Graphics,u=laya.resource.HTMLCanvas,d=laya.utils.Handler,_=laya.net.Loader,m=laya.maths.MathUtil,f=laya.maths.Matrix,g=(laya.display.Node,laya.maths.Point,laya.maths.Rectangle),y=laya.renders.Render,v=(laya.renders.RenderContext,laya.resource.Resource),x=laya.utils.RunDriver,b=laya.display.Sprite,w=laya.utils.Stat,S=laya.resource.Texture,I=laya.net.URL,M=laya.utils.Utils,C=function(){function e(){this.nodes=null,this.name=null,this.playTime=NaN,this.bone3DMap=null,this.totalKeyframeDatasLength=0}return a(e,"laya.ani.AnimationContent"),e}(),k=function(){function e(){this.name=null,this.parentIndex=0,this.parent=null,this.keyframeWidth=0,this.lerpType=0,this.interpolationMethod=null,this.childs=null,this.keyFrame=null,this.playTime=NaN,this.extenData=null,this.dataOffset=0}return a(e,"laya.ani.AnimationNodeContent"),e}(),E=function(){function e(){}return a(e,"laya.ani.AnimationParser01"),e.parse=function(e,t){var i=t.__getBuffer(),n=0,a=0,r=0,o=0,s=0,h=0,c=0,p=t.readUTFString();e._aniClassName=p;var u,d=t.readUTFString().split("\n"),_=t.getUint8(),m=t.getUint32(),f=t.getUint32();m>0&&(u=i.slice(m,f));var g=new l(u);for(f>0&&(e._publicExtData=i.slice(f,i.byteLength)),e._useParent=!!t.getUint8(),e._anis.length=_,n=0;n<_;n++){var y=e._anis[n]=new C;y.nodes=new Array;var v=y.name=d[t.getUint16()];e._aniMap[v]=n,y.bone3DMap={},y.playTime=t.getFloat32();var x=y.nodes.length=t.getUint8();for(y.totalKeyframeDatasLength=0,a=0;a<x;a++){var b=y.nodes[a]=new k;b.childs=[];var w=t.getInt16();w>=0&&(b.name=d[w],y.bone3DMap[b.name]=a),b.keyFrame=new Array,b.parentIndex=t.getInt16(),-1==b.parentIndex?b.parent=null:b.parent=y.nodes[b.parentIndex],b.lerpType=t.getUint8();var S=t.getUint32();g.pos=S;var I=b.keyframeWidth=g.getUint16();if(y.totalKeyframeDatasLength+=I,0===b.lerpType||1===b.lerpType)for(b.interpolationMethod=[],b.interpolationMethod.length=I,r=0;r<I;r++)b.interpolationMethod[r]=ie.interpolation[g.getUint8()];null!=b.parent&&b.parent.childs.push(b);var M=t.getUint16();M>0&&(b.extenData=i.slice(t.pos,t.pos+M),t.pos+=M);var E=t.getUint16();b.keyFrame.length=E;var T,L=0;for(r=0,o=E;r<o;r++){if(T=b.keyFrame[r]=new Z,T.duration=t.getFloat32(),T.startTime=L,2===b.lerpType){T.interpolationData=[];var D=t.getUint8(),N=0;switch(N=t.getFloat32()){case 254:for(T.interpolationData.length=I,c=0;c<I;c++)T.interpolationData[c]=0;break;case 255:for(T.interpolationData.length=I,c=0;c<I;c++)T.interpolationData[c]=5;break;default:for(T.interpolationData.push(N),h=1;h<D;h++)T.interpolationData.push(t.getFloat32())}}for(T.data=new Float32Array(I),s=0;s<I;s++)T.data[s]=t.getFloat32(),T.data[s]>-1e-8&&T.data[s]<1e-8&&(T.data[s]=0);L+=T.duration}T.startTime=y.playTime,b.playTime=y.playTime,e._calculateKeyFrame(b,E,I)}}},e}(),T=function(){function e(){}return a(e,"laya.ani.AnimationParser02"),e.READ_DATA=function(){e._DATA.offset=e._reader.getUint32(),e._DATA.size=e._reader.getUint32()},e.READ_BLOCK=function(){for(var t=e._BLOCK.count=e._reader.getUint16(),i=e._BLOCK.blockStarts=[],n=e._BLOCK.blockLengths=[],a=0;a<t;a++)i.push(e._reader.getUint32()),n.push(e._reader.getUint32())},e.READ_STRINGS=function(){var t=e._reader.getUint32(),i=e._reader.getUint16(),n=e._reader.pos;e._reader.pos=t+e._DATA.offset;for(var a=0;a<i;a++)e._strings[a]=e._reader.readUTFString();e._reader.pos=n},e.parse=function(t,i){e._templet=t,e._reader=i;i.__getBuffer();e.READ_DATA(),e.READ_BLOCK(),e.READ_STRINGS();for(var n=0,a=e._BLOCK.count;n<a;n++){var r=i.getUint16(),o=e._strings[r],s=e["READ_"+o];if(null==s)throw new Error("model file err,no this function:"+r+" "+o);s.call()}},e.READ_ANIMATIONS=function(){var t=e._reader,i=t.__getBuffer(),n=0,a=0,r=0,o=0,s=t.getUint16(),h=[];for(h.length=s,n=0;n<s;n++)h[n]=ie.interpolation[t.getByte()];var l=t.getUint8();for(e._templet._anis.length=l,n=0;n<l;n++){var c=e._templet._anis[n]={};c.nodes=new Array;var p=c.name=e._strings[t.getUint16()];e._templet._aniMap[p]=n,c.bone3DMap={},c.playTime=t.getFloat32();var u=c.nodes.length=t.getInt16();for(c.totalKeyframeDatasLength=0,a=0;a<u;a++){var d=c.nodes[a]={};d.keyframeWidth=s,d.childs=[];var _=t.getUint16();_>=0&&(d.name=e._strings[_],c.bone3DMap[d.name]=a),d.keyFrame=new Array,d.parentIndex=t.getInt16(),-1==d.parentIndex?d.parent=null:d.parent=c.nodes[d.parentIndex],c.totalKeyframeDatasLength+=s,d.interpolationMethod=h,null!=d.parent&&d.parent.childs.push(d);var m=t.getUint16();d.keyFrame.length=m;var f=null,g=null;for(r=0,o=m;r<o;r++){(f=d.keyFrame[r]={}).startTime=t.getFloat32(),g&&(g.duration=f.startTime-g.startTime);var y=e._DATA.offset,v=t.getUint32(),x=4*s,b=i.slice(y+v,y+v+x);f.data=new Float32Array(b),g=f}f.duration=0,d.playTime=c.playTime,e._templet._calculateKeyFrame(d,m,s)}}},e._templet=null,e._reader=null,e._strings=[],n(e,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),e}(),L=(function(){function e(){}a(e,"laya.ani.AnimationState"),e.stopped=0,e.paused=1,e.playing=2}(),function(){function e(){this.name=null,this.root=null,this.parentBone=null,this.length=10,this.transform=null,this.inheritScale=!0,this.inheritRotation=!0,this.rotation=NaN,this.resultRotation=NaN,this.d=-1,this._tempMatrix=null,this._sprite=null,this.resultTransform=new K,this.resultMatrix=new f,this._children=[]}a(e,"laya.ani.bone.Bone");var t=e.prototype;return t.setTempMatrix=function(e){this._tempMatrix=e;var t=0,i=0;for(t=0,i=this._children.length;t<i;t++)this._children[t].setTempMatrix(this._tempMatrix)},t.update=function(e){this.rotation=this.transform.skX;var t;if(e)t=this.resultTransform.getMatrix(),f.mul(t,e,this.resultMatrix),this.resultRotation=this.rotation;else if(this.resultRotation=this.rotation+this.parentBone.resultRotation,this.parentBone)if(this.inheritRotation&&this.inheritScale)t=this.resultTransform.getMatrix(),f.mul(t,this.parentBone.resultMatrix,this.resultMatrix);else{var i=this.parentBone,n=NaN,a=NaN,r=NaN,o=this.parentBone.resultMatrix;t=this.resultTransform.getMatrix();var s=o.a*t.tx+o.c*t.ty+o.tx,h=o.b*t.tx+o.d*t.ty+o.ty,l=new f;this.inheritRotation?(n=Math.atan2(i.resultMatrix.b,i.resultMatrix.a),a=Math.cos(n),r=Math.sin(n),l.setTo(a,r,-r,a,0,0),f.mul(this._tempMatrix,l,f.TEMP),f.TEMP.copyTo(l),t=this.resultTransform.getMatrix(),f.mul(t,l,this.resultMatrix),this.resultTransform.scX*this.resultTransform.scY<0&&this.resultMatrix.rotate(.5*Math.PI),this.resultMatrix.tx=s,this.resultMatrix.ty=h):(this.inheritScale,t=this.resultTransform.getMatrix(),f.TEMP.identity(),f.TEMP.d=this.d,f.mul(t,f.TEMP,this.resultMatrix),this.resultMatrix.tx=s,this.resultMatrix.ty=h)}else(t=this.resultTransform.getMatrix()).copyTo(this.resultMatrix);var c=0,p=0;for(c=0,p=this._children.length;c<p;c++)this._children[c].update()},t.updateChild=function(){var e=0,t=0;for(e=0,t=this._children.length;e<t;e++)this._children[e].update()},t.setRotation=function(e){this._sprite&&(this._sprite.rotation=180*e/Math.PI)},t.updateDraw=function(t,n){e.ShowBones&&!e.ShowBones[this.name]||(this._sprite?(this._sprite.x=t+this.resultMatrix.tx,this._sprite.y=n+this.resultMatrix.ty):(this._sprite=new b,this._sprite.graphics.drawCircle(0,0,5,"#ff0000"),this._sprite.graphics.drawLine(0,0,this.length,0,"#00ff00"),this._sprite.graphics.fillText(this.name,0,0,"20px Arial","#00ff00","center"),i.stage.addChild(this._sprite),this._sprite.x=t+this.resultMatrix.tx,this._sprite.y=n+this.resultMatrix.ty));var a=0,r=0;for(a=0,r=this._children.length;a<r;a++)this._children[a].updateDraw(t,n)},t.addChild=function(e){this._children.push(e),e.parentBone=this},t.findBone=function(e){if(this.name==e)return this;var t,i,n=0,a=0;for(n=0,a=this._children.length;n<a;n++)if(t=this._children[n],i=t.findBone(e))return i;return null},t.localToWorld=function(e){var t=e[0],i=e[1];e[0]=t*this.resultMatrix.a+i*this.resultMatrix.c+this.resultMatrix.tx,e[1]=t*this.resultMatrix.b+i*this.resultMatrix.d+this.resultMatrix.ty},e.ShowBones={},e}()),D=function(){function e(){this.name=null,this.parent=null,this.attachmentName=null,this.srcDisplayIndex=-1,this.type="src",this.templet=null,this.currSlotData=null,this.currTexture=null,this.currDisplayData=null,this.displayIndex=-1,this._diyTexture=null,this._parentMatrix=null,this._resultMatrix=null,this._replaceDic={},this._curDiyUV=null,this._curDiyVS=null,this._skinSprite=null,this.deformData=null,this._mVerticleArr=null}a(e,"laya.ani.bone.BoneSlot");var t=e.prototype;return t.showSlotData=function(e,t){void 0===t&&(t=!0),this.currSlotData=e,t&&(this.displayIndex=this.srcDisplayIndex),this.currDisplayData=null,this.currTexture=null},t.showDisplayByName=function(e){this.currSlotData&&this.showDisplayByIndex(this.currSlotData.getDisplayByName(e))},t.replaceDisplayByName=function(e,t){if(this.currSlotData){var i=0;i=this.currSlotData.getDisplayByName(e);var n=0;n=this.currSlotData.getDisplayByName(t),this.replaceDisplayByIndex(i,n)}},t.replaceDisplayByIndex=function(e,t){this.currSlotData&&(this._replaceDic[e]=t,this.displayIndex==e&&this.showDisplayByIndex(e))},t.showDisplayByIndex=function(e){if(null!=this._replaceDic[e]&&(e=this._replaceDic[e]),this.currSlotData&&e>-1&&e<this.currSlotData.displayArr.length){if(this.displayIndex=e,this.currDisplayData=this.currSlotData.displayArr[e],this.currDisplayData){var t=this.currDisplayData.name;this.currTexture=this.templet.getTexture(t),this.currTexture&&0==this.currDisplayData.type&&this.currDisplayData.uvs&&(!y.isConchApp||y.isConchApp&&b.RUNTIMEVERION>"0.9.15")&&(this.currTexture=this.currDisplayData.createTexture(this.currTexture))}}else this.displayIndex=-1,this.currDisplayData=null,this.currTexture=null},t.replaceSkin=function(e){this._diyTexture=e,this._curDiyUV&&(this._curDiyUV.length=0),this.currDisplayData&&this._diyTexture==this.currDisplayData.texture&&(this._diyTexture=null)},t.setParentMatrix=function(e){this._parentMatrix=e},t.draw=function(t,i,n,a){if(void 0===n&&(n=!1),void 0===a&&(a=1),(null!=this._diyTexture||null!=this.currTexture)&&null!=this.currDisplayData||this.currDisplayData&&3==this.currDisplayData.type){var r=this.currTexture;this._diyTexture&&(r=this._diyTexture);var o;switch(this.currDisplayData.type){case 0:if(t){var s=this.getDisplayMatrix();if(this._parentMatrix){var h=!1;if(s){f.mul(s,this._parentMatrix,f.TEMP);var l;if(n?(null==this._resultMatrix&&(this._resultMatrix=new f),l=this._resultMatrix):l=new f,!y.isWebGL&&this.currDisplayData.uvs||y.isWebGL&&this._diyTexture&&this.currDisplayData.uvs){var c=e._tempMatrix;c.identity(),this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(c.d=-1),this.currDisplayData.uvs[0]>this.currDisplayData.uvs[4]&&this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(h=!0,c.rotate(-Math.PI/2)),f.mul(c,f.TEMP,l)}else f.TEMP.copyTo(l);h?t.drawTexture(r,-this.currDisplayData.height/2,-this.currDisplayData.width/2,this.currDisplayData.height,this.currDisplayData.width,l):t.drawTexture(r,-this.currDisplayData.width/2,-this.currDisplayData.height/2,this.currDisplayData.width,this.currDisplayData.height,l)}}}break;case 1:if(n?(null==this._skinSprite&&(this._skinSprite=e.createSkinMesh()),o=this._skinSprite):o=e.createSkinMesh(),null==o)return;var p;if(null==this.currDisplayData.bones){var u=this.currDisplayData.weights;this.deformData&&(u=this.deformData);var d;this._diyTexture?(this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=J.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=J.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),d=this._curDiyUV):d=this.currDisplayData.uvs,this._mVerticleArr=u;this.currDisplayData.triangles.length;p=this.currDisplayData.triangles,o.init2(r,null,p,this._mVerticleArr,d);var _=this.getDisplayMatrix();if(this._parentMatrix&&_){f.mul(_,this._parentMatrix,f.TEMP);var m;n?(null==this._resultMatrix&&(this._resultMatrix=new f),m=this._resultMatrix):m=new f,f.TEMP.copyTo(m),o.transform=m}}else this.skinMesh(i,o,a);t.drawSkin(o);break;case 2:if(n?(null==this._skinSprite&&(this._skinSprite=e.createSkinMesh()),o=this._skinSprite):o=e.createSkinMesh(),null==o)return;this.skinMesh(i,o,a),t.drawSkin(o)}}},t.skinMesh=function(e,t,i){var n,a=this.currTexture,r=this.currDisplayData.bones;this._diyTexture?(a=this._diyTexture,this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=J.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=J.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),n=this._curDiyUV):n=this.currDisplayData.uvs;var o,s,h=this.currDisplayData.weights,l=this.currDisplayData.triangles,c=0,p=0,u=0,d=NaN,_=NaN,m=0,f=0,g=[],y=0,v=0;if(this.deformData&&this.deformData.length>0){var x=0;for(y=0,v=r.length;y<v;){for(u=r[y++]+y,c=0,p=0;y<u;y++)s=e[r[y]],d=h[m]+this.deformData[x++],_=h[m+1]+this.deformData[x++],f=h[m+2],c+=(d*s.a+_*s.c+s.tx)*f,p+=(d*s.b+_*s.d+s.ty)*f,m+=3;g.push(c,p)}}else for(y=0,v=r.length;y<v;){for(u=r[y++]+y,c=0,p=0;y<u;y++)s=e[r[y]],d=h[m],_=h[m+1],f=h[m+2],c+=(d*s.a+_*s.c+s.tx)*f,p+=(d*s.b+_*s.d+s.ty)*f,m+=3;g.push(c,p)}this._mVerticleArr=g,o=l,t.init2(a,null,o,this._mVerticleArr,n)},t.drawBonePoint=function(e){e&&this._parentMatrix&&e.drawCircle(this._parentMatrix.tx,this._parentMatrix.ty,5,"#ff0000")},t.getDisplayMatrix=function(){return this.currDisplayData?this.currDisplayData.transform.getMatrix():null},t.getMatrix=function(){return this._resultMatrix},t.copy=function(){var t=new e;return t.type="copy",t.name=this.name,t.attachmentName=this.attachmentName,t.srcDisplayIndex=this.srcDisplayIndex,t.parent=this.parent,t.displayIndex=this.displayIndex,t.templet=this.templet,t.currSlotData=this.currSlotData,t.currTexture=this.currTexture,t.currDisplayData=this.currDisplayData,t},e.createSkinMesh=function(){return y.isWebGL||y.isConchApp?x.skinAniSprite():y.isWebGL?null:ae.useSimpleMeshInCanvas?new ne:new te},n(e,["_tempMatrix",function(){return this._tempMatrix=new f}]),e}(),N=function(){function e(){this.mesh=null,this.transform=null,this.context=null,this.mode=0}a(e,"laya.ani.bone.canvasmesh.CanvasMeshRender");var t=e.prototype;return t.renderToContext=function(e){this.context=e.ctx||e,this.mesh&&(0==this.mode?this._renderWithIndexes(this.mesh):this._renderNoIndexes(this.mesh))},t._renderNoIndexes=function(e){var t=0,i=e.vertices.length/2,n=0;for(t=0;t<i-2;t++)n=2*t,this._renderDrawTriangle(e,n,n+2,n+4)},t._renderWithIndexes=function(e){var t=e.indexes,i=0,n=t.length;for(i=0;i<n;i+=3){var a=2*t[i],r=2*t[i+1],o=2*t[i+2];this._renderDrawTriangle(e,a,r,o)}},t._renderDrawTriangle=function(e,t,i,n){var a=this.context,r=e.uvs,o=e.vertices,s=e.texture,h=s.bitmap,l=h.source,c=s.width,p=s.height,u=h.width,d=h.height,_=NaN,m=NaN,f=NaN,g=NaN,y=NaN,v=NaN;if(e.useUvTransform){var x=e.uvTransform;_=(r[t]*x.a+r[t+1]*x.c+x.tx)*u,m=(r[i]*x.a+r[i+1]*x.c+x.tx)*u,f=(r[n]*x.a+r[n+1]*x.c+x.tx)*u,g=(r[t]*x.b+r[t+1]*x.d+x.ty)*d,y=(r[i]*x.b+r[i+1]*x.d+x.ty)*d,v=(r[n]*x.b+r[n+1]*x.d+x.ty)*d}else _=r[t]*u,m=r[i]*u,f=r[n]*u,g=r[t+1]*d,y=r[i+1]*d,v=r[n+1]*d;var b=o[t],w=o[i],S=o[n],I=o[t+1],M=o[i+1],C=o[n+1];if(e.canvasPadding>0){var k=e.canvasPadding,E=e.canvasPadding,T=(b+w+S)/3,L=(I+M+C)/3,D=b-T,N=I-L,A=Math.sqrt(D*D+N*N);b=T+D/A*(A+k),I=L+N/A*(A+E),N=M-L,w=T+(D=w-T)/(A=Math.sqrt(D*D+N*N))*(A+k),M=L+N/A*(A+E),N=C-L,S=T+(D=S-T)/(A=Math.sqrt(D*D+N*N))*(A+k),C=L+N/A*(A+E)}if(a.save(),this.transform){var R=this.transform;a.transform(R.a,R.b,R.c,R.d,R.tx,R.ty)}a.beginPath(),a.moveTo(b,I),a.lineTo(w,M),a.lineTo(S,C),a.closePath(),a.clip();var B=1/(_*y+g*f+m*v-y*f-g*m-_*v),P=b*y+g*S+w*v-y*S-g*w-b*v,O=_*w+b*f+m*S-w*f-b*m-_*S,V=_*y*S+g*w*f+b*m*v-b*y*f-g*m*S-_*w*v,U=I*y+g*C+M*v-y*C-g*M-I*v,F=_*M+I*f+m*C-M*f-I*m-_*C,H=_*y*C+g*M*f+I*m*v-I*y*f-g*m*C-_*M*v;a.transform(P*B,U*B,O*B,F*B,V*B,H*B),a.drawImage(l,s.uv[0]*u,s.uv[1]*d,c,p,s.uv[0]*u,s.uv[1]*d,c,p),a.restore()},e}(),A=function(){function e(){this.texture=null,this.uvs=[0,0,1,0,1,1,0,1],this.vertices=[0,0,100,0,100,100,0,100],this.indexes=[0,1,3,3,1,2],this.uvTransform=null,this.useUvTransform=!1,this.canvasPadding=1}a(e,"laya.ani.bone.canvasmesh.MeshData");return e.prototype.getBounds=function(){return g._getWrapRec(this.vertices)},e}(),R=function(){function e(){this.skinName=null,this.deformSlotDataList=[]}return a(e,"laya.ani.bone.DeformAniData"),e}(),B=function(){function e(){this.deformSlotDisplayList=[]}return a(e,"laya.ani.bone.DeformSlotData"),e}(),P=function(){function e(){this.boneSlot=null,this.slotIndex=-1,this.attachment=null,this.deformData=null,this.frameIndex=0,this.timeList=[],this.vectices=[],this.tweenKeyList=[]}a(e,"laya.ani.bone.DeformSlotDisplayData");var t=e.prototype;return t.binarySearch1=function(e,t){var i=0,n=e.length-2;if(0==n)return 1;for(var a=n>>>1;;){if(e[Math.floor(a+1)]<=t?i=a+1:n=a,i==n)return i+1;a=i+n>>>1}return 0},t.apply=function(e,t,i){if(void 0===i&&(i=1),e+=.05,!(this.timeList.length<=0)){var n=0;if(!(e<this.timeList[0])){var a=this.vectices[0].length,r=[],o=this.binarySearch1(this.timeList,e);if(this.frameIndex=o,e>=this.timeList[this.timeList.length-1]){var s=this.vectices[this.vectices.length-1];if(i<1)for(n=0;n<a;n++)r[n]+=(s[n]-r[n])*i;else for(n=0;n<a;n++)r[n]=s[n];this.deformData=r}else{this.tweenKeyList[this.frameIndex];var h=this.vectices[this.frameIndex-1],l=this.vectices[this.frameIndex],c=this.timeList[this.frameIndex-1],p=this.timeList[this.frameIndex];i=this.tweenKeyList[o-1]?(e-c)/(p-c):0;var u=NaN;for(n=0;n<a;n++)u=h[n],r[n]=u+(l[n]-u)*i;this.deformData=r}}}},e}(),O=function(){function e(){this.time=NaN,this.drawOrder=[]}return a(e,"laya.ani.bone.DrawOrderData"),e}(),V=function(){function e(){this.name=null,this.intValue=0,this.floatValue=NaN,this.stringValue=null,this.time=NaN}return a(e,"laya.ani.bone.EventData"),e}(),U=function(){function e(e,t){this._targetBone=null,this._bones=null,this._data=null,this.name=null,this.mix=NaN,this.bendDirection=NaN,this.isSpine=!0,this._sp=null,this.isDebug=!1,this._data=e,this._targetBone=t[e.targetBoneIndex],this.isSpine=e.isSpine,null==this._bones&&(this._bones=[]),this._bones.length=0;for(var i=0,n=e.boneIndexs.length;i<n;i++)this._bones.push(t[e.boneIndexs[i]]);this.name=e.name,this.mix=e.mix,this.bendDirection=e.bendDirection}a(e,"laya.ani.bone.IkConstraint");var t=e.prototype;return t.apply=function(){switch(this._bones.length){case 1:this._applyIk1(this._bones[0],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.mix);break;case 2:this.isSpine?this._applyIk2(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix):this._applyIk3(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix)}},t._applyIk1=function(t,i,n,a){var r=t.parentBone,o=1/(r.resultMatrix.a*r.resultMatrix.d-r.resultMatrix.b*r.resultMatrix.c),s=i-r.resultMatrix.tx,h=n-r.resultMatrix.ty,l=(s*r.resultMatrix.d-h*r.resultMatrix.c)*o-t.transform.x,c=(h*r.resultMatrix.a-s*r.resultMatrix.b)*o-t.transform.y,p=Math.atan2(c,l)*e.radDeg-0-t.transform.skX;t.transform.scX<0&&(p+=180),p>180?p-=360:p<-180&&(p+=360),t.transform.skX=t.transform.skY=t.transform.skX+p*a,t.update()},t.updatePos=function(e,t){this._sp&&this._sp.pos(e,t)},t._applyIk2=function(t,n,a,r,o,s){if(0!=s){var h=t.resultTransform.x,l=t.resultTransform.y,c=t.transform.scX,p=t.transform.scY,u=n.transform.scX,d=0,_=0,m=0;c<0?(c=-c,d=180,m=-1):(d=0,m=1),p<0&&(p=-p,m=-m),u<0?(u=-u,_=180):_=0;var f=n.resultTransform.x,g=NaN,y=NaN,v=NaN,x=t.resultMatrix.a,w=t.resultMatrix.c,S=t.resultMatrix.b,I=t.resultMatrix.d,M=Math.abs(c-p)<=1e-4;M?(y=x*f+w*(g=n.resultTransform.y)+t.resultMatrix.tx,v=S*f+I*g+t.resultMatrix.ty):(g=0,y=x*f+t.resultMatrix.tx,v=S*f+t.resultMatrix.ty),this.isDebug&&(this._sp||(this._sp=new b,i.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(a,r,15,"#ffff00"),this._sp.graphics.drawCircle(y,v,15,"#ff00ff")),t.setRotation(Math.atan2(v-t.resultMatrix.ty,y-t.resultMatrix.tx));var C=t.parentBone;x=C.resultMatrix.a,w=C.resultMatrix.c,S=C.resultMatrix.b;var k=1/(x*(I=C.resultMatrix.d)-w*S),E=a-C.resultMatrix.tx,T=r-C.resultMatrix.ty,L=(E*I-T*w)*k-h,D=(T*x-E*S)*k-l,N=((E=y-C.resultMatrix.tx)*I-(T=v-C.resultMatrix.ty)*w)*k-h,A=(T*x-E*S)*k-l,R=Math.sqrt(N*N+A*A),B=n.length*u,P=NaN,O=NaN;if(M){var V=(L*L+D*D-R*R-(B*=c)*B)/(2*R*B);V<-1?V=-1:V>1&&(V=1),O=Math.acos(V)*o,x=R+B*V,w=B*Math.sin(O),P=Math.atan2(D*x-L*w,L*x+D*w)}else{var U=(x=c*B)*x,F=(w=p*B)*w,H=L*L+D*D,z=Math.atan2(D,L),X=-2*F*R,Y=F-U;if((I=X*X-4*Y*(S=F*R*R+U*H-U*F))>0){var G=Math.sqrt(I);X<0&&(G=-G);var j=(G=-(X+G)/2)/Y,W=S/G,q=Math.abs(j)<Math.abs(W)?j:W;q*q<=H&&(T=Math.sqrt(H-q*q)*o,P=z-Math.atan2(T,q),O=Math.atan2(T/p,(q-R)/c))}var K=0,J=Number.MAX_VALUE,Z=0,Q=0,$=0,ee=0,te=0,ie=0;(I=(E=R+x)*E)>ee&&($=0,ee=I,te=E),(I=(E=R-x)*E)<J&&(K=Math.PI,J=I,Z=E);var ne=Math.acos(-x*R/(U-F));(I=(E=x*Math.cos(ne)+R)*E+(T=w*Math.sin(ne))*T)<J&&(K=ne,J=I,Z=E,Q=T),I>ee&&($=ne,ee=I,te=E,ie=T),H<=(J+ee)/2?(P=z-Math.atan2(Q*o,Z),O=K*o):(P=z-Math.atan2(ie*o,te),O=$*o)}var ae=Math.atan2(g,f)*m,re=t.resultTransform.skX;(P=(P-ae)*e.radDeg+d-re)>180?P-=360:P<-180&&(P+=360),t.resultTransform.x=h,t.resultTransform.y=l,t.resultTransform.skX=t.resultTransform.skY=re+P*s,re=n.resultTransform.skX,(O=((O+ae)*e.radDeg-0)*m+_-(re%=360))>180?O-=360:O<-180&&(O+=360),n.resultTransform.x=f,n.resultTransform.y=g,n.resultTransform.skX=n.resultTransform.skY=n.resultTransform.skY+O*s,t.update()}},t._applyIk3=function(t,n,a,r,o,s){if(0!=s){var h=NaN,l=NaN,c=n.resultMatrix.a*n.length,p=n.resultMatrix.b*n.length,u=c*c+p*p,d=Math.sqrt(u),_=t.resultMatrix.tx,m=t.resultMatrix.ty,f=n.resultMatrix.tx,g=n.resultMatrix.ty,y=f-_,v=g-m,x=y*y+v*v,w=Math.sqrt(x),S=(y=a-t.resultMatrix.tx)*y+(v=r-t.resultMatrix.ty)*v,I=Math.sqrt(S);if(d+w<=I||I+d<=w||I+w<=d){var M=NaN;f=_+(M=d+w<=I?1:-1)*(a-_)*w/I,g=m+M*(r-m)*w/I}else{var C=(x-u+S)/(2*S),k=Math.sqrt(x-C*C*S)/I,E=_+y*C,T=m+v*C,L=-v*k,D=y*k;o>0?(f=E-L,g=T-D):(f=E+L,g=T+D)}h=f,l=g,this.isDebug&&(this._sp||(this._sp=new b,i.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(_,m,15,"#ff00ff"),this._sp.graphics.drawCircle(a,r,15,"#ffff00"),this._sp.graphics.drawCircle(h,l,15,"#ff00ff"));var N=NaN;N=Math.atan2(l-t.resultMatrix.ty,h-t.resultMatrix.tx),t.setRotation(N);var A;(A=e._tempMatrix).identity(),A.rotate(N),A.scale(t.resultMatrix.getScaleX(),t.resultMatrix.getScaleY()),A.translate(t.resultMatrix.tx,t.resultMatrix.ty),A.copyTo(t.resultMatrix),t.updateChild();var R=NaN;R=Math.atan2(r-l,a-h),n.setRotation(R);var B;(B=e._tempMatrix).identity(),B.rotate(R),B.scale(n.resultMatrix.getScaleX(),n.resultMatrix.getScaleY()),B.translate(h,l),A.copyTo(n.resultMatrix),n.updateChild()}},n(e,["radDeg",function(){return this.radDeg=180/Math.PI},"degRad",function(){return this.degRad=Math.PI/180},"_tempMatrix",function(){return this._tempMatrix=new f}]),e}(),F=function(){function e(){this.name=null,this.targetBoneName=null,this.bendDirection=1,this.mix=1,this.isSpine=!0,this.targetBoneIndex=-1,this.boneNames=[],this.boneIndexs=[]}return a(e,"laya.ani.bone.IkConstraintData"),e}(),H=function(){function e(){}return a(e,"laya.ani.bone.MeshTools"),e.findEdge=function(e,t,i){void 0===t&&(t=0),void 0===i&&(i=!0);var n=0,a=0,r=0;for(a=e.length,r=-1,n=0;n<a;n+=2)(r<0||i==e[r+t]<e[n+t])&&(r=n);return r},e.findBestTriangle=function(t){var i=0;i=e.findEdge(t,1,!0);var n=0;n=e.findEdge(t,1,!1);var a=0;a=e.findEdge(t,0,!0);var r=0;r=e.findEdge(t,0,!1);var o;return o=e._bestTriangle,o.length=0,o.push(a,r),o.indexOf(i)<0&&o.push(i),o.indexOf(n)<0&&o.push(n),o},e.solveMesh=function(t,i){(i=i||[]).length=0;var n;n=t.uvs;var a;a=t.vertices;var r,o,s=0,h=0,l=0;s=(o=e.findBestTriangle(n))[0],h=o[1],l=o[2],e._absArr.length=0;return e.isNormalUV(t.texture.uv)&&e.adptTexture(t),r=e.solvePoints(t.texture.uv,n[s],n[s+1],n[h]-n[s],n[h+1]-n[s+1],n[l]-n[s],n[l+1]-n[s+1],e._absArr),e.transPoints(r,a[s],a[s+1],a[h]-a[s],a[h+1]-a[s+1],a[l]-a[s],a[l+1]-a[s+1],i)},e.findWrapRect=function(t){var i=0;i=e.findEdge(t,1,!0);var n=0;n=e.findEdge(t,1,!1);var a=0;a=e.findEdge(t,0,!0);var r=0;r=e.findEdge(t,0,!1);var o=NaN;o=t[a];var s=NaN;s=t[r];var h=NaN;h=t[i+1];var l=NaN;return[s,l=t[n+1],o-s,h-l]},e.adptTexture=function(t){var i;i=e.findWrapRect(t.uvs);var n,a,r=(n=t.texture).width,o=n.height;a=S.create(n,i[0]*r,i[1]*o,i[2]*r,i[3]*o),t.texture=a},e.isNormalUV=function(e){return 0==e[0]&&0==e[1]&&1==e[4]&&1==e[5]},e.solvePoints=function(t,i,n,a,r,o,s,h){h=h||[];var l=0,c=0;c=t.length;var p;for(l=0;l<c;l+=2)p=e.solve2(t[l],t[l+1],i,n,a,r,o,s),h.push(p[0],p[1]);return h},e.transPoints=function(t,i,n,a,r,o,s,h){h=h||[];var l=0,c=0;c=t.length;for(l=0;l<c;l+=2)e.transPoint(t[l],t[l+1],i,n,a,r,o,s,h);return h},e.transPoint=function(e,t,i,n,a,r,o,s,h){var l=NaN,c=NaN;return l=i+a*e+o*t,c=n+r*e+s*t,(h=h||[]).push(l,c),h},e.solve2=function(t,i,n,a,r,o,s,h,l,c){void 0===l&&(l=!1),c=c||[];var p=NaN,u=NaN;if(0==r)return e.solve2(t,i,n,a,s,h,r,o,!0,c);var d=NaN,_=NaN;return d=t-n,_=i-a,u=(_-d*o/r)/(h-s*o/r),p=(d-u*s)/r,l?c.push(u,p):c.push(p,u),c},e.solve=function(t,i,n,a){return e.solve2(t.x,t.y,i.x,i.y,n.x,n.y,a.x,a.y)},e._bestTriangle=[],e._absArr=[],e}(),z=function(){function e(e,t){this.target=null,this.data=null,this.bones=null,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this._debugKey=!1,this._spaces=null,this._segments=[],this._curves=[],this.data=e,this.position=e.position,this.spacing=e.spacing,this.rotateMix=e.rotateMix,this.translateMix=e.translateMix,this.bones=[];for(var i=this.data.bones,n=0,a=i.length;n<a;n++)this.bones.push(t[i[n]])}a(e,"laya.ani.bone.PathConstraint");var t=e.prototype;return t.apply=function(e,t){if(this.target){var i=this.translateMix,n=this.translateMix,a=n>0,r=this.data.spacingMode,o="length"==r,s=this.data.rotateMode,h="tangent"==s,l="chainScale"==s,c=[],p=this.bones.length,u=h?p:p+1,d=[];this._spaces=d,d[0]=this.position;var _=this.spacing;if(l||o)for(var m=0,f=u-1;m<f;){var g=this.bones[m],y=g.length,v=y*g.resultMatrix.a,x=y*g.resultMatrix.b;y=Math.sqrt(v*v+x*x),l&&(c[m]=y),d[++m]=o?Math.max(0,y+_):_}else for(m=1;m<u;m++)d[m]=_;var b=this.computeWorldPositions(this.target,e,t,u,h,"percent"==this.data.positionMode,"percent"==r);if(this._debugKey){for(m=0;m<b.length;m++)t.drawCircle(b[m++],b[m++],5,"#00ff00");var w=[];for(m=0;m<b.length;m++)w.push(b[m++],b[m++]);t.drawLines(0,0,w,"#ff0000")}var S=b[0],I=b[1],M=this.data.offsetRotation,C="chain"==s&&0==M,k=NaN;for(m=0,k=3;m<p;m++,k+=3){(g=this.bones[m]).resultMatrix.tx+=(S-g.resultMatrix.tx)*i,g.resultMatrix.ty+=(I-g.resultMatrix.ty)*i;var E=(v=b[k])-S,T=(x=b[k+1])-I;if(l&&0!=(y=c[m])){var L=(Math.sqrt(E*E+T*T)/y-1)*n+1;g.resultMatrix.a*=L,g.resultMatrix.c*=L}if(S=v,I=x,a){var D=g.resultMatrix.a,N=g.resultMatrix.c,A=g.resultMatrix.b,R=g.resultMatrix.d,B=NaN,P=NaN,O=NaN;B=h?b[k-1]:0==d[m+1]?b[k+2]:Math.atan2(T,E),B-=Math.atan2(A,D)-M/180*Math.PI,C&&(P=Math.cos(B),O=Math.sin(B),S+=((y=g.length)*(P*D-O*A)-E)*n,I+=(y*(O*D+P*A)-T)*n),B>Math.PI?B-=2*Math.PI:B<-Math.PI&&(B+=2*Math.PI),B*=n,P=Math.cos(B),O=Math.sin(B),g.resultMatrix.a=P*D-O*A,g.resultMatrix.c=P*N-O*R,g.resultMatrix.b=O*D+P*A,g.resultMatrix.d=O*N+P*R}}}},t.computeWorldVertices2=function(t,i,n,a,r,o){var s,h,l=t.currDisplayData.bones,c=t.currDisplayData.weights,p=t.currDisplayData.triangles,u=0,d=0,_=0,m=0,f=0,g=0,y=0,v=0,x=0,b=0,w=0;if(null!=l){for(u=0;u<n;u+=2)d+=(m=l[d])+1,_+=m;var S=i;for(f=o,g=3*_;f<a;f+=2){for(y=0,v=0,m=l[d++],m+=d;d<m;d++,g+=3){s=S[l[d]].resultMatrix,x=c[g],b=c[g+1];var I=c[g+2];y+=(x*s.a+b*s.c+s.tx)*I,v+=(x*s.b+b*s.d+s.ty)*I}r[f]=y,r[f+1]=v}}else{p||(p=c),t.deformData&&(p=t.deformData);var M;if(M=t.parent,i)for(w=i.length,u=0;u<w;u++)if(i[u].name==M){h=i[u];break}var C;h&&(C=h.resultMatrix),C||(C=e._tempMt);var k=C.tx,E=C.ty,T=C.a,L=C.b,D=C.c,N=C.d;for(h&&(N*=h.d),d=n,f=o;f<a;d+=2,f+=2)x=p[d],b=p[d+1],r[f]=x*T+b*L+k,r[f+1]=-(x*D+b*N+E)}},t.computeWorldPositions=function(e,t,i,n,a,r,o){e.currDisplayData.bones,e.currDisplayData.weights,e.currDisplayData.triangles;var s=[],h=0,l=e.currDisplayData.verLen,c=this.position,p=this._spaces,u=[],d=[],_=l/6,m=-1,f=NaN,g=0,y=0,v=NaN,x=NaN,b=NaN,w=NaN;if(_--,l-=4,this.computeWorldVertices2(e,t,2,l,s,0),this._debugKey)for(h=0;h<s.length;)i.drawCircle(s[h++],s[h++],10,"#ff0000");u=s,this._curves.length=_;var S=this._curves;f=0;var I=u[0],M=u[1],C=0,k=0,E=0,T=0,L=0,D=0,N=NaN,A=NaN,R=NaN,B=NaN,P=NaN,O=NaN,V=NaN,U=NaN,F=0;for(h=0,F=2;h<_;h++,F+=6)C=u[F],k=u[F+1],E=u[F+2],T=u[F+3],P=2*(N=.1875*(I-2*C+E))+(R=.09375*(3*(C-E)-I+(L=u[F+4]))),O=2*(A=.1875*(M-2*k+T))+(B=.09375*(3*(k-T)-M+(D=u[F+5]))),V=.75*(C-I)+N+.16666667*R,U=.75*(k-M)+A+.16666667*B,f+=Math.sqrt(V*V+U*U),V+=P,U+=O,P+=R,O+=B,f+=Math.sqrt(V*V+U*U),V+=P,U+=O,f+=Math.sqrt(V*V+U*U),V+=P+R,U+=O+B,f+=Math.sqrt(V*V+U*U),S[h]=f,I=L,M=D;if(r&&(c*=f),o)for(h=0;h<n;h++)p[h]*=f;var H=this._segments,z=0,X=0;for(h=0,g=0,y=0,X=0;h<n;h++,g+=3)if(x=p[h],c+=x,(v=c)<0)this.addBeforePosition(v,u,0,d,g);else if(v>f)this.addAfterPosition(v-f,u,l-4,d,g);else{for(;;y++)if(w=S[y],!(v>w)){0==y?v/=w:v=(v-(b=S[y-1]))/(w-b);break}if(y!=m){m=y;var Y=6*y;for(I=u[Y],M=u[Y+1],C=u[Y+2],k=u[Y+3],E=u[Y+4],T=u[Y+5],P=2*(N=.03*(I-2*C+E))+(R=.006*(3*(C-E)-I+(L=u[Y+6]))),O=2*(A=.03*(M-2*k+T))+(B=.006*(3*(k-T)-M+(D=u[Y+7]))),V=.3*(C-I)+N+.16666667*R,U=.3*(k-M)+A+.16666667*B,z=Math.sqrt(V*V+U*U),H[0]=z,Y=1;Y<8;Y++)V+=P,U+=O,P+=R,O+=B,z+=Math.sqrt(V*V+U*U),H[Y]=z;V+=P,U+=O,z+=Math.sqrt(V*V+U*U),H[8]=z,V+=P+R,U+=O+B,z+=Math.sqrt(V*V+U*U),H[9]=z,X=0}for(v*=z;;X++)if(w=H[X],!(v>w)){0==X?v/=w:v=X+(v-(b=H[X-1]))/(w-b);break}this.addCurvePosition(.1*v,I,M,C,k,E,T,L,D,d,g,a||h>0&&0==x)}return d},t.addBeforePosition=function(e,t,i,n,a){var r=t[i],o=t[i+1],s=t[i+2]-r,h=t[i+3]-o,l=Math.atan2(h,s);n[a]=r+e*Math.cos(l),n[a+1]=o+e*Math.sin(l),n[a+2]=l},t.addAfterPosition=function(e,t,i,n,a){var r=t[i+2],o=t[i+3],s=r-t[i],h=o-t[i+1],l=Math.atan2(h,s);n[a]=r+e*Math.cos(l),n[a+1]=o+e*Math.sin(l),n[a+2]=l},t.addCurvePosition=function(e,t,i,n,a,r,o,s,h,l,c,p){0==e&&(e=1e-4);var u=e*e,d=u*e,_=1-e,m=_*_,f=m*_,g=_*e,y=3*g,v=_*y,x=y*e,b=t*f+n*v+r*x+s*d,w=i*f+a*v+o*x+h*d;l[c]=b,l[c+1]=w,l[c+2]=p?Math.atan2(w-(i*m+a*g*2+o*u),b-(t*m+n*g*2+r*u)):0},e.NONE=-1,e.BEFORE=-2,e.AFTER=-3,n(e,["_tempMt",function(){return this._tempMt=new f}]),e}(),X=function(){function e(){this.name=null,this.target=null,this.positionMode=null,this.spacingMode=null,this.rotateMode=null,this.offsetRotation=NaN,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this.bones=[]}return a(e,"laya.ani.bone.PathConstraintData"),e}(),Y=function(){function e(){this.name=null,this.slotArr=[]}return a(e,"laya.ani.bone.SkinData"),e}(),G=function(){function e(){this.name=null,this.attachmentName=null,this.type=0,this.transform=null,this.width=NaN,this.height=NaN,this.texture=null,this.bones=null,this.uvs=null,this.weights=null,this.triangles=null,this.vertices=null,this.lengths=null,this.verLen=0}a(e,"laya.ani.bone.SkinSlotDisplayData");var t=e.prototype;return t.createTexture=function(e){return this.texture?this.texture:(this.texture=new S(e.bitmap,this.uvs),this.uvs[0]>this.uvs[4]&&this.uvs[1]>this.uvs[5]?(this.texture.width=e.height,this.texture.height=e.width,this.texture.offsetX=-e.offsetX,this.texture.offsetY=-e.offsetY,this.texture.sourceWidth=e.sourceHeight,this.texture.sourceHeight=e.sourceWidth):(this.texture.width=e.width,this.texture.height=e.height,this.texture.offsetX=-e.offsetX,this.texture.offsetY=-e.offsetY,this.texture.sourceWidth=e.sourceWidth,this.texture.sourceHeight=e.sourceHeight),y.isWebGL||this.uvs[1]>this.uvs[5]&&(this.texture.offsetY=this.texture.sourceHeight-this.texture.height-this.texture.offsetY),this.texture)},t.destory=function(){this.texture&&this.texture.destroy()},e}(),j=function(){function e(){this.name=null,this.displayArr=[]}a(e,"laya.ani.bone.SlotData");return e.prototype.getDisplayByName=function(e){for(var t=0,i=this.displayArr.length;t<i;t++)if(this.displayArr[t].attachmentName==e)return t;return-1},e}(),W=function(){function e(e,t){this._data=null,this._bones=null,this.target=null,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this._temp=o(2,0),this._data=e,null==this._bones&&(this._bones=[]),this.target=t[e.targetIndex];var i=0,n=0;for(i=0,n=e.boneIndexs.length;i<n;i++)this._bones.push(t[e.boneIndexs[i]]);this.rotateMix=e.rotateMix,this.translateMix=e.translateMix,this.scaleMix=e.scaleMix,this.shearMix=e.shearMix}a(e,"laya.ani.bone.TfConstraint");return e.prototype.apply=function(){for(var e,t=this.target.resultMatrix.a,i=this.target.resultMatrix.b,n=this.target.resultMatrix.c,a=this.target.resultMatrix.d,r=0,o=this._bones.length;r<o;r++){if(e=this._bones[r],this.rotateMix>0){var s=e.resultMatrix.a,h=e.resultMatrix.b,l=e.resultMatrix.c,c=e.resultMatrix.d,p=Math.atan2(n,t)-Math.atan2(l,s)+this._data.offsetRotation*Math.PI/180;p>Math.PI?p-=2*Math.PI:p<-Math.PI&&(p+=2*Math.PI),p*=this.rotateMix;var u=Math.cos(p),d=Math.sin(p);e.resultMatrix.a=u*s-d*l,e.resultMatrix.b=u*h-d*c,e.resultMatrix.c=d*s+u*l,e.resultMatrix.d=d*h+u*c}if(this.translateMix&&(this._temp[0]=this._data.offsetX,this._temp[1]=this._data.offsetY,this.target.localToWorld(this._temp),e.resultMatrix.tx+=(this._temp[0]-e.resultMatrix.tx)*this.translateMix,e.resultMatrix.ty+=(this._temp[1]-e.resultMatrix.ty)*this.translateMix,e.updateChild()),this.scaleMix>0){var _=Math.sqrt(e.resultMatrix.a*e.resultMatrix.a+e.resultMatrix.c*e.resultMatrix.c),m=Math.sqrt(t*t+n*n),f=_>1e-5?(_+(m-_+this._data.offsetScaleX)*this.scaleMix)/_:0;e.resultMatrix.a*=f,e.resultMatrix.c*=f,_=Math.sqrt(e.resultMatrix.b*e.resultMatrix.b+e.resultMatrix.d*e.resultMatrix.d),m=Math.sqrt(i*i+a*a),f=_>1e-5?(_+(m-_+this._data.offsetScaleY)*this.scaleMix)/_:0,e.resultMatrix.b*=f,e.resultMatrix.d*=f}if(this.shearMix>0){h=e.resultMatrix.b,c=e.resultMatrix.d;var g=Math.atan2(c,h);(p=Math.atan2(a,i)-Math.atan2(n,t)-(g-Math.atan2(e.resultMatrix.c,e.resultMatrix.a)))>Math.PI?p-=2*Math.PI:p<-Math.PI&&(p+=2*Math.PI),p=g+(p+this._data.offsetShearY*Math.PI/180)*this.shearMix,f=Math.sqrt(h*h+c*c),e.resultMatrix.b=Math.cos(p)*f,e.resultMatrix.d=Math.sin(p)*f}}},e}(),q=function(){function e(){this.name=null,this.targetIndex=0,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this.offsetRotation=NaN,this.offsetX=NaN,this.offsetY=NaN,this.offsetScaleX=NaN,this.offsetScaleY=NaN,this.offsetShearY=NaN,this.boneIndexs=[]}return a(e,"laya.ani.bone.TfConstraintData"),e}(),K=function(){function e(){this.skX=0,this.skY=0,this.scX=1,this.scY=1,this.x=0,this.y=0,this.skewX=0,this.skewY=0,this.mMatrix=null}a(e,"laya.ani.bone.Transform");var t=e.prototype;return t.initData=function(e){void 0!=e.x&&(this.x=e.x),void 0!=e.y&&(this.y=e.y),void 0!=e.skX&&(this.skX=e.skX),void 0!=e.skY&&(this.skY=e.skY),void 0!=e.scX&&(this.scX=e.scX),void 0!=e.scY&&(this.scY=e.scY)},t.getMatrix=function(){var e;return(e=this.mMatrix?this.mMatrix:this.mMatrix=new f).identity(),e.scale(this.scX,this.scY),(this.skewX||this.skewY)&&this.skew(e,this.skewX*Math.PI/180,this.skewY*Math.PI/180),e.rotate(this.skX*Math.PI/180),e.translate(this.x,this.y),e},t.skew=function(e,t,i){var n=Math.sin(i),a=Math.cos(i),r=Math.sin(t),o=Math.cos(t);return e.setTo(e.a*o-e.b*n,e.a*r+e.b*a,e.c*o-e.d*n,e.c*r+e.d*a,e.tx*o-e.ty*n,e.tx*r+e.ty*a),e},e}(),J=function(){function e(){}return a(e,"laya.ani.bone.UVTools"),e.getRelativeUV=function(e,t,i){var n=e[0],a=e[2]-e[0],r=e[1],o=e[5]-e[1];i||(i=[]),i.length=t.length;var s=0,h=0;h=i.length;var l=1/a,c=1/o;for(s=0;s<h;s+=2)i[s]=(t[s]-n)*l,i[s+1]=(t[s+1]-r)*c;return i},e.getAbsoluteUV=function(e,t,i){if(0==e[0]&&0==e[1]&&1==e[4]&&1==e[5])return i?(M.copyArray(i,t),i):t;var n=e[0],a=e[2]-e[0],r=e[1],o=e[5]-e[1];i||(i=[]),i.length=t.length;var s=0,h=0;for(h=i.length,s=0;s<h;s+=2)i[s]=t[s]*a+n,i[s+1]=t[s+1]*o+r;return i},e}(),Z=function(){function e(){this.startTime=NaN,this.duration=NaN,this.interpolationData=null,this.data=null,this.nextData=null}return a(e,"laya.ani.KeyFramesContent"),e}(),Q=function(){function e(){}return a(e,"laya.ani.math.BezierLerp"),e.getBezierRate=function(t,i,n,a,r){var o=e._getBezierParamKey(i,n,a,r),s=100*o+t;if(e._bezierResultCache[s])return e._bezierResultCache[s];var h=e._getBezierPoints(i,n,a,r,o),l=0,c=0;for(c=h.length,l=0;l<c;l+=2)if(t<=h[l])return e._bezierResultCache[s]=h[l+1],h[l+1];return e._bezierResultCache[s]=1,1},e._getBezierParamKey=function(e,t,i,n){return 100*(100*(100*(100*e+t)+i)+n)},e._getBezierPoints=function(t,i,n,a,r){if(e._bezierPointsCache[r])return e._bezierPointsCache[r];var o;o=[0,0,t,i,n,a,1,1];var h;return h=(new s).getBezierPoints(o,100,3),e._bezierPointsCache[r]=h,h},e._bezierResultCache={},e._bezierPointsCache={},e}(),$=function(e){function t(){this._destroyed=!1,this._templet=null,this._currentTime=NaN,this._currentFrameTime=NaN,this._playStart=NaN,this._playEnd=NaN,this._playDuration=NaN,this._overallDuration=NaN,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=NaN,this._startUpdateLoopCount=NaN,this._currentAnimationClipIndex=0,this._currentKeyframeIndex=0,this._paused=!1,this._cacheFrameRate=0,this._cacheFrameRateInterval=NaN,this._cachePlayRate=NaN,this._fullFrames=null,this.isCache=!0,this.playbackRate=1,this.returnToZeroStopped=!1,t.__super.call(this),this._destroyed=!1,this._currentAnimationClipIndex=-1,this._currentKeyframeIndex=-1,this._currentTime=0,this._overallDuration=Number.MAX_VALUE,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=0,this._startUpdateLoopCount=-1,this._cachePlayRate=1,this.cacheFrameRate=60,this.returnToZeroStopped=!1}a(t,"laya.ani.AnimationPlayer",c);var n=t.prototype;return i.imps(n,{"laya.resource.IDestroy":!0}),n._onTempletLoadedComputeFullKeyframeIndices=function(e,t,i){this._templet===i&&this._cachePlayRate===e&&this._cacheFrameRate===t&&this._computeFullKeyframeIndices()},n._computeFullKeyframeIndices=function(){for(var e=this._fullFrames=[],t=this._templet,i=this._cacheFrameRateInterval*this._cachePlayRate,n=0,a=t.getAnimationCount();n<a;n++){for(var r=[],o=0,s=t.getAnimation(n).nodes.length;o<s;o++){for(var h=t.getAnimation(n).nodes[o],l=Math.floor(h.playTime/i+.01),c=new Uint16Array(l+1),p=-1,u=0,d=h.keyFrame.length;u<d;u++){var _=h.keyFrame[u],m=_.startTime,f=m+_.duration+i;do{for(var g=Math.floor(m/i+.5),y=p+1;y<g;y++)c[y]=u;p=g,c[g]=u,m+=i}while(m<=f)}r.push(c)}e.push(r)}},n._onAnimationTempletLoaded=function(){this.destroyed||this._calculatePlayDuration()},n._calculatePlayDuration=function(){if(0!==this.state){var e=this._templet.getAniDuration(this._currentAnimationClipIndex);0===this._playEnd&&(this._playEnd=e),this._playEnd>e&&(this._playEnd=e),this._playDuration=this._playEnd-this._playStart}},n._setPlayParams=function(e,t){this._currentTime=e,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/t+.01),0),this._currentFrameTime=this._currentKeyframeIndex*t},n._setPlayParamsWhenStop=function(e,t){this._currentTime=e,this._currentKeyframeIndex=Math.max(Math.floor(e/t+.01),0),this._currentFrameTime=this._currentKeyframeIndex*t,this._currentAnimationClipIndex=-1},n._update=function(e){if(-1!==this._currentAnimationClipIndex&&!this._paused&&this._templet&&this._templet.loaded){var t=this._cacheFrameRateInterval*this._cachePlayRate,i=0;this._startUpdateLoopCount!==w.loopCount&&(i=e*this.playbackRate,this._elapsedPlaybackTime+=i);var n=this.playDuration;if(0!==this._overallDuration&&this._elapsedPlaybackTime>=this._overallDuration||0===this._overallDuration&&this._elapsedPlaybackTime>=n)return this._setPlayParamsWhenStop(n,t),void this.event("stopped");if(i+=this._currentTime,n>0)if(i>=n)do{if(i-=n,this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(n,t),this._stopWhenCircleFinish=!1,void this.event("stopped");i<n&&(this._setPlayParams(i,t),this.event("complete"))}while(i>=n);else this._setPlayParams(i,t);else{if(this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(n,t),this._stopWhenCircleFinish=!1,void this.event("stopped");this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this.event("complete")}}},n._destroy=function(){this.offAll(),this._templet=null,this._fullFrames=null,this._destroyed=!0},n.play=function(e,t,i,n,a){if(void 0===e&&(e=0),void 0===t&&(t=1),void 0===i&&(i=2147483647),void 0===n&&(n=0),void 0===a&&(a=0),!this._templet)throw new Error("AnimationPlayer:templet must not be null,maybe you need to set url.");if(i<0||n<0||a<0)throw new Error("AnimationPlayer:overallDuration,playStart and playEnd must large than zero.");if(0!==a&&n>a)throw new Error("AnimationPlayer:start must less than end.");this._currentTime=0,this._currentFrameTime=0,this._elapsedPlaybackTime=0,this.playbackRate=t,this._overallDuration=i,this._playStart=n,this._playEnd=a,this._paused=!1,this._currentAnimationClipIndex=e,this._currentKeyframeIndex=0,this._startUpdateLoopCount=w.loopCount,this.event("played"),this._templet.loaded?this._calculatePlayDuration():this._templet.once("loaded",this,this._onAnimationTempletLoaded),this._update(0)},n.playByFrame=function(e,t,i,n,a,r){void 0===e&&(e=0),void 0===t&&(t=1),void 0===i&&(i=2147483647),void 0===n&&(n=0),void 0===a&&(a=0),void 0===r&&(r=30);var o=1e3/r;this.play(e,t,i,n*o,a*o)},n.stop=function(e){void 0===e&&(e=!0),e?(this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this._currentAnimationClipIndex=-1,this.event("stopped")):this._stopWhenCircleFinish=!0},r(0,n,"playEnd",function(){return this._playEnd}),r(0,n,"templet",function(){return this._templet},function(e){0===!this.state&&this.stop(!0),this._templet!==e&&(this._templet=e,e.loaded?this._computeFullKeyframeIndices():e.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,this._cacheFrameRate]))}),r(0,n,"playStart",function(){return this._playStart}),r(0,n,"playDuration",function(){return this._playDuration}),r(0,n,"state",function(){return-1===this._currentAnimationClipIndex?0:this._paused?1:2}),r(0,n,"currentKeyframeIndex",function(){return this._currentKeyframeIndex}),r(0,n,"overallDuration",function(){return this._overallDuration}),r(0,n,"currentFrameTime",function(){return this._currentFrameTime}),r(0,n,"currentAnimationClipIndex",function(){return this._currentAnimationClipIndex}),r(0,n,"currentPlayTime",function(){return this._currentTime+this._playStart}),r(0,n,"cachePlayRate",function(){return this._cachePlayRate},function(e){this._cachePlayRate!==e&&(this._cachePlayRate=e,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[e,this._cacheFrameRate])))}),r(0,n,"cacheFrameRate",function(){return this._cacheFrameRate},function(e){this._cacheFrameRate!==e&&(this._cacheFrameRate=e,this._cacheFrameRateInterval=1e3/this._cacheFrameRate,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,e])))}),r(0,n,"currentTime",null,function(e){if(-1!==this._currentAnimationClipIndex&&this._templet&&this._templet.loaded){if(e<this._playStart||e>this._playEnd)throw new Error("AnimationPlayer:value must large than playStartTime,small than playEndTime.");this._startUpdateLoopCount=w.loopCount;var t=this._cacheFrameRateInterval*this._cachePlayRate;this._currentTime=e,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/t),0),this._currentFrameTime=this._currentKeyframeIndex*t}}),r(0,n,"paused",function(){return this._paused},function(e){this._paused=e,e&&this.event("paused")}),r(0,n,"cacheFrameRateInterval",function(){return this._cacheFrameRateInterval}),r(0,n,"destroyed",function(){return this._destroyed}),t}(),ee=function(e){function t(){t.__super.call(this),y.isConchNode&&(this.drawSkin=function(e){e.transform||(e.transform=f.EMPTY),this._addCmd([e]),this.setSkinMesh&&this.setSkinMesh(e._ps,e.mVBData,e.mEleNum,0,e.mTexture,e.transform)})}a(t,"laya.ani.GraphicsAni",p);return t.prototype.drawSkin=function(e){var t=[e];this._saveToCmd(y._context._drawSkin,t)},t.create=function(){return t._caches.pop()||new t},t.recycle=function(e){e.clear(),t._caches.push(e)},t._caches=[],t}(),te=function(e){function t(){t.__super.call(this),this.mesh=new A}a(t,"laya.ani.bone.canvasmesh.SkinMeshCanvas",N);var i=t.prototype;return i.init2=function(e,t,i,n,a){this.transform&&(this.transform=null);var r;i?r=i:(r=[]).push(0,1,3,3,1,2),this.mesh.texture=e,this.mesh.indexes=r,this.mesh.vertices=n,this.mesh.uvs=a},i.render=function(e,i,n){this.mesh.texture&&(this.transform?(this.transform.translate(i,n),this.renderToContext(e),this.transform.translate(-i,-n)):(this.transform=t._tempMatrix,this.transform.identity(),this.transform.translate(i,n),this.renderToContext(e),this.transform.translate(-i,-n),this.transform=null))},n(t,["_tempMatrix",function(){return this._tempMatrix=new f}]),t}(),ie=function(e){function t(){this._aniMap={},this.unfixedLastAniIndex=-1,t.__super.call(this),this._anis=new Array}a(t,"laya.ani.AnimationTemplet",v);var n=t.prototype;return n.parse=function(e){var t=new l(e);this._aniVersion=t.readUTFString(),E.parse(this,t)},n._calculateKeyFrame=function(e,t,i){var n=e.keyFrame;n[t]=n[0];for(var a=0;a<t;a++){var r=n[a];r.nextData=0===r.duration?r.data:n[a+1].data}n.length--},n.onAsynLoaded=function(e,t,i){var n=new l(t);switch(this._aniVersion=n.readUTFString(),this._aniVersion){case"LAYAANIMATION:02":T.parse(this,n);break;default:E.parse(this,n)}this._endLoaded()},n.disposeResource=function(){this._aniVersion=null,this._anis=null,this._aniMap=null,this._publicExtData=null,this.unfixedCurrentFrameIndexes=null,this.unfixedCurrentTimes=null,this.unfixedKeyframes=null,this._aniClassName=null,this._animationDatasCache=null},n.getAnimationCount=function(){return this._anis.length},n.getAnimation=function(e){return this._anis[e]},n.getAniDuration=function(e){return this._anis[e].playTime},n.getNodes=function(e){return this._anis[e].nodes},n.getNodeIndexWithName=function(e,t){return this._anis[e].bone3DMap[t]},n.getNodeCount=function(e){return this._anis[e].nodes.length},n.getTotalkeyframesLength=function(e){return this._anis[e].totalKeyframeDatasLength},n.getPublicExtData=function(){return this._publicExtData},n.getAnimationDataWithCache=function(e,t,i,n){var a=t[i];if(a){var r=a[e];return r?r[n]:null}return null},n.setAnimationDataWithCache=function(e,t,i,n,a){var r=t[i]||(t[i]={});(r[e]||(r[e]=[]))[n]=a},n.getOriginalData=function(e,i,n,a,r){for(var o=this._anis[e].nodes,s=0,h=0,l=o.length,c=0;h<l;h++){var p,u=o[h];p=u.keyFrame[n[h][a]],u.dataOffset=c;var d=r-p.startTime,_=u.lerpType;if(_)switch(_){case 0:case 1:for(s=0;s<u.keyframeWidth;)s+=u.interpolationMethod[s](u,s,i,c+s,p.data,d,null,p.duration,p.nextData);break;case 2:var m=p.interpolationData,f=m.length,g=0;for(s=0;s<f;){var y=m[s];switch(y){case 6:case 7:s+=t.interpolation[y](u,g,i,c+g,p.data,d,null,p.duration,p.nextData,m,s+1);break;default:s+=t.interpolation[y](u,g,i,c+g,p.data,d,null,p.duration,p.nextData)}g++}}else for(s=0;s<u.keyframeWidth;)s+=u.interpolationMethod[s](u,s,i,c+s,p.data,d,null,p.duration,p.nextData);c+=u.keyframeWidth}},n.getNodesCurrentFrameIndex=function(e,t){var i=this._anis[e].nodes;e!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(i.length),this.unfixedCurrentTimes=new Float32Array(i.length),this.unfixedLastAniIndex=e);for(var n=0,a=i.length;n<a;n++){var r=i[n];for(t<this.unfixedCurrentTimes[n]&&(this.unfixedCurrentFrameIndexes[n]=0),this.unfixedCurrentTimes[n]=t;this.unfixedCurrentFrameIndexes[n]<r.keyFrame.length&&!(r.keyFrame[this.unfixedCurrentFrameIndexes[n]].startTime>this.unfixedCurrentTimes[n]);)this.unfixedCurrentFrameIndexes[n]++;this.unfixedCurrentFrameIndexes[n]--}return this.unfixedCurrentFrameIndexes},n.getOriginalDataUnfixedRate=function(e,i,n){var a=this._anis[e].nodes;e!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(a.length),this.unfixedCurrentTimes=new Float32Array(a.length),this.unfixedKeyframes=o(a.length),this.unfixedLastAniIndex=e);for(var r=0,s=0,h=a.length,l=0;s<h;s++){var c=a[s];for(n<this.unfixedCurrentTimes[s]&&(this.unfixedCurrentFrameIndexes[s]=0),this.unfixedCurrentTimes[s]=n;this.unfixedCurrentFrameIndexes[s]<c.keyFrame.length&&!(c.keyFrame[this.unfixedCurrentFrameIndexes[s]].startTime>this.unfixedCurrentTimes[s]);)this.unfixedKeyframes[s]=c.keyFrame[this.unfixedCurrentFrameIndexes[s]],this.unfixedCurrentFrameIndexes[s]++;var p=this.unfixedKeyframes[s];c.dataOffset=l;var u=n-p.startTime;if(c.lerpType)switch(c.lerpType){case 0:case 1:for(r=0;r<c.keyframeWidth;)r+=c.interpolationMethod[r](c,r,i,l+r,p.data,u,null,p.duration,p.nextData);break;case 2:var d=p.interpolationData,_=d.length,m=0;for(r=0;r<_;){var f=d[r];switch(f){case 6:case 7:r+=t.interpolation[f](c,m,i,l+m,p.data,u,null,p.duration,p.nextData,d,r+1);break;default:r+=t.interpolation[f](c,m,i,l+m,p.data,u,null,p.duration,p.nextData)}m++}}else for(r=0;r<c.keyframeWidth;)r+=c.interpolationMethod[r](c,r,i,l+r,p.data,u,null,p.duration,p.nextData);l+=c.keyframeWidth}},t._LinearInterpolation_0=function(e,t,i,n,a,r,o,s,h,l){var c=0===s?0:r/s;return i[n]=(1-c)*a[t]+c*h[t],1},t._QuaternionInterpolation_1=function(e,t,i,n,a,r,o,s,h,l){var c=0===s?0:r/s;return m.slerpQuaternionArray(a,t,h,t,c,i,n),4},t._AngleInterpolation_2=function(e,t,i,n,a,r,o,s,h,l){return 0},t._RadiansInterpolation_3=function(e,t,i,n,a,r,o,s,h,l){return 0},t._Matrix4x4Interpolation_4=function(e,t,i,n,a,r,o,s,h,l){for(var c=0;c<16;c++,t++)i[n+c]=a[t]+r*o[t];return 16},t._NoInterpolation_5=function(e,t,i,n,a,r,o,s,h,l){return i[n]=a[t],1},t._BezierInterpolation_6=function(e,t,i,n,a,r,o,s,h,l,c){return void 0===c&&(c=0),i[n]=a[t]+(h[t]-a[t])*Q.getBezierRate(r/s,l[c],l[c+1],l[c+2],l[c+3]),5},t._BezierInterpolation_7=function(e,t,i,n,a,r,o,s,h,l,c){return void 0===c&&(c=0),i[n]=l[c+4]+l[c+5]*Q.getBezierRate((.001*r+l[c+6])/l[c+7],l[c],l[c+1],l[c+2],l[c+3]),9},t.load=function(e){return i.loader.create(e,null,null,t)},t.interpolation=[t._LinearInterpolation_0,t._QuaternionInterpolation_1,t._AngleInterpolation_2,t._RadiansInterpolation_3,t._Matrix4x4Interpolation_4,t._NoInterpolation_5,t._BezierInterpolation_6,t._BezierInterpolation_7],t}(),ne=(function(e){function t(){this.isCached=!1,this.canvas=null,this.tex=null,this.rec=null,t.__super.call(this)}a(t,"laya.ani.bone.canvasmesh.CacheAbleSkinMesh",te);var i=t.prototype;i.getCanvasPic=function(){var e=new u("2D"),i=e.getContext("2d");this.rec=this.mesh.getBounds(),e.size(this.rec.width,this.rec.height);var n;return n=this.transform,this.transform=t.tempMt,this.transform.identity(),this.transform.translate(-this.rec.x,-this.rec.y),this.renderToContext(i),this.transform.translate(+this.rec.x,+this.rec.y),this.transform=n,new S(e)},i.render=function(e,t,i){this.mesh.texture&&(this.isCached||(this.isCached=!0,this.tex=this.getCanvasPic()),this.transform?(this.transform.translate(t,i),this._renderTextureToContext(e),this.transform.translate(-t,-i)):(this.transform=te._tempMatrix,this.transform.identity(),this.transform.translate(t,i),this._renderTextureToContext(e),this.transform.translate(-t,-i),this.transform=null))},i._renderTextureToContext=function(e){this.context=e.ctx||e,e.save();var t;if(t=this.tex,this.transform){var i=this.transform;e.transform(i.a,i.b,i.c,i.d,i.tx,i.ty)}this.rec=this.mesh.getBounds(),e.translate(this.rec.x,this.rec.y),e.drawTexture(t,0,0,t.width,t.height,0,0),e.restore()},n(t,["tempMt",function(){return this.tempMt=new f}])}(),function(e){function t(){this.cacheOK=!1,this.cacheCmdOK=!1,this.transformCmds=[],this.drawCmds=[],t.__super.call(this),this.tempMesh=new A}a(t,"laya.ani.bone.canvasmesh.SimpleSkinMeshCanvas",e);var i=t.prototype;return i.init2=function(t,i,n,a,r){e.prototype.init2.call(this,t,i,n,a,r),this.cacheOK=!1,this.cacheCmdOK=!1,this.transformCmds.length=6,this.drawCmds.length=9},i.renderToContext=function(e){if(this.context=e.ctx||e,this.mesh){if(this.mesh.uvs.length<=8)return void(0==this.mode?this._renderWithIndexes(this.mesh):this._renderNoIndexes(this.mesh));this.cacheOK||(this.tempMesh.texture=this.mesh.texture,this.tempMesh.uvs=this.mesh.texture.uv,this.tempMesh.vertices=H.solveMesh(this.mesh,this.tempMesh.vertices),this.cacheOK=!0),0==this.mode?this._renderWithIndexes(this.tempMesh):this._renderNoIndexes(this.tempMesh)}},i._renderWithIndexes=function(e){if(this.cacheCmdOK)this.renderByCache(e);else{var t=e.indexes,i=0,n=t.length;for(n>1&&(n=1),i=0;i<n;i+=3){var a=2*t[i],r=2*t[i+1],o=2*t[i+2];this._renderDrawTriangle(e,a,r,o)}this.cacheCmdOK=!0}},i._renderDrawTriangle=function(e,t,i,n){var a=this.context,r=e.uvs,o=e.vertices,s=e.texture,h=s.bitmap,l=h.source,c=s.width,p=s.height,u=h.width,d=h.height,_=NaN,m=NaN,f=NaN,g=NaN,y=NaN,v=NaN;if(e.useUvTransform){var x=e.uvTransform;_=(r[t]*x.a+r[t+1]*x.c+x.tx)*u,m=(r[i]*x.a+r[i+1]*x.c+x.tx)*u,f=(r[n]*x.a+r[n+1]*x.c+x.tx)*u,g=(r[t]*x.b+r[t+1]*x.d+x.ty)*d,y=(r[i]*x.b+r[i+1]*x.d+x.ty)*d,v=(r[n]*x.b+r[n+1]*x.d+x.ty)*d}else _=r[t]*u,m=r[i]*u,f=r[n]*u,g=r[t+1]*d,y=r[i+1]*d,v=r[n+1]*d;var b=o[t],w=o[i],S=o[n],I=o[t+1],M=o[i+1],C=o[n+1],k=1/(_*y+g*f+m*v-y*f-g*m-_*v),E=b*y+g*S+w*v-y*S-g*w-b*v,T=_*w+b*f+m*S-w*f-b*m-_*S,L=_*y*S+g*w*f+b*m*v-b*y*f-g*m*S-_*w*v,D=I*y+g*C+M*v-y*C-g*M-I*v,N=_*M+I*f+m*C-M*f-I*m-_*C,A=_*y*C+g*M*f+I*m*v-I*y*f-g*m*C-_*M*v;if(this.transformCmds[0]=E*k,this.transformCmds[1]=D*k,this.transformCmds[2]=T*k,this.transformCmds[3]=N*k,this.transformCmds[4]=L*k,this.transformCmds[5]=A*k,this.drawCmds[0]=l,this.drawCmds[1]=s.uv[0]*u,this.drawCmds[2]=s.uv[1]*d,this.drawCmds[3]=c,this.drawCmds[4]=p,this.drawCmds[5]=s.uv[0]*u,this.drawCmds[6]=s.uv[1]*d,this.drawCmds[7]=c,this.drawCmds[8]=p,a.save(),this.transform){var R=this.transform;a.transform(R.a,R.b,R.c,R.d,R.tx,R.ty)}a.transform.apply(a,this.transformCmds),a.drawImage.apply(a,this.drawCmds),a.restore()},i.renderByCache=function(e){var t=this.context;if(t.save(),this.transform){var i=this.transform;t.transform(i.a,i.b,i.c,i.d,i.tx,i.ty)}t.transform.apply(t,this.transformCmds),t.drawImage.apply(t,this.drawCmds),t.restore()},t}(te)),ae=function(e){function t(e,i){this._templet=null,this._player=null,this._curOriginalData=null,this._boneMatrixArray=[],this._lastTime=0,this._currAniName=null,this._currAniIndex=-1,this._pause=!0,this._aniClipIndex=-1,this._clipIndex=-1,this._skinIndex=0,this._skinName="default",this._aniMode=0,this._graphicsCache=null,this._boneSlotDic=null,this._bindBoneBoneSlotDic=null,this._boneSlotArray=null,this._index=-1,this._total=-1,this._indexControl=!1,this._aniPath=null,this._texturePath=null,this._complete=null,this._loadAniMode=0,this._yReverseMatrix=null,this._ikArr=null,this._tfArr=null,this._pathDic=null,this._rootBone=null,this._boneList=null,this._aniSectionDic=null,this._eventIndex=0,this._drawOrderIndex=0,this._drawOrder=null,this._lastAniClipIndex=-1,this._lastUpdateAniClipIndex=-1,t.__super.call(this),void 0===i&&(i=0),e&&this.init(e,i)}a(t,"laya.ani.bone.Skeleton",e);var n=t.prototype;return n.init=function(e,t){void 0===t&&(t=0);var i=0,n=0;if(1==t)for(this._graphicsCache=[],i=0,n=e.getAnimationCount();i<n;i++)this._graphicsCache.push([]);if(this._yReverseMatrix=e.yReverseMatrix,this._aniMode=t,this._templet=e,this._player=new $,this._player.cacheFrameRate=e.rate,this._player.templet=e,this._player.play(),this._parseSrcBoneMatrix(),this._boneList=e.mBoneArr,this._rootBone=e.mRootBone,this._aniSectionDic=e.aniSectionDic,e.ikArr.length>0)for(this._ikArr=[],i=0,n=e.ikArr.length;i<n;i++)this._ikArr.push(new U(e.ikArr[i],this._boneList));if(e.pathArr.length>0){var a,r;null==this._pathDic&&(this._pathDic={});var o;for(i=0,n=e.pathArr.length;i<n;i++)a=e.pathArr[i],r=new z(a,this._boneList),(o=this._boneSlotDic[a.name])&&((r=new z(a,this._boneList)).target=o),this._pathDic[a.name]=r}if(e.tfArr.length>0)for(this._tfArr=[],i=0,n=e.tfArr.length;i<n;i++)this._tfArr.push(new W(e.tfArr[i],this._boneList));if(e.skinDataArray.length>0){var s=this._templet.skinDataArray[this._skinIndex];this._skinName=s.name}this._player.on("played",this,this._onPlay),this._player.on("stopped",this,this._onStop),this._player.on("paused",this,this._onPause)},n.load=function(e,t,n){void 0===n&&(n=0),this._aniPath=e,this._complete=t,this._loadAniMode=n,i.loader.load([{url:e,type:"arraybuffer"}],d.create(this,this._onLoaded))},n._onLoaded=function(){var e=_.getRes(this._aniPath);if(null!=e){null==re.TEMPLET_DICTIONARY&&(re.TEMPLET_DICTIONARY={});var t;(t=re.TEMPLET_DICTIONARY[this._aniPath])?t.isParseFail?this._parseFail():t.isParserComplete?this._parseComplete():(t.on("complete",this,this._parseComplete),t.on("error",this,this._parseFail)):((t=new re)._setUrl(this._aniPath),re.TEMPLET_DICTIONARY[this._aniPath]=t,t.on("complete",this,this._parseComplete),t.on("error",this,this._parseFail),t.isParserComplete=!1,t.parseData(null,e))}},n._parseComplete=function(){var e=re.TEMPLET_DICTIONARY[this._aniPath];e&&(this.init(e,this._loadAniMode),this.play(0,!0)),this._complete&&this._complete.runWith(this)},n._parseFail=function(){console.log("[Error]:"+this._aniPath+"解析失败")},n._onPlay=function(){this.event("played")},n._onStop=function(){var e,t=this._templet.eventAniArr[this._aniClipIndex];if(t&&this._eventIndex<t.length)for(;this._eventIndex<t.length;this._eventIndex++)(e=t[this._eventIndex]).time>=this._player.playStart&&e.time<=this._player.playEnd&&this.event("label",e);this._eventIndex=0,this._drawOrder=null,this.event("stopped")},n._onPause=function(){this.event("paused")},n._parseSrcBoneMatrix=function(){var e=0,t=0;for(t=this._templet.srcBoneMatrixArr.length,e=0;e<t;e++)this._boneMatrixArray.push(new f);if(0==this._aniMode)this._boneSlotDic=this._templet.boneSlotDic,this._bindBoneBoneSlotDic=this._templet.bindBoneBoneSlotDic,this._boneSlotArray=this._templet.boneSlotArray;else{null==this._boneSlotDic&&(this._boneSlotDic={}),null==this._bindBoneBoneSlotDic&&(this._bindBoneBoneSlotDic={}),null==this._boneSlotArray&&(this._boneSlotArray=[]);var i,n,a=this._templet.boneSlotArray;for(e=0,t=a.length;e<t;e++)i=a[e],null==(n=this._bindBoneBoneSlotDic[i.parent])&&(this._bindBoneBoneSlotDic[i.parent]=n=[]),this._boneSlotDic[i.name]=i=i.copy(),n.push(i),this._boneSlotArray.push(i)}},n._emitMissedEvents=function(e,t,i){void 0===i&&(i=0);var n=this._templet.eventAniArr[this._player.currentAnimationClipIndex];if(n){var a,r=0,o=0;for(o=n.length,r=i;r<o;r++)(a=n[r]).time>=this._player.playStart&&a.time<=this._player.playEnd&&this.event("label",a)}},n._update=function(e){if(void 0===e&&(e=!0),!(this._pause||e&&this._indexControl)){var t=this.timer.currTimer,i=this._player.currentKeyframeIndex,n=t-this._lastTime;if(e?this._player._update(n):i=-1,this._lastTime=t,this._player&&(this._index=this._clipIndex=this._player.currentKeyframeIndex,!(this._index<0||n>0&&this._clipIndex==i&&this._lastUpdateAniClipIndex==this._aniClipIndex))){this._lastUpdateAniClipIndex=this._aniClipIndex,i>this._clipIndex&&0!=this._eventIndex&&(this._emitMissedEvents(this._player.playStart,this._player.playEnd,this._eventIndex),this._eventIndex=0);var a,r=this._templet.eventAniArr[this._aniClipIndex];r&&this._eventIndex<r.length&&((a=r[this._eventIndex]).time>=this._player.playStart&&a.time<=this._player.playEnd?this._player.currentPlayTime>=a.time&&(this.event("label",a),this._eventIndex++):this._eventIndex++);var o;if(0==this._aniMode){if(o=this._templet.getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=o&&(this.graphics=o));var s=0,h=0;for(h=this._clipIndex;!this._templet.getGrahicsDataWithCache(this._aniClipIndex,h-1)&&h>0;)h--;if(h<this._clipIndex)for(s=h;s<this._clipIndex;s++)this._createGraphics(s)}else if(1==this._aniMode){if(o=this._getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=o&&(this.graphics=o));for(h=this._clipIndex;!this._getGrahicsDataWithCache(this._aniClipIndex,h-1)&&h>0;)h--;if(h<this._clipIndex)for(s=h;s<this._clipIndex;s++)this._createGraphics(s)}this._createGraphics()}}},n._createGraphics=function(e){void 0===e&&(e=-1),-1==e&&(e=this._clipIndex);var t,i=e*this._player.cacheFrameRateInterval,n=this._templet.drawOrderAniArr[this._aniClipIndex];if(n&&n.length>0)for(this._drawOrderIndex=0,t=n[this._drawOrderIndex];i>=t.time&&(this._drawOrder=t.drawOrder,this._drawOrderIndex++,!(this._drawOrderIndex>=n.length));)t=n[this._drawOrderIndex];var a;0==this._aniMode||1==this._aniMode?this.graphics=ee.create():this.graphics instanceof laya.ani.GraphicsAni?this.graphics.clear():this.graphics=ee.create(),a=this.graphics;var r=this._templet.getNodes(this._aniClipIndex);this._templet.getOriginalData(this._aniClipIndex,this._curOriginalData,this._player._fullFrames[this._aniClipIndex],e,i);var o,s,h,c,p=this._aniSectionDic[this._aniClipIndex],u=0,d=0,_=0,m=0,g=0,y=this._templet.srcBoneMatrixArr.length;for(d=0,g=p[0];d<y;d++)c=this._boneList[d],h=this._templet.srcBoneMatrixArr[d],c.resultTransform.scX=h.scX*this._curOriginalData[u++],c.resultTransform.skX=h.skX+this._curOriginalData[u++],c.resultTransform.skY=h.skY+this._curOriginalData[u++],c.resultTransform.scY=h.scY*this._curOriginalData[u++],c.resultTransform.x=h.x+this._curOriginalData[u++],c.resultTransform.y=h.y+this._curOriginalData[u++],8===this._templet.tMatrixDataLen&&(c.resultTransform.skewX=h.skewX+this._curOriginalData[u++],c.resultTransform.skewY=h.skewY+this._curOriginalData[u++]);var v,x={},b={};for(g+=p[1];d<g;d++)x[(v=r[d]).name]=this._curOriginalData[u++],b[v.name]=this._curOriginalData[u++],this._curOriginalData[u++],this._curOriginalData[u++],this._curOriginalData[u++],this._curOriginalData[u++];var w={},S={};for(g+=p[2];d<g;d++)w[(v=r[d]).name]=this._curOriginalData[u++],S[v.name]=this._curOriginalData[u++],this._curOriginalData[u++],this._curOriginalData[u++],this._curOriginalData[u++],this._curOriginalData[u++];if(this._pathDic){var I;for(g+=p[3];d<g;d++)if(v=r[d],I=this._pathDic[v.name]){switch(new l(v.extenData).getByte()){case 1:I.position=this._curOriginalData[u++];break;case 2:I.spacing=this._curOriginalData[u++];break;case 3:I.rotateMix=this._curOriginalData[u++],I.translateMix=this._curOriginalData[u++]}}}if(this._yReverseMatrix?this._rootBone.update(this._yReverseMatrix):this._rootBone.update(f.TEMP.identity()),this._ikArr){var M;for(d=0,g=this._ikArr.length;d<g;d++)M=this._ikArr[d],w.hasOwnProperty(M.name)&&(M.bendDirection=w[M.name]),S.hasOwnProperty(M.name)&&(M.mix=S[M.name]),M.apply()}if(this._pathDic)for(var C in this._pathDic)(I=this._pathDic[C]).apply(this._boneList,a);if(this._tfArr){for(d=0,m=this._tfArr.length;d<m;d++)this._tfArr[d].apply()}for(d=0,m=this._boneList.length;d<m;d++)if(c=this._boneList[d],s=this._bindBoneBoneSlotDic[c.name],c.resultMatrix.copyTo(this._boneMatrixArray[d]),s)for(_=0,g=s.length;_<g;_++)(o=s[_])&&o.setParentMatrix(c.resultMatrix);var k,E={},T=this._templet.deformAniArr;if(T&&T.length>0){if(this._lastAniClipIndex!=this._aniClipIndex)for(this._lastAniClipIndex=this._aniClipIndex,d=0,g=this._boneSlotArray.length;d<g;d++)(o=this._boneSlotArray[d]).deformData=null;var L=T[this._aniClipIndex];k=L.default,this._setDeform(k,E,this._boneSlotArray,i);var D;for(D in L)"default"!=D&&D!=this._skinName&&(k=L[D],this._setDeform(k,E,this._boneSlotArray,i));k=L[this._skinName],this._setDeform(k,E,this._boneSlotArray,i)}var N,A,R;if(this._drawOrder)for(d=0,g=this._drawOrder.length;d<g;d++)N=x[(o=this._boneSlotArray[this._drawOrder[d]]).name],A=b[o.name],isNaN(A)||(a.save(),a.alpha(A)),isNaN(N)||-2==N||(this._templet.attachmentNames?o.showDisplayByName(this._templet.attachmentNames[N]):o.showDisplayByIndex(N)),E[this._drawOrder[d]]?(R=E[this._drawOrder[d]],o.currDisplayData&&R[o.currDisplayData.attachmentName]?o.deformData=R[o.currDisplayData.attachmentName]:o.deformData=null):o.deformData=null,isNaN(A)?o.draw(a,this._boneMatrixArray,2==this._aniMode):o.draw(a,this._boneMatrixArray,2==this._aniMode,A),isNaN(A)||a.restore();else for(d=0,g=this._boneSlotArray.length;d<g;d++)N=x[(o=this._boneSlotArray[d]).name],A=b[o.name],isNaN(A)||(a.save(),a.alpha(A)),isNaN(N)||-2==N||(this._templet.attachmentNames?o.showDisplayByName(this._templet.attachmentNames[N]):o.showDisplayByIndex(N)),E[d]?(R=E[d],o.currDisplayData&&R[o.currDisplayData.attachmentName]?o.deformData=R[o.currDisplayData.attachmentName]:o.deformData=null):o.deformData=null,isNaN(A)?o.draw(a,this._boneMatrixArray,2==this._aniMode):o.draw(a,this._boneMatrixArray,2==this._aniMode,A),isNaN(A)||a.restore();0==this._aniMode?this._templet.setGrahicsDataWithCache(this._aniClipIndex,e,a):1==this._aniMode&&this._setGrahicsDataWithCache(this._aniClipIndex,e,a)},n._setDeform=function(e,t,i,n){if(e){var a,r,o,s=0,h=0,l=0;if(e)for(s=0,h=e.deformSlotDataList.length;s<h;s++)for(a=e.deformSlotDataList[s],l=0;l<a.deformSlotDisplayList.length;l++)o=i[(r=a.deformSlotDisplayList[l]).slotIndex],r.apply(n,o),t[r.slotIndex]||(t[r.slotIndex]={}),t[r.slotIndex][r.attachment]=r.deformData}},n.getAnimNum=function(){return this._templet.getAnimationCount()},n.getAniNameByIndex=function(e){return this._templet.getAniNameByIndex(e)},n.getSlotByName=function(e){return this._boneSlotDic[e]},n.showSkinByName=function(e,t){void 0===t&&(t=!0),this.showSkinByIndex(this._templet.getSkinIndexByName(e),t)},n.showSkinByIndex=function(e,t){void 0===t&&(t=!0);for(var i=0;i<this._boneSlotArray.length;i++)this._boneSlotArray[i].showSlotData(null,t);if(this._templet.showSkinByIndex(this._boneSlotDic,e,t)){var n=this._templet.skinDataArray[e];this._skinIndex=e,this._skinName=n.name}this._clearCache()},n.showSlotSkinByIndex=function(e,t){if(0!=this._aniMode){var i=this.getSlotByName(e);i&&i.showDisplayByIndex(t),this._clearCache()}},n.showSlotSkinByName=function(e,t){if(0!=this._aniMode){var i=this.getSlotByName(e);i&&i.showDisplayByName(t),this._clearCache()}},n.replaceSlotSkinName=function(e,t,i){if(0!=this._aniMode){var n=this.getSlotByName(e);n&&n.replaceDisplayByName(t,i),this._clearCache()}},n.replaceSlotSkinByIndex=function(e,t,i){if(0!=this._aniMode){var n=this.getSlotByName(e);n&&n.replaceDisplayByIndex(t,i),this._clearCache()}},n.setSlotSkin=function(e,t){if(0!=this._aniMode){var i=this.getSlotByName(e);i&&i.replaceSkin(t),this._clearCache()}},n._clearCache=function(){if(1==this._aniMode)for(var e=0,t=this._graphicsCache.length;e<t;e++){for(var i=0,n=this._graphicsCache[e].length;i<n;i++){var a=this._graphicsCache[e][i];a!=this.graphics&&ee.recycle(a)}this._graphicsCache[e].length=0}},n.play=function(e,t,i,n,a,r){void 0===i&&(i=!0),void 0===n&&(n=0),void 0===a&&(a=0),void 0===r&&(r=!0),this._indexControl=!1;var o=-1,s=NaN;if(s=t?2147483647:0,"string"==typeof e)for(var l=0,c=this._templet.getAnimationCount();l<c;l++){var p=this._templet.getAnimation(l);if(p&&e==p.name){o=l;break}}else o=e;o>-1&&o<this.getAnimNum()&&(this._aniClipIndex=o,(i||this._pause||this._currAniIndex!=o)&&(this._currAniIndex=o,this._curOriginalData=new Float32Array(this._templet.getTotalkeyframesLength(o)),this._drawOrder=null,this._eventIndex=0,this._player.play(o,this._player.playbackRate,s,n,a),r&&this._templet.showSkinByIndex(this._boneSlotDic,this._skinIndex),this._pause&&(this._pause=!1,this._lastTime=h.now(),this.timer.frameLoop(1,this,this._update,null,!0)),this._update()))},n.stop=function(){this._pause||(this._pause=!0,this._player&&this._player.stop(!0),this.timer.clear(this,this._update))},n.playbackRate=function(e){this._player&&(this._player.playbackRate=e)},n.paused=function(){this._pause||(this._pause=!0,this._player&&(this._player.paused=!0),this.timer.clear(this,this._update))},n.resume=function(){this._indexControl=!1,this._pause&&(this._pause=!1,this._player&&(this._player.paused=!1),this._lastTime=h.now(),this.timer.frameLoop(1,this,this._update,null,!0))},n._getGrahicsDataWithCache=function(e,t){return this._graphicsCache[e][t]},n._setGrahicsDataWithCache=function(e,t,i){this._graphicsCache[e][t]=i},n.destroy=function(t){void 0===t&&(t=!0),e.prototype.destroy.call(this,t),this._templet=null,this._player&&this._player.offAll(),this._player=null,this._curOriginalData=null,this._boneMatrixArray.length=0,this._lastTime=0,this.timer.clear(this,this._update)},r(0,n,"url",function(){return this._aniPath},function(e){this.load(e)}),r(0,n,"index",function(){return this._index},function(e){this.player&&(this._index=e,this._player.currentTime=1e3*this._index/this._player.cacheFrameRate,this._indexControl=!0,this._update(!1))}),r(0,n,"total",function(){return this._templet&&this._player?this._total=Math.floor(this._templet.getAniDuration(this._player.currentAnimationClipIndex)/1e3*this._player.cacheFrameRate):this._total=-1,this._total}),r(0,n,"templet",function(){return this._templet}),r(0,n,"player",function(){return this._player}),t.useSimpleMeshInCanvas=!1,t}(b),re=(function(e){function t(e){this._start=0,this._Pos=0,this._data=null,this._curIndex=0,this._preIndex=0,this._playIndex=0,this._playing=!1,this._ended=!0,this._count=0,this._ids=null,this._loadedImage={},this._idOfSprite=null,this._parentMovieClip=null,this._movieClipList=null,this._labels=null,this.basePath=null,this._atlasPath=null,this._url=null,this._isRoot=!1,this._completeHandler=null,this._endFrame=-1,this.interval=30,this.loop=!1,t.__super.call(this),this._ids={},this._idOfSprite=[],this._reset(),this._playing=!1,this._parentMovieClip=e,e?(this._isRoot=!1,this._movieClipList=e._movieClipList,this._movieClipList.push(this)):(this._movieClipList=[this],this._isRoot=!0,this._setUpNoticeType(1))}a(t,"laya.ani.swf.MovieClip",e);var n=t.prototype;n.destroy=function(t){void 0===t&&(t=!0),this._clear(),e.prototype.destroy.call(this,t)},n._setDisplay=function(t){e.prototype._setDisplay.call(this,t),this._isRoot&&this._$3__onDisplay(t)},n._$3__onDisplay=function(e){e?this.timer.loop(this.interval,this,this.updates,null,!0):this.timer.clear(this,this.updates)},n.updates=function(){if(!this._parentMovieClip){var e=0,t=0;for(t=this._movieClipList.length,e=0;e<t;e++)this._movieClipList[e]&&this._movieClipList[e]._update()}},n.addLabel=function(e,t){this._labels||(this._labels={}),this._labels[t]=e},n.removeLabel=function(e){if(e){if(!this._labels)for(var t in this._labels)if(this._labels[t]===e){delete this._labels[t];break}}else this._labels=null},n._update=function(){if(this._data&&this._playing){if(this._playIndex++,this._playIndex>=this._count){if(!this.loop)return this._playIndex--,void this.stop();this._playIndex=0}if(this._parse(this._playIndex),this._labels&&this._labels[this._playIndex]&&this.event("label",this._labels[this._playIndex]),-1!=this._endFrame&&this._endFrame==this._playIndex){if(this._endFrame=-1,null!=this._completeHandler){var e=this._completeHandler;this._completeHandler=null,e.run()}this.stop()}}},n.stop=function(){this._playing=!1},n.gotoAndStop=function(e){this.index=e,this.stop()},n._clear=function(){if(this.stop(),this._idOfSprite.length=0,!this._parentMovieClip){this.timer.clear(this,this.updates);var e=0,t=0;for(t=this._movieClipList.length,e=0;e<t;e++)this._movieClipList[e]!=this&&this._movieClipList[e]._clear();this._movieClipList.length=0}this._atlasPath&&_.clearRes(this._atlasPath);var i;for(i in this._loadedImage)this._loadedImage[i]&&(_.clearRes(i),this._loadedImage[i]=!1);this.removeChildren(),this.graphics=null,this._parentMovieClip=null},n.play=function(e,t){void 0===e&&(e=0),void 0===t&&(t=!0),this.loop=t,this._playing=!0,this._data&&this._displayFrame(e)},n._displayFrame=function(e){void 0===e&&(e=-1),-1!=e&&(this._curIndex>e&&this._reset(),this._parse(e))},n._reset=function(e){void 0===e&&(e=!0),e&&1!=this._curIndex&&this.removeChildren(),this._preIndex=this._curIndex=-1,this._Pos=this._start},n._parse=function(e){var i,n,a,r=0,o=0,s=0,h=!1,l=this._idOfSprite,c=this._data;for(this._ended&&this._reset(),c.pos=this._Pos,this._ended=!1,this._playIndex=e,this._curIndex>e&&e<this._preIndex&&(this._reset(!0),c.pos=this._Pos);this._curIndex<=e&&!this._ended;)switch(c.getUint16()){case 12:if(r=c.getUint16(),o=this._ids[c.getUint16()],this._Pos=c.pos,c.pos=o,0==(s=c.getUint8())){var p=c.getUint16();if(!(n=l[r])){n=l[r]=new b;var u=new b;u.loadImage(this.basePath+p+".png"),this._loadedImage[this.basePath+p+".png"]=!0,n.addChild(u),u.size(c.getFloat32(),c.getFloat32());var d=c._getMatrix();u.transform=d}n.alpha=1}else 1==s&&((i=l[r])||(l[r]=i=new t(this),i.interval=this.interval,i._ids=this._ids,i.basePath=this.basePath,i._setData(c,o),i._initState(),i.play(0)),i.alpha=1);c.pos=this._Pos;break;case 3:var _=l[c.getUint16()];_&&(this.addChild(_),_.zOrder=c.getUint16(),h=!0);break;case 4:(_=l[c.getUint16()])&&_.removeSelf();break;case 5:l[c.getUint16()][t._ValueList[c.getUint16()]]=c.getFloat32();break;case 6:l[c.getUint16()].visible=c.getUint8()>0;break;case 7:var m=(n=l[c.getUint16()]).transform||f.create();m.setTo(c.getFloat32(),c.getFloat32(),c.getFloat32(),c.getFloat32(),c.getFloat32(),c.getFloat32()),n.transform=m;break;case 8:l[c.getUint16()].setPos(c.getFloat32(),c.getFloat32());break;case 9:l[c.getUint16()].setSize(c.getFloat32(),c.getFloat32());break;case 10:l[c.getUint16()].alpha=c.getFloat32();break;case 11:l[c.getUint16()].setScale(c.getFloat32(),c.getFloat32());break;case 98:a=c.getString(),this.event(a),"stop"==a&&this.stop();break;case 99:this._curIndex=c.getUint16(),h&&this.updateZOrder();break;case 100:this._count=this._curIndex+1,this._ended=!0,this._playing&&(this.event("enterframe"),this.event("end"),this.event("complete")),this._reset(!1)}this._playing&&!this._ended&&this.event("enterframe"),this._Pos=c.pos},n._setData=function(e,t){this._data=e,this._start=t+3},n.load=function(e,t,n){void 0===t&&(t=!1),this._url=e=I.formatURL(e),t&&(this._atlasPath=n||e.split(".swf")[0]+".json"),this.stop(),this._clear(),this._movieClipList=[this];var a;a=[{url:e,type:"arraybuffer"}],this._atlasPath&&a.push({url:this._atlasPath,type:"atlas"}),i.loader.load(a,d.create(this,this._onLoaded))},n._onLoaded=function(){var e;(e=_.getRes(this._url))?(this.basePath=this._atlasPath?_.getAtlas(this._atlasPath).dir:this._url.split(".swf")[0]+"/image/",this._initData(e)):this.event("error","file not find")},n._initState=function(){this._reset(),this._ended=!1;var e=this._playing;for(this._playing=!1,this._curIndex=0;!this._ended;)this._parse(++this._curIndex);this._playing=e},n._initData=function(e){this._data=new l(e);var t=0,i=this._data.getUint16();for(t=0;t<i;t++)this._ids[this._data.getInt16()]=this._data.getInt32();this.interval=1e3/this._data.getUint16(),this._setData(this._data,this._ids[32767]),this._initState(),this.play(0),this.event("loaded"),this._parentMovieClip||this.timer.loop(this.interval,this,this.updates,null,!0)},n.playTo=function(e,t,i){this._completeHandler=i,this._endFrame=t,this.play(e,!1)},r(0,n,"index",function(){return this._playIndex},function(e){this._playIndex=e,this._data&&this._displayFrame(this._playIndex),this._labels&&this._labels[e]&&this.event("label",this._labels[e])}),r(0,n,"count",function(){return this._count}),r(0,n,"playing",function(){return this._playing}),r(0,n,"url",null,function(e){this.load(e)}),t._ValueList=["x","y","width","height","scaleX","scaleY","rotation","alpha"]}(b),function(e){function t(){this._mainTexture=null,this._textureJson=null,this._graphicsCache=[],this.srcBoneMatrixArr=[],this.ikArr=[],this.tfArr=[],this.pathArr=[],this.boneSlotDic={},this.bindBoneBoneSlotDic={},this.boneSlotArray=[],this.skinDataArray=[],this.skinDic={},this.subTextureDic={},this.isParseFail=!1,this.yReverseMatrix=null,this.drawOrderAniArr=[],this.eventAniArr=[],this.attachmentNames=null,this.deformAniArr=[],this._isDestroyed=!1,this._rate=30,this.isParserComplete=!1,this.aniSectionDic={},this._skBufferUrl=null,this._textureDic={},this._loadList=null,this._path=null,this.tMatrixDataLen=0,this.mRootBone=null,t.__super.call(this),this.skinSlotDisplayDataArr=[],this.mBoneArr=[]}a(t,"laya.ani.bone.Templet",e);var n=t.prototype;return n.loadAni=function(e){this._skBufferUrl=e,i.loader.load(e,d.create(this,this.onComplete),null,"arraybuffer")},n.onComplete=function(e){if(this._isDestroyed)this.destroy();else{var t=_.getRes(this._skBufferUrl);t?(this._path=this._skBufferUrl.slice(0,this._skBufferUrl.lastIndexOf("/"))+"/",this.parseData(null,t)):this.event("error","load failed:"+this._skBufferUrl)}},n.parseData=function(e,t,i){void 0===i&&(i=30),!this._path&&this.url&&(this._path=this.url.slice(0,this.url.lastIndexOf("/"))+"/"),this._mainTexture=e,this._mainTexture&&y.isWebGL&&e.bitmap&&(e.bitmap.enableMerageInAtlas=!1),this._rate=i,this.parse(t)},n.buildArmature=function(e){return void 0===e&&(e=0),new ae(this,e)},n.parse=function(i){e.prototype.parse.call(this,i),this._endLoaded(),this._aniVersion!=t.LAYA_ANIMATION_VISION&&(console.log("[Error] 版本不一致，请使用IDE版本配套的重新导出"+this._aniVersion+"->"+t.LAYA_ANIMATION_VISION),this._loaded=!1),this.loaded?this._mainTexture?this._parsePublicExtData():this._parseTexturePath():(this.event("error",this),this.isParseFail=!0)},n._parseTexturePath=function(){if(this._isDestroyed)this.destroy();else{var e=0;this._loadList=[];var t,n=new l(this.getPublicExtData()),a=0,r=0,o=0,s=n.getInt32(),h=n.readUTFString(),c=h.split("\n");for(e=0;e<s;e++)t=this._path+c[2*e],h=c[2*e+1],n.getFloat32(),n.getFloat32(),a=n.getFloat32(),r=n.getFloat32(),o=n.getFloat32(),isNaN(o)?0:o,o=n.getFloat32(),isNaN(o)?0:o,o=n.getFloat32(),isNaN(o)?a:o,o=n.getFloat32(),isNaN(o)?r:o,-1==this._loadList.indexOf(t)&&this._loadList.push(t);i.loader.load(this._loadList,d.create(this,this._textureComplete))}},n._textureComplete=function(){for(var e,t,i=0,n=this._loadList.length;i<n;i++)t=this._loadList[i],e=this._textureDic[t]=_.getRes(t),y.isWebGL&&e&&e.bitmap&&(e.bitmap.enableMerageInAtlas=!1);this._parsePublicExtData()},n._parsePublicExtData=function(){var e=0,t=0,i=0,n=0,a=0;for(e=0,a=this.getAnimationCount();e<a;e++)this._graphicsCache.push([]);var r=!1;r="Dragon"!=this._aniClassName;var o,s,h=new l(this.getPublicExtData()),c=0,p=0,u=0,d=0,_=0,m=0,g=0,y=0,v=0,x=h.getInt32(),b=h.readUTFString(),w=b.split("\n");for(e=0;e<x;e++){if(o=this._mainTexture,s=this._path+w[2*e],b=w[2*e+1],null==this._mainTexture&&(o=this._textureDic[s]),!o)return this.event("error",this),void(this.isParseFail=!0);c=h.getFloat32(),p=h.getFloat32(),u=h.getFloat32(),d=h.getFloat32(),v=h.getFloat32(),_=isNaN(v)?0:v,v=h.getFloat32(),m=isNaN(v)?0:v,v=h.getFloat32(),g=isNaN(v)?u:v,v=h.getFloat32(),y=isNaN(v)?d:v,this.subTextureDic[b]=S.create(o,c,p,u,d,-_,-m,g,y)}this._mainTexture=o;var I,M=h.getUint16();for(e=0;e<M;e++)(I=[]).push(h.getUint16()),I.push(h.getUint16()),I.push(h.getUint16()),I.push(h.getUint16()),this.aniSectionDic[e]=I;var C,k,E,T,N,A=h.getInt16(),U={};for(e=0;e<A;e++)C=new L,0==e?N=C:C.root=N,C.d=r?-1:1,E=h.readUTFString(),T=h.readUTFString(),C.length=h.getFloat32(),1==h.getByte()&&(C.inheritRotation=!1),1==h.getByte()&&(C.inheritScale=!1),C.name=E,T&&((k=U[T])?k.addChild(C):this.mRootBone=C),U[E]=C,this.mBoneArr.push(C);this.tMatrixDataLen=h.getUint16();var H,z=h.getUint16(),W=Math.floor(z/this.tMatrixDataLen),J=this.srcBoneMatrixArr;for(e=0;e<W;e++)(H=new K).scX=h.getFloat32(),H.skX=h.getFloat32(),H.skY=h.getFloat32(),H.scY=h.getFloat32(),H.x=h.getFloat32(),H.y=h.getFloat32(),8===this.tMatrixDataLen&&(H.skewX=h.getFloat32(),H.skewY=h.getFloat32()),J.push(H),(C=this.mBoneArr[e]).transform=H;var Z,Q=h.getUint16(),$=0;for(e=0;e<Q;e++){for(Z=new F,$=h.getUint16(),t=0;t<$;t++)Z.boneNames.push(h.readUTFString()),Z.boneIndexs.push(h.getInt16());Z.name=h.readUTFString(),Z.targetBoneName=h.readUTFString(),Z.targetBoneIndex=h.getInt16(),Z.bendDirection=h.getFloat32(),Z.mix=h.getFloat32(),Z.isSpine=r,this.ikArr.push(Z)}var ee,te=h.getUint16(),ie=0;for(e=0;e<te;e++){for(ee=new q,ie=h.getUint16(),t=0;t<ie;t++)ee.boneIndexs.push(h.getInt16());ee.name=h.getUTFString(),ee.targetIndex=h.getInt16(),ee.rotateMix=h.getFloat32(),ee.translateMix=h.getFloat32(),ee.scaleMix=h.getFloat32(),ee.shearMix=h.getFloat32(),ee.offsetRotation=h.getFloat32(),ee.offsetX=h.getFloat32(),ee.offsetY=h.getFloat32(),ee.offsetScaleX=h.getFloat32(),ee.offsetScaleY=h.getFloat32(),ee.offsetShearY=h.getFloat32(),this.tfArr.push(ee)}var ne,ae=h.getUint16(),re=0;for(e=0;e<ae;e++){for((ne=new X).name=h.readUTFString(),re=h.getUint16(),t=0;t<re;t++)ne.bones.push(h.getInt16());ne.target=h.readUTFString(),ne.positionMode=h.readUTFString(),ne.spacingMode=h.readUTFString(),ne.rotateMode=h.readUTFString(),ne.offsetRotation=h.getFloat32(),ne.position=h.getFloat32(),ne.spacing=h.getFloat32(),ne.rotateMix=h.getFloat32(),ne.translateMix=h.getFloat32(),this.pathArr.push(ne)}var oe,se,he,le,ce=0,pe=0,ue=0,de=NaN,_e=0,me=h.getInt16();for(e=0;e<me;e++){var fe=h.getUint8(),ge={};this.deformAniArr.push(ge);for(var ye=0;ye<fe;ye++)for((oe=new R).skinName=h.getUTFString(),ge[oe.skinName]=oe,ce=h.getInt16(),t=0;t<ce;t++)for(se=new B,oe.deformSlotDataList.push(se),pe=h.getInt16(),i=0;i<pe;i++)for(he=new P,se.deformSlotDisplayList.push(he),he.slotIndex=h.getInt16(),he.attachment=h.getUTFString(),ue=h.getInt16(),n=0;n<ue;n++)for(1==h.getByte()?he.tweenKeyList.push(!0):he.tweenKeyList.push(!1),de=h.getFloat32(),he.timeList.push(de),le=[],he.vectices.push(le),_e=h.getInt16(),a=0;a<_e;a++)le.push(h.getFloat32())}var ve,xe,be=h.getInt16(),we=0,Se=0;for(e=0;e<be;e++){for(we=h.getInt16(),ve=[],t=0;t<we;t++){for((xe=new O).time=h.getFloat32(),Se=h.getInt16(),i=0;i<Se;i++)xe.drawOrder.push(h.getInt16());ve.push(xe)}this.drawOrderAniArr.push(ve)}var Ie,Me,Ce=h.getInt16(),ke=0;for(e=0;e<Ce;e++){for(ke=h.getInt16(),Ie=[],t=0;t<ke;t++)(Me=new V).name=h.getUTFString(),Me.intValue=h.getInt32(),Me.floatValue=h.getFloat32(),Me.stringValue=h.getUTFString(),Me.time=h.getFloat32(),Ie.push(Me);this.eventAniArr.push(Ie)}var Ee=h.getInt16();if(Ee>0)for(this.attachmentNames=[],e=0;e<Ee;e++)this.attachmentNames.push(h.getUTFString());var Te,Le,De=h.getInt16();for(e=0;e<De;e++)(Te=new D).name=h.readUTFString(),Te.parent=h.readUTFString(),Te.attachmentName=h.readUTFString(),Te.srcDisplayIndex=Te.displayIndex=h.getInt16(),Te.templet=this,this.boneSlotDic[Te.name]=Te,null==(Le=this.bindBoneBoneSlotDic[Te.parent])&&(this.bindBoneBoneSlotDic[Te.parent]=Le=[]),Le.push(Te),this.boneSlotArray.push(Te);var Ne,Ae,Re,Be=h.readUTFString().split("\n"),Pe=0,Oe=h.getUint8(),Ve=0,Ue=0,Fe=0,He=0,ze=0,Xe=0,Ye=0;for(e=0;e<Oe;e++){for((Ne=new Y).name=Be[Pe++],Ve=h.getUint8(),t=0;t<Ve;t++){for((Ae=new j).name=Be[Pe++],Te=this.boneSlotDic[Ae.name],Ue=h.getUint8(),i=0;i<Ue;i++){if(Re=new G,this.skinSlotDisplayDataArr.push(Re),Re.name=Be[Pe++],Re.attachmentName=Be[Pe++],Re.transform=new K,Re.transform.scX=h.getFloat32(),Re.transform.skX=h.getFloat32(),Re.transform.skY=h.getFloat32(),Re.transform.scY=h.getFloat32(),Re.transform.x=h.getFloat32(),Re.transform.y=h.getFloat32(),Ae.displayArr.push(Re),Re.width=h.getFloat32(),Re.height=h.getFloat32(),Re.type=h.getUint8(),Re.verLen=h.getUint16(),(A=h.getUint16())>0)for(Re.bones=[],n=0;n<A;n++){var Ge=h.getUint16();Re.bones.push(Ge)}if((Fe=h.getUint16())>0)for(Re.uvs=[],n=0;n<Fe;n++)Re.uvs.push(h.getFloat32());if((He=h.getUint16())>0)for(Re.weights=[],n=0;n<He;n++)Re.weights.push(h.getFloat32());if((ze=h.getUint16())>0)for(Re.triangles=[],n=0;n<ze;n++)Re.triangles.push(h.getUint16());if((Xe=h.getUint16())>0)for(Re.vertices=[],n=0;n<Xe;n++)Re.vertices.push(h.getFloat32());if((Ye=h.getUint16())>0)for(Re.lengths=[],n=0;n<Ye;n++)Re.lengths.push(h.getFloat32())}Ne.slotArr.push(Ae)}this.skinDic[Ne.name]=Ne,this.skinDataArray.push(Ne)}1==h.getUint8()?(this.yReverseMatrix=new f(1,0,0,-1,0,0),N&&N.setTempMatrix(this.yReverseMatrix)):N&&N.setTempMatrix(new f),this.showSkinByIndex(this.boneSlotDic,0),this.isParserComplete=!0,this.event("complete",this)},n.getTexture=function(e){var t=this.subTextureDic[e];return t||(t=this.subTextureDic[e.substr(0,e.length-1)]),null==t?this._mainTexture:t},n.showSkinByIndex=function(e,t,i){if(void 0===i&&(i=!0),t<0&&t>=this.skinDataArray.length)return!1;var n,a,r=0,o=0,s=this.skinDataArray[t];if(s){for(r=0,o=s.slotArr.length;r<o;r++)(a=s.slotArr[r])&&(n=e[a.name])&&(n.showSlotData(a,i),i&&"undefined"!=n.attachmentName&&"null"!=n.attachmentName?n.showDisplayByName(n.attachmentName):n.showDisplayByIndex(n.displayIndex));return!0}return!1},n.getSkinIndexByName=function(e){for(var t=0,i=this.skinDataArray.length;t<i;t++)if(this.skinDataArray[t].name==e)return t;return-1},n.getGrahicsDataWithCache=function(e,t){return this._graphicsCache[e][t]},n.setGrahicsDataWithCache=function(e,t,i){this._graphicsCache[e][t]=i},n.destroy=function(){this._isDestroyed=!0;var e;for(var i in this.subTextureDic)(e=this.subTextureDic[i])&&e.destroy();for(i in this._textureDic)(e=this._textureDic[i])&&e.destroy();for(var n=0,a=this.skinSlotDisplayDataArr.length;n<a;n++)this.skinSlotDisplayDataArr[n].destory();this.skinSlotDisplayDataArr.length=0,this.url&&delete t.TEMPLET_DICTIONARY[this.url],laya.resource.Resource.prototype.destroy.call(this)},n.getAniNameByIndex=function(e){var t=this.getAnimation(e);return t?t.name:null},r(0,n,"rate",function(){return this._rate},function(e){this._rate=e}),t.LAYA_ANIMATION_VISION="LAYAANIMATION:1.6.0",t.TEMPLET_DICTIONARY=null,t}(ie))}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});for(var i in Laya){var n=Laya[i];n&&n.__isclass&&(t[i]=n)}}),function(e,t,i){i.un,i.uns;var n=i.static,a=i.class,r=i.getset,o=(i.__newvec,laya.utils.Browser,laya.display.css.CSSStyle),s=laya.utils.ClassUtils,h=(laya.events.Event,laya.utils.HTMLChar),l=laya.net.Loader,c=(laya.display.Node,laya.maths.Rectangle),p=laya.renders.Render,u=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.display.Sprite),d=laya.utils.Stat,_=laya.display.Text,m=laya.resource.Texture,f=laya.net.URL,g=laya.utils.Utils,y=function(){function e(){}return a(e,"laya.html.utils.HTMLParse"),e.parse=function(t,i,n){i=(i="<root>"+(i=i.replace(/<br>/g,"<br/>"))+"</root>").replace(e.spacePattern,e.char255);var a=g.parseXMLFromString(i);e._parseXML(t,a.childNodes[0].childNodes,n)},e._parseXML=function(t,i,n,a){var r=0,o=0;if(i.join||i.item)for(r=0,o=i.length;r<o;++r)e._parseXML(t,i[r],n,a);else{var h,l;if(3==i.nodeType){var c;return void(t instanceof laya.html.dom.HTMLDivElement?(null==i.nodeName&&(i.nodeName="#text"),l=i.nodeName.toLowerCase(),(c=i.textContent.replace(/^\s+|\s+$/g,"")).length>0&&(h=s.getInstance(l))&&(t.addChild(h),h.innerTEXT=c.replace(e.char255AndOneSpacePattern," "))):(c=i.textContent.replace(/^\s+|\s+$/g,"")).length>0&&(t.innerTEXT=c.replace(e.char255AndOneSpacePattern," ")))}if("#comment"==(l=i.nodeName.toLowerCase()))return;if(h=s.getInstance(l)){(h=t.addChild(h)).URI=n,h.href=a;var p=i.attributes;if(p&&p.length>0)for(r=0,o=p.length;r<o;++r){var u=p[r],d=u.nodeName,_=u.value;h._setAttributes(d,_)}e._parseXML(h,i.childNodes,n,h.href)}else e._parseXML(t,i.childNodes,n,a)}},e.char255=String.fromCharCode(255),e.spacePattern=/&nbsp;|&#160;/g,e.char255AndOneSpacePattern=new RegExp(String.fromCharCode(255)+"|(\\s+)","g"),e}(),v=function(){function e(){}return a(e,"laya.html.utils.Layout"),e.later=function(t){null==e._will&&(e._will=[],i.stage.frameLoop(1,null,function(){if(!(e._will.length<1)){for(var t=0;t<e._will.length;t++)laya.html.utils.Layout.layout(e._will[t]);e._will.length=0}})),e._will.push(t)},e.layout=function(t){if(!t||!t._style)return null;if(0==(512&t._style._type))return null;t.getStyle()._type&=-513;var i=e._multiLineLayout(t);return p.isConchApp&&t.layaoutCallNative&&t.layaoutCallNative(),i},e._multiLineLayout=function(t){function i(){T.y=M,M+=T.h+d,0==T.h&&(M+=m),T.mWidth=N,N=0,T=new x,E.push(T),T.h=0,I=0,A=!0,L=!1}if(_.RightToLeft)return e._multiLineLayout2(t);var n=new Array;t._addChildsToLayout(n);var a,r,o,s,h,l=0,c=n.length,p=t._getCSSStyle(),u=p.letterSpacing,d=p.leading,m=p.lineHeight,f=p._widthAuto()||!p.wordWrap,g=f?999999:t.width,y=(t.height,0),v=p.italic?p.fontSize/3:0,b=p._getAlign(),w=p._getValign(),S=0!==w||0!==b||0!=m,I=0,M=0,C=0,k=0,E=new Array,T=E[0]=new x,L=!1,D=!1;T.h=0,p.italic&&(g-=p.fontSize/3);var N=0,A=!0;for(l=0;l<c;l++)if(null!=(a=n[l]))if(A=!1,a instanceof laya.html.dom.HTMLBrElement)i(),T.y=M;else{if(a._isChar()){if((s=a).isWord)L=D||"\n"===s.char,T.wordStartIndex=T.elements.length;else{if(E.length>0&&I+C>g&&T.wordStartIndex>0){var R=0;R=T.elements.length-T.wordStartIndex+1,T.elements.length=T.wordStartIndex,l-=R,i();continue}L=!1,N+=s.width}C=s.width+u,k=s.height,D=!1,(L=L||I+C>g)&&i(),T.minTextHeight=Math.min(T.minTextHeight,a.height)}else h=a,o=(r=a._getCSSStyle()).padding,0===r._getCssFloat()||(S=!0),L=D||r.lineElement,C=h.width*h._style._tf.scaleX+o[1]+o[3]+u,k=h.height*h._style._tf.scaleY+o[0]+o[2],D=r.lineElement,(L=L||I+C>g&&r.wordWrap)&&i();T.elements.push(a),T.h=Math.max(T.h,k),a.x=I,a.y=M,I+=C,T.w=I-u,T.y=M,y=Math.max(I+v,y)}else A||(I+=e.DIV_ELEMENT_PADDING),T.wordStartIndex=T.elements.length;if(M=T.y+T.h,S){var B=0,P=g;for(f&&t.width>0&&(P=t.width),l=0,c=E.length;l<c;l++)E[l].updatePos(0,P,l,B,b,w,m),B+=Math.max(m,E[l].h+d);M=B}return f&&(t.width=y),M>t.height&&(t.height=M),[y,M]},e._multiLineLayout2=function(t){function i(){E.y=I,I+=E.h+d,0==E.h&&(I+=_),E.mWidth=D,D=0,E=new x,k.push(E),E.h=0,S=0,N=!0,T=!1}var n=new Array;t._addChildsToLayout(n);var a,r,o,s,h,l=0,c=n.length,p=t._getCSSStyle(),u=p.letterSpacing,d=p.leading,_=p.lineHeight,m=p._widthAuto()||!p.wordWrap,f=m?999999:t.width,g=(t.height,0),y=p.italic?p.fontSize/3:0,v=2-p._getAlign(),b=p._getValign(),w=0!==b||0!==v||0!=_,S=0,I=0,M=0,C=0,k=new Array,E=k[0]=new x,T=!1,L=!1;E.h=0,p.italic&&(f-=p.fontSize/3);var D=0,N=!0;for(l=0;l<c;l++)if(null!=(a=n[l]))if(N=!1,a instanceof laya.html.dom.HTMLBrElement)i(),E.y=I;else{if(a._isChar()){if((s=a).isWord)T=L||"\n"===s.char,E.wordStartIndex=E.elements.length;else{if(k.length>0&&S+M>f&&E.wordStartIndex>0){var A=0;A=E.elements.length-E.wordStartIndex+1,E.elements.length=E.wordStartIndex,l-=A,i();continue}T=!1,D+=s.width}M=s.width+u,C=s.height,L=!1,(T=T||S+M>f)&&i(),E.minTextHeight=Math.min(E.minTextHeight,a.height)}else h=a,o=(r=a._getCSSStyle()).padding,0===r._getCssFloat()||(w=!0),T=L||r.lineElement,M=h.width*h._style._tf.scaleX+o[1]+o[3]+u,C=h.height*h._style._tf.scaleY+o[0]+o[2],L=r.lineElement,(T=T||S+M>f&&r.wordWrap)&&i();E.elements.push(a),E.h=Math.max(E.h,C),a.x=S,a.y=I,S+=M,E.w=S-u,E.y=I,g=Math.max(S+y,g)}else N||(S+=e.DIV_ELEMENT_PADDING),E.wordStartIndex=E.elements.length;if(I=E.y+E.h,w){var R=0,B=f;for(l=0,c=k.length;l<c;l++)k[l].updatePos(0,B,l,R,v,b,_),R+=Math.max(_,k[l].h+d);I=R}for(m&&(t.width=g),I>t.height&&(t.height=I),l=0,c=k.length;l<c;l++)k[l].revertOrder(f);return[g,I]},e._will=null,e.DIV_ELEMENT_PADDING=0,e}(),x=function(){function e(){this.x=0,this.y=0,this.w=0,this.h=0,this.wordStartIndex=0,this.minTextHeight=99999,this.mWidth=0,this.elements=new Array}a(e,"laya.html.utils.LayoutLine");var t=e.prototype;return t.updatePos=function(e,t,i,n,a,r,o){var s,h=0;this.elements.length>0&&(h=(s=this.elements[this.elements.length-1]).x+s.width-this.elements[0].x);var l=0,c=NaN;1===a&&(l=(t-h)/2),2===a&&(l=t-h),0===o||0!=r||(r=1);for(var p=0,u=this.elements.length;p<u;p++){var d=(s=this.elements[p])._getCSSStyle();switch(0!==l&&(s.x+=l),d._getValign()){case 0:s.y=n;break;case 1:var _=0;99999!=this.minTextHeight&&(_=this.minTextHeight);var m=(_+o)/2;m=Math.max(m,this.h),c=(laya.html.dom.HTMLImageElement,n+m-s.height),s.y=c;break;case 2:s.y=n+(o-s.height)}}},t.revertOrder=function(e){var t;if(this.elements.length>0){var i=0,n=0;for(n=this.elements.length,i=0;i<n;i++)(t=this.elements[i]).x=e-t.x-t.width}},e}(),b=function(e){function t(){this.URI=null,this._href=null,t.__super.call(this),this._text=t._EMPTYTEXT,this.setStyle(new o(this)),this._getCSSStyle().valign="middle",this.mouseEnabled=!0}a(t,"laya.html.dom.HTMLElement",e);var n=t.prototype;return n.layaoutCallNative=function(){var e=0;if(this._childs&&(e=this._childs.length)>0)for(var t=0;t<e;t++)this._childs[t].layaoutCallNative&&this._childs[t].layaoutCallNative();var i=this._getWords();i?laya.html.dom.HTMLElement.fillWords(this,i,0,0,this.style.font,this.style.color,this.style.underLine):this.graphics.clear()},n.appendChild=function(e){return this.addChild(e)},n._getWords2=function(){var e=this._text.text;if(!e||0===e.length)return null;var t,i,n=0,a=0;if(this._text.drawWords)i=this._text.drawWords;else{for(a=(t=e.split(" ")).length-1,i=[],n=0;n<a;n++)i.push(t[n]," ");a>=0&&i.push(t[a]),this._text.drawWords=i}var r=this._text.words;if(r&&r.length===i.length)return r;null===r&&(this._text.words=r=[]),r.length=i.length;var o,s=this.style,l=s.font;for(n=0,a=i.length;n<a;n++){o=g.measureText(i[n],l);var c=r[n]=new h(i[n],o.width,o.height||s.fontSize,s);if(c.char.length>1&&(c.charNum=c.char),this.href){var p=new u;this.addChild(p),c.setSprite(p)}}return r},n._getWords=function(){if(!_.CharacterCache)return this._getWords2();var e=this._text.text;if(!e||0===e.length)return null;var t=this._text.words;if(t&&t.length===e.length)return t;null===t&&(this._text.words=t=[]),t.length=e.length;for(var i,n=this.style,a=n.font,r=0,o=e.length;r<o;r++){i=g.measureText(e.charAt(r),a);var s=t[r]=new h(e.charAt(r),i.width,i.height||n.fontSize,n);if(this.href){var l=new u;this.addChild(l),s.setSprite(l)}}return t},n.showLinkSprite=function(){var e=this._text.words;if(e)for(var t,i,n=[],a=0;a<e.length;a++)i=e[a],(t=new u).graphics.drawRect(0,0,i.width,i.height,"#ff0000"),t.width=i.width,t.height=i.height,this.addChild(t),n.push(t)},n._layoutLater=function(){var e=this.style;512&e._type||(e.widthed(this)&&(this._childs.length>0||null!=this._getWords())&&e.block?(v.later(this),e._type|=512):this.parent&&this.parent._layoutLater())},n._setAttributes=function(t,i){switch(t){case"style":return void this.style.cssText(i);case"class":return void(this.className=i)}e.prototype._setAttributes.call(this,t,i)},n.updateHref=function(){if(null!=this._href){var e=this._getWords();if(e)for(var t,i,n=0;n<e.length;n++)(i=(t=e[n]).getSprite())&&(i.size(t.width,t.height),i.on("click",this,this.onLinkHandler))}},n.onLinkHandler=function(e){switch(e.type){case"click":for(var t=this;t;)t.event("link",[this.href]),t=t.parent}},n.formatURL=function(e){return this.URI?f.formatURL(e,this.URI?this.URI.path:null):e},r(0,n,"href",function(){return this._href},function(e){this._href=e,null!=e&&(this._getCSSStyle().underLine=1,this.updateHref())}),r(0,n,"color",null,function(e){this.style.color=e}),r(0,n,"onClick",null,function(e){i._runScript("fn=function(event){"+e+";}"),this.on("click",this,void 0)}),r(0,n,"id",null,function(e){S.document.setElementById(e,this)}),r(0,n,"innerTEXT",function(){return this._text.text},function(e){this.text=e}),r(0,n,"style",function(){return this._style}),r(0,n,"text",function(){return this._text.text},function(e){this._text==t._EMPTYTEXT?this._text={text:e,words:null}:(this._text.text=e,this._text.words&&(this._text.words.length=0)),p.isConchApp&&this.layaoutCallNative(),this._renderType|=2048,this.repaint(),this.updateHref()}),r(0,n,"parent",e.prototype._$get_parent,function(e){if(e instanceof laya.html.dom.HTMLElement){var t=e;this.URI||(this.URI=t.URI),this.style.inherit(t.style)}i.superSet(u,this,"parent",e)}),r(0,n,"className",null,function(e){this.style.attrs(S.document.styleSheets["."+e])}),t.fillWords=function(e,t,i,n,a,r,o){e.graphics.clear();for(var s=0,h=t.length;s<h;s++){var l=t[s];e.graphics.fillText(l.char,l.x+i,l.y+n,a,r,"left",o)}},t._EMPTYTEXT={text:null,words:null},t}(u),w=(function(e){function t(){t.__super.call(this),this.style.lineElement=!0,this.style.block=!0}a(t,"laya.html.dom.HTMLBrElement",b)}(),function(e){function t(){this.contextHeight=NaN,this.contextWidth=NaN,t.__super.call(this),this.style.block=!0,this.style.lineElement=!0,this.style.width=200,this.style.height=200}a(t,"laya.html.dom.HTMLDivElement",e);var n=t.prototype;return n.appendHTML=function(e){y.parse(this,e,this.URI),this.layout()},n._addChildsToLayout=function(e){var t=this._getWords();if(null==t&&0==this._childs.length)return!1;t&&t.forEach(function(t){e.push(t)});for(var i=!0,n=0,a=this._childs.length;n<a;n++){var r=this._childs[n];i?i=!1:e.push(null),r._addToLayout(e)}return!0},n._addToLayout=function(e){this.layout()},n.layout=function(){if(this.style){this.style._type|=512;var e=v.layout(this);if(e){this._$P.mHtmlBounds||this._set$P("mHtmlBounds",new c);var t=this._$P.mHtmlBounds;t.x=t.y=0,t.width=this.contextWidth=e[0],t.height=this.contextHeight=e[1],this.setBounds(t)}}},r(0,n,"height",function(){return this._height?this._height:this.contextHeight},e.prototype._$set_height),r(0,n,"innerHTML",null,function(e){this.destroyChildren(),this.appendHTML(e)}),r(0,n,"width",function(){return this._width?this._width:this.contextWidth},function(e){var t=!1;t=0===e?e!=this._width:e!=this.width,i.superSet(b,this,"width",e),t&&this.layout()}),t}(b)),S=function(e){function t(){this.all=new Array,this.styleSheets=o.styleSheets,t.__super.call(this)}a(t,"laya.html.dom.HTMLDocument",b);var i=t.prototype;return i.getElementById=function(e){return this.all[e]},i.setElementById=function(e,t){this.all[e]=t},n(t,["document",function(){return this.document=new t}]),t}();(function(e){function t(){this._tex=null,this._url=null,this._renderArgs=[],t.__super.call(this),this.style.block=!0}a(t,"laya.html.dom.HTMLImageElement",b);var i=t.prototype;i._addToLayout=function(e){!this._style.absolute&&e.push(this)},i.render=function(e,t,i){!this._tex||!this._tex.loaded||!this._tex.loaded||this._width<1||this._height<1||(d.spriteCount++,this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,e.ctx.drawTexture2(t,i,this.style.translateX,this.style.translateY,this.transform,this.style.alpha,this.style.blendMode,this._renderArgs))},i.layaoutCallNative=function(){var e=0;if(this._childs&&(e=this._childs.length)>0)for(var t=0;t<e;t++)this._childs[t].layaoutCallNative&&this._childs[t].layaoutCallNative()},r(0,i,"src",null,function(e){function t(){var e=i._style;e.widthed(i)||i._tex.width,e.heighted(i)||i._tex.height;e.widthed(i)||i._width==i._tex.width||(i.width=i._tex.width,i.parent&&i.parent._layoutLater()),e.heighted(i)||i._height==i._tex.height||(i.height=i._tex.height,i.parent&&i.parent._layoutLater()),p.isConchApp&&(i._renderArgs[0]=i._tex,i._renderArgs[1]=i.x,i._renderArgs[2]=i.y,i._renderArgs[3]=i.width||i._tex.width,i._renderArgs[4]=i.height||i._tex.height,i.graphics.drawTexture(i._tex,0,0,i._renderArgs[3],i._renderArgs[4])),i.repaint(),i.parentRepaint()}var i=this;if(e=this.formatURL(e),this._url!=e){this._url=e;var n=this._tex=l.getRes(e);n||(this._tex=n=new m,n.load(e),l.cacheRes(e,n)),n.loaded?t():n.on("loaded",null,t)}})})(),function(e){function t(){this.type=null,t.__super.call(this),this.visible=!1}a(t,"laya.html.dom.HTMLLinkElement",e);var i=t.prototype;i._onload=function(e){switch(this.type){case"text/css":o.parseCSS(e,this.URI)}},r(0,i,"href",e.prototype._$get_href,function(e){var t=this;e=this.formatURL(e),this.URI=new f(e);var i=new l;i.once("complete",null,function(e){t._onload(e)}),i.load(e,"text")}),t._cuttingStyle=new RegExp("((@keyframes[\\s\\t]+|)(.+))[\\t\\n\\r\\s]*{","g")}(b),function(e){function t(){t.__super.call(this),this.visible=!1}a(t,"laya.html.dom.HTMLStyleElement",e);r(0,t.prototype,"text",e.prototype._$get_text,function(e){o.parseCSS(e,null)})}(b),function(e){function t(){t.__super.call(this),this._getCSSStyle().valign="middle"}a(t,"laya.html.dom.HTMLIframeElement",e);r(0,t.prototype,"href",e.prototype._$get_href,function(e){var t=this;e=this.formatURL(e);var i=new l;i.once("complete",null,function(i){var n=t.URI;t.URI=new f(e),t.innerHTML=i,!n||(t.URI=n)}),i.load(e,"text")})}(w)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});for(var i in Laya){var n=Laya[i];n&&n.__isclass&&(t[i]=n)}}),function(e,t,i){i.un,i.uns;var n=i.static,a=i.class,r=i.getset,o=(i.__newvec,laya.webgl.canvas.BlendMode),s=(laya.events.Event,laya.resource.HTMLCanvas),h=laya.utils.Handler,l=laya.webgl.utils.IndexBuffer2D,c=(laya.net.Loader,laya.maths.MathUtil),p=laya.maths.Matrix,u=laya.renders.Render,d=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.webgl.shader.Shader),_=laya.display.Sprite,m=laya.utils.Stat,f=laya.resource.Texture,g=laya.utils.Utils,y=laya.webgl.shader.d2.value.Value2D,v=laya.webgl.utils.VertexBuffer2D,x=laya.webgl.WebGL,b=(laya.webgl.WebGLContext,function(){function e(){this._frameTime=0,this._emissionRate=60,this._emissionTime=0,this.minEmissionTime=1/60,this._particleTemplate=null}a(e,"laya.particle.emitter.EmitterBase");var t=e.prototype;return t.start=function(e){void 0===e&&(e=2147483647),0!=this._emissionRate&&(this._emissionTime=e)},t.stop=function(){this._emissionTime=0},t.clear=function(){this._emissionTime=0},t.emit=function(){},t.advanceTime=function(e){if(void 0===e&&(e=1),this._emissionTime-=e,!(this._emissionTime<0||(this._frameTime+=e,this._frameTime<this.minEmissionTime)))for(;this._frameTime>this.minEmissionTime;)this._frameTime-=this.minEmissionTime,this.emit()},r(0,t,"particleTemplate",null,function(e){this._particleTemplate=e}),r(0,t,"emissionRate",function(){return this._emissionRate},function(e){e<=0||(this._emissionRate=e,e>0&&(this.minEmissionTime=1/e))}),e}()),w=function(){function e(){this.position=null,this.velocity=null,this.startColor=null,this.endColor=null,this.sizeRotation=null,this.radius=null,this.radian=null,this.durationAddScale=NaN,this.time=NaN}return a(e,"laya.particle.ParticleData"),e.Create=function(t,i,n,a){var r=new e;r.position=i,c.scaleVector3(n,t.emitterVelocitySensitivity,e._tempVelocity);var o=c.lerp(t.minHorizontalVelocity,t.maxHorizontalVelocity,Math.random()),s=Math.random()*Math.PI*2;e._tempVelocity[0]+=o*Math.cos(s),e._tempVelocity[2]+=o*Math.sin(s),e._tempVelocity[1]+=c.lerp(t.minVerticalVelocity,t.maxVerticalVelocity,Math.random()),r.velocity=e._tempVelocity,r.startColor=e._tempStartColor,r.endColor=e._tempEndColor;var h=0;if(t.disableColor)for(h=0;h<4;h++)r.startColor[h]=1,r.endColor[h]=1;else if(t.colorComponentInter)for(h=0;h<4;h++)r.startColor[h]=c.lerp(t.minStartColor[h],t.maxStartColor[h],Math.random()),r.endColor[h]=c.lerp(t.minEndColor[h],t.maxEndColor[h],Math.random());else c.lerpVector4(t.minStartColor,t.maxStartColor,Math.random(),r.startColor),c.lerpVector4(t.minEndColor,t.maxEndColor,Math.random(),r.endColor);r.sizeRotation=e._tempSizeRotation;var l=Math.random();r.sizeRotation[0]=c.lerp(t.minStartSize,t.maxStartSize,l),r.sizeRotation[1]=c.lerp(t.minEndSize,t.maxEndSize,l),r.sizeRotation[2]=c.lerp(t.minRotateSpeed,t.maxRotateSpeed,Math.random()),r.radius=e._tempRadius;var p=Math.random();r.radius[0]=c.lerp(t.minStartRadius,t.maxStartRadius,p),r.radius[1]=c.lerp(t.minEndRadius,t.maxEndRadius,p),r.radian=e._tempRadian,r.radian[0]=c.lerp(t.minHorizontalStartRadian,t.maxHorizontalStartRadian,Math.random()),r.radian[1]=c.lerp(t.minVerticalStartRadian,t.maxVerticalStartRadian,Math.random());var u=t.useEndRadian;return r.radian[2]=u?c.lerp(t.minHorizontalEndRadian,t.maxHorizontalEndRadian,Math.random()):r.radian[0],r.radian[3]=u?c.lerp(t.minVerticalEndRadian,t.maxVerticalEndRadian,Math.random()):r.radian[1],r.durationAddScale=t.ageAddScale*Math.random(),r.time=a,r},n(e,["_tempVelocity",function(){return this._tempVelocity=new Float32Array(3)},"_tempStartColor",function(){return this._tempStartColor=new Float32Array(4)},"_tempEndColor",function(){return this._tempEndColor=new Float32Array(4)},"_tempSizeRotation",function(){return this._tempSizeRotation=new Float32Array(3)},"_tempRadius",function(){return this._tempRadius=new Float32Array(2)},"_tempRadian",function(){return this._tempRadian=new Float32Array(4)}]),e}(),S=(function(){function e(e,t,i){this._templet=null,this._timeBetweenParticles=NaN,this._previousPosition=null,this._timeLeftOver=0,this._tempVelocity=new Float32Array([0,0,0]),this._tempPosition=new Float32Array([0,0,0]),this._templet=e,this._timeBetweenParticles=1/t,this._previousPosition=i}a(e,"laya.particle.ParticleEmitter");e.prototype.update=function(e,t){if((e/=1e3)>0){c.subtractVector3(t,this._previousPosition,this._tempVelocity),c.scaleVector3(this._tempVelocity,1/e,this._tempVelocity);for(var i=this._timeLeftOver+e,n=-this._timeLeftOver;i>this._timeBetweenParticles;)n+=this._timeBetweenParticles,i-=this._timeBetweenParticles,c.lerpVector3(this._previousPosition,t,n/e,this._tempPosition),this._templet.addParticleArray(this._tempPosition,this._tempVelocity);this._timeLeftOver=i}this._previousPosition[0]=t[0],this._previousPosition[1]=t[1],this._previousPosition[2]=t[2]}}(),function(){function e(){this.textureName=null,this.textureCount=1,this.maxPartices=100,this.duration=1,this.ageAddScale=0,this.emitterVelocitySensitivity=1,this.minStartSize=100,this.maxStartSize=100,this.minEndSize=100,this.maxEndSize=100,this.minHorizontalVelocity=0,this.maxHorizontalVelocity=0,this.minVerticalVelocity=0,this.maxVerticalVelocity=0,this.endVelocity=1,this.minRotateSpeed=0,this.maxRotateSpeed=0,this.minStartRadius=0,this.maxStartRadius=0,this.minEndRadius=0,this.maxEndRadius=0,this.minHorizontalStartRadian=0,this.maxHorizontalStartRadian=0,this.minVerticalStartRadian=0,this.maxVerticalStartRadian=0,this.useEndRadian=!0,this.minHorizontalEndRadian=0,this.maxHorizontalEndRadian=0,this.minVerticalEndRadian=0,this.maxVerticalEndRadian=0,this.colorComponentInter=!1,this.disableColor=!1,this.blendState=0,this.emitterType="null",this.emissionRate=0,this.sphereEmitterRadius=1,this.sphereEmitterVelocity=0,this.sphereEmitterVelocityAddVariance=0,this.ringEmitterRadius=30,this.ringEmitterVelocity=0,this.ringEmitterVelocityAddVariance=0,this.ringEmitterUp=2,this.gravity=new Float32Array([0,0,0]),this.minStartColor=new Float32Array([1,1,1,1]),this.maxStartColor=new Float32Array([1,1,1,1]),this.minEndColor=new Float32Array([1,1,1,1]),this.maxEndColor=new Float32Array([1,1,1,1]),this.pointEmitterPosition=new Float32Array([0,0,0]),this.pointEmitterPositionVariance=new Float32Array([0,0,0]),this.pointEmitterVelocity=new Float32Array([0,0,0]),this.pointEmitterVelocityAddVariance=new Float32Array([0,0,0]),this.boxEmitterCenterPosition=new Float32Array([0,0,0]),this.boxEmitterSize=new Float32Array([0,0,0]),this.boxEmitterVelocity=new Float32Array([0,0,0]),this.boxEmitterVelocityAddVariance=new Float32Array([0,0,0]),this.sphereEmitterCenterPosition=new Float32Array([0,0,0]),this.ringEmitterCenterPosition=new Float32Array([0,0,0]),this.positionVariance=new Float32Array([0,0,0])}return a(e,"laya.particle.ParticleSetting"),e.checkSetting=function(t){var i;for(i in e._defaultSetting)t.hasOwnProperty(i)||(t[i]=e._defaultSetting[i])},n(e,["_defaultSetting",function(){return this._defaultSetting=new e}]),e}()),I=function(){function e(){this.settings=null,this.texture=null}a(e,"laya.particle.ParticleTemplateBase");return e.prototype.addParticleArray=function(e,t){},e}(),M=function(){function e(){this.u_Duration=NaN,this.u_EndVelocity=NaN,this.u_Gravity=null,this.a_Position=null,this.a_Velocity=null,this.a_StartColor=null,this.a_EndColor=null,this.a_SizeRotation=null,this.a_Radius=null,this.a_Radian=null,this.a_AgeAddScale=NaN,this.gl_Position=null,this.v_Color=null,this.oSize=NaN,this._color=new Float32Array(4),this._position=new Float32Array(3)}a(e,"laya.particle.particleUtils.CanvasShader");var t=e.prototype;return t.getLen=function(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2])},t.ComputeParticlePosition=function(e,t,i,n){this._position[0]=e[0],this._position[1]=e[1],this._position[2]=e[2];var a=this.getLen(t),r=a*n+(a*this.u_EndVelocity-a)*n*n/2,o=NaN;o=this.getLen(t);var s=0;for(3,s=0;s<3;s++)this._position[s]=this._position[s]+t[s]/o*r*this.u_Duration,this._position[s]+=this.u_Gravity[s]*i*n;var h=c.lerp(this.a_Radius[0],this.a_Radius[1],n),l=c.lerp(this.a_Radian[0],this.a_Radian[2],n),p=c.lerp(this.a_Radian[1],this.a_Radian[3],n),u=Math.cos(p)*h;return this._position[1]+=Math.sin(p)*h,this._position[0]+=Math.cos(l)*u,this._position[2]+=Math.sin(l)*u,new Float32Array([this._position[0],this._position[1],0,1])},t.ComputeParticleSize=function(e,t,i){return c.lerp(e,t,i)},t.ComputeParticleRotation=function(e,t){return e*t},t.ComputeParticleColor=function(e,t,i){var n=this._color;return c.lerpVector4(e,t,i,n),n[3]=n[3]*i*(1-i)*(1-i)*6.7,n},t.clamp=function(e,t,i){return e<t?t:e>i?i:e},t.getData=function(e){e*=1+this.a_AgeAddScale;var t=this.clamp(e/this.u_Duration,0,1);this.gl_Position=this.ComputeParticlePosition(this.a_Position,this.a_Velocity,e,t);var i=this.ComputeParticleSize(this.a_SizeRotation[0],this.a_SizeRotation[1],t),n=this.ComputeParticleRotation(this.a_SizeRotation[2],e);this.v_Color=this.ComputeParticleColor(this.a_StartColor,this.a_EndColor,t);var a=new p,r=NaN;r=i/this.oSize*2,a.scale(r,r),a.rotate(n),a.setTranslate(this.gl_Position[0],-this.gl_Position[1]);var o=NaN;return o=this.v_Color[3],[this.v_Color,o,a,this.v_Color[0]*o,this.v_Color[1]*o,this.v_Color[2]*o]},e}(),C=function(){function e(){this.maxIndex=0,this.cmds=null,this.id=0}a(e,"laya.particle.particleUtils.CMDParticle");return e.prototype.setCmds=function(e){this.cmds=e,this.maxIndex=e.length-1},e}(),k=function(){function e(){}return a(e,"laya.particle.particleUtils.PicTool"),e.getCanvasPic=function(e,t){e=e.bitmap;var i=new s("2D"),n=i.getContext("2d");i.size(e.width,e.height);var a=t>>16&255,r=t>>8&255,o=255&t;if(u.isConchApp&&n.setFilter(a/255,r/255,o/255,0),n.drawImage(e.source,0,0),!u.isConchApp){for(var h=n.getImageData(0,0,i.width,i.height),l=h.data,c=0,p=l.length;c<p;c+=4)0!=l[c+3]&&(l[c]*=a/255,l[c+1]*=r/255,l[c+2]*=o/255);n.putImageData(h,0,0)}return i},e.getRGBPic=function(t){return[new f(e.getCanvasPic(t,16711680)),new f(e.getCanvasPic(t,65280)),new f(e.getCanvasPic(t,255))]},e}(),E=function(e){function t(e){this.setting=null,this._posRange=null,this._canvasTemplate=null,this._emitFun=null,t.__super.call(this),this.template=e}a(t,"laya.particle.emitter.Emitter2D",e);var i=t.prototype;return i.emit=function(){e.prototype.emit.call(this),null!=this._emitFun&&this._emitFun()},i.getRandom=function(e){return(2*Math.random()-1)*e},i.webGLEmit=function(){var e=new Float32Array(3);e[0]=this.getRandom(this._posRange[0]),e[1]=this.getRandom(this._posRange[1]),e[2]=this.getRandom(this._posRange[2]);var t=new Float32Array(3);t[0]=0,t[1]=0,t[2]=0,this._particleTemplate.addParticleArray(e,t)},i.canvasEmit=function(){var e=new Float32Array(3);e[0]=this.getRandom(this._posRange[0]),e[1]=this.getRandom(this._posRange[1]),e[2]=this.getRandom(this._posRange[2]);var t=new Float32Array(3);t[0]=0,t[1]=0,t[2]=0,this._particleTemplate.addParticleArray(e,t)},r(0,i,"template",function(){return this._particleTemplate},function(e){this._particleTemplate=e,e||(this._emitFun=null,this.setting=null,this._posRange=null),this.setting=e.settings,this._posRange=this.setting.positionVariance,this._particleTemplate instanceof laya.particle.ParticleTemplate2D?this._emitFun=this.webGLEmit:this._particleTemplate instanceof laya.particle.ParticleTemplateCanvas&&(this._canvasTemplate=e,this._emitFun=this.canvasEmit)}),t}(b),T=function(e){function t(e){this._vertices=null,this._vertexBuffer=null,this._indexBuffer=null,this._floatCountPerVertex=29,this._firstActiveElement=0,this._firstNewElement=0,this._firstFreeElement=0,this._firstRetiredElement=0,this._currentTime=0,this._drawCounter=0,t.__super.call(this),this.settings=e}a(t,"laya.particle.ParticleTemplateWebGL",I);var i=t.prototype;return i.initialize=function(){this._vertices=new Float32Array(this.settings.maxPartices*this._floatCountPerVertex*4);for(var e=0,t=0;t<this.settings.maxPartices;t++){var i=Math.random(),n=this.settings.textureCount?1/this.settings.textureCount:1,a=NaN;for(a=0;a<this.settings.textureCount&&!(i<a+n);a+=n);e=t*this._floatCountPerVertex*4,this._vertices[e+0*this._floatCountPerVertex+0]=-1,this._vertices[e+0*this._floatCountPerVertex+1]=-1,this._vertices[e+0*this._floatCountPerVertex+2]=0,this._vertices[e+0*this._floatCountPerVertex+3]=a,this._vertices[e+1*this._floatCountPerVertex+0]=1,this._vertices[e+1*this._floatCountPerVertex+1]=-1,this._vertices[e+1*this._floatCountPerVertex+2]=1,this._vertices[e+1*this._floatCountPerVertex+3]=a,this._vertices[e+2*this._floatCountPerVertex+0]=1,this._vertices[e+2*this._floatCountPerVertex+1]=1,this._vertices[e+2*this._floatCountPerVertex+2]=1,this._vertices[e+2*this._floatCountPerVertex+3]=a+n,this._vertices[e+3*this._floatCountPerVertex+0]=-1,this._vertices[e+3*this._floatCountPerVertex+1]=1,this._vertices[e+3*this._floatCountPerVertex+2]=0,this._vertices[e+3*this._floatCountPerVertex+3]=a+n}},i.loadContent=function(){},i.update=function(e){this._currentTime+=e/1e3,this.retireActiveParticles(),this.freeRetiredParticles(),this._firstActiveElement==this._firstFreeElement&&(this._currentTime=0),this._firstRetiredElement==this._firstActiveElement&&(this._drawCounter=0)},i.retireActiveParticles=function(){for(var e=this.settings.duration;this._firstActiveElement!=this._firstNewElement;){var t=this._firstActiveElement*this._floatCountPerVertex*4,i=t+28,n=this._currentTime-this._vertices[i];if((n*=1+this._vertices[t+27])+1e-4<e)break;this._vertices[i]=this._drawCounter,this._firstActiveElement++,this._firstActiveElement>=this.settings.maxPartices&&(this._firstActiveElement=0)}},i.freeRetiredParticles=function(){for(;this._firstRetiredElement!=this._firstActiveElement;){if(this._drawCounter-this._vertices[this._firstRetiredElement*this._floatCountPerVertex*4+28]<3)break;this._firstRetiredElement++,this._firstRetiredElement>=this.settings.maxPartices&&(this._firstRetiredElement=0)}},i.addNewParticlesToVertexBuffer=function(){},i.addParticleArray=function(e,t){var i=this._firstFreeElement+1;if(i>=this.settings.maxPartices&&(i=0),i!==this._firstRetiredElement){for(var n=w.Create(this.settings,e,t,this._currentTime),a=this._firstFreeElement*this._floatCountPerVertex*4,r=0;r<4;r++){var o=0,s=0;for(o=0,s=4;o<3;o++)this._vertices[a+r*this._floatCountPerVertex+s+o]=n.position[o];for(o=0,s=7;o<3;o++)this._vertices[a+r*this._floatCountPerVertex+s+o]=n.velocity[o];for(o=0,s=10;o<4;o++)this._vertices[a+r*this._floatCountPerVertex+s+o]=n.startColor[o];for(o=0,s=14;o<4;o++)this._vertices[a+r*this._floatCountPerVertex+s+o]=n.endColor[o];for(o=0,s=18;o<3;o++)this._vertices[a+r*this._floatCountPerVertex+s+o]=n.sizeRotation[o];for(o=0,s=21;o<2;o++)this._vertices[a+r*this._floatCountPerVertex+s+o]=n.radius[o];for(o=0,s=23;o<4;o++)this._vertices[a+r*this._floatCountPerVertex+s+o]=n.radian[o];this._vertices[a+r*this._floatCountPerVertex+27]=n.durationAddScale,this._vertices[a+r*this._floatCountPerVertex+28]=n.time}this._firstFreeElement=i}},t}(),L=function(e){function t(e){this._ready=!1,this.textureList=[],this.particleList=[],this.pX=0,this.pY=0,this.activeParticles=[],this.deadParticles=[],this.iList=[],this._maxNumParticles=0,this.textureWidth=NaN,this.dTextureWidth=NaN,this.colorChange=!0,this.step=1/60,this.canvasShader=new M,t.__super.call(this),this.settings=e,this._maxNumParticles=e.maxPartices,this.texture=new f,this.texture.on("loaded",this,this._textureLoaded),this.texture.load(e.textureName)}a(t,"laya.particle.ParticleTemplateCanvas",I);var i=t.prototype;return i._textureLoaded=function(e){this.setTexture(this.texture),this._ready=!0},i.clear=function(e){void 0===e&&(e=!0),this.deadParticles.length=0,this.activeParticles.length=0,this.textureList.length=0},i.setTexture=function(e){this.texture=e,this.textureWidth=e.width,this.dTextureWidth=1/this.textureWidth,this.pX=.5*-e.width,this.pY=.5*-e.height,this.textureList=t.changeTexture(e,this.textureList),this.particleList.length=0,this.deadParticles.length=0,this.activeParticles.length=0},i._createAParticleData=function(e,t){this.canvasShader.u_EndVelocity=this.settings.endVelocity,this.canvasShader.u_Gravity=this.settings.gravity,this.canvasShader.u_Duration=this.settings.duration;var i;i=w.Create(this.settings,e,t,0),this.canvasShader.a_Position=i.position,this.canvasShader.a_Velocity=i.velocity,this.canvasShader.a_StartColor=i.startColor,this.canvasShader.a_EndColor=i.endColor,this.canvasShader.a_SizeRotation=i.sizeRotation,this.canvasShader.a_Radius=i.radius,this.canvasShader.a_Radian=i.radian,this.canvasShader.a_AgeAddScale=i.durationAddScale,this.canvasShader.oSize=this.textureWidth;var n=new C,a=0,r=this.settings.duration/(1+i.durationAddScale),o=[];for(a=0;a<r;a+=this.step)o.push(this.canvasShader.getData(a));return n.id=this.particleList.length,this.particleList.push(n),n.setCmds(o),n},i.addParticleArray=function(e,t){if(this._ready){var i;this.particleList.length<this._maxNumParticles?(i=this._createAParticleData(e,t),this.iList[i.id]=0,this.activeParticles.push(i)):this.deadParticles.length>0&&(i=this.deadParticles.pop(),this.iList[i.id]=0,this.activeParticles.push(i))}},i.advanceTime=function(e){if(void 0===e&&(e=1),this._ready){var t,i=this.activeParticles,n=this.deadParticles,a=0,r=i.length,o=0,s=this.iList;for(a=r-1;a>-1;a--)(o=s[(t=i[a]).id])>=t.maxIndex?(o=0,i.splice(a,1),n.push(t)):o+=1,s[t.id]=o}},i.render=function(e,t,i){this._ready&&(this.activeParticles.length<1||this.textureList.length<2||(this.settings.disableColor?this.noColorRender(e,t,i):this.canvasRender(e,t,i)))},i.noColorRender=function(e,t,i){var n,a,r=this.activeParticles,o=0,s=r.length,h=NaN,l=this.pX,c=this.pY,p=2*-l,u=2*-c,d=0,_=(this.textureList,this.iList),m=NaN;for(e.translate(t,i),m=e.ctx.globalAlpha,o=0;o<s;o++)d=_[(n=r[o]).id],(a=n.cmds[d])&&((h=a[1])<=.01||(e.setAlpha(m*h),e.drawTextureWithTransform(this.texture,l,c,p,u,a[2],1)));e.setAlpha(m),e.translate(-t,-i)},i.canvasRender=function(e,t,i){var n,a,r,o=this.activeParticles,s=0,h=o.length,l=this.pX,c=this.pY,p=2*-l,u=2*-c,d=0,_=this.textureList,m=this.iList,f=NaN;for(e.translate(t,i),f=e.ctx.globalAlpha,r=e.ctx.globalCompositeOperation,e.blendMode("lighter"),s=0;s<h;s++)d=m[(n=o[s]).id],(a=n.cmds[d])&&(a[1]<=.01||(e.save(),e.transformByMatrix(a[2]),a[3]>.01&&(e.setAlpha(f*a[3]),e.drawTexture(_[0],l,c,p,u)),a[4]>.01&&(e.setAlpha(f*a[4]),e.drawTexture(_[1],l,c,p,u)),a[5]>.01&&(e.setAlpha(f*a[5]),e.drawTexture(_[2],l,c,p,u)),e.restore()));e.setAlpha(f),e.translate(-t,-i),e.blendMode(r)},t.changeTexture=function(e,t,i){return t||(t=[]),t.length=0,i&&i.disableColor?t.push(e,e,e):g.copyArray(t,k.getRGBPic(e)),t},t}(),D=function(e){function t(e){this._vertexBuffer2D=null,this._indexBuffer2D=null,this.x=0,this.y=0,this._blendFn=null,this._startTime=0,this.sv=new N,t.__super.call(this,e);var n=this;i.loader.load(this.settings.textureName,h.create(null,function(e){e.bitmap.enableMerageInAtlas=!1,n.texture=e})),this.sv.u_Duration=this.settings.duration,this.sv.u_Gravity=this.settings.gravity,this.sv.u_EndVelocity=this.settings.endVelocity,this._blendFn=o.fns[e.blendState],this.initialize(),this._vertexBuffer=this._vertexBuffer2D=v.create(-1,35048),this._indexBuffer=this._indexBuffer2D=l.create(35044),this.loadContent()}a(t,"laya.particle.ParticleTemplate2D",e);var n=t.prototype;return i.imps(n,{"laya.webgl.submit.ISubmit":!0}),n.getRenderType=function(){return-111},n.releaseRender=function(){},n.addParticleArray=function(t,i){t[0]+=this.x,t[1]+=this.y,e.prototype.addParticleArray.call(this,t,i)},n.loadContent=function(){for(var e=new Uint16Array(6*this.settings.maxPartices),t=0;t<this.settings.maxPartices;t++)e[6*t+0]=4*t+0,e[6*t+1]=4*t+1,e[6*t+2]=4*t+2,e[6*t+3]=4*t+0,e[6*t+4]=4*t+2,e[6*t+5]=4*t+3;this._indexBuffer2D.clear(),this._indexBuffer2D.append(e),this._indexBuffer2D.upload()},n.addNewParticlesToVertexBuffer=function(){this._vertexBuffer2D.clear(),this._vertexBuffer2D.append(this._vertices);var e=0;this._firstNewElement<this._firstFreeElement?(e=4*this._firstNewElement*this._floatCountPerVertex*4,this._vertexBuffer2D.subUpload(e,e,e+4*(this._firstFreeElement-this._firstNewElement)*this._floatCountPerVertex*4)):(e=4*this._firstNewElement*this._floatCountPerVertex*4,this._vertexBuffer2D.subUpload(e,e,e+4*(this.settings.maxPartices-this._firstNewElement)*this._floatCountPerVertex*4),this._firstFreeElement>0&&(this._vertexBuffer2D.setNeedUpload(),this._vertexBuffer2D.subUpload(0,0,4*this._firstFreeElement*this._floatCountPerVertex*4))),this._firstNewElement=this._firstFreeElement},n.renderSubmit=function(){if(this.texture&&this.texture.loaded){if(this.update(i.timer.delta),this.sv.u_CurrentTime=this._currentTime,this._firstNewElement!=this._firstFreeElement&&this.addNewParticlesToVertexBuffer(),this.blend(),this._firstActiveElement!=this._firstFreeElement){x.mainContext;this._vertexBuffer2D.bind(this._indexBuffer2D),this.sv.u_texture=this.texture.source,this.sv.upload(),this._firstActiveElement<this._firstFreeElement?x.mainContext.drawElements(4,6*(this._firstFreeElement-this._firstActiveElement),5123,6*this._firstActiveElement*2):(x.mainContext.drawElements(4,6*(this.settings.maxPartices-this._firstActiveElement),5123,6*this._firstActiveElement*2),this._firstFreeElement>0&&x.mainContext.drawElements(4,6*this._firstFreeElement,5123,0)),m.drawCall++}this._drawCounter++}return 1},n.blend=function(){if(o.activeBlendFunction!==this._blendFn){var e=x.mainContext;e.enable(3042),this._blendFn(e),o.activeBlendFunction=this._blendFn}},n.dispose=function(){this._vertexBuffer2D.dispose(),this._indexBuffer2D.dispose()},t.activeBlendType=-1,t}(T),N=function(e){function t(){this.a_CornerTextureCoordinate=[4,5126,!1,116,0],this.a_Position=[3,5126,!1,116,16],this.a_Velocity=[3,5126,!1,116,28],this.a_StartColor=[4,5126,!1,116,40],this.a_EndColor=[4,5126,!1,116,56],this.a_SizeRotation=[3,5126,!1,116,72],this.a_Radius=[2,5126,!1,116,84],this.a_Radian=[4,5126,!1,116,92],this.a_AgeAddScale=[1,5126,!1,116,108],this.a_Time=[1,5126,!1,116,112],this.u_CurrentTime=NaN,this.u_Duration=NaN,this.u_Gravity=null,this.u_EndVelocity=NaN,this.u_texture=null,t.__super.call(this,0,0)}a(t,"laya.particle.shader.value.ParticleShaderValue",y);return t.prototype.upload=function(){this.refresh(),t.pShader.upload(this)},n(t,["pShader",function(){return this.pShader=new A}]),t}(),A=(function(t){function n(e){this._matrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this._particleTemplate=null,this._canvasTemplate=null,this._emitter=null,this.autoPlay=!0,n.__super.call(this),e&&this.setParticleSetting(e)}a(n,"laya.particle.Particle2D",t);var o=n.prototype;o.load=function(e){i.loader.load(e,h.create(this,this.setParticleSetting),null,"json")},o.setParticleSetting=function(t){var n=this;if(!t)return this.stop();if(S.checkSetting(t),e.ConchParticleTemplate2D&&!u.isWebGL||(this.customRenderEnable=!0),u.isWebGL)this._particleTemplate=new D(t),this.graphics._saveToCmd(u.context._drawParticle,[this._particleTemplate]);else{if(u.isConchApp&&e.ConchParticleTemplate2D){this._particleTemplate=new ConchParticleTemplate2D;var a=this;return i.loader.load(t.textureName,h.create(null,function(e){a._particleTemplate.texture=e,a._particleTemplate.settings=t,u.isConchNode?a.graphics.drawParticle(a._particleTemplate):a.graphics._saveToCmd(u.context._drawParticle,[n._particleTemplate])})),this._emitter={start:function(){}},this.play=this._particleTemplate.play.bind(this._particleTemplate),this.stop=this._particleTemplate.stop.bind(this._particleTemplate),void(this.autoPlay&&this.play())}this._particleTemplate=this._canvasTemplate=new L(t)}this._emitter?this._emitter.template=this._particleTemplate:this._emitter=new E(this._particleTemplate),this.autoPlay&&(this.emitter.start(),this.play())},o.play=function(){this.timer.frameLoop(1,this,this._loop)},o.stop=function(){this.timer.clear(this,this._loop)},o._loop=function(){this.advanceTime(1/60)},o.advanceTime=function(e){void 0===e&&(e=1),this._canvasTemplate&&this._canvasTemplate.advanceTime(e),this._emitter&&this._emitter.advanceTime(e)},o.customRender=function(e,t,i){if(u.isWebGL){this._matrix4[0]=e.ctx._curMat.a,this._matrix4[1]=e.ctx._curMat.b,this._matrix4[4]=e.ctx._curMat.c,this._matrix4[5]=e.ctx._curMat.d,this._matrix4[12]=e.ctx._curMat.tx,this._matrix4[13]=e.ctx._curMat.ty;this._particleTemplate.sv.u_mmat=this._matrix4}this._canvasTemplate&&this._canvasTemplate.render(e,t,i)},o.destroy=function(e){void 0===e&&(e=!0),this._particleTemplate instanceof laya.particle.ParticleTemplate2D&&this._particleTemplate.dispose(),t.prototype.destroy.call(this,e)},r(0,o,"url",null,function(e){this.load(e)}),r(0,o,"emitter",function(){return this._emitter})}(_),function(e){function t(){t.__super.call(this,t.vs,t.ps,"ParticleShader")}return a(t,"laya.particle.shader.ParticleShader",d),n(t,["vs",function(){return this.vs="attribute vec4 a_CornerTextureCoordinate;\nattribute vec3 a_Position;\nattribute vec3 a_Velocity;\nattribute vec4 a_StartColor;\nattribute vec4 a_EndColor;\nattribute vec3 a_SizeRotation;\nattribute vec2 a_Radius;\nattribute vec4 a_Radian;\nattribute float a_AgeAddScale;\nattribute float a_Time;\n\nvarying vec4 v_Color;\nvarying vec2 v_TextureCoordinate;\n\nuniform float u_CurrentTime;\nuniform float u_Duration;\nuniform float u_EndVelocity;\nuniform vec3 u_Gravity;\n\n#ifdef PARTICLE3D\n uniform mat4 u_WorldMat;\n uniform mat4 u_View;\n uniform mat4 u_Projection;\n uniform vec2 u_ViewportScale;\n#else\n uniform vec2 size;\n uniform mat4 mmat;\n uniform mat4 u_mmat;\n#endif\n\nvec4 ComputeParticlePosition(in vec3 position, in vec3 velocity,in float age,in float normalizedAge)\n{\n\n   float startVelocity = length(velocity);//起始标量速度\n   float endVelocity = startVelocity * u_EndVelocity;//结束标量速度\n\n   float velocityIntegral = startVelocity * normalizedAge +(endVelocity - startVelocity) * normalizedAge *normalizedAge/2.0;//计算当前速度的标量（单位空间），vt=v0*t+(1/2)*a*(t^2)\n   \n   vec3 addPosition = normalize(velocity) * velocityIntegral * u_Duration;//计算受自身速度影响的位置，转换标量到矢量    \n   addPosition += u_Gravity * age * normalizedAge;//计算受重力影响的位置\n   \n   float radius=mix(a_Radius.x, a_Radius.y, normalizedAge); //计算粒子受半径和角度影响（无需计算角度和半径时，可用宏定义优化屏蔽此计算）\n   float radianHorizontal =mix(a_Radian.x,a_Radian.z,normalizedAge);\n   float radianVertical =mix(a_Radian.y,a_Radian.w,normalizedAge);\n   \n   float r =cos(radianVertical)* radius;\n   addPosition.y += sin(radianVertical) * radius;\n\t\n   addPosition.x += cos(radianHorizontal) *r;\n   addPosition.z += sin(radianHorizontal) *r;\n  \n   #ifdef PARTICLE3D\n   position+=addPosition;\n    return  u_Projection*u_View*u_WorldMat*(vec4(position, 1.0));\n   #else\n   addPosition.y=-addPosition.y;//2D粒子位置更新需要取负，2D粒子坐标系Y轴正向朝上\n   position+=addPosition;\n    return  vec4(position,1.0);\n   #endif\n}\n\nfloat ComputeParticleSize(in float startSize,in float endSize, in float normalizedAge)\n{    \n    float size = mix(startSize, endSize, normalizedAge);\n    \n\t#ifdef PARTICLE3D\n    //Project the size into screen coordinates.\n     return size * u_Projection[1][1];\n\t#else\n\t return size;\n\t#endif\n}\n\nmat2 ComputeParticleRotation(in float rot,in float age)\n{    \n    float rotation =rot * age;\n    //计算2x2旋转矩阵.\n    float c = cos(rotation);\n    float s = sin(rotation);\n    return mat2(c, -s, s, c);\n}\n\nvec4 ComputeParticleColor(in vec4 startColor,in vec4 endColor,in float normalizedAge)\n{\n\tvec4 color=mix(startColor,endColor,normalizedAge);\n    //硬编码设置，使粒子淡入很快，淡出很慢,6.7的缩放因子把置归一在0到1之间，可以谷歌x*(1-x)*(1-x)*6.7的制图表\n    color.a *= normalizedAge * (1.0-normalizedAge) * (1.0-normalizedAge) * 6.7;\n   \n    return color;\n}\n\nvoid main()\n{\n   float age = u_CurrentTime - a_Time;\n   age *= 1.0 + a_AgeAddScale;\n   float normalizedAge = clamp(age / u_Duration,0.0,1.0);\n   gl_Position = ComputeParticlePosition(a_Position, a_Velocity, age, normalizedAge);//计算粒子位置\n   float pSize = ComputeParticleSize(a_SizeRotation.x,a_SizeRotation.y, normalizedAge);\n   mat2 rotation = ComputeParticleRotation(a_SizeRotation.z, age);\n\t\n   #ifdef PARTICLE3D\n\tgl_Position.xy += (rotation*a_CornerTextureCoordinate.xy) * pSize * u_ViewportScale;\n   #else\n    mat4 mat=u_mmat*mmat;\n    gl_Position=vec4((mat*gl_Position).xy,0.0,1.0);\n\tgl_Position.xy += (rotation*a_CornerTextureCoordinate.xy) * pSize*vec2(mat[0][0],mat[1][1]);\n    gl_Position=vec4((gl_Position.x/size.x-0.5)*2.0,(0.5-gl_Position.y/size.y)*2.0,0.0,1.0);\n   #endif\n   \n   v_Color = ComputeParticleColor(a_StartColor,a_EndColor, normalizedAge);\n   v_TextureCoordinate =a_CornerTextureCoordinate.zw;\n}\n\n"},"ps",function(){return this.ps="#ifdef FSHIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\nvarying vec4 v_Color;\nvarying vec2 v_TextureCoordinate;\nuniform sampler2D u_texture;\n\nvoid main()\n{\t\n\tgl_FragColor=texture2D(u_texture,v_TextureCoordinate)*v_Color;\n\tgl_FragColor.xyz *= v_Color.w;\n}"}]),t}())}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});for(var i in Laya){var n=Laya[i];n&&n.__isclass&&(t[i]=n)}}),function(global,undefined){"use strict";!function(e,t,i){function n(i){var a=t[i];return a||e[i][0].call(a=t[i]={exports:{}},n,a,a.exports),a.exports}var a=global.protobuf=n(i[0]);"function"==typeof define&&define.amd&&define(["long"],function(e){return a.util.Long=e,a.configure(),a}),"object"==typeof module&&module&&module.exports&&(module.exports=a)}({1:[function(e,t,i){t.exports=function(e,t){for(var i=[],n=2;n<arguments.length;)i.push(arguments[n++]);var a=!0;return new Promise(function(n,r){i.push(function(e){if(a)if(a=!1,e)r(e);else{for(var t=[],i=1;i<arguments.length;)t.push(arguments[i++]);n.apply(null,t)}});try{e.apply(t||this,i)}catch(e){a&&(a=!1,r(e))}})}},{}],2:[function(e,t,i){var n=i;n.length=function(e){var t=e.length;if(!t)return 0;for(var i=0;--t%4>1&&"="===e.charAt(t);)++i;return Math.ceil(3*e.length)/4-i};for(var a=new Array(64),r=new Array(123),o=0;o<64;)r[a[o]=o<26?o+65:o<52?o+71:o<62?o-4:o-59|43]=o++;n.encode=function(e,t,i){for(var n,r=[],o=0,s=0;t<i;){var h=e[t++];switch(s){case 0:r[o++]=a[h>>2],n=(3&h)<<4,s=1;break;case 1:r[o++]=a[n|h>>4],n=(15&h)<<2,s=2;break;case 2:r[o++]=a[n|h>>6],r[o++]=a[63&h],s=0}}return s&&(r[o++]=a[n],r[o]=61,1===s&&(r[o+1]=61)),String.fromCharCode.apply(String,r)};n.decode=function(e,t,i){for(var n,a=i,o=0,s=0;s<e.length;){var h=e.charCodeAt(s++);if(61===h&&o>1)break;if((h=r[h])===undefined)throw Error("invalid encoding");switch(o){case 0:n=h,o=1;break;case 1:t[i++]=n<<2|(48&h)>>4,n=h,o=2;break;case 2:t[i++]=(15&n)<<4|(60&h)>>2,n=h,o=3;break;case 3:t[i++]=(3&n)<<6|h,o=0}}if(1===o)throw Error("invalid encoding");return i-a},n.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},{}],3:[function(e,t,i){function n(){function e(){for(var t=[],n=0;n<arguments.length;)t.push(arguments[n++]);var u=a.apply(null,t),d=c;if(i.length){var _=i[i.length-1];r.test(_)?d=++c:h.test(_)&&++d,s.test(_)&&!s.test(u)?(d=++c,p=!0):p&&l.test(_)&&(d=--c,p=!1),o.test(u)&&(d=--c)}for(n=0;n<d;++n)u="\t"+u;return i.push(u),e}for(var t=[],i=[],c=1,p=!1,u=0;u<arguments.length;)t.push(arguments[u++]);return e.str=function(e){return"function"+(e?" "+e.replace(/[^\w_$]/g,"_"):"")+"("+t.join(",")+") {\n"+i.join("\n")+"\n}"},e.eof=function(t,i){"object"==typeof t&&(i=t,t=undefined);var a=e.str(t);n.verbose&&console.log("--- codegen ---\n"+a.replace(/^/gm,"> ").replace(/\t/g,"  "));var r=Object.keys(i||(i={}));return Function.apply(null,r.concat("return "+a)).apply(null,r.map(function(e){return i[e]}))},e}function a(e){for(var t=[],i=1;i<arguments.length;)t.push(arguments[i++]);if(i=0,e=e.replace(/%([dfjs])/g,function(e,n){switch(n){case"d":return Math.floor(t[i++]);case"f":return Number(t[i++]);case"j":return JSON.stringify(t[i++]);default:return t[i++]}}),i!==t.length)throw Error("argument count mismatch");return e}t.exports=n;var r=/[{[]$/,o=/^[}\]]/,s=/:$/,h=/^\s*(?:if|}?else if|while|for)\b|\b(?:else)\s*$/,l=/\b(?:break|continue)(?: \w+)?;?$|^\s*return\b/;n.sprintf=a,n.supported=!1;try{n.supported=1===n("a","b")("return a-b").eof()(2,1)}catch(e){}n.verbose=!1},{}],4:[function(e,t,i){function n(){this._listeners={}}t.exports=n,n.prototype.on=function(e,t,i){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:i||this}),this},n.prototype.off=function(e,t){if(e===undefined)this._listeners={};else if(t===undefined)this._listeners[e]=[];else for(var i=this._listeners[e],n=0;n<i.length;)i[n].fn===t?i.splice(n,1):++n;return this},n.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var i=[],n=1;n<arguments.length;)i.push(arguments[n++]);for(n=0;n<t.length;)t[n].fn.apply(t[n++].ctx,i)}return this}},{}],5:[function(e,t,i){function n(e,t,i){return"function"==typeof t?(i=t,t={}):t||(t={}),i?!t.xhr&&r&&r.readFile?r.readFile(e,function(a,r){return a&&"undefined"!=typeof XMLHttpRequest?n.xhr(e,t,i):a?i(a):i(null,t.binary?r:r.toString("utf8"))}):n.xhr(e,t,i):a(n,this,e,t)}t.exports=n;var a=e(1),r=e(6)("fs");n.xhr=function(e,t,i){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(4!==n.readyState)return undefined;if(0!==n.status&&200!==n.status)return i(Error("status "+n.status));if(t.binary){var e=n.response;if(!e){e=[];for(var a=0;a<n.responseText.length;++a)e.push(255&n.responseText.charCodeAt(a))}return i(null,"undefined"!=typeof Uint8Array?new Uint8Array(e):e)}return i(null,n.responseText)},t.binary&&("overrideMimeType"in n&&n.overrideMimeType("text/plain; charset=x-user-defined"),n.responseType="arraybuffer"),n.open("GET",e),n.send()}},{1:1,6:6}],6:[function(require,module,exports){function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},{}],7:[function(e,t,i){var n=i,a=n.isAbsolute=function(e){return/^(?:\/|\w+:)/.test(e)},r=n.normalize=function(e){var t=(e=e.replace(/\\/g,"/").replace(/\/{2,}/g,"/")).split("/"),i=a(e),n="";i&&(n=t.shift()+"/");for(var r=0;r<t.length;)".."===t[r]?r>0&&".."!==t[r-1]?t.splice(--r,2):i?t.splice(r,1):++r:"."===t[r]?t.splice(r,1):++r;return n+t.join("/")};n.resolve=function(e,t,i){return i||(t=r(t)),a(t)?t:(i||(e=r(e)),(e=e.replace(/(?:\/|^)[^/]+$/,"")).length?r(e+"/"+t):t)}},{}],8:[function(e,t,i){t.exports=function(e,t,i){var n=i||8192,a=n>>>1,r=null,o=n;return function(i){if(i<1||i>a)return e(i);o+i>n&&(r=e(n),o=0);var s=t.call(r,o,o+=i);return 7&o&&(o=1+(7|o)),s}}},{}],9:[function(e,t,i){var n=i;n.length=function(e){for(var t=0,i=0,n=0;n<e.length;++n)(i=e.charCodeAt(n))<128?t+=1:i<2048?t+=2:55296==(64512&i)&&56320==(64512&e.charCodeAt(n+1))?(++n,t+=4):t+=3;return t},n.read=function(e,t,i){if(i-t<1)return"";for(var n,a=null,r=[],o=0;t<i;)(n=e[t++])<128?r[o++]=n:n>191&&n<224?r[o++]=(31&n)<<6|63&e[t++]:n>239&&n<365?(n=((7&n)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,r[o++]=55296+(n>>10),r[o++]=56320+(1023&n)):r[o++]=(15&n)<<12|(63&e[t++])<<6|63&e[t++],o>8191&&((a||(a=[])).push(String.fromCharCode.apply(String,r)),o=0);return a?(o&&a.push(String.fromCharCode.apply(String,r.slice(0,o))),a.join("")):String.fromCharCode.apply(String,r.slice(0,o))},n.write=function(e,t,i){for(var n,a,r=i,o=0;o<e.length;++o)(n=e.charCodeAt(o))<128?t[i++]=n:n<2048?(t[i++]=n>>6|192,t[i++]=63&n|128):55296==(64512&n)&&56320==(64512&(a=e.charCodeAt(o+1)))?(n=65536+((1023&n)<<10)+(1023&a),++o,t[i++]=n>>18|240,t[i++]=n>>12&63|128,t[i++]=n>>6&63|128,t[i++]=63&n|128):(t[i++]=n>>12|224,t[i++]=n>>6&63|128,t[i++]=63&n|128);return i-r}},{}],10:[function(e,t,i){function n(t,i){if(a||(a=e(34)),!(t instanceof a))throw TypeError("type must be a Type");if(i){if("function"!=typeof i)throw TypeError("ctor must be a function")}else i=n.generate(t).eof(t.name);i.constructor=n,(i.prototype=new r).constructor=i,o.merge(i,r,!0),i.$type=t,i.prototype.$type=t;for(var s=0;s<t.fieldsArray.length;++s)i.prototype[t._fieldsArray[s].name]=Array.isArray(t._fieldsArray[s].resolve().defaultValue)?o.emptyArray:o.isObject(t._fieldsArray[s].defaultValue)&&!t._fieldsArray[s].long?o.emptyObject:t._fieldsArray[s].defaultValue;var h={};for(s=0;s<t.oneofsArray.length;++s)h[t._oneofsArray[s].resolve().name]={get:o.oneOfGetter(t._oneofsArray[s].oneof),set:o.oneOfSetter(t._oneofsArray[s].oneof)};return s&&Object.defineProperties(i.prototype,h),t.ctor=i,i.prototype}t.exports=n;var a,r=e(21),o=e(36);n.generate=function(e){return o.codegen("p")("if(p){")("for(var ks=Object.keys(p),i=0;i<ks.length;++i)")("this[ks[i]]=p[ks[i]];")("}")},n.create=n,n.prototype=r},{21:21,34:34,36:36}],11:[function(e,t,i){function n(e,t){a.test(e)||(e="google/protobuf/"+e+".proto",t={nested:{google:{nested:{protobuf:{nested:t}}}}}),n[e]=t}t.exports=n;var a=/\/|\./;n("any",{Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}}});var r;n("duration",{Duration:r={fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}}}),n("timestamp",{Timestamp:r}),n("empty",{Empty:{fields:{}}}),n("struct",{Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}}}),n("wrappers",{DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}}})},{}],12:[function(e,t,i){function n(e,t,i,n){if(t.resolvedType)if(t.resolvedType instanceof o){e("switch(d%s){",n);for(var a=t.resolvedType.values,r=Object.keys(a),s=0;s<r.length;++s)t.repeated&&a[r[s]]===t.typeDefault&&e("default:"),e("case%j:",r[s])("case %j:",a[r[s]])("m%s=%j",n,a[r[s]])("break");e("}")}else e('if(typeof d%s!=="object")',n)("throw TypeError(%j)",t.fullName+": object expected")("m%s=types[%d].fromObject(d%s)",n,i,n);else{var h=!1;switch(t.type){case"double":case"float":e("m%s=Number(d%s)",n,n);break;case"uint32":case"fixed32":e("m%s=d%s>>>0",n,n);break;case"int32":case"sint32":case"sfixed32":e("m%s=d%s|0",n,n);break;case"uint64":h=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":e("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",n,n,h)('else if(typeof d%s==="string")',n)("m%s=parseInt(d%s,10)",n,n)('else if(typeof d%s==="number")',n)("m%s=d%s",n,n)('else if(typeof d%s==="object")',n)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",n,n,n,h?"true":"");break;case"bytes":e('if(typeof d%s==="string")',n)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",n,n,n)("else if(d%s.length)",n)("m%s=d%s",n,n);break;case"string":e("m%s=String(d%s)",n,n);break;case"bool":e("m%s=Boolean(d%s)",n,n)}}return e}function a(e,t,i,n){if(t.resolvedType)t.resolvedType instanceof o?e("d%s=o.enums===String?types[%d].values[m%s]:m%s",n,i,n,n):e("d%s=types[%d].toObject(m%s,o)",n,i,n);else{var a=!1;switch(t.type){case"uint64":a=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":e('if(typeof m%s==="number")',n)("d%s=o.longs===String?String(m%s):m%s",n,n,n)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",n,n,n,n,a?"true":"",n);break;case"bytes":e("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",n,n,n,n,n);break;default:e("d%s=m%s",n,n)}}return e}var r=i,o=e(15),s=e(36);r.fromObject=function(e){var t=e.fieldsArray,i=s.codegen("d")("if(d instanceof this.ctor)")("return d");if(!t.length)return i("return new this.ctor");i("var m=new this.ctor");for(var a=0;a<t.length;++a){var r=t[a].resolve(),h=s.safeProp(r.name);r.map?(i("if(d%s){",h)('if(typeof d%s!=="object")',h)("throw TypeError(%j)",r.fullName+": object expected")("m%s={}",h)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",h),n(i,r,a,h+"[ks[i]]")("}")("}")):r.repeated?(i("if(d%s){",h)("if(!Array.isArray(d%s))",h)("throw TypeError(%j)",r.fullName+": array expected")("m%s=[]",h)("for(var i=0;i<d%s.length;++i){",h),n(i,r,a,h+"[i]")("}")("}")):(r.resolvedType instanceof o||i("if(d%s!==undefined&&d%s!==null){",h,h),n(i,r,a,h),r.resolvedType instanceof o||i("}"))}return i("return m")},r.toObject=function(e){var t=e.fieldsArray;if(!t.length)return s.codegen()("return {}");for(var i=s.codegen("m","o")("if(!o)")("o={}")("var d={}"),n=[],r=[],h=[],l=0;l<t.length;++l)t[l].resolve().repeated?n.push(t[l]):t[l].map?r.push(t[l]):h.push(t[l]);if(n.length){for(i("if(o.arrays||o.defaults){"),l=0;l<n.length;++l)i("d%s=[]",s.safeProp(n[l].name));i("}")}if(r.length){for(i("if(o.objects||o.defaults){"),l=0;l<r.length;++l)i("d%s={}",s.safeProp(r[l].name));i("}")}if(h.length){for(i("if(o.defaults){"),l=0,c;l<h.length;++l){var c=h[l],p=s.safeProp(c.name);c.resolvedType instanceof o?i("d%s=o.enums===String?%j:%j",p,c.resolvedType.valuesById[c.typeDefault],c.typeDefault):c.long?i("if(util.Long){")("var n=new util.Long(%d,%d,%j)",c.typeDefault.low,c.typeDefault.high,c.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",p)("}else")("d%s=o.longs===String?%j:%d",p,c.typeDefault.toString(),c.typeDefault.toNumber()):c.bytes?i("d%s=o.bytes===String?%j:%s",p,String.fromCharCode.apply(String,c.typeDefault),"["+Array.prototype.slice.call(c.typeDefault).join(",")+"]"):i("d%s=%j",p,c.typeDefault)}i("}")}for(l=0,c;l<t.length;++l){c=t[l];i("if(m%s!==undefined&&m%s!==null&&m.hasOwnProperty(%j)){",p=s.safeProp(c.name),p,c.name),c.map?(i("d%s={}",p)("for(var ks2=Object.keys(m%s),j=0;j<ks2.length;++j){",p),a(i,c,l,p+"[ks2[j]]")("}")):c.repeated?(i("d%s=[]",p)("for(var j=0;j<m%s.length;++j){",p),a(i,c,l,p+"[j]")("}")):a(i,c,l,p),i("}")}return i("return d")}},{15:15,36:36}],13:[function(e,t,i){function n(e){return"missing required '"+e.name+"'"}function a(e){var t=s.codegen("r","l")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor")("while(r.pos<c){")("var t=r.uint32()");e.group&&t("if((t&7)===4)")("break"),t("switch(t>>>3){");for(var i=0;i<e.fieldsArray.length;++i){var h=e._fieldsArray[i].resolve(),l=h.resolvedType instanceof r?"uint32":h.type,c="m"+s.safeProp(h.name);t("case %d:",h.id),h.map?(t("r.skip().pos++")("if(%s===util.emptyObject)",c)("%s={}",c)("var k=r.%s()",h.keyType)("r.pos++"),o.basic[l]===undefined?t('%s[typeof k==="object"?util.longToHash(k):k]=types[%d].decode(r,r.uint32())',c,i):t('%s[typeof k==="object"?util.longToHash(k):k]=r.%s()',c,l)):h.repeated?(t("if(!(%s&&%s.length))",c,c)("%s=[]",c),(a.compat||h.packed)&&o.packed[l]!==undefined&&t("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",c,l)("}else"),o.basic[l]===undefined?t(h.resolvedType.group?"%s.push(types[%d].decode(r))":"%s.push(types[%d].decode(r,r.uint32()))",c,i):t("%s.push(r.%s())",c,l)):o.basic[l]===undefined?t(h.resolvedType.group?"%s=types[%d].decode(r)":"%s=types[%d].decode(r,r.uint32())",c,i):t("%s=r.%s()",c,l),t("break")}for(t("default:")("r.skipType(t&7)")("break")("}")("}"),i=0;i<e._fieldsArray.length;++i){var p=e._fieldsArray[i];p.required&&t("if(!m.hasOwnProperty(%j))",p.name)("throw util.ProtocolError(%j,{instance:m})",n(p))}return t("return m")}t.exports=a,a.compat=!0;var r=e(15),o=e(35),s=e(36)},{15:15,35:35,36:36}],14:[function(e,t,i){function n(e,t,i,n){return t.resolvedType.group?e("types[%d].encode(%s,w.uint32(%d)).uint32(%d)",i,n,(t.id<<3|3)>>>0,(t.id<<3|4)>>>0):e("types[%d].encode(%s,w.uint32(%d).fork()).ldelim()",i,n,(t.id<<3|2)>>>0)}function a(e,t){return e.id-t.id}function r(e){var t,i=h.codegen("m","w")("if(!w)")("w=Writer.create()"),l=e.fieldsArray;r.compat&&(l=l.slice().sort(a));for(_=0;_<l.length;++_){var c=l[_].resolve(),p=r.compat?e._fieldsArray.indexOf(c):_;if(!c.partOf){var u=c.resolvedType instanceof o?"uint32":c.type,d=s.basic[u];t="m"+h.safeProp(c.name),c.map?(i("if(%s&&m.hasOwnProperty(%j)){",t,c.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",t)("w.uint32(%d).fork().uint32(%d).%s(ks[i])",(c.id<<3|2)>>>0,8|s.mapKey[c.keyType],c.keyType),d===undefined?i("types[%d].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",p,t):i(".uint32(%d).%s(%s[ks[i]]).ldelim()",16|d,u,t),i("}")("}")):c.repeated?c.packed&&s.packed[u]!==undefined?i("if(%s&&%s.length&&m.hasOwnProperty(%j)){",t,t,c.name)("w.uint32(%d).fork()",(c.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",t)("w.%s(%s[i])",u,t)("w.ldelim()")("}"):(i("if(%s!==undefined&&m.hasOwnProperty(%j)){",t,c.name)("for(var i=0;i<%s.length;++i)",t),d===undefined?n(i,c,p,t+"[i]"):i("w.uint32(%d).%s(%s[i])",(c.id<<3|d)>>>0,u,t),i("}")):(c.required||(c.long?i("if(%s!==undefined&&%s!==null&&m.hasOwnProperty(%j))",t,t,c.name):c.bytes||c.resolvedType&&!(c.resolvedType instanceof o)?i("if(%s&&m.hasOwnProperty(%j))",t,c.name):i("if(%s!==undefined&&m.hasOwnProperty(%j))",t,c.name)),d===undefined?n(i,c,p,t):i("w.uint32(%d).%s(%s)",(c.id<<3|d)>>>0,u,t))}}for(var _=0;_<e.oneofsArray.length;++_){var m=e._oneofsArray[_];i("switch(%s){","m"+h.safeProp(m.name));for(var f=0;f<m.fieldsArray.length;++f){var u=(c=m.fieldsArray[f]).resolvedType instanceof o?"uint32":c.type,d=s.basic[u];t="m"+h.safeProp(c.name),i("case%j:",c.name),d===undefined?n(i,c,e._fieldsArray.indexOf(c),t):i("w.uint32(%d).%s(%s)",(c.id<<3|d)>>>0,u,t),i("break")}i("}")}return i("return w")}t.exports=r,r.compat=!0;var o=e(15),s=e(35),h=e(36)},{15:15,35:35,36:36}],15:[function(e,t,i){function n(e,t,i){if(a.call(this,e,i),t&&"object"!=typeof t)throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comments={},t)for(var n=Object.keys(t),r=0;r<n.length;++r)this.valuesById[this.values[n[r]]=t[n[r]]]=n[r]}t.exports=n;var a=e(24);((n.prototype=Object.create(a.prototype)).constructor=n).className="Enum";var r=e(36);n.fromJSON=function(e,t){return new n(e,t.values,t.options)},n.prototype.toJSON=function(){return{options:this.options,values:this.values}},n.prototype.add=function(e,t,i){if(!r.isString(e))throw TypeError("name must be a string");if(!r.isInteger(t))throw TypeError("id must be an integer");if(this.values[e]!==undefined)throw Error("duplicate name");if(this.valuesById[t]!==undefined){if(!this.options||!this.options.allow_alias)throw Error("duplicate id");this.values[e]=t}else this.valuesById[this.values[e]=t]=e;return this.comments[e]=i||null,this},n.prototype.remove=function(e){if(!r.isString(e))throw TypeError("name must be a string");var t=this.values[e];if(t===undefined)throw Error("name does not exist");return delete this.valuesById[t],delete this.values[e],delete this.comments[e],this}},{24:24,36:36}],16:[function(e,t,i){function n(e,t,i,n,r,o){if(h.isObject(n)?(o=n,n=r=undefined):h.isObject(r)&&(o=r,r=undefined),a.call(this,e,o),!h.isInteger(t)||t<0)throw TypeError("id must be a non-negative integer");if(!h.isString(i))throw TypeError("type must be a string");if(n!==undefined&&!l.test(n=n.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(r!==undefined&&!h.isString(r))throw TypeError("extend must be a string");this.rule=n&&"optional"!==n?n:undefined,this.type=i,this.id=t,this.extend=r||undefined,this.required="required"===n,this.optional=!this.required,this.repeated="repeated"===n,this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=!!h.Long&&s.long[i]!==undefined,this.bytes="bytes"===i,this.resolvedType=null,this.extensionField=null,this.declaringField=null,this._packed=null}t.exports=n;var a=e(24);((n.prototype=Object.create(a.prototype)).constructor=n).className="Field";var r,o=e(15),s=e(35),h=e(36),l=/^required|optional|repeated$/;Object.defineProperty(n.prototype,"packed",{get:function(){return null===this._packed&&(this._packed=!1!==this.getOption("packed")),this._packed}}),n.prototype.setOption=function(e,t,i){return"packed"===e&&(this._packed=null),a.prototype.setOption.call(this,e,t,i)},n.fromJSON=function(e,t){return new n(e,t.id,t.type,t.rule,t.extend,t.options)},n.prototype.toJSON=function(){return{rule:"optional"!==this.rule&&this.rule||undefined,type:this.type,id:this.id,extend:this.extend,options:this.options}},n.prototype.resolve=function(){if(this.resolved)return this;if((this.typeDefault=s.defaults[this.type])===undefined){r||(r=e(34));var t=this.declaringField?this.declaringField.parent:this.parent;if(this.resolvedType=t.lookup(this.type,r))this.typeDefault=null;else{if(!(this.resolvedType=t.lookup(this.type,o)))throw Error("unresolvable field type: "+this.type+" in "+t);this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]}}if(this.options&&this.options.default!==undefined&&(this.typeDefault=this.options.default,this.resolvedType instanceof o&&"string"==typeof this.typeDefault&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),!this.options||this.options.packed===undefined||!this.resolvedType||this.resolvedType instanceof o||delete this.options.packed,this.long)this.typeDefault=h.Long.fromNumber(this.typeDefault,"u"===this.type.charAt(0)),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&"string"==typeof this.typeDefault){var i;h.base64.test(this.typeDefault)?h.base64.decode(this.typeDefault,i=h.newBuffer(h.base64.length(this.typeDefault)),0):h.utf8.write(this.typeDefault,i=h.newBuffer(h.utf8.length(this.typeDefault)),0),this.typeDefault=i}return this.map?this.defaultValue=h.emptyObject:this.repeated?this.defaultValue=h.emptyArray:this.defaultValue=this.typeDefault,a.prototype.resolve.call(this)}},{15:15,24:24,34:34,35:35,36:36}],17:[function(e,t,i){var n=t.exports=e(18);n.build="light",n.load=function(e,t,i){return"function"==typeof t?(i=t,t=new n.Root):t||(t=new n.Root),t.load(e,i)},n.loadSync=function(e,t){return t||(t=new n.Root),t.loadSync(e)},n.encoder=e(14),n.decoder=e(13),n.verifier=e(39),n.converter=e(12),n.ReflectionObject=e(24),n.Namespace=e(23),n.Root=e(29),n.Enum=e(15),n.Type=e(34),n.Field=e(16),n.OneOf=e(25),n.MapField=e(20),n.Service=e(32),n.Method=e(22),n.Class=e(10),n.Message=e(21),n.types=e(35),n.util=e(36),n.ReflectionObject._configure(n.Root),n.Namespace._configure(n.Type,n.Service),n.Root._configure(n.Type)},{10:10,12:12,13:13,14:14,15:15,16:16,18:18,20:20,21:21,22:22,23:23,24:24,25:25,29:29,32:32,34:34,35:35,36:36,39:39}],18:[function(e,t,i){function n(){a.Reader._configure(a.BufferReader),a.util._configure()}var a=i;a.build="minimal",a.roots={},a.Writer=e(40),a.BufferWriter=e(41),a.Reader=e(27),a.BufferReader=e(28),a.util=e(38),a.rpc=e(30),a.configure=n,a.Writer._configure(a.BufferWriter),n()},{27:27,28:28,30:30,38:38,40:40,41:41}],19:[function(e,t,i){var n=t.exports=e(17);n.build="full",n.tokenize=e(33),n.parse=e(26),n.common=e(11),n.Root._configure(n.Type,n.parse,n.common)},{11:11,17:17,26:26,33:33}],20:[function(e,t,i){function n(e,t,i,n,r){if(a.call(this,e,t,n,r),!o.isString(i))throw TypeError("keyType must be a string");this.keyType=i,this.resolvedKeyType=null,this.map=!0}t.exports=n;var a=e(16);((n.prototype=Object.create(a.prototype)).constructor=n).className="MapField";var r=e(35),o=e(36);n.fromJSON=function(e,t){return new n(e,t.id,t.keyType,t.type,t.options)},n.prototype.toJSON=function(){return{keyType:this.keyType,type:this.type,id:this.id,extend:this.extend,options:this.options}},n.prototype.resolve=function(){if(this.resolved)return this;if(r.mapKey[this.keyType]===undefined)throw Error("invalid key type: "+this.keyType);return a.prototype.resolve.call(this)}},{16:16,35:35,36:36}],21:[function(e,t,i){function n(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)this[t[i]]=e[t[i]]}t.exports=n;var a=e(36);n.encode=function(e,t){return this.$type.encode(e,t)},n.encodeDelimited=function(e,t){return this.$type.encodeDelimited(e,t)},n.decode=function(e){return this.$type.decode(e)},n.decodeDelimited=function(e){return this.$type.decodeDelimited(e)},n.verify=function(e){return this.$type.verify(e)},n.from=n.fromObject=function(e){return this.$type.fromObject(e)},n.toObject=function(e,t){return this.$type.toObject(e,t)},n.prototype.toObject=function(e){return this.$type.toObject(this,e)},n.prototype.toJSON=function(){return this.$type.toObject(this,a.toJSONOptions)}},{36:36}],22:[function(e,t,i){function n(e,t,i,n,o,s,h){if(r.isObject(o)?(h=o,o=s=undefined):r.isObject(s)&&(h=s,s=undefined),t!==undefined&&!r.isString(t))throw TypeError("type must be a string");if(!r.isString(i))throw TypeError("requestType must be a string");if(!r.isString(n))throw TypeError("responseType must be a string");a.call(this,e,h),this.type=t||"rpc",this.requestType=i,this.requestStream=!!o||undefined,this.responseType=n,this.responseStream=!!s||undefined,this.resolvedRequestType=null,this.resolvedResponseType=null}t.exports=n;var a=e(24);((n.prototype=Object.create(a.prototype)).constructor=n).className="Method";var r=e(36);n.fromJSON=function(e,t){return new n(e,t.type,t.requestType,t.responseType,t.requestStream,t.responseStream,t.options)},n.prototype.toJSON=function(){return{type:"rpc"!==this.type&&this.type||undefined,requestType:this.requestType,requestStream:this.requestStream,responseType:this.responseType,responseStream:this.responseStream,options:this.options}},n.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),a.prototype.resolve.call(this))}},{24:24,36:36}],23:[function(e,t,i){function n(e){if(!e||!e.length)return undefined;for(var t={},i=0;i<e.length;++i)t[e[i].name]=e[i].toJSON();return t}function a(e,t){o.call(this,e,t),this.nested=undefined,this._nestedArray=null}function r(e){return e._nestedArray=null,e}t.exports=a;var o=e(24);((a.prototype=Object.create(o.prototype)).constructor=a).className="Namespace";var s,h,l=e(15),c=e(16),p=e(36);a.fromJSON=function(e,t){return new a(e,t.options).addJSON(t.nested)},a.arrayToJSON=n,Object.defineProperty(a.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=p.toArray(this.nested))}}),a.prototype.toJSON=function(){return{options:this.options,nested:n(this.nestedArray)}},a.prototype.addJSON=function(e){if(e)for(var t,i=Object.keys(e),n=0;n<i.length;++n)t=e[i[n]],this.add((t.fields!==undefined?s.fromJSON:t.values!==undefined?l.fromJSON:t.methods!==undefined?h.fromJSON:t.id!==undefined?c.fromJSON:a.fromJSON)(i[n],t));return this},a.prototype.get=function(e){return this.nested&&this.nested[e]||null},a.prototype.getEnum=function(e){if(this.nested&&this.nested[e]instanceof l)return this.nested[e].values;throw Error("no such enum")},a.prototype.add=function(e){if(!(e instanceof c&&e.extend!==undefined||e instanceof s||e instanceof l||e instanceof h||e instanceof a))throw TypeError("object must be a valid nested object");if(this.nested){var t=this.get(e.name);if(t){if(!(t instanceof a&&e instanceof a)||t instanceof s||t instanceof h)throw Error("duplicate name '"+e.name+"' in "+this);for(var i=t.nestedArray,n=0;n<i.length;++n)e.add(i[n]);this.remove(t),this.nested||(this.nested={}),e.setOptions(t.options,!0)}}else this.nested={};return this.nested[e.name]=e,e.onAdd(this),r(this)},a.prototype.remove=function(e){if(!(e instanceof o))throw TypeError("object must be a ReflectionObject");if(e.parent!==this)throw Error(e+" is not a member of "+this);return delete this.nested[e.name],Object.keys(this.nested).length||(this.nested=undefined),e.onRemove(this),r(this)},a.prototype.define=function(e,t){if(p.isString(e))e=e.split(".");else if(!Array.isArray(e))throw TypeError("illegal path");if(e&&e.length&&""===e[0])throw Error("path must be relative");for(var i=this;e.length>0;){var n=e.shift();if(i.nested&&i.nested[n]){if(!((i=i.nested[n])instanceof a))throw Error("path conflicts with non-namespace objects")}else i.add(i=new a(n))}return t&&i.addJSON(t),i},a.prototype.resolveAll=function(){for(var e=this.nestedArray,t=0;t<e.length;)e[t]instanceof a?e[t++].resolveAll():e[t++].resolve();return this.resolve()},a.prototype.lookup=function(e,t,i){if("boolean"==typeof t&&(i=t,t=undefined),p.isString(e)&&e.length){if("."===e)return this.root;e=e.split(".")}else if(!e.length)return this;if(""===e[0])return this.root.lookup(e.slice(1),t);var n=this.get(e[0]);if(n)if(1===e.length){if(!t||n instanceof t)return n}else if(n instanceof a&&(n=n.lookup(e.slice(1),t,!0)))return n;return null===this.parent||i?null:this.parent.lookup(e,t)},a.prototype.lookupType=function(e){var t=this.lookup(e,s);if(!t)throw Error("no such type");return t},a.prototype.lookupService=function(e){var t=this.lookup(e,h);if(!t)throw Error("no such service");return t},a.prototype.lookupEnum=function(e){var t=this.lookup(e,l);if(!t)throw Error("no such enum");return t.values},a._configure=function(e,t){s=e,h=t}},{15:15,16:16,24:24,36:36}],24:[function(e,t,i){function n(e,t){if(!r.isString(e))throw TypeError("name must be a string");if(t&&!r.isObject(t))throw TypeError("options must be an object");this.options=t,this.name=e,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}t.exports=n,n.className="ReflectionObject";var a,r=e(36);Object.defineProperties(n.prototype,{root:{get:function(){for(var e=this;null!==e.parent;)e=e.parent;return e}},fullName:{get:function(){for(var e=[this.name],t=this.parent;t;)e.unshift(t.name),t=t.parent;return e.join(".")}}}),n.prototype.toJSON=function(){throw Error()},n.prototype.onAdd=function(e){this.parent&&this.parent!==e&&this.parent.remove(this),this.parent=e,this.resolved=!1;var t=e.root;t instanceof a&&t._handleAdd(this)},n.prototype.onRemove=function(e){var t=e.root;t instanceof a&&t._handleRemove(this),this.parent=null,this.resolved=!1},n.prototype.resolve=function(){return this.resolved?this:(this.root instanceof a&&(this.resolved=!0),this)},n.prototype.getOption=function(e){return this.options?this.options[e]:undefined},n.prototype.setOption=function(e,t,i){return i&&this.options&&this.options[e]!==undefined||((this.options||(this.options={}))[e]=t),this},n.prototype.setOptions=function(e,t){if(e)for(var i=Object.keys(e),n=0;n<i.length;++n)this.setOption(i[n],e[i[n]],t);return this},n.prototype.toString=function(){var e=this.constructor.className,t=this.fullName;return t.length?e+" "+t:e},n._configure=function(e){a=e}},{36:36}],25:[function(e,t,i){function n(e,t,i){if(Array.isArray(t)||(i=t,t=undefined),r.call(this,e,i),t!==undefined&&!Array.isArray(t))throw TypeError("fieldNames must be an Array");this.oneof=t||[],this.fieldsArray=[]}function a(e){if(e.parent)for(var t=0;t<e.fieldsArray.length;++t)e.fieldsArray[t].parent||e.parent.add(e.fieldsArray[t])}t.exports=n;var r=e(24);((n.prototype=Object.create(r.prototype)).constructor=n).className="OneOf";var o=e(16);n.fromJSON=function(e,t){return new n(e,t.oneof,t.options)},n.prototype.toJSON=function(){return{oneof:this.oneof,options:this.options}},n.prototype.add=function(e){if(!(e instanceof o))throw TypeError("field must be a Field");return e.parent&&e.parent!==this.parent&&e.parent.remove(e),this.oneof.push(e.name),this.fieldsArray.push(e),e.partOf=this,a(this),this},n.prototype.remove=function(e){if(!(e instanceof o))throw TypeError("field must be a Field");var t=this.fieldsArray.indexOf(e);if(t<0)throw Error(e+" is not a member of "+this);return this.fieldsArray.splice(t,1),(t=this.oneof.indexOf(e.name))>-1&&this.oneof.splice(t,1),e.partOf=null,this},n.prototype.onAdd=function(e){r.prototype.onAdd.call(this,e);for(var t=0;t<this.oneof.length;++t){var i=e.get(this.oneof[t]);i&&!i.partOf&&(i.partOf=this,this.fieldsArray.push(i))}a(this)},n.prototype.onRemove=function(e){for(var t,i=0;i<this.fieldsArray.length;++i)(t=this.fieldsArray[i]).parent&&t.parent.remove(t);r.prototype.onRemove.call(this,e)}},{16:16,24:24}],26:[function(e,t,i){function n(e){return null===e?null:e.toLowerCase()}function a(e,t,i){function k(e,t,i){var n=a.filename;return i||(a.filename=null),Error("illegal "+(t||"token")+" '"+e+"' ("+(n?n+", ":"")+"line "+j.line()+")")}function E(){var e,t=[];do{if('"'!==(e=W())&&"'"!==e)throw k(e);t.push(W()),J(e),e=K()}while('"'===e||"'"===e);return t.join("")}function T(e){var t=W();switch(n(t)){case"'":case'"':return q(t),E();case"true":return!0;case"false":return!1}try{return function(e,t){var i=1;"-"===e.charAt(0)&&(i=-1,e=e.substring(1));var a=n(e);switch(a){case"inf":return i*(1/0);case"nan":return NaN;case"0":return 0}if(f.test(e))return i*parseInt(e,10);if(y.test(a))return i*parseInt(e,16);if(x.test(e))return i*parseInt(e,8);if(w.test(a))return i*parseFloat(e);throw k(e,"number",t)}(t,!0)}catch(i){if(e&&I.test(t))return t;throw k(t,"value")}}function L(e,t){var i,n;do{!t||'"'!==(i=K())&&"'"!==i?e.push([n=D(W()),J("to",!0)?D(W()):n]):e.push(E())}while(J(",",!0));J(";")}function D(e,t){var i=n(e);switch(i){case"max":return 536870911;case"0":return 0}if("-"===e.charAt(0)&&!t)throw k(e,"id");if(g.test(e))return parseInt(e,10);if(v.test(i))return parseInt(e,16);if(b.test(e))return parseInt(e,8);throw k(e,"id")}function N(){if(H!==undefined)throw k("package");if(H=W(),!I.test(H))throw k(H,"name");ee=ee.define(H),J(";")}function A(){var e,t=K();switch(t){case"weak":e=X||(X=[]),W();break;case"public":W();default:e=z||(z=[])}t=E(),J(";"),e.push(t)}function R(){if(J("="),Y=n(E()),!($="proto3"===Y)&&"proto2"!==Y)throw k(Y,"syntax");J(";")}function B(e,t){switch(t){case"option":return O(e,t),J(";"),!0;case"message":return function(e,t){var i=W();if(!S.test(i))throw k(i,"type name");var r=new s(i);if(r.comment=Z(),r.filename=a.filename,J("{",!0)){for(;"}"!==(t=W());){var o=n(t);if(!B(r,t))switch(o){case"map":!function(e){J("<");var t=W();if(_.mapKey[t]===undefined)throw k(t,"type");J(",");var i=W();if(!I.test(i))throw k(i,"type");J(">");var n=W();if(!S.test(n))throw k(n,"name");n=te(n),J("=");var r=new l(n,D(W()),t,i),o=j.line();r.comment=Z(),r.filename=a.filename,F(r),r.comment||(r.comment=Z(o));e.add(r)}(r);break;case"required":case"optional":case"repeated":P(r,o);break;case"oneof":!function(e,t){var i=W();if(!S.test(i))throw k(i,"name");i=te(i);var n=new c(i),r=j.line();if(n.comment=Z(),n.filename=a.filename,J("{",!0)){for(;"}"!==(t=W());)"option"===t?(O(n,t),J(";")):(q(t),P(n,"optional"));J(";",!0)}else J(";"),n.comment||(n.comment=Z(r));e.add(n)}(r,o);break;case"extensions":L(r.extensions||(r.extensions=[]));break;case"reserved":L(r.reserved||(r.reserved=[]),!0);break;default:if(!$||!I.test(t))throw k(t);q(t),P(r,"optional")}}J(";",!0)}else J(";");e.add(r)}(e,t),!0;case"enum":return function(e,t){var i=W();if(!S.test(i))throw k(i,"name");var r=new p(i);if(r.comment=Z(),r.filename=a.filename,J("{",!0)){for(;"}"!==(t=W());)"option"===n(t)?(O(r,t),J(";")):function(e,t){if(!S.test(t))throw k(t,"name");var i=t;J("=");var n=D(W(),!0),a=j.line();e.add(i,n,Z()),F({}),e.comments[i]||(e.comments[i]=Z(a))}(r,t);J(";",!0)}else J(";");e.add(r)}(e,t),!0;case"service":return function(e,t){if(t=W(),!S.test(t))throw k(t,"service name");var i=new u(t);if(i.comment=Z(),i.filename=a.filename,J("{",!0)){for(;"}"!==(t=W());){var r=n(t);switch(r){case"option":O(i,r),J(";");break;case"rpc":!function(e,t){var i=t,r=W();if(!S.test(r))throw k(r,"name");var o,s,h,l;J("("),J("stream",!0)&&(s=!0);if(!I.test(t=W()))throw k(t);o=t,J(")"),J("returns"),J("("),J("stream",!0)&&(l=!0);if(!I.test(t=W()))throw k(t);h=t,J(")");var c=new d(r,i,o,h,s,l),p=j.line();if(c.comment=Z(),c.filename=a.filename,J("{",!0)){for(;"}"!==(t=W());){var u=n(t);switch(u){case"option":O(c,u),J(";");break;default:throw k(t)}}J(";",!0)}else J(";"),c.comment||(c.comment=Z(p));e.add(c)}(i,r);break;default:throw k(t)}}J(";",!0)}else J(";");e.add(i)}(e,t),!0;case"extend":return function(e,t){var i=W();if(!I.test(i))throw k(i,"reference");if(J("{",!0)){for(;"}"!==(t=W());){var a=n(t);switch(a){case"required":case"repeated":case"optional":P(e,a,i);break;default:if(!$||!I.test(t))throw k(t);q(t),P(e,"optional",i)}}J(";",!0)}else J(";")}(e,t),!0}return!1}function P(e,t,i){var r=W();if("group"!==r){if(!I.test(r))throw k(r,"type");var o=W();if(!S.test(o))throw k(o,"name");o=te(o),J("=");var l=new h(o,D(W()),r,t,i),c=j.line();l.comment=Z(),l.filename=a.filename,F(l),l.comment||(l.comment=Z(c)),!$&&l.repeated&&l.setOption("packed",!1,!0),e.add(l)}else!function(e,t){var i=W();if(!S.test(i))throw k(i,"name");var r=m.lcFirst(i);i===r&&(i=m.ucFirst(i));J("=");var o=D(W()),l=new s(i);l.group=!0,l.comment=Z();var c=new h(r,o,i,t);l.filename=c.filename=a.filename,J("{");for(;"}"!==(G=W());)switch(G=n(G)){case"option":O(l,G),J(";");break;case"required":case"optional":case"repeated":P(l,G);break;default:throw k(G)}J(";",!0),e.add(l).add(c)}(e,t)}function O(e,t){var i=J("(",!0),n=W();if(!I.test(n))throw k(n,"name");i&&(J(")"),n="("+n+")",t=K(),M.test(t)&&(n+=t,W())),J("="),V(e,n)}function V(e,t){if(J("{",!0))do{if(!S.test(G=W()))throw k(G,"name");"{"===K()?V(e,t+"."+G):(J(":"),U(e,t+"."+G,T(!0)))}while(!J("}",!0));else U(e,t,T(!0))}function U(e,t,i){e.setOption&&e.setOption(t,i)}function F(e){if(J("[",!0)){do{O(e,"option")}while(J(",",!0));J("]")}return J(";"),e}t instanceof o||(i=t,t=new o),i||(i=a.defaults);for(var H,z,X,Y,G,j=r(e),W=j.next,q=j.push,K=j.peek,J=j.skip,Z=j.cmnt,Q=!0,$=!1,ee=t,te=i.keepCase?function(e){return e}:function(e){return e.substring(0,1)+e.substring(1).replace(C,function(e,t){return t.toUpperCase()})};null!==(G=W());){switch(n(G)){case"package":if(!Q)throw k(G);N();break;case"import":if(!Q)throw k(G);A();break;case"syntax":if(!Q)throw k(G);R();break;case"option":if(!Q)throw k(G);O(ee,G),J(";");break;default:if(B(ee,G)){Q=!1;continue}throw k(G)}}return a.filename=null,{package:H,imports:z,weakImports:X,syntax:Y,root:t}}t.exports=a,a.filename=null,a.defaults={keepCase:!1};var r=e(33),o=e(29),s=e(34),h=e(16),l=e(20),c=e(25),p=e(15),u=e(32),d=e(22),_=e(35),m=e(36),f=/^[1-9][0-9]*$/,g=/^-?[1-9][0-9]*$/,y=/^0[x][0-9a-f]+$/,v=/^-?0[x][0-9a-f]+$/,x=/^0[0-7]+$/,b=/^-?0[0-7]+$/,w=/^(?!e)[0-9]*(?:\.[0-9]*)?(?:[e][+-]?[0-9]+)?$/,S=/^[a-zA-Z_][a-zA-Z_0-9]*$/,I=/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)+$/,M=/^(?:\.[a-zA-Z][a-zA-Z_0-9]*)+$/,C=/_([a-z])(?=[a-z]|$)/g},{15:15,16:16,20:20,22:22,25:25,29:29,32:32,33:33,34:34,35:35,36:36}],27:[function(e,t,i){function n(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function a(e){this.buf=e,this.pos=0,this.len=e.length}function r(){var e=new c(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw n(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw n(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function o(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function s(){if(this.pos+8>this.len)throw n(this,8);return new c(o(this.buf,this.pos+=4),o(this.buf,this.pos+=4))}t.exports=a;var h,l=e(38),c=l.LongBits,p=l.utf8,u="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new a(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new a(e);throw Error("illegal buffer")};a.create=l.Buffer?function(e){return(a.create=function(e){return l.Buffer.isBuffer(e)?new h(e):u(e)})(e)}:u,a.prototype._slice=l.Array.prototype.subarray||l.Array.prototype.slice,a.prototype.uint32=function(){var e=4294967295;return function(){if(e=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return e;if((this.pos+=5)>this.len)throw this.pos=this.len,n(this,10);return e}}(),a.prototype.int32=function(){return 0|this.uint32()},a.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},a.prototype.bool=function(){return 0!==this.uint32()},a.prototype.fixed32=function(){if(this.pos+4>this.len)throw n(this,4);return o(this.buf,this.pos+=4)},a.prototype.sfixed32=function(){if(this.pos+4>this.len)throw n(this,4);return 0|o(this.buf,this.pos+=4)};var d="undefined"!=typeof Float32Array?function(){var e=new Float32Array(1),t=new Uint8Array(e.buffer);return e[0]=-0,t[3]?function(i,n){return t[0]=i[n],t[1]=i[n+1],t[2]=i[n+2],t[3]=i[n+3],e[0]}:function(i,n){return t[0]=i[n+3],t[1]=i[n+2],t[2]=i[n+1],t[3]=i[n],e[0]}}():function(e,t){var i=o(e,t+4),n=2*(i>>31)+1,a=i>>>23&255,r=8388607&i;return 255===a?r?NaN:n*(1/0):0===a?1.401298464324817e-45*n*r:n*Math.pow(2,a-150)*(r+8388608)};a.prototype.float=function(){if(this.pos+4>this.len)throw n(this,4);var e=d(this.buf,this.pos);return this.pos+=4,e};var _="undefined"!=typeof Float64Array?function(){var e=new Float64Array(1),t=new Uint8Array(e.buffer);return e[0]=-0,t[7]?function(i,n){return t[0]=i[n],t[1]=i[n+1],t[2]=i[n+2],t[3]=i[n+3],t[4]=i[n+4],t[5]=i[n+5],t[6]=i[n+6],t[7]=i[n+7],e[0]}:function(i,n){return t[0]=i[n+7],t[1]=i[n+6],t[2]=i[n+5],t[3]=i[n+4],t[4]=i[n+3],t[5]=i[n+2],t[6]=i[n+1],t[7]=i[n],e[0]}}():function(e,t){var i=o(e,t+4),n=o(e,t+8),a=2*(n>>31)+1,r=n>>>20&2047,s=4294967296*(1048575&n)+i;return 2047===r?s?NaN:a*(1/0):0===r?5e-324*a*s:a*Math.pow(2,r-1075)*(s+4503599627370496)};a.prototype.double=function(){if(this.pos+8>this.len)throw n(this,4);var e=_(this.buf,this.pos);return this.pos+=8,e},a.prototype.bytes=function(){var e=this.uint32(),t=this.pos,i=this.pos+e;if(i>this.len)throw n(this,e);return this.pos+=e,t===i?new this.buf.constructor(0):this._slice.call(this.buf,t,i)},a.prototype.string=function(){var e=this.bytes();return p.read(e,0,e.length)},a.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw n(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw n(this)}while(128&this.buf[this.pos++]);return this},a.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;;){if(4==(e=7&this.uint32()))break;this.skipType(e)}break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},a._configure=function(e){h=e;var t=l.Long?"toLong":"toNumber";l.merge(a.prototype,{int64:function(){return r.call(this)[t](!1)},uint64:function(){return r.call(this)[t](!0)},sint64:function(){return r.call(this).zzDecode()[t](!1)},fixed64:function(){return s.call(this)[t](!0)},sfixed64:function(){return s.call(this)[t](!1)}})}},{38:38}],28:[function(e,t,i){function n(e){a.call(this,e)}t.exports=n;var a=e(27);(n.prototype=Object.create(a.prototype)).constructor=n;var r=e(38);r.Buffer&&(n.prototype._slice=r.Buffer.prototype.slice),n.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len))}},{27:27,38:38}],29:[function(e,t,i){function n(e){o.call(this,"",e),this.deferred=[],this.files=[]}function a(){}function r(e,t){var i=t.parent.lookup(t.extend);if(i){var n=new c(t.fullName,t.id,t.type,t.rule,undefined,t.options);return n.declaringField=t,t.extensionField=n,i.add(n),!0}return!1}t.exports=n;var o=e(23);((n.prototype=Object.create(o.prototype)).constructor=n).className="Root";var s,h,l,c=e(16),p=e(15),u=e(36);n.fromJSON=function(e,t){return t||(t=new n),e.options&&t.setOptions(e.options),t.addJSON(e.nested)},n.prototype.resolvePath=u.path.resolve,n.prototype.load=function e(t,i,n){function r(e,t){if(n){var i=n;if(n=null,p)throw e;i(e,t)}}function o(e,t){try{if(u.isString(t)&&"{"===t.charAt(0)&&(t=JSON.parse(t)),u.isString(t)){h.filename=e;var n,a=h(t,c,i),o=0;if(a.imports)for(;o<a.imports.length;++o)(n=c.resolvePath(e,a.imports[o]))&&s(n);if(a.weakImports)for(o=0;o<a.weakImports.length;++o)(n=c.resolvePath(e,a.weakImports[o]))&&s(n,!0)}else c.setOptions(t.options).addJSON(t.nested)}catch(e){r(e)}p||d||r(null,c)}function s(e,t){var i=e.lastIndexOf("google/protobuf/");if(i>-1){var a=e.substring(i);a in l&&(e=a)}if(!(c.files.indexOf(e)>-1))if(c.files.push(e),e in l)p?o(e,l[e]):(++d,setTimeout(function(){--d,o(e,l[e])}));else if(p){var s;try{s=u.fs.readFileSync(e).toString("utf8")}catch(e){return void(t||r(e))}o(e,s)}else++d,u.fetch(e,function(i,a){--d,n&&(i?t?d||r(null,c):r(i):o(e,a))})}"function"==typeof i&&(n=i,i=undefined);var c=this;if(!n)return u.asPromise(e,c,t,i);var p=n===a,d=0;u.isString(t)&&(t=[t]);for(var _,m=0;m<t.length;++m)(_=c.resolvePath("",t[m]))&&s(_);return p?c:(d||r(null,c),undefined)},n.prototype.loadSync=function(e,t){if(!u.isNode)throw Error("not supported");return this.load(e,t,a)},n.prototype.resolveAll=function(){if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map(function(e){return"'extend "+e.extend+"' in "+e.parent.fullName}).join(", "));return o.prototype.resolveAll.call(this)};var d=/^[A-Z]/;n.prototype._handleAdd=function(e){if(e instanceof c)e.extend===undefined||e.extensionField||r(0,e)||this.deferred.push(e);else if(e instanceof p)d.test(e.name)&&(e.parent[e.name]=e.values);else{if(e instanceof s)for(var t=0;t<this.deferred.length;)r(0,this.deferred[t])?this.deferred.splice(t,1):++t;for(var i=0;i<e.nestedArray.length;++i)this._handleAdd(e._nestedArray[i]);d.test(e.name)&&(e.parent[e.name]=e)}},n.prototype._handleRemove=function(e){if(e instanceof c){if(e.extend!==undefined)if(e.extensionField)e.extensionField.parent.remove(e.extensionField),e.extensionField=null;else{var t=this.deferred.indexOf(e);t>-1&&this.deferred.splice(t,1)}}else if(e instanceof p)d.test(e.name)&&delete e.parent[e.name];else if(e instanceof o){for(var i=0;i<e.nestedArray.length;++i)this._handleRemove(e._nestedArray[i]);d.test(e.name)&&delete e.parent[e.name]}},n._configure=function(e,t,i){s=e,h=t,l=i}},{15:15,16:16,23:23,36:36}],30:[function(e,t,i){i.Service=e(31)},{31:31}],31:[function(e,t,i){function n(e,t,i){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");a.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(i)}t.exports=n;var a=e(38);(n.prototype=Object.create(a.EventEmitter.prototype)).constructor=n,n.prototype.rpcCall=function e(t,i,n,r,o){if(!r)throw TypeError("request must be specified");var s=this;if(!o)return a.asPromise(e,s,t,i,n,r);if(!s.rpcImpl)return setTimeout(function(){o(Error("already ended"))},0),undefined;try{return s.rpcImpl(t,i[s.requestDelimited?"encodeDelimited":"encode"](r).finish(),function(e,i){if(e)return s.emit("error",e,t),o(e);if(null===i)return s.end(!0),undefined;if(!(i instanceof n))try{i=n[s.responseDelimited?"decodeDelimited":"decode"](i)}catch(e){return s.emit("error",e,t),o(e)}return s.emit("data",i,t),o(null,i)})}catch(e){return s.emit("error",e,t),setTimeout(function(){o(e)},0),undefined}},n.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},{38:38}],32:[function(e,t,i){function n(e,t){r.call(this,e,t),this.methods={},this._methodsArray=null}function a(e){return e._methodsArray=null,e}t.exports=n;var r=e(23);((n.prototype=Object.create(r.prototype)).constructor=n).className="Service";var o=e(22),s=e(36),h=e(30);n.fromJSON=function(e,t){var i=new n(e,t.options);if(t.methods)for(var a=Object.keys(t.methods),r=0;r<a.length;++r)i.add(o.fromJSON(a[r],t.methods[a[r]]));return i},Object.defineProperty(n.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=s.toArray(this.methods))}}),n.prototype.toJSON=function(){var e=r.prototype.toJSON.call(this);return{options:e&&e.options||undefined,methods:r.arrayToJSON(this.methodsArray)||{},nested:e&&e.nested||undefined}},n.prototype.get=function(e){return this.methods[e]||r.prototype.get.call(this,e)},n.prototype.resolveAll=function(){for(var e=this.methodsArray,t=0;t<e.length;++t)e[t].resolve();return r.prototype.resolve.call(this)},n.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);return e instanceof o?(this.methods[e.name]=e,e.parent=this,a(this)):r.prototype.add.call(this,e)},n.prototype.remove=function(e){if(e instanceof o){if(this.methods[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.methods[e.name],e.parent=null,a(this)}return r.prototype.remove.call(this,e)},n.prototype.create=function(e,t,i){for(var n=new h.Service(e,t,i),a=0;a<this.methodsArray.length;++a)n[s.lcFirst(this._methodsArray[a].resolve().name)]=s.codegen("r","c")("return this.rpcCall(m,q,s,r,c)").eof(s.lcFirst(this._methodsArray[a].name),{m:this._methodsArray[a],q:this._methodsArray[a].resolvedRequestType.ctor,s:this._methodsArray[a].resolvedResponseType.ctor});return n}},{22:22,23:23,30:30,36:36}],33:[function(e,t,i){function n(e){return e.replace(p,function(e,t){switch(t){case"\\":case"":return t;default:return u[t]||""}})}function a(e){function t(e){return Error("illegal "+e+" (line "+f+")")}function i(t){return e.charAt(t)}function a(t,i){g=e.charAt(t++),v=f;for(var n=e.substring(t,i).split(l),a=0;a<n.length;++a)n[a]=n[a].replace(h,"").trim();y=n.join("\n").trim()}function p(){if(x.length>0)return x.shift();if(b)return function(){var i="'"===b?s:o;i.lastIndex=_-1;var a=i.exec(e);if(!a)throw t("string");return _=i.lastIndex,u(b),b=null,n(a[1])}();var h,l,p,d,g;do{if(_===m)return null;for(h=!1;c.test(p=i(_));)if("\n"===p&&++f,++_===m)return null;if("/"===i(_)){if(++_===m)throw t("comment");if("/"===i(_)){for(g="/"===i(d=_+1);"\n"!==i(++_);)if(_===m)return null;++_,g&&a(d,_-1),++f,h=!0}else{if("*"!==(p=i(_)))return"/";g="*"===i(d=_+1);do{if("\n"===p&&++f,++_===m)throw t("comment");l=p,p=i(_)}while("*"!==l||"/"!==p);++_,g&&a(d,_-2),h=!0}}}while(h);var y=_;r.lastIndex=0;if(!r.test(i(y++)))for(;y<m&&!r.test(i(y));)++y;var v=e.substring(_,_=y);return'"'!==v&&"'"!==v||(b=v),v}function u(e){x.push(e)}function d(){if(!x.length){var e=p();if(null===e)return null;u(e)}return x[0]}var _=0,m=(e=e.toString()).length,f=1,g=null,y=null,v=0,x=[],b=null;return{next:p,peek:d,push:u,skip:function(e,i){var n=d();if(n===e)return p(),!0;if(!i)throw t("token '"+n+"', '"+e+"' expected");return!1},line:function(){return f},cmnt:function(e){var t;return e===undefined?t=v===f-1&&y||null:(y||d(),t=v===e&&"/"===g&&y||null),t&&(g=y=null,v=0),t}}}t.exports=a;var r=/[\s{}=;:[\],'"()<>]/g,o=/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,s=/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,h=/^ *[*/]+ */,l=/\n/g,c=/\s/,p=/\\(.?)/g,u={0:"\0",r:"\r",n:"\n",t:"\t"};a.unescape=n},{}],34:[function(e,t,i){function n(e,t){r.call(this,e,t),this.fields={},this.oneofs=undefined,this.extensions=undefined,this.reserved=undefined,this.group=undefined,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}function a(e){return e._fieldsById=e._fieldsArray=e._oneofsArray=e._ctor=null,delete e.encode,delete e.decode,delete e.verify,e}t.exports=n;var r=e(23);((n.prototype=Object.create(r.prototype)).constructor=n).className="Type";var o=e(15),s=e(25),h=e(16),l=e(20),c=e(32),p=e(10),u=e(21),d=e(27),_=e(40),m=e(36),f=e(14),g=e(13),y=e(39),v=e(12);n.fromJSON=function(e,t){var i=new n(e,t.options);i.extensions=t.extensions,i.reserved=t.reserved;for(var a=Object.keys(t.fields),p=0;p<a.length;++p)i.add((void 0!==t.fields[a[p]].keyType?l.fromJSON:h.fromJSON)(a[p],t.fields[a[p]]));if(t.oneofs)for(a=Object.keys(t.oneofs),p=0;p<a.length;++p)i.add(s.fromJSON(a[p],t.oneofs[a[p]]));if(t.nested)for(a=Object.keys(t.nested),p=0;p<a.length;++p){var u=t.nested[a[p]];i.add((u.id!==undefined?h.fromJSON:u.fields!==undefined?n.fromJSON:u.values!==undefined?o.fromJSON:u.methods!==undefined?c.fromJSON:r.fromJSON)(a[p],u))}return t.extensions&&t.extensions.length&&(i.extensions=t.extensions),t.reserved&&t.reserved.length&&(i.reserved=t.reserved),t.group&&(i.group=!0),i},Object.defineProperties(n.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var e=Object.keys(this.fields),t=0;t<e.length;++t){var i=this.fields[e[t]],n=i.id;if(this._fieldsById[n])throw Error("duplicate id "+n+" in "+this);this._fieldsById[n]=i}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=m.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=m.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this._ctor=p(this).constructor)},set:function(e){if(e&&!(e.prototype instanceof u))throw TypeError("ctor must be a Message constructor");e.from||(e.from=u.from),this._ctor=e}}}),n.prototype.toJSON=function(){var e=r.prototype.toJSON.call(this);return{options:e&&e.options||undefined,oneofs:r.arrayToJSON(this.oneofsArray),fields:r.arrayToJSON(this.fieldsArray.filter(function(e){return!e.declaringField}))||{},extensions:this.extensions&&this.extensions.length?this.extensions:undefined,reserved:this.reserved&&this.reserved.length?this.reserved:undefined,group:this.group||undefined,nested:e&&e.nested||undefined}},n.prototype.resolveAll=function(){for(var e=this.fieldsArray,t=0;t<e.length;)e[t++].resolve();var i=this.oneofsArray;for(t=0;t<i.length;)i[t++].resolve();return r.prototype.resolve.call(this)},n.prototype.get=function(e){return this.fields[e]||this.oneofs&&this.oneofs[e]||this.nested&&this.nested[e]||null},n.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);if(e instanceof h&&e.extend===undefined){if(this._fieldsById?this._fieldsById[e.id]:this.fieldsById[e.id])throw Error("duplicate id "+e.id+" in "+this);if(this.isReservedId(e.id))throw Error("id "+e.id+" is reserved in "+this);if(this.isReservedName(e.name))throw Error("name '"+e.name+"' is reserved in "+this);return e.parent&&e.parent.remove(e),this.fields[e.name]=e,e.message=this,e.onAdd(this),a(this)}return e instanceof s?(this.oneofs||(this.oneofs={}),this.oneofs[e.name]=e,e.onAdd(this),a(this)):r.prototype.add.call(this,e)},n.prototype.remove=function(e){if(e instanceof h&&e.extend===undefined){if(!this.fields||this.fields[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.fields[e.name],e.parent=null,e.onRemove(this),a(this)}if(e instanceof s){if(!this.oneofs||this.oneofs[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.oneofs[e.name],e.parent=null,e.onRemove(this),a(this)}return r.prototype.remove.call(this,e)},n.prototype.isReservedId=function(e){if(this.reserved)for(var t=0;t<this.reserved.length;++t)if("string"!=typeof this.reserved[t]&&this.reserved[t][0]<=e&&this.reserved[t][1]>=e)return!0;return!1},n.prototype.isReservedName=function(e){if(this.reserved)for(var t=0;t<this.reserved.length;++t)if(this.reserved[t]===e)return!0;return!1},n.prototype.create=function(e){return new this.ctor(e)},n.prototype.setup=function(){for(var e=this.fullName,t=[],i=0;i<this.fieldsArray.length;++i)t.push(this._fieldsArray[i].resolve().resolvedType);return this.encode=f(this).eof(e+"$encode",{Writer:_,types:t,util:m}),this.decode=g(this).eof(e+"$decode",{Reader:d,types:t,util:m}),this.verify=y(this).eof(e+"$verify",{types:t,util:m}),this.fromObject=this.from=v.fromObject(this).eof(e+"$fromObject",{types:t,util:m}),this.toObject=v.toObject(this).eof(e+"$toObject",{types:t,util:m}),this},n.prototype.encode=function(e,t){return this.setup().encode(e,t)},n.prototype.encodeDelimited=function(e,t){return this.encode(e,t&&t.len?t.fork():t).ldelim()},n.prototype.decode=function(e,t){return this.setup().decode(e,t)},n.prototype.decodeDelimited=function(e){return e instanceof d||(e=d.create(e)),this.decode(e,e.uint32())},n.prototype.verify=function(e){return this.setup().verify(e)},n.prototype.fromObject=function(e){return this.setup().fromObject(e)},n.prototype.from=n.prototype.fromObject,n.prototype.toObject=function(e,t){return this.setup().toObject(e,t)}},{10:10,12:12,13:13,14:14,15:15,16:16,20:20,21:21,23:23,25:25,27:27,32:32,36:36,39:39,40:40}],35:[function(e,t,i){function n(e,t){var i=0,n={};for(t|=0;i<e.length;)n[o[i+t]]=e[i++];return n}var a=i,r=e(36),o=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];a.basic=n([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]),a.defaults=n([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",r.emptyArray,null]),a.long=n([0,0,0,1,1],7),a.mapKey=n([0,0,0,5,5,0,0,0,1,1,0,2],2),a.packed=n([1,5,0,0,0,5,5,0,0,0,1,1,0])},{36:36}],36:[function(e,t,i){var n=t.exports=e(38);n.codegen=e(3),n.fetch=e(5),n.path=e(7),n.fs=n.inquire("fs"),n.toArray=function(e){var t=[];if(e)for(var i=Object.keys(e),n=0;n<i.length;++n)t.push(e[i[n]]);return t};var a=/\\/g,r=/"/g;n.safeProp=function(e){return'["'+e.replace(a,"\\\\").replace(r,'\\"')+'"]'},n.ucFirst=function(e){return e.charAt(0).toUpperCase()+e.substring(1)}},{3:3,38:38,5:5,7:7}],37:[function(e,t,i){function n(e,t){this.lo=e>>>0,this.hi=t>>>0}t.exports=n;var a=e(38),r=n.zero=new n(0,0);r.toNumber=function(){return 0},r.zzEncode=r.zzDecode=function(){return this},r.length=function(){return 1};var o=n.zeroHash="\0\0\0\0\0\0\0\0";n.fromNumber=function(e){if(0===e)return r;var t=e<0;t&&(e=-e);var i=e>>>0,a=(e-i)/4294967296>>>0;return t&&(a=~a>>>0,i=~i>>>0,++i>4294967295&&(i=0,++a>4294967295&&(a=0))),new n(i,a)},n.from=function(e){if("number"==typeof e)return n.fromNumber(e);if(a.isString(e)){if(!a.Long)return n.fromNumber(parseInt(e,10));e=a.Long.fromString(e)}return e.low||e.high?new n(e.low>>>0,e.high>>>0):r},n.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,i=~this.hi>>>0;return t||(i=i+1>>>0),-(t+4294967296*i)}return this.lo+4294967296*this.hi},n.prototype.toLong=function(e){return a.Long?new a.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var s=String.prototype.charCodeAt;n.fromHash=function(e){return e===o?r:new n((s.call(e,0)|s.call(e,1)<<8|s.call(e,2)<<16|s.call(e,3)<<24)>>>0,(s.call(e,4)|s.call(e,5)<<8|s.call(e,6)<<16|s.call(e,7)<<24)>>>0)},n.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},n.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},n.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},n.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,i=this.hi>>>24;return 0===i?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:i<128?9:10}},{38:38}],38:[function(e,t,i){function n(e,t,i){for(var n=Object.keys(t),a=0;a<n.length;++a)e[n[a]]!==undefined&&i||(e[n[a]]=t[n[a]]);return e}function a(e){function t(e,i){if(!(this instanceof t))return new t(e,i);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),i&&n(this,i)}return(t.prototype=Object.create(Error.prototype)).constructor=t,Object.defineProperty(t.prototype,"name",{get:function(){return e}}),t.prototype.toString=function(){return this.name+": "+this.message},t}var r=i;r.asPromise=e(1),r.base64=e(2),r.EventEmitter=e(4),r.inquire=e(6),r.utf8=e(9),r.pool=e(8),r.LongBits=e(37),r.emptyArray=Object.freeze?Object.freeze([]):[],r.emptyObject=Object.freeze?Object.freeze({}):{},r.isNode=Boolean(global.process&&global.process.versions&&global.process.versions.node),r.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},r.isString=function(e){return"string"==typeof e||e instanceof String},r.isObject=function(e){return e&&"object"==typeof e},r.Buffer=function(){try{var e=r.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),r._Buffer_from=null,r._Buffer_allocUnsafe=null,r.newBuffer=function(e){return"number"==typeof e?r.Buffer?r._Buffer_allocUnsafe(e):new r.Array(e):r.Buffer?r._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},r.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,r.Long=global.dcodeIO&&global.dcodeIO.Long||r.inquire("long"),r.key2Re=/^true|false|0|1$/,r.key32Re=/^-?(?:0|[1-9][0-9]*)$/,r.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,r.longToHash=function(e){return e?r.LongBits.from(e).toHash():r.LongBits.zeroHash},r.longFromHash=function(e,t){var i=r.LongBits.fromHash(e);return r.Long?r.Long.fromBits(i.lo,i.hi,t):i.toNumber(Boolean(t))},r.merge=n,r.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},r.newError=a,r.ProtocolError=a("ProtocolError"),r.oneOfGetter=function(e){for(var t={},i=0;i<e.length;++i)t[e[i]]=1;return function(){for(var e=Object.keys(this),i=e.length-1;i>-1;--i)if(1===t[e[i]]&&this[e[i]]!==undefined&&null!==this[e[i]])return e[i]}},r.oneOfSetter=function(e){return function(t){for(var i=0;i<e.length;++i)e[i]!==t&&delete this[e[i]]}},r.lazyResolve=function(e,t){for(var i=0;i<t.length;++i)for(var n=Object.keys(t[i]),a=0;a<n.length;++a){for(var r=t[i][n[a]].split("."),o=e;r.length;)o=o[r.shift()];t[i][n[a]]=o}},r.toJSONOptions={longs:String,enums:String,bytes:String},r._configure=function(){var e=r.Buffer;e?(r._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,i){return new e(t,i)},r._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):r._Buffer_from=r._Buffer_allocUnsafe=null}},{1:1,2:2,37:37,4:4,6:6,8:8,9:9}],39:[function(e,t,i){function n(e,t){return e.name+": "+t+(e.repeated&&"array"!==t?"[]":e.map&&"object"!==t?"{k:"+e.keyType+"}":"")+" expected"}function a(e,t,i,a){if(t.resolvedType)if(t.resolvedType instanceof o){e("switch(%s){",a)("default:")("return%j",n(t,"enum value"));for(var r=Object.keys(t.resolvedType.values),s=0;s<r.length;++s)e("case %d:",t.resolvedType.values[r[s]]);e("break")("}")}else e("var e=types[%d].verify(%s);",i,a)("if(e)")("return%j+e",t.name+".");else switch(t.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":e("if(!util.isInteger(%s))",a)("return%j",n(t,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":e("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",a,a,a,a)("return%j",n(t,"integer|Long"));break;case"float":case"double":e('if(typeof %s!=="number")',a)("return%j",n(t,"number"));break;case"bool":e('if(typeof %s!=="boolean")',a)("return%j",n(t,"boolean"));break;case"string":e("if(!util.isString(%s))",a)("return%j",n(t,"string"));break;case"bytes":e('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',a,a,a)("return%j",n(t,"buffer"))}return e}function r(e,t,i){switch(t.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":e("if(!util.key32Re.test(%s))",i)("return%j",n(t,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":e("if(!util.key64Re.test(%s))",i)("return%j",n(t,"integer|Long key"));break;case"bool":e("if(!util.key2Re.test(%s))",i)("return%j",n(t,"boolean key"))}return e}t.exports=function(e){for(var t=s.codegen("m")('if(typeof m!=="object"||m===null)')("return%j","object expected"),i=0;i<e.fieldsArray.length;++i){var h=e._fieldsArray[i].resolve(),l="m"+s.safeProp(h.name);h.map?(t("if(%s!==undefined){",l)("if(!util.isObject(%s))",l)("return%j",n(h,"object"))("var k=Object.keys(%s)",l)("for(var i=0;i<k.length;++i){"),r(t,h,"k[i]"),a(t,h,i,l+"[k[i]]")("}")("}")):h.repeated?(t("if(%s!==undefined){",l)("if(!Array.isArray(%s))",l)("return%j",n(h,"array"))("for(var i=0;i<%s.length;++i){",l),a(t,h,i,l+"[i]")("}")("}")):(h.required||(!h.resolvedType||h.resolvedType instanceof o?t("if(%s!==undefined){",l):t("if(%s!==undefined&&%s!==null){",l,l)),a(t,h,i,l),h.required||t("}"))}return t("return null")};var o=e(15),s=e(36)},{15:15,36:36}],40:[function(e,t,i){function n(e,t,i){this.fn=e,this.len=t,this.next=undefined,this.val=i}function a(){}function r(){this.len=0,this.head=new n(a,0,0),this.tail=this.head,this.states=null}function o(e,t,i){t[i]=255&e}function s(e,t){this.len=e,this.next=undefined,this.val=t}function h(e,t,i){for(;e.hi;)t[i++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[i++]=127&e.lo|128,e.lo=e.lo>>>7;t[i++]=e.lo}function l(e,t,i){t[i++]=255&e,t[i++]=e>>>8&255,t[i++]=e>>>16&255,t[i]=e>>>24}t.exports=r;var c,p=e(38),u=p.LongBits,d=p.base64,_=p.utf8;r.create=p.Buffer?function(){return(r.create=function(){return new c})()}:function(){return new r},r.alloc=function(e){return new p.Array(e)},p.Array!==Array&&(r.alloc=p.pool(r.alloc,p.Array.prototype.subarray)),r.prototype.push=function(e,t,i){return this.tail=this.tail.next=new n(e,t,i),this.len+=t,this},(s.prototype=Object.create(n.prototype)).fn=function(e,t,i){for(;e>127;)t[i++]=127&e|128,e>>>=7;t[i]=e},r.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new s((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},r.prototype.int32=function(e){return e<0?this.push(h,10,u.fromNumber(e)):this.uint32(e)},r.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},r.prototype.uint64=function(e){var t=u.from(e);return this.push(h,t.length(),t)},r.prototype.int64=r.prototype.uint64,r.prototype.sint64=function(e){var t=u.from(e).zzEncode();return this.push(h,t.length(),t)},r.prototype.bool=function(e){return this.push(o,1,e?1:0)},r.prototype.fixed32=function(e){return this.push(l,4,e>>>0)},r.prototype.sfixed32=r.prototype.fixed32,r.prototype.fixed64=function(e){var t=u.from(e);return this.push(l,4,t.lo).push(l,4,t.hi)},r.prototype.sfixed64=r.prototype.fixed64;var m="undefined"!=typeof Float32Array?function(){var e=new Float32Array(1),t=new Uint8Array(e.buffer);return e[0]=-0,t[3]?function(i,n,a){e[0]=i,n[a++]=t[0],n[a++]=t[1],n[a++]=t[2],n[a]=t[3]}:function(i,n,a){e[0]=i,n[a++]=t[3],n[a++]=t[2],n[a++]=t[1],n[a]=t[0]}}():function(e,t,i){var n=e<0?1:0;if(n&&(e=-e),0===e)l(1/e>0?0:2147483648,t,i);else if(isNaN(e))l(2147483647,t,i);else if(e>3.4028234663852886e38)l((n<<31|2139095040)>>>0,t,i);else if(e<1.1754943508222875e-38)l((n<<31|Math.round(e/1.401298464324817e-45))>>>0,t,i);else{var a=Math.floor(Math.log(e)/Math.LN2);l((n<<31|a+127<<23|8388607&Math.round(e*Math.pow(2,-a)*8388608))>>>0,t,i)}};r.prototype.float=function(e){return this.push(m,4,e)};var f="undefined"!=typeof Float64Array?function(){var e=new Float64Array(1),t=new Uint8Array(e.buffer);return e[0]=-0,t[7]?function(i,n,a){e[0]=i,n[a++]=t[0],n[a++]=t[1],n[a++]=t[2],n[a++]=t[3],n[a++]=t[4],n[a++]=t[5],n[a++]=t[6],n[a]=t[7]}:function(i,n,a){e[0]=i,n[a++]=t[7],n[a++]=t[6],n[a++]=t[5],n[a++]=t[4],n[a++]=t[3],n[a++]=t[2],n[a++]=t[1],n[a]=t[0]}}():function(e,t,i){var n=e<0?1:0;if(n&&(e=-e),0===e)l(0,t,i),l(1/e>0?0:2147483648,t,i+4);else if(isNaN(e))l(4294967295,t,i),l(2147483647,t,i+4);else if(e>1.7976931348623157e308)l(0,t,i),l((n<<31|2146435072)>>>0,t,i+4);else{var a;if(e<2.2250738585072014e-308)l((a=e/5e-324)>>>0,t,i),l((n<<31|a/4294967296)>>>0,t,i+4);else{var r=Math.floor(Math.log(e)/Math.LN2);1024===r&&(r=1023),l(4503599627370496*(a=e*Math.pow(2,-r))>>>0,t,i),l((n<<31|r+1023<<20|1048576*a&1048575)>>>0,t,i+4)}}};r.prototype.double=function(e){return this.push(f,8,e)};var g=p.Array.prototype.set?function(e,t,i){t.set(e,i)}:function(e,t,i){for(var n=0;n<e.length;++n)t[i+n]=e[n]};r.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this.push(o,1,0);if(p.isString(e)){var i=r.alloc(t=d.length(e));d.decode(e,i,0),e=i}return this.uint32(t).push(g,t,e)},r.prototype.string=function(e){var t=_.length(e);return t?this.uint32(t).push(_.write,t,e):this.push(o,1,0)},r.prototype.fork=function(){return this.states=new function(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}(this),this.head=this.tail=new n(a,0,0),this.len=0,this},r.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new n(a,0,0),this.len=0),this},r.prototype.ldelim=function(){var e=this.head,t=this.tail,i=this.len;return this.reset().uint32(i),i&&(this.tail.next=e.next,this.tail=t,this.len+=i),this},r.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),i=0;e;)e.fn(e.val,t,i),i+=e.len,e=e.next;return t},r._configure=function(e){c=e}},{38:38}],41:[function(e,t,i){function n(){r.call(this)}function a(e,t,i){e.length<40?o.utf8.write(e,t,i):t.utf8Write(e,i)}t.exports=n;var r=e(40);(n.prototype=Object.create(r.prototype)).constructor=n;var o=e(38),s=o.Buffer;n.alloc=function(e){return(n.alloc=o._Buffer_allocUnsafe)(e)};var h=s&&s.prototype instanceof Uint8Array&&"set"===s.prototype.set.name?function(e,t,i){t.set(e,i)}:function(e,t,i){if(e.copy)e.copy(t,i,0,e.length);else for(var n=0;n<e.length;)t[i++]=e[n++]};n.prototype.bytes=function(e){o.isString(e)&&(e=o._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this.push(h,t,e),this},n.prototype.string=function(e){var t=s.byteLength(e);return this.uint32(t),t&&this.push(a,t,e),this}},{38:38,40:40}]},{},[19])}("object"==typeof window&&window||"object"==typeof self&&self||this),function(e,t,i){i.un,i.uns;var n=i.static,a=i.class,r=i.getset,o=(i.__newvec,laya.display.Animation),s=(laya.utils.Browser,laya.utils.ClassUtils),h=laya.filters.ColorFilter,l=laya.utils.Ease,c=laya.events.Event,p=(laya.events.EventDispatcher,laya.display.css.Font),u=laya.display.FrameAnimation,d=laya.display.Graphics,_=laya.utils.Handler,m=laya.display.Input,f=laya.net.Loader,g=(laya.display.Node,laya.maths.Point),y=laya.maths.Rectangle,v=laya.renders.Render,x=laya.display.Sprite,b=laya.display.Text,w=laya.resource.Texture,S=laya.utils.Tween,I=laya.utils.Utils,M=laya.utils.WeakObject;i.interface("laya.ui.IItem"),i.interface("laya.ui.ISelect"),i.interface("laya.ui.IRender"),i.interface("laya.ui.IComponent"),i.interface("laya.ui.IBox","IComponent");var C=function(){function e(){this.enable=!1,this.top=NaN,this.bottom=NaN,this.left=NaN,this.right=NaN,this.centerX=NaN,this.centerY=NaN,this.anchorX=NaN,this.anchorY=NaN}return a(e,"laya.ui.LayoutStyle"),n(e,["EMPTY",function(){return this.EMPTY=new e}]),e}(),k=function(){function e(){}return a(e,"laya.ui.Styles"),e.labelColor="#000000",e.buttonStateNum=3,e.scrollBarMinNum=15,e.scrollBarDelayTime=500,n(e,["defaultSizeGrid",function(){return this.defaultSizeGrid=[4,4,4,4,0]},"labelPadding",function(){return this.labelPadding=[2,2,2,2]},"inputLabelPadding",function(){return this.inputLabelPadding=[1,1,1,3]},"buttonLabelColors",function(){return this.buttonLabelColors=["#32556b","#32cc6b","#ff0000","#C0C0C0"]},"comboBoxItemColors",function(){return this.comboBoxItemColors=["#5e95b6","#ffffff","#000000","#8fa4b1","#ffffff"]}]),e}(),E=function(){function e(){}return a(e,"laya.ui.UIUtils"),e.fillArray=function(e,t,i){var n=e.concat();if(t)for(var a=t.split(","),r=0,o=Math.min(n.length,a.length);r<o;r++){var s=a[r];n[r]="true"==s||"false"!=s&&s,null!=i&&(n[r]=i(s))}return n},e.toColor=function(e){return I.toHexColor(e)},e.gray=function(t,i){void 0===i&&(i=!0),i?e.addFilter(t,e.grayFilter):e.clearFilter(t,h)},e.addFilter=function(e,t){var i=e.filters||[];i.push(t),e.filters=i},e.clearFilter=function(e,t){var n=e.filters;if(null!=n&&n.length>0){for(var a=n.length-1;a>-1;a--){var r=n[a];i.__typeof(r,t)&&n.splice(a,1)}e.filters=n}},e._getReplaceStr=function(t){return e.escapeSequence[t]},e.adptString=function(t){return t.replace(/\\(\w)/g,e._getReplaceStr)},e.getBindFun=function(t){var n=e._funMap.get(t);if(null==n){var a='"'+t+'"',r="(function(data){if(data==null)return;with(data){try{\nreturn "+(a=a.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"'))+"\n}catch(e){}}})";n=i._runScript(r),e._funMap.set(t,n)}return n},n(e,["grayFilter",function(){return this.grayFilter=new h([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0])},"escapeSequence",function(){return this.escapeSequence={"\\n":"\n","\\t":"\t"}},"_funMap",function(){return this._funMap=new M}]),e}(),T=function(){function e(){}return a(e,"UIConfig"),e.touchScrollEnable=!0,e.mouseWheelEnable=!0,e.showButtons=!0,e.popupBgColor="#000000",e.popupBgAlpha=.5,e.closeDialogOnSide=!0,e}(),L=function(e){function t(){this.autoCacheCmd=!0,this._width=0,this._height=0,this._source=null,this._sizeGrid=null,this._isChanged=!1,this._offset=null,t.__super.call(this)}a(t,"laya.ui.AutoBitmap",e);var n=t.prototype;return n.destroy=function(){e.prototype.destroy.call(this),this._source=null,this._sizeGrid=null,this._offset=null},n._setChanged=function(){this._isChanged||(this._isChanged=!0,i.timer.callLater(this,this.changeSource))},n.changeSource=function(){this._isChanged=!1;var e=this._source;if(e&&e.bitmap){var i=this.width,n=this.height,a=this._sizeGrid,r=e.sourceWidth,o=e.sourceHeight;if(!a||r===i&&o===n)this.cleanByTexture(e,this._offset?this._offset[0]:0,this._offset?this._offset[1]:0,i,n);else{e.$_GID||(e.$_GID=I.getGID());var s=e.$_GID+"."+i+"."+n+"."+a.join(".");if(I.isOKCmdList(M.I.get(s)))return void(this.cmds=M.I.get(s));this.clear();var h=a[0],l=a[1],c=a[2],p=a[3],u=a[4],d=!1;if(i==r&&(p=l=0),n==o&&(h=c=0),p+l>i){var _=i;d=!0,i=p+l,this.save(),this.clipRect(0,0,_,n)}p&&h&&this.drawTexture(t.getTexture(e,0,0,p,h),0,0,p,h),l&&h&&this.drawTexture(t.getTexture(e,r-l,0,l,h),i-l,0,l,h),p&&c&&this.drawTexture(t.getTexture(e,0,o-c,p,c),0,n-c,p,c),l&&c&&this.drawTexture(t.getTexture(e,r-l,o-c,l,c),i-l,n-c,l,c),h&&this.drawBitmap(u,t.getTexture(e,p,0,r-p-l,h),p,0,i-p-l,h),c&&this.drawBitmap(u,t.getTexture(e,p,o-c,r-p-l,c),p,n-c,i-p-l,c),p&&this.drawBitmap(u,t.getTexture(e,0,h,p,o-h-c),0,h,p,n-h-c),l&&this.drawBitmap(u,t.getTexture(e,r-l,h,l,o-h-c),i-l,h,l,n-h-c),this.drawBitmap(u,t.getTexture(e,p,h,r-p-l,o-h-c),p,h,i-p-l,n-h-c),d&&this.restore(),this.autoCacheCmd&&!v.isConchApp&&M.I.set(s,this.cmds)}this._repaint()}},n.drawBitmap=function(e,t,i,n,a,r){void 0===a&&(a=0),void 0===r&&(r=0),a<.1||r<.1||(!e||t.width==a&&t.height==r?this.drawTexture(t,i,n,a,r):this.fillTexture(t,i,n,a,r))},n.clear=function(t){void 0===t&&(t=!0),e.prototype.clear.call(this,!1)},r(0,n,"sizeGrid",function(){return this._sizeGrid},function(e){this._sizeGrid=e,this._setChanged()}),r(0,n,"width",function(){return this._width?this._width:this._source?this._source.sourceWidth:0},function(e){this._width!=e&&(this._width=e,this._setChanged())}),r(0,n,"height",function(){return this._height?this._height:this._source?this._source.sourceHeight:0},function(e){this._height!=e&&(this._height=e,this._setChanged())}),r(0,n,"source",function(){return this._source},function(e){e?(this._source=e,this._setChanged()):(this._source=null,this.clear())}),t.getTexture=function(e,t,i,n,a){n<=0&&(n=1),a<=0&&(a=1),e.$_GID||(e.$_GID=I.getGID());var r=e.$_GID+"."+t+"."+i+"."+n+"."+a,o=M.I.get(r);return o&&o.source||(o=w.createFromTexture(e,t,i,n,a),M.I.set(r,o)),o},t}(d),D=(function(e){function t(){t.__super.call(this)}a(t,"laya.ui.UIEvent",c),t.SHOW_TIP="showtip",t.HIDE_TIP="hidetip"}(),function(e){function t(){this._comXml=null,this._dataSource=null,this._toolTip=null,this._tag=null,this._disabled=!1,this._gray=!1,this.layoutEnabled=!0,t.__super.call(this),this._layout=C.EMPTY,this.preinitialize(),this.createChildren(),this.initialize()}a(t,"laya.ui.Component",e);var n=t.prototype;return i.imps(n,{"laya.ui.IComponent":!0}),n.destroy=function(t){void 0===t&&(t=!0),e.prototype.destroy.call(this,t),this._dataSource=this._layout=null,this._tag=null,this._toolTip=null},n.preinitialize=function(){},n.createChildren=function(){},n.initialize=function(){},n.callLater=function(e,t){i.timer.callLater(this,e,t)},n.runCallLater=function(e){i.timer.runCallLater(this,e)},n.commitMeasure=function(){},n.changeSize=function(){this.event("resize")},n.getLayout=function(){return this._layout===C.EMPTY&&(this._layout=new C),this._layout},n._setLayoutEnabled=function(e){this._layout&&this._layout.enable!=e&&(this._layout.enable=e,this.on("added",this,this.onAdded),this.on("removed",this,this.onRemoved),this.parent&&this.onAdded())},n.onRemoved=function(){this.parent.off("resize",this,this.onCompResize)},n.onAdded=function(){this.parent.on("resize",this,this.onCompResize),this.resetLayoutX(),this.resetLayoutY()},n.onCompResize=function(){this._layout&&this._layout.enable&&(this.resetLayoutX(),this.resetLayoutY())},n.resetLayoutX=function(){var e=this._layout;if(isNaN(e.anchorX)||(this.pivotX=e.anchorX*this.width),this.layoutEnabled){var t=this.parent;t&&(isNaN(e.centerX)?isNaN(e.left)?isNaN(e.right)||(this.x=Math.round(t.width-this.displayWidth-e.right+this.pivotX*this.scaleX)):(this.x=Math.round(e.left+this.pivotX*this.scaleX),isNaN(e.right)||(this.width=(t._width-e.left-e.right)/(this.scaleX||.01))):this.x=Math.round(.5*(t.width-this.displayWidth)+e.centerX+this.pivotX*this.scaleX))}},n.resetLayoutY=function(){var e=this._layout;if(isNaN(e.anchorY)||(this.pivotY=e.anchorY*this.height),this.layoutEnabled){var t=this.parent;t&&(isNaN(e.centerY)?isNaN(e.top)?isNaN(e.bottom)||(this.y=Math.round(t.height-this.displayHeight-e.bottom+this.pivotY*this.scaleY)):(this.y=Math.round(e.top+this.pivotY*this.scaleY),isNaN(e.bottom)||(this.height=(t._height-e.top-e.bottom)/(this.scaleY||.01))):this.y=Math.round(.5*(t.height-this.displayHeight)+e.centerY+this.pivotY*this.scaleY))}},n.onMouseOver=function(e){i.stage.event("showtip",this._toolTip)},n.onMouseOut=function(e){i.stage.event("hidetip",this._toolTip)},r(0,n,"displayWidth",function(){return this.width*this.scaleX}),r(0,n,"width",function(){return this._width?this._width:this.measureWidth},function(e){this._width!=e&&(this._width=e,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerX)&&isNaN(this._layout.right)&&isNaN(this._layout.anchorX)||this.resetLayoutX())}),r(0,n,"measureWidth",function(){var e=0;this.commitMeasure();for(var t=this.numChildren-1;t>-1;t--){var i=this.getChildAt(t);i.visible&&(e=Math.max(i.x+i.width*i.scaleX,e))}return e}),r(0,n,"displayHeight",function(){return this.height*this.scaleY}),r(0,n,"height",function(){return this._height?this._height:this.measureHeight},function(e){this._height!=e&&(this._height=e,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerY)&&isNaN(this._layout.bottom)&&isNaN(this._layout.anchorY)||this.resetLayoutY())}),r(0,n,"dataSource",function(){return this._dataSource},function(e){this._dataSource=e;for(var t in this._dataSource)this.hasOwnProperty(t)&&"function"!=typeof this[t]&&(this[t]=this._dataSource[t])}),r(0,n,"scaleY",e.prototype._$get_scaleY,function(e){i.superGet(x,this,"scaleY")!=e&&(i.superSet(x,this,"scaleY",e),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutY())}),r(0,n,"measureHeight",function(){var e=0;this.commitMeasure();for(var t=this.numChildren-1;t>-1;t--){var i=this.getChildAt(t);i.visible&&(e=Math.max(i.y+i.height*i.scaleY,e))}return e}),r(0,n,"scaleX",e.prototype._$get_scaleX,function(e){i.superGet(x,this,"scaleX")!=e&&(i.superSet(x,this,"scaleX",e),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutX())}),r(0,n,"top",function(){return this._layout.top},function(e){e!=this._layout.top&&(this.getLayout().top=e,this._setLayoutEnabled(!0)),this.resetLayoutY()}),r(0,n,"bottom",function(){return this._layout.bottom},function(e){e!=this._layout.bottom&&(this.getLayout().bottom=e,this._setLayoutEnabled(!0)),this.resetLayoutY()}),r(0,n,"left",function(){return this._layout.left},function(e){e!=this._layout.left&&(this.getLayout().left=e,this._setLayoutEnabled(!0)),this.resetLayoutX()}),r(0,n,"right",function(){return this._layout.right},function(e){e!=this._layout.right&&(this.getLayout().right=e,this._setLayoutEnabled(!0)),this.resetLayoutX()}),r(0,n,"centerX",function(){return this._layout.centerX},function(e){e!=this._layout.centerX&&(this.getLayout().centerX=e,this._setLayoutEnabled(!0)),this.resetLayoutX()}),r(0,n,"centerY",function(){return this._layout.centerY},function(e){e!=this._layout.centerY&&(this.getLayout().centerY=e,this._setLayoutEnabled(!0)),this.resetLayoutY()}),r(0,n,"anchorX",function(){return this._layout.anchorX},function(e){e!=this._layout.anchorX&&(this.getLayout().anchorX=e,this._setLayoutEnabled(!0)),this.resetLayoutX()}),r(0,n,"anchorY",function(){return this._layout.anchorY},function(e){e!=this._layout.anchorY&&(this.getLayout().anchorY=e,this._setLayoutEnabled(!0)),this.resetLayoutY()}),r(0,n,"tag",function(){return this._tag},function(e){this._tag=e}),r(0,n,"toolTip",function(){return this._toolTip},function(e){this._toolTip!=e&&(this._toolTip=e,null!=e?(this.on("mouseover",this,this.onMouseOver),this.on("mouseout",this,this.onMouseOut)):(this.off("mouseover",this,this.onMouseOver),this.off("mouseout",this,this.onMouseOut)))}),r(0,n,"comXml",function(){return this._comXml},function(e){this._comXml=e}),r(0,n,"gray",function(){return this._gray},function(e){e!==this._gray&&(this._gray=e,E.gray(this,e))}),r(0,n,"disabled",function(){return this._disabled},function(e){e!==this._disabled&&(this.gray=this._disabled=e,this.mouseEnabled=!e)}),t}(x)),N=function(e){function t(){this.lockLayer=null,this.popupEffect=function(e){e.scale(1,1),S.from(e,{x:i.stage.width/2,y:i.stage.height/2,scaleX:0,scaleY:0},300,l.backOut,_.create(this,this.doOpen,[e]))},this.closeEffect=function(e,t){S.to(e,{x:i.stage.width/2,y:i.stage.height/2,scaleX:0,scaleY:0},300,l.strongOut,_.create(this,this.doClose,[e,t]))},t.__super.call(this),this.maskLayer=new x,this.popupEffectHandler=new _(this,this.popupEffect),this.closeEffectHandler=new _(this,this.closeEffect),this.mouseEnabled=this.maskLayer.mouseEnabled=!0,this.zOrder=1e3,i.stage.addChild(this),i.stage.on("resize",this,this._onResize),T.closeDialogOnSide&&this.maskLayer.on("click",this,this._closeOnSide),this._onResize(null)}a(t,"laya.ui.DialogManager",x);var n=t.prototype;return n._closeOnSide=function(){var e=this.getChildAt(this.numChildren-1);e instanceof laya.ui.Dialog&&e.close("side")},n.setLockView=function(e){this.lockLayer||(this.lockLayer=new A,this.lockLayer.mouseEnabled=!0,this.lockLayer.size(i.stage.width,i.stage.height)),this.lockLayer.removeChildren(),e&&(e.centerX=e.centerY=0,this.lockLayer.addChild(e))},n._onResize=function(e){var t=this.maskLayer.width=i.stage.width,n=this.maskLayer.height=i.stage.height;this.lockLayer&&this.lockLayer.size(t,n),this.maskLayer.graphics.clear(),this.maskLayer.graphics.drawRect(0,0,t,n,T.popupBgColor),this.maskLayer.alpha=T.popupBgAlpha;for(var a=this.numChildren-1;a>-1;a--){var r=this.getChildAt(a);r.popupCenter&&this._centerDialog(r)}},n._centerDialog=function(e){e.x=Math.round((i.stage.width-e.width>>1)+e.pivotX),e.y=Math.round((i.stage.height-e.height>>1)+e.pivotY)},n.open=function(e,t,i){void 0===t&&(t=!1),void 0===i&&(i=!1),t&&this._closeAll(),e.popupCenter&&this._centerDialog(e),this.addChild(e),(e.isModal||this._$P.hasZorder)&&this.timer.callLater(this,this._checkMask),i&&null!=e.popupEffect?e.popupEffect.runWith(e):this.doOpen(e),this.event("open")},n.doOpen=function(e){e.onOpened()},n.lock=function(e){this.lockLayer&&(e?this.addChild(this.lockLayer):this.lockLayer.removeSelf())},n.close=function(e,t,i){void 0===i&&(i=!1),i&&null!=e.closeEffect?e.closeEffect.runWith([e,t]):this.doClose(e,t),this.event("close")},n.doClose=function(e,t){e.removeSelf(),e.isModal&&this._checkMask(),e.closeHandler&&e.closeHandler.runWith(t),e.onClosed(t)},n.closeAll=function(){this._closeAll(),this.event("close")},n._closeAll=function(){for(var e=this.numChildren-1;e>-1;e--){var t=this.getChildAt(e);t&&null!=t.close&&this.doClose(t)}},n.getDialogsByGroup=function(e){for(var t=[],i=this.numChildren-1;i>-1;i--){var n=this.getChildAt(i);n&&n.group===e&&t.push(n)}return t},n.closeByGroup=function(e){for(var t=[],i=this.numChildren-1;i>-1;i--){var n=this.getChildAt(i);n&&n.group===e&&(n.close(),t.push(n))}return t},n._checkMask=function(){this.maskLayer.removeSelf();for(var e=this.numChildren-1;e>-1;e--){var t=this.getChildAt(e);if(t&&t.isModal)return void this.addChildAt(this.maskLayer,e)}},t}(),A=function(e){function t(){t.__super.call(this)}a(t,"laya.ui.Box",e);var n=t.prototype;return i.imps(n,{"laya.ui.IBox":!0}),r(0,n,"dataSource",e.prototype._$get_dataSource,function(e){this._dataSource=e;for(var t in e){var i=this.getChildByName(t);i?i.dataSource=e[t]:this.hasOwnProperty(t)&&"function"!=typeof this[t]&&(this[t]=e[t])}}),t}(D),R=function(e){function t(e,i){this.toggle=!1,this._bitmap=null,this._text=null,this._strokeColors=null,this._state=0,this._selected=!1,this._skin=null,this._autoSize=!0,this._sources=null,this._clickHandler=null,this._stateChanged=!1,t.__super.call(this),this._labelColors=k.buttonLabelColors,this._stateNum=k.buttonStateNum,void 0===i&&(i=""),this.skin=e,this.label=i}a(t,"laya.ui.Button",e);var o=t.prototype;return i.imps(o,{"laya.ui.ISelect":!0}),o.destroy=function(t){void 0===t&&(t=!0),e.prototype.destroy.call(this,t),this._bitmap&&this._bitmap.destroy(),this._text&&this._text.destroy(t),this._bitmap=null,this._text=null,this._clickHandler=null,this._labelColors=this._sources=this._strokeColors=null},o.createChildren=function(){this.graphics=this._bitmap=new L},o.createText=function(){this._text||(this._text=new b,this._text.overflow=b.HIDDEN,this._text.align="center",this._text.valign="middle",this._text.width=this._width,this._text.height=this._height)},o.initialize=function(){1!==this._mouseEnableState&&(this.mouseEnabled=!0,this._setBit(2,!0)),this._createListener("mouseover",this,this.onMouse,null,!1,!1),this._createListener("mouseout",this,this.onMouse,null,!1,!1),this._createListener("mousedown",this,this.onMouse,null,!1,!1),this._createListener("mouseup",this,this.onMouse,null,!1,!1),this._createListener("click",this,this.onMouse,null,!1,!1)},o.onMouse=function(e){if(!1!==this.toggle||!this._selected)return"click"===e.type?(this.toggle&&(this.selected=!this._selected),void(this._clickHandler&&this._clickHandler.run())):void(!this._selected&&(this.state=t.stateMap[e.type]))},o.changeClips=function(){var e=f.getRes(this._skin);if(e){var t=e.sourceWidth,i=e.sourceHeight/this._stateNum;e.$_GID||(e.$_GID=I.getGID());var n=e.$_GID+"-"+this._stateNum,a=M.I.get(n);if(I.isOkTextureList(a)||(a=null),a)this._sources=a;else{if(this._sources=[],1===this._stateNum)this._sources.push(e);else for(var r=0;r<this._stateNum;r++)this._sources.push(w.createFromTexture(e,0,i*r,t,i));M.I.set(n,this._sources)}this._autoSize?(this._bitmap.width=this._width||t,this._bitmap.height=this._height||i,this._text&&(this._text.width=this._bitmap.width,this._text.height=this._bitmap.height)):this._text&&(this._text.x=t)}},o.changeState=function(){this._stateChanged=!1,this.runCallLater(this.changeClips);var e=this._state<this._stateNum?this._state:this._stateNum-1;this._sources&&(this._bitmap.source=this._sources[e]),this.label&&(this._text.color=this._labelColors[e],this._strokeColors&&(this._text.strokeColor=this._strokeColors[e]))},o._setStateChanged=function(){this._stateChanged||(this._stateChanged=!0,this.callLater(this.changeState))},r(0,o,"labelStrokeColor",function(){return this.createText(),this._text.strokeColor},function(e){this.createText(),this._text.strokeColor=e}),r(0,o,"measureHeight",function(){return this.runCallLater(this.changeClips),this._text?Math.max(this._bitmap.height,this._text.height):this._bitmap.height}),r(0,o,"skin",function(){return this._skin},function(e){this._skin!=e&&(this._skin=e,this.callLater(this.changeClips),this._setStateChanged())}),r(0,o,"state",function(){return this._state},function(e){this._state!=e&&(this._state=e,this._setStateChanged())}),r(0,o,"text",function(){return this.createText(),this._text}),r(0,o,"stateNum",function(){return this._stateNum},function(e){"string"==typeof e&&(e=parseInt(e)),this._stateNum!=e&&(this._stateNum=e<1?1:e>3?3:e,this.callLater(this.changeClips))}),r(0,o,"strokeColors",function(){return this._strokeColors?this._strokeColors.join(","):""},function(e){this._strokeColors=E.fillArray(k.buttonLabelColors,e,String),this._setStateChanged()}),r(0,o,"labelColors",function(){return this._labelColors.join(",")},function(e){this._labelColors=E.fillArray(k.buttonLabelColors,e,String),this._setStateChanged()}),r(0,o,"measureWidth",function(){return this.runCallLater(this.changeClips),this._autoSize?this._bitmap.width:(this.runCallLater(this.changeState),this._bitmap.width+(this._text?this._text.width:0))}),r(0,o,"label",function(){return this._text?this._text.text:null},function(e){(this._text||e)&&(this.createText(),this._text.text!=e&&(e&&!this._text.parent&&this.addChild(this._text),this._text.text=(e+"").replace(/\\n/g,"\n"),this._setStateChanged()))}),r(0,o,"selected",function(){return this._selected},function(e){this._selected!=e&&(this._selected=e,this.state=this._selected?2:0,this.event("change"))}),r(0,o,"labelPadding",function(){return this.createText(),this._text.padding.join(",")},function(e){this.createText(),this._text.padding=E.fillArray(k.labelPadding,e,Number)}),r(0,o,"labelSize",function(){return this.createText(),this._text.fontSize},function(e){this.createText(),this._text.fontSize=e}),r(0,o,"labelStroke",function(){return this.createText(),this._text.stroke},function(e){this.createText(),this._text.stroke=e}),r(0,o,"labelBold",function(){return this.createText(),this._text.bold},function(e){this.createText(),this._text.bold=e}),r(0,o,"labelFont",function(){return this.createText(),this._text.font},function(e){this.createText(),this._text.font=e}),r(0,o,"labelAlign",function(){return this.createText(),this._text.align},function(e){this.createText(),this._text.align=e}),r(0,o,"clickHandler",function(){return this._clickHandler},function(e){this._clickHandler=e}),r(0,o,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(e){this._bitmap.sizeGrid=E.fillArray(k.defaultSizeGrid,e,Number)}),r(0,o,"width",e.prototype._$get_width,function(e){i.superSet(D,this,"width",e),this._autoSize&&(this._bitmap.width=e,this._text&&(this._text.width=e))}),r(0,o,"height",e.prototype._$get_height,function(e){i.superSet(D,this,"height",e),this._autoSize&&(this._bitmap.height=e,this._text&&(this._text.height=e))}),r(0,o,"dataSource",e.prototype._$get_dataSource,function(e){this._dataSource=e,"number"==typeof e||"string"==typeof e?this.label=e+"":i.superSet(D,this,"dataSource",e)}),r(0,o,"iconOffset",function(){return this._bitmap._offset?this._bitmap._offset.join(","):null},function(e){this._bitmap._offset=e?E.fillArray([1,1],e,Number):[]}),n(t,["stateMap",function(){return this.stateMap={mouseup:0,mouseover:1,mousedown:2,mouseout:0}}]),t}(D),B=function(e){function t(e,i,n){this._sources=null,this._bitmap=null,this._skin=null,this._clipX=1,this._clipY=1,this._clipWidth=0,this._clipHeight=0,this._autoPlay=!1,this._interval=50,this._complete=null,this._isPlaying=!1,this._index=0,this._clipChanged=!1,this._group=null,this._toIndex=-1,t.__super.call(this),void 0===i&&(i=1),void 0===n&&(n=1),this._clipX=i,this._clipY=n,this.skin=e}a(t,"laya.ui.Clip",e);var n=t.prototype;return n.destroy=function(t){void 0===t&&(t=!0),e.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,this._sources=null},n.dispose=function(){this.destroy(!0),i.loader.clearRes(this._skin)},n.createChildren=function(){this.graphics=this._bitmap=new L},n._onDisplay=function(e){this._isPlaying?this._displayedInStage?this.play():this.stop():this._autoPlay&&this.play()},n.changeClip=function(){if(this._clipChanged=!1,this._skin){var e=f.getRes(this._skin);e?this.loadComplete(this._skin,e):i.loader.load(this._skin,_.create(this,this.loadComplete,[this._skin]))}},n.loadComplete=function(e,t){if(e===this._skin&&t){var i=this._clipWidth||Math.ceil(t.sourceWidth/this._clipX),n=this._clipHeight||Math.ceil(t.sourceHeight/this._clipY),a=this._skin+i+n,r=M.I.get(a);if(I.isOkTextureList(r)||(r=null),r)this._sources=r;else{this._sources=[];for(var o=0;o<this._clipY;o++)for(var s=0;s<this._clipX;s++)this._sources.push(w.createFromTexture(t,i*s,n*o,i,n));M.I.set(a,this._sources)}this.index=this._index,this.event("loaded"),this.onCompResize()}},n.play=function(e,t){void 0===e&&(e=0),void 0===t&&(t=-1),this._isPlaying=!0,this.index=e,this._toIndex=t,this._index++,i.timer.loop(this.interval,this,this._loop),this.on("display",this,this._onDisplay),this.on("undisplay",this,this._onDisplay)},n._loop=function(){this._style.visible&&this._sources&&(this._index++,this._toIndex>-1&&this._index>=this._toIndex?this.stop():this._index>=this._sources.length&&(this._index=0),this.index=this._index)},n.stop=function(){this._isPlaying=!1,i.timer.clear(this,this._loop),this.event("complete")},n._setClipChanged=function(){this._clipChanged||(this._clipChanged=!0,this.callLater(this.changeClip))},r(0,n,"interval",function(){return this._interval},function(e){this._interval!=e&&(this._interval=e,this._isPlaying&&this.play())}),r(0,n,"skin",function(){return this._skin},function(e){this._skin!=e&&(this._skin=e,e?this._setClipChanged():this._bitmap.source=null)}),r(0,n,"sources",function(){return this._sources},function(e){this._sources=e,this.index=this._index,this.event("loaded")}),r(0,n,"clipX",function(){return this._clipX},function(e){this._clipX=e||1,this._setClipChanged()}),r(0,n,"clipY",function(){return this._clipY},function(e){this._clipY=e||1,this._setClipChanged()}),r(0,n,"total",function(){return this.runCallLater(this.changeClip),this._sources?this._sources.length:0}),r(0,n,"clipWidth",function(){return this._clipWidth},function(e){this._clipWidth=e,this._setClipChanged()}),r(0,n,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(e){this._bitmap.sizeGrid=E.fillArray(k.defaultSizeGrid,e,Number)}),r(0,n,"group",function(){return this._group},function(e){e&&this._skin&&f.setGroup(this._skin,e),this._group=e}),r(0,n,"clipHeight",function(){return this._clipHeight},function(e){this._clipHeight=e,this._setClipChanged()}),r(0,n,"width",e.prototype._$get_width,function(e){i.superSet(D,this,"width",e),this._bitmap.width=e}),r(0,n,"height",e.prototype._$get_height,function(e){i.superSet(D,this,"height",e),this._bitmap.height=e}),r(0,n,"measureWidth",function(){return this.runCallLater(this.changeClip),this._bitmap.width}),r(0,n,"measureHeight",function(){return this.runCallLater(this.changeClip),this._bitmap.height}),r(0,n,"index",function(){return this._index},function(e){this._index=e,this._bitmap&&this._sources&&(this._bitmap.source=this._sources[e]),this.event("change")}),r(0,n,"autoPlay",function(){return this._autoPlay},function(e){this._autoPlay!=e&&(this._autoPlay=e,e?this.play():this.stop())}),r(0,n,"isPlaying",function(){return this._isPlaying},function(e){this._isPlaying=e}),r(0,n,"dataSource",e.prototype._$get_dataSource,function(e){this._dataSource=e,"number"==typeof e&&Math.floor(e)==e||"string"==typeof e?this.index=parseInt(e):i.superSet(D,this,"dataSource",e)}),r(0,n,"bitmap",function(){return this._bitmap}),t}(D),P=function(e){function t(){this.changeHandler=null,this._gridSize=11,this._bgColor="#ffffff",this._borderColor="#000000",this._inputColor="#000000",this._inputBgColor="#efefef",this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=[],this._selectedColor="#000000",this._panelChanged=!1,t.__super.call(this)}a(t,"laya.ui.ColorPicker",e);var n=t.prototype;return n.destroy=function(t){void 0===t&&(t=!0),e.prototype.destroy.call(this,t),this._colorPanel&&this._colorPanel.destroy(t),this._colorButton&&this._colorButton.destroy(t),this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=null,this.changeHandler=null},n.createChildren=function(){this.addChild(this._colorButton=new R),this._colorPanel=new A,this._colorPanel.size(230,166),this._colorPanel.addChild(this._colorTiles=new x),this._colorPanel.addChild(this._colorBlock=new x),this._colorPanel.addChild(this._colorInput=new m)},n.initialize=function(){this._colorButton.on("click",this,this.onColorButtonClick),this._colorBlock.pos(5,5),this._colorInput.pos(60,5),this._colorInput.size(60,20),this._colorInput.on("change",this,this.onColorInputChange),this._colorInput.on("keydown",this,this.onColorFieldKeyDown),this._colorTiles.pos(5,30),this._colorTiles.on("mousemove",this,this.onColorTilesMouseMove),this._colorTiles.on("click",this,this.onColorTilesClick),this._colorTiles.size(20*this._gridSize,12*this._gridSize),this._colorPanel.on("mousedown",this,this.onPanelMouseDown),this.bgColor=this._bgColor},n.onPanelMouseDown=function(e){e.stopPropagation()},n.changePanel=function(){this._panelChanged=!1;var e=this._colorPanel.graphics;e.clear(),e.drawRect(0,0,230,166,this._bgColor,this._borderColor),this.drawBlock(this._selectedColor),this._colorInput.borderColor=this._borderColor,this._colorInput.bgColor=this._inputBgColor,this._colorInput.color=this._inputColor,(e=this._colorTiles.graphics).clear();for(var t=[0,3355443,6710886,10066329,13421772,16777215,16711680,65280,255,16776960,65535,16711935],i=0;i<12;i++)for(var n=0;n<20;n++){var a=0;a=0===n?t[i]:1===n?0:51*(((3*i+n/6)%3<<0)+3*(i/6<<0))<<16|n%6*51<<8|(i<<0)%6*51;var r=E.toColor(a);this._colors.push(r);var o=n*this._gridSize,s=i*this._gridSize;e.drawRect(o,s,this._gridSize,this._gridSize,r,"#000000")}},n.onColorButtonClick=function(e){this._colorPanel.parent?this.close():this.open()},n.open=function(){var e=this.localToGlobal(new g),t=e.x+this._colorPanel.width<=i.stage.width?e.x:i.stage.width-this._colorPanel.width,n=e.y+this._colorButton.height;n=n+this._colorPanel.height<=i.stage.height?n:e.y-this._colorPanel.height,this._colorPanel.pos(t,n),this._colorPanel.zOrder=1001,i._currentStage.addChild(this._colorPanel),i.stage.on("mousedown",this,this.removeColorBox)},n.close=function(){i.stage.off("mousedown",this,this.removeColorBox),this._colorPanel.removeSelf()},n.removeColorBox=function(e){this.close()},n.onColorFieldKeyDown=function(e){13==e.keyCode&&(this._colorInput.text?this.selectedColor=this._colorInput.text:this.selectedColor=null,this.close(),e.stopPropagation())},n.onColorInputChange=function(e){this._colorInput.text?this.drawBlock(this._colorInput.text):this.drawBlock("#FFFFFF")},n.onColorTilesClick=function(e){this.selectedColor=this.getColorByMouse(),this.close()},n.onColorTilesMouseMove=function(e){this._colorInput.focus=!1;var t=this.getColorByMouse();this._colorInput.text=t,this.drawBlock(t)},n.getColorByMouse=function(){var e=this._colorTiles.getMousePoint(),t=Math.floor(e.x/this._gridSize),i=Math.floor(e.y/this._gridSize);return this._colors[20*i+t]},n.drawBlock=function(e){var t=this._colorBlock.graphics;t.clear();var i=e||"#ffffff";t.drawRect(0,0,50,20,i,this._borderColor),e||t.drawLine(0,0,50,20,"#ff0000")},n.changeColor=function(){var e=this.graphics;e.clear();var t=this._selectedColor||"#000000";e.drawRect(0,0,this._colorButton.width,this._colorButton.height,t)},n._setPanelChanged=function(){this._panelChanged||(this._panelChanged=!0,this.callLater(this.changePanel))},r(0,n,"inputBgColor",function(){return this._inputBgColor},function(e){this._inputBgColor=e,this._setPanelChanged()}),r(0,n,"selectedColor",function(){return this._selectedColor},function(e){this._selectedColor!=e&&(this._selectedColor=this._colorInput.text=e,this.drawBlock(e),this.changeColor(),this.changeHandler&&this.changeHandler.runWith(this._selectedColor),this.event("change",c.EMPTY.setTo("change",this,this)))}),r(0,n,"skin",function(){return this._colorButton.skin},function(e){this._colorButton.skin=e,this.changeColor()}),r(0,n,"bgColor",function(){return this._bgColor},function(e){this._bgColor=e,this._setPanelChanged()}),r(0,n,"borderColor",function(){return this._borderColor},function(e){this._borderColor=e,this._setPanelChanged()}),r(0,n,"inputColor",function(){return this._inputColor},function(e){this._inputColor=e,this._setPanelChanged()}),t}(D),O=function(e){function t(e,i){this._visibleNum=6,this._button=null,this._list=null,this._isOpen=!1,this._itemSize=12,this._labels=[],this._selectedIndex=-1,this._selectHandler=null,this._itemHeight=NaN,this._listHeight=NaN,this._listChanged=!1,this._itemChanged=!1,this._scrollBarSkin=null,this._isCustomList=!1,this.itemRender=null,t.__super.call(this),this._itemColors=k.comboBoxItemColors,this.skin=e,this.labels=i}a(t,"laya.ui.ComboBox",e);var n=t.prototype;return n.destroy=function(t){void 0===t&&(t=!0),e.prototype.destroy.call(this,t),this._button&&this._button.destroy(t),this._list&&this._list.destroy(t),this._button=null,this._list=null,this._itemColors=null,this._labels=null,this._selectHandler=null},n.createChildren=function(){this.addChild(this._button=new R),this._button.text.align="left",this._button.labelPadding="0,0,0,5",this._button.on("mousedown",this,this.onButtonMouseDown)},n._createList=function(){this._list=new W,this._scrollBarSkin&&(this._list.vScrollBarSkin=this._scrollBarSkin),this._setListEvent(this._list)},n._setListEvent=function(e){this._list.selectEnable=!0,this._list.on("mousedown",this,this.onListDown),this._list.mouseHandler=_.create(this,this.onlistItemMouse,null,!1),this._list.scrollBar&&this._list.scrollBar.on("mousedown",this,this.onScrollBarDown)},n.onListDown=function(e){e.stopPropagation()},n.onScrollBarDown=function(e){e.stopPropagation()},n.onButtonMouseDown=function(e){this.callLater(this.switchTo,[!this._isOpen])},n.changeList=function(){this._listChanged=!1;var e=this.width-2,t=this._itemColors[2];this._itemHeight=this._itemSize+6,this._list.itemRender=this.itemRender||{type:"Box",child:[{type:"Label",props:{name:"label",x:1,padding:"3,3,3,3",width:e,height:this._itemHeight,fontSize:this._itemSize,color:t}}]},this._list.repeatY=this._visibleNum,this._list.refresh()},n.onlistItemMouse=function(e,t){var i=e.type;if("mouseover"===i||"mouseout"===i){if(this._isCustomList)return;var n=this._list.getCell(t);if(!n)return;var a=n.getChildByName("label");a&&("mouseover"===i?(a.bgColor=this._itemColors[0],a.color=this._itemColors[1]):(a.bgColor=null,a.color=this._itemColors[2]))}else"click"===i&&(this.selectedIndex=t,this.isOpen=!1)},n.switchTo=function(e){this.isOpen=e},n.changeOpen=function(){this.isOpen=!this._isOpen},n.changeItem=function(){if(this._itemChanged=!1,this._listHeight=this._labels.length>0?Math.min(this._visibleNum,this._labels.length)*this._itemHeight:this._itemHeight,!this._isCustomList){var e=this._list.graphics;e.clear(),e.drawRect(0,0,this.width-1,this._listHeight,this._itemColors[4],this._itemColors[3])}var t=this._list.array||[];t.length=0;for(var i=0,n=this._labels.length;i<n;i++)t.push({label:this._labels[i]});this._list.height=this._listHeight,this._list.array=t},n.changeSelected=function(){this._button.label=this.selectedLabel},n._onStageMouseWheel=function(e){this._list&&!this._list.contains(e.target)&&this.removeList(null)},n.removeList=function(e){i.stage.off("mousedown",this,this.removeList),i.stage.off("mousewheel",this,this._onStageMouseWheel),this.isOpen=!1},r(0,n,"selectedIndex",function(){return this._selectedIndex},function(e){this._selectedIndex!=e&&(this._selectedIndex=e,this._labels.length>0?this.changeSelected():this.callLater(this.changeSelected),this.event("change",[c.EMPTY.setTo("change",this,this)]),this._selectHandler&&this._selectHandler.runWith(this._selectedIndex))}),r(0,n,"measureHeight",function(){return this._button.height}),r(0,n,"skin",function(){return this._button.skin},function(e){this._button.skin!=e&&(this._button.skin=e,this._listChanged=!0)}),r(0,n,"measureWidth",function(){return this._button.width}),r(0,n,"width",e.prototype._$get_width,function(e){i.superSet(D,this,"width",e),this._button.width=this._width,this._itemChanged=!0,this._listChanged=!0}),r(0,n,"selectedLabel",function(){return this._selectedIndex>-1&&this._selectedIndex<this._labels.length?this._labels[this._selectedIndex]:null},function(e){this.selectedIndex=this._labels.indexOf(e)}),r(0,n,"labels",function(){return this._labels.join(",")},function(e){this._labels.length>0&&(this.selectedIndex=-1),e?this._labels=e.split(","):this._labels.length=0,this._itemChanged=!0}),r(0,n,"height",e.prototype._$get_height,function(e){i.superSet(D,this,"height",e),this._button.height=this._height}),r(0,n,"selectHandler",function(){return this._selectHandler},function(e){this._selectHandler=e}),r(0,n,"visibleNum",function(){return this._visibleNum},function(e){this._visibleNum=e,this._listChanged=!0}),r(0,n,"labelBold",function(){return this._button.text.bold},function(e){this._button.text.bold=e}),r(0,n,"itemColors",function(){return String(this._itemColors)},function(e){this._itemColors=E.fillArray(this._itemColors,e,String),this._listChanged=!0}),r(0,n,"itemSize",function(){return this._itemSize},function(e){this._itemSize=e,this._listChanged=!0}),r(0,n,"scrollBar",function(){return this.list.scrollBar}),r(0,n,"isOpen",function(){return this._isOpen},function(e){if(this._isOpen!=e)if(this._isOpen=e,this._button.selected=this._isOpen,this._isOpen){this._list||this._createList(),this._listChanged&&!this._isCustomList&&this.changeList(),this._itemChanged&&this.changeItem();var t=this.localToGlobal(g.TEMP.setTo(0,0)),n=t.y+this._button.height;n=n+this._listHeight<=i.stage.height?n:t.y-this._listHeight,this._list.pos(t.x,n),this._list.zOrder=1001,i._currentStage.addChild(this._list),i.stage.once("mousedown",this,this.removeList),i.stage.on("mousewheel",this,this._onStageMouseWheel),this._list.selectedIndex=this._selectedIndex}else this._list&&this._list.removeSelf()}),r(0,n,"scrollBarSkin",function(){return this._scrollBarSkin},function(e){this._scrollBarSkin=e}),r(0,n,"sizeGrid",function(){return this._button.sizeGrid},function(e){this._button.sizeGrid=e}),r(0,n,"button",function(){return this._button}),r(0,n,"list",function(){return this._list||this._createList(),this._list},function(e){e&&(e.removeSelf(),this._isCustomList=!0,this._list=e,this._setListEvent(e),this._itemHeight=e.getCell(0).height+e.spaceY)}),r(0,n,"dataSource",e.prototype._$get_dataSource,function(e){this._dataSource=e,"number"==typeof e&&Math.floor(e)==e||"string"==typeof e?this.selectedIndex=parseInt(e):e instanceof Array?this.labels=e.join(","):i.superSet(D,this,"dataSource",e)}),r(0,n,"labelColors",function(){return this._button.labelColors},function(e){this._button.labelColors!=e&&(this._button.labelColors=e)}),r(0,n,"labelPadding",function(){return this._button.text.padding.join(",")},function(e){this._button.text.padding=E.fillArray(k.labelPadding,e,Number)}),r(0,n,"labelSize",function(){return this._button.text.fontSize},function(e){this._button.text.fontSize=e}),r(0,n,"labelFont",function(){return this._button.text.font},function(e){this._button.text.font=e}),r(0,n,"stateNum",function(){return this._button.stateNum},function(e){this._button.stateNum=e}),t}(D),V=function(e){function t(e){this.rollRatio=.95,this.changeHandler=null,this.scaleBar=!0,this.autoHide=!1,this.elasticDistance=0,this.elasticBackTime=500,this.upButton=null,this.downButton=null,this.slider=null,this._scrollSize=1,this._skin=null,this._thumbPercent=1,this._target=null,this._lastPoint=null,this._lastOffset=0,this._checkElastic=!1,this._isElastic=!1,this._value=NaN,this._hide=!1,this._clickOnly=!0,this._offsets=null,t.__super.call(this),this._showButtons=T.showButtons,this._touchScrollEnable=T.touchScrollEnable,this._mouseWheelEnable=T.mouseWheelEnable,this.skin=e,this.max=1}a(t,"laya.ui.ScrollBar",e);var n=t.prototype;return n.destroy=function(t){void 0===t&&(t=!0),this.stopScroll(),this.target=null,e.prototype.destroy.call(this,t),this.upButton&&this.upButton.destroy(t),this.downButton&&this.downButton.destroy(t),this.slider&&this.slider.destroy(t),this.upButton=this.downButton=null,this.slider=null,this.changeHandler=null,this._offsets=null},n.createChildren=function(){this.addChild(this.slider=new U),this.addChild(this.upButton=new R),this.addChild(this.downButton=new R)},n.initialize=function(){this.slider.showLabel=!1,this.slider.on("change",this,this.onSliderChange),this.slider.setSlider(0,0,0),this.upButton.on("mousedown",this,this.onButtonMouseDown),this.downButton.on("mousedown",this,this.onButtonMouseDown)},n.onSliderChange=function(){this._value!=this.slider.value&&(this.value=this.slider.value)},n.onButtonMouseDown=function(e){var t=e.currentTarget===this.upButton;this.slide(t),i.timer.once(k.scrollBarDelayTime,this,this.startLoop,[t]),i.stage.once("mouseup",this,this.onStageMouseUp)},n.startLoop=function(e){i.timer.frameLoop(1,this,this.slide,[e])},n.slide=function(e){e?this.value-=this._scrollSize:this.value+=this._scrollSize},n.onStageMouseUp=function(e){i.timer.clear(this,this.startLoop),i.timer.clear(this,this.slide)},n.changeScrollBar=function(){this.upButton.visible=this._showButtons,this.downButton.visible=this._showButtons,this._showButtons&&(this.upButton.skin=this._skin.replace(".png","$up.png"),this.downButton.skin=this._skin.replace(".png","$down.png")),this.slider.isVertical?this.slider.y=this._showButtons?this.upButton.height:0:this.slider.x=this._showButtons?this.upButton.width:0,this.resetPositions(),this.repaint()},n.changeSize=function(){e.prototype.changeSize.call(this),this.repaint(),this.resetPositions(),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this.value)},n.resetPositions=function(){this.slider.isVertical?this.slider.height=this.height-(this._showButtons?this.upButton.height+this.downButton.height:0):this.slider.width=this.width-(this._showButtons?this.upButton.width+this.downButton.width:0),this.resetButtonPosition()},n.resetButtonPosition=function(){this.slider.isVertical?this.downButton.y=this.slider.y+this.slider.height:this.downButton.x=this.slider.x+this.slider.width},n.setScroll=function(e,t,i){this.runCallLater(this.changeSize),this.slider.setSlider(e,t,i),this.slider.bar.visible=t>0,!this._hide&&this.autoHide&&(this.visible=!1)},n.onTargetMouseWheel=function(e){this.value-=e.delta*this._scrollSize,this.target=this._target},n.onTargetMouseDown=function(e){this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new g),this._lastPoint.setTo(i.stage.mouseX,i.stage.mouseY),i.timer.clear(this,this.tweenMove),S.clearTween(this),i.stage.once("mouseup",this,this.onStageMouseUp2),i.stage.once("mouseout",this,this.onStageMouseUp2),i.timer.frameLoop(1,this,this.loop)},n.loop=function(){var e=i.stage.mouseY,t=i.stage.mouseX;if(this._lastOffset=this.isVertical?e-this._lastPoint.y:t-this._lastPoint.x,this._clickOnly){if(!(Math.abs(this._lastOffset*(this.isVertical?i.stage._canvasTransform.getScaleY():i.stage._canvasTransform.getScaleX()))>1))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this._target.mouseEnabled=!1,!this.hide&&this.autoHide&&(this.alpha=1,this.visible=!0),this.event("start")}this._offsets.push(this._lastOffset),this._lastPoint.x=t,this._lastPoint.y=e,0!==this._lastOffset&&(this._checkElastic||(this.elasticDistance>0?this._checkElastic||0==this._lastOffset||(this._lastOffset>0&&this._value<=this.min||this._lastOffset<0&&this._value>=this.max?(this._isElastic=!0,this._checkElastic=!0):this._isElastic=!1):this._checkElastic=!0),this._isElastic?this._value<=this.min?this.value-=this._lastOffset*Math.max(0,1-(this.min-this._value)/this.elasticDistance):this._value>=this.max&&(this.value-=this._lastOffset*Math.max(0,1-(this._value-this.max)/this.elasticDistance)):this.value-=this._lastOffset)},n.onStageMouseUp2=function(e){if(i.stage.off("mouseup",this,this.onStageMouseUp2),i.stage.off("mouseout",this,this.onStageMouseUp2),i.timer.clear(this,this.loop),!(this._clickOnly&&this._value>=this.min&&this._value<=this.max))if(this._target.mouseEnabled=!0,this._isElastic)this._value<this.min?S.to(this,{value:this.min},this.elasticBackTime,l.sineOut,_.create(this,this.elasticOver)):this._value>this.max&&S.to(this,{value:this.max},this.elasticBackTime,l.sineOut,_.create(this,this.elasticOver));else{if(!this._offsets)return;this._offsets.length<1&&(this._offsets[0]=this.isVertical?i.stage.mouseY-this._lastPoint.y:i.stage.mouseX-this._lastPoint.x);for(var t=0,n=Math.min(this._offsets.length,3),a=0;a<n;a++)t+=this._offsets[this._offsets.length-1-a];if(this._lastOffset=t/n,(t=Math.abs(this._lastOffset))<2)return void this.event("end");t>60&&(this._lastOffset=this._lastOffset>0?60:-60);var r=Math.round(Math.abs(this.elasticDistance*(this._lastOffset/240)));i.timer.frameLoop(1,this,this.tweenMove,[r])}},n.elasticOver=function(){this._isElastic=!1,!this.hide&&this.autoHide&&S.to(this,{alpha:0},500),this.event("end")},n.tweenMove=function(e){this._lastOffset*=this.rollRatio;var t=NaN;if(e>0&&(this._lastOffset>0&&this.value<=this.min?(this._isElastic=!0,t=.5*-(this.min-e-this.value),this._lastOffset>t&&(this._lastOffset=t)):this._lastOffset<0&&this.value>=this.max&&(this._isElastic=!0,t=.5*-(this.max+e-this.value),this._lastOffset<t&&(this._lastOffset=t))),this.value-=this._lastOffset,Math.abs(this._lastOffset)<1){if(i.timer.clear(this,this.tweenMove),this._isElastic)return void(this._value<this.min?S.to(this,{value:this.min},this.elasticBackTime,l.sineOut,_.create(this,this.elasticOver)):this._value>this.max?S.to(this,{value:this.max},this.elasticBackTime,l.sineOut,_.create(this,this.elasticOver)):this.elasticOver());this.event("end"),!this.hide&&this.autoHide&&S.to(this,{alpha:0},500)}},n.stopScroll=function(){this.onStageMouseUp2(null),i.timer.clear(this,this.tweenMove),S.clearTween(this)},r(0,n,"measureHeight",function(){return this.slider.isVertical?100:this.slider.height}),r(0,n,"skin",function(){return this._skin},function(e){this._skin!=e&&(this._skin=e,this.slider.skin=this._skin,this.callLater(this.changeScrollBar))}),r(0,n,"max",function(){return this.slider.max},function(e){this.slider.max=e}),r(0,n,"showButtons",function(){return this._showButtons},function(e){this._showButtons=e,this.callLater(this.changeScrollBar)}),r(0,n,"measureWidth",function(){return this.slider.isVertical?this.slider.width:100}),r(0,n,"min",function(){return this.slider.min},function(e){this.slider.min=e}),r(0,n,"value",function(){return this._value},function(e){e!==this._value&&(this._value=e,this._isElastic||(this.slider._value!=e&&(this.slider._value=e,this.slider.changeValue()),this._value=this.slider._value),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this._value))}),r(0,n,"isVertical",function(){return this.slider.isVertical},function(e){this.slider.isVertical=e}),r(0,n,"sizeGrid",function(){return this.slider.sizeGrid},function(e){this.slider.sizeGrid=e}),r(0,n,"scrollSize",function(){return this._scrollSize},function(e){this._scrollSize=e}),r(0,n,"dataSource",e.prototype._$get_dataSource,function(e){this._dataSource=e,"number"==typeof e||"string"==typeof e?this.value=Number(e):i.superSet(D,this,"dataSource",e)}),r(0,n,"thumbPercent",function(){return this._thumbPercent},function(e){this.runCallLater(this.changeScrollBar),this.runCallLater(this.changeSize),e=e>=1?.99:e,this._thumbPercent=e,this.scaleBar&&(this.slider.isVertical?this.slider.bar.height=Math.max(this.slider.height*e,k.scrollBarMinNum):this.slider.bar.width=Math.max(this.slider.width*e,k.scrollBarMinNum))}),r(0,n,"target",function(){return this._target},function(e){this._target&&(this._target.off("mousewheel",this,this.onTargetMouseWheel),this._target.off("mousedown",this,this.onTargetMouseDown)),this._target=e,e&&(this._mouseWheelEnable&&this._target.on("mousewheel",this,this.onTargetMouseWheel),this._touchScrollEnable&&this._target.on("mousedown",this,this.onTargetMouseDown))}),r(0,n,"hide",function(){return this._hide},function(e){this._hide=e,this.visible=!e}),r(0,n,"touchScrollEnable",function(){return this._touchScrollEnable},function(e){this._touchScrollEnable=e,this.target=this._target}),r(0,n,"mouseWheelEnable",function(){return this._mouseWheelEnable},function(e){this._mouseWheelEnable=e}),r(0,n,"tick",function(){return this.slider.tick},function(e){this.slider.tick=e}),t}(D),U=function(e){function t(e){this.changeHandler=null,this.isVertical=!0,this.showLabel=!0,this._allowClickBack=!1,this._max=100,this._min=0,this._tick=1,this._value=0,this._skin=null,this._bg=null,this._progress=null,this._bar=null,this._tx=NaN,this._ty=NaN,this._maxMove=NaN,this._globalSacle=null,t.__super.call(this),this.skin=e}a(t,"laya.ui.Slider",e);var o=t.prototype;return o.destroy=function(t){void 0===t&&(t=!0),e.prototype.destroy.call(this,t),this._bg&&this._bg.destroy(t),this._bar&&this._bar.destroy(t),this._progress&&this._progress.destroy(t),this._bg=null,this._bar=null,this._progress=null,this.changeHandler=null},o.createChildren=function(){this.addChild(this._bg=new F),this.addChild(this._bar=new R)},o.initialize=function(){this._bar.on("mousedown",this,this.onBarMouseDown),this._bg.sizeGrid=this._bar.sizeGrid="4,4,4,4,0",this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid),this.allowClickBack=!0},o.onBarMouseDown=function(e){this._globalSacle||(this._globalSacle=new g),this._globalSacle.setTo(this.globalScaleX||.01,this.globalScaleY||.01),this._maxMove=this.isVertical?this.height-this._bar.height:this.width-this._bar.width,this._tx=i.stage.mouseX,this._ty=i.stage.mouseY,i.stage.on("mousemove",this,this.mouseMove),i.stage.once("mouseup",this,this.mouseUp),i.stage.once("mouseout",this,this.mouseUp),this.showValueText()},o.showValueText=function(){if(this.showLabel){var e=laya.ui.Slider.label;this.addChild(e),e.textField.changeText(this._value+""),this.isVertical?(e.x=this._bar.x+20,e.y=.5*(this._bar.height-e.height)+this._bar.y):(e.y=this._bar.y-20,e.x=.5*(this._bar.width-e.width)+this._bar.x)}},o.hideValueText=function(){laya.ui.Slider.label&&laya.ui.Slider.label.removeSelf()},o.mouseUp=function(e){i.stage.off("mousemove",this,this.mouseMove),i.stage.off("mouseup",this,this.mouseUp),i.stage.off("mouseout",this,this.mouseUp),this.sendChangeEvent("changed"),this.hideValueText()},o.mouseMove=function(e){var t=this._value;this.isVertical?(this._bar.y+=(i.stage.mouseY-this._ty)/this._globalSacle.y,this._bar.y>this._maxMove?this._bar.y=this._maxMove:this._bar.y<0&&(this._bar.y=0),this._value=this._bar.y/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x+=(i.stage.mouseX-this._tx)/this._globalSacle.x,this._bar.x>this._maxMove?this._bar.x=this._maxMove:this._bar.x<0&&(this._bar.x=0),this._value=this._bar.x/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width)),this._tx=i.stage.mouseX,this._ty=i.stage.mouseY;var n=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*n)/n,this._value!=t&&this.sendChangeEvent(),this.showValueText()},o.sendChangeEvent=function(e){void 0===e&&(e="change"),this.event(e),this.changeHandler&&this.changeHandler.runWith(this._value)},o.setBarPoint=function(){this.isVertical?this._bar.x=Math.round(.5*(this._bg.width-this._bar.width)):this._bar.y=Math.round(.5*(this._bg.height-this._bar.height))},o.changeSize=function(){e.prototype.changeSize.call(this),this.isVertical?this._bg.height=this.height:this._bg.width=this.width,this.setBarPoint(),this.changeValue()},o.setSlider=function(e,t,i){this._value=-1,this._min=e,this._max=t>e?t:e,this.value=i<e?e:i>t?t:i},o.changeValue=function(){var e=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*e)/e,this._value=this._value>this._max?this._max:this._value<this._min?this._min:this._value;var t=this._max-this._min;0===t&&(t=1),this.isVertical?(this._bar.y=(this._value-this._min)/t*(this.height-this._bar.height),this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x=(this._value-this._min)/t*(this.width-this._bar.width),this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width))},o.onBgMouseDown=function(e){var t=this._bg.getMousePoint();this.isVertical?this.value=t.y/(this.height-this._bar.height)*(this._max-this._min)+this._min:this.value=t.x/(this.width-this._bar.width)*(this._max-this._min)+this._min},r(0,o,"measureHeight",function(){return Math.max(this._bg.height,this._bar.height)}),r(0,o,"skin",function(){return this._skin},function(e){if(this._skin!=e){this._skin=e,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png");var t=this._skin.replace(".png","$progress.png");f.getRes(t)&&(this._progress||(this.addChild(this._progress=new F),this._progress.sizeGrid=this._bar.sizeGrid,this.setChildIndex(this._progress,1)),this._progress.skin=t),this.setBarPoint(),this.callLater(this.changeValue)}}),r(0,o,"allowClickBack",function(){return this._allowClickBack},function(e){this._allowClickBack!=e&&(this._allowClickBack=e,e?this._bg.on("mousedown",this,this.onBgMouseDown):this._bg.off("mousedown",this,this.onBgMouseDown))}),r(0,o,"max",function(){return this._max},function(e){this._max!=e&&(this._max=e,this.callLater(this.changeValue))}),r(0,o,"measureWidth",function(){return Math.max(this._bg.width,this._bar.width)}),r(0,o,"tick",function(){return this._tick},function(e){this._tick!=e&&(this._tick=e,this.callLater(this.changeValue))}),r(0,o,"sizeGrid",function(){return this._bg.sizeGrid},function(e){this._bg.sizeGrid=e,this._bar.sizeGrid=e,this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid)}),r(0,o,"min",function(){return this._min},function(e){this._min!=e&&(this._min=e,this.callLater(this.changeValue))}),r(0,o,"value",function(){return this._value},function(e){if(this._value!=e){var t=this._value;this._value=e,this.changeValue(),this._value!=t&&this.sendChangeEvent()}}),r(0,o,"dataSource",e.prototype._$get_dataSource,function(e){this._dataSource=e,"number"==typeof e||"string"==typeof e?this.value=Number(e):i.superSet(D,this,"dataSource",e)}),r(0,o,"bar",function(){return this._bar}),n(t,["label",function(){return this.label=new H}]),t}(D),F=function(e){function t(e){this._bitmap=null,this._skin=null,this._group=null,t.__super.call(this),this.skin=e}a(t,"laya.ui.Image",e);var n=t.prototype;return n.destroy=function(t){void 0===t&&(t=!0),e.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null},n.dispose=function(){this.destroy(!0),i.loader.clearRes(this._skin)},n.createChildren=function(){this.graphics=this._bitmap=new L,this._bitmap.autoCacheCmd=!1},n.setSource=function(e,t){e===this._skin&&t&&(this.source=t,this.onCompResize())},r(0,n,"source",function(){return this._bitmap.source},function(e){this._bitmap&&(this._bitmap.source=e,this.event("loaded"),this.repaint())}),r(0,n,"dataSource",e.prototype._$get_dataSource,function(e){this._dataSource=e,"string"==typeof e?this.skin=e:i.superSet(D,this,"dataSource",e)}),r(0,n,"measureHeight",function(){return this._bitmap.height}),r(0,n,"skin",function(){return this._skin},function(e){if(this._skin!=e||!this.source)if(this._skin=e,e){var t=f.getRes(e);t?(this.source=t,this.onCompResize()):this.source=null}else this.source=null}),r(0,n,"group",function(){return this._group},function(e){e&&this._skin&&f.setGroup(this._skin,e),this._group=e}),r(0,n,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(e){this._bitmap.sizeGrid=E.fillArray(k.defaultSizeGrid,e,Number)}),r(0,n,"measureWidth",function(){return this._bitmap.width}),r(0,n,"width",e.prototype._$get_width,function(e){i.superSet(D,this,"width",e),this._bitmap.width=0==e?1e-7:e}),r(0,n,"height",e.prototype._$get_height,function(e){i.superSet(D,this,"height",e),this._bitmap.height=0==e?1e-7:e}),t}(D),H=function(e){function t(e){this._tf=null,t.__super.call(this),void 0===e&&(e=""),p.defaultColor=k.labelColor,this.text=e}a(t,"laya.ui.Label",e);var n=t.prototype;return n.destroy=function(t){void 0===t&&(t=!0),e.prototype.destroy.call(this,t),this._tf=null},n.createChildren=function(){this.addChild(this._tf=new b)},n.changeText=function(e){this._tf.changeText(e)},r(0,n,"padding",function(){return this._tf.padding.join(",")},function(e){this._tf.padding=E.fillArray(k.labelPadding,e,Number)}),r(0,n,"bold",function(){return this._tf.bold},function(e){this._tf.bold=e}),r(0,n,"align",function(){return this._tf.align},function(e){this._tf.align=e}),r(0,n,"text",function(){return this._tf.text},function(e){this._tf.text!=e&&(e&&(e=E.adptString(e+"")),this._tf.text=e,this.event("change"),this._width&&this._height||this.onCompResize())}),r(0,n,"italic",function(){return this._tf.italic},function(e){this._tf.italic=e}),r(0,n,"wordWrap",function(){return this._tf.wordWrap},function(e){this._tf.wordWrap=e}),r(0,n,"font",function(){return this._tf.font},function(e){this._tf.font=e}),r(0,n,"dataSource",e.prototype._$get_dataSource,function(e){this._dataSource=e,"number"==typeof e||"string"==typeof e?this.text=e+"":i.superSet(D,this,"dataSource",e)}),r(0,n,"color",function(){return this._tf.color},function(e){this._tf.color=e}),r(0,n,"valign",function(){return this._tf.valign},function(e){this._tf.valign=e}),r(0,n,"leading",function(){return this._tf.leading},function(e){this._tf.leading=e}),r(0,n,"fontSize",function(){return this._tf.fontSize},function(e){this._tf.fontSize=e}),r(0,n,"bgColor",function(){return this._tf.bgColor},function(e){this._tf.bgColor=e}),r(0,n,"borderColor",function(){return this._tf.borderColor},function(e){this._tf.borderColor=e}),r(0,n,"stroke",function(){return this._tf.stroke},function(e){this._tf.stroke=e}),r(0,n,"strokeColor",function(){return this._tf.strokeColor},function(e){this._tf.strokeColor=e}),r(0,n,"textField",function(){return this._tf}),r(0,n,"measureWidth",function(){return this._tf.width}),r(0,n,"measureHeight",function(){return this._tf.height}),r(0,n,"width",function(){return this._width||this._tf.text?i.superGet(D,this,"width"):0},function(e){i.superSet(D,this,"width",e),this._tf.width=e}),r(0,n,"height",function(){return this._height||this._tf.text?i.superGet(D,this,"height"):0},function(e){i.superSet(D,this,"height",e),this._tf.height=e}),r(0,n,"overflow",function(){return this._tf.overflow},function(e){this._tf.overflow=e}),r(0,n,"underline",function(){return this._tf.underline},function(e){this._tf.underline=e}),r(0,n,"underlineColor",function(){return this._tf.underlineColor},function(e){this._tf.underlineColor=e}),t}(D),z=function(e){function t(e){this.changeHandler=null,this._bg=null,this._bar=null,this._skin=null,this._value=.5,t.__super.call(this),this.skin=e}a(t,"laya.ui.ProgressBar",e);var n=t.prototype;return n.destroy=function(t){void 0===t&&(t=!0),e.prototype.destroy.call(this,t),this._bg&&this._bg.destroy(t),this._bar&&this._bar.destroy(t),this._bg=this._bar=null,this.changeHandler=null},n.createChildren=function(){this.addChild(this._bg=new F),this.addChild(this._bar=new F),this._bar._bitmap.autoCacheCmd=!1},n.changeValue=function(){if(this.sizeGrid){var e=this.sizeGrid.split(","),t=Number(e[3]),i=Number(e[1]),n=(this.width-t-i)*this._value;this._bar.width=t+i+n,this._bar.visible=this._bar.width>t+i}else this._bar.width=this.width*this._value},r(0,n,"measureHeight",function(){return this._bg.height}),r(0,n,"skin",function(){return this._skin},function(e){this._skin!=e&&(this._skin=e,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png"),this.callLater(this.changeValue))}),r(0,n,"measureWidth",function(){return this._bg.width}),r(0,n,"height",e.prototype._$get_height,function(e){i.superSet(D,this,"height",e),this._bg.height=this._height,this._bar.height=this._height}),r(0,n,"bar",function(){return this._bar}),r(0,n,"value",function(){return this._value},function(e){this._value!=e&&(e=e>1?1:e<0?0:e,this._value=e,this.callLater(this.changeValue),this.event("change"),this.changeHandler&&this.changeHandler.runWith(e))}),r(0,n,"bg",function(){return this._bg}),r(0,n,"sizeGrid",function(){return this._bg.sizeGrid},function(e){this._bg.sizeGrid=this._bar.sizeGrid=e}),r(0,n,"width",e.prototype._$get_width,function(e){i.superSet(D,this,"width",e),this._bg.width=this._width,this.callLater(this.changeValue)}),r(0,n,"dataSource",e.prototype._$get_dataSource,function(e){this._dataSource=e,"number"==typeof e||"string"==typeof e?this.value=Number(e):i.superSet(D,this,"dataSource",e)}),t}(D),X=(function(e){function t(){this._tipBox=null,this._tipText=null,this._defaultTipHandler=null,t.__super.call(this),this._tipBox=new D,this._tipBox.addChild(this._tipText=new b),this._tipText.x=this._tipText.y=5,this._tipText.color=t.tipTextColor,this._defaultTipHandler=this._showDefaultTip,i.stage.on("showtip",this,this._onStageShowTip),i.stage.on("hidetip",this,this._onStageHideTip),this.zOrder=1100}a(t,"laya.ui.TipManager",D);var n=t.prototype;n._onStageHideTip=function(e){i.timer.clear(this,this._showTip),this.closeAll(),this.removeSelf()},n._onStageShowTip=function(e){i.timer.once(t.tipDelay,this,this._showTip,[e],!0)},n._showTip=function(e){if("string"==typeof e){var t=String(e);Boolean(t)&&this._defaultTipHandler(t)}else e instanceof laya.utils.Handler?e.run():"function"==typeof e&&e.apply();i.stage.on("mousemove",this,this._onStageMouseMove),i.stage.on("mousedown",this,this._onStageMouseDown),this._onStageMouseMove(null)},n._onStageMouseDown=function(e){this.closeAll()},n._onStageMouseMove=function(e){this._showToStage(this,t.offsetX,t.offsetY)},n._showToStage=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=0);var a=e.getBounds();e.x=i.stage.mouseX+t,e.y=i.stage.mouseY+n,e.x+a.width>i.stage.width&&(e.x-=a.width+t),e.y+a.height>i.stage.height&&(e.y-=a.height+n)},n.closeAll=function(){i.timer.clear(this,this._showTip),i.stage.off("mousemove",this,this._onStageMouseMove),i.stage.off("mousedown",this,this._onStageMouseDown),this.removeChildren()},n.showDislayTip=function(e){this.addChild(e),this._showToStage(this),i._currentStage.addChild(this)},n._showDefaultTip=function(e){this._tipText.text=e;var n=this._tipBox.graphics;n.clear(),n.drawRect(0,0,this._tipText.width+10,this._tipText.height+10,t.tipBackColor),this.addChild(this._tipBox),this._showToStage(this),i._currentStage.addChild(this)},r(0,n,"defaultTipHandler",function(){return this._defaultTipHandler},function(e){this._defaultTipHandler=e}),t.offsetX=10,t.offsetY=15,t.tipTextColor="#ffffff",t.tipBackColor="#111111",t.tipDelay=200}(),function(e){function t(){this._idMap=null,this._aniList=null,this._watchMap={},t.__super.call(this)}var r;a(t,"laya.ui.View",A);var h=t.prototype;return h.createView=function(e){if(e.animations&&!this._idMap&&(this._idMap={}),t.createComp(e,this,this),e.animations){var i,n,a=[],r=e.animations,o=0,s=r.length;for(o=0;o<s;o++){switch(i=new u,n=r[o],i._setUp(this._idMap,n),this[n.name]=i,i._setControlNode(this),n.action){case 1:i.play(0,!1);break;case 2:i.play(0,!0)}a.push(i)}this._aniList=a}this._width>0&&null==e.props.hitTestPrior&&!this.mouseThrough&&(this.hitTestPrior=!0)},h.onEvent=function(e,t){},h.loadUI=function(e){var i=t.uiMap[e];i&&this.createView(i)},h.destroy=function(e){void 0===e&&(e=!0),this._aniList&&(this._aniList.length=0),this._idMap=null,this._aniList=null,this._watchMap=null,laya.ui.Component.prototype.destroy.call(this,e)},h.changeData=function(e){var t=this._watchMap[e];if(t){console.log("change",e);for(var i=0,n=t.length;i<n;i++){t[i].exe(this)}}},t._regs=function(){for(var e in t.uiClassMap)s.regClass(e,t.uiClassMap[e])},t.createComp=function(e,n,a,r){if(!(n=n||t.getCompInstance(e)))return console.warn("can not create:"+e.type),null;var o=e.child;if(o)for(var h=n instanceof laya.ui.List,l=0,c=o.length;l<c;l++){var p=o[l];if(!n.hasOwnProperty("itemRender")||"render"!=p.props.name&&"render"!==p.props.renderType)if("Graphic"==p.type)s.addGraphicsToSprite(p,n);else if(s.isDrawType(p.type))s.addGraphicToSprite(p,n,!0);else{if(h){var u=[],d=t.createComp(p,null,a,u);u.length&&(d._$bindData=u)}else d=t.createComp(p,null,a,r);"Script"==p.type?("owner"in d?d.owner=n:"target"in d&&(d.target=n),"copydata"in d&&(d.copydata=e),n.scriptMap||(n.scriptMap={}),n.scriptMap[p.props.runtime]=d):"mask"==p.props.renderType||"mask"==p.props.name?n.mask=d:d instanceof laya.display.Sprite&&n.addChild(d)}else n.itemRender=p}var _=e.props;for(var m in _){var f=_[m];t.eventDic[m]?f&&a&&n.on(m,a,a.onEvent,[f]):t.setCompValue(n,m,f,a,r)}return i.__typeof(n,"laya.ui.IItem")&&n.initItems(),e.compId&&a&&a._idMap&&(a._idMap[e.compId]=n),n},t.setCompValue=function(e,n,a,o,h){if("string"==typeof a&&a.indexOf("${")>-1){if(t._sheet||(t._sheet=s.getClass("laya.data.Table")),!t._sheet)return void console.warn("Can not find class Sheet");if(h)h.push(e,n,a);else if(o){-1==a.indexOf("].")&&(a=a.replace(".","[0]."));var l=new r(e,n,a);l.exe(o);for(var c,p,u=a.replace(/\[.*?\]\./g,".");null!=(c=t._parseWatchData.exec(u));){for(var d=c[1];null!=(p=t._parseKeyWord.exec(d));){var _=p[0],m=o._watchMap[_]||(o._watchMap[_]=[]);m.push(l),t._sheet.I.notifer.on(_,o,o.changeData,[_])}(m=o._watchMap[d]||(o._watchMap[d]=[])).push(l),t._sheet.I.notifer.on(d,o,o.changeData,[d])}}}else if("var"===n&&o)o[a]=e;else if("onClick"==n){var f=i._runScript("(function(){"+a+"})");e.on("click",o,f)}else e[n]="true"===a||"false"!==a&&a},t.getCompInstance=function(e){var n,a=e.props?e.props.runtime:null;return n=a?t.viewClassMap[a]||t.uiClassMap[a]||i.__classmap[a]:t.uiClassMap[e.type],e.props&&e.props.hasOwnProperty("renderType")&&"instance"==e.props.renderType?n.instance:n?new n:null},t.regComponent=function(e,i){t.uiClassMap[e]=i,s.regClass(e,i)},t.regViewRuntime=function(e,i){t.viewClassMap[e]=i},t.uiMap={},t.viewClassMap={},t._sheet=null,n(t,["uiClassMap",function(){return this.uiClassMap={ViewStack:ee,LinkButton:R,TextArea:le,ColorPicker:P,Box:A,Button:R,CheckBox:Y,Clip:B,ComboBox:O,Component:D,HScrollBar:q,HSlider:J,Image:F,Label:H,List:W,Panel:K,ProgressBar:z,Radio:Q,RadioGroup:se,ScrollBar:V,Slider:U,Tab:he,TextInput:ie,View:t,VScrollBar:te,VSlider:ne,Tree:$,HBox:re,VBox:oe,Sprite:x,Animation:o,Text:b,FontClip:j}},"eventDic",function(){return this.eventDic={mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0,rightmousedown:!0,rightmouseup:!0,rightclick:!0}},"_parseWatchData",function(){return this._parseWatchData=/\${(.*?)}/g},"_parseKeyWord",function(){return this._parseKeyWord=/[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g}]),t.__init$=function(){t._regs(),r=function(){function e(e,t,i){this.comp=null,this.prop=null,this.value=null,this.comp=e,this.prop=t,this.value=i}a(e,"");return e.prototype.exe=function(e){var t=E.getBindFun(this.value);this.comp[this.prop]=t.call(this,e)},e}()},t}()),Y=function(e){function t(e,i){void 0===i&&(i=""),t.__super.call(this,e,i)}a(t,"laya.ui.CheckBox",e);var n=t.prototype;return n.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!0,this._autoSize=!1},n.initialize=function(){e.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0},r(0,n,"dataSource",e.prototype._$get_dataSource,function(e){this._dataSource=e,"boolean"==typeof e?this.selected=e:"string"==typeof e?this.selected="true"===e:i.superSet(R,this,"dataSource",e)}),t}(R),G=function(e){function t(){this._space=0,this._align="none",this._itemChanged=!1,t.__super.call(this)}a(t,"laya.ui.LayoutBox",A);var i=t.prototype;return i.addChild=function(e){return e.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChild.call(this,e)},i.onResize=function(e){this._setItemChanged()},i.addChildAt=function(e,t){return e.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChildAt.call(this,e,t)},i.removeChild=function(e){return e.off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChild.call(this,e)},i.removeChildAt=function(e){return this.getChildAt(e).off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChildAt.call(this,e)},i.refresh=function(){this._setItemChanged()},i.changeItems=function(){this._itemChanged=!1},i.sortItem=function(e){e&&e.sort(function(e,t){return e.y-t.y})},i._setItemChanged=function(){this._itemChanged||(this._itemChanged=!0,this.callLater(this.changeItems))},r(0,i,"space",function(){return this._space},function(e){this._space=e,this._setItemChanged()}),r(0,i,"align",function(){return this._align},function(e){this._align=e,this._setItemChanged()}),t}(),j=function(e){function t(e,i){this._valueArr=null,this._indexMap=null,this._sheet=null,this._direction="horizontal",this._spaceX=0,this._spaceY=0,this._align="left",this._wordsW=0,this._wordsH=0,t.__super.call(this),e&&(this.skin=e),i&&(this.sheet=i)}a(t,"laya.ui.FontClip",e);var n=t.prototype;return n.createChildren=function(){this._bitmap=new L,this.on("loaded",this,this._onClipLoaded)},n._onClipLoaded=function(){this.callLater(this.changeValue)},n.changeValue=function(){if(this._sources&&this._valueArr){this.graphics.clear(!0);var e;if(e=this._sources[0]){var t="horizontal"===this._direction;t?(this._wordsW=this._valueArr.length*(e.sourceWidth+this.spaceX),this._wordsH=e.sourceHeight):(this._wordsW=e.sourceWidth,this._wordsH=(e.sourceHeight+this.spaceY)*this._valueArr.length);var i=0;if(this._width)switch(this._align){case"center":i=.5*(this._width-this._wordsW);break;case"right":i=this._width-this._wordsW;break;default:i=0}for(var n=0,a=this._valueArr.length;n<a;n++){var r=this._indexMap[this._valueArr.charAt(n)];this.sources[r]&&(e=this.sources[r],t?this.graphics.drawTexture(e,i+n*(e.sourceWidth+this.spaceX),0,e.sourceWidth,e.sourceHeight):this.graphics.drawTexture(e,0+i,n*(e.sourceHeight+this.spaceY),e.sourceWidth,e.sourceHeight))}this._width||(this.resetLayoutX(),this.callLater(this.changeSize)),this._height||(this.resetLayoutY(),this.callLater(this.changeSize))}}},n.destroy=function(t){void 0===t&&(t=!0),this._valueArr=null,this._indexMap=null,this.graphics.clear(!0),this.removeSelf(),this.off("loaded",this,this._onClipLoaded),e.prototype.destroy.call(this,t)},r(0,n,"sheet",function(){return this._sheet},function(e){e+="",this._sheet=e;var t=e.split(" ");this._clipX=String(t[0]).length,this.clipY=t.length,this._indexMap={};for(var i=0;i<this._clipY;i++)for(var n=t[i].split(""),a=0,r=n.length;a<r;a++)this._indexMap[n[a]]=i*this._clipX+a}),r(0,n,"height",e.prototype._$get_height,function(e){i.superSet(B,this,"height",e),this.callLater(this.changeValue)}),r(0,n,"direction",function(){return this._direction},function(e){this._direction=e,this.callLater(this.changeValue)}),r(0,n,"value",function(){return this._valueArr?this._valueArr:""},function(e){e+="",this._valueArr=e,this.callLater(this.changeValue)}),r(0,n,"width",e.prototype._$get_width,function(e){i.superSet(B,this,"width",e),this.callLater(this.changeValue)}),r(0,n,"spaceX",function(){return this._spaceX},function(e){this._spaceX=e,"horizontal"===this._direction&&this.callLater(this.changeValue)}),r(0,n,"spaceY",function(){return this._spaceY},function(e){this._spaceY=e,"horizontal"!==this._direction&&this.callLater(this.changeValue)}),r(0,n,"align",function(){return this._align},function(e){this._align=e,this.callLater(this.changeValue)}),r(0,n,"measureWidth",function(){return this._wordsW}),r(0,n,"measureHeight",function(){return this._wordsH}),t}(B),W=function(e){function t(){this.selectHandler=null,this.renderHandler=null,this.mouseHandler=null,this.selectEnable=!1,this.totalPage=0,this._content=null,this._scrollBar=null,this._itemRender=null,this._repeatX=0,this._repeatY=0,this._repeatX2=0,this._repeatY2=0,this._spaceX=0,this._spaceY=0,this._array=null,this._startIndex=0,this._selectedIndex=-1,this._page=0,this._isVertical=!0,this._cellSize=20,this._cellOffset=0,this._isMoved=!1,this.cacheContent=!1,this._createdLine=0,this._cellChanged=!1,t.__super.call(this),this._cells=[],this._offset=new g}a(t,"laya.ui.List",e);var n=t.prototype;return i.imps(n,{"laya.ui.IRender":!0,"laya.ui.IItem":!0}),n.destroy=function(e){void 0===e&&(e=!0),this._content&&this._content.destroy(e),this._scrollBar&&this._scrollBar.destroy(e),laya.ui.Component.prototype.destroy.call(this,e),this._content=null,this._scrollBar=null,this._itemRender=null,this._cells=null,this._array=null,this.selectHandler=this.renderHandler=this.mouseHandler=null},n.createChildren=function(){this.addChild(this._content=new A)},n.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=i.superGet(A,this,"cacheAs")),i.superSet(A,this,"cacheAs","none"),this._scrollBar.once("end",this,this.onScrollEnd)},n.onScrollEnd=function(){i.superSet(A,this,"cacheAs",this._$P.cacheAs)},n._removePreScrollBar=function(){var e=this.removeChildByName("scrollBar");e&&e.destroy(!0)},n.changeCells=function(){if(this._cellChanged=!1,this._itemRender){this.scrollBar=this.getChildByName("scrollBar");var e=this._getOneCell(),t=e.width+this._spaceX||1,i=e.height+this._spaceY||1;this._width>0&&(this._repeatX2=this._isVertical?Math.round(this._width/t):Math.ceil(this._width/t)),this._height>0&&(this._repeatY2=this._isVertical?Math.ceil(this._height/i):Math.round(this._height/i));var n=this._width?this._width:t*this.repeatX-this._spaceX,a=this._height?this._height:i*this.repeatY-this._spaceY;this._cellSize=this._isVertical?i:t,this._cellOffset=this._isVertical?i*Math.max(this._repeatY2,this._repeatY)-a-this._spaceY:t*Math.max(this._repeatX2,this._repeatX)-n-this._spaceX,this._isVertical&&this._scrollBar?this._scrollBar.height=a:!this._isVertical&&this._scrollBar&&(this._scrollBar.width=n),this.setContentSize(n,a);var r=this._isVertical?this.repeatX:this.repeatY,o=(this._isVertical?this.repeatY:this.repeatX)+(this._scrollBar?1:0);this._createItems(0,r,o),this._createdLine=o,this._array&&(this.array=this._array,this.runCallLater(this.renderItems))}},n._getOneCell=function(){if(0===this._cells.length){var e=this.createItem();if(this._offset.setTo(e.x,e.y),this.cacheContent)return e;this._cells.push(e)}return this._cells[0]},n._createItems=function(e,t,i){var n=this._content,a=this._getOneCell(),r=a.width+this._spaceX,o=a.height+this._spaceY;if(this.cacheContent){var s=new A;s.cacheAsBitmap=!0,s.pos((this._isVertical?0:e)*r,(this._isVertical?e:0)*o),this._content.addChild(s),this._content.optimizeScrollRect=!0,n=s}else{for(var h=[],l=this._cells.length-1;l>-1;l--){var c=this._cells[l];c.removeSelf(),h.push(c)}this._cells.length=0}for(var p=e;p<i;p++)for(var u=0;u<t;u++)(a=h&&h.length?h.pop():this.createItem()).x=(this._isVertical?u:p)*r-n.x,a.y=(this._isVertical?p:u)*o-n.y,a.name="item"+(p*t+u),n.addChild(a),this.addCell(a)},n.createItem=function(){var e=[];if("function"==typeof this._itemRender)var t=new this._itemRender;else t=X.createComp(this._itemRender,null,null,e);if(0==e.length&&t._watchMap){var i=t._watchMap;for(var n in i)for(var a=i[n],r=0;r<a.length;r++){var o=a[r];e.push(o.comp,o.prop,o.value)}}return e.length&&(t._$bindData=e),t},n.addCell=function(e){e.on("click",this,this.onCellMouse),e.on("rightclick",this,this.onCellMouse),e.on("mouseover",this,this.onCellMouse),e.on("mouseout",this,this.onCellMouse),e.on("mousedown",this,this.onCellMouse),e.on("mouseup",this,this.onCellMouse),this._cells.push(e)},n.initItems=function(){if(!this._itemRender&&null!=this.getChildByName("item0")){this.repeatX=1;var e=0;e=0;for(var t=0;t<1e4;t++){var i=this.getChildByName("item"+t);{if(!i)break;this.addCell(i),e++}}this.repeatY=e}},n.setContentSize=function(e,t){this._content.width=e,this._content.height=t,(this._scrollBar||0!=this._offset.x||0!=this._offset.y)&&(this._content.scrollRect||(this._content.scrollRect=new y),this._content.scrollRect.setTo(-this._offset.x,-this._offset.y,e,t),this._content.scrollRect=this._content.scrollRect),this.event("resize")},n.onCellMouse=function(e){"mousedown"===e.type&&(this._isMoved=!1);var t=e.currentTarget,i=this._startIndex+this._cells.indexOf(t);i<0||("click"===e.type||"rightclick"===e.type?this.selectEnable&&!this._isMoved?this.selectedIndex=i:this.changeCellState(t,!0,0):"mouseover"!==e.type&&"mouseout"!==e.type||this._selectedIndex===i||this.changeCellState(t,"mouseover"===e.type,0),this.mouseHandler&&this.mouseHandler.runWith([e,i]))},n.changeCellState=function(e,t,i){var n=e.getChildByName("selectBox");n&&(this.selectEnable=!0,n.visible=t,n.index=i)},n.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this.width,this.height),this._scrollBar&&this.callLater(this.onScrollBarChange)},n.onScrollBarChange=function(e){this.runCallLater(this.changeCells);var t=this._scrollBar.value,i=this._isVertical?this.repeatX:this.repeatY,n=this._isVertical?this.repeatY:this.repeatX,a=Math.floor(t/this._cellSize);if(this.cacheContent)o=n+1,this._createdLine-a<o&&(this._createItems(this._createdLine,i,this._createdLine+o),this.renderItems(this._createdLine*i,0),this._createdLine+=o);else{var r=a*i,o=0;if(r>this._startIndex){o=r-this._startIndex;var s=!0,h=this._startIndex+i*(n+1);this._isMoved=!0}else r<this._startIndex&&(o=this._startIndex-r,s=!1,h=this._startIndex-1,this._isMoved=!0);for(var l=0;l<o;l++){if(s){var c=this._cells.shift();this._cells[this._cells.length]=c;var p=h+l}else c=this._cells.pop(),this._cells.unshift(c),p=h-l;var u=Math.floor(p/i)*this._cellSize;this._isVertical?c.y=u:c.x=u,this.renderItem(c,p)}this._startIndex=r,this.changeSelectStatus()}var d=this._content.scrollRect;this._isVertical?(d.y=t-this._offset.y,d.x=-this._offset.x):(d.y=-this._offset.y,d.x=t-this._offset.x),this._content.scrollRect=d},n.posCell=function(e,t){if(this._scrollBar){var i=this._isVertical?this.repeatX:this.repeatY,n=(this._isVertical?this.repeatY:this.repeatX,Math.floor(t/i)*this._cellSize);this._isVertical?e.y=n:e.x=n}},n.changeSelectStatus=function(){for(var e=0,t=this._cells.length;e<t;e++)this.changeCellState(this._cells[e],this._selectedIndex===this._startIndex+e,1)},n.renderItems=function(e,t){void 0===e&&(e=0),void 0===t&&(t=0);for(var i=e,n=t||this._cells.length;i<n;i++)this.renderItem(this._cells[i],this._startIndex+i);this.changeSelectStatus()},n.renderItem=function(e,t){this._array&&t>=0&&t<this._array.length?(e.visible=!0,e._$bindData?(e._dataSource=this._array[t],this._bindData(e,this._array[t])):e.dataSource=this._array[t],this.cacheContent||this.posCell(e,t),this.hasListener("render")&&this.event("render",[e,t]),this.renderHandler&&this.renderHandler.runWith([e,t])):(e.visible=!1,e.dataSource=null)},n._bindData=function(e,t){for(var i=e._$bindData,n=0,a=i.length;n<a;n++){var r=i[n++],o=i[n++],s=i[n],h=E.getBindFun(s);r[o]=h.call(this,t)}},n.refresh=function(){this.array=this._array},n.getItem=function(e){return e>-1&&e<this._array.length?this._array[e]:null},n.changeItem=function(e,t){e>-1&&e<this._array.length&&(this._array[e]=t,e>=this._startIndex&&e<this._startIndex+this._cells.length&&this.renderItem(this.getCell(e),e))},n.setItem=function(e,t){this.changeItem(e,t)},n.addItem=function(e){this._array.push(e),this.array=this._array},n.addItemAt=function(e,t){this._array.splice(t,0,e),this.array=this._array},n.deleteItem=function(e){this._array.splice(e,1),this.array=this._array},n.getCell=function(e){return this.runCallLater(this.changeCells),e>-1&&this._cells?this._cells[(e-this._startIndex)%this._cells.length]:null},n.scrollTo=function(e){if(this._scrollBar){var t=this._isVertical?this.repeatX:this.repeatY;this._scrollBar.value=Math.floor(e/t)*this._cellSize}else this.startIndex=e},n.tweenTo=function(e,t,i){if(void 0===t&&(t=200),this._scrollBar){var n=this._isVertical?this.repeatX:this.repeatY;S.to(this._scrollBar,{value:Math.floor(e/n)*this._cellSize},t,null,i,0,!0)}else this.startIndex=e,i&&i.run()},n._setCellChanged=function(){this._cellChanged||(this._cellChanged=!0,this.callLater(this.changeCells))},n.commitMeasure=function(){this.runCallLater(this.changeCells)},r(0,n,"cacheAs",e.prototype._$get_cacheAs,function(e){i.superSet(A,this,"cacheAs",e),this._scrollBar&&(this._$P.cacheAs=null,"none"!==e?this._scrollBar.on("start",this,this.onScrollStart):this._scrollBar.off("start",this,this.onScrollStart))}),r(0,n,"content",function(){return this._content}),r(0,n,"height",e.prototype._$get_height,function(e){e!=this._height&&(i.superSet(A,this,"height",e),this._setCellChanged())}),r(0,n,"itemRender",function(){return this._itemRender},function(e){if(this._itemRender!=e){this._itemRender=e;for(var t=this._cells.length-1;t>-1;t--)this._cells[t].destroy();this._cells.length=0,this._setCellChanged()}}),r(0,n,"vScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(e){this._removePreScrollBar();var t=new te;t.name="scrollBar",t.right=0,e&&" "!=e&&(t.skin=e),this.scrollBar=t,this.addChild(t),this._setCellChanged()}),r(0,n,"page",function(){return this._page},function(e){this._page=e,this._array&&(this._page=e>0?e:0,this._page=this._page<this.totalPage?this._page:this.totalPage-1,this.startIndex=this._page*this.repeatX*this.repeatY)}),r(0,n,"hScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(e){this._removePreScrollBar();var t=new q;t.name="scrollBar",t.bottom=0,e&&" "!=e&&(t.skin=e),this.scrollBar=t,this.addChild(t),this._setCellChanged()}),r(0,n,"repeatX",function(){return this._repeatX>0?this._repeatX:this._repeatX2>0?this._repeatX2:1},function(e){this._repeatX=e,this._setCellChanged()}),r(0,n,"scrollBar",function(){return this._scrollBar},function(e){this._scrollBar!=e&&(this._scrollBar=e,e&&(this._isVertical=this._scrollBar.isVertical,this.addChild(this._scrollBar),this._scrollBar.on("change",this,this.onScrollBarChange)))}),r(0,n,"width",e.prototype._$get_width,function(e){e!=this._width&&(i.superSet(A,this,"width",e),this._setCellChanged())}),r(0,n,"repeatY",function(){return this._repeatY>0?this._repeatY:this._repeatY2>0?this._repeatY2:1},function(e){this._repeatY=e,this._setCellChanged()}),r(0,n,"spaceX",function(){return this._spaceX},function(e){this._spaceX=e,this._setCellChanged()}),r(0,n,"spaceY",function(){return this._spaceY},function(e){this._spaceY=e,this._setCellChanged()}),r(0,n,"selectedIndex",function(){return this._selectedIndex},function(e){this._selectedIndex!=e&&(this._selectedIndex=e,this.changeSelectStatus(),this.event("change"),this.selectHandler&&this.selectHandler.runWith(e),this.startIndex=this._startIndex)}),r(0,n,"selectedItem",function(){return-1!=this._selectedIndex?this._array[this._selectedIndex]:null},function(e){this.selectedIndex=this._array.indexOf(e)}),r(0,n,"length",function(){return this._array?this._array.length:0}),r(0,n,"selection",function(){return this.getCell(this._selectedIndex)},function(e){this.selectedIndex=this._startIndex+this._cells.indexOf(e)}),r(0,n,"startIndex",function(){return this._startIndex},function(e){this._startIndex=e>0?e:0,this.callLater(this.renderItems)}),r(0,n,"array",function(){return this._array},function(e){this.runCallLater(this.changeCells),this._array=e||[];var t=this._array.length;if(this.totalPage=Math.ceil(t/(this.repeatX*this.repeatY)),this._selectedIndex=this._selectedIndex<t?this._selectedIndex:t-1,this.startIndex=this._startIndex,this._scrollBar){this._scrollBar.stopScroll();var i=this._isVertical?this.repeatX:this.repeatY,n=this._isVertical?this.repeatY:this.repeatX,a=Math.ceil(t/i);(this._cellOffset>0?this.totalPage+1:this.totalPage)>1?(this._scrollBar.scrollSize=this._cellSize,this._scrollBar.thumbPercent=n/a,this._scrollBar.setScroll(0,(a-n)*this._cellSize+this._cellOffset,this._scrollBar.value),this._scrollBar.target=this._content):(this._scrollBar.setScroll(0,0,0),this._scrollBar.target=this._content)}}),r(0,n,"dataSource",e.prototype._$get_dataSource,function(e){this._dataSource=e,"number"==typeof e&&Math.floor(e)==e||"string"==typeof e?this.selectedIndex=parseInt(e):e instanceof Array?this.array=e:i.superSet(A,this,"dataSource",e)}),r(0,n,"cells",function(){return this.runCallLater(this.changeCells),this._cells}),t}(A),q=function(e){function t(){t.__super.call(this)}a(t,"laya.ui.HScrollBar",e);return t.prototype.initialize=function(){e.prototype.initialize.call(this),this.slider.isVertical=!1},t}(V),K=function(e){function t(){this._content=null,this._vScrollBar=null,this._hScrollBar=null,this._scrollChanged=!1,t.__super.call(this),this.width=this.height=100}a(t,"laya.ui.Panel",e);var n=t.prototype;return n.destroy=function(e){void 0===e&&(e=!0),laya.ui.Component.prototype.destroy.call(this,e),this._content&&this._content.destroy(e),this._vScrollBar&&this._vScrollBar.destroy(e),this._hScrollBar&&this._hScrollBar.destroy(e),this._vScrollBar=null,this._hScrollBar=null,this._content=null},n.destroyChildren=function(){this._content.destroyChildren()},n.createChildren=function(){laya.display.Node.prototype.addChild.call(this,this._content=new A)},n.addChild=function(e){return e.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChild(e)},n.onResize=function(){this._setScrollChanged()},n.addChildAt=function(e,t){return e.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChildAt(e,t)},n.removeChild=function(e){return e.off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChild(e)},n.removeChildAt=function(e){return this.getChildAt(e).off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChildAt(e)},n.removeChildren=function(e,t){void 0===e&&(e=0),void 0===t&&(t=2147483647);for(var i=this._content.numChildren-1;i>-1;i--)this._content.removeChildAt(i);return this._setScrollChanged(),this},n.getChildAt=function(e){return this._content.getChildAt(e)},n.getChildByName=function(e){return this._content.getChildByName(e)},n.getChildIndex=function(e){return this._content.getChildIndex(e)},n.changeScroll=function(){this._scrollChanged=!1;var e=this.contentWidth||1,t=this.contentHeight||1,i=this._vScrollBar,n=this._hScrollBar,a=i&&t>this._height,r=n&&e>this._width,o=a?this._width-i.width:this._width,s=r?this._height-n.height:this._height;i&&(i.x=this._width-i.width,i.y=0,i.height=this._height-(r?n.height:0),i.scrollSize=Math.max(.033*this._height,1),i.thumbPercent=s/t,i.setScroll(0,t-s,i.value)),n&&(n.x=0,n.y=this._height-n.height,n.width=this._width-(a?i.width:0),n.scrollSize=Math.max(.033*this._width,1),n.thumbPercent=o/e,n.setScroll(0,e-o,n.value))},n.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this._width,this._height)},n.setContentSize=function(e,t){var i=this._content;i.width=e,i.height=t,i.scrollRect||(i.scrollRect=new y),i.scrollRect.setTo(0,0,e,t),i.scrollRect=i.scrollRect},n.onScrollBarChange=function(e){var t=this._content.scrollRect;if(t){var i=Math.round(e.value);e.isVertical?t.y=i:t.x=i,this._content.scrollRect=t}},n.scrollTo=function(e,t){void 0===e&&(e=0),void 0===t&&(t=0),this.vScrollBar&&(this.vScrollBar.value=t),this.hScrollBar&&(this.hScrollBar.value=e)},n.refresh=function(){this.changeScroll()},n.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=i.superGet(A,this,"cacheAs")),i.superSet(A,this,"cacheAs","none"),this._hScrollBar&&this._hScrollBar.once("end",this,this.onScrollEnd),this._vScrollBar&&this._vScrollBar.once("end",this,this.onScrollEnd)},n.onScrollEnd=function(){i.superSet(A,this,"cacheAs",this._$P.cacheAs)},n._setScrollChanged=function(){this._scrollChanged||(this._scrollChanged=!0,this.callLater(this.changeScroll))},r(0,n,"numChildren",function(){return this._content.numChildren}),r(0,n,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(e){null==this._hScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._hScrollBar=new q),this._hScrollBar.on("change",this,this.onScrollBarChange,[this._hScrollBar]),this._hScrollBar.target=this._content,this._setScrollChanged()),this._hScrollBar.skin=e}),r(0,n,"contentWidth",function(){for(var e=0,t=this._content.numChildren-1;t>-1;t--){var i=this._content.getChildAt(t);e=Math.max(i.x+i.width*i.scaleX,e)}return e}),r(0,n,"contentHeight",function(){for(var e=0,t=this._content.numChildren-1;t>-1;t--){var i=this._content.getChildAt(t);e=Math.max(i.y+i.height*i.scaleY,e)}return e}),r(0,n,"width",e.prototype._$get_width,function(e){i.superSet(A,this,"width",e),this._setScrollChanged()}),r(0,n,"hScrollBar",function(){return this._hScrollBar}),r(0,n,"content",function(){return this._content}),r(0,n,"height",e.prototype._$get_height,function(e){i.superSet(A,this,"height",e),this._setScrollChanged()}),r(0,n,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(e){null==this._vScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._vScrollBar=new te),this._vScrollBar.on("change",this,this.onScrollBarChange,[this._vScrollBar]),this._vScrollBar.target=this._content,this._setScrollChanged()),this._vScrollBar.skin=e}),r(0,n,"vScrollBar",function(){return this._vScrollBar}),r(0,n,"cacheAs",e.prototype._$get_cacheAs,function(e){i.superSet(A,this,"cacheAs",e),this._$P.cacheAs=null,"none"!==e?(this._hScrollBar&&this._hScrollBar.on("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.on("start",this,this.onScrollStart)):(this._hScrollBar&&this._hScrollBar.off("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.off("start",this,this.onScrollStart))}),t}(A),J=function(e){function t(e){t.__super.call(this,e),this.isVertical=!1}return a(t,"laya.ui.HSlider",U),t}(),Z=function(e){function t(e,i){this.selectHandler=null,this._items=null,this._selectedIndex=-1,this._skin=null,this._direction="horizontal",this._space=0,this._labels=null,this._labelColors=null,this._labelFont=null,this._labelStrokeColor=null,this._strokeColors=null,this._labelStroke=NaN,this._labelSize=0,this._labelBold=!1,this._labelPadding=null,this._labelAlign=null,this._stateNum=0,this._labelChanged=!1,t.__super.call(this),this.skin=i,this.labels=e}a(t,"laya.ui.UIGroup",e);var n=t.prototype;return i.imps(n,{"laya.ui.IItem":!0}),n.preinitialize=function(){this.mouseEnabled=!0},n.destroy=function(e){void 0===e&&(e=!0),laya.ui.Component.prototype.destroy.call(this,e),this._items&&(this._items.length=0),this._items=null,this.selectHandler=null},n.addItem=function(e,t){void 0===t&&(t=!0);var i=e,n=this._items.length;if(i.name="item"+n,this.addChild(i),this.initItems(),t&&n>0){var a=this._items[n-1];"horizontal"==this._direction?i.x=a.x+a.width+this._space:i.y=a.y+a.height+this._space}else t&&(i.x=0,i.y=0);return n},n.delItem=function(e,t){void 0===t&&(t=!0);var i=this._items.indexOf(e);if(-1!=i){var n=e;this.removeChild(n);for(var a=i+1,r=this._items.length;a<r;a++){var o=this._items[a];o.name="item"+(a-1),t&&("horizontal"==this._direction?o.x-=n.width+this._space:o.y-=n.height+this._space)}if(this.initItems(),this._selectedIndex>-1){var s=0;s=this._selectedIndex<this._items.length?this._selectedIndex:this._selectedIndex-1,this._selectedIndex=-1,this.selectedIndex=s}}},n.initItems=function(){this._items||(this._items=[]),this._items.length=0;for(var e=0;e<1e4;e++){var t=this.getChildByName("item"+e);if(null==t)break;this._items.push(t),t.selected=e===this._selectedIndex,t.clickHandler=_.create(this,this.itemClick,[e],!1)}},n.itemClick=function(e){this.selectedIndex=e},n.setSelect=function(e,t){this._items&&e>-1&&e<this._items.length&&(this._items[e].selected=t)},n.createItem=function(e,t){return null},n.changeLabels=function(){if(this._labelChanged=!1,this._items)for(var e=0,t=0,i=this._items.length;t<i;t++){var n=this._items[t];this._skin&&(n.skin=this._skin),this._labelColors&&(n.labelColors=this._labelColors),this._labelSize&&(n.labelSize=this._labelSize),this._labelStroke&&(n.labelStroke=this._labelStroke),this._labelStrokeColor&&(n.labelStrokeColor=this._labelStrokeColor),this._strokeColors&&(n.strokeColors=this._strokeColors),this._labelBold&&(n.labelBold=this._labelBold),this._labelPadding&&(n.labelPadding=this._labelPadding),this._labelAlign&&(n.labelAlign=this._labelAlign),this._stateNum&&(n.stateNum=this._stateNum),this._labelFont&&(n.labelFont=this._labelFont),"horizontal"===this._direction?(n.y=0,n.x=e,e+=n.width+this._space):(n.x=0,n.y=e,e+=n.height+this._space)}this.changeSize()},n.commitMeasure=function(){this.runCallLater(this.changeLabels)},n._setLabelChanged=function(){this._labelChanged||(this._labelChanged=!0,this.callLater(this.changeLabels))},r(0,n,"labelStrokeColor",function(){return this._labelStrokeColor},function(e){this._labelStrokeColor!=e&&(this._labelStrokeColor=e,this._setLabelChanged())}),r(0,n,"skin",function(){return this._skin},function(e){this._skin!=e&&(this._skin=e,this._setLabelChanged())}),r(0,n,"selectedIndex",function(){return this._selectedIndex},function(e){this._selectedIndex!=e&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=e,this.setSelect(e,!0),this.event("change"),this.selectHandler&&this.selectHandler.runWith(this._selectedIndex))}),r(0,n,"labels",function(){return this._labels},function(e){if(this._labels!=e){if(this._labels=e,this.removeChildren(),this._setLabelChanged(),this._labels)for(var t=this._labels.split(","),i=0,n=t.length;i<n;i++){var a=this.createItem(this._skin,t[i]);a.name="item"+i,this.addChild(a)}this.initItems()}}),r(0,n,"strokeColors",function(){return this._strokeColors},function(e){this._strokeColors!=e&&(this._strokeColors=e,this._setLabelChanged())}),r(0,n,"labelColors",function(){return this._labelColors},function(e){this._labelColors!=e&&(this._labelColors=e,this._setLabelChanged())}),r(0,n,"labelStroke",function(){return this._labelStroke},function(e){this._labelStroke!=e&&(this._labelStroke=e,this._setLabelChanged())}),r(0,n,"labelSize",function(){return this._labelSize},function(e){this._labelSize!=e&&(this._labelSize=e,this._setLabelChanged())}),r(0,n,"stateNum",function(){return this._stateNum},function(e){this._stateNum!=e&&(this._stateNum=e,this._setLabelChanged())}),r(0,n,"labelBold",function(){return this._labelBold},function(e){this._labelBold!=e&&(this._labelBold=e,this._setLabelChanged())}),r(0,n,"labelFont",function(){return this._labelFont},function(e){this._labelFont!=e&&(this._labelFont=e,this._setLabelChanged())}),r(0,n,"labelPadding",function(){return this._labelPadding},function(e){this._labelPadding!=e&&(this._labelPadding=e,this._setLabelChanged())}),r(0,n,"direction",function(){return this._direction},function(e){this._direction=e,this._setLabelChanged()}),r(0,n,"space",function(){return this._space},function(e){this._space=e,this._setLabelChanged()}),r(0,n,"items",function(){return this._items}),r(0,n,"selection",function(){return this._selectedIndex>-1&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(e){this.selectedIndex=this._items.indexOf(e)}),r(0,n,"dataSource",e.prototype._$get_dataSource,function(e){this._dataSource=e,"number"==typeof e&&Math.floor(e)==e||"string"==typeof e?this.selectedIndex=parseInt(e):e instanceof Array?this.labels=e.join(","):i.superSet(A,this,"dataSource",e)}),t}(A),Q=function(e){function t(e,i){this._value=null,void 0===i&&(i=""),t.__super.call(this,e,i)}a(t,"laya.ui.Radio",e);var i=t.prototype;return i.destroy=function(t){void 0===t&&(t=!0),e.prototype.destroy.call(this,t),this._value=null},i.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!1,this._autoSize=!1},i.initialize=function(){e.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0,this.on("click",this,this.onClick)},i.onClick=function(e){this.selected=!0},r(0,i,"value",function(){return null!=this._value?this._value:this.label},function(e){this._value=e}),t}(R),$=function(e){function t(){this._list=null,this._source=null,this._renderHandler=null,this._spaceLeft=10,this._spaceBottom=0,this._keepStatus=!0,t.__super.call(this),this.width=this.height=200}a(t,"laya.ui.Tree",e);var n=t.prototype;return i.imps(n,{"laya.ui.IRender":!0}),n.destroy=function(e){void 0===e&&(e=!0),laya.ui.Component.prototype.destroy.call(this,e),this._list&&this._list.destroy(e),this._list=null,this._source=null,this._renderHandler=null},n.createChildren=function(){this.addChild(this._list=new W),this._list.renderHandler=_.create(this,this.renderItem,null,!1),this._list.repeatX=1,this._list.on("change",this,this.onListChange)},n.onListChange=function(e){this.event("change")},n.getArray=function(){var e,t=[];for(var i in this._source)e=this._source[i],this.getParentOpenStatus(e)&&(e.x=this._spaceLeft*this.getDepth(e),t.push(e));return t},n.getDepth=function(e,t){return void 0===t&&(t=0),null==e.nodeParent?t:this.getDepth(e.nodeParent,t+1)},n.getParentOpenStatus=function(e){var t=e.nodeParent;return null==t||!!t.isOpen&&(null==t.nodeParent||this.getParentOpenStatus(t))},n.renderItem=function(e,t){var i=e.dataSource;if(i){e.left=i.x;var n=e.getChildByName("arrow");n&&(i.hasChild?(n.visible=!0,n.index=i.isOpen?1:0,n.tag=t,n.off("click",this,this.onArrowClick),n.on("click",this,this.onArrowClick)):n.visible=!1);var a=e.getChildByName("folder");a&&(2==a.clipY?a.index=i.isDirectory?0:1:a.index=i.isDirectory?i.isOpen?1:0:2),this._renderHandler&&this._renderHandler.runWith([e,t])}},n.onArrowClick=function(e){var t=e.currentTarget.tag;this._list.array[t].isOpen=!this._list.array[t].isOpen,this.event("open"),this._list.array=this.getArray()},n.setItemState=function(e,t){this._list.array[e]&&(this._list.array[e].isOpen=t,this._list.array=this.getArray())},n.fresh=function(){this._list.array=this.getArray(),this.repaint()},n.parseXml=function(e,t,i,n){var a,r=e.childNodes,o=r.length;if(!n){a={};var s,h=e.attributes;for(var l in h){var c=(s=h[l]).nodeName,p=s.nodeValue;a[c]="true"==p||"false"!=p&&p}a.nodeParent=i,o>0&&(a.isDirectory=!0),a.hasChild=o>0,t.push(a)}for(var u=0;u<o;u++){var d=r[u];this.parseXml(d,t,a,!1)}},n.parseOpenStatus=function(e,t){for(var i=0,n=t.length;i<n;i++){var a=t[i];if(a.isDirectory)for(var r=0,o=e.length;r<o;r++){var s=e[r];if(s.isDirectory&&this.isSameParent(s,a)&&a.label==s.label){a.isOpen=s.isOpen;break}}}},n.isSameParent=function(e,t){return null==e.nodeParent&&null==t.nodeParent||null!=e.nodeParent&&null!=t.nodeParent&&(e.nodeParent.label==t.nodeParent.label&&this.isSameParent(e.nodeParent,t.nodeParent))},n.filter=function(e){if(Boolean(e)){var t=[];this.getFilterSource(this._source,t,e),this._list.array=t}else this._list.array=this.getArray()},n.getFilterSource=function(e,t,i){i=i.toLocaleLowerCase();var n;for(var a in e)!(n=e[a]).isDirectory&&String(n.label).toLowerCase().indexOf(i)>-1&&(n.x=0,t.push(n)),n.child&&n.child.length>0&&this.getFilterSource(n.child,t,i)},r(0,n,"spaceBottom",function(){return this._list.spaceY},function(e){this._list.spaceY=e}),r(0,n,"keepStatus",function(){return this._keepStatus},function(e){this._keepStatus=e}),r(0,n,"itemRender",function(){return this._list.itemRender},function(e){this._list.itemRender=e}),r(0,n,"array",function(){return this._list.array},function(e){this._keepStatus&&this._list.array&&e&&this.parseOpenStatus(this._list.array,e),this._source=e,this._list.array=this.getArray()}),r(0,n,"mouseHandler",function(){return this._list.mouseHandler},function(e){this._list.mouseHandler=e}),r(0,n,"dataSource",e.prototype._$get_dataSource,function(e){this._dataSource=e,i.superSet(A,this,"dataSource",e)}),r(0,n,"source",function(){return this._source}),r(0,n,"scrollBar",function(){return this._list.scrollBar}),r(0,n,"list",function(){return this._list}),r(0,n,"scrollBarSkin",function(){return this._list.vScrollBarSkin},function(e){this._list.vScrollBarSkin=e}),r(0,n,"renderHandler",function(){return this._renderHandler},function(e){this._renderHandler=e}),r(0,n,"selectedIndex",function(){return this._list.selectedIndex},function(e){this._list.selectedIndex=e}),r(0,n,"spaceLeft",function(){return this._spaceLeft},function(e){this._spaceLeft=e}),r(0,n,"selectedItem",function(){return this._list.selectedItem},function(e){this._list.selectedItem=e}),r(0,n,"width",e.prototype._$get_width,function(e){i.superSet(A,this,"width",e),this._list.width=e}),r(0,n,"height",e.prototype._$get_height,function(e){i.superSet(A,this,"height",e),this._list.height=e}),r(0,n,"xml",null,function(e){var t=[];this.parseXml(e.childNodes[0],t,null,!0),this.array=t}),r(0,n,"selectedPath",function(){return this._list.selectedItem?this._list.selectedItem.path:null}),t}(A),ee=function(e){function t(){this._items=null,this._selectedIndex=0,t.__super.call(this),this._setIndexHandler=_.create(this,this.setIndex,null,!1)}a(t,"laya.ui.ViewStack",e);var n=t.prototype;return i.imps(n,{"laya.ui.IItem":!0}),n.setItems=function(e){this.removeChildren();for(var t=0,i=0,n=e.length;i<n;i++){var a=e[i];a&&(a.name="item"+t,this.addChild(a),t++)}this.initItems()},n.addItem=function(e){e.name="item"+this._items.length,this.addChild(e),this.initItems()},n.initItems=function(){this._items=[];for(var e=0;e<1e4;e++){var t=this.getChildByName("item"+e);if(null==t)break;this._items.push(t),t.visible=e==this._selectedIndex}},n.setSelect=function(e,t){this._items&&e>-1&&e<this._items.length&&(this._items[e].visible=t)},n.setIndex=function(e){this.selectedIndex=e},r(0,n,"dataSource",e.prototype._$get_dataSource,function(e){if(this._dataSource=e,"number"==typeof e&&Math.floor(e)==e||"string"==typeof e)this.selectedIndex=parseInt(e);else for(var t in this._dataSource)this.hasOwnProperty(t)&&(this[t]=this._dataSource[t])}),r(0,n,"selectedIndex",function(){return this._selectedIndex},function(e){this._selectedIndex!=e&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=e,this.setSelect(this._selectedIndex,!0))}),r(0,n,"selection",function(){return this._selectedIndex>-1&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(e){this.selectedIndex=this._items.indexOf(e)}),r(0,n,"items",function(){return this._items}),r(0,n,"setIndexHandler",function(){return this._setIndexHandler},function(e){this._setIndexHandler=e}),t}(A),te=function(e){function t(){t.__super.call(this)}return a(t,"laya.ui.VScrollBar",V),t}(),ie=function(e){function t(e){this._bg=null,this._skin=null,t.__super.call(this),void 0===e&&(e=""),this.text=e,this.skin=this.skin}a(t,"laya.ui.TextInput",e);var n=t.prototype;return n.preinitialize=function(){this.mouseEnabled=!0},n.destroy=function(t){void 0===t&&(t=!0),e.prototype.destroy.call(this,t),this._bg&&this._bg.destroy(),this._bg=null},n.createChildren=function(){this.addChild(this._tf=new m),this._tf.padding=k.inputLabelPadding,this._tf.on("input",this,this._onInput),this._tf.on("enter",this,this._onEnter),this._tf.on("blur",this,this._onBlur),this._tf.on("focus",this,this._onFocus)},n._onFocus=function(){this.event("focus",this)},n._onBlur=function(){this.event("blur",this)},n._onInput=function(){this.event("input",this)},n._onEnter=function(){this.event("enter",this)},n.initialize=function(){this.width=128,this.height=22},n.select=function(){this._tf.select()},n.setSelection=function(e,t){this._tf.setSelection(e,t)},r(0,n,"text",e.prototype._$get_text,function(e){this._tf.text!=e&&(e+="",this._tf.text=e,this.event("change"))}),r(0,n,"bg",function(){return this._bg},function(e){this.graphics=this._bg=e}),r(0,n,"inputElementYAdjuster",function(){return this._tf.inputElementYAdjuster},function(e){this._tf.inputElementYAdjuster=e}),r(0,n,"multiline",function(){return this._tf.multiline},function(e){this._tf.multiline=e}),r(0,n,"skin",function(){return this._skin},function(e){this._skin!=e&&(this._skin=e,this._bg||(this.graphics=this._bg=new L),this._bg.source=f.getRes(this._skin),this._width&&(this._bg.width=this._width),this._height&&(this._bg.height=this._height))}),r(0,n,"sizeGrid",function(){return this._bg&&this._bg.sizeGrid?this._bg.sizeGrid.join(","):null},function(e){this._bg||(this.graphics=this._bg=new L),this._bg.sizeGrid=E.fillArray(k.defaultSizeGrid,e,Number)}),r(0,n,"inputElementXAdjuster",function(){return this._tf.inputElementXAdjuster},function(e){this._tf.inputElementXAdjuster=e}),r(0,n,"width",e.prototype._$get_width,function(e){i.superSet(H,this,"width",e),this._bg&&(this._bg.width=e)}),r(0,n,"height",e.prototype._$get_height,function(e){i.superSet(H,this,"height",e),this._bg&&(this._bg.height=e)}),r(0,n,"editable",function(){return this._tf.editable},function(e){this._tf.editable=e}),r(0,n,"restrict",function(){return this._tf.restrict},function(e){this._tf.restrict=e}),r(0,n,"prompt",function(){return this._tf.prompt},function(e){this._tf.prompt=e}),r(0,n,"promptColor",function(){return this._tf.promptColor},function(e){this._tf.promptColor=e}),r(0,n,"maxChars",function(){return this._tf.maxChars},function(e){this._tf.maxChars=e}),r(0,n,"focus",function(){return this._tf.focus},function(e){this._tf.focus=e}),r(0,n,"type",function(){return this._tf.type},function(e){this._tf.type=e}),r(0,n,"asPassword",function(){return this._tf.asPassword},function(e){this._tf.asPassword=e}),t}(H),ne=function(e){function t(){t.__super.call(this)}return a(t,"laya.ui.VSlider",U),t}(),ae=function(e){function t(){this.popupCenter=!0,this.closeHandler=null,this.popupEffect=null,this.closeEffect=null,this.group=null,this.isModal=!1,this._dragArea=null,t.__super.call(this)}a(t,"laya.ui.Dialog",e);var n=t.prototype;return n.initialize=function(){this.popupEffect=t.manager.popupEffectHandler,this.closeEffect=t.manager.closeEffectHandler,this._dealDragArea(),this.on("click",this,this._onClick)},n._dealDragArea=function(){var e=this.getChildByName("drag");e&&(this.dragArea=e.x+","+e.y+","+e.width+","+e.height,e.removeSelf())},n._onClick=function(e){var t=e.target;if(t)switch(t.name){case"close":case"cancel":case"sure":case"no":case"ok":case"yes":this.close(t.name)}},n.show=function(e,t){void 0===e&&(e=!1),void 0===t&&(t=!0),this._open(!1,e,t)},n.popup=function(e,t){void 0===e&&(e=!1),void 0===t&&(t=!0),this._open(!0,e,t)},n._open=function(e,i,n){t.manager.lock(!1),this.isModal=e,t.manager.open(this,i,n)},n.onOpened=function(){},n.close=function(e,i){void 0===i&&(i=!0),t.manager.close(this,e,i)},n.onClosed=function(e){},n._onMouseDown=function(e){var t=this.getMousePoint();this._dragArea.contains(t.x,t.y)?this.startDrag():this.stopDrag()},r(0,n,"dragArea",function(){return this._dragArea?this._dragArea.toString():null},function(e){if(e){var t=E.fillArray([0,0,0,0],e,Number);this._dragArea=new y(t[0],t[1],t[2],t[3]),this.on("mousedown",this,this._onMouseDown)}else this._dragArea=null,this.off("mousedown",this,this._onMouseDown)}),r(0,n,"isPopup",function(){return null!=this.parent}),r(0,n,"zOrder",e.prototype._$get_zOrder,function(e){i.superSet(X,this,"zOrder",e),t.manager._checkMask()}),r(1,t,"manager",function(){return t._manager=t._manager||new N},function(e){t._manager=e}),t.setLockView=function(e){t.manager.setLockView(e)},t.lock=function(e){t.manager.lock(e)},t.closeAll=function(){t.manager.closeAll()},t.getDialogsByGroup=function(e){return t.manager.getDialogsByGroup(e)},t.closeByGroup=function(e){return t.manager.closeByGroup(e)},t.CLOSE="close",t.CANCEL="cancel",t.SURE="sure",t.NO="no",t.OK="ok",t.YES="yes",t._manager=null,t}(X),re=function(e){function t(){t.__super.call(this)}a(t,"laya.ui.HBox",e);var n=t.prototype;return n.sortItem=function(e){e&&e.sort(function(e,t){return e.x-t.x})},n.changeItems=function(){this._itemChanged=!1;for(var e=[],t=0,i=0,n=this.numChildren;i<n;i++){var a=this.getChildAt(i);a&&a.layoutEnabled&&(e.push(a),t=this._height?this._height:Math.max(t,a.height*a.scaleY))}this.sortItem(e);var r=0;for(i=0,n=e.length;i<n;i++)(a=e[i]).x=r,r+=a.width*a.scaleX+this._space,"top"==this._align?a.y=0:"middle"==this._align?a.y=.5*(t-a.height*a.scaleY):"bottom"==this._align&&(a.y=t-a.height*a.scaleY);this.changeSize()},r(0,n,"height",e.prototype._$get_height,function(e){this._height!=e&&(i.superSet(G,this,"height",e),this.callLater(this.changeItems))}),t.NONE="none",t.TOP="top",t.MIDDLE="middle",t.BOTTOM="bottom",t}(G),oe=function(e){function t(){t.__super.call(this)}a(t,"laya.ui.VBox",e);var n=t.prototype;return n.changeItems=function(){this._itemChanged=!1;for(var e=[],t=0,i=0,n=this.numChildren;i<n;i++){var a=this.getChildAt(i);a&&a.layoutEnabled&&(e.push(a),t=this._width?this._width:Math.max(t,a.width*a.scaleX))}this.sortItem(e);var r=0;for(i=0,n=e.length;i<n;i++)(a=e[i]).y=r,r+=a.height*a.scaleY+this._space,"left"==this._align?a.x=0:"center"==this._align?a.x=.5*(t-a.width*a.scaleX):"right"==this._align&&(a.x=t-a.width*a.scaleX);this.changeSize()},r(0,n,"width",e.prototype._$get_width,function(e){this._width!=e&&(i.superSet(G,this,"width",e),this.callLater(this.changeItems))}),t.NONE="none",t.LEFT="left",t.CENTER="center",t.RIGHT="right",t}(G),se=function(e){function t(){t.__super.call(this)}a(t,"laya.ui.RadioGroup",Z);return t.prototype.createItem=function(e,t){return new Q(e,t)},t}(),he=function(e){function t(){t.__super.call(this)}a(t,"laya.ui.Tab",Z);return t.prototype.createItem=function(e,t){return new R(e,t)},t}(),le=function(e){function t(e){this._vScrollBar=null,this._hScrollBar=null,void 0===e&&(e=""),t.__super.call(this,e)}a(t,"laya.ui.TextArea",e);var n=t.prototype;return n.destroy=function(t){void 0===t&&(t=!0),e.prototype.destroy.call(this,t),this._vScrollBar&&this._vScrollBar.destroy(),this._hScrollBar&&this._hScrollBar.destroy(),this._vScrollBar=null,this._hScrollBar=null},n.initialize=function(){this.width=180,this.height=150,this._tf.wordWrap=!0,this.multiline=!0},n.onVBarChanged=function(e){this._tf.scrollY!=this._vScrollBar.value&&(this._tf.scrollY=this._vScrollBar.value)},n.onHBarChanged=function(e){this._tf.scrollX!=this._hScrollBar.value&&(this._tf.scrollX=this._hScrollBar.value)},n.changeScroll=function(){var e=this._vScrollBar&&this._tf.maxScrollY>0,t=this._hScrollBar&&this._tf.maxScrollX>0,i=e?this._width-this._vScrollBar.width:this._width,n=t?this._height-this._hScrollBar.height:this._height,a=this._tf.padding||k.labelPadding;this._tf.width=i,this._tf.height=n,this._vScrollBar&&(this._vScrollBar.x=this._width-this._vScrollBar.width-a[2],this._vScrollBar.y=a[1],this._vScrollBar.height=this._height-(t?this._hScrollBar.height:0)-a[1]-a[3],this._vScrollBar.scrollSize=1,this._vScrollBar.thumbPercent=n/Math.max(this._tf.textHeight,n),this._vScrollBar.setScroll(1,this._tf.maxScrollY,this._tf.scrollY),this._vScrollBar.visible=e),this._hScrollBar&&(this._hScrollBar.x=a[0],this._hScrollBar.y=this._height-this._hScrollBar.height-a[3],this._hScrollBar.width=this._width-(e?this._vScrollBar.width:0)-a[0]-a[2],this._hScrollBar.scrollSize=Math.max(.033*i,1),this._hScrollBar.thumbPercent=i/Math.max(this._tf.textWidth,i),this._hScrollBar.setScroll(0,this.maxScrollX,this.scrollX),this._hScrollBar.visible=t)},n.scrollTo=function(e){this.commitMeasure(),this._tf.scrollY=e},r(0,n,"scrollY",function(){return this._tf.scrollY}),r(0,n,"width",e.prototype._$get_width,function(e){i.superSet(ie,this,"width",e),this.callLater(this.changeScroll)}),r(0,n,"hScrollBar",function(){return this._hScrollBar}),r(0,n,"height",e.prototype._$get_height,function(e){i.superSet(ie,this,"height",e),this.callLater(this.changeScroll)}),r(0,n,"maxScrollX",function(){return this._tf.maxScrollX}),r(0,n,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(e){null==this._vScrollBar&&(this.addChild(this._vScrollBar=new te),this._vScrollBar.on("change",this,this.onVBarChanged),this._vScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._vScrollBar.skin=e}),r(0,n,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(e){null==this._hScrollBar&&(this.addChild(this._hScrollBar=new q),this._hScrollBar.on("change",this,this.onHBarChanged),this._hScrollBar.mouseWheelEnable=!1,this._hScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._hScrollBar.skin=e}),r(0,n,"vScrollBar",function(){return this._vScrollBar}),r(0,n,"maxScrollY",function(){return this._tf.maxScrollY}),r(0,n,"scrollX",function(){return this._tf.scrollX}),t}(ie);!function(e){function t(){this._uiView=null,this.isCloseOther=!1,t.__super.call(this)}a(t,"laya.ui.AsynDialog",ae);var i=t.prototype;i.createView=function(e){this._uiView=e},i._open=function(e,t,i){this.isModal=e,this.isCloseOther=t,ae.manager.lock(!0),this._uiView?this.onCreated():this.onOpen()},i.onCreated=function(){this.createUI(),this.onOpen()},i.createUI=function(){laya.ui.View.prototype.createView.call(this,this._uiView),this._uiView=null,this._dealDragArea()},i.onOpen=function(){ae.manager.open(this,this.isCloseOther),ae.manager.lock(!1)},i.close=function(e,t){void 0===t&&(t=!0),ae.manager.close(this),this.onClose()},i.onClose=function(){},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e),this._uiView=null,this.onDestroy()},i.onDestroy=function(){}}();i.__init([X])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});for(var i in Laya){var n=Laya[i];n&&n.__isclass&&(t[i]=n)}}),function(e,t,i){i.un,i.uns;var n=i.static,a=i.class,r=i.getset,o=i.__newvec,s=(laya.ani.AnimationContent,laya.ani.AnimationPlayer),h=(laya.ani.AnimationState,laya.ani.AnimationTemplet),l=laya.maths.Arith,c=laya.webgl.atlas.AtlasResourceManager,p=laya.webgl.shader.BaseShader,u=laya.utils.Browser,d=laya.webgl.utils.Buffer,_=laya.utils.Byte,m=(laya.ani.bone.canvasmesh.CacheAbleSkinMesh,laya.utils.ClassUtils),f=i.Config,g=(laya.events.Event,laya.events.EventDispatcher),y=laya.utils.Handler,v=laya.net.Loader,x=laya.net.LoaderManager,b=laya.maths.MathUtil,w=laya.display.Node,S=laya.renders.Render,I=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.webgl.utils.RenderState2D),M=laya.resource.Resource,C=laya.utils.RunDriver,k=(laya.webgl.shader.Shader,laya.webgl.utils.ShaderCompile),E=laya.display.Sprite,T=laya.utils.Stat,L=laya.utils.StringKey,D=(laya.display.css.Style,laya.resource.Texture,laya.net.URL),N=laya.utils.Utils,A=laya.webgl.WebGL,R=laya.webgl.WebGLContext;laya.webgl.canvas.WebGLContext2D;i.interface("laya.d3.core.IClone"),i.interface("laya.d3.graphics.IVertex"),i.interface("laya.d3.core.render.IUpdate"),i.interface("laya.d3.core.scene.ITreeNode"),i.interface("laya.d3.core.render.IRenderable");var B=function(){function e(){}return a(e,"laya.d3.animation.AnimationClipParser01"),e.READ_DATA=function(){e._DATA.offset=e._reader.getUint32(),e._DATA.size=e._reader.getUint32()},e.READ_BLOCK=function(){for(var t=e._BLOCK.count=e._reader.getUint16(),i=e._BLOCK.blockStarts=[],n=e._BLOCK.blockLengths=[],a=0;a<t;a++)i.push(e._reader.getUint32()),n.push(e._reader.getUint32())},e.READ_STRINGS=function(){var t=e._reader.getUint32(),i=e._reader.getUint16(),n=e._reader.pos;e._reader.pos=t+e._DATA.offset;for(var a=0;a<i;a++)e._strings[a]=e._reader.readUTFString();e._reader.pos=n},e.parse=function(t,i){e._animationClip=t,e._reader=i;i.__getBuffer();e.READ_DATA(),e.READ_BLOCK(),e.READ_STRINGS();for(var n=0,a=e._BLOCK.count;n<a;n++){var r=i.getUint16(),o=e._strings[r],s=e["READ_"+o];if(null==s)throw new Error("model file err,no this function:"+r+" "+o);s.call()}},e.READ_ANIMATIONS=function(){var t,i=0,n=0,a=e._reader,r=a.__getBuffer(),o=[],s=a.getUint8();for(o.length=s,i=0;i<s;i++)o[i]=a.getUint16();var h=[],l=a.getUint16();for(h.length=l,i=0;i<l;i++)h[i]=a.getFloat32();var c=e._animationClip;c.name=e._strings[a.getUint16()];var p=c._duration=a.getFloat32();c.islooping=!!a.getByte(),c._frameRate=a.getInt16();var u=a.getInt16(),d=c._nodes=new Array;d.length=u;(c._publicClipDatas=[]).length=u;var _=c._nodesMap={},m=0,f=0;for(i=0;i<u;i++){t=d[i]=new F;var g=a.getUint16(),y=t.path=[];for(y.length=g,n=0;n<g;n++)y[n]=e._strings[a.getUint16()];var v=y.join("/"),x=_[v];x||(_[v]=x=[]),x.push(t);var b=a.getInt16();-1!==b&&(t.componentType=e._strings[b]);var w=V._propertyIndexDic[e._strings[a.getUint16()]];if(null==w)throw new Error("AnimationClipParser01:unknown property name.");var S=w<4,I=!S||S&&""===y[0];t._cacheProperty=I,I?m++:f++,t.propertyNameID=w;var M=o[a.getUint8()];t.keyFrameWidth=M/4;var C=t.keyFrames=[],k=C.length=a.getUint16(),E=null,T=NaN;for(n=0;n<k;n++){var L=C[n]=new U;T=L.startTime=h[a.getUint16()];var D=a.pos;L.inTangent=new Float32Array(r.slice(D,D+M)),a.pos+=M,D=a.pos,L.outTangent=new Float32Array(r.slice(D,D+M)),a.pos+=M,D=a.pos,L.data=new Float32Array(r.slice(D,D+M)),a.pos+=M,E&&(E.next=L,E.duration=T-E.startTime),E=L}L.next=null,L.duration=p-T}var N=c._nodeToCachePropertyMap=new Int32Array(u),A=c._cachePropertyMap=new Int32Array(m),R=c._unCachePropertyMap=new Int32Array(f);for(m=f=0,i=0;i<u;i++)(t=d[i])._cacheProperty?(N[i]=m,A[m++]=i):R[f++]=i},e._animationClip=null,e._reader=null,e._strings=[],n(e,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),e}(),P=function(){function e(){}return a(e,"laya.d3.animation.AnimationClipParser02"),e.READ_DATA=function(){e._DATA.offset=e._reader.getUint32(),e._DATA.size=e._reader.getUint32()},e.READ_BLOCK=function(){for(var t=e._BLOCK.count=e._reader.getUint16(),i=e._BLOCK.blockStarts=[],n=e._BLOCK.blockLengths=[],a=0;a<t;a++)i.push(e._reader.getUint32()),n.push(e._reader.getUint32())},e.READ_STRINGS=function(){var t=e._reader.getUint32(),i=e._reader.getUint16(),n=e._reader.pos;e._reader.pos=t+e._DATA.offset;for(var a=0;a<i;a++)e._strings[a]=e._reader.readUTFString();e._reader.pos=n},e.parse=function(t,i){e._animationClip=t,e._reader=i;i.__getBuffer();e.READ_DATA(),e.READ_BLOCK(),e.READ_STRINGS();for(var n=0,a=e._BLOCK.count;n<a;n++){var r=i.getUint16(),o=e._strings[r],s=e["READ_"+o];if(null==s)throw new Error("model file err,no this function:"+r+" "+o);s.call()}},e.READ_ANIMATIONS=function(){var t,i=0,n=0,a=e._reader,r=a.__getBuffer(),o=[],s=a.getUint8();for(o.length=s,i=0;i<s;i++)o[i]=a.getUint16();var h=[],l=a.getUint16();for(h.length=l,i=0;i<l;i++)h[i]=a.getFloat32();var c=e._animationClip;c.name=e._strings[a.getUint16()];var p=c._duration=a.getFloat32();c.islooping=!!a.getByte(),c._frameRate=a.getInt16();var u=a.getInt16(),d=c._nodes=new Array;d.length=u;(c._publicClipDatas=[]).length=u;var _=c._nodesMap={},m=0,f=0;for(i=0;i<u;i++){t=d[i]=new F;var g=a.getUint16(),y=t.path=[];for(y.length=g,n=0;n<g;n++)y[n]=e._strings[a.getUint16()];var v=y.join("/"),x=_[v];x||(_[v]=x=[]),x.push(t);var b=a.getInt16();-1!==b&&(t.componentType=e._strings[b]);var w=V._propertyIndexDic[e._strings[a.getUint16()]];if(null==w)throw new Error("AnimationClipParser02:unknown property name.");var S=w<4,I=!S||S&&""===y[0];t._cacheProperty=I,I?m++:f++,t.propertyNameID=w;var M=o[a.getUint8()];t.keyFrameWidth=M/4;var C=t.keyFrames=[],k=C.length=a.getUint16(),E=null,T=NaN;for(n=0;n<k;n++){var L=C[n]=new U;T=L.startTime=h[a.getUint16()];var D=a.pos;L.inTangent=new Float32Array(r.slice(D,D+M)),a.pos+=M,D=a.pos,L.outTangent=new Float32Array(r.slice(D,D+M)),a.pos+=M,D=a.pos,L.data=new Float32Array(r.slice(D,D+M)),a.pos+=M,E&&(E.next=L,E.duration=T-E.startTime),E=L}L.next=null,L.duration=p-T}var N=a.getUint16();for(i=0;i<N;i++){var A=new O;A.time=a.getFloat32(),A.eventName=e._strings[a.getUint16()];var R,B=a.getUint16();for(B>0&&(A.params=R=[]),n=0;n<B;n++){switch(a.getByte()){case 0:R.push(!!a.getByte());break;case 1:R.push(a.getInt32());break;case 2:R.push(a.getFloat32());break;case 3:R.push(e._strings[a.getUint16()]);break;default:throw new Error("unknown type.")}}c.addEvent(A)}var P=c._nodeToCachePropertyMap=new Int32Array(u),H=c._cachePropertyMap=new Int32Array(m),z=c._unCachePropertyMap=new Int32Array(f);for(m=f=0,i=0;i<u;i++)(t=d[i])._cacheProperty?(P[i]=m,H[m++]=i):z[f++]=i},e._animationClip=null,e._reader=null,e._strings=[],n(e,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),e}(),O=function(){function e(){this.time=NaN,this.eventName=null,this.params=null}return a(e,"laya.d3.animation.AnimationEvent"),e}(),V=function(){function e(){this._childs=[],this.transform=new Qt(this)}a(e,"laya.d3.animation.AnimationNode");var t=e.prototype;return i.imps(t,{"laya.d3.core.IClone":!0}),t.addChild=function(e){e._parent=this,e.transform.setParent(this.transform),this._childs.push(e)},t.removeChild=function(e){var t=this._childs.indexOf(e);-1!==t&&this._childs.splice(t,1)},t.getChildByName=function(e){for(var t=0,i=this._childs.length;t<i;t++){var n=this._childs[t];if(n.name===e)return n}return null},t.getChildByIndex=function(e){return this._childs[e]},t.getChildCount=function(){return this._childs.length},t.cloneTo=function(e){var t=e;t.name=this.name;for(var i=0,n=this._childs.length;i<n;i++){var a=this._childs[i],r=a.clone();t.addChild(r);var o=a.transform,s=r.transform;s.setLocalPosition(o.getLocalPosition()),s.setLocalRotation(o.getLocalRotation()),s.setLocalScale(o.getLocalScale()),s._localRotationEuler=o._localRotationEuler,s._setWorldMatrixIgnoreUpdate(o.getWorldMatrix())}},t.clone=function(){var e=new this.constructor;return this.cloneTo(e),e},e.__init__=function(){e.registerAnimationNodeProperty("localPosition",e._getLocalPosition,e._setLocalPosition),e.registerAnimationNodeProperty("localRotation",e._getLocalRotation,e._setLocalRotation),e.registerAnimationNodeProperty("localScale",e._getLocalScale,e._setLocalScale),e.registerAnimationNodeProperty("localRotationEuler",e._getLocalRotationEuler,e._setLocalRotationEuler),e.registerAnimationNodeProperty("particleRender.sharedMaterial.tintColor",e._getParticleRenderSharedMaterialTintColor,e._setParticleRenderSharedMaterialTintColor),e.registerAnimationNodeProperty("meshRender.sharedMaterial.tilingOffset",e._getMeshRenderSharedMaterialTilingOffset,e._setMeshRenderSharedMaterialTilingOffset),e.registerAnimationNodeProperty("meshRender.sharedMaterial.albedoColor",e._getMeshRenderSharedMaterialAlbedo,e._setMeshRenderSharedMaterialAlbedo),e.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.tilingOffset",e._getSkinnedMeshRenderSharedMaterialTilingOffset,e._setSkinnedMeshRenderSharedMaterialTilingOffset),e.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedoColor",e._getSkinnedMeshRenderSharedMaterialAlbedo,e._setSkinnedMeshRenderSharedMaterialAlbedo),e.registerAnimationNodeProperty("meshRender.sharedMaterial.albedo",e._getMeshRenderSharedMaterialAlbedo,e._setMeshRenderSharedMaterialAlbedo),e.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedo",e._getSkinnedMeshRenderSharedMaterialAlbedo,e._setSkinnedMeshRenderSharedMaterialAlbedo),e.registerAnimationNodeProperty("meshRender.sharedMaterial.intensity",e._getMeshRenderSharedMaterialIntensity,e._setMeshRenderSharedMaterialIntensity),e.registerAnimationNodeProperty("meshRender.sharedMaterial.alpha",e._getMeshRenderSharedMaterialAlpha,e._setMeshRenderSharedMaterialAlpha),e.registerAnimationNodeProperty("meshRender.sharedMaterial.alphaColor",e._getMeshRenderSharedMaterialAlphaColor,e._setMeshRenderSharedMaterialAlphaColor),e.registerAnimationNodeProperty("meshRender.sharedMaterial.baseColor",e._getMeshRenderSharedMaterialBaseColor,e._setMeshRenderSharedMaterialBaseColor),e.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolve",e._getMeshRenderSharedMaterialDissolve,e._setMeshRenderSharedMaterialDissolve),e.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveSpeed",e._getMeshRenderSharedMaterialDissolveSpeed,e._setMeshRenderSharedMaterialDissolveSpeed),e.registerAnimationNodeProperty("meshRender.sharedMaterial.mMultiplier",e._getMeshRenderSharedMaterialMMultiplier,e._setMeshRenderSharedMaterialMMultiplier),e.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedX",e._getMeshRenderSharedMaterialBaseScrollSpeedX,e._setMeshRenderSharedMaterialBaseScrollSpeedX),e.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedY",e._getMeshRenderSharedMaterialBaseScrollSpeedY,e._setMeshRenderSharedMaterialBaseScrollSpeedY),e.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedX",e._getMeshRenderSharedMaterialSecondScrollSpeedX,e._setMeshRenderSharedMaterialSecondScrollSpeedX),e.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedY",e._getMeshRenderSharedMaterialSecondScrollSpeedY,e._setMeshRenderSharedMaterialSecondScrollSpeedY),e.registerAnimationNodeProperty("meshRender.sharedMaterial.detailTilingOffset",e._getMeshRenderSharedMaterialDetailTilingOffset,e._setMeshRenderSharedMaterialDetailTilingOffset),e.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveTilingOffset",e._getMeshRenderSharedMaterialDissolveTilingOffset,e._setMeshRenderSharedMaterialDissolveTilingOffset),e.registerAnimationNodeProperty("meshRender.sharedMaterial.maskTilingOffset",e._getMeshRenderSharedMaterialMaskTilingOffset,e._setMeshRenderSharedMaterialMaskTilingOffset)},e.registerAnimationNodeProperty=function(t,i,n){if(e._propertyIndexDic[t])throw new Error("AnimationNode: this propertyName has registered.");e._propertyIndexDic[t]=e._propertyIDCounter,e._propertyGetFuncs[e._propertyIDCounter]=i,e._propertySetFuncs[e._propertyIDCounter]=n,e._propertyIDCounter++},e._getLocalPosition=function(e,t){return e?e.transform.getLocalPosition():t._transform.localPosition.elements},e._setLocalPosition=function(e,t,i){if(e)e.transform.setLocalPosition(i);else{var n=t._transform,a=n.localPosition;a.elements=i,n.localPosition=a}},e._getLocalRotation=function(e,t){return e?e.transform.getLocalRotation():t._transform.localRotation.elements},e._setLocalRotation=function(e,t,i){if(e)e.transform.setLocalRotation(i);else{var n=t._transform,a=n.localRotation;a.elements=i,n.localRotation=a}},e._getLocalScale=function(e,t){return e?e.transform.getLocalScale():t._transform.localScale.elements},e._setLocalScale=function(e,t,i){if(e)e.transform.setLocalScale(i);else{var n=t._transform,a=n.localScale;a.elements=i,n.localScale=a}},e._getLocalRotationEuler=function(e,t){return e?e.transform.getLocalRotationEuler():t._transform.localRotationEuler.elements},e._setLocalRotationEuler=function(e,t,i){if(e)e.transform.setLocalRotationEuler(i);else{var n=t._transform,a=n.localRotationEuler;a.elements=i,n.localRotationEuler=a}},e._getMeshRenderSharedMaterialTilingOffset=function(e,t){if(e){var i=e.transform._entity;return i?i.owner.meshRender.sharedMaterial.tilingOffset.elements:null}return t.meshRender.sharedMaterial.tilingOffset.elements},e._setMeshRenderSharedMaterialTilingOffset=function(e,t,i){var n,a;if(e){var r=e.transform._entity;r&&((a=(n=r.owner.meshRender.material).tilingOffset).elements=i,n.tilingOffset=a)}else(a=(n=t.meshRender.material).tilingOffset).elements=i,n.tilingOffset=a},e._getMeshRenderSharedMaterialAlbedo=function(e,t){if(e){var i=e.transform._entity;return i?i.owner.meshRender.sharedMaterial.albedoColor.elements:null}return t.meshRender.sharedMaterial.albedoColor.elements},e._setMeshRenderSharedMaterialAlbedo=function(e,t,i){var n,a;if(e){var r=e.transform._entity;r&&((a=(n=r.owner.meshRender.material).albedoColor).elements=i,n.albedoColor=a)}else(a=(n=t.meshRender.material).albedoColor).elements=i,n.albedoColor=a},e._getSkinnedMeshRenderSharedMaterialTilingOffset=function(e,t){if(e){var i=e.transform._entity;return i?i.owner.skinnedMeshRender.sharedMaterial.tilingOffset.elements:null}return t.skinnedMeshRender.sharedMaterial.tilingOffset.elements},e._setSkinnedMeshRenderSharedMaterialTilingOffset=function(e,t,i){var n,a;if(e){var r=e.transform._entity;r&&((a=(n=r.owner.skinnedMeshRender.material).tilingOffset).elements=i,n.tilingOffset=a)}else(a=(n=t.skinnedMeshRender.material).tilingOffset).elements=i,n.tilingOffset=a},e._getSkinnedMeshRenderSharedMaterialAlbedo=function(e,t){if(e){var i=e.transform._entity;return i?i.owner.skinnedMeshRender.sharedMaterial.albedoColor.elements:null}return t.skinnedMeshRender.sharedMaterial.albedoColor.elements},e._setSkinnedMeshRenderSharedMaterialAlbedo=function(e,t,i){var n,a;if(e){var r=e.transform._entity;r&&((a=(n=r.owner.skinnedMeshRender.material).albedoColor).elements=i,n.albedoColor=a)}else(a=(n=t.skinnedMeshRender.material).albedoColor).elements=i,n.albedoColor=a},e._getParticleRenderSharedMaterialTintColor=function(e,t){if(e){var i=e.transform._entity;return i?i.owner.particleRender.sharedMaterial.tintColor.elements:null}return t.particleRender.sharedMaterial.tintColor.elements},e._setParticleRenderSharedMaterialTintColor=function(e,t,i){var n,a;if(e){var r=e.transform._entity;r&&((a=(n=r.owner.particleRender.material).tintColor).elements=i,n.tintColor=a)}else(a=(n=t.particleRender.material).tintColor).elements=i,n.tintColor=a},e._getMeshRenderSharedMaterialAlphaColor=function(e,t){if(e){var i=e.transform._entity;return i?i.owner.meshRender.sharedMaterial.alphaColor.elements:null}return t.meshRender.sharedMaterial.alphaColor.elements},e._setMeshRenderSharedMaterialAlphaColor=function(e,t,i){var n,a;if(e){var r=e.transform._entity;r&&((a=(n=r.owner.meshRender.material).alphaColor).elements=i,n.alphaColor=a)}else(a=(n=t.meshRender.material).alphaColor).elements=i,n.alphaColor=a},e._getMeshRenderSharedMaterialBaseColor=function(e,t){if(e){var i=e.transform._entity;return i?i.owner.meshRender.sharedMaterial.baseColor.elements:null}return t.meshRender.sharedMaterial.baseColor.elements},e._setMeshRenderSharedMaterialBaseColor=function(e,t,i){var n,a;if(e){var r=e.transform._entity;r&&((a=(n=r.owner.meshRender.material).baseColor).elements=i,n.baseColor=a)}else(a=(n=t.meshRender.material).baseColor).elements=i,n.baseColor=a},e._getMeshRenderSharedMaterialDissolve=function(e,t){if(e){var i=e.transform._entity;return i?i.owner.meshRender.sharedMaterial.dissolve:0}return t.meshRender.sharedMaterial.dissolve},e._setMeshRenderSharedMaterialDissolve=function(e,t,i){if(e){var n=e.transform._entity;n&&(n.owner.meshRender.material.dissolve=i[0])}else t.meshRender.material.dissolve=i[0]},e._getMeshRenderSharedMaterialDissolveSpeed=function(e,t){if(e){var i=e.transform._entity;return i?i.owner.meshRender.sharedMaterial.dissolveSpeed:0}return t.meshRender.sharedMaterial.dissolveSpeed},e._setMeshRenderSharedMaterialDissolveSpeed=function(e,t,i){if(e){var n=e.transform._entity;n&&(n.owner.meshRender.material.dissolveSpeed=i[0])}else t.meshRender.material.dissolveSpeed=i[0]},e._getMeshRenderSharedMaterialMMultiplier=function(e,t){if(e){var i=e.transform._entity;return i?i.owner.meshRender.sharedMaterial.mMultiplier:0}return t.meshRender.sharedMaterial.mMultiplier},e._setMeshRenderSharedMaterialMMultiplier=function(e,t,i){if(e){var n=e.transform._entity;n&&(n.owner.meshRender.material.mMultiplier=i[0])}else t.meshRender.material.mMultiplier=i[0]},e._getMeshRenderSharedMaterialBaseScrollSpeedX=function(e,t){if(e){var i=e.transform._entity;return i?i.owner.meshRender.sharedMaterial.baseScrollSpeedX:0}return t.meshRender.sharedMaterial.baseScrollSpeedX},e._setMeshRenderSharedMaterialBaseScrollSpeedX=function(e,t,i){if(e){var n=e.transform._entity;n&&(n.owner.meshRender.material.baseScrollSpeedX=i[0])}else t.meshRender.material.baseScrollSpeedX=i[0]},e._getMeshRenderSharedMaterialBaseScrollSpeedY=function(e,t){if(e){var i=e.transform._entity;return i?i.owner.meshRender.sharedMaterial.baseScrollSpeedY:0}return t.meshRender.sharedMaterial.baseScrollSpeedY},e._setMeshRenderSharedMaterialBaseScrollSpeedY=function(e,t,i){if(e){var n=e.transform._entity;n&&(n.owner.meshRender.material.baseScrollSpeedY=i[0])}else t.meshRender.material.baseScrollSpeedY=i[0]},e._getMeshRenderSharedMaterialSecondScrollSpeedX=function(e,t){if(e){var i=e.transform._entity;return i?i.owner.meshRender.sharedMaterial.secondScrollSpeedX:0}return t.meshRender.sharedMaterial.secondScrollSpeedX},e._setMeshRenderSharedMaterialSecondScrollSpeedX=function(e,t,i){if(e){var n=e.transform._entity;n&&(n.owner.meshRender.material.secondScrollSpeedX=i[0])}else t.meshRender.material.secondScrollSpeedX=i[0]},e._getMeshRenderSharedMaterialSecondScrollSpeedY=function(e,t){if(e){var i=e.transform._entity;return i?i.owner.meshRender.sharedMaterial.secondScrollSpeedY:0}return t.meshRender.sharedMaterial.secondScrollSpeedY},e._setMeshRenderSharedMaterialSecondScrollSpeedY=function(e,t,i){if(e){var n=e.transform._entity;n&&(n.owner.meshRender.material.secondScrollSpeedY=i[0])}else t.meshRender.material.secondScrollSpeedY=i[0]},e._getMeshRenderSharedMaterialAlpha=function(e,t){if(e){var i=e.transform._entity;return i?i.owner.meshRender.sharedMaterial.alpha:0}return t.meshRender.sharedMaterial.alpha},e._setMeshRenderSharedMaterialAlpha=function(e,t,i){if(e){var n=e.transform._entity;n&&(n.owner.meshRender.material.alpha=i[0])}else t.meshRender.material.alpha=i[0]},e._getMeshRenderSharedMaterialIntensity=function(e,t){if(e){var i=e.transform._entity;return i?i.owner.meshRender.sharedMaterial.intensity:0}return t.meshRender.sharedMaterial.intensity},e._setMeshRenderSharedMaterialIntensity=function(e,t,i){if(e){var n=e.transform._entity;n&&(n.owner.meshRender.material.intensity=i[0])}else t.meshRender.material.intensity=i[0]},e._getMeshRenderSharedMaterialDetailTilingOffset=function(e,t){if(e){var i=e.transform._entity;return i?i.owner.meshRender.sharedMaterial.detailTilingOffset.elements:null}return t.meshRender.sharedMaterial.detailTilingOffset.elements},e._setMeshRenderSharedMaterialDetailTilingOffset=function(e,t,i){var n,a;if(e){var r=e.transform._entity;r&&((a=(n=r.owner.meshRender.material).detailTilingOffset).elements=i,n.detailTilingOffset=a)}else(a=(n=t.meshRender.material).detailTilingOffset).elements=i,n.detailTilingOffset=a},e._getMeshRenderSharedMaterialDissolveTilingOffset=function(e,t){if(e){var i=e.transform._entity;return i?i.owner.meshRender.sharedMaterial.dissolveTilingOffset.elements:null}return t.meshRender.sharedMaterial.dissolveTilingOffset.elements},e._setMeshRenderSharedMaterialDissolveTilingOffset=function(e,t,i){var n,a;if(e){var r=e.transform._entity;r&&((a=(n=r.owner.meshRender.material).dissolveTilingOffset).elements=i,n.dissolveTilingOffset=a)}else(a=(n=t.meshRender.material).dissolveTilingOffset).elements=i,n.dissolveTilingOffset=a},e._getMeshRenderSharedMaterialMaskTilingOffset=function(e,t){if(e){var i=e.transform._entity;return i?i.owner.meshRender.sharedMaterial.maskTilingOffset.elements:null}return t.meshRender.sharedMaterial.maskTilingOffset.elements},e._setMeshRenderSharedMaterialMaskTilingOffset=function(e,t,i){var n,a;if(e){var r=e.transform._entity;r&&((a=(n=r.owner.meshRender.material).maskTilingOffset).elements=i,n.maskTilingOffset=a)}else(a=(n=t.meshRender.material).maskTilingOffset).elements=i,n.maskTilingOffset=a},e._propertyIDCounter=0,e._propertyIndexDic={},e._propertySetFuncs=[],e._propertyGetFuncs=[],e}(),U=function(){function e(){this.startTime=NaN,this.inTangent=null,this.outTangent=null,this.data=null,this.duration=NaN,this.next=null}return a(e,"laya.d3.animation.Keyframe"),e}(),F=function(){function e(){this._cacheProperty=!1,this.path=null,this.componentType=null,this.propertyNameID=0,this.keyFrameWidth=0,this.defaultData=null,this.keyFrames=null}return a(e,"laya.d3.animation.KeyframeNode"),e}(),H=function(){function e(){this._tempVector30=new At,this._tempVector31=new At,this._tempVector32=new At,this._a=new At,this._b=new At,this._c=new At,this._d=new At}a(e,"laya.d3.core.glitter.SplineCurvePositionVelocity");var t=e.prototype;return t.Init=function(e,t,i,n){e.cloneTo(this._d),t.cloneTo(this._c),At.scale(e,2,this._a),At.scale(i,2,this._tempVector30),At.subtract(this._a,this._tempVector30,this._a),At.add(this._a,t,this._a),At.add(this._a,n,this._a),At.scale(i,3,this._b),At.scale(e,3,this._tempVector30),At.subtract(this._b,this._tempVector30,this._b),At.subtract(this._b,n,this._b),At.scale(t,2,this._tempVector30),At.subtract(this._b,this._tempVector30,this._b)},t.Slerp=function(e,t){At.scale(this._a,e*e*e,this._tempVector30),At.scale(this._b,e*e,this._tempVector31),At.scale(this._c,e,this._tempVector32),At.add(this._tempVector30,this._tempVector31,t),At.add(t,this._tempVector32,t),At.add(t,this._d,t)},e}(),z=function(){function e(e,t,i,n){this._datas=null,this._w=0,this._h=0,this._minHeight=NaN,this._maxHeight=NaN,this._datas=[],this._w=e,this._h=t,this._minHeight=i,this._maxHeight=n}a(e,"laya.d3.core.HeightMap");var t=e.prototype;return t._inBounds=function(e,t){return e>=0&&e<this._h&&t>=0&&t<this._w},t.getHeight=function(e,t){return this._inBounds(e,t)?this._datas[e][t]:NaN},r(0,t,"width",function(){return this._w}),r(0,t,"height",function(){return this._h}),r(0,t,"maxHeight",function(){return this._maxHeight}),r(0,t,"minHeight",function(){return this._minHeight}),e.creatFromMesh=function(t,i,n,a){for(var r=[],o=[],s=t.getSubMeshCount(),h=0;h<s;h++){for(var l=t.getSubMesh(h),c=l._getVertexBuffer(),p=c.getData(),u=[],d=0;d<p.length;d+=c.vertexDeclaration.vertexStride/4){var _=new At(p[d+0],p[d+1],p[d+2]);u.push(_)}r.push(u);var m=l._getIndexBuffer();o.push(m.getData())}var f=t.boundingBox,g=f.min.x,y=f.min.z,v=f.max.x,x=f.max.z,b=f.min.y,w=f.max.y,S=v-g,I=x-y,M=a.elements[0]=S/(i-1),C=a.elements[1]=I/(n-1),k=new e(i,n,b,w),E=e._tempRay,T=E.direction.elements;T[0]=0,T[1]=-1,T[2]=0;var L=w+.1;E.origin.elements[1]=L;for(var D=0;D<n;D++){var N=y+D*C;k._datas[D]=[];for(var A=0;A<i;A++){var R=g+A*M,B=E.origin.elements;B[0]=R,B[2]=N;var P=e._getPosition(E,r,o);k._datas[D][A]=P===Number.MAX_VALUE?NaN:L-P}}return k},e.createFromImage=function(t,i,n){for(var a=t.width,r=t.height,o=new e(a,r,i,n),s=(n-i)/254,h=t.getPixels(),l=0,c=0;c<r;c++)for(var p=o._datas[c]=[],u=0;u<a;u++){var d=h[l++],_=h[l++],m=h[l++],f=h[l++];p[u]=255==d&&255==_&&255==m&&255==f?NaN:(d+_+m)/3*s+i}return o},e._getPosition=function(e,t,i){for(var n=Number.MAX_VALUE,a=0;a<t.length;a++)for(var r=t[a],o=i[a],s=0;s<o.length;s+=3){var h=r[o[s+0]],l=r[o[s+1]],c=r[o[s+2]],p=Wt.rayIntersectsTriangle(e,h,l,c);!isNaN(p)&&p<n&&(n=p)}return n},n(e,["_tempRay",function(){return this._tempRay=new Dt(new At,new At)}]),e}(),X=function(){function e(){this._visible=!0,this._nonRigidbodyOffset=0,this._colliders=[]}a(e,"laya.d3.core.Layer");var t=e.prototype;return t._binarySearchIndex=function(){for(var t=0,i=e._collsionTestList.length-1,n=0;t<=i;){n=Math.floor((t+i)/2);var a=e._collsionTestList[n];if(a==this._number)return n;a>this._number?i=n-1:t=n+1}return t},t._addCollider=function(t){0===this._colliders.length&&e._collsionTestList.splice(this._binarySearchIndex(),0,this._number),t._isRigidbody?(this._colliders.unshift(t),this._nonRigidbodyOffset++):this._colliders.push(t)},t._removeCollider=function(t){var i=this._colliders.indexOf(t);i<this._nonRigidbodyOffset&&this._nonRigidbodyOffset--,this._colliders.splice(i,1),0===this._colliders.length&&e._collsionTestList.splice(e._collsionTestList.indexOf(this._number),1)},r(0,t,"number",function(){return this._number}),r(0,t,"visible",function(){return this._visible},function(t){this._visible=t,e._visibleLayers=t?e._visibleLayers|this.mask:e._visibleLayers&~this.mask}),r(0,t,"mask",function(){return this._mask}),r(1,e,"visibleLayers",function(){return e._visibleLayers},function(t){e._visibleLayers=t;for(var i=0,n=e._layerList.length;i<n;i++){var a=e._layerList[i];a._visible=0!=(a._mask&e._visibleLayers)}}),e.__init__=function(){e._layerList.length=31;for(var t=0;t<31;t++){var i=new e;e._layerList[t]=i,0===t?(i.name="Default Layer",i.visible=!0):(i.name="Layer-"+t,i.visible=!1),i._number=t,i._mask=Math.pow(2,t)}e.currentCreationLayer=e._layerList[0]},e.getLayerByNumber=function(t){if(t<0||t>30)throw new Error("无法返回指定Layer，该number超出范围！");return e._layerList[t]},e.getLayerByName=function(t){for(var i=0;i<31;i++)if(e._layerList[i].name===t)return e._layerList[i];throw new Error("无法返回指定Layer,该name不存在")},e.isVisible=function(t){return 0!=(t&e._currentCameraCullingMask&e._visibleLayers)},e._layerList=[],e._visibleLayers=2147483647,e._collsionTestList=[],e._currentCameraCullingMask=2147483647,e.maxCount=31,e.currentCreationLayer=null,e}(),Y=function(){function e(e,t,i){this._time=NaN,this._minCount=0,this._maxCount=0,this._time=e,this._minCount=t,this._maxCount=i}a(e,"laya.d3.core.particleShuriKen.module.Burst");var t=e.prototype;return i.imps(t,{"laya.d3.core.IClone":!0}),t.cloneTo=function(e){var t=e;t._time=this._time,t._minCount=this._minCount,t._maxCount=this._maxCount},t.clone=function(){var e=new this.constructor;return this.cloneTo(e),e},r(0,t,"time",function(){return this._time}),r(0,t,"minCount",function(){return this._minCount}),r(0,t,"maxCount",function(){return this._maxCount}),e}(),G=function(){function e(e){this._color=null,this.enbale=!1,this._color=e}a(e,"laya.d3.core.particleShuriKen.module.ColorOverLifetime");var t=e.prototype;return t.cloneTo=function(e){var t=e;this._color.cloneTo(t._color),t.enbale=this.enbale},t.clone=function(){var e;switch(this._color.type){case 0:e=K.createByConstant(this._color.constant.clone());break;case 1:e=K.createByGradient(this._color.gradient.clone());break;case 2:e=K.createByRandomTwoConstant(this._color.constantMin.clone(),this._color.constantMax.clone());break;case 3:e=K.createByRandomTwoGradient(this._color.gradientMin.clone(),this._color.gradientMax.clone())}var t=new this.constructor(e);return t.enbale=this.enbale,t},r(0,t,"color",function(){return this._color}),e}(),j=function(){function e(){this._destroyed=!1,this._emissionRate=0,this._bursts=null,this.enbale=!1,this._destroyed=!1,this.emissionRate=10,this._bursts=[]}a(e,"laya.d3.core.particleShuriKen.module.Emission");var t=e.prototype;return i.imps(t,{"laya.d3.core.IClone":!0,"laya.resource.IDestroy":!0}),t._destroy=function(){this._bursts=null,this._destroyed=!0},t.getBurstsCount=function(){return this._bursts.length},t.getBurstByIndex=function(e){return this._bursts[e]},t.addBurst=function(e){var t=this._bursts.length;if(t>0)for(var i=0;i<t;i++)this._bursts[i].time>e.time&&this._bursts.splice(i,0,e);this._bursts.push(e)},t.removeBurst=function(e){var t=this._bursts.indexOf(e);-1!==t&&this._bursts.splice(t,1)},t.removeBurstByIndex=function(e){this._bursts.splice(e,1)},t.clearBurst=function(){this._bursts.length=0},t.cloneTo=function(e){var t=e,i=t._bursts;i.length=this._bursts.length;for(var n=0,a=this._bursts.length;n<a;n++){var r=i[n];r?this._bursts[n].cloneTo(r):i[n]=this._bursts[n].clone()}t._emissionRate=this._emissionRate,t.enbale=this.enbale},t.clone=function(){var e=new this.constructor;return this.cloneTo(e),e},r(0,t,"destroyed",function(){return this._destroyed}),r(0,t,"emissionRate",function(){return this._emissionRate},function(e){if(e<0)throw new Error("ParticleBaseShape:emissionRate value must large or equal than 0.");this._emissionRate=e}),e}(),W=function(){function e(){this._type=0,this._constant=0,this._overTime=null,this._constantMin=0,this._constantMax=0,this._overTimeMin=null,this._overTimeMax=null}a(e,"laya.d3.core.particleShuriKen.module.FrameOverTime");var t=e.prototype;return i.imps(t,{"laya.d3.core.IClone":!0}),t.cloneTo=function(e){var t=e;t._type=this._type,t._constant=this._constant,this._overTime.cloneTo(t._overTime),t._constantMin=this._constantMin,t._constantMax=this._constantMax,this._overTimeMin.cloneTo(t._overTimeMin),this._overTimeMax.cloneTo(t._overTimeMax)},t.clone=function(){var e=new this.constructor;return this.cloneTo(e),e},r(0,t,"frameOverTimeData",function(){return this._overTime}),r(0,t,"constant",function(){return this._constant}),r(0,t,"type",function(){return this._type}),r(0,t,"frameOverTimeDataMin",function(){return this._overTimeMin}),r(0,t,"constantMin",function(){return this._constantMin}),r(0,t,"frameOverTimeDataMax",function(){return this._overTimeMax}),r(0,t,"constantMax",function(){return this._constantMax}),e.createByConstant=function(t){var i=new e;return i._type=0,i._constant=t,i},e.createByOverTime=function(t){var i=new e;return i._type=1,i._overTime=t,i},e.createByRandomTwoConstant=function(t,i){var n=new e;return n._type=2,n._constantMin=t,n._constantMax=i,n},e.createByRandomTwoOverTime=function(t,i){var n=new e;return n._type=3,n._overTimeMin=t,n._overTimeMax=i,n},e}(),q=function(){function e(){this._type=0,this._separateAxes=!1,this._constant=NaN,this._constantSeparate=null,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._gradientW=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null,this._gradientWMin=null,this._gradientWMax=null}a(e,"laya.d3.core.particleShuriKen.module.GradientAngularVelocity");var t=e.prototype;return i.imps(t,{"laya.d3.core.IClone":!0}),t.cloneTo=function(e){var t=e;t._type=this._type,t._separateAxes=this._separateAxes,t._constant=this._constant,this._constantSeparate.cloneTo(t._constantSeparate),this._gradient.cloneTo(t._gradient),this._gradientX.cloneTo(t._gradientX),this._gradientY.cloneTo(t._gradientY),this._gradientZ.cloneTo(t._gradientZ),t._constantMin=this._constantMin,t._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(t._constantMinSeparate),this._constantMaxSeparate.cloneTo(t._constantMaxSeparate),this._gradientMin.cloneTo(t._gradientMin),this._gradientMax.cloneTo(t._gradientMax),this._gradientXMin.cloneTo(t._gradientXMin),this._gradientXMax.cloneTo(t._gradientXMax),this._gradientYMin.cloneTo(t._gradientYMin),this._gradientYMax.cloneTo(t._gradientYMax),this._gradientZMin.cloneTo(t._gradientZMin),this._gradientZMax.cloneTo(t._gradientZMax)},t.clone=function(){var e=new this.constructor;return this.cloneTo(e),e},r(0,t,"gradientZ",function(){return this._gradientZ}),r(0,t,"constant",function(){return this._constant}),r(0,t,"gradient",function(){return this._gradient}),r(0,t,"separateAxes",function(){return this._separateAxes}),r(0,t,"type",function(){return this._type}),r(0,t,"constantSeparate",function(){return this._constantSeparate}),r(0,t,"gradientX",function(){return this._gradientX}),r(0,t,"gradientY",function(){return this._gradientY}),r(0,t,"gradientW",function(){return this._gradientW}),r(0,t,"gradientMin",function(){return this._gradientMin}),r(0,t,"constantMin",function(){return this._constantMin}),r(0,t,"gradientMax",function(){return this._gradientMax}),r(0,t,"constantMax",function(){return this._constantMax}),r(0,t,"gradientWMin",function(){return this._gradientWMin}),r(0,t,"constantMinSeparate",function(){return this._constantMinSeparate}),r(0,t,"constantMaxSeparate",function(){return this._constantMaxSeparate}),r(0,t,"gradientXMin",function(){return this._gradientXMin}),r(0,t,"gradientXMax",function(){return this._gradientXMax}),r(0,t,"gradientWMax",function(){return this._gradientWMax}),r(0,t,"gradientYMin",function(){return this._gradientYMin}),r(0,t,"gradientYMax",function(){return this._gradientYMax}),r(0,t,"gradientZMin",function(){return this._gradientZMin}),r(0,t,"gradientZMax",function(){return this._gradientZMax}),e.createByConstant=function(t){var i=new e;return i._type=0,i._separateAxes=!1,i._constant=t,i},e.createByConstantSeparate=function(t){var i=new e;return i._type=0,i._separateAxes=!0,i._constantSeparate=t,i},e.createByGradient=function(t){var i=new e;return i._type=1,i._separateAxes=!1,i._gradient=t,i},e.createByGradientSeparate=function(t,i,n,a){var r=new e;return r._type=1,r._separateAxes=!0,r._gradientX=t,r._gradientY=i,r._gradientZ=n,r._gradientW=a,r},e.createByRandomTwoConstant=function(t,i){var n=new e;return n._type=2,n._separateAxes=!1,n._constantMin=t,n._constantMax=i,n},e.createByRandomTwoConstantSeparate=function(t,i){var n=new e;return n._type=2,n._separateAxes=!0,n._constantMinSeparate=t,n._constantMaxSeparate=i,n},e.createByRandomTwoGradient=function(t,i){var n=new e;return n._type=3,n._separateAxes=!1,n._gradientMin=t,n._gradientMax=i,n},e.createByRandomTwoGradientSeparate=function(t,i,n,a,r,o,s,h){var l=new e;return l._type=3,l._separateAxes=!0,l._gradientXMin=t,l._gradientXMax=i,l._gradientYMin=n,l._gradientYMax=a,l._gradientZMin=r,l._gradientZMax=o,l._gradientWMin=s,l._gradientWMax=h,l},e}(),K=function(){function e(){this._type=0,this._constant=null,this._constantMin=null,this._constantMax=null,this._gradient=null,this._gradientMin=null,this._gradientMax=null}a(e,"laya.d3.core.particleShuriKen.module.GradientColor");var t=e.prototype;return i.imps(t,{"laya.d3.core.IClone":!0}),t.cloneTo=function(e){var t=e;t._type=this._type,this._constant.cloneTo(t._constant),this._constantMin.cloneTo(t._constantMin),this._constantMax.cloneTo(t._constantMax),this._gradient.cloneTo(t._gradient),this._gradientMin.cloneTo(t._gradientMin),this._gradientMax.cloneTo(t._gradientMax)},t.clone=function(){var e=new this.constructor;return this.cloneTo(e),e},r(0,t,"gradient",function(){return this._gradient}),r(0,t,"constant",function(){return this._constant}),r(0,t,"type",function(){return this._type}),r(0,t,"gradientMin",function(){return this._gradientMin}),r(0,t,"constantMin",function(){return this._constantMin}),r(0,t,"gradientMax",function(){return this._gradientMax}),r(0,t,"constantMax",function(){return this._constantMax}),e.createByConstant=function(t){var i=new e;return i._type=0,i._constant=t,i},e.createByGradient=function(t){var i=new e;return i._type=1,i._gradient=t,i},e.createByRandomTwoConstant=function(t,i){var n=new e;return n._type=2,n._constantMin=t,n._constantMax=i,n},e.createByRandomTwoGradient=function(t,i){var n=new e;return n._type=3,n._gradientMin=t,n._gradientMax=i,n},e}(),J=function(){function e(){this._alphaCurrentLength=0,this._rgbCurrentLength=0,this._alphaElements=null,this._rgbElements=null,this._alphaElements=new Float32Array(8),this._rgbElements=new Float32Array(16)}a(e,"laya.d3.core.particleShuriKen.module.GradientDataColor");var t=e.prototype;return i.imps(t,{"laya.d3.core.IClone":!0}),t.addAlpha=function(e,t){this._alphaCurrentLength<8?(6===this._alphaCurrentLength&&1!==e&&(e=1,console.log("GradientDataColor warning:the forth key is  be force set to 1.")),this._alphaElements[this._alphaCurrentLength++]=e,this._alphaElements[this._alphaCurrentLength++]=t):console.log("GradientDataColor warning:data count must lessEqual than 4")},t.addRGB=function(e,t){this._rgbCurrentLength<16?(12===this._rgbCurrentLength&&1!==e&&(e=1,console.log("GradientDataColor warning:the forth key is  be force set to 1.")),this._rgbElements[this._rgbCurrentLength++]=e,this._rgbElements[this._rgbCurrentLength++]=t.x,this._rgbElements[this._rgbCurrentLength++]=t.y,this._rgbElements[this._rgbCurrentLength++]=t.z):console.log("GradientDataColor warning:data count must lessEqual than 4")},t.cloneTo=function(e){var t=e,i=0,n=0;t._alphaCurrentLength=this._alphaCurrentLength;var a=t._alphaElements;for(a.length=this._alphaElements.length,i=0,n=this._alphaElements.length;i<n;i++)a[i]=this._alphaElements[i];t._rgbCurrentLength=this._rgbCurrentLength;var r=t._rgbElements;for(r.length=this._rgbElements.length,i=0,n=this._rgbElements.length;i<n;i++)r[i]=this._rgbElements[i]},t.clone=function(){var e=new this.constructor;return this.cloneTo(e),e},r(0,t,"alphaGradientCount",function(){return this._alphaCurrentLength/2}),r(0,t,"rgbGradientCount",function(){return this._rgbCurrentLength/4}),e}(),Z=function(){function e(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}a(e,"laya.d3.core.particleShuriKen.module.GradientDataInt");var t=e.prototype;return i.imps(t,{"laya.d3.core.IClone":!0}),t.add=function(e,t){this._currentLength<8?(6===this._currentLength&&1!==e&&(e=1,console.log("Warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=e,this._elements[this._currentLength++]=t):console.log("Warning:data count must lessEqual than 4")},t.cloneTo=function(e){var t=e;t._currentLength=this._currentLength;var i=t._elements;i.length=this._elements.length;for(var n=0,a=this._elements.length;n<a;n++)i[n]=this._elements[n]},t.clone=function(){var e=new this.constructor;return this.cloneTo(e),e},r(0,t,"gradientCount",function(){return this._currentLength/2}),e}(),Q=function(){function e(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}a(e,"laya.d3.core.particleShuriKen.module.GradientDataNumber");var t=e.prototype;return i.imps(t,{"laya.d3.core.IClone":!0}),t.add=function(e,t){this._currentLength<8?(6===this._currentLength&&1!==e&&(e=1,console.log("GradientDataNumber warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=e,this._elements[this._currentLength++]=t):console.log("GradientDataNumber warning:data count must lessEqual than 4")},t.getKeyByIndex=function(e){return this._elements[2*e]},t.getValueByIndex=function(e){return this._elements[2*e+1]},t.getAverageValue=function(){for(var e=0,t=this._currentLength-2;e<t;e+=2){this._elements[e+1];this._elements[e+3],this._elements[e+2]-this._elements[e]}return 0},t.cloneTo=function(e){var t=e;t._currentLength=this._currentLength;var i=t._elements;i.length=this._elements.length;for(var n=0,a=this._elements.length;n<a;n++)i[n]=this._elements[n]},t.clone=function(){var e=new this.constructor;return this.cloneTo(e),e},r(0,t,"gradientCount",function(){return this._currentLength/2}),e}(),$=(function(){function e(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(12)}a(e,"laya.d3.core.particleShuriKen.module.GradientDataVector2");var t=e.prototype;i.imps(t,{"laya.d3.core.IClone":!0}),t.add=function(e,t){this._currentLength<8?(6===this._currentLength&&1!==e&&(e=1,console.log("GradientDataVector2 warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=e,this._elements[this._currentLength++]=t.x,this._elements[this._currentLength++]=t.y):console.log("GradientDataVector2 warning:data count must lessEqual than 4")},t.cloneTo=function(e){var t=e;t._currentLength=this._currentLength;var i=t._elements;i.length=this._elements.length;for(var n=0,a=this._elements.length;n<a;n++)i[n]=this._elements[n]},t.clone=function(){var e=new this.constructor;return this.cloneTo(e),e},r(0,t,"gradientCount",function(){return this._currentLength/3})}(),function(){function e(){this._type=0,this._separateAxes=!1,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}a(e,"laya.d3.core.particleShuriKen.module.GradientSize");var t=e.prototype;return i.imps(t,{"laya.d3.core.IClone":!0}),t.getMaxSizeInGradient=function(){var e=0,t=0,i=-Number.MAX_VALUE;switch(this._type){case 0:if(this._separateAxes){for(e=0,t=this._gradientX.gradientCount;e<t;e++)i=Math.max(i,this._gradientX.getValueByIndex(e));for(e=0,t=this._gradientY.gradientCount;e<t;e++)i=Math.max(i,this._gradientY.getValueByIndex(e))}else for(e=0,t=this._gradient.gradientCount;e<t;e++)i=Math.max(i,this._gradient.getValueByIndex(e));break;case 1:this._separateAxes?(i=Math.max(this._constantMinSeparate.x,this._constantMaxSeparate.x),i=Math.max(i,this._constantMinSeparate.y),i=Math.max(i,this._constantMaxSeparate.y)):i=Math.max(this._constantMin,this._constantMax);break;case 2:if(this._separateAxes){for(e=0,t=this._gradientXMin.gradientCount;e<t;e++)i=Math.max(i,this._gradientXMin.getValueByIndex(e));for(e=0,t=this._gradientXMax.gradientCount;e<t;e++)i=Math.max(i,this._gradientXMax.getValueByIndex(e));for(e=0,t=this._gradientYMin.gradientCount;e<t;e++)i=Math.max(i,this._gradientYMin.getValueByIndex(e));for(e=0,t=this._gradientZMax.gradientCount;e<t;e++)i=Math.max(i,this._gradientZMax.getValueByIndex(e))}else{for(e=0,t=this._gradientMin.gradientCount;e<t;e++)i=Math.max(i,this._gradientMin.getValueByIndex(e));for(e=0,t=this._gradientMax.gradientCount;e<t;e++)i=Math.max(i,this._gradientMax.getValueByIndex(e))}}return i},t.cloneTo=function(e){var t=e;t._type=this._type,t._separateAxes=this._separateAxes,this._gradient.cloneTo(t._gradient),this._gradientX.cloneTo(t._gradientX),this._gradientY.cloneTo(t._gradientY),this._gradientZ.cloneTo(t._gradientZ),t._constantMin=this._constantMin,t._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(t._constantMinSeparate),this._constantMaxSeparate.cloneTo(t._constantMaxSeparate),this._gradientMin.cloneTo(t._gradientMin),this._gradientMax.cloneTo(t._gradientMax),this._gradientXMin.cloneTo(t._gradientXMin),this._gradientXMax.cloneTo(t._gradientXMax),this._gradientYMin.cloneTo(t._gradientYMin),this._gradientYMax.cloneTo(t._gradientYMax),this._gradientZMin.cloneTo(t._gradientZMin),this._gradientZMax.cloneTo(t._gradientZMax)},t.clone=function(){var e=new this.constructor;return this.cloneTo(e),e},r(0,t,"gradientZ",function(){return this._gradientZ}),r(0,t,"gradient",function(){return this._gradient}),r(0,t,"separateAxes",function(){return this._separateAxes}),r(0,t,"type",function(){return this._type}),r(0,t,"gradientMin",function(){return this._gradientMin}),r(0,t,"constantMin",function(){return this._constantMin}),r(0,t,"gradientX",function(){return this._gradientX}),r(0,t,"gradientY",function(){return this._gradientY}),r(0,t,"gradientMax",function(){return this._gradientMax}),r(0,t,"constantMax",function(){return this._constantMax}),r(0,t,"constantMinSeparate",function(){return this._constantMinSeparate}),r(0,t,"constantMaxSeparate",function(){return this._constantMaxSeparate}),r(0,t,"gradientXMin",function(){return this._gradientXMin}),r(0,t,"gradientXMax",function(){return this._gradientXMax}),r(0,t,"gradientYMin",function(){return this._gradientYMin}),r(0,t,"gradientYMax",function(){return this._gradientYMax}),r(0,t,"gradientZMin",function(){return this._gradientZMin}),r(0,t,"gradientZMax",function(){return this._gradientZMax}),e.createByGradient=function(t){var i=new e;return i._type=0,i._separateAxes=!1,i._gradient=t,i},e.createByGradientSeparate=function(t,i,n){var a=new e;return a._type=0,a._separateAxes=!0,a._gradientX=t,a._gradientY=i,a._gradientZ=n,a},e.createByRandomTwoConstant=function(t,i){var n=new e;return n._type=1,n._separateAxes=!1,n._constantMin=t,n._constantMax=i,n},e.createByRandomTwoConstantSeparate=function(t,i){var n=new e;return n._type=1,n._separateAxes=!0,n._constantMinSeparate=t,n._constantMaxSeparate=i,n},e.createByRandomTwoGradient=function(t,i){var n=new e;return n._type=2,n._separateAxes=!1,n._gradientMin=t,n._gradientMax=i,n},e.createByRandomTwoGradientSeparate=function(t,i,n,a,r,o){var s=new e;return s._type=2,s._separateAxes=!0,s._gradientXMin=t,s._gradientXMax=i,s._gradientYMin=n,s._gradientYMax=a,s._gradientZMin=r,s._gradientZMax=o,s},e}()),ee=function(){function e(){this._type=0,this._constant=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=null,this._constantMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}a(e,"laya.d3.core.particleShuriKen.module.GradientVelocity");var t=e.prototype;return i.imps(t,{"laya.d3.core.IClone":!0}),t.cloneTo=function(e){var t=e;t._type=this._type,this._constant.cloneTo(t._constant),this._gradientX.cloneTo(t._gradientX),this._gradientY.cloneTo(t._gradientY),this._gradientZ.cloneTo(t._gradientZ),this._constantMin.cloneTo(t._constantMin),this._constantMax.cloneTo(t._constantMax),this._gradientXMin.cloneTo(t._gradientXMin),this._gradientXMax.cloneTo(t._gradientXMax),this._gradientYMin.cloneTo(t._gradientYMin),this._gradientYMax.cloneTo(t._gradientYMax),this._gradientZMin.cloneTo(t._gradientZMin),this._gradientZMax.cloneTo(t._gradientZMax)},t.clone=function(){var e=new this.constructor;return this.cloneTo(e),e},r(0,t,"gradientZ",function(){return this._gradientZ}),r(0,t,"constant",function(){return this._constant}),r(0,t,"type",function(){return this._type}),r(0,t,"gradientXMax",function(){return this._gradientXMax}),r(0,t,"constantMin",function(){return this._constantMin}),r(0,t,"gradientX",function(){return this._gradientX}),r(0,t,"gradientY",function(){return this._gradientY}),r(0,t,"gradientXMin",function(){return this._gradientXMin}),r(0,t,"constantMax",function(){return this._constantMax}),r(0,t,"gradientYMin",function(){return this._gradientYMin}),r(0,t,"gradientYMax",function(){return this._gradientYMax}),r(0,t,"gradientZMin",function(){return this._gradientZMin}),r(0,t,"gradientZMax",function(){return this._gradientZMax}),e.createByConstant=function(t){var i=new e;return i._type=0,i._constant=t,i},e.createByGradient=function(t,i,n){var a=new e;return a._type=1,a._gradientX=t,a._gradientY=i,a._gradientZ=n,a},e.createByRandomTwoConstant=function(t,i){var n=new e;return n._type=2,n._constantMin=t,n._constantMax=i,n},e.createByRandomTwoGradient=function(t,i,n,a,r,o){var s=new e;return s._type=3,s._gradientXMin=t,s._gradientXMax=i,s._gradientYMin=n,s._gradientYMax=a,s._gradientZMin=r,s._gradientZMax=o,s},e}(),te=function(){function e(e){this._angularVelocity=null,this.enbale=!1,this._angularVelocity=e}a(e,"laya.d3.core.particleShuriKen.module.RotationOverLifetime");var t=e.prototype;return i.imps(t,{"laya.d3.core.IClone":!0}),t.cloneTo=function(e){var t=e;this._angularVelocity.cloneTo(t._angularVelocity),t.enbale=this.enbale},t.clone=function(){var e;switch(this._angularVelocity.type){case 0:e=this._angularVelocity.separateAxes?q.createByConstantSeparate(this._angularVelocity.constantSeparate.clone()):q.createByConstant(this._angularVelocity.constant);break;case 1:e=this._angularVelocity.separateAxes?q.createByGradientSeparate(this._angularVelocity.gradientX.clone(),this._angularVelocity.gradientY.clone(),this._angularVelocity.gradientZ.clone(),this._angularVelocity.gradientW.clone()):q.createByGradient(this._angularVelocity.gradient.clone());break;case 2:e=this._angularVelocity.separateAxes?q.createByRandomTwoConstantSeparate(this._angularVelocity.constantMinSeparate.clone(),this._angularVelocity.constantMaxSeparate.clone()):q.createByRandomTwoConstant(this._angularVelocity.constantMin,this._angularVelocity.constantMax);break;case 3:e=this._angularVelocity.separateAxes?q.createByRandomTwoGradientSeparate(this._angularVelocity.gradientXMin.clone(),this._angularVelocity.gradientYMin.clone(),this._angularVelocity.gradientZMin.clone(),this._angularVelocity.gradientWMin.clone(),this._angularVelocity.gradientXMax.clone(),this._angularVelocity.gradientYMax.clone(),this._angularVelocity.gradientZMax.clone(),this._angularVelocity.gradientWMax.clone()):q.createByRandomTwoGradient(this._angularVelocity.gradientMin.clone(),this._angularVelocity.gradientMax.clone())}var t=new this.constructor(e);return t.enbale=this.enbale,t},r(0,t,"angularVelocity",function(){return this._angularVelocity}),e}(),ie=function(){function e(){this.enable=!1,this.randomDirection=!1}a(e,"laya.d3.core.particleShuriKen.module.shape.BaseShape");var t=e.prototype;return i.imps(t,{"laya.d3.core.IClone":!0}),t._getShapeBoundBox=function(e){throw new Error("BaseShape: must override it.")},t._getSpeedBoundBox=function(e){throw new Error("BaseShape: must override it.")},t.generatePositionAndDirection=function(e,t,i,n){throw new Error("BaseShape: must override it.")},t._calculateProceduralBounds=function(e,t,i){this._getShapeBoundBox(e);var n=e.min,a=e.max;At.multiply(n,t,n),At.multiply(a,t,a);var r=new xt(new At,new At);this.randomDirection?(r.min=new At(-1,-1,-1),r.max=new At(1,1,1)):this._getSpeedBoundBox(r);var o=new xt(new At,new At),s=o.min,h=o.max;At.scale(r.min,i.y,s),At.scale(r.max,i.y,h),At.add(e.min,s,s),At.add(e.max,h,h),At.min(e.min,s,e.min),At.max(e.max,s,e.max);var l=new xt(new At,new At),c=l.min,p=l.max;At.scale(r.min,i.x,c),At.scale(r.max,i.x,p),At.min(l.min,p,s),At.max(l.min,p,h),At.min(e.min,s,e.min),At.max(e.max,s,e.max)},t.cloneTo=function(e){e.enable=this.enable},t.clone=function(){var e=new this.constructor;return this.cloneTo(e),e},e}(),ne=function(){function e(){}return a(e,"laya.d3.core.particleShuriKen.module.shape.ShapeUtils"),e._randomPointUnitArcCircle=function(e,t,i){var n=t.elements,a=NaN;a=i?i.getFloat()*e:Math.random()*e,n[0]=Math.cos(a),n[1]=Math.sin(a)},e._randomPointInsideUnitArcCircle=function(t,i,n){var a=i.elements;e._randomPointUnitArcCircle(t,i,n);var r=NaN;r=n?Math.pow(n.getFloat(),.5):Math.pow(Math.random(),.5),a[0]=a[0]*r,a[1]=a[1]*r},e._randomPointUnitCircle=function(e,t){var i=e.elements,n=NaN;n=t?t.getFloat()*Math.PI*2:Math.random()*Math.PI*2,i[0]=Math.cos(n),i[1]=Math.sin(n)},e._randomPointInsideUnitCircle=function(t,i){var n=t.elements;e._randomPointUnitCircle(t);var a=NaN;a=i?Math.pow(i.getFloat(),.5):Math.pow(Math.random(),.5),n[0]=n[0]*a,n[1]=n[1]*a},e._randomPointUnitSphere=function(e,t){var i=e.elements,n=NaN,a=NaN;t?(n=i[2]=2*t.getFloat()-1,a=t.getFloat()*Math.PI*2):(n=i[2]=2*Math.random()-1,a=Math.random()*Math.PI*2);var r=Math.sqrt(1-n*n);i[0]=r*Math.cos(a),i[1]=r*Math.sin(a)},e._randomPointInsideUnitSphere=function(t,i){var n=t.elements;e._randomPointUnitSphere(t);var a=NaN;a=i?Math.pow(i.getFloat(),1/3):Math.pow(Math.random(),1/3),n[0]=n[0]*a,n[1]=n[1]*a,n[2]=n[2]*a},e._randomPointInsideHalfUnitBox=function(e,t){var i=e.elements;t?(i[0]=t.getFloat()-.5,i[1]=t.getFloat()-.5,i[2]=t.getFloat()-.5):(i[0]=Math.random()-.5,i[1]=Math.random()-.5,i[2]=Math.random()-.5)},e}(),ae=function(){function e(e){this._size=null,this.enbale=!1,this._size=e}a(e,"laya.d3.core.particleShuriKen.module.SizeOverLifetime");var t=e.prototype;return i.imps(t,{"laya.d3.core.IClone":!0}),t.cloneTo=function(e){var t=e;this._size.cloneTo(t._size),t.enbale=this.enbale},t.clone=function(){var e;switch(this._size.type){case 0:e=this._size.separateAxes?$.createByGradientSeparate(this._size.gradientX.clone(),this._size.gradientY.clone(),this._size.gradientZ.clone()):$.createByGradient(this._size.gradient.clone());break;case 1:e=this._size.separateAxes?$.createByRandomTwoConstantSeparate(this._size.constantMinSeparate.clone(),this._size.constantMaxSeparate.clone()):$.createByRandomTwoConstant(this._size.constantMin,this._size.constantMax);break;case 2:e=this._size.separateAxes?$.createByRandomTwoGradientSeparate(this._size.gradientXMin.clone(),this._size.gradientYMin.clone(),this._size.gradientZMin.clone(),this._size.gradientXMax.clone(),this._size.gradientYMax.clone(),this._size.gradientZMax.clone()):$.createByRandomTwoGradient(this._size.gradientMin.clone(),this._size.gradientMax.clone())}var t=new this.constructor(e);return t.enbale=this.enbale,t},r(0,t,"size",function(){return this._size}),e}(),re=function(){function e(){this._type=0,this._constant=NaN,this._constantMin=NaN,this._constantMax=NaN}a(e,"laya.d3.core.particleShuriKen.module.StartFrame");var t=e.prototype;return i.imps(t,{"laya.d3.core.IClone":!0}),t.cloneTo=function(e){var t=e;t._type=this._type,t._constant=this._constant,t._constantMin=this._constantMin,t._constantMax=this._constantMax},t.clone=function(){var e=new this.constructor;return this.cloneTo(e),e},r(0,t,"constant",function(){return this._constant}),r(0,t,"type",function(){return this._type}),r(0,t,"constantMin",function(){return this._constantMin}),r(0,t,"constantMax",function(){return this._constantMax}),e.createByConstant=function(t){var i=new e;return i._type=0,i._constant=t,i},e.createByRandomTwoConstant=function(t,i){var n=new e;return n._type=1,n._constantMin=t,n._constantMax=i,n},e}(),oe=function(){function e(e,t){this._frame=null,this._startFrame=null,this.tiles=null,this.type=0,this.randomRow=!1,this.rowIndex=0,this.cycles=0,this.enableUVChannels=0,this.enable=!1,this.tiles=new Nt(1,1),this.type=0,this.randomRow=!0,this.rowIndex=0,this.cycles=1,this.enableUVChannels=1,this._frame=e,this._startFrame=t}a(e,"laya.d3.core.particleShuriKen.module.TextureSheetAnimation");var t=e.prototype;return i.imps(t,{"laya.d3.core.IClone":!0}),t.cloneTo=function(e){var t=e;this.tiles.cloneTo(t.tiles),t.type=this.type,t.randomRow=this.randomRow,this._frame.cloneTo(t._frame),this._startFrame.cloneTo(t._startFrame),t.cycles=this.cycles,t.enableUVChannels=this.enableUVChannels,t.enable=this.enable},t.clone=function(){var e;switch(this._frame.type){case 0:e=W.createByConstant(this._frame.constant);break;case 1:e=W.createByOverTime(this._frame.frameOverTimeData.clone());break;case 2:e=W.createByRandomTwoConstant(this._frame.constantMin,this._frame.constantMax);break;case 3:e=W.createByRandomTwoOverTime(this._frame.frameOverTimeDataMin.clone(),this._frame.frameOverTimeDataMax.clone())}var t;switch(this._startFrame.type){case 0:t=re.createByConstant(this._startFrame.constant);break;case 1:t=re.createByRandomTwoConstant(this._startFrame.constantMin,this._startFrame.constantMax)}var i=new this.constructor(e,t);return this.tiles.cloneTo(i.tiles),i.type=this.type,i.randomRow=this.randomRow,i.cycles=this.cycles,i.enableUVChannels=this.enableUVChannels,i.enable=this.enable,i},r(0,t,"frame",function(){return this._frame}),r(0,t,"startFrame",function(){return this._startFrame}),e}(),se=function(){function e(e){this._velocity=null,this.enbale=!1,this.space=0,this._velocity=e}a(e,"laya.d3.core.particleShuriKen.module.VelocityOverLifetime");var t=e.prototype;return i.imps(t,{"laya.d3.core.IClone":!0}),t.cloneTo=function(e){var t=e;this._velocity.cloneTo(t._velocity),t.enbale=this.enbale,t.space=this.space},t.clone=function(){var e;switch(this._velocity.type){case 0:e=ee.createByConstant(this._velocity.constant.clone());break;case 1:e=ee.createByGradient(this._velocity.gradientX.clone(),this._velocity.gradientY.clone(),this._velocity.gradientZ.clone());break;case 2:e=ee.createByRandomTwoConstant(this._velocity.constantMin.clone(),this._velocity.constantMax.clone());break;case 3:e=ee.createByRandomTwoGradient(this._velocity.gradientXMin.clone(),this._velocity.gradientYMin.clone(),this._velocity.gradientZMin.clone(),this._velocity.gradientXMax.clone(),this._velocity.gradientYMax.clone(),this._velocity.gradientZMax.clone())}var t=new this.constructor(e);return t.enbale=this.enbale,t.space=this.space,t},r(0,t,"velocity",function(){return this._velocity}),e}(),he=function(){function e(){}return a(e,"laya.d3.core.particleShuriKen.ShurikenParticleData"),e._getStartLifetimeFromGradient=function(e,t){for(var i=1,n=e.gradientCount;i<n;i++){var a=e.getKeyByIndex(i);if(a>=t){var r=e.getKeyByIndex(i-1),o=(t-r)/(a-r);return b.lerp(e.getValueByIndex(i-1),e.getValueByIndex(i),o)}}throw new Error("ShurikenParticleData: can't get value foam startLifeTimeGradient.")},e._randomInvertRoationArray=function(e,t,i,n,a){var r=NaN;n?(n.seed=a[6],r=n.getFloat(),a[6]=n.seed):r=Math.random(),r<i?(t[0]=-e[0],t[1]=-e[1],t[2]=-e[2]):(t[0]=e[0],t[1]=e[1],t[2]=e[2])},e._randomInvertRoation=function(e,t,i,n){var a=NaN;return i?(i.seed=n[6],a=i.getFloat(),n[6]=i.seed):a=Math.random(),a<t&&(e=-e),e},e.create=function(t,i,n){var a=t.autoRandomSeed,r=t._rand,o=t._randomSeeds;switch(t.startColorType){case 0:var s=t.startColorConstant.elements;e.startColor[0]=s[0],e.startColor[1]=s[1],e.startColor[2]=s[2],e.startColor[3]=s[3];break;case 2:a?b.lerpVector4(t.startColorConstantMin.elements,t.startColorConstantMax.elements,Math.random(),e.startColor):(r.seed=o[3],b.lerpVector4(t.startColorConstantMin.elements,t.startColorConstantMax.elements,r.getFloat(),e.startColor),o[3]=r.seed)}var h=t.colorOverLifetime;if(h&&h.enbale){var l=h.color;switch(l.type){case 0:e.startColor[0]=e.startColor[0]*l.constant.x,e.startColor[1]=e.startColor[1]*l.constant.y,e.startColor[2]=e.startColor[2]*l.constant.z,e.startColor[3]=e.startColor[3]*l.constant.w;break;case 2:var c=NaN;a?c=Math.random():(r.seed=o[10],c=r.getFloat(),o[10]=r.seed);var p=l.constantMin,u=l.constantMax;e.startColor[0]=e.startColor[0]*b.lerp(p.x,u.x,c),e.startColor[1]=e.startColor[1]*b.lerp(p.y,u.y,c),e.startColor[2]=e.startColor[2]*b.lerp(p.z,u.z,c),e.startColor[3]=e.startColor[3]*b.lerp(p.w,u.w,c)}}var d=e.startSize;switch(t.startSizeType){case 0:if(t.threeDStartSize){var _=t.startSizeConstantSeparate;d[0]=_.x,d[1]=_.y,d[2]=_.z}else d[0]=d[1]=d[2]=t.startSizeConstant;break;case 2:if(t.threeDStartSize){var m=t.startSizeConstantMinSeparate,f=t.startSizeConstantMaxSeparate;a?(d[0]=b.lerp(m.x,f.x,Math.random()),d[1]=b.lerp(m.y,f.y,Math.random()),d[2]=b.lerp(m.z,f.z,Math.random())):(r.seed=o[4],d[0]=b.lerp(m.x,f.x,r.getFloat()),d[1]=b.lerp(m.y,f.y,r.getFloat()),d[2]=b.lerp(m.z,f.z,r.getFloat()),o[4]=r.seed)}else a?d[0]=d[1]=d[2]=b.lerp(t.startSizeConstantMin,t.startSizeConstantMax,Math.random()):(r.seed=o[4],d[0]=d[1]=d[2]=b.lerp(t.startSizeConstantMin,t.startSizeConstantMax,r.getFloat()),o[4]=r.seed)}var g=t.sizeOverLifetime;if(g&&g.enbale&&1===g.size.type){var y=g.size;if(y.separateAxes)a?(d[0]=d[0]*b.lerp(y.constantMinSeparate.x,y.constantMaxSeparate.x,Math.random()),d[1]=d[1]*b.lerp(y.constantMinSeparate.y,y.constantMaxSeparate.y,Math.random()),d[2]=d[2]*b.lerp(y.constantMinSeparate.z,y.constantMaxSeparate.z,Math.random())):(r.seed=o[11],d[0]=d[0]*b.lerp(y.constantMinSeparate.x,y.constantMaxSeparate.x,r.getFloat()),d[1]=d[1]*b.lerp(y.constantMinSeparate.y,y.constantMaxSeparate.y,r.getFloat()),d[2]=d[2]*b.lerp(y.constantMinSeparate.z,y.constantMaxSeparate.z,r.getFloat()),o[11]=r.seed);else{var v=NaN;a?v=b.lerp(y.constantMin,y.constantMax,Math.random()):(r.seed=o[11],v=b.lerp(y.constantMin,y.constantMax,r.getFloat()),o[11]=r.seed),d[0]=d[0]*v,d[1]=d[1]*v,d[2]=d[2]*v}}var x=i.renderMode;if(1!==x)switch(t.startRotationType){case 0:if(t.threeDStartRotation){var w=t.startRotationConstantSeparate,S=e._tempVector30.elements;e._randomInvertRoationArray(w.elements,S,t.randomizeRotationDirection,a?null:r,o),e.startRotation[0]=S[0],e.startRotation[1]=S[1],e.startRotation[2]=4!==x?-S[2]:S[2]}else e.startRotation[0]=e._randomInvertRoation(t.startRotationConstant,t.randomizeRotationDirection,a?null:r,o);break;case 2:if(t.threeDStartRotation){var I=t.startRotationConstantMinSeparate,M=t.startRotationConstantMaxSeparate,C=e._tempVector30.elements;a?(C[0]=b.lerp(I.x,M.x,Math.random()),C[1]=b.lerp(I.y,M.y,Math.random()),C[2]=b.lerp(I.z,M.z,Math.random())):(r.seed=o[5],C[0]=b.lerp(I.x,M.x,r.getFloat()),C[1]=b.lerp(I.y,M.y,r.getFloat()),C[2]=b.lerp(I.z,M.z,r.getFloat()),o[5]=r.seed),e._randomInvertRoationArray(C,C,t.randomizeRotationDirection,a?null:r,o),e.startRotation[0]=C[0],e.startRotation[1]=C[1],e.startRotation[2]=4!==x?-C[2]:C[2]}else a?e.startRotation[0]=e._randomInvertRoation(b.lerp(t.startRotationConstantMin,t.startRotationConstantMax,Math.random()),t.randomizeRotationDirection,a?null:r,o):(r.seed=o[5],e.startRotation[0]=e._randomInvertRoation(b.lerp(t.startRotationConstantMin,t.startRotationConstantMax,r.getFloat()),t.randomizeRotationDirection,a?null:r,o),o[5]=r.seed)}switch(t.startLifetimeType){case 0:e.startLifeTime=t.startLifetimeConstant;break;case 1:e.startLifeTime=e._getStartLifetimeFromGradient(t.startLifeTimeGradient,t.emissionTime);break;case 2:a?e.startLifeTime=b.lerp(t.startLifetimeConstantMin,t.startLifetimeConstantMax,Math.random()):(r.seed=o[7],e.startLifeTime=b.lerp(t.startLifetimeConstantMin,t.startLifetimeConstantMax,r.getFloat()),o[7]=r.seed);break;case 3:var k=t.emissionTime;a?e.startLifeTime=b.lerp(e._getStartLifetimeFromGradient(t.startLifeTimeGradientMin,k),e._getStartLifetimeFromGradient(t.startLifeTimeGradientMax,k),Math.random()):(r.seed=o[7],e.startLifeTime=b.lerp(e._getStartLifetimeFromGradient(t.startLifeTimeGradientMin,k),e._getStartLifetimeFromGradient(t.startLifeTimeGradientMax,k),r.getFloat()),o[7]=r.seed)}switch(t.startSpeedType){case 0:e.startSpeed=t.startSpeedConstant;break;case 2:a?e.startSpeed=b.lerp(t.startSpeedConstantMin,t.startSpeedConstantMax,Math.random()):(r.seed=o[8],e.startSpeed=b.lerp(t.startSpeedConstantMin,t.startSpeedConstantMax,r.getFloat()),o[8]=r.seed)}var E=t.textureSheetAnimation;if(E&&E.enable){var T=E.tiles,L=T.x,D=T.y,N=1/L,A=1/D,R=0,B=E.startFrame;switch(B.type){case 0:R=B.constant;break;case 1:a?R=b.lerp(B.constantMin,B.constantMax,Math.random()):(r.seed=o[14],R=b.lerp(B.constantMin,B.constantMax,r.getFloat()),o[14]=r.seed)}var P=E.frame;switch(P.type){case 0:R+=P.constant;break;case 2:a?R+=b.lerp(P.constantMin,P.constantMax,Math.random()):(r.seed=o[15],R+=b.lerp(P.constantMin,P.constantMax,r.getFloat()),o[15]=r.seed)}var O=0;switch(E.type){case 0:O=Math.floor(R/L);break;case 1:E.randomRow?a?O=Math.floor(Math.random()*D):(r.seed=o[13],O=Math.floor(r.getFloat()*D),o[13]=r.seed):O=E.rowIndex}var V=Math.floor(R%L);(e.startUVInfo=e.startUVInfo)[0]=N,e.startUVInfo[1]=A,e.startUVInfo[2]=V*N,e.startUVInfo[3]=O*A}else(e.startUVInfo=e.startUVInfo)[0]=1,e.startUVInfo[1]=1,e.startUVInfo[2]=0,e.startUVInfo[3]=0;switch(t.simulationSpace){case 0:var U=n.position.elements;e.simulationWorldPostion[0]=U[0],e.simulationWorldPostion[1]=U[1],e.simulationWorldPostion[2]=U[2];var F=n.rotation.elements;e.simulationWorldRotation[0]=F[0],e.simulationWorldRotation[1]=F[1],e.simulationWorldRotation[2]=F[2],e.simulationWorldRotation[3]=F[3];break;case 1:break;default:throw new Error("ShurikenParticleMaterial: SimulationSpace value is invalid.")}},e.startLifeTime=NaN,e.startSpeed=NaN,n(e,["_tempVector30",function(){return this._tempVector30=new At},"_tempQuaternion",function(){return this._tempQuaternion=new Tt},"startColor",function(){return this.startColor=new Float32Array(4)},"startSize",function(){return this.startSize=new Float32Array(3)},"startRotation",function(){return this.startRotation=new Float32Array(3)},"startUVInfo",function(){return this.startUVInfo=new Float32Array(4)},"simulationWorldPostion",function(){return this.simulationWorldPostion=new Float32Array(3)},"simulationWorldRotation",function(){return this.simulationWorldRotation=new Float32Array(4)}]),e}(),le=function(){function e(){this._tempInt0=0,this._tempInt1=0,this._tempUint0=0,this._tempUint1=0,this._tempUint2=0,this._tempUint3=0,this._tempUint4=0,this._tempUint5=0,this._tempUint6=0,this._tempUint7=0,this._tempNumver0=NaN,this._tempNumver1=NaN,this._tempNumver2=NaN,this._tempNumver3=NaN,this._floatSizePerVer=7,this._defaultBufferSize=600*this._floatSizePerVer,this._vb=null,this._posInVBData=0,this._ib=null,this._posInIBData=0,this._primitiveType=NaN,this._hasBegun=!1,this._numVertsPerPrimitive=0,this._camera=null,this._sharderNameID=0,this._shader=null,this._shaderCompile=null,this._vbData=new Float32Array(this._defaultBufferSize),this._ibData=new Uint16Array(this._defaultBufferSize),this._spriteShaderValue=new Ft,this._vb=qi.create(e._vertexDeclaration,this._defaultBufferSize/this._floatSizePerVer,35048),this._ib=Wi.create("ushort",this._defaultBufferSize,35048),this._sharderNameID=Oi.nameKey.getID("LINE"),this._shaderCompile=ci._preCompileShader[this._sharderNameID]}a(e,"laya.d3.core.PhasorSpriter3D");var t=e.prototype;return t.line=function(e,t,i,n){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+2*this._floatSizePerVer>this._vbData.length||this._posInIBData+2>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(e.x,e.y,e.z,t.x,t.y,t.z,t.w),this.addVertex(i.x,i.y,i.z,n.x,n.y,n.z,n.w),this.addIndexes(this._tempUint0,this._tempUint0+1),this},t.circle=function(e,t,i,n,a,r){for(this._hasBegun&&1===this._primitiveType||this.drawLinesException(),this._tempUint0=2*t,(this._posInVBData+this._tempUint0*this._floatSizePerVer>this._vbData.length||this._posInIBData+2*this._tempUint0>this._ibData.length)&&this.flush(),this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=0,this._tempInt0=0;this._tempNumver0<6.2832;this._tempNumver0=this._tempNumver0+3.1416/t,this._tempInt0++)this.addVertex(Math.sin(this._tempNumver0)*e,Math.cos(this._tempNumver0)*e,0,i,n,a,r),0===this._tempInt0?this.addIndexes(this._tempUint1):this._tempInt0===this._tempUint0-1?(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2,this._tempUint1)):(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2));return this},t.plane=function(e,t,i,n,a,r,o,s,h){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+4*this._floatSizePerVer>this._vbData.length||this._posInIBData+6>this._ibData.length)&&this.flush(),this._tempNumver0=n/2,this._tempNumver1=a/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(e-this._tempNumver0,t+this._tempNumver1,i,r,o,s,h),this.addVertex(e+this._tempNumver0,t+this._tempNumver1,i,r,o,s,h),this.addVertex(e-this._tempNumver0,t-this._tempNumver1,i,r,o,s,h),this.addVertex(e+this._tempNumver0,t-this._tempNumver1,i,r,o,s,h),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint0+3),this},t.box=function(e,t,i,n,a,r,o,s,h,l){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+36>this._ibData.length)&&this.flush(),this._tempNumver0=n/2,this._tempNumver1=a/2,this._tempNumver2=r/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(e-this._tempNumver0,t+this._tempNumver1,i+this._tempNumver2,o,s,h,l),this.addVertex(e+this._tempNumver0,t+this._tempNumver1,i+this._tempNumver2,o,s,h,l),this.addVertex(e-this._tempNumver0,t-this._tempNumver1,i+this._tempNumver2,o,s,h,l),this.addVertex(e+this._tempNumver0,t-this._tempNumver1,i+this._tempNumver2,o,s,h,l),this.addVertex(e+this._tempNumver0,t+this._tempNumver1,i-this._tempNumver2,o,s,h,l),this.addVertex(e-this._tempNumver0,t+this._tempNumver1,i-this._tempNumver2,o,s,h,l),this.addVertex(e+this._tempNumver0,t-this._tempNumver1,i-this._tempNumver2,o,s,h,l),this.addVertex(e-this._tempNumver0,t-this._tempNumver1,i-this._tempNumver2,o,s,h,l),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint3,this._tempUint4,this._tempUint5,this._tempUint6,this._tempUint6,this._tempUint5,this._tempUint7,this._tempUint5,this._tempUint0,this._tempUint7,this._tempUint7,this._tempUint0,this._tempUint2,this._tempUint1,this._tempUint4,this._tempUint3,this._tempUint3,this._tempUint4,this._tempUint6,this._tempUint5,this._tempUint4,this._tempUint0,this._tempUint0,this._tempUint4,this._tempUint1,this._tempUint2,this._tempUint3,this._tempUint7,this._tempUint7,this._tempUint3,this._tempUint6),this},t.cone=function(e,t,i,n,a,r,o){for(this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+(2*i+2)*this._floatSizePerVer>this._vbData.length||this._posInIBData+6*i>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData,this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=2*Math.PI/i,this.addVertexIndex(0,t,0,n,a,r,o,this._tempUint0),this.addVertexIndex(0,0,0,n,a,r,o,this._tempUint0+this._floatSizePerVer),this._tempInt0=2,this._tempNumver1=0,this._tempInt1=0;this._tempInt1<i;this._tempInt1++)this._tempNumver2=Math.cos(this._tempNumver1),this._tempNumver3=Math.sin(this._tempNumver1),this.addVertexIndex(e*this._tempNumver2,0,e*this._tempNumver3,n,a,r,o,this._tempUint0+this._tempInt0*this._floatSizePerVer),this.addIndexes(this._tempUint1,this._tempUint1+this._tempInt0),this._tempInt1==i-1?this.addIndexes(this._tempUint1+2):this.addIndexes(this._tempUint1+this._tempInt0+1),this.addVertexIndex(e*this._tempNumver2,0,e*this._tempNumver3,n,a,r,o,this._tempUint0+(this._tempInt0+i)*this._floatSizePerVer),this.addIndexes(this._tempUint1+1),this._tempInt1==i-1?this.addIndexes(this._tempUint1+i+2):this.addIndexes(this._tempUint1+this._tempInt0+i+1),this.addIndexes(this._tempUint1+this._tempInt0+i),this._tempInt0++,this._tempNumver1+=this._tempNumver0;return this},t.boundingBoxLine=function(e,t,i,n,a,r,o,s,h,l){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+48>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(e,a,r,o,s,h,l),this.addVertex(n,a,r,o,s,h,l),this.addVertex(e,t,r,o,s,h,l),this.addVertex(n,t,r,o,s,h,l),this.addVertex(n,a,i,o,s,h,l),this.addVertex(e,a,i,o,s,h,l),this.addVertex(n,t,i,o,s,h,l),this.addVertex(e,t,i,o,s,h,l),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint1,this._tempUint3,this._tempUint3,this._tempUint2,this._tempUint2,this._tempUint0,this._tempUint4,this._tempUint5,this._tempUint5,this._tempUint7,this._tempUint7,this._tempUint6,this._tempUint6,this._tempUint4,this._tempUint5,this._tempUint0,this._tempUint0,this._tempUint2,this._tempUint2,this._tempUint7,this._tempUint7,this._tempUint5,this._tempUint1,this._tempUint4,this._tempUint4,this._tempUint6,this._tempUint6,this._tempUint3,this._tempUint3,this._tempUint1,this._tempUint5,this._tempUint4,this._tempUint4,this._tempUint1,this._tempUint1,this._tempUint0,this._tempUint0,this._tempUint5,this._tempUint2,this._tempUint3,this._tempUint3,this._tempUint6,this._tempUint6,this._tempUint7,this._tempUint7,this._tempUint2),this},t.addVertex=function(e,t,i,n,a,r,o){return this._hasBegun||this.addVertexIndexException(),this._vbData[this._posInVBData]=e,this._vbData[this._posInVBData+1]=t,this._vbData[this._posInVBData+2]=i,this._vbData[this._posInVBData+3]=n,this._vbData[this._posInVBData+4]=a,this._vbData[this._posInVBData+5]=r,this._vbData[this._posInVBData+6]=o,this._posInVBData+=this._floatSizePerVer,this},t.addVertexIndex=function(e,t,i,n,a,r,o,s){return this._hasBegun||this.addVertexIndexException(),this._vbData[s]=e,this._vbData[s+1]=t,this._vbData[s+2]=i,this._vbData[s+3]=n,this._vbData[s+4]=a,this._vbData[s+5]=r,this._vbData[s+6]=o,(s+=this._floatSizePerVer)>this._posInVBData&&(this._posInVBData=s),this},t.addIndexes=function(e){var t=arguments;this._hasBegun||this.addVertexIndexException();for(var i=0;i<t.length;i++)this._ibData[this._posInIBData]=t[i],this._posInIBData++;return this},t.begin=function(e,t){return this._hasBegun&&this.beginException0(),1!==e&&4!==e&&this.beginException1(),this._primitiveType=e,this._camera=t,this._hasBegun=!0,this},t.end=function(){return this._hasBegun||this.endException(),this.flush(),this._hasBegun=!1,this},t.flush=function(){0!==this._posInVBData&&(this._ib.setData(this._ibData),this._vb.setData(this._vbData),this._vb._bind(),this._ib._bind(),this._shader=this._shaderCompile.withCompile(0,0,0),this._shader.bind(),this._shader.uploadAttributes(e._vertexDeclaration.shaderValues.data,null),this._spriteShaderValue.setValue(1,this._camera.projectionViewMatrix.elements),this._shader.uploadSpriteUniforms(this._spriteShaderValue.data),T.drawCall++,A.mainContext.drawElements(this._primitiveType,this._posInIBData,5123,0),this._posInIBData=0,this._posInVBData=0)},t.addVertexIndexException=function(){throw new Error("请先调用begin()函数")},t.beginException0=function(){throw new Error("调用begin()前请确保已成功调用end()！")},t.beginException1=function(){throw new Error("只支持“LINES”和“TRIANGLES”两种基元！")},t.endException=function(){throw new Error("调用end()前请确保已成功调用begin()！")},t.drawLinesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“LINES”基元！")},t.drawTrianglesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“TRIANGLES”基元！")},n(e,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ce(28,[new ke(0,"vector3",0),new ke(12,"vector4",1)])}]),e}(),ce=function(){function e(){this._id=0,this._type=0,this._mainSortID=0,this._render=null,this._sprite3D=null,this._material=null,this._renderObj=null,this._staticBatch=null,this._tempBatchIndexStart=0,this._tempBatchIndexEnd=0,this._canDynamicBatch=!1,this._shaderValue=null,this._onPreRenderFunction=null,this._id=++e._uniqueIDCounter,this._canDynamicBatch=!0,this._shaderValue=new Ft}a(e,"laya.d3.core.render.RenderElement");var t=e.prototype;return t.getDynamicBatchBakedVertexs=function(e){for(var t=this._renderObj._getVertexBuffer(e),i=t.getData().slice(),n=t.vertexDeclaration,a=n.getVertexElementByUsage(0).offset/4,r=n.getVertexElementByUsage(3).offset/4,o=this._sprite3D.transform,s=o.worldMatrix,h=o.rotation,l=n.vertexStride/4,c=0,p=i.length;c<p;c+=l){var u=c+a,d=c+r;Jt.transformVector3ArrayToVector3ArrayCoordinate(i,u,s,i,u),Jt.transformVector3ArrayByQuat(i,d,h,i,d)}return i},t.getBakedIndices=function(){return this._renderObj._getIndexBuffer().getData()},t._destroy=function(){this._staticBatch&&this._staticBatch._manager._garbageCollection(this)},r(0,t,"id",function(){return this._id}),r(0,t,"renderObj",function(){return this._renderObj},function(e){this._renderObj!==e&&(this._renderObj=e)}),e._uniqueIDCounter=0,e}(),pe=function(){function e(t){this._id=0,this._needSort=!1,this._renderElements=null,this._renderableRenderObjects=null,this._dynamicBatchCombineRenderElements=null,this._finalElements=null,this._scene=null,this._id=++e._uniqueIDCounter,this._needSort=!1,this._scene=t,this._renderElements=[],this._renderableRenderObjects=[],this._dynamicBatchCombineRenderElements=[]}a(e,"laya.d3.core.render.RenderQueue");var t=e.prototype;return t._sortOpaqueFunc=function(e,t){if(e._render&&t._render){var i=e._material.renderQueue-t._material.renderQueue;return 0===i?e._render._distanceForSort-t._render._distanceForSort:i}return 0},t._sortAlphaFunc=function(e,t){if(e._render&&t._render){var i=e._material.renderQueue-t._material.renderQueue;return 0===i?t._render._distanceForSort-e._render._distanceForSort:i}return 0},t._begainRenderElement=function(e,t,i){return!!t._beforeRender(e)},t._sortAlpha=function(t){e._cameraPosition=t,this._finalElements.sort(this._sortAlphaFunc)},t._sortOpaque=function(t){e._cameraPosition=t,this._finalElements.sort(this._sortOpaqueFunc)},t._preRender=function(e){this._finalElements=this._renderElements.concat(this._dynamicBatchCombineRenderElements)},t._render=function(e,t){for(var i,n,a,r,o,s,h=T.loopCount,l=this._scene,c=e.camera,p=(c.id,!1),u=0,d=this._finalElements.length;u<d;u++){var _,m,f,g=this._finalElements[u];if(null!=g._onPreRenderFunction&&g._onPreRenderFunction.call(g._sprite3D,e),0===g._type){if(e.owner=f=g._sprite3D,e.renderElement=g,f._preRenderUpdateComponents(e),_=g.renderObj,m=g._material,this._begainRenderElement(e,_,m)){if(i=_._getVertexBuffers(),n=_._getVertexBuffer(0),a=n.vertexDeclaration,r=e._shader=m._getShader(l._shaderDefineValue,a.shaderDefineValue,f._shaderDefineValue),p=r.bind()||h!==r._uploadLoopCount,i){if(r._uploadVertexBuffer!==i||p){for(var y=0;y<i.length;y++){var v=i[y];r.uploadAttributesX(v.vertexDeclaration.shaderValues.data,v)}r._uploadVertexBuffer=i}}else(r._uploadVertexBuffer!==n||p)&&(r.uploadAttributes(a.shaderValues.data,null),r._uploadVertexBuffer=n);(r._uploadScene!==l||p)&&(r.uploadSceneUniforms(l._shaderValues.data),r._uploadScene=l),(c!==r._uploadCamera||r._uploadSprite3D!==f||p)&&(r.uploadSpriteUniforms(f._shaderValues.data),r._uploadSprite3D=f),(c!==r._uploadCamera||p)&&(r.uploadCameraUniforms(c._shaderValues.data),r._uploadCamera=c),(r._uploadMaterial!==m||p)&&(m._upload(),r._uploadMaterial=m),o!==m?(m._setRenderStateBlendDepth(),m._setRenderStateFrontFace(t,f.transform),o=m,s=f):s!==f&&(m._setRenderStateFrontFace(t,f.transform),s=f),_._render(e),r._uploadLoopCount=h}f._postRenderUpdateComponents(e)}else if(2===g._type){g.renderObj;e.owner=f=g._sprite3D,e.renderElement=g,e._batchIndexStart=g._tempBatchIndexStart,e._batchIndexEnd=g._tempBatchIndexEnd,_=g.renderObj,m=g._material,this._begainRenderElement(e,_,m)&&(a=(n=_._getVertexBuffer(0)).vertexDeclaration,p=(r=e._shader=m._getShader(l._shaderDefineValue,a.shaderDefineValue,f._shaderDefineValue)).bind()||h!==r._uploadLoopCount,(r._uploadVertexBuffer!==n||p)&&(r.uploadAttributes(a.shaderValues.data,null),r._uploadVertexBuffer=n),(r._uploadScene!==l||p)&&(r.uploadSceneUniforms(l._shaderValues.data),r._uploadScene=l),(c!==r._uploadCamera||r._uploadSprite3D!==f||p)&&(r.uploadSpriteUniforms(f._shaderValues.data),r._uploadSprite3D=f),(c!==r._uploadCamera||p)&&(r.uploadCameraUniforms(c._shaderValues.data),r._uploadCamera=c),(r._uploadMaterial!==m||p)&&(m._upload(),r._uploadMaterial=m),o!==m?(m._setRenderStateBlendDepth(),m._setRenderStateFrontFace(t,f.transform),o=m,s=f):s!==f&&(m._setRenderStateFrontFace(t,f.transform),s=f),_._render(e),r._uploadLoopCount=h)}}},t._renderShadow=function(e,t){for(var i,n,a,r,o,s=T.loopCount,h=this._scene,l=e.camera,c=!1,p=0,u=this._finalElements.length;p<u;p++){var d,_,m,f=this._finalElements[p];0===f._type&&(e.owner=m=f._sprite3D,t||m._projectionViewWorldUpdateCamera===l&&m._projectionViewWorldUpdateLoopCount===T.loopCount||(m._render._renderUpdate(e._projectionViewMatrix),m._projectionViewWorldUpdateLoopCount=T.loopCount,m._projectionViewWorldUpdateCamera=l),e.renderElement=f,m._preRenderUpdateComponents(e),d=f.renderObj,_=f._material,this._begainRenderElement(e,d,null)&&(n=(i=d._getVertexBuffer(0)).vertexDeclaration,c=(a=e._shader=_._getShader(h._shaderDefineValue,n.shaderDefineValue,m._shaderDefineValue)).bind()||s!==a._uploadLoopCount,(a._uploadVertexBuffer!==i||c)&&(a.uploadAttributes(n.shaderValues.data,null),a._uploadVertexBuffer=i),(l!==a._uploadCamera||a._uploadSprite3D!==m||c)&&(a.uploadSpriteUniforms(m._shaderValues.data),a._uploadSprite3D=m),(l!==a._uploadCamera||c)&&(a.uploadCameraUniforms(l._shaderValues.data),a._uploadCamera=l),(a._uploadMaterial!==_||c)&&(_._upload(),a._uploadMaterial=_),a._uploadRenderElement,r!==_?(_._setRenderStateFrontFace(!1,m.transform),r=_,o=m):o!==m&&(_._setRenderStateFrontFace(!1,m.transform),o=m),d._render(e),a._uploadLoopCount=s),m._postRenderUpdateComponents(e))}},t._clearRenderElements=function(){this._dynamicBatchCombineRenderElements.length=0,this._renderElements.length=0,this._needSort=!0},t._addRenderElement=function(e){this._renderElements.push(e),this._needSort=!0},t._addDynamicBatchElement=function(e){this._dynamicBatchCombineRenderElements.push(e)},r(0,t,"id",function(){return this._id}),e._uniqueIDCounter=0,e._cameraPosition=null,e}(),ue=function(){function e(){this._staticBatch=null,this._batchIndexStart=0,this._batchIndexEnd=0,this._viewMatrix=null,this._projectionMatrix=null,this._projectionViewMatrix=null,this._viewport=null,this._shader=null,this.elapsedTime=NaN,this.scene=null,this.owner=null,this.renderElement=null,this.camera=null}return a(e,"laya.d3.core.render.RenderState"),e.clientWidth=0,e.clientHeight=0,e}(),de=function(){function e(e,t){this._exactBox=null,this._relaxBox=null,this._scene=null,this._parent=null,this._currentDepth=0,this._boundingSphere=new wt(new At,0),this._corners=[new At,new At,new At,new At,new At,new At,new At,new At],this._boundingBoxCenter=new At,this._children=o(8),this._objects=[],this._tempBoundBoxCorners=[new At,new At,new At,new At,new At,new At,new At,new At],this._scene=e,this._currentDepth=t}a(e,"laya.d3.core.scene.OctreeNode");var t=e.prototype;return i.imps(t,{"laya.d3.core.scene.ITreeNode":!0}),t.init=function(e,t){var i=new At,n=new At;At.scale(t,-.5,i),At.scale(t,.5,n),At.add(i,e,i),At.add(n,e,n),this.exactBox=new xt(i,n),this.relaxBox=new xt(i,n)},t.addTreeNode=function(e){1===St.boxContainsBox(this._relaxBox,e.boundingBox)?this.addNodeDown(e,0):this.addObject(e)},t.addChild=function(t){var i=this._children[t];if(null==i){i=new e(this._scene,this._currentDepth+1),this._children[t]=i,i._parent=this,At.subtract(this._exactBox.max,this._exactBox.min,e.tempSize),At.multiply(e.tempSize,e._octreeSplit[t],e.tempCenter),At.add(this._exactBox.min,e.tempCenter,e.tempCenter),At.scale(e.tempSize,.25,e.tempSize);var n=new At,a=new At;At.subtract(e.tempCenter,e.tempSize,n),At.add(e.tempCenter,e.tempSize,a),i.exactBox=new xt(n,a),At.scale(e.tempSize,e.relax,e.tempSize);var r=new At,o=new At;At.subtract(e.tempCenter,e.tempSize,r),At.add(e.tempCenter,e.tempSize,o),i.relaxBox=new xt(r,o)}return i},t.addObject=function(e){e._treeNode=this,this._objects.push(e)},t.removeObject=function(e){if(e._treeNode!=this)return console.log("OctreeNode::removeObject error"),!1;var t=this._objects.indexOf(e);return-1!==t&&(this._objects.splice(t,1),!0)},t.clearObject=function(){this._objects.length=0},t.addNodeUp=function(e,t){this._parent&&1!==St.boxContainsBox(this._exactBox,e.boundingBox)?this._parent.addNodeUp(e,t-1):this.addNodeDown(e,t)},t.addNodeDown=function(e,t){if(t<this._scene.treeLevel){var i=this.inChildIndex(e.boundingBoxCenter),n=this.addChild(i);1===St.boxContainsBox(n._relaxBox,e.boundingBox)?n.addNodeDown(e,++t):this.addObject(e)}else this.addObject(e)},t.inChildIndex=function(e){return 4*(e.z<this._boundingBoxCenter.z?0:1)+2*(e.y<this._boundingBoxCenter.y?0:1)+(e.x<this._boundingBoxCenter.x?0:1)},t.updateObject=function(e){1===St.boxContainsBox(this._relaxBox,e.boundingBox)?(this.removeObject(e),e._treeNode=null,this.addNodeDown(e,this._currentDepth)):this._parent&&(this.removeObject(e),e._treeNode=null,this._parent.addNodeUp(e,this._currentDepth-1))},t.cullingObjects=function(e,t,i,n,a){var r=0,o=0,s=0,h=0,l=this._scene._dynamicBatchManager;for(r=0,s=this._objects.length;r<s;r++){var c=this._objects[r];if(X.isVisible(c._owner.layer.mask)&&c.enable){if(t&&(T.treeSpriteCollision+=1,0===e.containsBoundSphere(c.boundingSphere)))continue;c._renderUpdate(a),c._distanceForSort=At.distance(c.boundingSphere.center,n)+c.sortingFudge;var p=c._renderElements;for(o=0,h=p.length;o<h;o++){var u=p[o],d=u._staticBatch;if(d&&d._material===u._material)d._addBatchRenderElement(u);else{var _=u.renderObj;_.triangleCount<10&&1===_._vertexBufferCount&&_._getIndexBuffer()&&u._material.renderQueue<2&&u._canDynamicBatch&&!c._owner.isStatic?l._addPrepareRenderElement(u):this._scene.getRenderQueue(u._material.renderQueue)._addRenderElement(u)}}}}for(r=0;r<8;r++){var m=this._children[r];if(null!=m){var f=t;if(t){var g=e.containsBoundBox(m._relaxBox);if(T.treeNodeCollision+=1,0===g)continue;f=2===g}m.cullingObjects(e,f,i,n,a)}}},t.cullingShadowObjects=function(e,t,i,n,a){var r=0,o=0,s=0,h=0;this._scene._dynamicBatchManager;for(r=0,s=this._objects.length;r<s;r++){var l=this._objects[r];if(l.castShadow&&X.isVisible(l._owner.layer.mask)&&l.enable){if(i&&0===e[0].containsBoundSphere(l.boundingSphere))continue;for(var c=1,p=e.length;c<p;c++){var u=t[c-1];if(0!==e[c].containsBoundSphere(l.boundingSphere)){var d=l._renderElements;for(o=0,h=d.length;o<h;o++)u._addRenderElement(d[o])}}}}for(r=0;r<8;r++){var _=this._children[r];if(null!=_){var m=i;if(i){var f=e[0].containsBoundBox(_._relaxBox);if(0===f)continue;m=2===f}_.cullingShadowObjects(e,t,m,n,a)}}},t.cullingShadowObjectsOnePSSM=function(e,t,i,n,a,r){var o=t[0],s=0,h=0,l=0,c=0;for(s=0,l=this._objects.length;s<l;s++){var p=this._objects[s];if(p.castShadow&&X.isVisible(p._owner.layer.mask)&&p.enable){if(n&&0===e.containsBoundSphere(p.boundingSphere))continue;p._renderUpdate(i);var u=p._renderElements;for(h=0,c=u.length;h<c;h++)o._addRenderElement(u[h])}}for(s=0;s<8;s++){var d=this._children[s];if(null!=d){var _=n;if(n){var m=e.containsBoundBox(d._relaxBox);if(0===m)continue;_=2===m}d.cullingShadowObjectsOnePSSM(e,t,i,_,a,r)}}},t.renderBoudingBox=function(e){this._renderBoudingBox(e);for(var t=0;t<8;++t){var i=this._children[t];i&&i.renderBoudingBox(e)}},t.buildAllChild=function(e){if(e<this._scene.treeLevel)for(var t=0;t<8;t++){this.addChild(t).buildAllChild(e+1)}},t._renderBoudingBox=function(e){},r(0,t,"exactBox",function(){return this._exactBox},function(e){this._exactBox=e,At.add(e.min,e.max,this._boundingBoxCenter),At.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter)}),r(0,t,"relaxBox",function(){return this._relaxBox},function(e){this._relaxBox=e,e.getCorners(this._corners),wt.createfromPoints(this._corners,this._boundingSphere)}),e.debugMode=!1,e.relax=1.15,e.CHILDNUM=8,n(e,["tempVector0",function(){return this.tempVector0=new At},"tempSize",function(){return this.tempSize=new At},"tempCenter",function(){return this.tempCenter=new At},"_octreeSplit",function(){return this._octreeSplit=[new At(.25,.25,.25),new At(.75,.25,.25),new At(.25,.75,.25),new At(.75,.75,.25),new At(.25,.25,.75),new At(.75,.25,.75),new At(.25,.75,.75),new At(.75,.75,.75)]}]),e}(),_e=(function(){function e(){}a(e,"laya.d3.core.scene.SceneManager")}(),function(){function e(e,t,i,n){this._r=NaN,this._g=NaN,this._b=NaN,this._a=NaN,void 0===e&&(e=1),void 0===t&&(t=1),void 0===i&&(i=1),void 0===n&&(n=1),this._r=e,this._g=t,this._b=i,this._a=n}a(e,"laya.d3.core.trail.module.Color",null,"Color$1");return e.prototype.cloneTo=function(e){e._r=this._r,e._g=this._g,e._b=this._b,e._a=this._a},n(e,["RED",function(){return this.RED=new e(1,0,0,1)},"GREEN",function(){return this.GREEN=new e(0,1,0,1)},"BLUE",function(){return this.BLUE=new e(0,0,1,1)},"CYAN",function(){return this.CYAN=new e(0,1,1,1)},"YELLOW",function(){return this.YELLOW=new e(1,.92,.016,1)},"MAGENTA",function(){return this.MAGENTA=new e(1,0,1,1)},"GRAY",function(){return this.GRAY=new e(.5,.5,.5,1)},"WHITE",function(){return this.WHITE=new e(1,1,1,1)},"BLACK",function(){return this.BLACK=new e(0,0,0,1)}]),e}()),me=function(){function e(){this._mode=0,this._colorKeys=null,this._alphaKeys=null,this.index=0,this._colorKeyData=new Float32Array(40),this._alphaKeyData=new Float32Array(20),this._colorKeys=[],this._alphaKeys=[]}a(e,"laya.d3.core.trail.module.Gradient");var t=e.prototype;return t.setKeys=function(e,t){this._colorKeys=e,this.index=0;for(var i,n=0;n<e.length;n++){var a=(i=e[n]).color;this._colorKeyData[this.index++]=a._r,this._colorKeyData[this.index++]=a._g,this._colorKeyData[this.index++]=a._b,this._colorKeyData[this.index++]=i.time}this._alphaKeys=t,this.index=0;for(var r,o=0;o<t.length;o++)r=t[o],this._alphaKeyData[this.index++]=r.alpha,this._alphaKeyData[this.index++]=r.time},t.cloneTo=function(e){var t=0,i=0,n=this.colorKeys,a=[];for(t=0,i=n.length;t<i;t++){var r=new ge;n[t].cloneTo(r),a.push(r)}var o=this.alphaKeys,s=[];for(t=0,i=o.length;t<i;t++){var h=new fe;o[t].cloneTo(h),s.push(h)}e.setKeys(a,s)},r(0,t,"mode",function(){return this._mode},function(e){this._mode=e}),r(0,t,"colorKeys",function(){return this._colorKeys},function(e){this._colorKeys=e,this.index=0;for(var t=0;t<e.length;t++){var i=e[t],n=i.color;this._colorKeyData[this.index++]=n._r,this._colorKeyData[this.index++]=n._g,this._colorKeyData[this.index++]=n._b,this._colorKeyData[this.index++]=i.time}}),r(0,t,"alphaKeys",function(){return this._alphaKeys},function(e){this._alphaKeys=e,this.index=0;for(var t=0;t<e.length;t++){var i=e[t];this._alphaKeyData[this.index++]=i.alpha,this._alphaKeyData[this.index++]=i.time}}),e}(),fe=function(){function e(e,t){this._alpha=NaN,this._time=NaN,void 0===e&&(e=0),void 0===t&&(t=0),this._alpha=e,this._time=t}a(e,"laya.d3.core.trail.module.GradientAlphaKey");var t=e.prototype;return t.cloneTo=function(e){e.alpha=this.alpha,e.time=this.time},r(0,t,"alpha",function(){return this._alpha},function(e){this._alpha=e}),r(0,t,"time",function(){return this._time},function(e){this._time=e}),e}(),ge=function(){function e(e,t){this._color=null,this._time=NaN,void 0===t&&(t=0),this._color=e||new _e,this._time=t}a(e,"laya.d3.core.trail.module.GradientColorKey");var t=e.prototype;return t.cloneTo=function(e){this.color.cloneTo(e.color),e.time=this.time},r(0,t,"color",function(){return this._color},function(e){this._color=e}),r(0,t,"time",function(){return this._time},function(e){this._time=e}),e}(),ye=(function(){function e(){}a(e,"laya.d3.core.trail.module.GradientMode"),e.Blend=0,e.Fixed=1}(),function(){function e(){}a(e,"laya.d3.core.trail.module.TextureMode"),e.Stretch=0,e.Tile=1}(),function(){function e(){this.time=NaN,this.inTangent=NaN,this.outTangent=NaN,this.value=NaN}a(e,"laya.d3.core.trail.module.TrailKeyFrame");return e.prototype.cloneTo=function(e){e.time=this.time,e.inTangent=this.inTangent,e.outTangent=this.outTangent,e.value=this.value},e}()),ve=function(){function e(t){this._id=0,this._owner=null,this._camera=null,this._vertexBuffers=null,this._verticesCount=0,this._virtualVerticesCount=0,this._maxVerticesCount=256,this._vertices1=null,this._vertexBuffer1=null,this._floatCountPerVertices1=8,this._verticesIndex1=0,this._everyAddVerticeCount1=0,this._delLength=0,this._vertices2=null,this._vertexBuffer2=null,this._floatCountPerVertices2=1,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._pointe=null,this._pointAtoBVector3e=null,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._curtime=NaN,this._curDisappearIndex=0,this._lastPosition=new At,this._curPosition=new At,this._delVector3=new At,this._lastFixedVertexPosition=new At,this._pointAtoBVector3=new At,this._pointA=new At,this._pointB=new At,this._owner=t,this._id=e.renderElementCount++,0==this._id?t._owner.transform.position.cloneTo(this._lastPosition):t._curSubTrailFinishPosition.cloneTo(this._lastPosition),this._everyGroupVertexBirthTime=[],this._VerticesToTailLength=new Float32Array(this._maxVerticesCount),this._everyVertexToPreVertexDistance=new Float32Array(this._maxVerticesCount),this._vertices1=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices1),this._vertices2=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices2),this._vertexBuffer1=new qi(xe.vertexDeclaration1,this._maxVerticesCount,35044,!0),this._vertexBuffer2=new qi(xe.vertexDeclaration2,this._maxVerticesCount,35044,!0),this._vertexBuffers=[],this._vertexBuffers.push(this._vertexBuffer1),this._vertexBuffers.push(this._vertexBuffer2)}a(e,"laya.d3.core.trail.TrailRenderElement");var t=e.prototype;return i.imps(t,{"laya.d3.core.render.IRenderable":!0}),t._updateTrail=function(){this._everyAddVerticeCount1=0,this._isStart||this._addTrailByFirstPosition(this._lastPosition,this._curPosition),this._addTrailByNextPosition(this._curPosition),this._vertexBuffer1.setData(this._vertices1,this._verticesIndex1,this._verticesIndex1,this._everyAddVerticeCount1),this._verticesIndex1+=this._everyAddVerticeCount1,this._curPosition.cloneTo(this._lastPosition),2==this._virtualVerticesCount&&(this._verticesIndex1-=2*this._floatCountPerVertices1)},t._addTrailByFirstPosition=function(e,t){At.subtract(t,e,this._delVector3),At.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),At.normalize(this._pointAtoBVector3,this._pointAtoBVector3),At.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._updateVerticesByPosition(e),e.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._curtime=this._owner._hasLifeSubTrail?this._owner._curSubTrailFinishCurTime:this._owner._curtime,this._everyGroupVertexBirthTime.push(this._curtime),this._isStart=!0,this._owner._hasLifeSubTrail=!0},t._addTrailByNextPosition=function(e){At.subtract(e,this._lastFixedVertexPosition,this._delVector3),At.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),At.normalize(this._pointAtoBVector3,this._pointAtoBVector3),At.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._delLength=At.scalarLength(this._delVector3),this._delLength-this._owner.minVertexDistance>=It.zeroTolerance?(this._owner._trailTotalLength+=this._delLength,this._owner._trailSupplementLength=0,this._updateVerticesByPosition(e),e.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._virtualVerticesCount=0,this._everyGroupVertexBirthTime.push(this._owner._curtime),this._verticesCount==this._maxVerticesCount&&this._onTrailRenderElementFinish()):(this._owner._trailSupplementLength=this._delLength,this._updateVerticesByPosition(e),this._virtualVerticesCount=2)},t._updateVerticesByPosition=function(e){this._pointe=e.elements,this._pointAtoBVector3e=this._pointAtoBVector3.elements,this._curtime=this._owner._curtime,this._owner._hasLifeSubTrail&&0==this._isStart&&(this._pointe=this._owner._curSubTrailFinishPosition.elements,this._pointAtoBVector3e=this._owner._curSubTrailFinishDirection.elements,this._curtime=this._owner._curSubTrailFinishCurTime),this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=1,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=0,this._VerticesToTailLength[this._verticesCount/2]=this._owner._trailTotalLength+this._owner._trailSupplementLength,0==this._owner._trailSupplementLength?this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._delLength:this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._isStart?this._owner._trailSupplementLength:0},t._updateVertexBuffer2=function(){var e=0,t=0,i=0,n=0;for(i=0,n=(this._verticesCount+this._virtualVerticesCount)/2;i<n;i++)t=0==this._owner.textureMode?(this._VerticesToTailLength[i]-this._owner._trailDeadLength)/(this._owner._trailTotalLength+this._owner._trailSupplementLength-this._owner._trailDeadLength):this._owner._trailTotalLength+this._owner._trailSupplementLength-this._VerticesToTailLength[i],this._vertices2[e++]=1-t,this._vertices2[e++]=1-t;this._vertexBuffer2.setData(this._vertices2,0,0,this._verticesCount+this._virtualVerticesCount)},t._onTrailRenderElementFinish=function(){this._lastFixedVertexPosition.cloneTo(this._owner._curSubTrailFinishPosition),this._pointAtoBVector3.cloneTo(this._owner._curSubTrailFinishDirection),this._owner._curSubTrailFinishCurTime=this._owner._curtime,this._isFinish=!0},t._updateDisappear=function(){var e=0,t=0;for(e=this._curDisappearIndex,t=(this._verticesCount+this._virtualVerticesCount)/2;e<t;e++)this._owner._curtime-this._everyGroupVertexBirthTime[e]>=this._owner.time+It.zeroTolerance&&(this._curDisappearIndex++,this._owner._trailDeadLength+=this._everyVertexToPreVertexDistance[this._curDisappearIndex],this._curDisappearIndex>=(this._verticesCount+this._virtualVerticesCount)/2&&(this._isDead=!0))},t._beforeRender=function(e){return this._camera=e.camera,null!=this._camera&&(this._owner._owner.transform.position.cloneTo(this._curPosition),!this._isDead&&(this._verticesCount<this._maxVerticesCount?(this._owner._isStart||(this._owner._owner.transform.position.cloneTo(this._lastPosition),this._owner._isStart=!0),At.equals(this._lastPosition,this._curPosition)||this._updateTrail()):this._isFinish&&(this._isFinish=!1,this._owner._curSubTrailFinished=!0),this._verticesCount>0)&&(this._updateVertexBuffer2(),this._updateDisappear(),!0))},t._render=function(e){this._isDead||(A.mainContext.drawArrays(5,2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),console.log(2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),T.drawCall++,T.trianglesFaces+=this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex-2)},t._getVertexBuffer=function(e){return void 0===e&&(e=0),0===e?this._vertexBuffer1:1===e?this._vertexBuffer2:null},t._getVertexBuffers=function(){return this._vertexBuffers},t._getIndexBuffer=function(){return null},t.reActivate=function(){this._id=laya.d3.core.trail.TrailRenderElement.renderElementCount++,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._verticesCount=0,this._virtualVerticesCount=0,this._verticesIndex1=0,this._delLength=0,this._curDisappearIndex=0,this._everyGroupVertexBirthTime=[],this._owner._curSubTrailFinishPosition.cloneTo(this._lastPosition)},t._destroy=function(){this._vertexBuffer1.dispose(),this._vertexBuffer2.dispose(),this._vertices1=null,this._vertexBuffer1=null,this._vertices2=null,this._vertexBuffer2=null,this._vertexBuffers=null,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._lastPosition=null,this._curPosition=null,this._delVector3=null,this._lastFixedVertexPosition=null,this._pointAtoBVector3=null,this._pointe=null,this._pointAtoBVector3e=null,this._pointA=null,this._pointB=null},r(0,t,"_vertexBufferCount",function(){return this._vertexBuffers.length}),r(0,t,"triangleCount",function(){return 0}),e.renderElementCount=0,e}(),xe=function(){function e(){}a(e,"laya.d3.core.trail.VertexTrail");var t=e.prototype;return i.imps(t,{"laya.d3.graphics.IVertex":!0}),r(0,t,"vertexDeclaration",function(){return e._vertexDeclaration1}),r(1,e,"vertexDeclaration1",function(){return e._vertexDeclaration1}),r(1,e,"vertexDeclaration2",function(){return e._vertexDeclaration2}),n(e,["_vertexDeclaration1",function(){return this._vertexDeclaration1=new Ce(32,[new ke(0,"vector3",0),new ke(12,"vector3",41),new ke(24,"single",33),new ke(28,"single",40)])},"_vertexDeclaration2",function(){return this._vertexDeclaration2=new Ce(4,[new ke(0,"single",38)])}]),e}(),be=function(){function e(e){this._vertexDeclaration=null,this._vertexDatas=null,this._indexDatas=null,this._vertexBuffer=null,this._indexBuffer=null,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=null,this._materials=null,this._materialToRenderElementsOffsets=null,this._merageElements=null,this._combineRenderElementPool=null,this._combineRenderElementPoolIndex=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=[],this._materialToRenderElementsOffsets=[],this._materials=[],this._merageElements=[],this._combineRenderElementPool=[],this._combineRenderElementPoolIndex=0,this._vertexDeclaration=e}a(e,"laya.d3.graphics.DynamicBatch");var t=e.prototype;return i.imps(t,{"laya.d3.core.render.IRenderable":!0}),t._getVertexBuffer=function(e){return void 0===e&&(e=0),0===e?this._vertexBuffer:null},t._getIndexBuffer=function(){return this._indexBuffer},t._getCombineRenderElementFromPool=function(e,t,i){var n=this._combineRenderElementPool[this._combineRenderElementPoolIndex++];return n||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=n=new ce,n._sprite3D=new gn),n._sprite3D._render._renderUpdate(i),n},t._getRenderElement=function(t,i,n){this._vertexDatas||(this._vertexDatas=new Float32Array(this._vertexDeclaration.vertexStride/4*e.maxVertexCount),this._indexDatas=new Uint16Array(e.maxIndexCount),this._vertexBuffer=qi.create(this._vertexDeclaration,e.maxVertexCount,35048),this._indexBuffer=Wi.create("ushort",e.maxIndexCount,35048)),this._merageElements.length=0;for(var a=0,r=0,o=0,s=this._combineRenderElements.length;o<s;o++){var h=this._combineRenderElements[o],l=h.getDynamicBatchBakedVertexs(0),c=h.getBakedIndices(),p=h._sprite3D.transform._isFrontFaceInvert,u=a/(this._vertexDeclaration.vertexStride/4),d=r,_=d+c.length;h._tempBatchIndexStart=d,h._tempBatchIndexEnd=_,this._indexDatas.set(c,r);var m=0;if(p)for(m=d;m<_;m+=3){this._indexDatas[m]=u+this._indexDatas[m];var f=this._indexDatas[m+1],g=this._indexDatas[m+2];this._indexDatas[m+1]=u+g,this._indexDatas[m+2]=u+f}else for(m=d;m<_;m+=3)this._indexDatas[m]=u+this._indexDatas[m],this._indexDatas[m+1]=u+this._indexDatas[m+1],this._indexDatas[m+2]=u+this._indexDatas[m+2];r+=c.length,this._vertexDatas.set(l,a),a+=l.length}for(this._vertexBuffer.setData(this._vertexDatas),this._indexBuffer.setData(this._indexDatas),this._combineRenderElementPoolIndex=0,o=0,s=this._materials.length;o<s;o++){var y=this._getCombineRenderElementFromPool(t,i,n);y._type=2,y._staticBatch=null,y.renderObj=this;var v=this._combineRenderElements[this._materialToRenderElementsOffsets[o]]._tempBatchIndexStart,x=o+1===this._materialToRenderElementsOffsets.length?r:this._combineRenderElements[this._materialToRenderElementsOffsets[o+1]]._tempBatchIndexStart;y._tempBatchIndexStart=v,y._tempBatchIndexEnd=x,y._material=this._materials[o],this._merageElements.push(y)}},t._addCombineRenderObjTest=function(t){var i=t.renderObj,n=this._currentCombineIndexCount+i._getIndexBuffer().indexCount;return!(this._currentCombineVertexCount+i._getVertexBuffer().vertexCount>e.maxVertexCount||n>e.maxIndexCount)},t._addCombineRenderObj=function(e){var t=e.renderObj;this._combineRenderElements.push(e),this._currentCombineIndexCount=this._currentCombineIndexCount+t._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+t._getVertexBuffer().vertexCount},t._addCombineMaterial=function(e){this._materials.push(e)},t._addMaterialToRenderElementOffset=function(e){this._materialToRenderElementsOffsets.push(e)},t._clearRenderElements=function(){this._combineRenderElements.length=0,this._materials.length=0,this._materialToRenderElementsOffsets.length=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0},t._addToRenderQueue=function(e,t,i,n){this._getRenderElement(t,i,n);for(var a=0,r=this._materials.length;a<r;a++)e.getRenderQueue(this._materials[a].renderQueue)._addDynamicBatchElement(this._merageElements[a])},t._beforeRender=function(e){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},t._render=function(e){var t=e._batchIndexEnd-e._batchIndexStart;A.mainContext.drawElements(4,t,5123,2*e._batchIndexStart),T.drawCall++,T.trianglesFaces+=t/3},t._getVertexBuffers=function(){return null},r(0,t,"_vertexBufferCount",function(){return 1}),r(0,t,"triangleCount",function(){return this._indexBuffer.indexCount/3}),r(0,t,"combineRenderElementsCount",function(){return this._combineRenderElements.length}),e.maxVertexCount=2e4,e.maxIndexCount=4e4,e.maxCombineTriangleCount=10,e}(),we=function(){function e(){this._dynamicBatches=null,this._prepareDynamicBatchCombineElements=null,this._dynamicBatches={},this._prepareDynamicBatchCombineElements=[]}a(e,"laya.d3.graphics.DynamicBatchManager");var t=e.prototype;return t.getDynamicBatch=function(e,t){var i,n=e.id.toString()+t;return this._dynamicBatches[n]?i=this._dynamicBatches[n]:this._dynamicBatches[n]=i=new be(e),i},t._garbageCollection=function(){for(var e in this._dynamicBatches)0===this._dynamicBatches[e].combineRenderElementsCount&&delete this._dynamicBatches[e]},t._addPrepareRenderElement=function(e){this._prepareDynamicBatchCombineElements.push(e)},t._finishCombineDynamicBatch=function(t){this._prepareDynamicBatchCombineElements.sort(e._sortPrepareDynamicBatch);for(var i,n,a,r,o,s,h,l,c=-1,p=!0,u=0,d=-1,_=0,m=this._prepareDynamicBatchCombineElements.length;_<m;_++){var f=(o=this._prepareDynamicBatchCombineElements[_]).renderObj._getVertexBuffer(0).vertexDeclaration,g=n!==f;g&&(u=0,n=f);var y=u!==c;if(y&&(c=u),(g||y)&&(s=this.getDynamicBatch(f,u),i=null),p)if(s._addCombineRenderObjTest(o)){if(r=o._material,i!==r)h&&(t.getRenderQueue(l._material.renderQueue)._addRenderElement(l),h=null,l=null,d=-1),h=r,d=s.combineRenderElementsCount,l=o,i=r;else if(h){var v=l.renderObj,x=o.renderObj;v._getVertexBuffer().vertexCount+x._getVertexBuffer().vertexCount>be.maxVertexCount||v._getIndexBuffer().indexCount+x._getIndexBuffer().indexCount>be.maxIndexCount?(t.getRenderQueue(l._material.renderQueue)._addRenderElement(l),h=r,d=s.combineRenderElementsCount,l=o):(s._addCombineMaterial(h),s._addMaterialToRenderElementOffset(d),s._addCombineRenderObj(l),h=null,l=null,d=-1,s._addCombineRenderObj(o))}else s._addCombineRenderObj(o);p=!0}else h&&(t.getRenderQueue(l._material.renderQueue)._addRenderElement(l),h=null,l=null,d=-1),u++,p=!1;else a=this._prepareDynamicBatchCombineElements[_-1],s._addMaterialToRenderElementOffset(s.combineRenderElementsCount),i=a._material,s._addCombineMaterial(i),s._addCombineRenderObj(a),p=!0,i!==(r=o._material)?(h=r,d=s.combineRenderElementsCount,l=o):s._addCombineRenderObj(o),i=r}h&&(t.getRenderQueue(l._material.renderQueue)._addRenderElement(l),h=null,l=null,d=-1),this._prepareDynamicBatchCombineElements.length=0},t._clearRenderElements=function(){for(var e in this._dynamicBatches)this._dynamicBatches[e]._clearRenderElements()},t._addToRenderQueue=function(e,t,i,n){for(var a in this._dynamicBatches){var r=this._dynamicBatches[a];r.combineRenderElementsCount>0&&r._addToRenderQueue(e,t,i,n)}},t.dispose=function(){this._dynamicBatches=null},e._sortPrepareDynamicBatch=function(e,t){return e._mainSortID-t._mainSortID},e}(),Se=function(){function e(){}return a(e,"laya.d3.graphics.FrustumCulling"),e.renderShadowObjectCulling=function(e,t,i,n,a){var r=0,o=0,s=0,h=0;for(r=0,s=i.length;r<s;r++){var l=i[r];l&&l._clearRenderElements()}var c,p,u,d=e._cullingRenders;if(a>1){for(r=0,s=e._cullingRendersLength;r<s;r++)if((c=d[r]).castShadow&&X.isVisible(c._owner.layer.mask)&&c.enable)for(var _=1,m=t.length;_<m;_++)if(p=i[_-1],0!==t[_].containsBoundSphere(c.boundingSphere))for(o=0,h=(u=c._renderElements).length;o<h;o++)p._addRenderElement(u[o])}else for(r=0,s=e._cullingRendersLength;r<s;r++)if((c=d[r]).castShadow&&X.isVisible(c._owner.layer.mask)&&c.enable&&0!==t[0].containsBoundSphere(c.boundingSphere))for(c._renderUpdate(n),p=i[0],o=0,h=(u=c._renderElements).length;o<h;o++)p._addRenderElement(u[o])},e.renderShadowObjectCullingOctree=function(e,t,i,n,a){for(var r=0,o=i.length;r<o;r++){var s=i[r];s&&s._clearRenderElements()}a>1?e.treeRoot.cullingShadowObjects(t,i,!0,0,e):e.treeRoot.cullingShadowObjectsOnePSSM(t[0],i,n,!0,0,e)},e.renderObjectCulling=function(e,t,i,n,a,r){var o=0,s=0,h=0,l=0,c=t._quenes,p=t._dynamicBatchManager,u=t._cullingRenders;for(o=0,s=c.length;o<s;o++){var d=c[o];d&&d._clearRenderElements()}var _=Ie._staticBatchManagers;for(o=0,s=_.length;o<s;o++)_[o]._clearRenderElements();p._clearRenderElements();var m=i.transform.position;for(o=0,s=t._cullingRendersLength;o<s;o++){var f=u[o];if(X.isVisible(f._owner.layer.mask)&&f.enable&&0!==e.containsBoundSphere(f.boundingSphere)&&f._renderUpdate(r)){f._distanceForSort=At.distance(f.boundingSphere.center,m)+f.sortingFudge;var g=f._renderElements;for(h=0,l=g.length;h<l;h++){var y=g[h],v=y._staticBatch;if(v&&v._material===y._material)v._addBatchRenderElement(y);else{var x=y.renderObj;x.triangleCount<10&&1===x._vertexBufferCount&&x._getIndexBuffer()&&y._material.renderQueue<2&&y._canDynamicBatch&&!f._owner.isStatic?p._addPrepareRenderElement(y):t.getRenderQueue(y._material.renderQueue)._addRenderElement(y)}}}}for(o=0,s=_.length;o<s;o++)_[o]._addToRenderQueue(t,n,a,r);p._finishCombineDynamicBatch(t),p._addToRenderQueue(t,n,a,r)},e.renderObjectCullingOctree=function(e,t,i,n,a,r){var o=0,s=0,h=t._quenes,l=t._dynamicBatchManager;for(o=0,s=h.length;o<s;o++){var c=h[o];c&&c._clearRenderElements()}var p=Ie._staticBatchManagers;for(o=0,s=p.length;o<s;o++)p[o]._clearRenderElements();for(l._clearRenderElements(),t._cullingRenders.length=0,t.treeRoot.cullingObjects(e,!0,0,i.transform.position,r),o=0,s=p.length;o<s;o++)p[o]._addToRenderQueue(t,n,a,r);l._finishCombineDynamicBatch(t),l._addToRenderQueue(t,n,a,r)},e.renderObjectCullingNoBoundFrustum=function(e,t,i,n,a){var r=0,o=0,s=0,h=0,l=e._quenes,c=e._dynamicBatchManager,p=e._cullingRenders;for(r=0,o=l.length;r<o;r++){var u=l[r];u&&u._clearRenderElements()}var d=Ie._staticBatchManagers;for(r=0,o=d.length;r<o;r++)d[r]._clearRenderElements();c._clearRenderElements();var _=t.transform.position;for(r=0,o=e._cullingRendersLength;r<o;r++){var m=p[r];if(X.isVisible(m._owner.layer.mask)&&m.enable){m._renderUpdate(a),m._distanceForSort=At.distance(m.boundingSphere.center,_)+m.sortingFudge;var f=m._renderElements;for(s=0,h=f.length;s<h;s++){var g=f[s],y=g._staticBatch;if(y&&y._material===g._material)y._addBatchRenderElement(g);else{var v=g.renderObj;v.triangleCount<10&&1===v._vertexBufferCount&&v._getIndexBuffer()&&g._material.renderQueue<2&&g._canDynamicBatch&&!m._owner.isStatic?c._addPrepareRenderElement(g):e.getRenderQueue(g._material.renderQueue)._addRenderElement(g)}}}}for(r=0,o=d.length;r<o;r++)d[r]._addToRenderQueue(e,i,n,a);c._finishCombineDynamicBatch(e),c._addToRenderQueue(e,i,n,a)},e}(),Ie=function(){function e(){this._initBatchRenderElements=null,this._staticBatches=null,this._initBatchRenderElements=[],this._staticBatches={}}a(e,"laya.d3.graphics.StaticBatchManager");var t=e.prototype;return t._finishInit=function(){for(var e in this._staticBatches)this._staticBatches[e]._finishInit();this._initBatchRenderElements.length=0},t._initStaticBatchs=function(e){throw new Error("StaticBatchManager:must override this function.")},t._addInitBatchSprite=function(e){for(var t=e._render._renderElements,i=0,n=t.length;i<n;i++)this._initBatchRenderElements.push(t[i])},t._clearRenderElements=function(){for(var e in this._staticBatches)this._staticBatches[e]._clearRenderElements()},t._garbageCollection=function(e){var t=e._staticBatch,i=t._initBatchRenderElements,n=i.indexOf(e);i.splice(n,1),0===i.length&&(t.dispose(),delete this._staticBatches[t._key])},t._addToRenderQueue=function(e,t,i,n){for(var a in this._staticBatches){var r=this._staticBatches[a];r._batchRenderElements.length>0&&r._updateToRenderQueue(e,n)}},t.dispose=function(){this._staticBatches=null},e._addToStaticBatchQueue=function(t){t instanceof laya.d3.core.RenderableSprite3D&&t._addToInitStaticBatchManager();for(var i=0,n=t.numChildren;i<n;i++)e._addToStaticBatchQueue(t._childs[i])},e.combine=function(t,i){var n,a=0,r=0;if(i)for(a=0,r=i.length;a<r;a++){i[a]._addToInitStaticBatchManager()}else t&&e._addToStaticBatchQueue(t);for(a=0,r=e._staticBatchManagers.length;a<r;a++)(n=e._staticBatchManagers[a])._initStaticBatchs(t),n._finishInit()},e._staticBatchManagers=[],e}(),Me=function(){function e(e,t,i){this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=null,this._initBatchRenderElements=null,this._batchRenderElements=null,this._material=null,this._rootOwner=null,this._key=null,this._manager=null,this._key=e,this._manager=t,this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=[],this._initBatchRenderElements=[],this._batchRenderElements=[],this._rootOwner=i}a(e,"laya.d3.graphics.StaticBatch");var t=e.prototype;return i.imps(t,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),t._binarySearch=function(e){for(var t=0,i=this._batchRenderElements.length-1,n=0;t<=i;)n=Math.floor((t+i)/2),this._compareBatchRenderElement(this._batchRenderElements[n],e)?i=n-1:t=n+1;return t},t._compareBatchRenderElement=function(e,t){throw new Error("StaticBatch:must override this function.")},t._getVertexDecLightMap=function(e){return e===rt.vertexDeclaration?et.vertexDeclaration:e===at.vertexDeclaration?$e.vertexDeclaration:e===We.vertexDeclaration?ze.vertexDeclaration:e===lt.vertexDeclaration?null:e===Oe.vertexDeclaration?Ve.vertexDeclaration:e===st.vertexDeclaration?it.vertexDeclaration:e===Ze.vertexDeclaration?Qe.vertexDeclaration:e===ot.vertexDeclaration?tt.vertexDeclaration:e===at.vertexDeclaration?$e.vertexDeclaration:e===qe.vertexDeclaration?Xe.vertexDeclaration:e===lt.vertexDeclaration?null:e===Oe.vertexDeclaration?Ve.vertexDeclaration:e===ht.vertexDeclaration?nt.vertexDeclaration:e===Ze.vertexDeclaration?Qe.vertexDeclaration:e},t._getCombineRenderElementFromPool=function(){throw new Error("StaticBatch:must override this function.")},t._addBatchRenderElement=function(e){this._batchRenderElements.splice(this._binarySearch(e),0,e)},t._updateToRenderQueue=function(e,t){this._combineRenderElementPoolIndex=0,this._getRenderElement(e.getRenderQueue(this._material.renderQueue)._renderElements,e,t)},t._getRenderElement=function(e,t,i){throw new Error("StaticBatch:must override this function.")},t._finishInit=function(){throw new Error("StaticBatch:must override this function.")},t._clearRenderElements=function(){this._batchRenderElements.length=0},t.dispose=function(){},t._getVertexBuffer=function(e){return void 0===e&&(e=0),null},t._getIndexBuffer=function(){return null},t._beforeRender=function(e){return!0},t._render=function(e){},t._getVertexBuffers=function(){return null},r(0,t,"_vertexBufferCount",function(){return 1}),r(0,t,"triangleCount",function(){return 0}),e.combine=function(e){console.log("StaticBatch: discard property,please use StaticBatchManager.combine() function instead."),Ie.combine(e)},e.maxBatchVertexCount=65535,e}(),Ce=function(){function e(t,i){if(this._id=0,this._shaderValues=null,this._shaderDefineValue=0,this._vertexStride=0,this._vertexElements=null,this._vertexElementsDic=null,this._id=++e._uniqueIDCounter,this._id>e.maxVertexDeclaration)throw new Error("VertexDeclaration: VertexDeclaration count should not large than ",e.maxVertexDeclaration);this._shaderValues=new Ft,this._vertexElementsDic={},this._vertexStride=t,this._vertexElements=i;for(var n=0;n<i.length;n++){var a=i[n],r=a.elementUsage;this._vertexElementsDic[r]=a;var o=[e._getTypeSize(a.elementFormat)/4,5126,!1,this._vertexStride,a.offset];switch(this._shaderValues.setValue(r,o),r){case 1:this._addShaderDefine(ci.SHADERDEFINE_COLOR);break;case 2:this._addShaderDefine(ci.SHADERDEFINE_UV0);break;case 15:this._addShaderDefine(ci.SHADERDEFINE_UV1)}}}a(e,"laya.d3.graphics.VertexDeclaration");var t=e.prototype;return t._addShaderDefine=function(e){this._shaderDefineValue|=e},t._removeShaderDefine=function(e){this._shaderDefineValue&=~e},t.getVertexElements=function(){return this._vertexElements.slice()},t.getVertexElementByUsage=function(e){return this._vertexElementsDic[e]},t.unBinding=function(){},r(0,t,"shaderDefineValue",function(){return this._shaderDefineValue}),r(0,t,"id",function(){return this._id}),r(0,t,"vertexStride",function(){return this._vertexStride}),r(0,t,"shaderValues",function(){return this._shaderValues}),e._getTypeSize=function(e){switch(e){case"single":return 4;case"vector2":return 8;case"vector3":return 12;case"vector4":return 16;case"color":case"byte4":case"short2":return 4;case"short4":return 8;case"normalizedshort2":return 4;case"normalizedshort4":return 8;case"halfvector2":return 4;case"halfvector4":return 8}return 0},e.getVertexStride=function(t){for(var i=0,n=0;n<t.Length;n++){var a=t[n],r=a.offset+e._getTypeSize(a.elementFormat);i<r&&(i=r)}return i},e._maxVertexDeclarationBit=1e3,e._uniqueIDCounter=1,n(e,["maxVertexDeclaration",function(){return this.maxVertexDeclaration=2147483647-1e3*Math.floor(2147483.647)}]),e}(),ke=function(){function e(e,t,i){this.offset=0,this.elementFormat=null,this.elementUsage=0,this.offset=e,this.elementFormat=t,this.elementUsage=i}return a(e,"laya.d3.graphics.VertexElement"),e}(),Ee=(function(){function e(){}a(e,"laya.d3.graphics.VertexElementFormat"),e.Single="single",e.Vector2="vector2",e.Vector3="vector3",e.Vector4="vector4",e.Color="color",e.Byte4="byte4",e.Short2="short2",e.Short4="short4",e.NormalizedShort2="normalizedshort2",e.NormalizedShort4="normalizedshort4",e.HalfVector2="halfvector2",e.HalfVector4="halfvector4"}(),function(){function e(){}a(e,"laya.d3.graphics.VertexElementUsage"),e.POSITION0=0,e.COLOR0=1,e.TEXTURECOORDINATE0=2,e.NORMAL0=3,e.BINORMAL0=4,e.TANGENT0=5,e.BLENDINDICES0=6,e.BLENDWEIGHT0=7,e.DEPTH0=8,e.FOG0=9,e.POINTSIZE0=10,e.SAMPLE0=11,e.TESSELLATEFACTOR0=12,e.COLOR1=13,e.NEXTTEXTURECOORDINATE0=14,e.TEXTURECOORDINATE1=15,e.NEXTTEXTURECOORDINATE1=16,e.CORNERTEXTURECOORDINATE0=17,e.VELOCITY0=18,e.STARTCOLOR0=19,e.STARTSIZE=20,e.AGEADDSCALE0=21,e.STARTROTATION=22,e.ENDCOLOR0=23,e.STARTLIFETIME=24,e.TIME0=33,e.SHAPEPOSITIONSTARTLIFETIME=30,e.DIRECTIONTIME=32,e.SIZEROTATION0=27,e.RADIUS0=28,e.RADIAN0=29,e.STARTSPEED=31,e.RANDOM0=34,e.RANDOM1=35,e.SIMULATIONWORLDPOSTION=36,e.SIMULATIONWORLDROTATION=37,e.TEXTURECOORDINATE0X=38,e.TEXTURECOORDINATE0X1=39,e.TEXTURECOORDINATE0Y=40,e.OFFSETVECTOR=41}(),function(){function e(e,t,i){this._position=null,this._textureCoordinate0=null,this._time=NaN,this._position=e,this._textureCoordinate0=t,this._time=i}a(e,"laya.d3.graphics.VertexGlitter");var t=e.prototype;return i.imps(t,{"laya.d3.graphics.IVertex":!0}),r(0,t,"textureCoordinate",function(){return this._textureCoordinate0}),r(0,t,"position",function(){return this._position}),r(0,t,"time",function(){return this._time}),r(0,t,"vertexDeclaration",function(){return e._vertexDeclaration}),r(1,e,"vertexDeclaration",function(){return e._vertexDeclaration}),n(e,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ce(24,[new ke(0,"vector3",0),new ke(12,"vector2",2),new ke(20,"single",33)])}]),e}()),Te=(function(){function e(e,t,i,n,a,r,o,s,h,l){this._cornerTextureCoordinate=null,this._position=null,this._velocity=null,this._startColor=null,this._endColor=null,this._sizeRotation=null,this._radius=null,this._radian=null,this._ageAddScale=NaN,this._time=NaN,this._cornerTextureCoordinate=e,this._position=t,this._velocity=i,this._startColor=n,this._endColor=a,this._sizeRotation=r,this._radius=o,this._radian=s,this._ageAddScale=h,this._time=l}a(e,"laya.d3.graphics.VertexParticle");var t=e.prototype;i.imps(t,{"laya.d3.graphics.IVertex":!0}),r(0,t,"endColor",function(){return this._endColor}),r(0,t,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),r(0,t,"sizeRotation",function(){return this._sizeRotation}),r(0,t,"velocity",function(){return this._velocity}),r(0,t,"position",function(){return this._position}),r(0,t,"startColor",function(){return this._startColor}),r(0,t,"radius",function(){return this._radius}),r(0,t,"radian",function(){return this._radian}),r(0,t,"ageAddScale",function(){return this._ageAddScale}),r(0,t,"time",function(){return this._time}),r(0,t,"vertexDeclaration",function(){return e._vertexDeclaration}),r(1,e,"vertexDeclaration",function(){return e._vertexDeclaration}),n(e,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ce(116,[new ke(0,"vector4",17),new ke(16,"vector3",0),new ke(28,"vector3",18),new ke(40,"vector4",19),new ke(56,"vector4",23),new ke(72,"vector3",27),new ke(84,"vector2",28),new ke(92,"vector4",29),new ke(108,"single",24),new ke(112,"single",33)])}])}(),function(){function e(e){this._position=null,this._position=e}a(e,"laya.d3.graphics.VertexPosition");var t=e.prototype;return i.imps(t,{"laya.d3.graphics.IVertex":!0}),r(0,t,"position",function(){return this._position}),r(0,t,"vertexDeclaration",function(){return e._vertexDeclaration}),r(1,e,"vertexDeclaration",function(){return e._vertexDeclaration}),n(e,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ce(12,[new ke(0,"vector3",0)])}]),e}()),Le=function(){function e(e,t){this._position=null,this._normal=null,this._position=e,this._normal=t}a(e,"laya.d3.graphics.VertexPositionNormal");var t=e.prototype;return i.imps(t,{"laya.d3.graphics.IVertex":!0}),r(0,t,"normal",function(){return this._normal}),r(0,t,"position",function(){return this._position}),r(0,t,"vertexDeclaration",function(){return e._vertexDeclaration}),r(1,e,"vertexDeclaration",function(){return e._vertexDeclaration}),n(e,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ce(24,[new ke(0,"vector3",0),new ke(12,"vector3",3)])}]),e}(),De=function(){function e(e,t,i){this._position=null,this._normal=null,this._color=null,this._position=e,this._normal=t,this._color=i}a(e,"laya.d3.graphics.VertexPositionNormalColor");var t=e.prototype;return i.imps(t,{"laya.d3.graphics.IVertex":!0}),r(0,t,"normal",function(){return this._normal}),r(0,t,"position",function(){return this._position}),r(0,t,"color",function(){return this._color}),r(0,t,"vertexDeclaration",function(){return e._vertexDeclaration}),r(1,e,"vertexDeclaration",function(){return e._vertexDeclaration}),n(e,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ce(40,[new ke(0,"vector3",0),new ke(12,"vector3",3),new ke(24,"vector4",1)])}]),e}(),Ne=function(){function e(e,t,i,n,a){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._position=e,this._normal=t,this._color=i,this._blendIndex=n,this._blendWeight=a}a(e,"laya.d3.graphics.VertexPositionNormalColorSkin");var t=e.prototype;return i.imps(t,{"laya.d3.graphics.IVertex":!0}),r(0,t,"normal",function(){return this._normal}),r(0,t,"position",function(){return this._position}),r(0,t,"blendWeight",function(){return this._blendWeight}),r(0,t,"color",function(){return this._color}),r(0,t,"blendIndex",function(){return this._blendIndex}),r(0,t,"vertexDeclaration",function(){return e._vertexDeclaration}),r(1,e,"vertexDeclaration",function(){return e._vertexDeclaration}),n(e,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ce(72,[new ke(0,"vector3",0),new ke(12,"vector3",3),new ke(24,"vector4",1),new ke(40,"vector4",7),new ke(56,"vector4",6)])}]),e}(),Ae=function(){function e(e,t,i,n,a,r){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=e,this._normal=t,this._color=i,this._tangent=n,this._blendIndex=a,this._blendWeight=r}a(e,"laya.d3.graphics.VertexPositionNormalColorSkinSTangent");var t=e.prototype;return i.imps(t,{"laya.d3.graphics.IVertex":!0}),r(0,t,"tangent",function(){return this._tangent}),r(0,t,"normal",function(){return this._normal}),r(0,t,"position",function(){return this._position}),r(0,t,"blendWeight",function(){return this._blendWeight}),r(0,t,"color",function(){return this._color}),r(0,t,"blendIndex",function(){return this._blendIndex}),r(0,t,"vertexDeclaration",function(){return e._vertexDeclaration}),r(1,e,"vertexDeclaration",function(){return e._vertexDeclaration}),n(e,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ce(88,[new ke(0,"vector3",0),new ke(12,"vector3",3),new ke(24,"vector4",1),new ke(40,"vector4",7),new ke(56,"vector4",6),new ke(72,"vector4",5)])}]),e}(),Re=function(){function e(e,t,i,n,a,r){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=e,this._normal=t,this._color=i,this._tangent=n,this._blendIndex=a,this._blendWeight=r}a(e,"laya.d3.graphics.VertexPositionNormalColorSkinTangent");var t=e.prototype;return i.imps(t,{"laya.d3.graphics.IVertex":!0}),r(0,t,"tangent",function(){return this._tangent}),r(0,t,"normal",function(){return this._normal}),r(0,t,"position",function(){return this._position}),r(0,t,"blendWeight",function(){return this._blendWeight}),r(0,t,"color",function(){return this._color}),r(0,t,"blendIndex",function(){return this._blendIndex}),r(0,t,"vertexDeclaration",function(){return e._vertexDeclaration}),r(1,e,"vertexDeclaration",function(){return e._vertexDeclaration}),n(e,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ce(84,[new ke(0,"vector3",0),new ke(12,"vector3",3),new ke(24,"vector4",1),new ke(40,"vector4",7),new ke(56,"vector4",6),new ke(72,"vector3",5)])}]),e}(),Be=function(){function e(e,t,i,n){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=e,this._normal=t,this._color=i,this._tangent=n}a(e,"laya.d3.graphics.VertexPositionNormalColorSTangent");var t=e.prototype;return i.imps(t,{"laya.d3.graphics.IVertex":!0}),r(0,t,"tangent",function(){return this._tangent}),r(0,t,"normal",function(){return this._normal}),r(0,t,"position",function(){return this._position}),r(0,t,"color",function(){return this._color}),r(0,t,"vertexDeclaration",function(){return e._vertexDeclaration}),r(1,e,"vertexDeclaration",function(){return e._vertexDeclaration}),n(e,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ce(56,[new ke(0,"vector3",0),new ke(12,"vector3",3),new ke(24,"vector4",1),new ke(40,"vector4",5)])}]),e}(),Pe=function(){function e(e,t,i,n){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=e,this._normal=t,this._color=i,this._tangent=n}a(e,"laya.d3.graphics.VertexPositionNormalColorTangent");var t=e.prototype;return i.imps(t,{"laya.d3.graphics.IVertex":!0}),r(0,t,"tangent",function(){return this._tangent}),r(0,t,"normal",function(){return this._normal}),r(0,t,"position",function(){return this._position}),r(0,t,"color",function(){return this._color}),r(0,t,"vertexDeclaration",function(){return e._vertexDeclaration}),r(1,e,"vertexDeclaration",function(){return e._vertexDeclaration}),n(e,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ce(52,[new ke(0,"vector3",0),new ke(12,"vector3",3),new ke(24,"vector4",1),new ke(40,"vector3",5)])}]),e}(),Oe=function(){function e(e,t,i,n){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._position=e,this._normal=t,this._color=i,this._textureCoordinate=n}a(e,"laya.d3.graphics.VertexPositionNormalColorTexture");var t=e.prototype;return i.imps(t,{"laya.d3.graphics.IVertex":!0}),r(0,t,"textureCoordinate",function(){return this._textureCoordinate}),r(0,t,"normal",function(){return this._normal}),r(0,t,"position",function(){return this._position}),r(0,t,"color",function(){return this._color}),r(0,t,"vertexDeclaration",function(){return e._vertexDeclaration}),r(1,e,"vertexDeclaration",function(){return e._vertexDeclaration}),n(e,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ce(48,[new ke(0,"vector3",0),new ke(12,"vector3",3),new ke(24,"vector4",1),new ke(40,"vector2",2)])}]),e}(),Ve=function(){function e(e,t,i,n,a){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=e,this._normal=t,this._color=i,this._textureCoordinate0=n,this._textureCoordinate1=a}a(e,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1");var t=e.prototype;return i.imps(t,{"laya.d3.graphics.IVertex":!0}),r(0,t,"normal",function(){return this._normal}),r(0,t,"position",function(){return this._position}),r(0,t,"color",function(){return this._color}),r(0,t,"textureCoordinate0",function(){return this._textureCoordinate0}),r(0,t,"vertexDeclaration",function(){return e._vertexDeclaration}),r(0,t,"textureCoordinate1",function(){return this._textureCoordinate1}),r(1,e,"vertexDeclaration",function(){return e._vertexDeclaration}),n(e,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ce(56,[new ke(0,"vector3",0),new ke(12,"vector3",3),new ke(24,"vector4",1),new ke(40,"vector2",2),new ke(48,"vector2",15)])}]),e}(),Ue=function(){function e(e,t,i,n,a,r,o){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=e,this._normal=t,this._color=i,this._textureCoordinate0=n,this._textureCoordinate1=a,this._blendIndex=r,this._blendWeight=o}a(e,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Skin");var t=e.prototype;return i.imps(t,{"laya.d3.graphics.IVertex":!0}),r(0,t,"normal",function(){return this._normal}),r(0,t,"position",function(){return this._position}),r(0,t,"blendWeight",function(){return this._blendWeight}),r(0,t,"color",function(){return this._color}),r(0,t,"textureCoordinate0",function(){return this._textureCoordinate0}),r(0,t,"vertexDeclaration",function(){return e._vertexDeclaration}),r(0,t,"textureCoordinate1",function(){return this._textureCoordinate1}),r(0,t,"blendIndex",function(){return this._blendIndex}),r(1,e,"vertexDeclaration",function(){return e._vertexDeclaration}),n(e,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ce(88,[new ke(0,"vector3",0),new ke(12,"vector3",3),new ke(24,"vector4",1),new ke(40,"vector2",2),new ke(48,"vector2",15),new ke(56,"vector4",7),new ke(72,"vector4",6)])}]),e}(),Fe=function(){function e(e,t,i,n,a,r,o,s){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=e,this._normal=t,this._color=i,this._textureCoordinate0=n,this._textureCoordinate1=a,this._tangent=r,this._blendIndex=o,this._blendWeight=s}a(e,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinSTangent");var t=e.prototype;return i.imps(t,{"laya.d3.graphics.IVertex":!0}),r(0,t,"tangent",function(){return this._tangent}),r(0,t,"normal",function(){return this._normal}),r(0,t,"position",function(){return this._position}),r(0,t,"blendWeight",function(){return this._blendWeight}),r(0,t,"color",function(){return this._color}),r(0,t,"textureCoordinate0",function(){return this._textureCoordinate0}),r(0,t,"vertexDeclaration",function(){return e._vertexDeclaration}),r(0,t,"textureCoordinate1",function(){return this._textureCoordinate1}),r(0,t,"blendIndex",function(){return this._blendIndex}),r(1,e,"vertexDeclaration",function(){return e._vertexDeclaration}),n(e,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ce(104,[new ke(0,"vector3",0),new ke(12,"vector3",3),new ke(24,"vector4",1),new ke(40,"vector2",2),new ke(48,"vector2",15),new ke(56,"vector4",7),new ke(72,"vector4",6),new ke(88,"vector4",5)])}]),e}(),He=function(){function e(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}a(e,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinTangent");var t=e.prototype;return i.imps(t,{"laya.d3.graphics.IVertex":!0}),t.VertexPositionNormalColorTexture0SkinTangent=function(e,t,i,n,a,r,o,s){this._position=e,this._normal=t,this._color=i,this._textureCoordinate0=n,this._textureCoordinate1=a,this._tangent=r,this._blendIndex=o,this._blendWeight=s},r(0,t,"tangent",function(){return this._tangent}),r(0,t,"normal",function(){return this._normal}),r(0,t,"position",function(){return this._position}),r(0,t,"blendWeight",function(){return this._blendWeight}),r(0,t,"color",function(){return this._color}),r(0,t,"textureCoordinate0",function(){return this._textureCoordinate0}),r(0,t,"vertexDeclaration",function(){return e._vertexDeclaration}),r(0,t,"textureCoordinate1",function(){return this._textureCoordinate1}),r(0,t,"blendIndex",function(){return this._blendIndex}),r(1,e,"vertexDeclaration",function(){return e._vertexDeclaration}),n(e,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ce(100,[new ke(0,"vector3",0),new ke(12,"vector3",3),new ke(24,"vector4",1),new ke(40,"vector2",2),new ke(48,"vector2",15),new ke(56,"vector4",7),new ke(72,"vector4",6),new ke(88,"vector3",5)])}]),e}(),ze=function(){function e(e,t,i,n,a,r){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=e,this._normal=t,this._color=i,this._textureCoordinate0=n,this._textureCoordinate1=a,this._tangent=r}a(e,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1STangent");var t=e.prototype;return i.imps(t,{"laya.d3.graphics.IVertex":!0}),r(0,t,"tangent",function(){return this._tangent}),r(0,t,"normal",function(){return this._normal}),r(0,t,"position",function(){return this._position}),r(0,t,"color",function(){return this._color}),r(0,t,"textureCoordinate0",function(){return this._textureCoordinate0}),r(0,t,"vertexDeclaration",function(){return e._vertexDeclaration}),r(0,t,"textureCoordinate1",function(){return this._textureCoordinate1}),r(1,e,"vertexDeclaration",function(){return e._vertexDeclaration}),n(e,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ce(72,[new ke(0,"vector3",0),new ke(12,"vector3",3),new ke(24,"vector4",1),new ke(40,"vector2",2),new ke(48,"vector2",15),new ke(56,"vector4",5)])}]),e}(),Xe=function(){function e(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}a(e,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Tangent");var t=e.prototype;return i.imps(t,{"laya.d3.graphics.IVertex":!0}),t.VertexPositionNormalColorTexture0Tangent=function(e,t,i,n,a,r){this._position=e,this._normal=t,this._color=i,this._textureCoordinate0=n,this._textureCoordinate1=a,this._tangent=r},r(0,t,"tangent",function(){return this._tangent}),r(0,t,"normal",function(){return this._normal}),r(0,t,"position",function(){return this._position}),r(0,t,"color",function(){return this._color}),r(0,t,"textureCoordinate0",function(){return this._textureCoordinate0}),r(0,t,"vertexDeclaration",function(){return e._vertexDeclaration}),r(0,t,"textureCoordinate1",function(){return this._textureCoordinate1}),r(1,e,"vertexDeclaration",function(){return e._vertexDeclaration}),n(e,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ce(68,[new ke(0,"vector3",0),new ke(12,"vector3",3),new ke(24,"vector4",1),new ke(40,"vector2",2),new ke(48,"vector2",15),new ke(56,"vector3",5)])}]),e}(),Ye=function(){function e(e,t,i,n,a,r){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=e,this._normal=t,this._color=i,this._textureCoordinate=n,this._blendIndex=a,this._blendWeight=r}a(e,"laya.d3.graphics.VertexPositionNormalColorTextureSkin");var t=e.prototype;return i.imps(t,{"laya.d3.graphics.IVertex":!0}),r(0,t,"textureCoordinate",function(){return this._textureCoordinate}),r(0,t,"normal",function(){return this._normal}),r(0,t,"position",function(){return this._position}),r(0,t,"blendWeight",function(){return this._blendWeight}),r(0,t,"color",function(){return this._color}),r(0,t,"blendIndex",function(){return this._blendIndex}),r(0,t,"vertexDeclaration",function(){return e._vertexDeclaration}),r(1,e,"vertexDeclaration",function(){return e._vertexDeclaration}),n(e,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ce(80,[new ke(0,"vector3",0),new ke(12,"vector3",3),new ke(24,"vector4",1),new ke(40,"vector2",2),new ke(48,"vector4",7),new ke(64,"vector4",6)])}]),e}(),Ge=function(){function e(e,t,i,n,a,r,o){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=e,this._normal=t,this._color=i,this._textureCoordinate=n,this._tangent=a,this._blendIndex=r,this._blendWeight=o}a(e,"laya.d3.graphics.VertexPositionNormalColorTextureSkinSTangent");var t=e.prototype;return i.imps(t,{"laya.d3.graphics.IVertex":!0}),r(0,t,"tangent",function(){return this._tangent}),r(0,t,"textureCoordinate",function(){return this._textureCoordinate}),r(0,t,"normal",function(){return this._normal}),r(0,t,"position",function(){return this._position}),r(0,t,"blendWeight",function(){return this._blendWeight}),r(0,t,"color",function(){return this._color}),r(0,t,"blendIndex",function(){return this._blendIndex}),r(0,t,"vertexDeclaration",function(){return e._vertexDeclaration}),r(1,e,"vertexDeclaration",function(){return e._vertexDeclaration}),n(e,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ce(96,[new ke(0,"vector3",0),new ke(12,"vector3",3),new ke(24,"vector4",1),new ke(40,"vector2",2),new ke(48,"vector4",7),new ke(64,"vector4",6),new ke(80,"vector4",5)])}]),e}(),je=function(){function e(e,t,i,n,a,r,o){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=e,this._normal=t,this._color=i,this._textureCoordinate=n,this._tangent=a,this._blendIndex=r,this._blendWeight=o}a(e,"laya.d3.graphics.VertexPositionNormalColorTextureSkinTangent");var t=e.prototype;return i.imps(t,{"laya.d3.graphics.IVertex":!0}),r(0,t,"tangent",function(){return this._tangent}),r(0,t,"textureCoordinate",function(){return this._textureCoordinate}),r(0,t,"normal",function(){return this._normal}),r(0,t,"position",function(){return this._position}),r(0,t,"blendWeight",function(){return this._blendWeight}),r(0,t,"color",function(){return this._color}),r(0,t,"blendIndex",function(){return this._blendIndex}),r(0,t,"vertexDeclaration",function(){return e._vertexDeclaration}),r(1,e,"vertexDeclaration",function(){return e._vertexDeclaration}),n(e,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ce(92,[new ke(0,"vector3",0),new ke(12,"vector3",3),new ke(24,"vector4",1),new ke(40,"vector2",2),new ke(48,"vector4",7),new ke(64,"vector4",6),new ke(80,"vector3",5)])}]),e}(),We=function(){function e(e,t,i,n,a){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=e,this._normal=t,this._color=i,this._textureCoordinate=n,this._tangent=a}a(e,"laya.d3.graphics.VertexPositionNormalColorTextureSTangent");var t=e.prototype;return i.imps(t,{"laya.d3.graphics.IVertex":!0}),r(0,t,"tangent",function(){return this._tangent}),r(0,t,"textureCoordinate",function(){return this._textureCoordinate}),r(0,t,"normal",function(){return this._normal}),r(0,t,"position",function(){return this._position}),r(0,t,"color",function(){return this._color}),r(0,t,"vertexDeclaration",function(){return e._vertexDeclaration}),r(1,e,"vertexDeclaration",function(){return e._vertexDeclaration}),n(e,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ce(64,[new ke(0,"vector3",0),new ke(12,"vector3",3),new ke(24,"vector4",1),new ke(40,"vector2",2),new ke(48,"vector4",5)])}]),e}(),qe=function(){function e(e,t,i,n,a){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=e,this._normal=t,this._color=i,this._textureCoordinate=n,this._tangent=a}a(e,"laya.d3.graphics.VertexPositionNormalColorTextureTangent");var t=e.prototype;return i.imps(t,{"laya.d3.graphics.IVertex":!0}),r(0,t,"tangent",function(){return this._tangent}),r(0,t,"textureCoordinate",function(){return this._textureCoordinate}),r(0,t,"normal",function(){return this._normal}),r(0,t,"position",function(){return this._position}),r(0,t,"color",function(){return this._color}),r(0,t,"vertexDeclaration",function(){return e._vertexDeclaration}),r(1,e,"vertexDeclaration",function(){return e._vertexDeclaration}),n(e,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ce(60,[new ke(0,"vector3",0),new ke(12,"vector3",3),new ke(24,"vector4",1),new ke(40,"vector2",2),new ke(48,"vector3",5)])}]),e}(),Ke=function(){function e(e,t,i){this._position=null,this._normal=null,this._tangent=null,this._position=e,this._normal=t,this._tangent=i}a(e,"laya.d3.graphics.VertexPositionNormalSTangent");var t=e.prototype;return i.imps(t,{"laya.d3.graphics.IVertex":!0}),r(0,t,"tangent",function(){return this._tangent}),r(0,t,"normal",function(){return this._normal}),r(0,t,"position",function(){return this._position}),r(0,t,"vertexDeclaration",function(){return e._vertexDeclaration}),r(1,e,"vertexDeclaration",function(){return e._vertexDeclaration}),n(e,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ce(40,[new ke(0,"vector3",0),new ke(12,"vector3",3),new ke(24,"vector4",5)])}]),e}(),Je=function(){function e(e,t,i){this._position=null,this._normal=null,this._tangent=null,this._position=e,this._normal=t,this._tangent=i}a(e,"laya.d3.graphics.VertexPositionNormalTangent");var t=e.prototype;return i.imps(t,{"laya.d3.graphics.IVertex":!0}),r(0,t,"tangent",function(){return this._tangent}),r(0,t,"normal",function(){return this._normal}),r(0,t,"position",function(){return this._position}),r(0,t,"vertexDeclaration",function(){return e._vertexDeclaration}),r(1,e,"vertexDeclaration",function(){return e._vertexDeclaration}),n(e,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ce(36,[new ke(0,"vector3",0),new ke(12,"vector3",3),new ke(24,"vector3",5)])}]),e}(),Ze=function(){function e(e,t,i){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=e,this._normal=t,this._textureCoordinate=i}a(e,"laya.d3.graphics.VertexPositionNormalTexture");var t=e.prototype;return i.imps(t,{"laya.d3.graphics.IVertex":!0}),r(0,t,"textureCoordinate",function(){return this._textureCoordinate}),r(0,t,"normal",function(){return this._normal}),r(0,t,"position",function(){return this._position}),r(0,t,"vertexDeclaration",function(){return e._vertexDeclaration}),r(1,e,"vertexDeclaration",function(){return e._vertexDeclaration}),n(e,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ce(32,[new ke(0,"vector3",0),new ke(12,"vector3",3),new ke(24,"vector2",2)])}]),e}(),Qe=function(){function e(e,t,i,n){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=e,this._normal=t,this._textureCoordinate0=i,this._textureCoordinate1=n}a(e,"laya.d3.graphics.VertexPositionNormalTexture0Texture1");var t=e.prototype;return i.imps(t,{"laya.d3.graphics.IVertex":!0}),r(0,t,"normal",function(){return this._normal}),r(0,t,"position",function(){return this._position}),r(0,t,"textureCoordinate0",function(){return this._textureCoordinate0}),r(0,t,"vertexDeclaration",function(){return e._vertexDeclaration}),r(0,t,"textureCoordinate1",function(){return this._textureCoordinate1}),r(1,e,"vertexDeclaration",function(){return e._vertexDeclaration}),n(e,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ce(40,[new ke(0,"vector3",0),new ke(12,"vector3",3),new ke(24,"vector2",2),new ke(32,"vector2",15)])}]),e}(),$e=function(){function e(e,t,i,n,a,r){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=e,this._normal=t,this._textureCoordinate0=i,this._textureCoordinate1=n,this._blendIndex=a,this._blendWeight=r}a(e,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Skin");var t=e.prototype;return i.imps(t,{"laya.d3.graphics.IVertex":!0}),r(0,t,"normal",function(){return this._normal}),r(0,t,"position",function(){return this._position}),r(0,t,"textureCoordinate0",function(){return this._textureCoordinate0}),r(0,t,"vertexDeclaration",function(){return e._vertexDeclaration}),r(0,t,"textureCoordinate1",function(){return this._textureCoordinate1}),r(0,t,"blendIndex",function(){return this._blendIndex}),r(0,t,"blendWeight",function(){return this._blendWeight}),r(1,e,"vertexDeclaration",function(){return e._vertexDeclaration}),n(e,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ce(72,[new ke(0,"vector3",0),new ke(12,"vector3",3),new ke(24,"vector2",2),new ke(32,"vector2",15),new ke(40,"vector4",7),new ke(56,"vector4",6)])}]),e}(),et=function(){function e(e,t,i,n,a,r,o){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=e,this._normal=t,this._textureCoordinate0=i,this._textureCoordinate1=n,this._tangent=a,this._blendIndex=r,this._blendWeight=o}a(e,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinSTangent");var t=e.prototype;return i.imps(t,{"laya.d3.graphics.IVertex":!0}),r(0,t,"tangent",function(){return this._tangent}),r(0,t,"normal",function(){return this._normal}),r(0,t,"position",function(){return this._position}),r(0,t,"textureCoordinate0",function(){return this._textureCoordinate0}),r(0,t,"vertexDeclaration",function(){return e._vertexDeclaration}),r(0,t,"textureCoordinate1",function(){return this._textureCoordinate1}),r(0,t,"blendIndex",function(){return this._blendIndex}),r(0,t,"blendWeight",function(){return this._blendWeight}),r(1,e,"vertexDeclaration",function(){return e._vertexDeclaration}),n(e,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ce(88,[new ke(0,"vector3",0),new ke(12,"vector3",3),new ke(24,"vector2",2),new ke(32,"vector2",15),new ke(40,"vector4",7),new ke(56,"vector4",6),new ke(72,"vector4",5)])}]),e}(),tt=function(){function e(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}a(e,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinTangent");var t=e.prototype;return i.imps(t,{"laya.d3.graphics.IVertex":!0}),t.VertexPositionNormalTexture0SkinTangent=function(e,t,i,n,a,r,o){this._position=e,this._normal=t,this._textureCoordinate0=i,this._textureCoordinate1=n,this._tangent=a,this._blendIndex=r,this._blendWeight=o},r(0,t,"tangent",function(){return this._tangent}),r(0,t,"normal",function(){return this._normal}),r(0,t,"position",function(){return this._position}),r(0,t,"textureCoordinate0",function(){return this._textureCoordinate0}),r(0,t,"vertexDeclaration",function(){return e._vertexDeclaration}),r(0,t,"textureCoordinate1",function(){return this._textureCoordinate1}),r(0,t,"blendIndex",function(){return this._blendIndex}),r(0,t,"blendWeight",function(){return this._blendWeight}),r(1,e,"vertexDeclaration",function(){return e._vertexDeclaration}),n(e,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ce(84,[new ke(0,"vector3",0),new ke(12,"vector3",3),new ke(24,"vector2",2),new ke(32,"vector2",15),new ke(40,"vector4",7),new ke(56,"vector4",6),new ke(72,"vector3",5)])}]),e}(),it=function(){function e(e,t,i,n,a){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=e,this._normal=t,this._textureCoordinate0=i,this._textureCoordinate1=n,this._tangent=a}a(e,"laya.d3.graphics.VertexPositionNormalTexture0Texture1STangent");var t=e.prototype;return i.imps(t,{"laya.d3.graphics.IVertex":!0}),r(0,t,"tangent",function(){return this._tangent}),r(0,t,"normal",function(){return this._normal}),r(0,t,"position",function(){return this._position}),r(0,t,"textureCoordinate0",function(){return this._textureCoordinate0}),r(0,t,"vertexDeclaration",function(){return e._vertexDeclaration}),r(0,t,"textureCoordinate1",function(){return this._textureCoordinate1}),r(1,e,"vertexDeclaration",function(){return e._vertexDeclaration}),n(e,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ce(56,[new ke(0,"vector3",0),new ke(12,"vector3",3),new ke(24,"vector2",2),new ke(32,"vector2",15),new ke(40,"vector4",5)])}]),e}(),nt=function(){function e(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}a(e,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Tangent");var t=e.prototype;return i.imps(t,{"laya.d3.graphics.IVertex":!0}),t.VertexPositionNormalTexture0Tangent=function(e,t,i,n,a){this._position=e,this._normal=t,this._textureCoordinate0=i,this._textureCoordinate1=n,this._tangent=a},r(0,t,"tangent",function(){return this._tangent}),r(0,t,"normal",function(){return this._normal}),r(0,t,"position",function(){return this._position}),r(0,t,"textureCoordinate0",function(){return this._textureCoordinate0}),r(0,t,"vertexDeclaration",function(){return e._vertexDeclaration}),r(0,t,"textureCoordinate1",function(){return this._textureCoordinate1}),r(1,e,"vertexDeclaration",function(){return e._vertexDeclaration}),n(e,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ce(52,[new ke(0,"vector3",0),new ke(12,"vector3",3),new ke(24,"vector2",2),new ke(32,"vector2",15),new ke(40,"vector3",5)])}]),e}(),at=function(){function e(e,t,i,n,a){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=e,this._normal=t,this._textureCoordinate=i,this._blendIndex=n,this._blendWeight=a}a(e,"laya.d3.graphics.VertexPositionNormalTextureSkin");var t=e.prototype;return i.imps(t,{"laya.d3.graphics.IVertex":!0}),r(0,t,"textureCoordinate",function(){return this._textureCoordinate}),r(0,t,"normal",function(){return this._normal}),r(0,t,"position",function(){return this._position}),r(0,t,"blendIndex",function(){return this._blendIndex}),r(0,t,"blendWeight",function(){return this._blendWeight}),r(0,t,"vertexDeclaration",function(){return e._vertexDeclaration}),r(1,e,"vertexDeclaration",function(){return e._vertexDeclaration}),n(e,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ce(64,[new ke(0,"vector3",0),new ke(12,"vector3",3),new ke(24,"vector2",2),new ke(32,"vector4",7),new ke(48,"vector4",6)])}]),e}(),rt=function(){function e(e,t,i,n,a,r){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=e,this._normal=t,this._textureCoordinate=i,this._tangent=n,this._blendIndex=a,this._blendWeight=r}a(e,"laya.d3.graphics.VertexPositionNormalTextureSkinSTangent");var t=e.prototype;return i.imps(t,{"laya.d3.graphics.IVertex":!0}),r(0,t,"tangent",function(){return this._tangent}),r(0,t,"textureCoordinate",function(){return this._textureCoordinate}),r(0,t,"normal",function(){return this._normal}),r(0,t,"position",function(){return this._position}),r(0,t,"blendIndex",function(){return this._blendIndex}),r(0,t,"blendWeight",function(){return this._blendWeight}),r(0,t,"vertexDeclaration",function(){return e._vertexDeclaration}),r(1,e,"vertexDeclaration",function(){return e._vertexDeclaration}),n(e,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ce(80,[new ke(0,"vector3",0),new ke(12,"vector3",3),new ke(24,"vector2",2),new ke(32,"vector4",7),new ke(48,"vector4",6),new ke(64,"vector4",5)])}]),e}(),ot=function(){function e(e,t,i,n,a,r){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=e,this._normal=t,this._textureCoordinate=i,this._tangent=n,this._blendIndex=a,this._blendWeight=r}a(e,"laya.d3.graphics.VertexPositionNormalTextureSkinTangent");var t=e.prototype;return i.imps(t,{"laya.d3.graphics.IVertex":!0}),r(0,t,"tangent",function(){return this._tangent}),r(0,t,"textureCoordinate",function(){return this._textureCoordinate}),r(0,t,"normal",function(){return this._normal}),r(0,t,"position",function(){return this._position}),r(0,t,"blendIndex",function(){return this._blendIndex}),r(0,t,"blendWeight",function(){return this._blendWeight}),r(0,t,"vertexDeclaration",function(){return e._vertexDeclaration}),r(1,e,"vertexDeclaration",function(){return e._vertexDeclaration}),n(e,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ce(76,[new ke(0,"vector3",0),new ke(12,"vector3",3),new ke(24,"vector2",2),new ke(32,"vector4",7),new ke(48,"vector4",6),new ke(64,"vector3",5)])}]),e}(),st=function(){function e(e,t,i,n){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=e,this._normal=t,this._textureCoordinate=i,this._tangent=n}a(e,"laya.d3.graphics.VertexPositionNormalTextureSTangent");var t=e.prototype;return i.imps(t,{"laya.d3.graphics.IVertex":!0}),r(0,t,"tangent",function(){return this._tangent}),r(0,t,"textureCoordinate",function(){return this._textureCoordinate}),r(0,t,"normal",function(){return this._normal}),r(0,t,"position",function(){return this._position}),r(0,t,"vertexDeclaration",function(){return e._vertexDeclaration}),r(1,e,"vertexDeclaration",function(){return e._vertexDeclaration}),n(e,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ce(48,[new ke(0,"vector3",0),new ke(12,"vector3",3),new ke(24,"vector2",2),new ke(32,"vector4",5)])}]),e}(),ht=function(){function e(e,t,i,n){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=e,this._normal=t,this._textureCoordinate=i,this._tangent=n}a(e,"laya.d3.graphics.VertexPositionNormalTextureTangent");var t=e.prototype;return i.imps(t,{"laya.d3.graphics.IVertex":!0}),r(0,t,"tangent",function(){return this._tangent}),r(0,t,"textureCoordinate",function(){return this._textureCoordinate}),r(0,t,"normal",function(){return this._normal}),r(0,t,"position",function(){return this._position}),r(0,t,"vertexDeclaration",function(){return e._vertexDeclaration}),r(1,e,"vertexDeclaration",function(){return e._vertexDeclaration}),n(e,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ce(44,[new ke(0,"vector3",0),new ke(12,"vector3",3),new ke(24,"vector2",2),new ke(32,"vector3",5)])}]),e}(),lt=function(){function e(e,t,i){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=e,this._normal=t,this._textureCoordinate=i}a(e,"laya.d3.graphics.VertexPositionNTBTexture");var t=e.prototype;return i.imps(t,{"laya.d3.graphics.IVertex":!0}),r(0,t,"textureCoordinate",function(){return this._textureCoordinate}),r(0,t,"normal",function(){return this._normal}),r(0,t,"position",function(){return this._position}),r(0,t,"vertexDeclaration",function(){return e._vertexDeclaration}),r(1,e,"vertexDeclaration",function(){return e._vertexDeclaration}),n(e,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ce(56,[new ke(0,"vector3",0),new ke(12,"vector3",3),new ke(24,"vector3",5),new ke(36,"vector3",4),new ke(48,"vector2",2)])}]),e}(),ct=function(){function e(e,t,i,n,a,r,o,s){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this.binormal=null,this._position=e,this._normal=t,this._textureCoordinate0=n,this._textureCoordinate1=a,this._tangent=r,i=i,this._blendIndex=o,this._blendWeight=s}a(e,"laya.d3.graphics.VertexPositionNTBTexture0Texture1Skin");var t=e.prototype;return i.imps(t,{"laya.d3.graphics.IVertex":!0}),r(0,t,"tangent",function(){return this._tangent}),r(0,t,"normal",function(){return this._normal}),r(0,t,"position",function(){return this._position}),r(0,t,"textureCoordinate0",function(){return this._textureCoordinate0}),r(0,t,"vertexDeclaration",function(){return e._vertexDeclaration}),r(0,t,"textureCoordinate1",function(){return this._textureCoordinate1}),r(0,t,"blendIndex",function(){return this._blendIndex}),r(0,t,"blendWeight",function(){return this._blendWeight}),r(1,e,"vertexDeclaration",function(){return e._vertexDeclaration}),n(e,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ce(96,[new ke(0,"vector3",0),new ke(12,"vector3",3),new ke(24,"vector3",5),new ke(36,"vector3",4),new ke(48,"vector2",2),new ke(56,"vector2",15),new ke(64,"vector4",7),new ke(80,"vector4",6)])}]),e}(),pt=function(){function e(e,t,i){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=e,this._normal=t,this._textureCoordinate=i}a(e,"laya.d3.graphics.VertexPositionNTBTextureSkin");var t=e.prototype;return i.imps(t,{"laya.d3.graphics.IVertex":!0}),r(0,t,"textureCoordinate",function(){return this._textureCoordinate}),r(0,t,"normal",function(){return this._normal}),r(0,t,"position",function(){return this._position}),r(0,t,"vertexDeclaration",function(){return e._vertexDeclaration}),r(1,e,"vertexDeclaration",function(){return e._vertexDeclaration}),n(e,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ce(88,[new ke(0,"vector3",0),new ke(12,"vector3",3),new ke(24,"vector3",5),new ke(36,"vector3",4),new ke(48,"vector2",2),new ke(56,"vector4",7),new ke(72,"vector4",6)])}]),e}(),ut=function(){function e(e,t,i,n){this._position=null,this._normal=null,this._textureCoord0=null,this._textureCoord1=null,this._position=e,this._normal=t,this._textureCoord0=i,this._textureCoord1=n}a(e,"laya.d3.graphics.VertexPositionTerrain");var t=e.prototype;return i.imps(t,{"laya.d3.graphics.IVertex":!0}),r(0,t,"normal",function(){return this._normal}),r(0,t,"position",function(){return this._position}),r(0,t,"textureCoord0",function(){return this._textureCoord0}),r(0,t,"textureCoord1",function(){return this._textureCoord1}),r(0,t,"vertexDeclaration",function(){return e._vertexDeclaration}),r(1,e,"vertexDeclaration",function(){return e._vertexDeclaration}),n(e,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ce(40,[new ke(0,"vector3",0),new ke(12,"vector3",3),new ke(24,"vector2",2),new ke(32,"vector2",15)])}]),e}(),dt=function(){function e(e,t){this._position=null,this._textureCoordinate0=null,this._position=e,this._textureCoordinate0=t}a(e,"laya.d3.graphics.VertexPositionTexture0");var t=e.prototype;return i.imps(t,{"laya.d3.graphics.IVertex":!0}),r(0,t,"position",function(){return this._position}),r(0,t,"textureCoordinate0",function(){return this._textureCoordinate0}),r(0,t,"vertexDeclaration",function(){return e._vertexDeclaration}),r(1,e,"vertexDeclaration",function(){return e._vertexDeclaration}),n(e,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ce(20,[new ke(0,"vector3",0),new ke(12,"vector2",2)])}]),e}(),_t=function(){function e(e,t,i,n,a,r,o,s,h,l,c,p,u,d){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=e,this._positionStartLifeTime=t,this._velocity=i,this._startColor=n,this._startSize=a,this._startRotation0=r,this._startRotation1=o,this._startRotation2=s,this._startLifeTime=h,this._time=l,this._startSpeed=c,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=d}a(e,"laya.d3.graphics.VertexShurikenParticleBillboard");var t=e.prototype;return i.imps(t,{"laya.d3.graphics.IVertex":!0}),r(0,t,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),r(0,t,"random1",function(){return this._randoms1}),r(0,t,"startRotation2",function(){return this._startRotation2}),r(0,t,"positionStartLifeTime",function(){return this._positionStartLifeTime}),r(0,t,"velocity",function(){return this._velocity}),r(0,t,"random0",function(){return this._randoms0}),r(0,t,"startSize",function(){return this._startSize}),r(0,t,"startColor",function(){return this._startColor}),r(0,t,"startRotation0",function(){return this._startRotation0}),r(0,t,"startRotation1",function(){return this._startRotation1}),r(0,t,"startLifeTime",function(){return this._startLifeTime}),r(0,t,"time",function(){return this._time}),r(0,t,"startSpeed",function(){return this._startSpeed}),r(0,t,"simulationWorldPostion",function(){return this._simulationWorldPostion}),r(0,t,"vertexDeclaration",function(){return e._vertexDeclaration}),r(1,e,"vertexDeclaration",function(){return e._vertexDeclaration}),n(e,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ce(152,[new ke(0,"vector4",17),new ke(16,"vector4",30),new ke(32,"vector4",32),new ke(48,"vector4",19),new ke(64,"vector3",20),new ke(76,"vector3",22),new ke(88,"single",31),new ke(92,"vector4",34),new ke(108,"vector4",35),new ke(124,"vector3",36),new ke(136,"vector4",37)])}]),e}(),mt=function(){function e(e,t,i,n,a,r,o,s,h,l,c,p,u,d){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=e,this._positionStartLifeTime=t,this._velocity=i,this._startColor=n,this._startSize=a,this._startRotation0=r,this._startRotation1=o,this._startRotation2=s,this._startLifeTime=h,this._time=l,this._startSpeed=c,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=d}a(e,"laya.d3.graphics.VertexShurikenParticleMesh");var t=e.prototype;return i.imps(t,{"laya.d3.graphics.IVertex":!0}),r(0,t,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),r(0,t,"velocity",function(){return this._velocity}),r(0,t,"position",function(){return this._positionStartLifeTime}),r(0,t,"random0",function(){return this._randoms0}),r(0,t,"startSize",function(){return this._startSize}),r(0,t,"startColor",function(){return this._startColor}),r(0,t,"startRotation0",function(){return this._startRotation0}),r(0,t,"startRotation1",function(){return this._startRotation1}),r(0,t,"random1",function(){return this._randoms1}),r(0,t,"startRotation2",function(){return this._startRotation2}),r(0,t,"startLifeTime",function(){return this._startLifeTime}),r(0,t,"time",function(){return this._time}),r(0,t,"startSpeed",function(){return this._startSpeed}),r(0,t,"simulationWorldPostion",function(){return this._simulationWorldPostion}),r(0,t,"vertexDeclaration",function(){return e._vertexDeclaration}),r(1,e,"vertexDeclaration",function(){return e._vertexDeclaration}),n(e,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ce(172,[new ke(0,"vector3",0),new ke(12,"vector4",1),new ke(28,"vector2",2),new ke(36,"vector4",30),new ke(52,"vector4",32),new ke(68,"vector4",19),new ke(84,"vector3",20),new ke(96,"vector3",22),new ke(108,"single",31),new ke(112,"vector4",34),new ke(128,"vector4",35),new ke(144,"vector3",36),new ke(156,"vector4",37)])}]),e}(),ft=function(){function e(e,t,i,n,a,r){this._version=null,this._strings=["BLOCK","DATA","STRINGS"],this._materials=null,this._subMeshes=null,this._materialMap=null,this._readData=null,this._mesh=null,this._BLOCK={count:0},this._DATA={offset:0,size:0},this._STRINGS={offset:0,size:0},this._shaderAttributes=null,this._mesh=i,this._materials=n,this._subMeshes=a,this._materialMap=r,this._version=t,this._onLoaded(e)}a(e,"laya.d3.loaders.LoadModelV01");var t=e.prototype;return t._onLoaded=function(e){this._readData=e,this.READ_BLOCK();for(var t=0;t<this._BLOCK.count;t++){var i=this._readData.getUint16(),n=this._strings[i],a=this["READ_"+n];if(null==a)throw new Error("model file err,no this function:"+i+" "+n);if(!a.call(this))break}return this._mesh},t.onError=function(){},t._readString=function(){return this._strings[this._readData.getUint16()]},t.READ_BLOCK=function(){this._readData.getUint16();return this._BLOCK.count=this._readData.getUint16(),!0},t.READ_DATA=function(){return this._DATA.offset=this._readData.getUint32(),this._DATA.size=this._readData.getUint32(),!0},t.READ_STRINGS=function(){this._STRINGS.offset=this._readData.getUint16(),this._STRINGS.size=this._readData.getUint16();var e=this._readData.pos;this._readData.pos=this._STRINGS.offset+this._DATA.offset;for(var t=0;t<this._STRINGS.size;t++)this._strings[t]=this._readData.readUTFString();return this._readData.pos=e,!0},t.READ_MATERIAL=function(){var e=this._readData.getUint16(),t=(this._readString(),this._readString());return this._materials[e]="null"!==t?v.getRes(this._materialMap[t]):new fi,!0},t.READ_MESH=function(){this._readString();switch(this._version){case"LAYAMODEL:01":console.log("Warning: The (.lm) file is converted by old fbxTools,please reConverted it use  lastest fbxTools version,later we will remove the  support of old version (.lm) support.");break;case"LAYASKINANI:01":case"LAYAMODEL:02":var e=this._readData.__getBuffer(),t=0,i=0,n=this._readData.getUint32(),a=this._readData.getUint32(),r=(new Float32Array(e.slice(n+this._DATA.offset,n+this._DATA.offset+a)),this._readData.getUint32()),o=this._readData.getUint32(),s=new Float32Array(e.slice(r+this._DATA.offset,r+this._DATA.offset+o));for(this.mesh._inverseBindPoses=[],t=0,i=s.length;t<i;t+=16){var h=new Ct(s[t+0],s[t+1],s[t+2],s[t+3],s[t+4],s[t+5],s[t+6],s[t+7],s[t+8],s[t+9],s[t+10],s[t+11],s[t+12],s[t+13],s[t+14],s[t+15]);this.mesh._inverseBindPoses.push(h)}break;default:throw new Error("LoadModel:unknown version.")}return!0},t.READ_SUBMESH=function(){this._readString(),this._readData.getUint8();var t=this._readString();this._shaderAttributes=t.match(e._attrReg);var i=this._readData.getUint32(),n=this._readData.getUint32(),a=(this._readData.getUint32(),this._readData.getUint32(),this._readData.getUint32()),r=this._readData.getUint32(),o=this._readData.getUint32(),s=this._readData.getUint32(),h=this._readData.__getBuffer(),l=new Ot(this._mesh),c=this._getVertexDeclaration(),p=qi.create(c,r/c.vertexStride,35044,!0),u=a+this._DATA.offset,d=h.slice(u,u+r);p.setData(new Float32Array(d)),l._vertexBuffer=p;for(var _=p.vertexDeclaration.getVertexElements(),m=0;m<_.length;m++)l._bufferUsage[_[m].elementUsage]=p;var f=Wi.create("ushort",n/2,35044,!0),g=i+this._DATA.offset,y=h.slice(g,g+n);f.setData(new Uint16Array(y)),l._indexBuffer=f;var v=h.slice(o+this._DATA.offset,o+this._DATA.offset+s);return l._boneIndicesList[0]=new Uint8Array(v),this._subMeshes.push(l),!0},t.READ_DATAAREA=function(){return!1},t._getVertexDeclaration=function(){for(var e=!1,t=!1,i=!1,n=!1,a=!1,r=!1,o=!1,s=!1,h=!1,l=0;l<this._shaderAttributes.length;l+=8)switch(this._shaderAttributes[l]){case"POSITION":e=!0;break;case"NORMAL":t=!0;break;case"COLOR":i=!0;break;case"UV":n=!0;break;case"UV1":a=!0;break;case"BLENDWEIGHT":o=!0;break;case"BLENDINDICES":s=!0;break;case"TANGENT":r=!0;break;case"BINORMAL":h=!0}var c;return e&&t&&i&&n&&a&&o&&s&&r?c=He.vertexDeclaration:e&&t&&i&&n&&a&&o&&s?c=Ue.vertexDeclaration:e&&t&&n&&a&&o&&s&&r?c=tt.vertexDeclaration:e&&t&&n&&a&&o&&s?c=$e.vertexDeclaration:e&&t&&i&&n&&o&&s&&r?c=je.vertexDeclaration:e&&t&&i&&n&&o&&s?c=Ye.vertexDeclaration:e&&t&&r&&h&&n&&o&&s?c=pt.vertexDeclaration:e&&t&&n&&o&&s&&r?c=ot.vertexDeclaration:e&&t&&n&&o&&s?c=at.vertexDeclaration:e&&t&&i&&o&&s&&r?c=Re.vertexDeclaration:e&&t&&i&&o&&s?c=Ne.vertexDeclaration:e&&t&&i&&n&&a&&r?c=Xe.vertexDeclaration:e&&t&&i&&n&&a?c=Ve.vertexDeclaration:e&&t&&n&&a&&r?c=nt.vertexDeclaration:e&&t&&n&&a?c=Qe.vertexDeclaration:e&&t&&i&&n&&r?c=qe.vertexDeclaration:e&&t&&n&&r&&h?c=lt.vertexDeclaration:e&&t&&i&&n?c=Oe.vertexDeclaration:e&&t&&n&&r?c=ht.vertexDeclaration:e&&t&&n?c=Ze.vertexDeclaration:e&&t&&i&&r?c=Pe.vertexDeclaration:e&&t&&i&&(c=De.vertexDeclaration),c},r(0,t,"mesh",function(){return this._mesh}),e._attrReg=new RegExp("(\\w+)|([:,;])","g"),e}(),gt=function(){function e(){}return a(e,"laya.d3.loaders.LoadModelV02"),e.parse=function(t,i,n,a,r,o){e._mesh=n,e._materials=a,e._subMeshes=r,e._materialMap=o,e._version=i,e._readData=t,e.READ_DATA(),e.READ_BLOCK(),e.READ_STRINGS();for(var s=0,h=e._BLOCK.count;s<h;s++){e._readData.pos=e._BLOCK.blockStarts[s];var l=e._readData.getUint16(),c=e._strings[l],p=e["READ_"+c];if(null==p)throw new Error("model file err,no this function:"+l+" "+c);p.call()}e._strings.length=0,e._readData=null,e._version=null,e._mesh=null,e._materials=null,e._subMeshes=null,e._materialMap=null},e._readString=function(){return e._strings[e._readData.getUint16()]},e.READ_DATA=function(){e._DATA.offset=e._readData.getUint32(),e._DATA.size=e._readData.getUint32()},e.READ_BLOCK=function(){for(var t=e._BLOCK.count=e._readData.getUint16(),i=e._BLOCK.blockStarts=[],n=e._BLOCK.blockLengths=[],a=0;a<t;a++)i.push(e._readData.getUint32()),n.push(e._readData.getUint32())},e.READ_STRINGS=function(){var t=e._readData.getUint32(),i=e._readData.getUint16(),n=e._readData.pos;e._readData.pos=t+e._DATA.offset;for(var a=0;a<i;a++)e._strings[a]=e._readData.readUTFString();e._readData.pos=n},e.READ_MATERIAL=function(){e._readString(),e._readString();var t=e._readString();return""!==t&&e._materials.push(v.getRes(e._materialMap[t])),!0},e.READ_MESH=function(){e._readString();var t=e._readData.__getBuffer(),i=0,n=0,a=e._readData.getInt16(),r=e._DATA.offset;for(i=0;i<a;i++){var o=r+e._readData.getUint32(),s=e._readData.getUint32(),h=new Float32Array(t.slice(o,o+s)),l=e._readString().match(e._attrReg),c=e._getVertexDeclaration(l),p=qi.create(c,4*h.length/c.vertexStride,35044,!0);p.setData(h),e._mesh._vertexBuffers.push(p)}var u=r+e._readData.getUint32(),d=e._readData.getUint32(),_=new Uint16Array(t.slice(u,u+d)),m=Wi.create("ushort",d/2,35044,!0);m.setData(_),e._mesh._indexBuffer=m;var f=e._mesh._boneNames=[],g=e._readData.getUint16();for(f.length=g,i=0;i<g;i++)f[i]=e._strings[e._readData.getUint16()];var y=e._readData.getUint32(),v=e._readData.getUint32(),x=(new Float32Array(t.slice(r+y,r+y+v)),e._readData.getUint32()),b=e._readData.getUint32(),w=new Float32Array(t.slice(r+x,r+x+b));for(e._mesh._inverseBindPoses=[],i=0,n=w.length;i<n;i+=16){var S=new Ct(w[i+0],w[i+1],w[i+2],w[i+3],w[i+4],w[i+5],w[i+6],w[i+7],w[i+8],w[i+9],w[i+10],w[i+11],w[i+12],w[i+13],w[i+14],w[i+15]);e._mesh._inverseBindPoses.push(S)}return e._mesh._skinnedDatas=new Float32Array(16*w.length),!0},e.READ_SUBMESH=function(){var t=e._readData.__getBuffer(),i=new Ot(e._mesh),n=e._readData.getInt16(),a=e._readData.getUint32(),r=e._readData.getUint32();i._vertexBuffer=e._mesh._vertexBuffers[n],i._vertexStart=a,i._vertexCount=r;var o=e._readData.getUint32(),s=e._readData.getUint32(),h=e._mesh._indexBuffer;i._indexBuffer=h,i._indexStart=o,i._indexCount=s,i._indices=new Uint16Array(h.getData().buffer,2*o,s);var l=e._DATA.offset,c=i._subIndexBufferStart,p=i._subIndexBufferCount,u=i._boneIndicesList,d=e._readData.getUint16();c.length=d,p.length=d,u.length=d;for(var _=0;_<d;_++){c[_]=e._readData.getUint32(),p[_]=e._readData.getUint32();var m=e._readData.getUint32(),f=e._readData.getUint32();i._boneIndicesList[_]=new Uint8Array(t.slice(l+m,l+m+f))}return e._subMeshes.push(i),!0},e._getVertexDeclaration=function(e){for(var t=!1,i=!1,n=!1,a=!1,r=!1,o=!1,s=!1,h=!1,l=!1,c=0;c<e.length;c++)switch(e[c]){case"POSITION":t=!0;break;case"NORMAL":i=!0;break;case"COLOR":n=!0;break;case"UV":a=!0;break;case"UV1":r=!0;break;case"BLENDWEIGHT":s=!0;break;case"BLENDINDICES":h=!0;break;case"TANGENT":o=!0;break;case"BINORMAL":l=!0}var p;return t&&i&&n&&a&&r&&s&&h&&o?p=He.vertexDeclaration:t&&i&&n&&a&&r&&s&&h?p=Ue.vertexDeclaration:t&&i&&a&&r&&s&&h&&o?p=tt.vertexDeclaration:t&&i&&a&&r&&s&&h?p=$e.vertexDeclaration:t&&i&&n&&a&&s&&h&&o?p=je.vertexDeclaration:t&&i&&n&&a&&s&&h?p=Ye.vertexDeclaration:t&&i&&a&&s&&h&&o?p=ot.vertexDeclaration:t&&i&&a&&s&&h?p=at.vertexDeclaration:t&&i&&n&&s&&h&&o?p=Re.vertexDeclaration:t&&i&&n&&s&&h?p=Ne.vertexDeclaration:t&&i&&n&&a&&r&&o?p=Xe.vertexDeclaration:t&&i&&n&&a&&r?p=Ve.vertexDeclaration:t&&i&&a&&r&&o?p=nt.vertexDeclaration:t&&i&&a&&r?p=Qe.vertexDeclaration:t&&i&&n&&a&&o?p=qe.vertexDeclaration:t&&i&&a&&o&&l?p=lt.vertexDeclaration:t&&i&&n&&a?p=Oe.vertexDeclaration:t&&i&&a&&o?p=ht.vertexDeclaration:t&&i&&a?p=Ze.vertexDeclaration:t&&i&&n&&o?p=Pe.vertexDeclaration:t&&i&&n&&(p=De.vertexDeclaration),p},e._attrReg=new RegExp("(\\w+)|([:,;])","g"),e._strings=[],e._readData=null,e._version=null,e._mesh=null,e._materials=null,e._subMeshes=null,e._materialMap=null,n(e,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),e}(),yt=function(){function e(){}return a(e,"laya.d3.loaders.LoadModelV03"),e.parse=function(t,i,n,a,r){e._mesh=n,e._subMeshes=a,e._materialMap=r,e._version=i,e._readData=t,e.READ_DATA(),e.READ_BLOCK(),e.READ_STRINGS();for(var o=0,s=e._BLOCK.count;o<s;o++){e._readData.pos=e._BLOCK.blockStarts[o];var h=e._readData.getUint16(),l=e._strings[h],c=e["READ_"+l];if(null==c)throw new Error("model file err,no this function:"+h+" "+l);c.call()}e._strings.length=0,e._readData=null,e._version=null,e._mesh=null,e._subMeshes=null,e._materialMap=null},e._readString=function(){return e._strings[e._readData.getUint16()]},e.READ_DATA=function(){e._DATA.offset=e._readData.getUint32(),e._DATA.size=e._readData.getUint32()},e.READ_BLOCK=function(){for(var t=e._BLOCK.count=e._readData.getUint16(),i=e._BLOCK.blockStarts=[],n=e._BLOCK.blockLengths=[],a=0;a<t;a++)i.push(e._readData.getUint32()),n.push(e._readData.getUint32())},e.READ_STRINGS=function(){var t=e._readData.getUint32(),i=e._readData.getUint16(),n=e._readData.pos;e._readData.pos=t+e._DATA.offset;for(var a=0;a<i;a++)e._strings[a]=e._readData.readUTFString();e._readData.pos=n},e.READ_MESH=function(){e._readString();var t=e._readData.__getBuffer(),i=0,n=0,a=e._readData.getInt16(),r=e._DATA.offset;for(i=0;i<a;i++){var o,s=r+e._readData.getUint32(),h=e._readData.getUint32(),l=new Float32Array(t.slice(s,s+h)),c=e._readString();switch(e._version){case"LAYAMODEL:03":o=e._vertexDeclarationMap_Discard[c];break;case"LAYAMODEL:0301":o=e._vertexDeclarationMap[c];break;default:throw new Error("LoadModelV03: unknown version.")}if(!o)throw new Error("LoadModelV03: unknown vertexDeclaration.");var p=qi.create(o,4*l.length/o.vertexStride,35044,!0);p.setData(l),e._mesh._vertexBuffers.push(p)}var u=r+e._readData.getUint32(),d=e._readData.getUint32(),_=new Uint16Array(t.slice(u,u+d)),m=Wi.create("ushort",d/2,35044,!0);m.setData(_),e._mesh._indexBuffer=m;var f=e._mesh._boneNames=[],g=e._readData.getUint16();for(f.length=g,i=0;i<g;i++)f[i]=e._strings[e._readData.getUint16()];e._readData.pos+=8;var y=e._readData.getUint32(),v=e._readData.getUint32(),x=new Float32Array(t.slice(r+y,r+y+v));for(e._mesh._inverseBindPoses=[],i=0,n=x.length;i<n;i+=16){var b=new Ct(x[i+0],x[i+1],x[i+2],x[i+3],x[i+4],x[i+5],x[i+6],x[i+7],x[i+8],x[i+9],x[i+10],x[i+11],x[i+12],x[i+13],x[i+14],x[i+15]);e._mesh._inverseBindPoses.push(b)}return e._mesh._skinnedDatas=new Float32Array(16*x.length),!0},e.READ_SUBMESH=function(){var t=e._readData.__getBuffer(),i=new Ot(e._mesh),n=e._readData.getInt16(),a=e._readData.getUint32(),r=e._readData.getUint32();i._vertexBuffer=e._mesh._vertexBuffers[n],i._vertexStart=a,i._vertexCount=r;var o=e._readData.getUint32(),s=e._readData.getUint32(),h=e._mesh._indexBuffer;i._indexBuffer=h,i._indexStart=o,i._indexCount=s,i._indices=new Uint16Array(h.getData().buffer,2*o,s);var l=e._DATA.offset,c=i._subIndexBufferStart,p=i._subIndexBufferCount,u=i._boneIndicesList,d=e._readData.getUint16();c.length=d,p.length=d,u.length=d;for(var _=0;_<d;_++){c[_]=e._readData.getUint32(),p[_]=e._readData.getUint32();var m=e._readData.getUint32(),f=e._readData.getUint32();u[_]=new Uint8Array(t.slice(l+m,l+m+f))}return e._subMeshes.push(i),!0},e._strings=[],e._readData=null,e._version=null,e._mesh=null,e._subMeshes=null,e._materialMap=null,n(e,["_vertexDeclarationMap_Discard",function(){return this._vertexDeclarationMap_Discard={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":He.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":Ue.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":ct.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":tt.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":$e.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":je.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":Ye.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":ot.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":at.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":Re.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":Ne.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":Xe.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":Ve.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":nt.vertexDeclaration,"POSITION,NORMAL,UV,UV1":Qe.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":qe.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":lt.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":Oe.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":ht.vertexDeclaration,"POSITION,NORMAL,UV":Ze.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":Pe.vertexDeclaration,"POSITION,NORMAL,COLOR":De.vertexDeclaration,"POSITION,NORMAL,TANGENT":Je.vertexDeclaration,"POSITION,NORMAL":Le.vertexDeclaration,"POSITION,UV":dt.vertexDeclaration,POSITION:Te.vertexDeclaration}},"_vertexDeclarationMap",function(){return this._vertexDeclarationMap={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":Fe.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":Ue.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":ct.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":et.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":$e.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":Ge.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":Ye.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":rt.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":at.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":Ae.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":Ne.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":ze.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":Ve.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":it.vertexDeclaration,"POSITION,NORMAL,UV,UV1":Qe.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":We.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":lt.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":Oe.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":st.vertexDeclaration,"POSITION,NORMAL,UV":Ze.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":Be.vertexDeclaration,"POSITION,NORMAL,COLOR":De.vertexDeclaration,"POSITION,NORMAL,TANGENT":Ke.vertexDeclaration,"POSITION,NORMAL":Le.vertexDeclaration,"POSITION,UV":dt.vertexDeclaration,POSITION:Te.vertexDeclaration}},"_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),e}(),vt=function(){function e(){}return a(e,"laya.d3.loaders.MeshReader"),e.read=function(t,i,n,a,r){var o=new _(t);o.pos=0;var s=o.readUTFString();switch(s){case"LAYAMODEL:01":case"LAYASKINANI:01":e._readVersion01(o,s,i,n,a,r);break;case"LAYAMODEL:02":gt.parse(o,s,i,n,a,r);break;case"LAYAMODEL:03":case"LAYAMODEL:0301":yt.parse(o,s,i,a,r);break;default:throw new Error("MeshReader: unknown mesh version.")}i._setSubMeshes(a)},e._readVersion01=function(e,t,i,n,a,r){new ft(e,t,i,n,a,r)},e}(),xt=function(){function e(e,t){this.min=null,this.max=null,this.min=e,this.max=t}a(e,"laya.d3.math.BoundBox");var t=e.prototype;return i.imps(t,{"laya.d3.core.IClone":!0}),t.getCorners=function(e){e.length=8;var t=this.min.elements,i=this.max.elements,n=t[0],a=t[1],r=t[2],o=i[0],s=i[1],h=i[2];e[0]=new At(n,s,h),e[1]=new At(o,s,h),e[2]=new At(o,a,h),e[3]=new At(n,a,h),e[4]=new At(n,s,r),e[5]=new At(o,s,r),e[6]=new At(o,a,r),e[7]=new At(n,a,r)},t.toDefault=function(){this.min.toDefault(),this.max.toDefault()},t.cloneTo=function(e){var t=e;this.min.cloneTo(t.min),this.max.cloneTo(t.max)},t.clone=function(){var e=new this.constructor(new At,new At);return this.cloneTo(e),e},e.createfromPoints=function(e,t){if(null==e)throw new Error("points");var i=t.min,n=t.max,a=i.elements;a[0]=Number.MAX_VALUE,a[1]=Number.MAX_VALUE,a[2]=Number.MAX_VALUE;var r=n.elements;r[0]=-Number.MAX_VALUE,r[1]=-Number.MAX_VALUE,r[2]=-Number.MAX_VALUE;for(var o=0,s=e.length;o<s;++o)At.min(i,e[o],i),At.max(n,e[o],n)},e.merge=function(e,t,i){At.min(e.min,t.min,i.min),At.max(e.max,t.max,i.max)},e}(),bt=function(){function e(t){this._matrix=null,this._near=null,this._far=null,this._left=null,this._right=null,this._top=null,this._bottom=null,this._matrix=t,this._near=new Et(new At),this._far=new Et(new At),this._left=new Et(new At),this._right=new Et(new At),this._top=new Et(new At),this._bottom=new Et(new At),e._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}a(e,"laya.d3.math.BoundFrustum");var t=e.prototype;return t.equalsBoundFrustum=function(e){return this._matrix.equalsOtherMatrix(e.matrix)},t.equalsObj=function(e){if(e instanceof laya.d3.math.BoundFrustum){var t=e;return this.equalsBoundFrustum(t)}return!1},t.getPlane=function(e){switch(e){case 0:return this._near;case 1:return this._far;case 2:return this._left;case 3:return this._right;case 4:return this._top;case 5:return this._bottom;default:return null}},t.getCorners=function(t){e._get3PlaneInterPoint(this._near,this._bottom,this._right).cloneTo(t[0]),e._get3PlaneInterPoint(this._near,this._top,this._right).cloneTo(t[1]),e._get3PlaneInterPoint(this._near,this._top,this._left).cloneTo(t[2]),e._get3PlaneInterPoint(this._near,this._bottom,this._left).cloneTo(t[3]),e._get3PlaneInterPoint(this._far,this._bottom,this._right).cloneTo(t[4]),e._get3PlaneInterPoint(this._far,this._top,this._right).cloneTo(t[5]),e._get3PlaneInterPoint(this._far,this._top,this._left).cloneTo(t[6]),e._get3PlaneInterPoint(this._far,this._bottom,this._left).cloneTo(t[7])},t.containsPoint=function(e){for(var t=Et.PlaneIntersectionType_Front,i=Et.PlaneIntersectionType_Front,n=0;n<6;n++){switch(n){case 0:i=St.intersectsPlaneAndPoint(this._near,e);break;case 1:i=St.intersectsPlaneAndPoint(this._far,e);break;case 2:i=St.intersectsPlaneAndPoint(this._left,e);break;case 3:i=St.intersectsPlaneAndPoint(this._right,e);break;case 4:i=St.intersectsPlaneAndPoint(this._top,e);break;case 5:i=St.intersectsPlaneAndPoint(this._bottom,e)}switch(i){case Et.PlaneIntersectionType_Back:return 0;case Et.PlaneIntersectionType_Intersecting:t=Et.PlaneIntersectionType_Intersecting}}switch(t){case Et.PlaneIntersectionType_Intersecting:return 2;default:return 1}},t.containsBoundBox=function(t){for(var i,n=e._tempV30,a=e._tempV31,r=1,o=0;o<6;o++){if(i=this.getPlane(o),this._getBoxToPlanePVertexNVertex(t,i.normal,n,a),St.intersectsPlaneAndPoint(i,n)===Et.PlaneIntersectionType_Back)return 0;St.intersectsPlaneAndPoint(i,a)===Et.PlaneIntersectionType_Back&&(r=2)}return r},t.containsBoundSphere=function(e){for(var t=Et.PlaneIntersectionType_Front,i=Et.PlaneIntersectionType_Front,n=0;n<6;n++){switch(n){case 0:i=St.intersectsPlaneAndSphere(this._near,e);break;case 1:i=St.intersectsPlaneAndSphere(this._far,e);break;case 2:i=St.intersectsPlaneAndSphere(this._left,e);break;case 3:i=St.intersectsPlaneAndSphere(this._right,e);break;case 4:i=St.intersectsPlaneAndSphere(this._top,e);break;case 5:i=St.intersectsPlaneAndSphere(this._bottom,e)}switch(i){case Et.PlaneIntersectionType_Back:return 0;case Et.PlaneIntersectionType_Intersecting:t=Et.PlaneIntersectionType_Intersecting}}switch(t){case Et.PlaneIntersectionType_Intersecting:return 2;default:return 1}},t._getBoxToPlanePVertexNVertex=function(e,t,i,n){var a=e.min,r=a.elements,o=e.max,s=o.elements,h=t.elements,l=h[0],c=h[1],p=h[2];a.cloneTo(i);var u=i.elements;l>=0&&(u[0]=s[0]),c>=0&&(u[1]=s[1]),p>=0&&(u[2]=s[2]),o.cloneTo(n);var d=n.elements;l>=0&&(d[0]=r[0]),c>=0&&(d[1]=r[1]),p>=0&&(d[2]=r[2])},r(0,t,"top",function(){return this._top}),r(0,t,"matrix",function(){return this._matrix},function(t){this._matrix=t,e._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}),r(0,t,"near",function(){return this._near}),r(0,t,"far",function(){return this._far}),r(0,t,"left",function(){return this._left}),r(0,t,"right",function(){return this._right}),r(0,t,"bottom",function(){return this._bottom}),e._getPlanesFromMatrix=function(e,t,i,n,a,r,o){var s=e.elements,h=s[0],l=s[1],c=s[2],p=s[3],u=s[4],d=s[5],_=s[6],m=s[7],f=s[8],g=s[9],y=s[10],v=s[11],x=s[12],b=s[13],w=s[14],S=s[15],I=t.normal.elements;I[0]=p+c,I[1]=m+_,I[2]=v+y,t.distance=S+w,t.normalize();var M=i.normal.elements;M[0]=p-c,M[1]=m-_,M[2]=v-y,i.distance=S-w,i.normalize();var C=n.normal.elements;C[0]=p+h,C[1]=m+u,C[2]=v+f,n.distance=S+x,n.normalize();var k=a.normal.elements;k[0]=p-h,k[1]=m-u,k[2]=v-f,a.distance=S-x,a.normalize();var E=r.normal.elements;E[0]=p-l,E[1]=m-d,E[2]=v-g,r.distance=S-b,r.normalize();var T=o.normal.elements;T[0]=p+l,T[1]=m+d,T[2]=v+g,o.distance=S+b,o.normalize()},e._get3PlaneInterPoint=function(t,i,n){var a=t.normal,r=i.normal,o=n.normal;At.cross(r,o,e._tempV30),At.cross(o,a,e._tempV31),At.cross(a,r,e._tempV32);var s=At.dot(a,e._tempV30),h=At.dot(r,e._tempV31),l=At.dot(o,e._tempV32);At.scale(e._tempV30,-t.distance/s,e._tempV33),At.scale(e._tempV31,-i.distance/h,e._tempV34),At.scale(e._tempV32,-n.distance/l,e._tempV35),At.add(e._tempV33,e._tempV34,e._tempV36),At.add(e._tempV35,e._tempV36,e._tempV37);return e._tempV37},n(e,["_tempV30",function(){return this._tempV30=new At},"_tempV31",function(){return this._tempV31=new At},"_tempV32",function(){return this._tempV32=new At},"_tempV33",function(){return this._tempV33=new At},"_tempV34",function(){return this._tempV34=new At},"_tempV35",function(){return this._tempV35=new At},"_tempV36",function(){return this._tempV36=new At},"_tempV37",function(){return this._tempV37=new At}]),e}(),wt=function(){function e(e,t){this.center=null,this.radius=NaN,this.center=e,this.radius=t}a(e,"laya.d3.math.BoundSphere");var t=e.prototype;return i.imps(t,{"laya.d3.core.IClone":!0}),t.toDefault=function(){this.center.toDefault(),this.radius=0},t.intersectsRayDistance=function(e){return St.intersectsRayAndSphereRD(e,this)},t.intersectsRayPoint=function(e,t){return St.intersectsRayAndSphereRP(e,this,t)},t.cloneTo=function(e){var t=e;this.center.cloneTo(t.center),t.radius=this.radius},t.clone=function(){var e=new this.constructor(new At,new At);return this.cloneTo(e),e},e.createFromSubPoints=function(t,i,n,a){if(null==t)throw new Error("points");if(i<0||i>=t.length)throw new Error("start"+i+"Must be in the range [0, "+(t.length-1)+"]");if(n<0||i+n>t.length)throw new Error("count"+n+"Must be in the range <= "+t.length+"}");var r=i+n,o=e._tempVector3;o.elements[0]=0,o.elements[1]=0,o.elements[2]=0;for(var s=i;s<r;++s)At.add(t[s],o,o);var h=a.center;At.scale(o,1/n,h);var l=0;for(s=i;s<r;++s){var c=At.distanceSquared(h,t[s]);c>l&&(l=c)}a.radius=Math.sqrt(l)},e.createfromPoints=function(t,i){if(null==t)throw new Error("points");e.createFromSubPoints(t,0,t.length,i)},n(e,["_tempVector3",function(){return this._tempVector3=new At}]),e}(),St=function(){function e(){}return a(e,"laya.d3.math.Collision"),e.distancePlaneToPoint=function(e,t){return At.dot(e.normal,t)-e.distance},e.distanceBoxToPoint=function(e,t){var i=e.min.elements,n=i[0],a=i[1],r=i[2],o=e.max.elements,s=o[0],h=o[1],l=o[2],c=t.elements,p=c[0],u=c[1],d=c[2],_=0;return p<n&&(_+=(n-p)*(n-p)),p>s&&(_+=(s-p)*(s-p)),u<a&&(_+=(a-u)*(a-u)),u>h&&(_+=(h-u)*(h-u)),d<r&&(_+=(r-d)*(r-d)),d>l&&(_+=(l-d)*(l-d)),Math.sqrt(_)},e.distanceBoxToBox=function(e,t){var i=e.min.elements,n=i[0],a=i[1],r=i[2],o=e.max.elements,s=o[0],h=o[1],l=o[2],c=t.min.elements,p=c[0],u=c[1],d=c[2],_=t.max.elements,m=_[0],f=_[1],g=_[2],y=0,v=NaN;return n>m?y+=(v=n-m)*v:p>s&&(y+=(v=p-s)*v),a>f?y+=(v=a-f)*v:u>h&&(y+=(v=u-h)*v),r>g?y+=(v=r-g)*v:d>l&&(y+=(v=d-l)*v),Math.sqrt(y)},e.distanceSphereToPoint=function(e,t){var i=Math.sqrt(At.distanceSquared(e.center,t));return i-=e.radius,Math.max(i,0)},e.distanceSphereToSphere=function(e,t){var i=Math.sqrt(At.distanceSquared(e.center,t.center));return i-=e.radius+t.radius,Math.max(i,0)},e.intersectsRayAndTriangleRD=function(t,i,n,a,r){var o=t.origin.elements,s=o[0],h=o[1],l=o[2],c=t.direction.elements,p=c[0],u=c[1],d=c[2],_=i.elements,m=_[0],f=_[1],g=_[2],y=n.elements,v=y[0],x=y[1],b=y[2],w=a.elements,S=w[0],I=w[1],M=w[2],C=e._tempV30.elements,k=C[0],E=C[1],T=C[2];k=v-m,E=x-f,T=b-g;var L=e._tempV31.elements,D=L[0],N=L[1],A=L[2];D=S-m,N=I-f,A=M-g;var R=e._tempV32.elements,B=R[0],P=R[1],O=R[2],V=k*(B=u*A-d*N)+E*(P=d*D-p*A)+T*(O=p*N-u*D);if(It.isZero(V))return 0,!1;var U=1/V,F=e._tempV33.elements,H=F[0],z=F[1],X=F[2],Y=(H=s-m)*B+(z=h-f)*P+(X=l-g)*O;if((Y*=U)<0||Y>1)return 0,!1;var G=e._tempV34.elements,j=G[0],W=G[1],q=G[2],K=p*(j=z*T-X*E)+u*(W=X*k-H*T)+d*(q=H*E-z*k);if((K*=U)<0||Y+K>1)return 0,!1;var J=D*j+N*W+A*q;return(J*=U)<0?(0,!1):(J,!0)},e.intersectsRayAndTriangleRP=function(t,i,n,a,r){return e.intersectsRayAndTriangleRD(t,i,n,a,NaN)?(At.scale(t.direction,NaN,e._tempV30),At.add(t.origin,e._tempV30,r),!0):(r=At.ZERO,!1)},e.intersectsRayAndPoint=function(t,i){At.subtract(t.origin,i,e._tempV30);var n=At.dot(e._tempV30,t.direction),a=At.dot(e._tempV30,e._tempV30)-It.zeroTolerance;if(a>0&&n>0)return!1;return!(n*n-a<0)},e.intersectsRayAndRay=function(t,i,n){var a=t.origin,r=a.elements,o=r[0],s=r[1],h=r[2],l=t.direction,c=l.elements,p=c[0],u=c[1],d=c[2],_=i.origin,m=_.elements,f=m[0],g=m[1],y=m[2],v=i.direction,x=v.elements,b=x[0],w=x[1],S=x[2];At.cross(l,v,e._tempV30);var I=e._tempV30.elements,M=At.scalarLengthSquared(e._tempV30);if(It.isZero(M)&&It.nearEqual(f,o)&&It.nearEqual(g,s)&&It.nearEqual(y,h))return At.ZERO.cloneTo(n),!0;var C=f-o,k=g-s,E=y-h,T=b,L=w,D=S,N=I[0],A=I[1],R=I[2],B=(C*L*R+k*D*N+E*T*A-C*D*A-k*T*R-E*L*N)/M,P=(C*(L=u)*R+k*(D=d)*N+E*(T=p)*A-C*D*A-k*T*R-E*L*N)/M;At.scale(l,B,e._tempV30),At.scale(v,P,e._tempV31),At.add(a,e._tempV30,e._tempV32),At.add(_,e._tempV31,e._tempV33);var O=e._tempV32.elements,V=e._tempV33.elements;return It.nearEqual(V[0],O[0])&&It.nearEqual(V[1],O[1])&&It.nearEqual(V[2],O[2])?(e._tempV32.cloneTo(n),!0):(At.ZERO.cloneTo(n),!1)},e.intersectsPlaneAndTriangle=function(t,i,n,a){var r=e.intersectsPlaneAndPoint(t,i),o=e.intersectsPlaneAndPoint(t,n),s=e.intersectsPlaneAndPoint(t,a);return r==Et.PlaneIntersectionType_Front&&o==Et.PlaneIntersectionType_Front&&s==Et.PlaneIntersectionType_Front?Et.PlaneIntersectionType_Front:r==Et.PlaneIntersectionType_Back&&o==Et.PlaneIntersectionType_Back&&s==Et.PlaneIntersectionType_Back?Et.PlaneIntersectionType_Back:Et.PlaneIntersectionType_Intersecting},e.intersectsRayAndPlaneRD=function(e,t,i){var n=t.normal,a=At.dot(n,e.direction);if(It.isZero(a))return 0,!1;var r=At.dot(n,e.origin);return!((-t.distance-r)/a<0)},e.intersectsRayAndPlaneRP=function(t,i,n){return e.intersectsRayAndPlaneRD(t,i,NaN)?(At.scale(t.direction,NaN,e._tempV30),At.add(t.origin,e._tempV30,e._tempV31),e._tempV31,!0):(At.ZERO,!1)},e.intersectsRayAndBoxRD=function(e,t){var i=e.origin.elements,n=i[0],a=i[1],r=i[2],o=e.direction.elements,s=o[0],h=o[1],l=o[2],c=t.min.elements,p=c[0],u=c[1],d=c[2],_=t.max.elements,m=_[0],f=_[1],g=_[2],y=0,v=It.MaxValue;if(It.isZero(s)){if(n<p||n>m)return-1}else{var x=1/s,b=(p-n)*x,w=(m-n)*x;if(b>w){var S=b;b=w,w=S}if(y=Math.max(b,y),v=Math.min(w,v),y>v)return-1}if(It.isZero(h)){if(a<u||a>f)return-1}else{var I=1/h,M=(u-a)*I,C=(f-a)*I;if(M>C){var k=M;M=C,C=k}if(y=Math.max(M,y),v=Math.min(C,v),y>v)return-1}if(It.isZero(l)){if(r<d||r>g)return-1}else{var E=1/l,T=(d-r)*E,L=(g-r)*E;if(T>L){var D=T;T=L,L=D}if(y=Math.max(T,y),v=Math.min(L,v),y>v)return-1}return y},e.intersectsRayAndBoxRP=function(t,i,n){var a=e.intersectsRayAndBoxRD(t,i);return-1===a?(At.ZERO.cloneTo(n),a):(At.scale(t.direction,a,e._tempV30),At.add(t.origin,e._tempV30,e._tempV31),e._tempV31.cloneTo(n),a)},e.intersectsRayAndSphereRD=function(t,i){var n=i.radius;At.subtract(t.origin,i.center,e._tempV30);var a=At.dot(e._tempV30,t.direction),r=At.dot(e._tempV30,e._tempV30)-n*n;if(r>0&&a>0)return-1;var o=a*a-r;if(o<0)return-1;var s=-a-Math.sqrt(o);return s<0&&(s=0),s},e.intersectsRayAndSphereRP=function(t,i,n){var a=e.intersectsRayAndSphereRD(t,i);return-1===a?(At.ZERO.cloneTo(n),a):(At.scale(t.direction,a,e._tempV30),At.add(t.origin,e._tempV30,e._tempV31),e._tempV31.cloneTo(n),a)},e.intersectsSphereAndTriangle=function(t,i,n,a){var r=t.center,o=t.radius;e.closestPointPointTriangle(r,i,n,a,e._tempV30),At.subtract(e._tempV30,r,e._tempV31);return At.dot(e._tempV31,e._tempV31)<=o*o},e.intersectsPlaneAndPoint=function(e,t){var i=At.dot(e.normal,t)+e.distance;return i>0?Et.PlaneIntersectionType_Front:i<0?Et.PlaneIntersectionType_Back:Et.PlaneIntersectionType_Intersecting},e.intersectsPlaneAndPlane=function(t,i){At.cross(t.normal,i.normal,e._tempV30);var n=At.dot(e._tempV30,e._tempV30);return!It.isZero(n)},e.intersectsPlaneAndPlaneRL=function(t,i,n){var a=t.normal,r=i.normal;At.cross(a,r,e._tempV34);var o=At.dot(e._tempV34,e._tempV34);return!It.isZero(o)&&(At.scale(r,t.distance,e._tempV30),At.scale(a,i.distance,e._tempV31),At.subtract(e._tempV30,e._tempV31,e._tempV32),At.cross(e._tempV32,e._tempV34,e._tempV33),At.normalize(e._tempV34,e._tempV34),new Dt(e._tempV33,e._tempV34),!0)},e.intersectsPlaneAndBox=function(t,i){var n=t.distance,a=t.normal,r=a.elements,o=r[0],s=r[1],h=r[2],l=i.min.elements,c=l[0],p=l[1],u=l[2],d=i.max.elements,_=d[0],m=d[1],f=d[2];e._tempV30.elements[0]=o>0?c:_,e._tempV30.elements[1]=s>0?p:m,e._tempV30.elements[2]=h>0?u:f,e._tempV31.elements[0]=o>0?_:c,e._tempV31.elements[1]=s>0?m:p,e._tempV31.elements[2]=h>0?f:u;var g=At.dot(a,e._tempV30);return g+n>0?Et.PlaneIntersectionType_Front:(g=At.dot(a,e._tempV31))+n<0?Et.PlaneIntersectionType_Back:Et.PlaneIntersectionType_Intersecting},e.intersectsPlaneAndSphere=function(e,t){var i=t.radius,n=At.dot(e.normal,t.center)+e.distance;return n>i?Et.PlaneIntersectionType_Front:n<-i?Et.PlaneIntersectionType_Back:Et.PlaneIntersectionType_Intersecting},e.intersectsBoxAndBox=function(e,t){var i=e.min.elements,n=e.max.elements,a=t.min.elements,r=t.max.elements;return!(i[0]>r[0]||a[0]>n[0])&&(!(i[1]>r[1]||a[1]>n[1])&&!(i[2]>r[2]||a[2]>n[2]))},e.intersectsBoxAndSphere=function(t,i){var n=i.center,a=i.radius;At.Clamp(n,t.min,t.max,e._tempV30);return At.distanceSquared(n,e._tempV30)<=a*a},e.intersectsSphereAndSphere=function(e,t){var i=e.radius+t.radius;return At.distanceSquared(e.center,t.center)<=i*i},e.boxContainsPoint=function(e,t){var i=e.min.elements,n=e.max.elements,a=t.elements;return i[0]<=a[0]&&n[0]>=a[0]&&i[1]<=a[1]&&n[1]>=a[1]&&i[2]<=a[2]&&n[2]>=a[2]?1:0},e.boxContainsBox=function(e,t){var i=e.min.elements,n=i[0],a=i[1],r=i[2],o=e.max.elements,s=o[0],h=o[1],l=o[2],c=t.min.elements,p=c[0],u=c[1],d=c[2],_=t.max.elements,m=_[0],f=_[1],g=_[2];return s<p||n>m?0:h<u||a>f?0:l<d||r>g?0:n<=p&&m<=m&&a<=u&&f<=h&&r<=d&&g<=l?1:2},e.boxContainsSphere=function(t,i){var n=t.min,a=n.elements,r=a[0],o=a[1],s=a[2],h=t.max,l=h.elements,c=l[0],p=l[1],u=l[2],d=i.center,_=d.elements,m=_[0],f=_[1],g=_[2],y=i.radius;At.Clamp(d,n,h,e._tempV30);return At.distanceSquared(d,e._tempV30)>y*y?0:r+y<=m&&m<=c-y&&c-r>y&&o+y<=f&&f<=p-y&&p-o>y&&s+y<=g&&g<=u-y&&u-s>y?1:2},e.sphereContainsPoint=function(e,t){return At.distanceSquared(t,e.center)<=e.radius*e.radius?1:0},e.sphereContainsTriangle=function(t,i,n,a){var r=e.sphereContainsPoint(t,i),o=e.sphereContainsPoint(t,n),s=e.sphereContainsPoint(t,a);return 1==r&&1==o&&1==s?1:e.intersectsSphereAndTriangle(t,i,n,a)?2:0},e.sphereContainsBox=function(t,i){var n=t.center.elements,a=n[0],r=n[1],o=n[2],s=t.radius,h=i.min.elements,l=h[0],c=h[1],p=h[2],u=i.max.elements,d=u[0],_=u[1],m=u[2],f=e._tempV30.elements;f[0],f[1],f[2];if(!e.intersectsBoxAndSphere(i,t))return 0;var g=s*s;return a-l,r-_,o-m,At.scalarLengthSquared(e._tempV30)>g?2:(a-d,r-_,o-m,At.scalarLengthSquared(e._tempV30)>g?2:(a-d,r-c,o-m,At.scalarLengthSquared(e._tempV30)>g?2:(a-l,r-c,o-m,At.scalarLengthSquared(e._tempV30)>g?2:(a-l,r-_,o-p,At.scalarLengthSquared(e._tempV30)>g?2:(a-d,r-_,o-p,At.scalarLengthSquared(e._tempV30)>g?2:(a-d,r-c,o-p,At.scalarLengthSquared(e._tempV30)>g?2:(a-l,r-c,o-p,At.scalarLengthSquared(e._tempV30)>g?2:1)))))))},e.sphereContainsSphere=function(e,t){var i=e.radius,n=t.radius,a=At.distance(e.center,t.center);return i+n<a?0:i-n<a?2:1},e.closestPointPointTriangle=function(t,i,n,a,r){At.subtract(n,i,e._tempV30),At.subtract(a,i,e._tempV31),At.subtract(t,i,e._tempV32),At.subtract(t,n,e._tempV33),At.subtract(t,a,e._tempV34);var o=At.dot(e._tempV30,e._tempV32),s=At.dot(e._tempV31,e._tempV32),h=At.dot(e._tempV30,e._tempV33),l=At.dot(e._tempV31,e._tempV33),c=At.dot(e._tempV30,e._tempV34),p=At.dot(e._tempV31,e._tempV34);if(o<=0&&s<=0)i.cloneTo(r);else if(h>=0&&l<=h)n.cloneTo(r);else{var u=o*l-h*s;if(u<=0&&o>=0&&h<=0){var d=o/(o-h);return At.scale(e._tempV30,d,r),void At.add(i,r,r)}if(p>=0&&c<=p)a.cloneTo(r);else{var _=c*s-o*p;if(_<=0&&s>=0&&p<=0){var m=s/(s-p);return At.scale(e._tempV31,m,r),void At.add(i,r,r)}var f=h*p-c*l;if(f<=0&&l-h>=0&&c-p>=0){var g=(l-h)/(l-h+(c-p));return At.subtract(a,n,r),At.scale(r,g,r),void At.add(n,r,r)}var y=1/(f+_+u),v=_*y,x=u*y;At.scale(e._tempV30,v,e._tempV35),At.scale(e._tempV31,x,e._tempV36),At.add(e._tempV35,e._tempV36,r),At.add(i,r,r)}}},e.closestPointPlanePoint=function(t,i,n){var a=t.normal,r=At.dot(a,i)-t.distance;At.scale(a,r,e._tempV30),At.subtract(i,e._tempV30,n)},e.closestPointBoxPoint=function(t,i,n){At.max(i,t.min,e._tempV30),At.min(e._tempV30,t.max,n)},e.closestPointSpherePoint=function(e,t,i){var n=e.center;At.subtract(t,n,i),At.normalize(i,i),At.scale(i,e.radius,i),At.add(i,n,i)},e.closestPointSphereSphere=function(e,t,i){var n=e.center;At.subtract(t.center,n,i),At.normalize(i,i),At.scale(i,e.radius,i),At.add(i,n,i)},n(e,["_tempV30",function(){return this._tempV30=new At},"_tempV31",function(){return this._tempV31=new At},"_tempV32",function(){return this._tempV32=new At},"_tempV33",function(){return this._tempV33=new At},"_tempV34",function(){return this._tempV34=new At},"_tempV35",function(){return this._tempV35=new At},"_tempV36",function(){return this._tempV36=new At}]),e}(),It=(function(){function e(){}a(e,"laya.d3.math.ContainmentType"),e.Disjoint=0,e.Contains=1,e.Intersects=2}(),function(){function e(){}return a(e,"laya.d3.math.MathUtils3D"),e.isZero=function(t){return Math.abs(t)<e.zeroTolerance},e.nearEqual=function(t,i){return!!e.isZero(t-i)},e.fastInvSqrt=function(t){return e.isZero(t)?t:1/Math.sqrt(t)},n(e,["zeroTolerance",function(){return this.zeroTolerance=1e-6},"MaxValue",function(){return this.MaxValue=3.40282347e38},"MinValue",function(){return this.MinValue=-3.40282347e38}]),e}()),Mt=function(){function e(){var e=this.elements=new Float32Array(9);e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1}a(e,"laya.d3.math.Matrix3x3");var t=e.prototype;return i.imps(t,{"laya.d3.core.IClone":!0}),t.determinant=function(){var e=this.elements,t=e[0],i=e[1],n=e[2],a=e[3],r=e[4],o=e[5],s=e[6],h=e[7],l=e[8];return t*(l*r-o*h)+i*(-l*a+o*s)+n*(h*a-r*s)},t.translate=function(e,t){var i=t.elements,n=this.elements,a=e.elements,r=n[0],o=n[1],s=n[2],h=n[3],l=n[4],c=n[5],p=n[6],u=n[7],d=n[8],_=a[0],m=a[1];i[0]=r,i[1]=o,i[2]=s,i[3]=h,i[4]=l,i[5]=c,i[6]=_*r+m*h+p,i[7]=_*o+m*l+u,i[8]=_*s+m*c+d},t.rotate=function(e,t){var i=t.elements,n=this.elements,a=n[0],r=n[1],o=n[2],s=n[3],h=n[4],l=n[5],c=n[6],p=n[7],u=n[8],d=Math.sin(e),_=Math.cos(e);i[0]=_*a+d*s,i[1]=_*r+d*h,i[2]=_*o+d*l,i[3]=_*s-d*a,i[4]=_*h-d*r,i[5]=_*l-d*o,i[6]=c,i[7]=p,i[8]=u},t.scale=function(e,t){var i=t.elements,n=this.elements,a=e.elements,r=a[0],o=a[1];i[0]=r*n[0],i[1]=r*n[1],i[2]=r*n[2],i[3]=o*n[3],i[4]=o*n[4],i[5]=o*n[5],i[6]=n[6],i[7]=n[7],i[8]=n[8]},t.invert=function(e){var t=e.elements,i=this.elements,n=i[0],a=i[1],r=i[2],o=i[3],s=i[4],h=i[5],l=i[6],c=i[7],p=i[8],u=p*s-h*c,d=-p*o+h*l,_=c*o-s*l,m=n*u+a*d+r*_;m||(e=null),m=1/m,t[0]=u*m,t[1]=(-p*a+r*c)*m,t[2]=(h*a-r*s)*m,t[3]=d*m,t[4]=(p*n-r*l)*m,t[5]=(-h*n+r*o)*m,t[6]=_*m,t[7]=(-c*n+a*l)*m,t[8]=(s*n-a*o)*m},t.transpose=function(e){var t=e.elements,i=this.elements;if(e===this){var n=i[1],a=i[2],r=i[5];t[1]=i[3],t[2]=i[6],t[3]=n,t[5]=i[7],t[6]=a,t[7]=r}else t[0]=i[0],t[1]=i[3],t[2]=i[6],t[3]=i[1],t[4]=i[4],t[5]=i[7],t[6]=i[2],t[7]=i[5],t[8]=i[8]},t.identity=function(){var e=this.elements;e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1},t.cloneTo=function(e){var t,i,n;if(i=this.elements,n=e.elements,i!==n)for(t=0;t<9;++t)n[t]=i[t]},t.clone=function(){var e=new this.constructor;return this.cloneTo(e),e},e.createFromTranslation=function(e,t){t.elements;var i=e.elements;t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=i[0],t[7]=i[1],t[8]=1},e.createFromRotation=function(e,t){var i=t.elements,n=Math.sin(e),a=Math.cos(e);i[0]=a,i[1]=n,i[2]=0,i[3]=-n,i[4]=a,i[5]=0,i[6]=0,i[7]=0,i[8]=1},e.createFromScaling=function(e,t){var i=t.elements,n=e.elements;i[0]=n[0],i[1]=0,i[2]=0,i[3]=0,i[4]=n[1],i[5]=0,i[6]=0,i[7]=0,i[8]=1},e.createFromMatrix4x4=function(e,t){t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10]},e.multiply=function(e,t,i){var n=i.elements,a=e.elements,r=t.elements,o=a[0],s=a[1],h=a[2],l=a[3],c=a[4],p=a[5],u=a[6],d=a[7],_=a[8],m=r[0],f=r[1],g=r[2],y=r[3],v=r[4],x=r[5],b=r[6],w=r[7],S=r[8];n[0]=m*o+f*l+g*u,n[1]=m*s+f*c+g*d,n[2]=m*h+f*p+g*_,n[3]=y*o+v*l+x*u,n[4]=y*s+v*c+x*d,n[5]=y*h+v*p+x*_,n[6]=b*o+w*l+S*u,n[7]=b*s+w*c+S*d,n[8]=b*h+w*p+S*_},e.lookAt=function(t,i,n,a){At.subtract(t,i,e._tempV30),At.normalize(e._tempV30,e._tempV30),At.cross(n,e._tempV30,e._tempV31),At.normalize(e._tempV31,e._tempV31),At.cross(e._tempV30,e._tempV31,e._tempV32);var r=e._tempV30.elements,o=e._tempV31.elements,s=e._tempV32.elements,h=a.elements;h[0]=o[0],h[3]=o[1],h[6]=o[2],h[1]=s[0],h[4]=s[1],h[7]=s[2],h[2]=r[0],h[5]=r[1],h[8]=r[2]},e.DEFAULT=new e,n(e,["_tempV30",function(){return this._tempV30=new At},"_tempV31",function(){return this._tempV31=new At},"_tempV32",function(){return this._tempV32=new At}]),e}(),Ct=function(){function e(e,t,i,n,a,r,o,s,h,l,c,p,u,d,_,m){void 0===e&&(e=1),void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=0),void 0===a&&(a=0),void 0===r&&(r=1),void 0===o&&(o=0),void 0===s&&(s=0),void 0===h&&(h=0),void 0===l&&(l=0),void 0===c&&(c=1),void 0===p&&(p=0),void 0===u&&(u=0),void 0===d&&(d=0),void 0===_&&(_=0),void 0===m&&(m=1);var f=this.elements=new Float32Array(16);f[0]=e,f[1]=t,f[2]=i,f[3]=n,f[4]=a,f[5]=r,f[6]=o,f[7]=s,f[8]=h,f[9]=l,f[10]=c,f[11]=p,f[12]=u,f[13]=d,f[14]=_,f[15]=m}a(e,"laya.d3.math.Matrix4x4");var t=e.prototype;return i.imps(t,{"laya.d3.core.IClone":!0}),t.getElementByRowColumn=function(e,t){if(e<0||e>3)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(t<0||t>3)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");return this.elements[4*e+t]},t.setElementByRowColumn=function(e,t,i){if(e<0||e>3)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(t<0||t>3)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");this.elements[4*e+t]=i},t.equalsOtherMatrix=function(e){var t=this.elements,i=e.elements;return It.nearEqual(t[0],i[0])&&It.nearEqual(t[1],i[1])&&It.nearEqual(t[2],i[2])&&It.nearEqual(t[3],i[3])&&It.nearEqual(t[4],i[4])&&It.nearEqual(t[5],i[5])&&It.nearEqual(t[6],i[6])&&It.nearEqual(t[7],i[7])&&It.nearEqual(t[8],i[8])&&It.nearEqual(t[9],i[9])&&It.nearEqual(t[10],i[10])&&It.nearEqual(t[11],i[11])&&It.nearEqual(t[12],i[12])&&It.nearEqual(t[13],i[13])&&It.nearEqual(t[14],i[14])&&It.nearEqual(t[15],i[15])},t.decomposeTransRotScale=function(t,i,n){var a=e._tempMatrix4x4;return this.decomposeTransRotMatScale(t,a,n)?(Tt.createFromMatrix4x4(a,i),!0):(i.identity(),!1)},t.decomposeTransRotMatScale=function(t,i,n){var a=this.elements,r=t.elements,o=i.elements,s=n.elements;r[0]=a[12],r[1]=a[13],r[2]=a[14];var h=a[0],l=a[1],c=a[2],p=a[4],u=a[5],d=a[6],_=a[8],m=a[9],f=a[10],g=s[0]=Math.sqrt(h*h+l*l+c*c),y=s[1]=Math.sqrt(p*p+u*u+d*d),v=s[2]=Math.sqrt(_*_+m*m+f*f);if(It.isZero(g)||It.isZero(y)||It.isZero(v))return o[1]=o[2]=o[3]=o[4]=o[6]=o[7]=o[8]=o[9]=o[11]=o[12]=o[13]=o[14]=0,o[0]=o[5]=o[10]=o[15]=1,!1;var x=e._tempVector0,b=x.elements;b[0]=_/v,b[1]=m/v,b[2]=f/v;var w=e._tempVector1,S=w.elements;S[0]=h/g,S[1]=l/g,S[2]=c/g;var I=e._tempVector2;At.cross(x,w,I);var M=e._tempVector1;return At.cross(I,x,M),o[3]=o[7]=o[11]=o[12]=o[13]=o[14]=0,o[15]=1,o[0]=M.x,o[1]=M.y,o[2]=M.z,o[4]=I.x,o[5]=I.y,o[6]=I.z,o[8]=x.x,o[9]=x.y,o[10]=x.z,o[0]*h+o[1]*l+o[2]*c<0&&(s[0]=-g),o[4]*p+o[5]*u+o[6]*d<0&&(s[1]=-y),o[8]*_+o[9]*m+o[10]*f<0&&(s[2]=-v),!0},t.decomposeYawPitchRoll=function(e){var t=e.elements,i=Math.asin(-this.elements[9]);t[1]=i;Math.cos(i)>It.zeroTolerance?(t[2]=Math.atan2(this.elements[1],this.elements[5]),t[0]=Math.atan2(this.elements[8],this.elements[10])):(t[2]=Math.atan2(-this.elements[4],this.elements[0]),t[0]=0)},t.normalize=function(){var e=this.elements,t=e[0],i=e[1],n=e[2],a=Math.sqrt(t*t+i*i+n*n);if(!a)return e[0]=0,e[1]=0,void(e[2]=0);1!=a&&(a=1/a,e[0]=t*a,e[1]=i*a,e[2]=n*a)},t.transpose=function(){var e,t;return e=this.elements,t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},t.invert=function(e){var t=this.elements,i=e.elements,n=t[0],a=t[1],r=t[2],o=t[3],s=t[4],h=t[5],l=t[6],c=t[7],p=t[8],u=t[9],d=t[10],_=t[11],m=t[12],f=t[13],g=t[14],y=t[15],v=n*h-a*s,x=n*l-r*s,b=n*c-o*s,w=a*l-r*h,S=a*c-o*h,I=r*c-o*l,M=p*f-u*m,C=p*g-d*m,k=p*y-_*m,E=u*g-d*f,T=u*y-_*f,L=d*y-_*g,D=v*L-x*T+b*E+w*k-S*C+I*M;0!==Math.abs(D)&&(D=1/D,i[0]=(h*L-l*T+c*E)*D,i[1]=(r*T-a*L-o*E)*D,i[2]=(f*I-g*S+y*w)*D,i[3]=(d*S-u*I-_*w)*D,i[4]=(l*k-s*L-c*C)*D,i[5]=(n*L-r*k+o*C)*D,i[6]=(g*b-m*I-y*x)*D,i[7]=(p*I-d*b+_*x)*D,i[8]=(s*T-h*k+c*M)*D,i[9]=(a*k-n*T-o*M)*D,i[10]=(m*S-f*b+y*v)*D,i[11]=(u*b-p*S-_*v)*D,i[12]=(h*C-s*E-l*M)*D,i[13]=(n*E-a*C+r*M)*D,i[14]=(f*x-m*w-g*v)*D,i[15]=(p*w-u*x+d*v)*D)},t.identity=function(){var e=this.elements;e[1]=e[2]=e[3]=e[4]=e[6]=e[7]=e[8]=e[9]=e[11]=e[12]=e[13]=e[14]=0,e[0]=e[5]=e[10]=e[15]=1},t.cloneTo=function(e){var t,i,n;if(i=this.elements,n=e.elements,i!==n)for(t=0;t<16;++t)n[t]=i[t]},t.clone=function(){var e=new this.constructor;return this.cloneTo(e),e},t.getTranslationVector=function(e){var t=this.elements,i=e.elements;i[0]=t[12],i[1]=t[13],i[2]=t[14]},t.setTranslationVector=function(e){var t=this.elements,i=e.elements;t[12]=i[0],t[13]=i[1],t[14]=i[2]},t.getForward=function(e){var t=this.elements,i=e.elements;i[0]=-t[8],i[1]=-t[9],i[2]=-t[10]},t.setForward=function(e){var t=this.elements,i=e.elements;t[8]=-i[0],t[9]=-i[1],t[10]=-i[2]},e.createRotationX=function(e,t){var i=t.elements,n=Math.sin(e),a=Math.cos(e);i[1]=i[2]=i[3]=i[4]=i[7]=i[8]=i[11]=i[12]=i[13]=i[14]=0,i[0]=i[15]=1,i[5]=i[10]=a,i[6]=n,i[9]=-n},e.createRotationY=function(e,t){var i=t.elements,n=Math.sin(e),a=Math.cos(e);i[1]=i[3]=i[4]=i[6]=i[7]=i[9]=i[11]=i[12]=i[13]=i[14]=0,i[5]=i[15]=1,i[0]=i[10]=a,i[2]=-n,i[8]=n},e.createRotationZ=function(e,t){var i=t.elements,n=Math.sin(e),a=Math.cos(e);i[2]=i[3]=i[6]=i[7]=i[8]=i[9]=i[11]=i[12]=i[13]=i[14]=0,i[10]=i[15]=1,i[0]=i[5]=a,i[1]=n,i[4]=-n},e.createRotationYawPitchRoll=function(t,i,n,a){Tt.createFromYawPitchRoll(t,i,n,e._tempQuaternion),e.createRotationQuaternion(e._tempQuaternion,a)},e.createRotationAxis=function(e,t,i){var n=e.elements,a=n[0],r=n[1],o=n[2],s=Math.cos(t),h=Math.sin(t),l=a*a,c=r*r,p=o*o,u=a*r,d=a*o,_=r*o,m=i.elements;m[3]=m[7]=m[11]=m[12]=m[13]=m[14]=0,m[15]=1,m[0]=l+s*(1-l),m[1]=u-s*u+h*o,m[2]=d-s*d-h*r,m[4]=u-s*u-h*o,m[5]=c+s*(1-c),m[6]=_-s*_+h*a,m[8]=d-s*d+h*r,m[9]=_-s*_-h*a,m[10]=p+s*(1-p)},e.createRotationQuaternion=function(e,t){var i=e.elements,n=t.elements,a=i[0],r=i[1],o=i[2],s=i[3],h=a*a,l=r*r,c=o*o,p=a*r,u=o*s,d=o*a,_=r*s,m=r*o,f=a*s;n[3]=n[7]=n[11]=n[12]=n[13]=n[14]=0,n[15]=1,n[0]=1-2*(l+c),n[1]=2*(p+u),n[2]=2*(d-_),n[4]=2*(p-u),n[5]=1-2*(c+h),n[6]=2*(m+f),n[8]=2*(d+_),n[9]=2*(m-f),n[10]=1-2*(l+h)},e.createTranslate=function(e,t){var i=e.elements,n=t.elements;n[4]=n[8]=n[1]=n[9]=n[2]=n[6]=n[3]=n[7]=n[11]=0,n[0]=n[5]=n[10]=n[15]=1,n[12]=i[0],n[13]=i[1],n[14]=i[2]},e.createScaling=function(e,t){var i=e.elements,n=t.elements;n[0]=i[0],n[5]=i[1],n[10]=i[2],n[1]=n[4]=n[8]=n[12]=n[9]=n[13]=n[2]=n[6]=n[14]=n[3]=n[7]=n[11]=0,n[15]=1},e.multiply=function(e,t,i){var n,a,r,o,s,h,l,c;if(a=i.elements,r=e.elements,o=t.elements,a===o)for(o=new Float32Array(16),n=0;n<16;++n)o[n]=a[n];for(n=0;n<4;n++)s=r[n],h=r[n+4],l=r[n+8],c=r[n+12],a[n]=s*o[0]+h*o[1]+l*o[2]+c*o[3],a[n+4]=s*o[4]+h*o[5]+l*o[6]+c*o[7],a[n+8]=s*o[8]+h*o[9]+l*o[10]+c*o[11],a[n+12]=s*o[12]+h*o[13]+l*o[14]+c*o[15]},e.createFromQuaternion=function(e,t){var i=t.elements,n=e.elements,a=n[0],r=n[1],o=n[2],s=n[3],h=a+a,l=r+r,c=o+o,p=a*h,u=r*h,d=r*l,_=o*h,m=o*l,f=o*c,g=s*h,y=s*l,v=s*c;i[0]=1-d-f,i[1]=u+v,i[2]=_-y,i[3]=0,i[4]=u-v,i[5]=1-p-f,i[6]=m+g,i[7]=0,i[8]=_+y,i[9]=m-g,i[10]=1-p-d,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1},e.createAffineTransformation=function(e,t,i,n){var a=e.elements,r=t.elements,o=i.elements,s=n.elements,h=r[0],l=r[1],c=r[2],p=r[3],u=h+h,d=l+l,_=c+c,m=h*u,f=h*d,g=h*_,y=l*d,v=l*_,x=c*_,b=p*u,w=p*d,S=p*_,I=o[0],M=o[1],C=o[2];s[0]=(1-(y+x))*I,s[1]=(f+S)*I,s[2]=(g-w)*I,s[3]=0,s[4]=(f-S)*M,s[5]=(1-(m+x))*M,s[6]=(v+b)*M,s[7]=0,s[8]=(g+w)*C,s[9]=(v-b)*C,s[10]=(1-(m+y))*C,s[11]=0,s[12]=a[0],s[13]=a[1],s[14]=a[2],s[15]=1},e.createLookAt=function(t,i,n,a){var r=a.elements,o=e._tempVector0,s=e._tempVector1,h=e._tempVector2;At.subtract(t,i,h),At.normalize(h,h),At.cross(n,h,o),At.normalize(o,o),At.cross(h,o,s),a.identity(),r[0]=o.x,r[4]=o.y,r[8]=o.z,r[1]=s.x,r[5]=s.y,r[9]=s.z,r[2]=h.x,r[6]=h.y,r[10]=h.z,r[12]=-At.dot(o,t),r[13]=-At.dot(s,t),r[14]=-At.dot(h,t)},e.createPerspective=function(e,t,i,n,a){var r=a.elements,o=1/Math.tan(e/2),s=1/(i-n);r[0]=o/t,r[5]=o,r[10]=(n+i)*s,r[11]=-1,r[14]=2*n*i*s,r[1]=r[2]=r[3]=r[4]=r[6]=r[7]=r[8]=r[9]=r[12]=r[13]=r[15]=0},e.createOrthoOffCenterRH=function(e,t,i,n,a,r,o){var s=o.elements,h=1/(e-t),l=1/(i-n),c=1/(a-r);s[1]=s[2]=s[3]=s[4]=s[6]=s[7]=s[8]=s[9]=s[11]=0,s[15]=1,s[0]=-2*h,s[5]=-2*l,s[10]=2*c,s[12]=(e+t)*h,s[13]=(n+i)*l,s[14]=(r+a)*c},e.translation=function(e,t){var i=e.elements,n=t.elements;n[0]=n[5]=n[10]=n[15]=1,n[12]=i[0],n[13]=i[1],n[14]=i[2]},n(e,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new e},"_tempVector0",function(){return this._tempVector0=new At},"_tempVector1",function(){return this._tempVector1=new At},"_tempVector2",function(){return this._tempVector2=new At},"_tempQuaternion",function(){return this._tempQuaternion=new Tt},"DEFAULT",function(){return this.DEFAULT=new e},"ZERO",function(){return this.ZERO=new e(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}]),e}(),kt=function(){function e(e,t){this.extents=null,this.transformation=null,this.extents=e,this.transformation=t}a(e,"laya.d3.math.OrientedBoundBox");var t=e.prototype;return t.getCorners=function(t){var i=e._tempV30.elements,n=e._tempV31.elements,a=e._tempV32.elements,r=this.extents.elements;i[0]=r[0],i[1]=i[2]=0,n[1]=r[1],n[0]=n[2]=0,a[2]=r[2],a[0]=a[1]=0,At.TransformNormal(e._tempV30,this.transformation,e._tempV30),At.TransformNormal(e._tempV31,this.transformation,e._tempV31),At.TransformNormal(e._tempV32,this.transformation,e._tempV32);var o=e._tempV33;this.transformation.getTranslationVector(o),t.length=8,At.add(o,e._tempV30,e._tempV34),At.add(e._tempV34,e._tempV31,e._tempV34),At.add(e._tempV34,e._tempV32,t[0]),At.add(o,e._tempV30,e._tempV34),At.add(e._tempV34,e._tempV31,e._tempV34),At.subtract(e._tempV34,e._tempV32,t[1]),At.subtract(o,e._tempV30,e._tempV34),At.add(e._tempV34,e._tempV31,e._tempV34),At.subtract(e._tempV34,e._tempV32,t[2]),At.subtract(o,e._tempV30,e._tempV34),At.add(e._tempV34,e._tempV31,e._tempV34),At.add(e._tempV34,e._tempV32,t[3]),At.add(o,e._tempV30,e._tempV34),At.subtract(e._tempV34,e._tempV31,e._tempV34),At.add(e._tempV34,e._tempV32,t[4]),At.add(o,e._tempV30,e._tempV34),At.subtract(e._tempV34,e._tempV31,e._tempV34),At.subtract(e._tempV34,e._tempV32,t[5]),At.subtract(o,e._tempV30,e._tempV34),At.subtract(e._tempV34,e._tempV31,e._tempV34),At.subtract(e._tempV34,e._tempV32,t[6]),At.subtract(o,e._tempV30,e._tempV34),At.subtract(e._tempV34,e._tempV31,e._tempV34),At.add(e._tempV34,e._tempV32,t[7])},t.transform=function(e){Ct.multiply(this.transformation,e,this.transformation)},t.scale=function(e){At.multiply(this.extents,e,this.extents)},t.translate=function(t){this.transformation.getTranslationVector(e._tempV30),At.add(e._tempV30,t,e._tempV31),this.transformation.setTranslationVector(e._tempV31)},t.Size=function(e){At.scale(this.extents,2,e)},t.getSize=function(t){var i=this.extents.elements;e._tempV30.x=i[0],e._tempV31.y=i[1],e._tempV32.z=i[2],At.TransformNormal(e._tempV30,this.transformation,e._tempV30),At.TransformNormal(e._tempV31,this.transformation,e._tempV31),At.TransformNormal(e._tempV31,this.transformation,e._tempV32);var n=t.elements;n[0]=At.scalarLength(e._tempV30),n[1]=At.scalarLength(e._tempV31),n[2]=At.scalarLength(e._tempV32)},t.getSizeSquared=function(t){var i=this.extents.elements;e._tempV30.x=i[0],e._tempV31.y=i[1],e._tempV32.z=i[2],At.TransformNormal(e._tempV30,this.transformation,e._tempV30),At.TransformNormal(e._tempV31,this.transformation,e._tempV31),At.TransformNormal(e._tempV31,this.transformation,e._tempV32);var n=t.elements;n[0]=At.scalarLengthSquared(e._tempV30),n[1]=At.scalarLengthSquared(e._tempV31),n[2]=At.scalarLengthSquared(e._tempV32)},t.getCenter=function(e){this.transformation.getTranslationVector(e)},t.containsPoint=function(t){var i=this.extents.elements,n=i[0],a=i[1],r=i[2];this.transformation.invert(e._tempM0),At.transformCoordinate(t,e._tempM0,e._tempV30);var o=e._tempV30.elements,s=Math.abs(o[0]),h=Math.abs(o[1]),l=Math.abs(o[2]);return It.nearEqual(s,n)&&It.nearEqual(h,a)&&It.nearEqual(l,r)?2:s<n&&h<a&&l<r?1:0},t.containsPoints=function(t){var i=this.extents.elements,n=i[0],a=i[1],r=i[2];this.transformation.invert(e._tempM0);for(var o=!0,s=!1,h=0;h<t.length;h++){At.transformCoordinate(t[h],e._tempM0,e._tempV30);var l=e._tempV30.elements,c=Math.abs(l[0]),p=Math.abs(l[1]),u=Math.abs(l[2]);It.nearEqual(c,n)&&It.nearEqual(p,a)&&It.nearEqual(u,r)&&(s=!0),c<n&&p<a&&u<r?s=!0:o=!1}return o?1:s?2:0},t.containsSphere=function(t,i){void 0===i&&(i=!1);var n=this.extents.elements,a=n[0],r=n[1],o=n[2],s=t.radius;this.transformation.invert(e._tempM0),At.transformCoordinate(t.center,e._tempM0,e._tempV30);var h=NaN;i?h=s:(At.scale(At.UnitX,s,e._tempV31),At.TransformNormal(e._tempV31,e._tempM0,e._tempV31),h=At.scalarLength(e._tempV31)),At.scale(this.extents,-1,e._tempV32),At.Clamp(e._tempV30,e._tempV32,this.extents,e._tempV33);if(At.distanceSquared(e._tempV30,e._tempV33)>h*h)return 0;var l=e._tempV30.elements,c=l[0],p=l[1],u=l[2],d=e._tempV32.elements,_=d[0],m=d[1],f=d[2];return _+h<=c&&c<=a-h&&a-_>h&&m+h<=p&&p<=r-h&&r-m>h&&f+h<=u&&u<=o-h&&o-f>h?1:2},t.containsOrientedBoundBox=function(t){var i=0,n=0;t.getCorners(e._corners);var a=this.containsPoints(e._corners);if(0!=a)return a;var r=this.extents.elements;t.extents.cloneTo(e._tempV35);var o=e._tempV35.elements;e._getRows(this.transformation,e._rows1),e._getRows(t.transformation,e._rows2);var s=NaN,h=NaN,l=NaN;for(i=0;i<4;i++)for(n=0;n<4;n++)3==i||3==n?(e._tempM0.setElementByRowColumn(i,n,0),e._tempM1.setElementByRowColumn(i,n,0)):(l=At.dot(e._rows1[i],e._rows2[n]),e._tempM0.setElementByRowColumn(i,n,l),e._tempM1.setElementByRowColumn(i,n,Math.abs(l)));t.getCenter(e._tempV34),this.getCenter(e._tempV36),At.subtract(e._tempV34,e._tempV36,e._tempV30);var c=e._tempV31.elements;c[0]=At.dot(e._tempV30,e._rows1[0]),c[1]=At.dot(e._tempV30,e._rows1[1]),c[2]=At.dot(e._tempV30,e._rows1[2]);var p=e._tempV32.elements,u=e._tempV33.elements;for(i=0;i<3;i++)if(p[0]=e._tempM1.getElementByRowColumn(i,0),p[1]=e._tempM1.getElementByRowColumn(i,1),p[2]=e._tempM1.getElementByRowColumn(i,2),s=r[i],h=At.dot(e._tempV35,e._tempV32),Math.abs(c[i])>s+h)return 0;for(n=0;n<3;n++)if(p[0]=e._tempM1.getElementByRowColumn(0,n),p[1]=e._tempM1.getElementByRowColumn(1,n),p[2]=e._tempM1.getElementByRowColumn(2,n),u[0]=e._tempM0.getElementByRowColumn(0,n),u[1]=e._tempM0.getElementByRowColumn(1,n),u[2]=e._tempM0.getElementByRowColumn(2,n),s=At.dot(this.extents,e._tempV32),h=o[n],Math.abs(At.dot(e._tempV31,e._tempV33))>s+h)return 0;for(i=0;i<3;i++)for(n=0;n<3;n++){var d=(i+1)%3,_=(i+2)%3,m=(n+1)%3,f=(n+2)%3;if(s=r[d]*e._tempM1.getElementByRowColumn(_,n)+r[_]*e._tempM1.getElementByRowColumn(d,n),h=o[m]*e._tempM1.getElementByRowColumn(i,f)+o[f]*e._tempM1.getElementByRowColumn(i,m),Math.abs(c[_]*e._tempM0.getElementByRowColumn(d,n)-c[d]*e._tempM0.getElementByRowColumn(_,n))>s+h)return 0}return 2},t.containsLine=function(t,i){e._corners[0]=t,e._corners[1]=i;var n=this.containsPoints(e._corners);if(0!=n)return n;var a=this.extents.elements,r=a[0],o=a[1],s=a[2];this.transformation.invert(e._tempM0),At.transformCoordinate(t,e._tempM0,e._tempV30),At.transformCoordinate(i,e._tempM0,e._tempV31),At.add(e._tempV30,e._tempV31,e._tempV32),At.scale(e._tempV32,.5,e._tempV32),At.subtract(e._tempV30,e._tempV32,e._tempV33);var h=e._tempV33.elements,l=h[0],c=h[1],p=h[2],u=e._tempV34.elements,d=u[0]=Math.abs(h[0]),_=u[1]=Math.abs(h[1]),m=u[2]=Math.abs(h[2]),f=e._tempV32.elements,g=f[0],y=f[1],v=f[2];return Math.abs(g)>r+d?0:Math.abs(y)>o+_?0:Math.abs(v)>s+m?0:Math.abs(y*p-v*c)>o*m+s*_?0:Math.abs(g*p-v*l)>r*m+s*d?0:Math.abs(g*c-y*l)>r*_+o*d?0:2},t.containsBoundBox=function(t){var i=0,n=0,a=t.min,r=t.max;t.getCorners(e._corners);var o=this.containsPoints(e._corners);if(0!=o)return o;At.subtract(r,a,e._tempV30),At.scale(e._tempV30,.5,e._tempV30),At.add(a,e._tempV30,e._tempV30),At.subtract(r,e._tempV30,e._tempV31);var s=this.extents.elements,h=e._tempV31.elements;e._getRows(this.transformation,e._rows1),this.transformation.invert(e._tempM0);var l=NaN,c=NaN;for(i=0;i<3;i++)for(n=0;n<3;n++)e._tempM1.setElementByRowColumn(i,n,Math.abs(e._tempM0.getElementByRowColumn(i,n)));this.getCenter(e._tempV35),At.subtract(e._tempV30,e._tempV35,e._tempV32);var p=e._tempV31.elements;p[0]=At.dot(e._tempV32,e._rows1[0]),p[1]=At.dot(e._tempV32,e._rows1[1]),p[2]=At.dot(e._tempV32,e._rows1[2]);var u=e._tempV33.elements,d=e._tempV34.elements;for(i=0;i<3;i++)if(u[0]=e._tempM1.getElementByRowColumn(i,0),u[1]=e._tempM1.getElementByRowColumn(i,1),u[2]=e._tempM1.getElementByRowColumn(i,2),l=s[i],c=At.dot(e._tempV31,e._tempV33),Math.abs(p[i])>l+c)return 0;for(n=0;n<3;n++)if(u[0]=e._tempM1.getElementByRowColumn(0,n),u[1]=e._tempM1.getElementByRowColumn(1,n),u[2]=e._tempM1.getElementByRowColumn(2,n),d[0]=e._tempM0.getElementByRowColumn(0,n),d[1]=e._tempM0.getElementByRowColumn(1,n),d[2]=e._tempM0.getElementByRowColumn(2,n),l=At.dot(this.extents,e._tempV33),c=h[n],Math.abs(At.dot(e._tempV31,e._tempV34))>l+c)return 0;for(i=0;i<3;i++)for(n=0;n<3;n++){var _=(i+1)%3,m=(i+2)%3,f=(n+1)%3,g=(n+2)%3;if(l=s[_]*e._tempM1.getElementByRowColumn(m,n)+s[m]*e._tempM1.getElementByRowColumn(_,n),c=h[f]*e._tempM1.getElementByRowColumn(i,g)+h[g]*e._tempM1.getElementByRowColumn(i,f),Math.abs(p[m]*e._tempM0.getElementByRowColumn(_,n)-p[_]*e._tempM0.getElementByRowColumn(m,n))>l+c)return 0}return 2},t.intersectsRay=function(t,i){At.scale(this.extents,-1,e._tempV30),this.transformation.invert(e._tempM0),At.TransformNormal(t.direction,e._tempM0,e._ray.direction),At.transformCoordinate(t.origin,e._tempM0,e._ray.origin),e._boxBound1.min=e._tempV30,e._boxBound1.max=this.extents;var n=St.intersectsRayAndBoxRP(e._ray,e._boxBound1,i);return-1!==n&&At.transformCoordinate(i,this.transformation,i),n},t._getLocalCorners=function(t){t.length=8;var i=this.extents.elements;e._tempV30.x=i[0],e._tempV31.y=i[1],e._tempV32.z=i[2],At.add(e._tempV30,e._tempV31,e._tempV33),At.add(e._tempV33,e._tempV32,t[0]),At.add(e._tempV30,e._tempV31,e._tempV33),At.subtract(e._tempV33,e._tempV32,t[1]),At.subtract(e._tempV31,e._tempV30,e._tempV33),At.subtract(e._tempV33,e._tempV30,t[2]),At.subtract(e._tempV31,e._tempV30,e._tempV33),At.add(e._tempV33,e._tempV32,t[3]),At.subtract(e._tempV30,e._tempV31,e._tempV33),At.add(e._tempV33,e._tempV32,t[4]),At.subtract(e._tempV30,e._tempV31,e._tempV33),At.subtract(e._tempV33,e._tempV32,t[5]),At.scale(t[0],-1,t[6]),At.subtract(e._tempV32,e._tempV30,e._tempV33),At.subtract(e._tempV33,e._tempV31,t[7])},t.equals=function(e){return this.extents==e.extents&&this.transformation==e.transformation},t.cloneTo=function(e){var t=e;this.extents.cloneTo(t.extents),this.transformation.cloneTo(t.transformation)},e.createByBoundBox=function(t,i){var n=t.min,a=t.max;At.subtract(a,n,e._tempV30),At.scale(e._tempV30,.5,e._tempV30),At.add(n,e._tempV30,e._tempV31),At.subtract(a,e._tempV31,e._tempV32),Ct.translation(e._tempV31,e._tempM0);var r=e._tempV32.clone(),o=e._tempM0.clone();i.extents=r,i.transformation=o},e.createByMinAndMaxVertex=function(t,i){At.subtract(i,t,e._tempV30),At.scale(e._tempV30,.5,e._tempV30),At.add(t,e._tempV30,e._tempV31),At.subtract(i,e._tempV31,e._tempV32),Ct.translation(e._tempV31,e._tempM0);return new e(e._tempV32,e._tempM0)},e._getRows=function(e,t){t.length=3;var i=e.elements,n=t[0].elements;n[0]=i[0],n[1]=i[1],n[2]=i[2];var a=t[1].elements;a[0]=i[4],a[1]=i[5],a[2]=i[6];var r=t[2].elements;r[0]=i[8],r[1]=i[9],r[2]=i[10]},e.getObbtoObbMatrix4x4=function(t,i,n,a){var r=t.transformation,o=i.transformation;if(n){e._getRows(r,e._rows1),e._getRows(o,e._rows2);for(var s=0;s<3;s++)for(var h=0;h<3;h++)a.setElementByRowColumn(s,h,At.dot(e._rows2[s],e._rows1[h]));i.getCenter(e._tempV30),t.getCenter(e._tempV31),At.subtract(e._tempV30,e._tempV31,e._tempV32);var l=a.elements;l[12]=At.dot(e._tempV32,e._rows1[0]),l[13]=At.dot(e._tempV32,e._rows1[1]),l[14]=At.dot(e._tempV32,e._rows1[2]),l[15]=1}else r.invert(e._tempM0),Ct.multiply(o,e._tempM0,a)},e.merge=function(t,i,n){var a=t.extents,r=t.transformation;e.getObbtoObbMatrix4x4(t,i,n,e._tempM0),i._getLocalCorners(e._corners),At.transformCoordinate(e._corners[0],e._tempM0,e._corners[0]),At.transformCoordinate(e._corners[1],e._tempM0,e._corners[1]),At.transformCoordinate(e._corners[2],e._tempM0,e._corners[2]),At.transformCoordinate(e._corners[3],e._tempM0,e._corners[3]),At.transformCoordinate(e._corners[4],e._tempM0,e._corners[4]),At.transformCoordinate(e._corners[5],e._tempM0,e._corners[5]),At.transformCoordinate(e._corners[6],e._tempM0,e._corners[6]),At.transformCoordinate(e._corners[7],e._tempM0,e._corners[7]),At.scale(a,-1,e._boxBound1.min),a.cloneTo(e._boxBound1.max),xt.createfromPoints(e._corners,e._boxBound2),xt.merge(e._boxBound2,e._boxBound1,e._boxBound3);var o=e._boxBound3.min,s=e._boxBound3.max;At.subtract(s,o,e._tempV30),At.scale(e._tempV30,.5,e._tempV30),At.add(o,e._tempV30,e._tempV32),At.subtract(s,e._tempV32,a),At.transformCoordinate(e._tempV32,r,e._tempV33)},n(e,["_tempV30",function(){return this._tempV30=new At},"_tempV31",function(){return this._tempV31=new At},"_tempV32",function(){return this._tempV32=new At},"_tempV33",function(){return this._tempV33=new At},"_tempV34",function(){return this._tempV34=new At},"_tempV35",function(){return this._tempV35=new At},"_tempV36",function(){return this._tempV36=new At},"_tempM0",function(){return this._tempM0=new Ct},"_tempM1",function(){return this._tempM1=new Ct},"_corners",function(){return this._corners=[new At,new At,new At,new At,new At,new At,new At,new At]},"_rows1",function(){return this._rows1=[new At,new At,new At]},"_rows2",function(){return this._rows2=[new At,new At,new At]},"_ray",function(){return this._ray=new Dt(new At,new At)},"_boxBound1",function(){return this._boxBound1=new xt(new At,new At)},"_boxBound2",function(){return this._boxBound2=new xt(new At,new At)},"_boxBound3",function(){return this._boxBound3=new xt(new At,new At)}]),e}(),Et=function(){function e(e,t){this.normal=null,this.distance=NaN,void 0===t&&(t=0),this.normal=e,this.distance=t}a(e,"laya.d3.math.Plane");return e.prototype.normalize=function(){var e=this.normal.elements,t=e[0],i=e[1],n=e[2],a=1/Math.sqrt(t*t+i*i+n*n);e[0]=t*a,e[1]=i*a,e[2]=n*a,this.distance*=a},e.createPlaneBy3P=function(t,i,n){var a=t.elements,r=i.elements,o=n.elements,s=r[0]-a[0],h=r[1]-a[1],l=r[2]-a[2],c=o[0]-a[0],p=o[1]-a[1],u=o[2]-a[2],d=h*u-l*p,_=l*c-s*u,m=s*p-h*c,f=1/Math.sqrt(d*d+_*_+m*m),g=d*f,y=_*f,v=m*f,x=e._TEMPVec3.elements;x[0]=g,x[1]=y,x[2]=v;var b=-(g*a[0]+y*a[1]+v*a[2]);return new e(e._TEMPVec3,b)},e.PlaneIntersectionType_Back=0,e.PlaneIntersectionType_Front=1,e.PlaneIntersectionType_Intersecting=2,n(e,["_TEMPVec3",function(){return this._TEMPVec3=new At}]),e}(),Tt=function(){function e(e,t,i,n){this.elements=new Float32Array(4),void 0===e&&(e=0),void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=1),this.elements[0]=e,this.elements[1]=t,this.elements[2]=i,this.elements[3]=n}a(e,"laya.d3.math.Quaternion");var t=e.prototype;return i.imps(t,{"laya.d3.core.IClone":!0}),t.scaling=function(e,t){var i=t.elements,n=this.elements;i[0]=n[0]*e,i[1]=n[1]*e,i[2]=n[2]*e,i[3]=n[3]*e},t.normalize=function(e){var t=e.elements,i=this.elements,n=i[0],a=i[1],r=i[2],o=i[3],s=n*n+a*a+r*r+o*o;s>0&&(s=1/Math.sqrt(s),t[0]=n*s,t[1]=a*s,t[2]=r*s,t[3]=o*s)},t.length=function(){var e=this.elements,t=e[0],i=e[1],n=e[2],a=e[3];return Math.sqrt(t*t+i*i+n*n+a*a)},t.rotateX=function(e,t){var i=t.elements,n=this.elements;e*=.5;var a=n[0],r=n[1],o=n[2],s=n[3],h=Math.sin(e),l=Math.cos(e);i[0]=a*l+s*h,i[1]=r*l+o*h,i[2]=o*l-r*h,i[3]=s*l-a*h},t.rotateY=function(e,t){var i=t.elements,n=this.elements;e*=.5;var a=n[0],r=n[1],o=n[2],s=n[3],h=Math.sin(e),l=Math.cos(e);i[0]=a*l-o*h,i[1]=r*l+s*h,i[2]=o*l+a*h,i[3]=s*l-r*h},t.rotateZ=function(e,t){var i=t.elements,n=this.elements;e*=.5;var a=n[0],r=n[1],o=n[2],s=n[3],h=Math.sin(e),l=Math.cos(e);i[0]=a*l+r*h,i[1]=r*l-a*h,i[2]=o*l+s*h,i[3]=s*l-o*h},t.getYawPitchRoll=function(t){At.transformQuat(At.ForwardRH,this,e.TEMPVector31),At.transformQuat(At.Up,this,e.TEMPVector32);var i=e.TEMPVector32.elements;e.angleTo(At.ZERO,e.TEMPVector31,e.TEMPVector33);var n=e.TEMPVector33.elements;n[0]==Math.PI/2?(n[1]=e.arcTanAngle(i[2],i[0]),n[2]=0):n[0]==-Math.PI/2?(n[1]=e.arcTanAngle(-i[2],-i[0]),n[2]=0):(Ct.createRotationY(-n[1],e.TEMPMatrix0),Ct.createRotationX(-n[0],e.TEMPMatrix1),At.transformCoordinate(e.TEMPVector32,e.TEMPMatrix0,e.TEMPVector32),At.transformCoordinate(e.TEMPVector32,e.TEMPMatrix1,e.TEMPVector32),n[2]=e.arcTanAngle(i[1],-i[0])),n[1]<=-Math.PI&&(n[1]=Math.PI),n[2]<=-Math.PI&&(n[2]=Math.PI),n[1]>=Math.PI&&n[2]>=Math.PI&&(n[1]=0,n[2]=0,n[0]=Math.PI-n[0]);var a=t.elements;a[0]=n[1],a[1]=n[0],a[2]=n[2]},t.invert=function(e){var t=e.elements,i=this.elements,n=i[0],a=i[1],r=i[2],o=i[3],s=n*n+a*a+r*r+o*o,h=s?1/s:0;t[0]=-n*h,t[1]=-a*h,t[2]=-r*h,t[3]=o*h},t.identity=function(){var e=this.elements;e[0]=0,e[1]=0,e[2]=0,e[3]=1},t.fromArray=function(e,t){void 0===t&&(t=0),this.elements[0]=e[t+0],this.elements[1]=e[t+1],this.elements[2]=e[t+2],this.elements[3]=e[t+3]},t.cloneTo=function(e){var t,i,n;if(i=this.elements,n=e.elements,i!==n)for(t=0;t<4;++t)n[t]=i[t]},t.clone=function(){var e=new this.constructor;return this.cloneTo(e),e},t.equals=function(e){var t=this.elements,i=e.elements;return It.nearEqual(t[0],i[0])&&It.nearEqual(t[1],i[1])&&It.nearEqual(t[2],i[2])&&It.nearEqual(t[3],i[3])},t.lengthSquared=function(){var e=this.elements[0],t=this.elements[1],i=this.elements[2],n=this.elements[3];return e*e+t*t+i*i+n*n},r(0,t,"x",function(){return this.elements[0]}),r(0,t,"y",function(){return this.elements[1]}),r(0,t,"z",function(){return this.elements[2]}),r(0,t,"w",function(){return this.elements[3]}),e.createFromYawPitchRoll=function(e,t,i,n){var a=.5*i,r=.5*t,o=.5*e,s=Math.sin(a),h=Math.cos(a),l=Math.sin(r),c=Math.cos(r),p=Math.sin(o),u=Math.cos(o),d=n.elements;d[0]=u*l*h+p*c*s,d[1]=p*c*h-u*l*s,d[2]=u*c*s-p*l*h,d[3]=u*c*h+p*l*s},e.multiply=function(e,t,i){var n=e.elements,a=t.elements,r=i.elements,o=n[0],s=n[1],h=n[2],l=n[3],c=a[0],p=a[1],u=a[2],d=a[3],_=s*u-h*p,m=h*c-o*u,f=o*p-s*c,g=o*c+s*p+h*u;r[0]=o*d+c*l+_,r[1]=s*d+p*l+m,r[2]=h*d+u*l+f,r[3]=l*d-g},e.arcTanAngle=function(e,t){return 0==e?1==t?Math.PI/2:-Math.PI/2:e>0?Math.atan(t/e):e<0?t>0?Math.atan(t/e)+Math.PI:Math.atan(t/e)-Math.PI:0},e.angleTo=function(t,i,n){At.subtract(i,t,e.TEMPVector30),At.normalize(e.TEMPVector30,e.TEMPVector30),n.elements[0]=Math.asin(e.TEMPVector30.y),n.elements[1]=e.arcTanAngle(-e.TEMPVector30.z,-e.TEMPVector30.x)},e.createFromAxisAngle=function(e,t,i){var n=i.elements,a=e.elements;t*=.5;var r=Math.sin(t);n[0]=r*a[0],n[1]=r*a[1],n[2]=r*a[2],n[3]=Math.cos(t)},e.createFromMatrix3x3=function(e,t){var i,n=t.elements,a=e.elements,r=a[0]+a[4]+a[8];if(r>0)i=Math.sqrt(r+1),n[3]=.5*i,i=.5/i,n[0]=(a[5]-a[7])*i,n[1]=(a[6]-a[2])*i,n[2]=(a[1]-a[3])*i;else{var o=0;a[4]>a[0]&&(o=1),a[8]>a[3*o+o]&&(o=2);var s=(o+1)%3,h=(o+2)%3;i=Math.sqrt(a[3*o+o]-a[3*s+s]-a[3*h+h]+1),n[o]=.5*i,i=.5/i,n[3]=(a[3*s+h]-a[3*h+s])*i,n[s]=(a[3*s+o]+a[3*o+s])*i,n[h]=(a[3*h+o]+a[3*o+h])*i}},e.createFromMatrix4x4=function(e,t){var i,n,a=e.elements,r=t.elements,o=a[0]+a[5]+a[10];o>0?(i=Math.sqrt(o+1),r[3]=.5*i,i=.5/i,r[0]=(a[6]-a[9])*i,r[1]=(a[8]-a[2])*i,r[2]=(a[1]-a[4])*i):a[0]>=a[5]&&a[0]>=a[10]?(n=.5/(i=Math.sqrt(1+a[0]-a[5]-a[10])),r[0]=.5*i,r[1]=(a[1]+a[4])*n,r[2]=(a[2]+a[8])*n,r[3]=(a[6]-a[9])*n):a[5]>a[10]?(n=.5/(i=Math.sqrt(1+a[5]-a[0]-a[10])),r[0]=(a[4]+a[1])*n,r[1]=.5*i,r[2]=(a[9]+a[6])*n,r[3]=(a[8]-a[2])*n):(n=.5/(i=Math.sqrt(1+a[10]-a[0]-a[5])),r[0]=(a[8]+a[2])*n,r[1]=(a[9]+a[6])*n,r[2]=.5*i,r[3]=(a[1]-a[4])*n)},e.slerp=function(e,t,i,n){var a,r,o,s,h,l=e.elements,c=t.elements,p=n.elements,u=l[0],d=l[1],_=l[2],m=l[3],f=c[0],g=c[1],y=c[2],v=c[3];return(r=u*f+d*g+_*y+m*v)<0&&(r=-r,f=-f,g=-g,y=-y,v=-v),1-r>1e-6?(a=Math.acos(r),o=Math.sin(a),s=Math.sin((1-i)*a)/o,h=Math.sin(i*a)/o):(s=1-i,h=i),p[0]=s*u+h*f,p[1]=s*d+h*g,p[2]=s*_+h*y,p[3]=s*m+h*v,p},e.lerp=function(e,t,i,n){var a=n.elements,r=e.elements,o=t.elements,s=r[0],h=r[1],l=r[2],c=r[3];a[0]=s+i*(o[0]-s),a[1]=h+i*(o[1]-h),a[2]=l+i*(o[2]-l),a[3]=c+i*(o[3]-c)},e.add=function(e,t,i){var n=i.elements,a=e.elements,r=t.elements;n[0]=a[0]+r[0],n[1]=a[1]+r[1],n[2]=a[2]+r[2],n[3]=a[3]+r[3]},e.dot=function(e,t){var i=e.elements,n=t.elements;return i[0]*n[0]+i[1]*n[1]+i[2]*n[2]+i[3]*n[3]},e.rotationLookAt=function(t,i,n){e.lookAt(At.ZERO,t,i,n)},e.lookAt=function(t,i,n,a){Mt.lookAt(t,i,n,e._tempMatrix3x3),e.rotationMatrix(e._tempMatrix3x3,a)},e.invert=function(e,t){var i=e.elements,n=t.elements,a=e.lengthSquared();It.isZero(a)||(a=1/a,n[0]=-i[0]*a,n[1]=-i[1]*a,n[2]=-i[2]*a,n[3]=i[3]*a)},e.rotationMatrix=function(e,t){var i=e.elements,n=i[0],a=i[1],r=i[2],o=i[3],s=i[4],h=i[5],l=i[6],c=i[7],p=i[8],u=t.elements,d=NaN,_=NaN,m=n+s+p;m>0?(d=Math.sqrt(m+1),u[3]=.5*d,d=.5/d,u[0]=(h-c)*d,u[1]=(l-r)*d,u[2]=(a-o)*d):n>=s&&n>=p?(_=.5/(d=Math.sqrt(1+n-s-p)),u[0]=.5*d,u[1]=(a+o)*_,u[2]=(r+l)*_,u[3]=(h-c)*_):s>p?(_=.5/(d=Math.sqrt(1+s-n-p)),u[0]=(o+a)*_,u[1]=.5*d,u[2]=(c+h)*_,u[3]=(l-r)*_):(_=.5/(d=Math.sqrt(1+p-n-s)),u[0]=(l+r)*_,u[1]=(c+h)*_,u[2]=.5*d,u[3]=(a-o)*_)},e.DEFAULT=new e,n(e,["TEMPVector30",function(){return this.TEMPVector30=new At},"TEMPVector31",function(){return this.TEMPVector31=new At},"TEMPVector32",function(){return this.TEMPVector32=new At},"TEMPVector33",function(){return this.TEMPVector33=new At},"TEMPMatrix0",function(){return this.TEMPMatrix0=new Ct},"TEMPMatrix1",function(){return this.TEMPMatrix1=new Ct},"_tempMatrix3x3",function(){return this._tempMatrix3x3=new Mt},"NAN",function(){return this.NAN=new e(NaN,NaN,NaN,NaN)}]),e}(),Lt=function(){function e(e){this._temp=new Uint32Array(1),this.seeds=new Uint32Array(4),this.seeds[0]=e,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}a(e,"laya.d3.math.Rand");var t=e.prototype;return t.getUint=function(){return this._temp[0]=this.seeds[0]^this.seeds[0]<<11,this.seeds[0]=this.seeds[1],this.seeds[1]=this.seeds[2],this.seeds[2]=this.seeds[3],this.seeds[3]=this.seeds[3]^this.seeds[3]>>>19^this._temp[0]^this._temp[0]>>>8,this.seeds[3]},t.getFloat=function(){return this.getUint(),(8388607&this.seeds[3])*(1/8388607)},t.getSignedFloat=function(){return 2*this.getFloat()-1},r(0,t,"seed",function(){return this.seeds[0]},function(e){this.seeds[0]=e,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}),e.getFloatFromInt=function(e){return 1/8388607*(8388607&e)},e.getByteFromInt=function(e){return(8388607&e)>>>15},e}(),Dt=(function(){function e(e){if(this._state0U=NaN,this._state0L=NaN,this._state1U=NaN,this._state1L=NaN,!(e instanceof Array)||4!==e.length)throw new Error("Rand:Seed must be an array with 4 numbers");this._state0U=0|e[0],this._state0L=0|e[1],this._state1U=0|e[2],this._state1L=0|e[3]}a(e,"laya.d3.math.RandX");var t=e.prototype;t.randomint=function(){var e=this._state0U,t=this._state0L,i=this._state1U,n=this._state1L,a=(n>>>0)+(t>>>0),r=i+e+(a/2>>>31)>>>0,o=a>>>0;this._state0U=i,this._state0L=n;var s=0,h=0,l=0,c=0;s=(e^=s=e<<23|(-512&t)>>>9)^i,h=(t^=h=t<<23)^n;s^=l=e>>>18,h^=c=t>>>18|(262143&e)<<14;return l=i>>>5,c=n>>>5|(31&i)<<27,s^=l,h^=c,this._state1U=s,this._state1L=h,[r,o]},t.random=function(){var t=this.randomint(),i=t[0],n=1023<<20|i>>>12,a=0|(t[1]>>>12|(4095&i)<<20);e._CONVERTION_BUFFER.setUint32(0,n,!1),e._CONVERTION_BUFFER.setUint32(4,a,!1);return Lt._CONVERTION_BUFFER.getFloat64(0,!1)-1},n(e,["_CONVERTION_BUFFER",function(){return this._CONVERTION_BUFFER=new DataView(new ArrayBuffer(8))},"defaultRand",function(){return this.defaultRand=new Lt([0,Date.now()/65536,0,Date.now()%65536])}])}(),function(){function e(e,t){this.origin=null,this.direction=null,this.origin=e,this.direction=t}return a(e,"laya.d3.math.Ray"),e}()),Nt=function(){function e(e,t){this.elements=new Float32Array(2),void 0===e&&(e=0),void 0===t&&(t=0);var i=this.elements;i[0]=e,i[1]=t}a(e,"laya.d3.math.Vector2");var t=e.prototype;return i.imps(t,{"laya.d3.core.IClone":!0}),t.fromArray=function(e,t){void 0===t&&(t=0),this.elements[0]=e[t+0],this.elements[1]=e[t+1]},t.cloneTo=function(e){var t=e.elements,i=this.elements;t[0]=i[0],t[1]=i[1]},t.clone=function(){var e=new this.constructor;return this.cloneTo(e),e},r(0,t,"x",function(){return this.elements[0]},function(e){this.elements[0]=e}),r(0,t,"y",function(){return this.elements[1]},function(e){this.elements[1]=e}),e.scale=function(e,t,i){var n=i.elements,a=e.elements;n[0]=a[0]*t,n[1]=a[1]*t},n(e,["ZERO",function(){return this.ZERO=new e(0,0)},"ONE",function(){return this.ONE=new e(1,1)}]),e}(),At=function(){function e(e,t,i){this.elements=new Float32Array(3),void 0===e&&(e=0),void 0===t&&(t=0),void 0===i&&(i=0);var n=this.elements;n[0]=e,n[1]=t,n[2]=i}a(e,"laya.d3.math.Vector3");var t=e.prototype;return i.imps(t,{"laya.d3.core.IClone":!0}),t.fromArray=function(e,t){void 0===t&&(t=0),this.elements[0]=e[t+0],this.elements[1]=e[t+1],this.elements[2]=e[t+2]},t.cloneTo=function(e){var t=e.elements,i=this.elements;t[0]=i[0],t[1]=i[1],t[2]=i[2]},t.clone=function(){var e=new this.constructor;return this.cloneTo(e),e},t.toDefault=function(){this.elements[0]=0,this.elements[1]=0,this.elements[2]=0},r(0,t,"x",function(){return this.elements[0]},function(e){this.elements[0]=e}),r(0,t,"y",function(){return this.elements[1]},function(e){this.elements[1]=e}),r(0,t,"z",function(){return this.elements[2]},function(e){this.elements[2]=e}),e.distanceSquared=function(e,t){var i=e.elements,n=t.elements,a=i[0]-n[0],r=i[1]-n[1],o=i[2]-n[2];return a*a+r*r+o*o},e.distance=function(e,t){var i=e.elements,n=t.elements,a=i[0]-n[0],r=i[1]-n[1],o=i[2]-n[2];return Math.sqrt(a*a+r*r+o*o)},e.min=function(e,t,i){var n=i.elements,a=e.elements,r=t.elements;n[0]=Math.min(a[0],r[0]),n[1]=Math.min(a[1],r[1]),n[2]=Math.min(a[2],r[2])},e.max=function(e,t,i){var n=i.elements,a=e.elements,r=t.elements;n[0]=Math.max(a[0],r[0]),n[1]=Math.max(a[1],r[1]),n[2]=Math.max(a[2],r[2])},e.transformQuat=function(e,t,i){var n=i.elements,a=e.elements,r=t.elements,o=a[0],s=a[1],h=a[2],l=r[0],c=r[1],p=r[2],u=r[3],d=u*o+c*h-p*s,_=u*s+p*o-l*h,m=u*h+l*s-c*o,f=-l*o-c*s-p*h;n[0]=d*u+f*-l+_*-p-m*-c,n[1]=_*u+f*-c+m*-l-d*-p,n[2]=m*u+f*-p+d*-c-_*-l},e.scalarLength=function(e){var t=e.elements,i=t[0],n=t[1],a=t[2];return Math.sqrt(i*i+n*n+a*a)},e.scalarLengthSquared=function(e){var t=e.elements,i=t[0],n=t[1],a=t[2];return i*i+n*n+a*a},e.normalize=function(e,t){var i=e.elements,n=t.elements,a=i[0],r=i[1],o=i[2],s=a*a+r*r+o*o;s>0&&(s=1/Math.sqrt(s),n[0]=i[0]*s,n[1]=i[1]*s,n[2]=i[2]*s)},e.multiply=function(e,t,i){var n=i.elements,a=e.elements,r=t.elements;n[0]=a[0]*r[0],n[1]=a[1]*r[1],n[2]=a[2]*r[2]},e.scale=function(e,t,i){var n=i.elements,a=e.elements;n[0]=a[0]*t,n[1]=a[1]*t,n[2]=a[2]*t},e.lerp=function(e,t,i,n){var a=n.elements,r=e.elements,o=t.elements,s=r[0],h=r[1],l=r[2];a[0]=s+i*(o[0]-s),a[1]=h+i*(o[1]-h),a[2]=l+i*(o[2]-l)},e.transformV3ToV3=function(t,i,n){var a=e._tempVector4;e.transformV3ToV4(t,i,a);var r=a.elements,o=n.elements;o[0]=r[0],o[1]=r[1],o[2]=r[2]},e.transformV3ToV4=function(e,t,i){var n=e.elements,a=n[0],r=n[1],o=n[2],s=t.elements,h=i.elements;h[0]=a*s[0]+r*s[4]+o*s[8]+s[12],h[1]=a*s[1]+r*s[5]+o*s[9]+s[13],h[2]=a*s[2]+r*s[6]+o*s[10]+s[14],h[3]=a*s[3]+r*s[7]+o*s[11]+s[15]},e.TransformNormal=function(e,t,i){var n=e.elements,a=n[0],r=n[1],o=n[2],s=t.elements,h=i.elements;h[0]=a*s[0]+r*s[4]+o*s[8],h[1]=a*s[1]+r*s[5]+o*s[9],h[2]=a*s[2]+r*s[6]+o*s[10]},e.transformCoordinate=function(t,i,n){var a=e._tempVector4.elements,r=t.elements,o=r[0],s=r[1],h=r[2],l=i.elements;a[0]=o*l[0]+s*l[4]+h*l[8]+l[12],a[1]=o*l[1]+s*l[5]+h*l[9]+l[13],a[2]=o*l[2]+s*l[6]+h*l[10]+l[14],a[3]=1/(o*l[3]+s*l[7]+h*l[11]+l[15]);var c=n.elements;c[0]=a[0]*a[3],c[1]=a[1]*a[3],c[2]=a[2]*a[3]},e.Clamp=function(e,t,i,n){var a=e.elements,r=a[0],o=a[1],s=a[2],h=t.elements,l=h[0],c=h[1],p=h[2],u=i.elements,d=u[0],_=u[1],m=u[2],f=n.elements;r=(r=r>d?d:r)<l?l:r,o=(o=o>_?_:o)<c?c:o,s=(s=s>m?m:s)<p?p:s,f[0]=r,f[1]=o,f[2]=s},e.add=function(e,t,i){var n=i.elements,a=e.elements,r=t.elements;n[0]=a[0]+r[0],n[1]=a[1]+r[1],n[2]=a[2]+r[2]},e.subtract=function(e,t,i){var n=i.elements,a=e.elements,r=t.elements;n[0]=a[0]-r[0],n[1]=a[1]-r[1],n[2]=a[2]-r[2]},e.cross=function(e,t,i){var n=e.elements,a=t.elements,r=i.elements,o=n[0],s=n[1],h=n[2],l=a[0],c=a[1],p=a[2];r[0]=s*p-h*c,r[1]=h*l-o*p,r[2]=o*c-s*l},e.dot=function(e,t){var i=e.elements,n=t.elements;return i[0]*n[0]+i[1]*n[1]+i[2]*n[2]},e.equals=function(e,t){var i=e.elements,n=t.elements;return It.nearEqual(Math.abs(i[0]),Math.abs(n[0]))&&It.nearEqual(Math.abs(i[1]),Math.abs(n[1]))&&It.nearEqual(Math.abs(i[2]),Math.abs(n[2]))},e.ZERO=new e(0,0,0),e.ONE=new e(1,1,1),e.NegativeUnitX=new e(-1,0,0),e.UnitX=new e(1,0,0),e.UnitY=new e(0,1,0),e.UnitZ=new e(0,0,1),e.ForwardRH=new e(0,0,-1),e.ForwardLH=new e(0,0,1),e.Up=new e(0,1,0),e.NAN=new e(NaN,NaN,NaN),n(e,["_tempVector4",function(){return this._tempVector4=new Rt}]),e}(),Rt=function(){function e(e,t,i,n){this.elements=new Float32Array(4),void 0===e&&(e=0),void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=0);var a=this.elements;a[0]=e,a[1]=t,a[2]=i,a[3]=n}a(e,"laya.d3.math.Vector4");var t=e.prototype;return i.imps(t,{"laya.d3.core.IClone":!0}),t.fromArray=function(e,t){void 0===t&&(t=0),this.elements[0]=e[t+0],this.elements[1]=e[t+1],this.elements[2]=e[t+2],this.elements[3]=e[t+3]},t.cloneTo=function(e){var t=e.elements,i=this.elements;t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3]},t.clone=function(){var e=new this.constructor;return this.cloneTo(e),e},t.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},t.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},r(0,t,"x",function(){return this.elements[0]},function(e){this.elements[0]=e}),r(0,t,"y",function(){return this.elements[1]},function(e){this.elements[1]=e}),r(0,t,"z",function(){return this.elements[2]},function(e){this.elements[2]=e}),r(0,t,"w",function(){return this.elements[3]},function(e){this.elements[3]=e}),e.lerp=function(e,t,i,n){var a=n.elements,r=e.elements,o=t.elements,s=r[0],h=r[1],l=r[2],c=r[3];a[0]=s+i*(o[0]-s),a[1]=h+i*(o[1]-h),a[2]=l+i*(o[2]-l),a[3]=c+i*(o[3]-c)},e.transformByM4x4=function(e,t,i){var n=e.elements,a=n[0],r=n[1],o=n[2],s=n[3],h=t.elements,l=i.elements;l[0]=a*h[0]+r*h[4]+o*h[8]+s*h[12],l[1]=a*h[1]+r*h[5]+o*h[9]+s*h[13],l[2]=a*h[2]+r*h[6]+o*h[10]+s*h[14],l[3]=a*h[3]+r*h[7]+o*h[11]+s*h[15]},e.equals=function(e,t){var i=e.elements,n=t.elements;return It.nearEqual(Math.abs(i[0]),Math.abs(n[0]))&&It.nearEqual(Math.abs(i[1]),Math.abs(n[1]))&&It.nearEqual(Math.abs(i[2]),Math.abs(n[2]))&&It.nearEqual(Math.abs(i[3]),Math.abs(n[3]))},e.normalize=function(e,t){var i=e.elements,n=t.elements,a=e.length();a>0&&(n[0]=i[0]*a,n[1]=i[1]*a,n[2]=i[2]*a,n[3]=i[3]*a)},e.add=function(e,t,i){var n=i.elements,a=e.elements,r=t.elements;n[0]=a[0]+r[0],n[1]=a[1]+r[1],n[2]=a[2]+r[2],n[3]=a[3]+r[3]},e.subtract=function(e,t,i){var n=i.elements,a=e.elements,r=t.elements;n[0]=a[0]-r[0],n[1]=a[1]-r[1],n[2]=a[2]-r[2],n[3]=a[3]-r[3]},e.multiply=function(e,t,i){var n=i.elements,a=e.elements,r=t.elements;n[0]=a[0]*r[0],n[1]=a[1]*r[1],n[2]=a[2]*r[2],n[3]=a[3]*r[3]},e.scale=function(e,t,i){var n=i.elements,a=e.elements;n[0]=a[0]*t,n[1]=a[1]*t,n[2]=a[2]*t,n[3]=a[3]*t},e.Clamp=function(e,t,i,n){var a=e.elements,r=a[0],o=a[1],s=a[2],h=a[3],l=t.elements,c=l[0],p=l[1],u=l[2],d=l[3],_=i.elements,m=_[0],f=_[1],g=_[2],y=_[3],v=n.elements;r=(r=r>m?m:r)<c?c:r,o=(o=o>f?f:o)<p?p:o,s=(s=s>g?g:s)<u?u:s,h=(h=h>y?y:h)<d?d:h,v[0]=r,v[1]=o,v[2]=s,v[3]=h},e.distanceSquared=function(e,t){var i=e.elements,n=t.elements,a=i[0]-n[0],r=i[1]-n[1],o=i[2]-n[2],s=i[3]-n[3];return a*a+r*r+o*o+s*s},e.distance=function(e,t){var i=e.elements,n=t.elements,a=i[0]-n[0],r=i[1]-n[1],o=i[2]-n[2],s=i[3]-n[3];return Math.sqrt(a*a+r*r+o*o+s*s)},e.dot=function(e,t){var i=e.elements,n=t.elements;return i[0]*n[0]+i[1]*n[1]+i[2]*n[2]+i[3]*n[3]},e.min=function(e,t,i){var n=i.elements,a=e.elements,r=t.elements;n[0]=Math.min(a[0],r[0]),n[1]=Math.min(a[1],r[1]),n[2]=Math.min(a[2],r[2]),n[3]=Math.min(a[3],r[3])},e.max=function(e,t,i){var n=i.elements,a=e.elements,r=t.elements;n[0]=Math.max(a[0],r[0]),n[1]=Math.max(a[1],r[1]),n[2]=Math.max(a[2],r[2]),n[3]=Math.max(a[3],r[3])},n(e,["ZERO",function(){return this.ZERO=new e},"ONE",function(){return this.ONE=new e(1,1,1,1)},"UnitX",function(){return this.UnitX=new e(1,0,0,0)},"UnitY",function(){return this.UnitY=new e(0,1,0,0)},"UnitZ",function(){return this.UnitZ=new e(0,0,1,0)},"UnitW",function(){return this.UnitW=new e(0,0,0,1)}]),e}(),Bt=function(){function e(e,t,i,n){this.minDepth=0,this.maxDepth=1,this.x=e,this.y=t,this.width=i,this.height=n}a(e,"laya.d3.math.Viewport");var t=e.prototype;return t.project=function(e,t,i){At.transformV3ToV3(e,t,i);var n=e.elements,a=t.elements,r=i.elements,o=n[0]*a[3]+n[1]*a[7]+n[2]*a[11]+a[15];1!==o&&(r[0]=r[0]/o,r[1]=r[1]/o,r[2]=r[2]/o),r[0]=.5*(r[0]+1)*this.width+this.x,r[1]=.5*(1-r[1])*this.height+this.y,r[2]=r[2]*(this.maxDepth-this.minDepth)+this.minDepth},t.unprojectFromMat=function(e,t,i){var n=e.elements,a=t.elements,r=i.elements;r[0]=(n[0]-this.x)/this.width*2-1,r[1]=-((n[1]-this.y)/this.height*2-1);var o=(this.maxDepth-this.minDepth)/2;r[2]=(n[2]-this.minDepth-o)/o;var s=r[0]*a[3]+r[1]*a[7]+r[2]*a[11]+a[15];At.transformV3ToV3(i,t,i),1!==s&&(r[0]=r[0]/s,r[1]=r[1]/s,r[2]=r[2]/s)},t.unprojectFromWVP=function(t,i,n,a,r){Ct.multiply(i,n,e._tempMatrix4x4),a&&Ct.multiply(e._tempMatrix4x4,a,e._tempMatrix4x4),e._tempMatrix4x4.invert(e._tempMatrix4x4),this.unprojectFromMat(t,e._tempMatrix4x4,r)},n(e,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new Ct}]),e}(),Pt=function(){function e(){this._alphaBlending=1,this._colorIntensity=1,this._shaderValue=new Ft}a(e,"laya.d3.resource.models.Sky");var t=e.prototype;return t._setEnvironmentDiffuse=function(){this._environmentDiffuse.loaded?this.__ownerCamera._shaderValues.setValue(7,this._environmentDiffuse):this._environmentDiffuse.on("loaded",this,this._environmentDiffuseLoaded)},t._setEnvironmentSpecular=function(){if(this._environmentSpecular.loaded){var e=this._environmentSpecular.simLodInfo;e&&e instanceof Float32Array&&this.__ownerCamera._shaderValues.setValue(9,e),this.__ownerCamera._shaderValues.setValue(8,this._environmentSpecular)}else this._environmentSpecular.on("loaded",this,this._environmentSpecularLoaded)},t._environmentDiffuseLoaded=function(){this.__ownerCamera._shaderValues.setValue(7,this._environmentDiffuse)},t._environmentSpecularLoaded=function(){var e=this._environmentSpecular.simLodInfo;e&&e instanceof Float32Array&&this.__ownerCamera._shaderValues.setValue(9,e),this.__ownerCamera._shaderValues.setValue(8,this._environmentSpecular)},t._render=function(e){},t.destroy=function(){this.__ownerCamera=null},r(0,t,"_ownerCamera",null,function(e){this.__ownerCamera=e,this._environmentDiffuse&&this._setEnvironmentDiffuse(),this._environmentSpecular&&this._setEnvironmentSpecular()}),r(0,t,"alphaBlending",function(){return this._alphaBlending},function(e){this._alphaBlending=e,this._alphaBlending<0&&(this._alphaBlending=0),this._alphaBlending>1&&(this._alphaBlending=1)}),r(0,t,"envDiffuseSHBlue",null,function(e){this.__ownerCamera._shaderValues.setValue(12,e)}),r(0,t,"colorIntensity",function(){return this._colorIntensity},function(e){this._colorIntensity=e,this._colorIntensity<0&&(this._colorIntensity=0)}),r(0,t,"envDiffuseSHGreen",null,function(e){this.__ownerCamera._shaderValues.setValue(11,e)}),r(0,t,"envDiffuseSHRed",null,function(e){this.__ownerCamera._shaderValues.setValue(10,e)}),r(0,t,"environmentDiffuse",function(){return this._environmentDiffuse},function(e){e.minFifter=9728,this._environmentDiffuse=e,this.__ownerCamera&&this._setEnvironmentDiffuse()}),r(0,t,"environmentSpecular",function(){return this._environmentSpecular},function(e){this._environmentSpecular=e,this.__ownerCamera&&this._setEnvironmentSpecular()}),e.MVPMATRIX=0,e.INTENSITY=1,e.ALPHABLENDING=2,e.DIFFUSETEXTURE=3,e}(),Ot=function(){function e(e){this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._indexInMesh=0,this._vertexBuffer=null,this._vertexStart=0,this._vertexCount=0,this._indexBuffer=null,this._indexStart=0,this._indexCount=0,this._indices=null,this._bufferUsage={},this._mesh=e,this._boneIndicesList=[],this._subIndexBufferStart=[],this._subIndexBufferCount=[]}a(e,"laya.d3.resource.models.SubMesh");var t=e.prototype;return i.imps(t,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),t._getVertexBuffer=function(e){return void 0===e&&(e=0),0===e?this._vertexBuffer:null},t._getIndexBuffer=function(){return this._indexBuffer},t._getStaticBatchBakedVertexs=function(t,i){var n,a,r=this._vertexBuffer,o=r.vertexDeclaration,s=o.getVertexElementByUsage(0).offset/4,h=o.getVertexElementByUsage(3).offset/4,l=i.meshRender.lightmapScaleOffset,c=0,p=0,u=0,d=0,_=0,m=0;if(l)if(a=o.getVertexElementByUsage(15))u=o.vertexStride/4,n=this._vertexCount>0?r.getData().slice(this._vertexStart*u,(this._vertexStart+this._vertexCount)*u):r.getData().slice(),d=a.offset/4;else{u=(m=o.vertexStride/4)+2,n=this._vertexCount?new Float32Array(this._vertexCount*(r.vertexDeclaration.vertexStride/4+2)):new Float32Array(r.vertexCount*(r.vertexDeclaration.vertexStride/4+2)),d=(_=o.getVertexElementByUsage(2).offset/4)+2;var f=r.getData();for(c=0,p=f.length/m;c<p;c++){var g=0;g=this._vertexCount>0?(this._vertexStart+c)*m:c*m;var y=c*u,v=0;for(v=0;v<d;v++)n[y+v]=f[g+v];for(v=d;v<m;v++)n[y+v+2]=f[g+v]}}else u=o.vertexStride/4,n=this._vertexCount?r.getData().slice(this._vertexStart*u,(this._vertexStart+this._vertexCount)*u):r.getData().slice();if(t){var x=t.worldMatrix,b=e._tempMatrix4x40;x.invert(b);var w=e._tempMatrix4x41,S=i.transform.worldMatrix;Ct.multiply(b,S,w)}else w=i.transform.worldMatrix;var I=e._tempQuaternion0;for(w.decomposeTransRotScale(e._tempVector30,I,e._tempVector31),c=0,p=n.length/u;c<p;c++){var M=c*u+s,C=c*u+h;if(Jt.transformVector3ArrayToVector3ArrayCoordinate(n,M,w,n,M),Jt.transformVector3ArrayByQuat(n,C,I,n,C),l){var k=c*u+d;if(a)Jt.transformLightingMapTexcoordByUV1Array(n,k,l,n,k);else{var E=c*m+_;Jt.transformLightingMapTexcoordByUV0Array(f,E,l,n,k)}}}return n},t._getVertexBuffers=function(){return null},t._beforeRender=function(e){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},t._render=function(e){var t,i=0,n=e.renderElement;if(this._indexCount>1){var a=this._boneIndicesList.length;if(a>1){for(var r=0;r<a;r++)(t=n._skinAnimationDatas||this._skinAnimationDatas)&&(n._shaderValue.setValue(0,t[r]),e._shader.uploadRenderElementUniforms(n._shaderValue.data)),A.mainContext.drawElements(4,this._subIndexBufferCount[r],5123,2*this._subIndexBufferStart[r]);T.drawCall+=a}else(t=n._skinAnimationDatas||this._skinAnimationDatas)&&(n._shaderValue.setValue(0,t[0]),e._shader.uploadRenderElementUniforms(n._shaderValue.data)),A.mainContext.drawElements(4,this._indexCount,5123,2*this._indexStart),T.drawCall++;i=this._indexCount}else i=this._indexBuffer.indexCount,(t=n._skinAnimationDatas||this._skinAnimationDatas)&&(n._shaderValue.setValue(0,t[0]),e._shader.uploadRenderElementUniforms(n._shaderValue.data)),A.mainContext.drawElements(4,i,5123,0),T.drawCall++;T.trianglesFaces+=i/3},t.getIndices=function(){return this._indexCount>0?this._indices:this._indexBuffer.getData()},t.dispose=function(){this._indexBuffer.destroy(),this._vertexBuffer.destroy(),this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._vertexBuffer=null,this._indexBuffer=null},r(0,t,"_vertexBufferCount",function(){return 1}),r(0,t,"triangleCount",function(){return this._indexBuffer.indexCount/3}),n(e,["_tempVector30",function(){return this._tempVector30=new At},"_tempVector31",function(){return this._tempVector31=new At},"_tempQuaternion0",function(){return this._tempQuaternion0=new Tt},"_tempMatrix4x40",function(){return this._tempMatrix4x40=new Ct},"_tempMatrix4x41",function(){return this._tempMatrix4x41=new Ct}]),e}(),Vt=function(){function e(e){this.defineCounter=0,this.defines=null,e?(this.defineCounter=e.defineCounter,this.defines=e.defines.slice()):(this.defineCounter=0,this.defines=[])}a(e,"laya.d3.shader.ShaderDefines",null,"ShaderDefines$1");return e.prototype.registerDefine=function(e){var t=Math.pow(2,this.defineCounter++);return this.defines[t]=e,t},e}(),Ut=function(){function e(){}return a(e,"laya.d3.shader.ShaderInit3D"),e.__init__=function(){ci._globalRegDefine("HIGHPRECISION",ci.SHADERDEFINE_HIGHPRECISION),ci._globalRegDefine("FOG",ci.SHADERDEFINE_FOG),ci._globalRegDefine("DIRECTIONLIGHT",ci.SHADERDEFINE_DIRECTIONLIGHT),ci._globalRegDefine("POINTLIGHT",ci.SHADERDEFINE_POINTLIGHT),ci._globalRegDefine("SPOTLIGHT",ci.SHADERDEFINE_SPOTLIGHT),ci._globalRegDefine("UV",ci.SHADERDEFINE_UV0),ci._globalRegDefine("COLOR",ci.SHADERDEFINE_COLOR),ci._globalRegDefine("UV1",ci.SHADERDEFINE_UV1),ci._globalRegDefine("CASTSHADOW",Ht.SHADERDEFINE_CAST_SHADOW),ci._globalRegDefine("SHADOWMAP_PSSM1",Ht.SHADERDEFINE_SHADOW_PSSM1),ci._globalRegDefine("SHADOWMAP_PSSM2",Ht.SHADERDEFINE_SHADOW_PSSM2),ci._globalRegDefine("SHADOWMAP_PSSM3",Ht.SHADERDEFINE_SHADOW_PSSM3),ci._globalRegDefine("SHADOWMAP_PCF_NO",Ht.SHADERDEFINE_SHADOW_PCF_NO),ci._globalRegDefine("SHADOWMAP_PCF1",Ht.SHADERDEFINE_SHADOW_PCF1),ci._globalRegDefine("SHADOWMAP_PCF2",Ht.SHADERDEFINE_SHADOW_PCF2),ci._globalRegDefine("SHADOWMAP_PCF3",Ht.SHADERDEFINE_SHADOW_PCF3),ci._globalRegDefine("DEPTHFOG",ci.SAHDERDEFINE_DEPTHFOG),Oi.addInclude("LightHelper.glsl","\nstruct DirectionLight\n{\n vec3 Direction;\n vec3 Diffuse;\n};\n\nstruct PointLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n float Range;\n};\n\nstruct SpotLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n vec3 Direction;\n float Spot;\n float Range;\n};\n\n\nvec3 NormalSampleToWorldSpace(vec3 normalMapSample, vec3 unitNormal, vec3 tangent)\n{\n\tvec3 normalT = 2.0*normalMapSample - 1.0;\n\n\t// Build orthonormal basis.\n\tvec3 N = normalize(unitNormal);\n\tvec3 T = normalize(tangent- dot(tangent, N)*N);\n\tvec3 B = cross(T, N);\n\n\tmat3 TBN = mat3(T, B, N);\n\n\t// Transform from tangent space to world space.\n\tvec3 bumpedNormal = TBN*normalT;\n\n\treturn bumpedNormal;\n}\n\n\nvoid  computeDirectionLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in DirectionLight dirLight,in vec3 ambinentColor,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);//不初始化在IOS中闪烁，PC中不会闪烁\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec=-normalize(dirLight.Direction);\n\t\n\tamb=matAmb*ambinentColor;\n\t\n\tfloat  diffuseFactor=dot(lightVec, normal);\n\t\n\tif(diffuseFactor>0.0)\n\t{\n\t   vec3 v = reflect(-lightVec, normal);\n\t   float specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t   \n\t   dif = diffuseFactor * matDif * dirLight.Diffuse;\n\t   spec = specFactor * matSpe.rgb;\n\t}\n\t\n}\n\nvoid computePointLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in PointLight poiLight,in vec3 ambinentColor, in vec3 pos,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec = poiLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > poiLight.Range )\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif( diffuseFactor > 0.0 )\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * poiLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\n\tfloat attenuate = 1.0 / dot(poiLight.Attenuation, vec3(1.0, d, d*d));\n\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\nvoid ComputeSpotLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in SpotLight spoLight,in vec3 ambinentColor,in vec3 pos, in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tamb = vec3(0.0);\n\tdif =vec3(0.0);\n\tspec= vec3(0.0);\n\tvec3 lightVec = spoLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > spoLight.Range)\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif(diffuseFactor > 0.0)\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * spoLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\t\n\tfloat spot = pow(max(dot(-lightVec, normalize(spoLight.Direction)), 0.0), spoLight.Spot);\n\n\tfloat attenuate = spot/dot(spoLight.Attenuation, vec3(1.0, d, d*d));\n\n\tamb *= spot;\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\n"),Oi.addInclude("Lighting.glsl","\nstruct DirectionLight\n{\n\tvec3 Color;\n\tvec3 Direction;\n};\n\nstruct PointLight\n{\n\tvec3 Color;\n\tvec3 Position;\n\tfloat Range;\n};\n\nstruct SpotLight\n{\n\tvec3 Color;\n\tvec3 Position;\n\tvec3 Direction;\n\tfloat Spot;\n\tfloat Range;\n};\n\n// U3D中使用衰减纹理,此函数模拟并非正确\n//float U3DAttenuation(in vec3 L,in float invLightRadius)\n//{\n//\tfloat fRatio = clamp(length(L) * invLightRadius,0.0,1.0);\n//\tfRatio *= fRatio;\n//\treturn 1.0 / (1.0 + 25.0 * fRatio)* clamp(4.0*(1.0 - fRatio),0.0,1.0); //fade to black as if 4 pixel texture\n//} \n\n// Same as Just Cause 2 and Crysis 2 (you can read GPU Pro 1 book for more information)\nfloat BasicAttenuation(in vec3 L,in float invLightRadius)\n{\n\tvec3 distance = L * invLightRadius;\n\tfloat attenuation = clamp(1.0 - dot(distance, distance),0.0,1.0); // Equals float attenuation = saturate(1.0f - dot(L, L) / (lightRadius *  lightRadius)); \t\n\treturn attenuation * attenuation;\n} \n\n// Inspired on http://fools.slindev.com/viewtopic.php?f=11&t=21&view=unread#unread\t\nfloat NaturalAttenuation(in vec3 L,in float invLightRadius)\n{\n\tfloat attenuationFactor = 30.0;\n\tvec3 distance = L * invLightRadius;\n\tfloat attenuation = dot(distance, distance); // Equals float attenuation = dot(L, L) / (lightRadius *  lightRadius);\n\tattenuation = 1.0 / (attenuation * attenuationFactor + 1.0);\n\t// Second we move down the function therewith it reaches zero at abscissa 1:\n\tattenuationFactor = 1.0 / (attenuationFactor + 1.0); //attenuationFactor contains now the value we have to subtract\n\tattenuation = max(attenuation - attenuationFactor, 0.0); // The max fixes a bug.\n\t// Finally we expand the equation along the y-axis so that it starts with a function value of 1 again.\n\tattenuation /= 1.0 - attenuationFactor;\n\treturn attenuation;\n} \n\nvoid LayaAirBlinnPhongLight (in vec3 specColor,in float specColorIntensity,in vec3 normal,in vec3 gloss, in vec3 viewDir,in vec3 lightColor, in vec3 lightVec,out vec3 diffuseColor,out vec3 specularColor)\n{\n    mediump vec3 h = normalize(viewDir-lightVec);\n    lowp float ln = max (0.0, dot (-lightVec,normal));\n    float nh = max (0.0, dot (h,normal));\n\tdiffuseColor=lightColor * ln;\n\tspecularColor=lightColor *specColor*pow (nh, specColorIntensity*128.0) * gloss;\n}\n\nvoid LayaAirBlinnPhongDiectionLight (in vec3 specColor,in float specColorIntensity,in vec3 normal,in vec3 gloss, in vec3 viewDir, in DirectionLight light,out vec3 diffuseColor,out vec3 specularColor)\n{\n\tvec3 lightVec=normalize(light.Direction);\n\tLayaAirBlinnPhongLight(specColor,specColorIntensity,normal,gloss,viewDir,light.Color,lightVec,diffuseColor,specularColor);\n}\n\nvoid LayaAirBlinnPhongPointLight (in vec3 pos,in vec3 specColor,in float specColorIntensity,in vec3 normal,in vec3 gloss, in vec3 viewDir, in PointLight light,out vec3 diffuseColor,out vec3 specularColor)\n{\n\tvec3 lightVec =  pos-light.Position;\n\t//if( length(lightVec) > light.Range )\n\t//\treturn;\n\tLayaAirBlinnPhongLight(specColor,specColorIntensity,normal,gloss,viewDir,light.Color,lightVec/length(lightVec),diffuseColor,specularColor);\n\tfloat attenuate = BasicAttenuation(lightVec, 1.0/light.Range);\n\tdiffuseColor *= attenuate;\n\tspecularColor*= attenuate;\n}\n\nvoid LayaAirBlinnPhongSpotLight (in vec3 pos,in vec3 specColor,in float specColorIntensity,in vec3 normal,in vec3 gloss, in vec3 viewDir, in SpotLight light,out vec3 diffuseColor,out vec3 specularColor)\n{\n\tvec3 lightVec =  pos-light.Position;\n\t//if( length(lightVec) > light.Range )\n\t//\treturn;\n\tvec3 normalLightVec=lightVec/length(lightVec);\n\tLayaAirBlinnPhongLight(specColor,specColorIntensity,normal,gloss,viewDir,light.Color,normalLightVec,diffuseColor,specularColor);\n\tfloat spot = pow(max(dot(normalLightVec, normalize(light.Direction)), 0.0), light.Spot);\n\tfloat attenuate = spot*BasicAttenuation(lightVec, 1.0/light.Range);\n\tdiffuseColor *= attenuate;\n\tspecularColor*= attenuate;\n}\n\nvec3 NormalSampleToWorldSpace(vec3 normalMapSample, vec3 unitNormal, vec3 tangent,vec3 binormal)\n{\n\tvec3 normalT =vec3(2.0*normalMapSample.x - 1.0,1.0-2.0*normalMapSample.y,2.0*normalMapSample.z - 1.0);\n\t\n\t// Build orthonormal basis.\n\tvec3 N = normalize(unitNormal);\n\tvec3 T = normalize(tangent);\n\tvec3 B = normalize(binormal);\n\tmat3 TBN = mat3(T, B, N);\n\t\n\t// Transform from tangent space to world space.\n\tvec3 bumpedNormal = TBN*normalT;\n\n\treturn bumpedNormal;\n}\n\n\n"),Oi.addInclude("ShadowHelper.glsl","uniform sampler2D u_shadowMap1;\nuniform sampler2D u_shadowMap2;\nuniform sampler2D u_shadowMap3;\nuniform vec2\t  u_shadowPCFoffset;\nuniform vec4     u_shadowPSSMDistance;\nvec4 packDepth(const in float depth)\n{\n\tconst vec4 bitShift = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);\n\tconst vec4 bitMask\t= vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);\n\tvec4 res = mod(depth*bitShift*vec4(255), vec4(256))/vec4(255);\n\tres -= res.xxyz * bitMask;\n\treturn res;\n}\nfloat unpackDepth(const in vec4 rgbaDepth)\n{\n\tconst vec4 bitShift = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);\n\tfloat depth = dot(rgbaDepth, bitShift);\n\treturn depth;\n}\nfloat tex2DPCF( sampler2D shadowMap,vec2 texcoord,vec2 invsize,float zRef )\n{\n\tvec2 texelpos =texcoord / invsize;\n\tvec2 lerps = fract( texelpos );\n\tfloat sourcevals[4];\n\tsourcevals[0] = float( unpackDepth(texture2D(shadowMap,texcoord)) > zRef );\n\tsourcevals[1] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x,0))) > zRef );\n\tsourcevals[2] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(0,invsize.y))) > zRef );\n\tsourcevals[3] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x, invsize.y) )) > zRef );\n\treturn mix( mix(sourcevals[0],sourcevals[2],lerps.y),mix(sourcevals[1],sourcevals[3],lerps.y),lerps.x );\n}\nfloat getShadowPSSM3( sampler2D shadowMap1,sampler2D shadowMap2,sampler2D shadowMap3,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\tnPSNum += int(posViewZ>pssmDistance.z);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\telse if( nPSNum == 2 )\n\t{\n\t\tlightVP = lightShadowVP[3];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t} \n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap3,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM2( sampler2D shadowMap1,sampler2D shadowMap2,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM1( sampler2D shadowMap1,vec4 lightMVPPos,vec4 pssmDistance,vec2 shadowPCFOffset,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tif( posViewZ < pssmDistance.x )\n\t{\n\t\tvec3 vText = lightMVPPos.xyz / lightMVPPos.w;\n\t\tfloat fMyZ = vText.z - zBias;\n\t\t/*\n\t\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\t\tbool bInFrustum = all( bInFrustumVec );\n\t\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\t\tbool bFrustumTest = all( bFrustumTestVec );\n\t\t*/\n\t\tif ( fMyZ <= 1.0 ) \n\t\t{\n\t\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,fMyZ );\n\t\t\tvalue = value/4.0;\n#endif\n#ifdef SHADOWMAP_PCF2\t\t\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF_NO\t\t\n\t\t\tvec4 color = texture2D( shadowMap1,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t\t}\n\t}\n\treturn value;\n}"),Oi.addInclude("WaveFunction.glsl","\nuniform vec2 u_WaveInfoD[20];\nuniform vec4 u_WaveInfo[20];\n\nuniform float TEXWAVE_UV_SCALE ;//= 20.0; //每texwidth像素代表的实际距离\n/**\n\t这里的计算都是\n*/\n\n/**\n* 计算一个波形\n*  开始计算的时候都按照z向上，最后输出的时候，颠倒一下。\n* @param tm {float} 毫秒\n*/\nvoid calcGerstnerWave(float curtm, vec3 pos, float deep, vec2 uvpos, out vec3 opos, out vec3 B, out vec3 T, out vec3 N, out float foamS){\n\tfloat tm = curtm/1000.;\n\topos = pos;\n\tvec3 wpos=vec3(0.);\t\t//累加的位置\n\tN=vec3(0.,0.,0.);\t//输出的法线初始化一下\n\tT=vec3(0.,0.,0.);\n\tB=vec3(0.,0.,0.);\n\tvec2 cD ;//= D;\n\t//float deepAtt = max(0.,min(deep,1.0));\n\t//A*=deepAtt; //TODO\n\t\n\tfor( int i=0; i<4; i++){\n\t\tcD = u_WaveInfoD[i];//vec2(wi.winfo[0],wi.winfo[1]);// wi.vDir;\n\t\tfloat Q = u_WaveInfo[i].x;//wi.QorK;\n\t\tfloat A = u_WaveInfo[i].y;//wi.A;\n\t\tfloat W = u_WaveInfo[i].z;//wi.omega;\n\t\tfloat P = u_WaveInfo[i].w;//wi.phi;\n\t\tfloat dop = dot(cD,uvpos);\n\t\tfloat c = cos(dop*W - tm*P);//TODO 优化\n\t\tfloat s = sin(dop*W - tm*P);\n\t\tfloat AWs = A*W*s;\n\t\tfloat AWc = A*W*c;\n\t\tfloat _QxyAWs = -Q*cD.x*cD.y*AWs;\n\t\t\n\t\twpos += vec3(Q*A*cD.x*c,\n\t\t\t\t\tQ*A*cD.y*c,\n\t\t\t\t\tA*s);\n\t\tN += vec3(-cD.x*AWc,\n\t\t\t\t-cD.y*AWc,\n\t\t\t\tQ*AWs);//记得最后1-\n\t\tT += vec3(_QxyAWs,\n\t\t\t\tQ*cD.y*cD.y*AWs,//记得1-\n\t\t\t\tcD.y*AWc\n\t\t\t);\n\t\tB += vec3(Q*cD.x*cD.x*AWs,//记得1-\n\t\t\t\t_QxyAWs,\n\t\t\t\tcD.x*AWc\n\t\t\t);\n\t\t//float v1 = exp(-tan((dop*W - tm*P)/2.+1.07));//除2，+pi/2 这样正好能对齐\n#ifdef USE_FOAM\t\t\n\t\tfloat v1 = 0.5-sin((dop*W - tm*P)/1.+2.0)/2.;\n\t\tfoamS += pow(v1,9.)/4.;\n#endif\n\t}\n\tT.y=1.-T.y; B.x=1.-B.x;N.z=1.-N.z;\n\topos += vec3(wpos.x,wpos.z*min(deep/10.,1.),wpos.y);\n\t//y和z交换一下。现在根据uv计算的位置，所以直接交换yz就行。其他情况下有问题么\n\tT.xyz=T.xzy;\n\tB.xyz=B.xzy;\n\tN.xyz=N.xzy;\n}\n\n\nvoid calcWave(float curtm, vec2 uv, out vec3 B, out vec3 T, out vec3 N){\n\tfloat tm = curtm/1000.;\n\tN=vec3(0.,0.,0.);\t//输出的法线初始化一下\n\tvec2 uvpos = uv*TEXWAVE_UV_SCALE; //TODO 这个范围是什么 就是1？\n\tuvpos.y*=-1.;\n\tvec2 cD;// = D;\n\tconst int NumWaves = 4;\n\tfloat scale = 1./float(NumWaves);\n\tfor( int i=0; i<NumWaves; i++){\n\t\tcD = u_WaveInfoD[i];//vec2(wi.winfo[0],wi.winfo[1]);// wi.vDir;\n\t\tfloat k = 1.5;//u_WaveInfo[i].x;//wi.QorK; TODO  不知道为什么，这个取u_WaveInfo[i].x，在mi3w上就会闪。测试发现实际值也传过来了，就是1.5\n\t\tfloat A = u_WaveInfo[i].y;//wi.A;\n\t\tfloat W = u_WaveInfo[i].z;//wi.omega;\n\t\tfloat P = u_WaveInfo[i].w;//wi.phi;\n\t\t\n\t\tfloat dop = dot(cD,uvpos);\n\t\tfloat c = cos(dop*W - tm*P);//TODO 优化\n\t\tfloat s = sin(dop*W - tm*P);\n\t\t/*\n\t\tfloat AWs = A*W*s;\n\t\tfloat AWc = A*W*c;\n\t\tfloat _QxyAWs = -Q*cD.x*cD.y*AWs;\n\t\t\n\t\tN += vec3(-cD.x*AWc,\n\t\t\t\t-cD.y*AWc,\n\t\t\t\tQ*AWs);//记得最后1-\n\t\t*/\n\t\tfloat kWAc = scale*c;//k*W*A*c;  为了提高精度，这里只保留sin，cos部分，实际使用的时候再乘回来。\n\t\t//float kWAc = k*W*A*c;  \n\t\tN += vec3(\n\t\t\t-kWAc*cD.x*pow((s+1.)/2.,k-1.),\n\t\t\t-kWAc*cD.y*pow((s+1.)/2.,k-1.),\n\t\t\t1.\n\t\t);\n\t}\n\t//N.z=1.-N.z;\n\t//y和z交换一下。现在根据uv计算的位置，所以直接交换yz就行。其他情况下有问题么\n\tN.xyz=N.xzy;\n}\n"),Oi.addInclude("BRDF.glsl","vec4 LayaAirBRDF(in vec3 diffuseColor, in vec3 specularColor, in float oneMinusReflectivity, in float smoothness, in vec3 normal, in vec3 viewDir, in vec3 lightDir, in vec3 lightColor, in vec3 gi)\n{\n\tfloat perceptualRoughness = SmoothnessToPerceptualRoughness(smoothness);\n\tvec3 halfDir = SafeNormalize(viewDir - lightDir);\n\t\n\tfloat nv = abs(dot(normal, viewDir));\n\t\n\tfloat nl = clamp(dot(normal,   -lightDir),  0.0, 1.0);\n\tfloat nh = clamp(dot(normal,     halfDir),  0.0, 1.0);\n\tfloat lv = clamp(dot(lightDir,   viewDir),  0.0, 1.0);\n\tfloat lh = clamp(dot(lightDir,  -halfDir),  0.0, 1.0);\n\t\n\tfloat diffuseTerm = DisneyDiffuse(nv, nl, lh, perceptualRoughness) * nl;\n\t\n\tfloat roughness = PerceptualRoughnessToRoughness(perceptualRoughness);\n\t\n\t//#if UNITY_BRDF_GGX\n\tfloat V = SmithJointGGXVisibilityTerm(nl, nv, roughness);\n\tfloat D = GGXTerm(nh, roughness);\n\t\n\tfloat specularTerm = V * D * PI;\n\t\n\tspecularTerm = sqrt(max(0.0001, specularTerm));\n\tspecularTerm = max(0.0, specularTerm * nl);\n\t\n\tvec4 color;\n\tcolor.rgb = diffuseColor * (gi + lightColor * diffuseTerm) + specularTerm * lightColor * FresnelTerm (specularColor, lh);\n\t\n\tcolor.a = 1.0;\n\treturn color;\n}"),Oi.addInclude("PBRUtils.glsl","struct DirectionLight\n{\n\tvec3 Color;\n\tvec3 Direction;\n};\n\nvec3 UnpackScaleNormal(in vec2 uv0)\n{\n\t#ifdef NORMALTEXTURE\n\t\tvec3 normalT;\n\t\tvec4 normalMapSample = texture2D(u_NormalTexture, uv0);\n\t\tnormalT.x = 2.0 * normalMapSample.x - 1.0;\n\t\tnormalT.y = 1.0 - 2.0 * normalMapSample.y;\n\t\tnormalT.xy *= u_normalScale;\n\t\tnormalT.z = sqrt(1.0 - clamp(dot(normalT.xy, normalT.xy), 0.0, 1.0));\n\t\t\n\t\tvec3 T = normalize(v_Tangent);\n\t\tvec3 B = normalize(v_Binormal);\n\t\tvec3 N = normalize(v_Normal);\n\t\tmat3 TBN = mat3(T, B, N);\n\t\t\n\t\tvec3 bumpedNormal = TBN * normalize(normalT);\n\t\treturn bumpedNormal;\n\t#else\n\t\treturn normalize(v_Normal);\n\t#endif\n}\n\nvec4 DielectricSpecularColor = vec4(0.220916301, 0.220916301, 0.220916301, 1.0 - 0.220916301);\n\nfloat PI = 3.14159265359;\n\nvec3 FresnelTerm (in vec3 F0, in float cosA)\n{\n\treturn F0 + (vec3(1.0) - F0) * pow(1.0 - cosA, 5.0);\n}\n\nfloat PerceptualRoughnessToRoughness(in float perceptualRoughness)\n{\n\treturn perceptualRoughness * perceptualRoughness;\n}\n\nfloat PerceptualRoughnessToSpecularPower(in float perceptualRoughness)\n{\n\tfloat m = PerceptualRoughnessToRoughness(perceptualRoughness);\n\tfloat sq = max(0.0001, m * m);\n\tfloat n = (2.0 / sq) - 2.0;\n\tn = max(n, 0.0001);\n\treturn n;\n}\n\nfloat RoughnessToPerceptualRoughness(in float roughness)\n{\n\treturn sqrt(roughness);\n}\n\nfloat SmoothnessToRoughness(in float smoothness)\n{\n\treturn (1.0 - smoothness) * (1.0 - smoothness);\n}\n\nfloat SmoothnessToPerceptualRoughness(in float smoothness)\n{\n\treturn (1.0 - smoothness);\n}\n\nvec3 SafeNormalize(in vec3 inVec)\n{\n\tfloat dp3 = max(0.001,dot(inVec,inVec));\n\treturn inVec * (1.0 / sqrt(dp3));\n}\n\nfloat DisneyDiffuse(in float NdotV, in float NdotL, in float LdotH, in float perceptualRoughness)\n{\n\tfloat fd90 = 0.5 + 2.0 * LdotH * LdotH * perceptualRoughness;\n\tfloat lightScatter\t= (1.0 + (fd90 - 1.0) * pow(1.0 - NdotL,5.0));\n\tfloat viewScatter\t= (1.0 + (fd90 - 1.0) * pow(1.0 - NdotV,5.0));\n\n\treturn lightScatter * viewScatter;\n}\n\nfloat SmithJointGGXVisibilityTerm (float NdotL, float NdotV, float roughness)\n{\n\tfloat a = roughness;\n\tfloat lambdaV = NdotL * (NdotV * (1.0 - a) + a);\n\tfloat lambdaL = NdotV * (NdotL * (1.0 - a) + a);\n\n\treturn 0.5 / (lambdaV + lambdaL + 0.00001);\n}\n\nfloat GGXTerm (float NdotH, float roughness)\n{\n\tfloat a2 = roughness * roughness;\n\tfloat d = (NdotH * a2 - NdotH) * NdotH + 1.0;\n\treturn 0.31830988618 * a2 / (d * d + 0.0000001);\n}\n\nfloat OneMinusReflectivityFromMetallic(in float metallic)\n{\n\tfloat oneMinusDielectricSpec = DielectricSpecularColor.a;\n\treturn oneMinusDielectricSpec - metallic * oneMinusDielectricSpec;\n}\n\nfloat SpecularStrength(vec3 specular)\n{\n    //(SHADER_TARGET < 30)return specular.r; \n    return max (max (specular.r, specular.g), specular.b);\n}\n\nvec3 DiffuseAndSpecularFromMetallic(in vec3 diffuseColor, in float metallic, out vec3 specularColor, out float oneMinusReflectivity)\n{\n\tspecularColor = mix(DielectricSpecularColor.rgb, diffuseColor, metallic);\n\toneMinusReflectivity = OneMinusReflectivityFromMetallic(metallic);\n\treturn diffuseColor * oneMinusReflectivity;\n}\n\nvec3 EnergyConservationBetweenDiffuseAndSpecular(in vec3 diffuseColor, in vec3 specularColor, out float oneMinusReflectivity)\n{\n\toneMinusReflectivity = 1.0 - SpecularStrength(specularColor);\n\treturn diffuseColor * oneMinusReflectivity;\n}\n\nvec4 Occlusion(in vec2 uv0){\n\t#ifdef OCCLUSIONTEXTURE\n\t\tvec4 occlusionTextureColor = texture2D(u_OcclusionTexture, uv0);\n\t\tfloat occ = occlusionTextureColor.g;\n\t\tfloat oneMinusT = 1.0 - u_occlusionStrength;\n\t\tfloat lerpOneTo = oneMinusT + occ * u_occlusionStrength;\n\t\treturn occlusionTextureColor * lerpOneTo;\n\t#else\n\t\treturn vec4(1.0);\n\t#endif\n}\n\nvec2 ParallaxOffset(in vec3 viewDir){\n\t#ifdef PARALLAXTEXTURE\n\t\tfloat h = texture2D(u_ParallaxTexture, v_Texcoord0).g;\n\t\th = h * u_parallaxScale - u_parallaxScale / 2.0;\n\t\tvec3 v = viewDir;\n\t\tv.z += 0.42;\n\t\tvec2 offset = h * (v.xy / v.z);\n\t\treturn v_Texcoord0 + offset;\n\t#else\n\t\treturn v_Texcoord0;\n\t#endif\n}\n\n"),Oi.addInclude("PBRStandardLighting.glsl",'#include "PBRUtils.glsl"\n#include "BRDF.glsl"\n\nvec4 PBRStandardLight(in vec3 diffuseColor, in float metallic, in float smoothness, in vec3 normal, in vec3 viewDir, in vec3 lightDir, in vec3 lightColor, in vec3 gi)\n{\n\tfloat oneMinusReflectivity;\n\tvec3 specularColor;\n\tdiffuseColor = DiffuseAndSpecularFromMetallic (diffuseColor, metallic, specularColor, oneMinusReflectivity);\n\t\n\tvec4 color = LayaAirBRDF(diffuseColor, specularColor, oneMinusReflectivity, smoothness, normal, viewDir, lightDir, lightColor, gi);\n\treturn color;\n}\n\nvec4 PBRStandardDiectionLight (in vec3 diffuseColor, in float metallic, in float smoothness, in vec3 normal, in vec3 viewDir, in DirectionLight light, in vec3 gi)\n{\n\tvec3 lightVec = normalize(light.Direction);\n\treturn PBRStandardLight(diffuseColor, metallic, smoothness, normal, viewDir, lightVec, light.Color, gi);\n}\n\nvec2 MetallicGloss(in float diffuseTextureAlpha, in vec2 uv0)\n{\n\tvec2 mg;\n\t\n\t#ifdef METALLICGLOSSTEXTURE\n\t\tvec4 metallicGlossTextureColor = texture2D(u_MetallicGlossTexture, uv0);\n\t\t#ifdef SMOOTHNESSSOURCE_DIFFUSETEXTURE_ALPHA\n\t\t\tmg.r = metallicGlossTextureColor.r;\n\t\t\tmg.g = diffuseTextureAlpha;\n\t\t#else\n\t\t    mg = metallicGlossTextureColor.ra;\n\t\t#endif\n\t\tmg.g *= u_smoothnessScale;\n\t#else\n\t\tmg.r = u_metallic;\n\t\t#ifdef SMOOTHNESSSOURCE_DIFFUSETEXTURE_ALPHA\n\t\t\tmg.g = diffuseTextureAlpha * u_smoothnessScale;\n\t\t#else\n\t\t\tmg.g = u_smoothness;\n\t\t#endif\n\t#endif\n\t\n\treturn mg;\n}\n\n'),Oi.addInclude("PBRSpecularLighting.glsl",'#include "PBRUtils.glsl"\n#include "BRDF.glsl"\n\nvec4 PBRSpecularLight(in vec3 diffuseColor, in vec3 specularColor, in float smoothness, in vec3 normal, in vec3 viewDir, in vec3 lightDir, in vec3 lightColor, in vec3 gi)\n{\n\tfloat oneMinusReflectivity;\n\tdiffuseColor = EnergyConservationBetweenDiffuseAndSpecular (diffuseColor, specularColor, oneMinusReflectivity);\n\t\n\tvec4 color = LayaAirBRDF(diffuseColor, specularColor, oneMinusReflectivity, smoothness, normal, viewDir, lightDir, lightColor, gi);\n\treturn color;\n}\n\nvec4 PBRSpecularDiectionLight (in vec3 diffuseColor, in vec3 specularColor, in float smoothness, in vec3 normal, in vec3 viewDir, in DirectionLight light, in vec3 gi)\n{\n\tvec3 lightVec = normalize(light.Direction);\n\treturn PBRSpecularLight(diffuseColor, specularColor, smoothness, normal, viewDir, lightVec, light.Color, gi);\n}\n\nvec4 SpecularGloss(float diffuseTextureAlpha, in vec2 uv0)\n{\n    vec4 sg;\n\t\n\t#ifdef SPECULARTEXTURE\n\t\tvec4 specularTextureColor = texture2D(u_SpecularTexture, uv0);\n\t\t#ifdef SMOOTHNESSSOURCE_DIFFUSETEXTURE_ALPHA\n\t\t\tsg.rgb = specularTextureColor.rgb;\n\t\t\tsg.a = diffuseTextureAlpha;\n\t\t#else\n\t\t\tsg = specularTextureColor;\n\t\t#endif\n\t\tsg.a *= u_smoothnessScale;\n\t#else\n\t\tsg.rgb = u_SpecularColor.rgb;\n\t\t#ifdef SMOOTHNESSSOURCE_DIFFUSETEXTURE_ALPHA\n\t\t\tsg.a = diffuseTextureAlpha * u_smoothnessScale;\n\t\t#else\n\t\t\tsg.a = u_smoothness;\n\t\t#endif\n\t#endif\n\t\n    return sg;\n}\n\n');var e,t,i={a_Position:0,a_Color:1,a_Normal:3,a_Texcoord0:2,a_Texcoord1:15,a_BoneWeights:7,a_BoneIndices:6,a_Tangent0:5},n={u_Bones:[0,0],u_DiffuseTexture:[1,1],u_SpecularTexture:[3,1],u_NormalTexture:[2,1],u_ReflectTexture:[5,1],u_AlphaTestValue:[0,1],u_DiffuseColor:[6,1],u_MaterialSpecular:[8,1],u_Shininess:[9,1],u_MaterialReflect:[10,1],u_TilingOffset:[11,1],u_WorldMat:[0,2],u_MvpMatrix:[1,2],u_LightmapScaleOffset:[2,2],u_LightMap:[3,2],u_CameraPos:[0,3],u_FogStart:[1,4],u_FogRange:[2,4],u_FogColor:[0,4],"u_DirectionLight.Color":[4,4],"u_DirectionLight.Direction":[3,4],"u_PointLight.Position":[5,4],"u_PointLight.Range":[6,4],"u_PointLight.Color":[8,4],"u_SpotLight.Position":[9,4],"u_SpotLight.Direction":[10,4],"u_SpotLight.Range":[12,4],"u_SpotLight.Spot":[11,4],"u_SpotLight.Color":[14,4],u_AmbientColor:[21,4],u_shadowMap1:[18,4],u_shadowMap2:[19,4],u_shadowMap3:[20,4],u_shadowPSSMDistance:[15,4],u_lightShadowVP:[16,4],u_shadowPCFoffset:[17,4]},a=Oi.nameKey.add("BLINNPHONG");e='attribute vec4 a_Position;\nuniform mat4 u_MvpMatrix;\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(SPECULARMAP)||defined(NORMALMAP)))||(defined(LIGHTMAP)&&defined(UV))\n\tattribute vec2 a_Texcoord0;\n\tvarying vec2 v_Texcoord0;\n#endif\n\n#if defined(LIGHTMAP)&&defined(UV1)\n\tattribute vec2 a_Texcoord1;\n#endif\n\n#ifdef LIGHTMAP\n\tuniform vec4 u_LightmapScaleOffset;\n\tvarying vec2 v_LightMapUV;\n#endif\n\n#ifdef COLOR\n\tattribute vec4 a_Color;\n\tvarying vec4 v_Color;\n#endif\n\n#ifdef BONE\n\tconst int c_MaxBoneCount = 24;\n\tattribute vec4 a_BoneIndices;\n\tattribute vec4 a_BoneWeights;\n\tuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tattribute vec3 a_Normal;\n\tvarying vec3 v_Normal; \n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tuniform vec3 u_CameraPos;\n\tvarying vec3 v_ViewDir; \n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP))&&defined(NORMALMAP)\n\tattribute vec4 a_Tangent0;\n\tvarying vec3 v_Tangent;\n\tvarying vec3 v_Binormal;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\n\tuniform mat4 u_WorldMat;\n\tvarying vec3 v_PositionWorld;\n#endif\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n  #ifdef SHADOWMAP_PSSM1 \n  varying vec4 v_lightMVPPos;\n  uniform mat4 u_lightShadowVP[4];\n  #endif\n#endif\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\nvoid main_castShadow()\n{\n\t#ifdef BONE\n\t\tmat4 skinTransform=mat4(0.0);\n\t\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\t\tvec4 position=skinTransform*a_Position;\n\t\tgl_Position = u_MvpMatrix * position;\n\t#else\n\t\tgl_Position = u_MvpMatrix * a_Position;\n\t#endif\n\t \n\t//TODO没考虑UV动画呢\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tv_Texcoord0=a_Texcoord0;\n\t#endif\n\t\tv_posViewZ = gl_Position.z;\n}\n\nvoid main_normal()\n{\n\t#ifdef BONE\n\t\tmat4 skinTransform=mat4(0.0);\n\t\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\t\tvec4 position=skinTransform*a_Position;\n\t\tgl_Position = u_MvpMatrix * position;\n\t#else\n\t\tgl_Position = u_MvpMatrix * a_Position;\n\t#endif\n\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\t\tmat3 worldMat;\n\t\t#ifdef BONE\n\t\t\tworldMat=mat3(u_WorldMat*skinTransform);\n\t\t#else\n\t\t\tworldMat=mat3(u_WorldMat);\n\t\t#endif  \n\t\tv_Normal=worldMat*a_Normal;//TODO:法线可以用"魔法"矩阵\n\t\t#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\t\tv_Tangent=worldMat*a_Tangent0.xyz;\n\t\t\tv_Binormal=cross(v_Normal,v_Tangent)*a_Tangent0.w;\n\t\t#endif\n\t#endif\n\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\n\t\t#ifdef BONE\n\t\t\tv_PositionWorld=(u_WorldMat*position).xyz;\n\t\t#else\n\t\t\tv_PositionWorld=(u_WorldMat*a_Position).xyz;\n\t\t#endif\n\t#endif\n\t\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\t\tv_ViewDir=u_CameraPos-v_PositionWorld;\n\t#endif\n\n\t#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(SPECULARMAP)||defined(NORMALMAP)))\n\t\tv_Texcoord0=a_Texcoord0;\n\t\t#ifdef TILINGOFFSET\n\t\t\tv_Texcoord0=(vec2(v_Texcoord0.x,v_Texcoord0.y-1.0)*u_TilingOffset.xy)+u_TilingOffset.zw;\n\t\t\tv_Texcoord0=vec2(v_Texcoord0.x,1.0+v_Texcoord0.y);\n\t\t#endif\n\t#endif\n\n\t#ifdef LIGHTMAP\n\t\t#ifdef SCALEOFFSETLIGHTINGMAPUV\n\t\t\t#ifdef UV1\n\t\t\t\tv_LightMapUV=vec2(a_Texcoord1.x*u_LightmapScaleOffset.x+u_LightmapScaleOffset.z,1.0+a_Texcoord1.y*u_LightmapScaleOffset.y+u_LightmapScaleOffset.w);\n\t\t\t#else\n\t\t\t\tv_LightMapUV=vec2(a_Texcoord0.x,a_Texcoord0.y-1.0)*u_LightmapScaleOffset.xy+u_LightmapScaleOffset.zw;\n\t\t\t#endif \n\t\t#else\n\t\t\t#ifdef UV1\n\t\t\t\tv_LightMapUV=a_Texcoord1;\n\t\t\t#else\n\t\t\t\tv_LightMapUV=a_Texcoord0;\n\t\t\t#endif \n\t\t#endif \n\t#endif\n\n\t#ifdef COLOR\n\t\tv_Color=a_Color;\n\t#endif\n\n\t#ifdef RECEIVESHADOW\n\t\tv_posViewZ = gl_Position.w;\n\t\t#ifdef SHADOWMAP_PSSM1 \n\t\t\tv_lightMVPPos = u_lightShadowVP[0] * vec4(v_PositionWorld,1.0);\n\t\t#endif\n\t#endif\n}\n\nvoid main()\n{\n\t#ifdef CASTSHADOW\n\t\tmain_castShadow();\n\t#else\n\t\tmain_normal();\n\t#endif\n}',t='#ifdef HIGHPRECISION\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\n#include "Lighting.glsl";\n\nuniform vec4 u_DiffuseColor;\n\n#ifdef COLOR\n\tvarying vec4 v_Color;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tvarying vec3 v_ViewDir; \n#endif\n\n#ifdef ALPHATEST\n\tuniform float u_AlphaTestValue;\n#endif\n\n#ifdef DIFFUSEMAP\n\tuniform sampler2D u_DiffuseTexture;\n#endif\n\n#ifdef REFLECTMAP\n\tuniform samplerCube u_ReflectTexture;\n\tuniform vec3 u_MaterialReflect;\n#endif\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(SPECULARMAP)||defined(NORMALMAP)))\n\tvarying vec2 v_Texcoord0;\n#endif\n\n#ifdef LIGHTMAP\n\tvarying vec2 v_LightMapUV;\n\tuniform sampler2D u_LightMap;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\tuniform vec3 u_MaterialSpecular;\n\tuniform float u_Shininess;\n\t#ifdef SPECULARMAP \n\t\tuniform sampler2D u_SpecularTexture;\n\t#endif\n#endif\n\n#ifdef FOG\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\t#ifdef ADDTIVEFOG\n\t#else\n\t\tuniform vec3 u_FogColor;\n\t#endif\n#endif\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\tuniform sampler2D u_NormalTexture;\n\tvarying vec3 v_Tangent;\n\tvarying vec3 v_Binormal;\n#endif\n\n#ifdef DIRECTIONLIGHT\n\tuniform DirectionLight u_DirectionLight;\n#endif\n\n#ifdef POINTLIGHT\n\tuniform PointLight u_PointLight;\n#endif\n\n#ifdef SPOTLIGHT\n\tuniform SpotLight u_SpotLight;\n#endif\n\nuniform vec3 u_AmbientColor;\n\n\n#if defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\n\tvarying vec3 v_PositionWorld;\n#endif\n\n#include "ShadowHelper.glsl"\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\t\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\t\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\n\nvoid main_castShadow()\n{\n\t//gl_FragColor=vec4(v_posViewZ,0.0,0.0,1.0);\n\tgl_FragColor=packDepth(v_posViewZ);\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tfloat alpha = texture2D(u_DiffuseTexture,v_Texcoord0).w;\n\t\tif( alpha < u_AlphaTestValue )\n\t\t{\n\t\t\tdiscard;\n\t\t}\n\t#endif\n}\nvoid main_normal()\n{\n\tvec4 mainColor=u_DiffuseColor;\n\t#ifdef DIFFUSEMAP\n\t\tvec4 difTexColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n\t\tmainColor=mainColor*difTexColor;\n\t#endif \n\t#ifdef COLOR\n\t\tmainColor=mainColor*v_Color;\n\t#endif \n    \n\t#ifdef ALPHATEST\n\t\tif(mainColor.a<u_AlphaTestValue)\n\t\t\tdiscard;\n\t#endif\n  \n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\t\tvec3 normal;\n\t\t#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\t\tvec3 normalMapSample = texture2D(u_NormalTexture, v_Texcoord0).rgb;\n\t\t\tnormal = normalize(NormalSampleToWorldSpace(normalMapSample, v_Normal, v_Tangent,v_Binormal));\n\t\t#else\n\t\t\tnormal = normalize(v_Normal);\n\t\t#endif\n\t#endif\n\t\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tvec3 viewDir= normalize(v_ViewDir);\n\t\tvec3 diffuse = vec3(0.0);\n\t\tvec3 specular= vec3(0.0);\n\t\tvec3 dif,spe;\n\t\t#ifdef SPECULARMAP\n\t\t\tvec3 gloss=texture2D(u_SpecularTexture, v_Texcoord0).rgb;\n\t\t#else\n\t\t\t#ifdef DIFFUSEMAP\n\t\t\t\tvec3 gloss=vec3(difTexColor.a);\n\t\t\t#else\n\t\t\t\tvec3 gloss=vec3(1.0);\n\t\t\t#endif\n\t\t#endif\n\t#endif\n\n\t\n\t#ifdef DIRECTIONLIGHT\n\t\tLayaAirBlinnPhongDiectionLight(u_MaterialSpecular,u_Shininess,normal,gloss,viewDir,u_DirectionLight,dif,spe);\n\t\tdiffuse+=dif;\n\t\tspecular+=spe;\n\t#endif\n \n\t#ifdef POINTLIGHT\n\t\tLayaAirBlinnPhongPointLight(v_PositionWorld,u_MaterialSpecular,u_Shininess,normal,gloss,viewDir,u_PointLight,dif,spe);\n\t\tdiffuse+=dif;\n\t\tspecular+=spe;\n\t#endif\n\n\t#ifdef SPOTLIGHT\n\t\tLayaAirBlinnPhongSpotLight(v_PositionWorld,u_MaterialSpecular,u_Shininess,normal,gloss,viewDir,u_SpotLight,dif,spe);\n\t\tdiffuse+=dif;\n\t\tspecular+=spe;\n\t#endif\n\n\t\n\tvec3 finalDiffuse;\n\t#ifdef LIGHTMAP\n\t\tfinalDiffuse=texture2D(u_LightMap, v_LightMapUV).rgb*2.0;\n\t\t//float exponent = texture2D(u_LightMap, v_LightMapUV).a;\n\t\t//finalDiffuse = texture2D(u_LightMap, v_LightMapUV).rgb;\n\t\t//float ratio = pow(2.0, exponent * 255.0 - (128.0 + 8.0));\n\t\t//finalDiffuse = finalDiffuse * 255.0 * ratio;\t\n\t\t//finalDiffuse = sqrt(finalDiffuse);\n\t#else\n\t\tfinalDiffuse=vec3(0.0);\n\t#endif\n\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tfinalDiffuse+=diffuse;\n\t#endif\n\n\t#ifdef RECEIVESHADOW\n\t\tfloat shadowValue = 1.0;\n\t\t#ifdef SHADOWMAP_PSSM3\n\t\t\tshadowValue = getShadowPSSM3( u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t\t#endif\n\t\t#ifdef SHADOWMAP_PSSM2\n\t\t\tshadowValue = getShadowPSSM2( u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t\t#endif \n\t\t#ifdef SHADOWMAP_PSSM1\n\t\t\tshadowValue = getShadowPSSM1( u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.001);\n\t\t#endif\n\t\tgl_FragColor =vec4(mainColor.rgb*(u_AmbientColor + finalDiffuse)*shadowValue,mainColor.a);\n\t#else\n\t\tgl_FragColor =vec4(mainColor.rgb*(u_AmbientColor + finalDiffuse),mainColor.a);\n\t#endif\n\t\n\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\t#ifdef RECEIVESHADOW\n\t\t\tgl_FragColor.rgb+=specular*shadowValue;\n\t\t#else\n\t\t\tgl_FragColor.rgb+=specular;\n\t\t#endif\n\t#endif\n\n\n\t#ifdef REFLECTMAP\n\t\tvec3 incident = -viewDir;\n\t\tvec3 reflectionVector = reflect(incident,normal);\n\t\tvec3 reflectionColor  = textureCube(u_ReflectTexture,reflectionVector).rgb;\n\t\tgl_FragColor.rgb += u_MaterialReflect*reflectionColor;\n\t#endif\n\t  \n\t#ifdef FOG\n\t\tfloat lerpFact=clamp((1.0/gl_FragCoord.w-u_FogStart)/u_FogRange,0.0,1.0);\n\t\t#ifdef ADDTIVEFOG\n\t\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,vec3(0.0,0.0,0.0),lerpFact);\n\t\t#else\n\t\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n\t\t#endif\n\t#endif\n}\n\nvoid main()\n{\n\t#ifdef CASTSHADOW\t\t\n\t\tmain_castShadow();\n\t#else\n\t  main_normal();\n\t#endif  \n}\n\n';var r=ci.add(a,e,t,i,n);Vi.SHADERDEFINE_DIFFUSEMAP=r.registerMaterialDefine("DIFFUSEMAP"),Vi.SHADERDEFINE_NORMALMAP=r.registerMaterialDefine("NORMALMAP"),Vi.SHADERDEFINE_SPECULARMAP=r.registerMaterialDefine("SPECULARMAP"),Vi.SHADERDEFINE_REFLECTMAP=r.registerMaterialDefine("REFLECTMAP"),Vi.SHADERDEFINE_TILINGOFFSET=r.registerMaterialDefine("TILINGOFFSET"),Vi.SHADERDEFINE_ADDTIVEFOG=r.registerMaterialDefine("ADDTIVEFOG"),i={a_Position:0,a_Color:1,a_Normal:3,a_Texcoord0:2,a_Texcoord1:15,a_TexcoordNext0:14,a_BoneWeights:7,a_BoneIndices:6,a_Tangent0:5},n={u_Bones:[0,0],u_DiffuseTexture:[1,1],u_SpecularTexture:[3,1],u_NormalTexture:[2,1],u_AmbientTexture:[5,1],u_ReflectTexture:[6,1],u_AlphaTestValue:[0,1],u_Albedo:[7,1],u_UVMatrix:[13,1],u_UVAge:[14,1],u_UVAniAge:[8,1],u_MaterialDiffuse:[10,1],u_MaterialAmbient:[9,1],u_MaterialSpecular:[11,1],u_MaterialReflect:[12,1],u_TilingOffset:[15,1],u_WorldMat:[0,2],u_MvpMatrix:[1,2],u_LightmapScaleOffset:[2,2],u_LightMap:[3,2],u_CameraPos:[0,3],u_FogStart:[1,4],u_FogRange:[2,4],u_FogColor:[0,4],"u_DirectionLight.Direction":[3,4],"u_DirectionLight.Diffuse":[4,4],"u_PointLight.Position":[5,4],"u_PointLight.Range":[6,4],"u_PointLight.Attenuation":[7,4],"u_PointLight.Diffuse":[8,4],"u_SpotLight.Position":[9,4],"u_SpotLight.Direction":[10,4],"u_SpotLight.Range":[12,4],"u_SpotLight.Spot":[11,4],"u_SpotLight.Attenuation":[13,4],"u_SpotLight.Diffuse":[14,4],u_AmbientColor:[21,4],u_shadowMap1:[18,4],u_shadowMap2:[19,4],u_shadowMap3:[20,4],u_shadowPSSMDistance:[15,4],u_lightShadowVP:[16,4],u_shadowPCFoffset:[17,4]};var o=Oi.nameKey.add("SIMPLE");e="attribute vec4 a_Position;\nuniform mat4 u_MvpMatrix;\n\n\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))||(defined(LIGHTMAP)&&defined(UV))\nattribute vec2 a_Texcoord0;\nvarying vec2 v_Texcoord0;\n  #ifdef UVTRANSFORM \n  uniform mat4 u_UVMatrix;\n  #endif\n#endif\n\n#if defined(AMBIENTMAP)||(defined(LIGHTMAP)&&defined(UV1))\nattribute vec2 a_Texcoord1;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec4 u_LightmapScaleOffset;\nvarying vec2 v_LightMapUV;\n#endif\n\n\n#ifdef COLOR\nattribute vec4 a_Color;\nvarying vec4 v_Color;\n#endif\n\n#ifdef BONE\nattribute vec4 a_BoneIndices;\nattribute vec4 a_BoneWeights;\nconst int c_MaxBoneCount = 24;\nuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nattribute vec3 a_Normal;\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP))&&defined(NORMALMAP)\nattribute vec3 a_Tangent0;\nvarying vec3 v_Tangent0;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\nuniform mat4 u_WorldMat;\nvarying vec3 v_PositionWorld;\n#endif\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n  #ifdef SHADOWMAP_PSSM1 \n  varying vec4 v_lightMVPPos;\n  uniform mat4 u_lightShadowVP[4];\n  #endif\n#endif\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\nvoid main_castShadow()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n \n//TODO没考虑UV动画呢\n#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\tv_Texcoord0=a_Texcoord0;\n#endif\n\tv_posViewZ = gl_Position.z;\n}\n\nvoid main_normal()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tmat3 worldMat;\n\t#ifdef BONE\n\t\tworldMat=mat3(u_WorldMat*skinTransform);\n\t#else\n\t\tworldMat=mat3(u_WorldMat);\n\t#endif  \n\tv_Normal=worldMat*a_Normal;\n\t#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tv_Tangent0=worldMat*a_Tangent0;\n\t#endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\n\t#ifdef BONE\n\t\tv_PositionWorld=(u_WorldMat*position).xyz;\n\t#else\n\t\tv_PositionWorld=(u_WorldMat*a_Position).xyz;\n\t#endif\n#endif\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\n\tv_Texcoord0=a_Texcoord0;\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0=(vec2(v_Texcoord0.x,v_Texcoord0.y-1.0)*u_TilingOffset.xy)+u_TilingOffset.zw;\n\t\tv_Texcoord0=vec2(v_Texcoord0.x,v_Texcoord0.y+1.0);\n\t#endif\n\t#ifdef UVTRANSFORM\n\t\tv_Texcoord0=(u_UVMatrix*vec4(v_Texcoord0,0.0,1.0)).xy;\n\t#endif\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\n\t#ifdef SCALEOFFSETLIGHTINGMAPUV\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=vec2(a_Texcoord1.x*u_LightmapScaleOffset.x+u_LightmapScaleOffset.z,1.0+a_Texcoord1.y*u_LightmapScaleOffset.y+u_LightmapScaleOffset.w);\n\t\t#else\n\t\t\tv_LightMapUV=vec2(a_Texcoord0.x,a_Texcoord0.y-1.0)*u_LightmapScaleOffset.xy+u_LightmapScaleOffset.zw;\n\t\t#endif \n\t#else\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=a_Texcoord1;\n\t\t#else\n\t\t\tv_LightMapUV=a_Texcoord0;\n\t\t#endif \n\t#endif \n#endif\n\n#ifdef COLOR\n\tv_Color=a_Color;\n#endif\n\n#ifdef RECEIVESHADOW\n\tv_posViewZ = gl_Position.w;\n\t#ifdef SHADOWMAP_PSSM1 \n\t\tv_lightMVPPos = u_lightShadowVP[0] * vec4(v_PositionWorld,1.0);\n\t#endif\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\n\tmain_castShadow();\n#else\n\tmain_normal();\n#endif\n}",t='#ifdef HIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\n#include "LightHelper.glsl";\n\nuniform vec4 u_Albedo;\n\n#ifdef ALPHATEST\nuniform float u_AlphaTestValue;\n#endif\n\n#ifdef DIFFUSEMAP\nuniform sampler2D u_DiffuseTexture;\n#endif\n\n#ifdef REFLECTMAP\nuniform samplerCube u_ReflectTexture;\nuniform vec3 u_MaterialReflect;\n#endif\n\n#if   defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\nvarying vec2 v_Texcoord0;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nvarying vec2 v_LightMapUV;\n#endif\n#ifdef AMBIENTMAP\nuniform sampler2D u_AmbientTexture;\n#endif\n#ifdef LIGHTMAP\nuniform sampler2D u_LightMap;\n#endif\n\n#ifdef COLOR\nvarying vec4 v_Color;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\nuniform vec3 u_MaterialDiffuse;\nuniform vec4 u_MaterialSpecular;\n  #if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP) \n  uniform sampler2D u_SpecularTexture;\n  #endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec3 u_MaterialAmbient;\n#endif\n\n#if defined(FOG)||defined(DEPTHFOG)\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\t#ifdef ADDTIVEFOG\n\t#else\n\t\tuniform vec3 u_FogColor;\n\t#endif\n#endif\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\nuniform sampler2D u_NormalTexture;\nvarying vec3 v_Tangent0;\n#endif\n\n#ifdef DIRECTIONLIGHT\nuniform DirectionLight u_DirectionLight;\n#endif\n\n#ifdef POINTLIGHT\nuniform PointLight u_PointLight;\n#endif\n\n#ifdef SPOTLIGHT\nuniform SpotLight u_SpotLight;\n#endif\n\nuniform vec3 u_AmbientColor;\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||(defined(RECEIVESHADOW)&&(defined(SHADOWMAP_PSM2)||defined(SHADOWMAP_PSM3)))\nuniform vec3 u_CameraPos;\n#endif\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)\nvarying vec3 v_PositionWorld;\n#endif\n\n#include "ShadowHelper.glsl"\n#ifdef RECEIVESHADOW\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\nvarying float v_posViewZ;\n\n\n\nvoid main_castShadow()\n{\n\t//gl_FragColor=vec4(v_posViewZ,0.0,0.0,1.0);\n\tgl_FragColor=packDepth(v_posViewZ);\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tfloat alpha = texture2D(u_DiffuseTexture,v_Texcoord0).w;\n\t\tif( alpha < u_AlphaTestValue )\n\t\t{\n\t\t\tdiscard;\n\t\t}\n\t#endif\n}\nvoid main_normal()\n{\n#if defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n#endif \n  \n#if defined(COLOR)&&!defined(DIFFUSEMAP)\n\tgl_FragColor=v_Color;\n#endif \n  \n#if defined(DIFFUSEMAP)&&defined(COLOR)\n\tvec4 texColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n\tgl_FragColor=texColor*v_Color;\n#endif\n  \n#if !defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=vec4(1.0,1.0,1.0,1.0);\n#endif \n    \n#ifdef ALPHATEST\n\tif(gl_FragColor.a-u_AlphaTestValue<0.0)\n\t\tdiscard;\n#endif\n  \n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tvec3 normal;\n    #if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tvec3 normalMapSample = texture2D(u_NormalTexture, v_Texcoord0).rgb;\n\t\tnormal = normalize(NormalSampleToWorldSpace(normalMapSample, v_Normal, v_Tangent0));\n\t#else\n\t\tnormal = normalize(v_Normal);\n    #endif\n#endif\n\t\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\tvec3 diffuse = vec3(0.0);\n\tvec3 ambient = vec3(0.0);\n\tvec3 specular= vec3(0.0);\n\tvec3 dif, amb, spe;\n#endif\n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(REFLECTMAP)\n\tvec3 toEye;\n\t#ifdef FOG\n\t\ttoEye=u_CameraPos-v_PositionWorld;\n\t\tfloat toEyeLength=length(toEye);\n\t\ttoEye/=toEyeLength;\n\t#else\n\t\ttoEye=normalize(u_CameraPos-v_PositionWorld);\n\t#endif\n#endif\n\t\n#ifdef DIRECTIONLIGHT\n\tcomputeDirectionLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_DirectionLight,u_AmbientColor,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n \n#ifdef POINTLIGHT\n\tcomputePointLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_PointLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef SPOTLIGHT\n\tComputeSpotLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_SpotLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef RECEIVESHADOW\n\tfloat shadowValue = 1.0;\n\t#ifdef SHADOWMAP_PSSM3\n\t\tshadowValue = getShadowPSSM3( u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif\n\t#ifdef SHADOWMAP_PSSM2\n\t\tshadowValue = getShadowPSSM2( u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif \n\t#ifdef SHADOWMAP_PSSM1\n\t\tshadowValue = getShadowPSSM1( u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.001);\n\t#endif\n#endif\n\n#ifdef AMBIENTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\n#ifdef LIGHTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\ngl_FragColor=gl_FragColor*u_Albedo;\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t#if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP)\n\t\tspecular =specular*texture2D(u_SpecularTexture, v_Texcoord0).rgb;\n    #endif\n\t#ifdef RECEIVESHADOW\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse*shadowValue) + specular*shadowValue,gl_FragColor.a);\n\t#else\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse) + specular,gl_FragColor.a);\n\t#endif\n#endif\n  \n#ifdef REFLECTMAP\n\tvec3 incident = -toEye;\n\tvec3 reflectionVector = reflect(incident,normal);\n\tvec3 reflectionColor  = textureCube(u_ReflectTexture,reflectionVector).rgb;\n\tgl_FragColor.rgb += u_MaterialReflect*reflectionColor;\n#endif\n  \n#ifdef FOG\n\tfloat lerpFact=clamp((toEyeLength-u_FogStart)/u_FogRange,0.0,1.0);\n\t#ifdef ADDTIVEFOG\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,vec3(0.0,0.0,0.0),lerpFact);\n\t#else\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n\t#endif\n#endif\n#ifdef DEPTHFOG\n\tfloat lerpFact = (-v_PositionWorld.y-u_FogStart)/u_FogRange;\n\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\t\t\n\tmain_castShadow();\n#else\n  main_normal();\n#endif  \n}\n\n',r=ci.add(o,e,t,i,n),Yi.SHADERDEFINE_DIFFUSEMAP=r.registerMaterialDefine("DIFFUSEMAP"),Yi.SHADERDEFINE_NORMALMAP=r.registerMaterialDefine("NORMALMAP"),Yi.SHADERDEFINE_SPECULARMAP=r.registerMaterialDefine("SPECULARMAP"),Yi.SHADERDEFINE_EMISSIVEMAP=r.registerMaterialDefine("EMISSIVEMAP"),Yi.SHADERDEFINE_AMBIENTMAP=r.registerMaterialDefine("AMBIENTMAP"),Yi.SHADERDEFINE_REFLECTMAP=r.registerMaterialDefine("REFLECTMAP"),Yi.SHADERDEFINE_UVTRANSFORM=r.registerMaterialDefine("UVTRANSFORM"),Yi.SHADERDEFINE_TILINGOFFSET=r.registerMaterialDefine("TILINGOFFSET"),Yi.SHADERDEFINE_ADDTIVEFOG=r.registerMaterialDefine("ADDTIVEFOG"),i={a_Position:0,a_Color:1},n={u_MvpMatrix:[1,2]};var s=Oi.nameKey.add("LINE");e="attribute vec4 a_Position;\nuniform mat4 u_MvpMatrix;\nattribute vec4 a_Color;\nvarying vec4 v_Color;\n\n\nvoid main()\n{\n  gl_Position = u_MvpMatrix * a_Position;\n  v_Color=a_Color;\n}",t="#ifdef HIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\nvarying vec4 v_Color;\n\nvoid main()\n{\n  gl_FragColor=v_Color; \n}\n\n",ci.add(s,e,t,i,n),i={a_position:0,a_normal:3,tangent:5,binormal:4,uv:2,a_BoneWeights:7,a_BoneIndices:6,a_Tangent0:5},n={u_Bones:[0,0],u_lodRect:[9,3],irrad_mat_red:[10,3],irrad_mat_green:[11,3],irrad_mat_blue:[12,3],u_hdrexposure:[13,3],u_aoObjPos:[14,1],texBaseColor:[1,1],texNormal:[2,1],texPbrInfo:[3,1],texPrefilterdEnv:[8,3],texHSNoise:[15,1],texPrefilterDiff:[7,3],u_AlphaTestValue:[0,1],texBRDFLUT:[4,1],u_UVAniAge:[5,1],u_roughness:[6,1],u_metaless:[7,1],u_UVMatrix:[8,1],u_UVAge:[9,1],modelMatrix:[0,2],mvp:[1,2],cameraPosition:[0,3],u_View:[1,3],u_Project:[2,3],u_FogStart:[1,4],u_FogRange:[2,4],u_FogColor:[0,4],"u_DirectionLight.Direction":[3,4],"u_DirectionLight.Diffuse":[4,4],"u_PointLight.Position":[5,4],"u_PointLight.Range":[6,4],"u_PointLight.Attenuation":[7,4],"u_PointLight.Diffuse":[8,4],"u_SpotLight.Position":[9,4],"u_SpotLight.Direction":[10,4],"u_SpotLight.Range":[12,4],"u_SpotLight.Spot":[11,4],"u_SpotLight.Attenuation":[13,4],"u_SpotLight.Diffuse":[14,4],u_shadowMap1:[18,4],u_shadowMap2:[19,4],u_shadowMap3:[20,4],u_shadowPSSMDistance:[15,4],u_lightShadowVP:[16,4],u_shadowPCFoffset:[17,4]};var h=Oi.nameKey.add("PBR");e="\nuniform mat4 modelMatrix;\n//uniform mat4 modelViewMatrix;\n//uniform mat4 projectionMatrix;\nuniform mat4 u_View;\nuniform mat4 u_Project;\nuniform mat4 mvp;\n//uniform mat4 viewMatrix;\nuniform vec3 cameraPosition;\n\nattribute vec3 a_position;\nattribute vec3 a_normal;\n#ifdef HAS_TANGENT\nattribute vec3 tangent;\nattribute vec3 binormal;\n#endif\nattribute vec2 uv;\n#ifdef BONE\nattribute vec4 a_BoneIndices;\nattribute vec4 a_BoneWeights;\nconst int c_MaxBoneCount = 24;\nuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\nvarying vec2 vUv;\nvarying vec3 vWorldNorm;\nvarying vec4 vViewPos;\nvarying vec4 vWorldPos;\nvarying vec3 vLightDir;\nvarying vec3 vViewDir;\n#ifdef HAS_TANGENT\nvarying vec3 vWorldTangent;\nvarying vec3 vWorldBinormal;\n#endif\n\n#ifdef RECEIVESHADOW\nvarying float v_posViewZ;\n  #ifdef SHADOWMAP_PSSM1 \n  varying vec4 v_lightMVPPos;\n  uniform mat4 u_lightShadowVP[4];\n  #endif\n#endif\n\nvoid main() {\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tgl_Position = mvp*skinTransform*vec4(a_position,1.);\n\tmat4 modelMat = modelMatrix*skinTransform;\n#else\n\tgl_Position = mvp*vec4(a_position,1.);\n\tmat4 modelMat = modelMatrix;\n#endif\t\n\tvWorldPos = modelMat*vec4(a_position,1.);\n\n#ifdef CASTSHADOW \n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tvUv = uv;\n\t#endif\t\n#else\n    vUv = uv;\n\tvWorldNorm = normalize((modelMat*vec4(a_normal,0.0)).xyz);\n\t#ifdef HAS_TANGENT\n\tvWorldTangent = normalize((modelMat*vec4(tangent,0.0)).xyz);\n\tvWorldBinormal = normalize((modelMat*vec4(binormal,0.0)).xyz);\n\t#endif\n    \n    vViewDir = (vWorldPos.xyz-cameraPosition);//这个不能normalize。否则无法线性差值了\n#ifdef RECEIVESHADOW\n\tv_posViewZ = gl_Position.z;\n\t#ifdef SHADOWMAP_PSSM1 \n\t\tv_lightMVPPos = u_lightShadowVP[0] * vWorldPos;\n\t#endif\n#endif\t\n#endif\n}\n",t='//#version 300 es\n\nprecision highp float;\nprecision lowp int;\n\nconst float PI = 3.14159265358979323846264;\nconst float _2PI = 6.2831853071796;\nvarying vec2 vUv;\nvarying vec3 vWorldNorm;\n#ifdef HAS_TANGENT\nvarying vec3 vWorldTangent;\nvarying vec3 vWorldBinormal;\n#endif\nvarying vec3 vViewDir;\nvarying vec4 vViewPos;\nvarying vec4 vWorldPos;\n//\nuniform sampler2D texBaseColor;\nuniform sampler2D texNormal;\n//预计算的贴图\nuniform sampler2D texPrefilterdEnv;\nuniform sampler2D texBRDFLUT;\nuniform sampler2D texPrefilterDiff;\n#ifdef HAS_PBRINFO\nuniform sampler2D texPbrInfo;   //Ao, Roughness, Metallic\n#endif\nuniform float u_hdrexposure;\nuniform float u_AlphaTestValue;\n\nuniform float u_roughness;\nuniform float u_metaless;\nconst float maxlv = 7.;\t//现在只支持512分辨率的环境贴图\nconst int nmaxlv = 9;//\n\t\t\t\t\t\t\t\nuniform mat4 irrad_mat_red;\nuniform mat4 irrad_mat_green;\nuniform mat4 irrad_mat_blue;\t\t\t\t\t\t\t\n\nvec3 speccontrib = vec3(0.);\n\nconst float _maxu8 = 255.0;\nconst float _maxu16 = 65535.0;\nconst float _shift8 = 256.0;    //平移的话是*256而不是255\nvec2 _RGBAToU16(const in vec4 rgba){\n    return vec2((rgba.r*_maxu8+rgba.g*_maxu8*_shift8)/_maxu16, (rgba.b*_maxu8+rgba.a*_maxu8*_shift8)/_maxu16);\n}\nvec3 _RGBEToRGB( const in vec4 rgba ){\n    float f = pow(2.0, rgba.w * 255.0 - (128.0 + 8.0));\n    return rgba.rgb * (255.0 * f);\n}\n\nfloat saturate(float v){\n    return min(max(v,0.),1.);\n}\n\nvec4 tex2dLod(sampler2D tex, float u, float v, float lod){\n\tvec2 uv = vec2(u,v);\n\tuv+=mod(gl_FragCoord.xy-vec2(0.5),2.0)*vec2(128.,0.);\n\treturn texture2D(tex,uv,lod-16.);\n}\n\n/*\n* 对一个全景图进行采样。假设x轴指向中心。\n*/\nvec4 texPanorama(sampler2D tex, const in vec3 dir){\n\tfloat envu = atan(dir.z,dir.x)/_2PI+0.5; \t\n\tfloat envv = acos(dir.y)/PI;//(1.0-dir.y)/2.0;\n\treturn texture2D(tex,vec2(envu,envv));\n}\n\nvec4 texPanoramaLod(sampler2D tex, const in vec3 dir, float lod){\n\tfloat envu = atan(dir.z,dir.x)/_2PI+0.5; \t\n\tfloat envv = acos(dir.y)/PI;//(1.0-dir.y)/2.0;\n\treturn tex2dLod(tex,envu,envv,lod);\n}\n\n/*\n    计算sh光照。\n    使用level=2，所以需要9个系数。\n    https://cseweb.ucsd.edu/~ravir/papers/envmap/envmap.pdf\n*/\nfloat environment_exposure = 1.0;\nvec3 diff_sh9(vec3 dir){\n\tvec4 shDir = vec4(dir.x,-dir.z,dir.y,1.0);\n  return max(vec3(0.0), vec3(\n\tdot(shDir, irrad_mat_red * shDir),\n\tdot(shDir, irrad_mat_green * shDir),\n\tdot(shDir, irrad_mat_blue * shDir)\n\t)) * environment_exposure;\t\n}\n\n#ifdef HAS_TANGENT\nvec3 applyNormalTex( vec3 norm, vec3 surf_norm ) {\n    vec3 mapN = norm * 2.0 - 1.0;\n    //mapN.xy = normalScale * mapN.xy;\n    mat3 tsn = mat3( vWorldTangent, vWorldBinormal, surf_norm );\n    return normalize( tsn * mapN );\n}\n#endif\n\nvec4 pbrlight(vec3 normal, float rough, float NoV, vec3 R){\n    vec4 basecolor = texture2D(texBaseColor,vUv);\n\tbasecolor.rgb = pow(basecolor.rgb,vec3(2.2));\n\tfloat metaless = 1.0; \t\n\tconst float ismetalinfov = (128./255.);\n\tif(basecolor.a>=ismetalinfov){//这时候表示金属度\n\t\tmetaless = (basecolor.a-ismetalinfov)*2.;\n\t\tbasecolor.a = 1.0;\n\t}else{\n\t\tmetaless = 0.;\n\t\tbasecolor.a = basecolor.a*2.0;\n\t}\n\t#ifdef FIX_METALESS\n\tmetaless = u_metaless;\n\t#endif\n\t#ifdef HAS_PBRINFO\t\n\tvec4 pbrinfo = texture2D(texPbrInfo, vUv);\n\tmetaless = pbrinfo.b;\n\trough = pbrinfo.g;\n\t#endif\n    const vec3 nonmetalF0 =vec3(0.02);\n    vec3 F0 =  mix(nonmetalF0, basecolor.rgb, metaless);\n\t\n    vec4 PrefilteredColor = texPanoramaLod(texPrefilterdEnv, R, rough*maxlv);\n    PrefilteredColor.rgb = _RGBEToRGB(PrefilteredColor);\n    vec4 EnvBRDF = texture2D(texBRDFLUT,vec2(rough , NoV));//TODO lod\n    vec2 rg = _RGBAToU16(EnvBRDF);    \n    speccontrib = (F0* rg.x + saturate( 50.0 * PrefilteredColor.g ) * rg.y);\n\tvec3 color_spec = PrefilteredColor.rgb*speccontrib;\n\t\n\tvec3 color_diff=diff_sh9(normal);\n\tvec3 outc =  color_diff*mix(basecolor.rgb,vec3(0.),metaless)*(vec3(1.0)-speccontrib)+color_spec;\n\t#ifdef HAS_PBRINFO\n\toutc*=pbrinfo.r;\n\t#endif\n\treturn vec4(outc, basecolor.a);\n}\n\nvec3 oldlight(vec4 normal, float NoV, vec3 R){\n    vec4 basecolor = texture2D(texBaseColor,vUv);\n\tconst vec3 lightdir=normalize(vec3(1.,1.,0.));\n\tconst vec3 spcecol = vec3(1.,0.8,0.8);\n\tconst vec3 amb = vec3(0.5);\n\tvec3 diffv =  (vec3(saturate(dot(lightdir,normal.xyz)))+amb);\n\t//vec3 spec = spcecol* pow(saturate(dot(R,lightdir)),(1.-pbrinfo.g)*5.);\n\treturn diffv*basecolor.rgb;//+spec;\n}\n\n#include "ShadowHelper.glsl"\n#ifdef RECEIVESHADOW\nvarying float v_posViewZ;\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\n\nvoid main() {\n#ifdef CASTSHADOW\n\tgl_FragColor=packDepth(gl_FragCoord.w);\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tfloat alpha = texture2D(texBaseColor,vUv).w;\n\t\tif( alpha < u_AlphaTestValue ){\n\t\t\tdiscard;\n\t\t}\n\t#endif\n#else\n\n\t#ifdef RECEIVESHADOW\n\t\tfloat shadowValue = 1.0;\n\t\t#ifdef SHADOWMAP_PSSM3\n\t\t\tshadowValue = getShadowPSSM3( u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,vWorldPos.xyz,v_posViewZ,0.0001);\n\t\t#endif\n\t\t#ifdef SHADOWMAP_PSSM2\n\t\t\tshadowValue = getShadowPSSM2( u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,vWorldPos.xyz,v_posViewZ,0.0001);\n\t\t#endif \n\t\t#ifdef SHADOWMAP_PSSM1\n\t\t\tshadowValue = getShadowPSSM1( u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.0001);\n\t\t#endif\n\t#endif\t\n\t\n    vec3 normal =  normalize(vWorldNorm);\n\tvec4 normtex = texture2D( texNormal, vUv );\n\t#ifdef HAS_TANGENT\t\n\tnormal = applyNormalTex(normtex.xyz, normal);\n\t#endif\n    vec3 view   = -normalize(vViewDir);\n    float NoV = saturate(dot( view, normal ));\n    vec3 R = 2. * NoV * normal - view;\n\tfloat roughness = normtex.a;\n\t#ifdef FIX_ROUGHNESS\n\troughness = u_roughness;\n\t#endif\n\t\n\tvec4 pbrl = pbrlight(normal,roughness,NoV,R)*u_hdrexposure;\n    gl_FragColor.rgb =  pow(pbrl.rgb,vec3(0.45455));\n\t//gl_FragColor.rgb = oldlight(normtex,NoV,R);\n\t#ifdef RECEIVESHADOW\n\tgl_FragColor.rgb *= max(shadowValue,0.7);\n\t#endif\n\t\n    gl_FragColor.a = pbrl.a;\n\n#endif\n}\n',r=ci.add(h,e,t,i,n),Hi.SHADERDEFINE_FIX_METALESS=r.registerMaterialDefine("FIX_METALESS"),Hi.SHADERDEFINE_FIX_ROUGHNESS=r.registerMaterialDefine("FIX_ROUGHNESS"),Hi.SHADERDEFINE_HAS_TANGENT=r.registerMaterialDefine("HAS_TANGENT"),Hi.SHADERDEFINE_HAS_PBRINFO=r.registerMaterialDefine("HAS_PBRINFO"),Hi.SHADERDEFINE_USE_GROUNDTRUTH=r.registerMaterialDefine("USE_GROUNDTRUTH"),Hi.SHADERDEFINE_TEST_CLIPZ=r.registerMaterialDefine("CLIPZ"),i={a_Position:0,a_Normal:3,a_Tangent0:5,a_Texcoord0:2,a_BoneWeights:7,a_BoneIndices:6},n={u_Bones:[0,0],u_MvpMatrix:[1,2],u_WorldMat:[0,2],u_CameraPos:[0,3],u_AlphaTestValue:[0,1],u_DiffuseColor:[7,1],u_EmissionColor:[8,1],u_DiffuseTexture:[1,1],u_NormalTexture:[3,1],u_ParallaxTexture:[4,1],u_MetallicGlossTexture:[2,1],u_OcclusionTexture:[5,1],u_EmissionTexture:[6,1],u_metallic:[9,1],u_smoothness:[10,1],u_smoothnessScale:[11,1],u_occlusionStrength:[13,1],u_normalScale:[14,1],u_parallaxScale:[15,1],u_TilingOffset:[17,1],"u_DirectionLight.Direction":[3,4],"u_DirectionLight.Color":[4,4],u_AmbientColor:[21,4],u_shadowMap1:[18,4],u_shadowMap2:[19,4],u_shadowMap3:[20,4],u_shadowPSSMDistance:[15,4],u_lightShadowVP:[16,4],u_shadowPCFoffset:[17,4]};var l=Oi.nameKey.add("PBRStandard");e="attribute vec4 a_Position;\nattribute vec3 a_Normal;\nattribute vec4 a_Tangent0;\nattribute vec2 a_Texcoord0;\n\nuniform mat4 u_MvpMatrix;\nuniform mat4 u_WorldMat;\nuniform vec3 u_CameraPos;\n\nvarying vec2 v_Texcoord0;\nvarying vec3 v_Normal;\nvarying vec3 v_Tangent;\nvarying vec3 v_Binormal;\nvarying vec3 v_ViewDir;\nvarying vec3 v_PositionWorld;\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n  #ifdef SHADOWMAP_PSSM1 \n\t  varying vec4 v_lightMVPPos;\n\t  uniform mat4 u_lightShadowVP[4];\n  #endif\n#endif\n\n#ifdef BONE\n\tconst int c_MaxBoneCount = 24;\n\tattribute vec4 a_BoneIndices;\n\tattribute vec4 a_BoneWeights;\n\tuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\nvoid main_castShadow()\n{\n\t#ifdef BONE\n\t\tmat4 skinTransform=mat4(0.0);\n\t\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\t\tvec4 position = skinTransform * a_Position;\n\t\tgl_Position = u_MvpMatrix * position;\n\t#else\n\t\tgl_Position = u_MvpMatrix * a_Position;\n\t#endif\n\t \n\t//TODO没考虑UV动画呢\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tv_Texcoord0 = a_Texcoord0;\n\t#endif\n\t\tv_posViewZ = gl_Position.z;\n}\n\nvoid main_normal()\n{\n\tmat3 worldMat;\n\t#ifdef BONE\n\t\tmat4 skinTransform = mat4(0.0);\n\t\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\t\tvec4 position = skinTransform * a_Position;\n\t\tgl_Position = u_MvpMatrix * position;\n\t\tworldMat=mat3(u_WorldMat*skinTransform);\n\t\tv_PositionWorld = (u_WorldMat * position).xyz;\n\t#else\n\t\tgl_Position = u_MvpMatrix * a_Position;\n\t\tworldMat = mat3(u_WorldMat);\n\t\tv_PositionWorld = (u_WorldMat * a_Position).xyz;\n\t#endif\n\t\n\tv_Normal = worldMat * a_Normal;\n\tv_Tangent = worldMat * a_Tangent0.xyz;\n\tv_Binormal = cross(v_Normal, v_Tangent) * a_Tangent0.w;\n  \n\tv_Texcoord0 = a_Texcoord0;\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0=(vec2(v_Texcoord0.x,v_Texcoord0.y-1.0)*u_TilingOffset.xy)+u_TilingOffset.zw;\n\t#endif\n\t\tv_Texcoord0=vec2(v_Texcoord0.x,1.0 + v_Texcoord0.y);\n  \n\tv_ViewDir = u_CameraPos - v_PositionWorld;\n  \n\t#ifdef RECEIVESHADOW\n\t\tv_posViewZ = gl_Position.w;\n\t\t#ifdef SHADOWMAP_PSSM1 \n\t\t\tv_lightMVPPos = u_lightShadowVP[0] * vec4(v_PositionWorld,1.0);\n\t\t#endif\n\t#endif\n}\n\nvoid main()\n{\n\t#ifdef CASTSHADOW\n\t\tmain_castShadow();\n\t#else\n\t\tmain_normal();\n\t#endif\n}",t='#ifdef FSHIGHPRECISION\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\nvarying vec2 v_Texcoord0;\nvarying vec3 v_Normal;\nvarying vec3 v_Tangent;\nvarying vec3 v_Binormal;\nvarying vec3 v_ViewDir;\n\nuniform vec4 u_AmbientColor;\nuniform vec4 u_DiffuseColor;\n\n#ifdef DIFFUSETEXTURE\n\tuniform sampler2D u_DiffuseTexture;\n#endif\n#ifdef METALLICGLOSSTEXTURE\n\tuniform sampler2D u_MetallicGlossTexture;\n#endif\n#ifdef NORMALTEXTURE\n\tuniform sampler2D u_NormalTexture;\n\tuniform float u_normalScale;\n#endif\n#ifdef PARALLAXTEXTURE\n\tuniform sampler2D u_ParallaxTexture;\n\tuniform float u_parallaxScale;\n#endif\n#ifdef OCCLUSIONTEXTURE\n\tuniform sampler2D u_OcclusionTexture;\n\tuniform float u_occlusionStrength;\n#endif\n#ifdef EMISSION\n\t#ifdef EMISSIONTEXTURE\n\t\tuniform sampler2D u_EmissionTexture;\n\t#endif\n\tuniform vec4 u_EmissionColor;\n#endif\n\nuniform float u_AlphaTestValue;\nuniform float u_metallic;\nuniform float u_smoothness;\nuniform float u_smoothnessScale;\n\n#include "PBRStandardLighting.glsl"\n#include "ShadowHelper.glsl"\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\t\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\t\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\n\nuniform DirectionLight u_DirectionLight;\n\nvoid main_castShadow()\n{\n\tgl_FragColor=packDepth(v_posViewZ);\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tfloat alpha = texture2D(u_DiffuseTexture,v_Texcoord0).w;\n\t\tif( alpha < u_AlphaTestValue )\n\t\t{\n\t\t\tdiscard;\n\t\t}\n\t#endif\n}\n\nvoid main_normal()\n{\t\n\tvec3 viewDir = normalize(v_ViewDir);\n\t\n\tvec2 uv0 = ParallaxOffset(viewDir);\n\t\n\tvec2 mg;\n\t#ifdef DIFFUSETEXTURE\n\t\tvec4 diffuseTextureColor = texture2D(u_DiffuseTexture, uv0);\n\t\tvec4 diffuseColor = diffuseTextureColor * u_DiffuseColor;\n\t\tmg = MetallicGloss(diffuseTextureColor.a, uv0);\n\t#else\n\t\tvec4 diffuseColor = u_DiffuseColor;\n\t\tmg = MetallicGloss(1.0, uv0);\n\t#endif\n\t\n\t#ifdef ALPHATEST\n\t\tif(diffuseColor.a < u_AlphaTestValue)\n\t\t\tdiscard;\n\t#endif\n\t\n\tgl_FragColor = diffuseColor;\n\t\n\tvec3 normal = UnpackScaleNormal(uv0);\n  \n\tvec3 gi = (u_AmbientColor * Occlusion(uv0)).rgb;\n  \n\tvec4 color = PBRStandardDiectionLight(diffuseColor.rgb, mg.r, mg.g, normal, viewDir, u_DirectionLight, gi);\n\t\n\tcolor.a = diffuseColor.a;\n\t\n\t#ifdef EMISSION\n\t\tvec4 emissionColor = u_EmissionColor;\n\t\t#ifdef EMISSIONTEXTURE\n\t\t\temissionColor *=  texture2D(u_EmissionTexture, uv0);\n\t\t#endif\n\t\tcolor.rgb += emissionColor.rgb;\n\t#endif\n\t\n\t#ifdef RECEIVESHADOW\n\t\tfloat shadowValue = 1.0;\n\t\t#ifdef SHADOWMAP_PSSM3\n\t\t\tshadowValue = getShadowPSSM3( u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t\t#endif\n\t\t#ifdef SHADOWMAP_PSSM2\n\t\t\tshadowValue = getShadowPSSM2( u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t\t#endif \n\t\t#ifdef SHADOWMAP_PSSM1\n\t\t\tshadowValue = getShadowPSSM1( u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.001);\n\t\t#endif\n\t\tgl_FragColor = vec4(color.rgb * shadowValue, color.a);\n\t#else\n\t\tgl_FragColor = color;\n\t#endif\n}\n\nvoid main()\n{\n\t#ifdef CASTSHADOW\t\t\n\t\tmain_castShadow();\n\t#else\n\t\tmain_normal();\n\t#endif  \n}\n\n',r=ci.add(l,e,t,i,n),Xi.SHADERDEFINE_DIFFUSETEXTURE=r.registerMaterialDefine("DIFFUSETEXTURE"),Xi.SHADERDEFINE_METALLICGLOSSTEXTURE=r.registerMaterialDefine("METALLICGLOSSTEXTURE"),Xi.SHADERDEFINE_SMOOTHNESSSOURCE_DIFFUSETEXTURE_ALPHA=r.registerMaterialDefine("SMOOTHNESSSOURCE_DIFFUSETEXTURE_ALPHA"),Xi.SHADERDEFINE_NORMALTEXTURE=r.registerMaterialDefine("NORMALTEXTURE"),Xi.SHADERDEFINE_PARALLAXTEXTURE=r.registerMaterialDefine("PARALLAXTEXTURE"),Xi.SHADERDEFINE_OCCLUSIONTEXTURE=r.registerMaterialDefine("OCCLUSIONTEXTURE"),Xi.SHADERDEFINE_EMISSION=r.registerMaterialDefine("EMISSION"),Xi.SHADERDEFINE_EMISSIONTEXTURE=r.registerMaterialDefine("EMISSIONTEXTURE"),Xi.SHADERDEFINE_TILINGOFFSET=r.registerMaterialDefine("TILINGOFFSET"),i={a_Position:0,a_Normal:3,a_Tangent0:5,a_Texcoord0:2,a_BoneWeights:7,a_BoneIndices:6},n={u_Bones:[0,0],u_MvpMatrix:[1,2],u_WorldMat:[0,2],u_CameraPos:[0,3],u_AlphaTestValue:[0,1],u_DiffuseColor:[7,1],u_SpecularColor:[8,1],u_EmissionColor:[9,1],u_DiffuseTexture:[1,1],u_NormalTexture:[3,1],u_ParallaxTexture:[4,1],u_SpecularTexture:[2,1],u_OcclusionTexture:[5,1],u_EmissionTexture:[6,1],u_smoothness:[10,1],u_smoothnessScale:[11,1],u_occlusionStrength:[13,1],u_normalScale:[14,1],u_parallaxScale:[15,1],u_TilingOffset:[17,1],"u_DirectionLight.Direction":[3,4],"u_DirectionLight.Color":[4,4],u_AmbientColor:[21,4],u_shadowMap1:[18,4],u_shadowMap2:[19,4],u_shadowMap3:[20,4],u_shadowPSSMDistance:[15,4],u_lightShadowVP:[16,4],u_shadowPCFoffset:[17,4]};var c=Oi.nameKey.add("PBRSpecular");e="attribute vec4 a_Position;\nattribute vec3 a_Normal;\nattribute vec4 a_Tangent0;\nattribute vec2 a_Texcoord0;\n\nuniform mat4 u_MvpMatrix;\nuniform mat4 u_WorldMat;\nuniform vec3 u_CameraPos;\n\nvarying vec2 v_Texcoord0;\nvarying vec3 v_Normal;\nvarying vec3 v_Tangent;\nvarying vec3 v_Binormal;\nvarying vec3 v_ViewDir;\nvarying vec3 v_PositionWorld;\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n  #ifdef SHADOWMAP_PSSM1 \n\t  varying vec4 v_lightMVPPos;\n\t  uniform mat4 u_lightShadowVP[4];\n  #endif\n#endif\n\n#ifdef BONE\n\tconst int c_MaxBoneCount = 24;\n\tattribute vec4 a_BoneIndices;\n\tattribute vec4 a_BoneWeights;\n\tuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\nvoid main_castShadow()\n{\n\t#ifdef BONE\n\t\tmat4 skinTransform=mat4(0.0);\n\t\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\t\tvec4 position = skinTransform * a_Position;\n\t\tgl_Position = u_MvpMatrix * position;\n\t#else\n\t\tgl_Position = u_MvpMatrix * a_Position;\n\t#endif\n\t \n\t//TODO没考虑UV动画呢\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tv_Texcoord0 = a_Texcoord0;\n\t#endif\n\t\tv_posViewZ = gl_Position.z;\n}\n\nvoid main_normal()\n{\n\tmat3 worldMat;\n\t#ifdef BONE\n\t\tmat4 skinTransform = mat4(0.0);\n\t\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\t\tvec4 position = skinTransform * a_Position;\n\t\tgl_Position = u_MvpMatrix * position;\n\t\tworldMat=mat3(u_WorldMat*skinTransform);\n\t\tv_PositionWorld = (u_WorldMat * position).xyz;\n\t#else\n\t\tgl_Position = u_MvpMatrix * a_Position;\n\t\tworldMat = mat3(u_WorldMat);\n\t\tv_PositionWorld = (u_WorldMat * a_Position).xyz;\n\t#endif\n\t\n\tv_Normal = worldMat * a_Normal;\n\tv_Tangent = worldMat * a_Tangent0.xyz;\n\tv_Binormal = cross(v_Normal, v_Tangent) * a_Tangent0.w;\n  \n\tv_Texcoord0 = a_Texcoord0;\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0=(vec2(v_Texcoord0.x,v_Texcoord0.y-1.0)*u_TilingOffset.xy)+u_TilingOffset.zw;\n\t#endif\n\t\tv_Texcoord0=vec2(v_Texcoord0.x,1.0 + v_Texcoord0.y);\n  \n\tv_ViewDir = u_CameraPos - v_PositionWorld;\n  \n\t#ifdef RECEIVESHADOW\n\t\tv_posViewZ = gl_Position.w;\n\t\t#ifdef SHADOWMAP_PSSM1 \n\t\t\tv_lightMVPPos = u_lightShadowVP[0] * vec4(v_PositionWorld,1.0);\n\t\t#endif\n\t#endif\n}\n\nvoid main()\n{\n\t#ifdef CASTSHADOW\n\t\tmain_castShadow();\n\t#else\n\t\tmain_normal();\n\t#endif\n}",t='#ifdef FSHIGHPRECISION\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\nvarying vec2 v_Texcoord0;\nvarying vec3 v_Normal;\nvarying vec3 v_Tangent;\nvarying vec3 v_Binormal;\nvarying vec3 v_ViewDir;\n\nuniform vec4 u_AmbientColor;\nuniform vec4 u_DiffuseColor;\nuniform vec4 u_SpecularColor;\n\n#ifdef DIFFUSETEXTURE\n\tuniform sampler2D u_DiffuseTexture;\n#endif\n#ifdef SPECULARTEXTURE\n\tuniform sampler2D u_SpecularTexture;\n#endif\n#ifdef NORMALTEXTURE\n\tuniform sampler2D u_NormalTexture;\n\tuniform float u_normalScale;\n#endif\n#ifdef PARALLAXTEXTURE\n\tuniform sampler2D u_ParallaxTexture;\n\tuniform float u_parallaxScale;\n#endif\n#ifdef OCCLUSIONTEXTURE\n\tuniform sampler2D u_OcclusionTexture;\n\tuniform float u_occlusionStrength;\n#endif\n#ifdef EMISSION\n\t#ifdef EMISSIONTEXTURE\n\t\tuniform sampler2D u_EmissionTexture;\n\t#endif\n\tuniform vec4 u_EmissionColor;\n#endif\n\nuniform float u_AlphaTestValue;\nuniform float u_metallic;\nuniform float u_smoothness;\nuniform float u_smoothnessScale;\n\n#include "PBRSpecularLighting.glsl"\n#include "ShadowHelper.glsl"\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\t\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\t\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\n\nuniform DirectionLight u_DirectionLight;\n\nvoid main_castShadow()\n{\n\tgl_FragColor=packDepth(v_posViewZ);\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tfloat alpha = texture2D(u_DiffuseTexture,v_Texcoord0).w;\n\t\tif( alpha < u_AlphaTestValue )\n\t\t{\n\t\t\tdiscard;\n\t\t}\n\t#endif\n}\n\nvoid main_normal()\n{\t\n\tvec3 viewDir = normalize(v_ViewDir);\n\t\n\tvec2 uv0 = ParallaxOffset(viewDir);\n\t\n\tvec4 sg;\n\t#ifdef DIFFUSETEXTURE\n\t\tvec4 diffuseTextureColor = texture2D(u_DiffuseTexture, uv0);\n\t\tvec4 diffuseColor = diffuseTextureColor * u_DiffuseColor;\n\t\tsg = SpecularGloss(diffuseTextureColor.a, uv0);\n\t#else\n\t\tvec4 diffuseColor = u_DiffuseColor;\n\t\tsg = SpecularGloss(1.0, uv0);\n\t#endif\n\t\n\t#ifdef ALPHATEST\n\t\tif(diffuseColor.a < u_AlphaTestValue)\n\t\t\tdiscard;\n\t#endif\n  \n\tvec3 normal = UnpackScaleNormal(uv0);\n\t\n\tvec3 gi = (u_AmbientColor * Occlusion(uv0)).rgb;\n\t\n\t//float a = (sg.r+sg.g+sg.b) / 3.0;\n  \n\tvec4 color = PBRSpecularDiectionLight(diffuseColor.rgb, sg.rgb, sg.a, normal,viewDir, u_DirectionLight, gi);\n\t\n\tcolor.a = diffuseColor.a;\n\t\n\t#ifdef EMISSION\n\t\tvec4 emissionColor = u_EmissionColor;\n\t\t#ifdef EMISSIONTEXTURE\n\t\t\temissionColor *=  texture2D(u_EmissionTexture, uv0);\n\t\t#endif\n\t\tcolor.rgb += emissionColor.rgb;\n\t#endif\n\t\n\t#ifdef RECEIVESHADOW\n\t\tfloat shadowValue = 1.0;\n\t\t#ifdef SHADOWMAP_PSSM3\n\t\t\tshadowValue = getShadowPSSM3( u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t\t#endif\n\t\t#ifdef SHADOWMAP_PSSM2\n\t\t\tshadowValue = getShadowPSSM2( u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t\t#endif \n\t\t#ifdef SHADOWMAP_PSSM1\n\t\t\tshadowValue = getShadowPSSM1( u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.001);\n\t\t#endif\n\t\tgl_FragColor = vec4(color.rgb * shadowValue, color.a);\n\t#else\n\t\tgl_FragColor = color;\n\t#endif\n}\n\nvoid main()\n{\n\t#ifdef CASTSHADOW\t\t\n\t\tmain_castShadow();\n\t#else\n\t\tmain_normal();\n\t#endif  \n}\n\n',r=ci.add(c,e,t,i,n),zi.SHADERDEFINE_DIFFUSETEXTURE=r.registerMaterialDefine("DIFFUSETEXTURE"),zi.SHADERDEFINE_SPECULARTEXTURE=r.registerMaterialDefine("SPECULARTEXTURE"),zi.SHADERDEFINE_SMOOTHNESSSOURCE_DIFFUSETEXTURE_ALPHA=r.registerMaterialDefine("SMOOTHNESSSOURCE_DIFFUSETEXTURE_ALPHA"),zi.SHADERDEFINE_NORMALTEXTURE=r.registerMaterialDefine("NORMALTEXTURE"),zi.SHADERDEFINE_PARALLAXTEXTURE=r.registerMaterialDefine("PARALLAXTEXTURE"),zi.SHADERDEFINE_OCCLUSIONTEXTURE=r.registerMaterialDefine("OCCLUSIONTEXTURE"),zi.SHADERDEFINE_EMISSION=r.registerMaterialDefine("EMISSION"),zi.SHADERDEFINE_EMISSIONTEXTURE=r.registerMaterialDefine("EMISSIONTEXTURE"),zi.SHADERDEFINE_TILINGOFFSET=r.registerMaterialDefine("TILINGOFFSET"),i={a_position:0,a_normal:3,uv:2},n={irrad_mat_red:[10,3],irrad_mat_green:[11,3],irrad_mat_blue:[12,3],u_hdrexposure:[13,3],texBaseColor:[1,1],texNormal:[2,1],texSky:[11,1],texUnderWater:[3,1],texPrefilterdEnv:[8,3],texPrefilterDiff:[7,3],texWaterDisp:[4,1],texWaveDetail:[9,1],texDeepColor:[10,1],texWaterInfo:[16,1],texFoam:[17,1],GEOWAVE_UV_SCALE:[18,1],modelMatrix:[0,2],mvp:[1,2],cameraPosition:[0,3],u_curTm:[8,1],u_scrsize:[15,1],u_WaveInfoD:[13,1],u_WaveInfo:[12,1],u_WaveMainDir:[14,1],u_DeepScale:[20,1],u_SeaColor:[19,1],u_View:[1,3],u_Project:[2,3],u_FogStart:[1,4],u_FogRange:[2,4],u_FogColor:[0,4],"u_DirectionLight.Direction":[3,4],"u_DirectionLight.Diffuse":[4,4],"u_PointLight.Position":[5,4],"u_PointLight.Range":[6,4],"u_PointLight.Attenuation":[7,4],"u_PointLight.Diffuse":[8,4],"u_SpotLight.Position":[9,4],"u_SpotLight.Direction":[10,4],"u_SpotLight.Range":[12,4],"u_SpotLight.Spot":[11,4],"u_SpotLight.Attenuation":[13,4],"u_SpotLight.Diffuse":[14,4]};var p=Oi.nameKey.add("Water");e='\nuniform mat4 modelMatrix;\n//uniform mat4 modelViewMatrix;\n//uniform mat4 projectionMatrix;\nuniform mat4 u_View;\nuniform mat4 u_Project;\nuniform mat4 mvp;\n//uniform mat4 viewMatrix;\nuniform vec3 cameraPosition;\nuniform float u_curTm;\n\nattribute vec3 a_position;\nattribute vec3 a_normal;\nattribute vec2 uv;\n//uniform sampler2D texWaterDisp;\n#ifdef USE_VERTEX_DEEPINFO\n#else\nuniform sampler2D texWaterInfo;\nvarying vec4 vWaterInfo;\nuniform float u_DeepScale;//texWaterInfo.r*vDeepScale\n#endif\nuniform float u_WaveMainDir;\t//主波方向\nuniform float GEOWAVE_UV_SCALE ;//= 100.0;\n\n\nvarying vec2 vUv;\nvarying vec3 vWorldNorm;\nvarying vec3 vWorldTan;\nvarying vec3 vWorldBin;\nvarying vec4 vViewPos;\nvarying vec4 vWorldPos;\nvarying vec3 vLightDir;\nvarying vec3 vViewDir;\nvarying vec3 vDisp;\nvarying float fDeep;\nvarying mat2 matUVTrans;\nvarying float fFoam;\n\nconst float PI = 3.14159265358979323846264;\n\n#include "WaveFunction.glsl"\n\nvec2 getPosFromUV(vec2 uv){\n\treturn uv*50.;\n}\n\nvoid main() {\n\tvec3 pos = a_position;\n    vUv = uv;\n\t\n\t//vDisp = texture2D(texWaterDisp,uv).rgb;\n\t//vec3 disp = vDisp;\n\t\n\t//TODO 这里有个潜规则。\n\tfloat tt = pos.y; pos.y=pos.z; pos.z=-tt;\n\t\n\t#ifdef USE_VERTEX_DEEPINFO\n\tfDeep = -pos.y;\n\tpos.y=0.0;\n\t#else\n\tvWaterInfo = texture2D(texWaterInfo,uv);\n\tfDeep = vWaterInfo.r*u_DeepScale;\n\t#endif\n\t\n\t\n\t//计算波形\n\tmat4 modelMat = modelMatrix;\n\tvec3 opos, T,B,N;\n\tfloat foams=0.;\n\tvec2 uvpos = uv*GEOWAVE_UV_SCALE+vec2(modelMat[3][0],0.);//TODO 如果有旋转缩放怎么办\n\tcalcGerstnerWave(u_curTm, pos,fDeep, uvpos,opos,B,T,N,foams);\n\tfFoam = foams;\n\tgl_Position = mvp*vec4(opos,1.);\n\tvWorldPos = modelMat*vec4(opos,1.);\n\n\tvWorldNorm = normalize((modelMatrix*vec4(N,0.0)).xyz);\n\tvWorldTan = normalize((modelMatrix*vec4(T,0.0)).xyz);\n\tvWorldBin = normalize((modelMatrix*vec4(B,0.0)).xyz);\n    vViewDir = vWorldPos.xyz-cameraPosition; //这个不能取normalize，否则会引入非线性\n\t\n\tfloat s = sin(u_WaveMainDir);\n\tfloat c = cos(u_WaveMainDir);\n\tmatUVTrans = mat2(c,-s,s,c);\n}\n',t="//#version 300 es\n\nprecision highp float;\nprecision lowp int;\n\nconst float PI = 3.14159265358979323846264;\nconst float _2PI = 6.2831853071796;\nvarying vec2 vUv;\nvarying vec3 vWorldNorm;\nvarying vec3 vWorldTan;\nvarying vec3 vWorldBin;\nvarying vec3 vViewDir;//入射。pos-cam\nvarying vec4 vViewPos;\nvarying vec4 vWorldPos;\nvarying float fDeep;\nvarying mat2 matUVTrans;\n#ifdef USE_VERTEX_DEEPINFO\n#else\nvarying vec4 vWaterInfo;\n#endif\nmat3 matTBNOff;//\n\n//\nuniform sampler2D texBaseColor;\nuniform sampler2D texNormal;\n#ifdef CUBE_ENV\nuniform samplerCube texSky;\n#else\nuniform sampler2D texSky;\n#endif\nuniform sampler2D texUnderWater;\nuniform sampler2D texWaveDetail;\n//uniform sampler2D texDeepColor;\nuniform sampler2D texFoam;\nvarying float fFoam;\nuniform float u_curTm;\nuniform vec2 u_scrsize;\nuniform vec3 u_SeaColor;//\n\nconst int NumTexWaves=4;\nconst float Amp_over_L = 0.01;\n//const vec3 SEA_COLOR1 = vec3(0.0292,0.672,0.7467);//大洋\n//const vec3 SEA_COLOR2 = vec3(0,0.927,0.43);//近海\n\nconst float _maxu8 = 255.0;\nconst float _maxu16 = 65535.0;\nconst float _shift8 = 256.0;    //平移的话是*256而不是255\nvec2 _RGBAToU16(const in vec4 rgba){\n    return vec2((rgba.r*_maxu8+rgba.g*_maxu8*_shift8)/_maxu16, (rgba.b*_maxu8+rgba.a*_maxu8*_shift8)/_maxu16);\n}\nvec3 _RGBEToRGB( const in vec4 rgba ){\n    float f = pow(2.0, rgba.w * 255.0 - (128.0 + 8.0));\n    return rgba.rgb * (255.0 * f);\n}\n\nfloat saturate(float v){\n    return min(max(v,0.),1.);\n}\n\n/*\n\t各种 ToneMap\n*/\n//Reinhard\nvec3 ReinhardToneMapping(vec3 color, float adapted_lum) {\n    const float MIDDLE_GREY = 1.;\n    color *= MIDDLE_GREY / adapted_lum;\n    return color / (1.0 + color);\n}\n\n//CE2\nvec3 CEToneMapping(vec3 color, float adapted_lum){\n    return 1. - exp(-adapted_lum * color);\n}\n\n//UC2\nvec3 F1(vec3 x){\n\tconst float A = 0.22;\n\tconst float B = 0.30;\n\tconst float C = 0.10;\n\tconst float D = 0.20;\n\tconst float E = 0.01;\n\tconst float F = 0.30;\n \n\treturn ((x * (A * x + C * B) + D * E) / (x * (A * x + B) + D * F)) - E / F;\n}\n\nvec3 Uncharted2ToneMapping(vec3 color, float adapted_lum){\n\tconst vec3 WHITE = vec3(11.2);\n\treturn F1(1.6 * adapted_lum * color) / F1(WHITE);\n}\n\n//ACES\nvec3 ACESToneMapping(vec3 color, float adapted_lum){\n\tconst float A = 2.51;\n\tconst float B = 0.03;\n\tconst float C = 2.43;\n\tconst float D = 0.59;\n\tconst float E = 0.14;\n\n\tcolor *= adapted_lum;\n\treturn (color * (A * color + B)) / (color * (C * color + D) + E);\n}\n\n/*\n* 对一个全景图进行采样。假设x轴指向中心。\n*/\nvec4 texPanorama(sampler2D tex, const in vec3 dir){\n\tfloat envu = atan(dir.z,dir.x)/_2PI+0.5; \t\n\tfloat envv = acos(dir.y)/PI;//(1.0-dir.y)/2.0;\n\treturn texture2D(tex,vec2(envu,envv));\n}\n\n/*\n\t与位于0点的测试棒的相交测试交点\n\t这个是瞎写的，只是为了测试\n*/\nbool hitClydiner(vec3 pos, vec3 dir, out vec3 hitpos, out vec3 hitnormal){\n\tconst float r = 0.5;\n\tfloat a = dir.x*dir.x+dir.z*dir.z;\n\tfloat b = 2.*dir.x*pos.x+2.*dir.z*pos.z;\n\tfloat c = pos.x*pos.x+pos.z*pos.z-r*r;\n\tfloat d = b*b-4.*a*c;\n\tif(d>=0.0){\n\t\tfloat t = (-b+sqrt(d))/2./a;\n\t\tt =min(t, (-b-sqrt(d))/2./a);\n\t\thitpos = pos+dir*t;\n\t\treturn true;\n\t}\n\t/*\n\tvec3 v1 = normalize(cross(dir,vec3(0.,1.,0.)));//公垂线\n\tfloat dist = dot(pos,v1);//最短距离\n\tif(abs(dist)<r){\n\t\treturn true;\n\t}\n\t*/\n\treturn false;\n}\n\n///* 根据散射公式来计算某个方向的颜色 *///\n//\nfloat phase_function(float costheta, float g, float g2){\n\treturn 1.5*( (1.0-g2) / (2.0+g2) ) * (1.0+costheta*costheta) / pow(1.0+g2-2.0*g*costheta, 1.5);\t\n}\n\nconst float _density = .2;\nconst vec3 _vLightDir=vec3(0.,-1.,0.);//必须是规格化的\nconst int _SAMPLENUM = 20;\nconst float _K1 = 1.0;\nconst float _g = -0.93;\n//\nvec3 calcScatter(vec3 start, vec3 dir, vec3 end){\n\tfloat len = length(end-start);\n\tfloat costheta = dot(dir,_vLightDir);\n\tfloat g2 = _g*_g;\n\tfloat K = _K1*len*_density*phase_function(costheta,_g,g2);\n\t//用分段的方式来积分\n\tfloat dlen = len/float(_SAMPLENUM);//距离平分\n\tfloat ddeep = (start.y-end.y)/float(_SAMPLENUM);//深度平分\n\tfloat sum=0.;\n\tfor( int i=0; i<_SAMPLENUM; i++){\n\t\tfloat fi = float(i);\n\t\tfloat v1 = exp(-_density*(dlen+ddeep)*fi);//TODO 应该可以用分析法计算出来\n\t\tsum += v1;\n\t}\n\treturn vec3(K*sum);\n}\n///* 根据散射公式来计算某个方向的亮度  END *///\n\nconst float cDeep = -2.;\t//假设水的深度\nvec3 getShuiDiColor(vec3 pos, vec3 dir, vec3 normal){\n\t//一个无限大的水底，黑白格纹理。纹理长度为1米\n\tfloat t = ( cDeep-pos.y )/dir.y;\n\tif(t<0.) return vec3(1.,0.,0.);//TEST\n\tbool bhit = false;\n\tvec3 hitpos;\n\tvec3 hitcolor;\n\tvec3 hn;\n\tif(hitClydiner(pos,dir,hitpos,hn) && hitpos.y>cDeep && hitpos.y<pos.y){\n\t\tbhit=true;\n\t\thitcolor = vec3(.8,.8,.8);\n\n\t}else\n\t{\n\t\thitpos = pos+dir*t;\n\t\tvec3 hp = floor(hitpos);\n\t\tfloat a = mod((hp.x+hp.z),2.);\n\t\thitcolor = (a<.9)?vec3(0.,0.,0.):vec3(1.,1.,1.);\n\t\t//hitcolor = texture2D(texUnderWater,hitpos.xz/10.).rgb;\n\t}\n\t\n\tfloat l = length(hitpos-pos);\n\t//return texture2D(texDeepColor,vec2(min(max(l/400.,0.),1.),0.5)).rgb;\n\t//return SEA_COLOR1*calcScatter(pos,dir,hitpos);\n\tfloat left = pow(0.8,l);//假设透过率为80%，则到达水底的时候的光强。\n\treturn mix(hitcolor,u_SeaColor,1.-left);\n}\n\n/*\n\tview已经normalize了\n*/\nvec3 getRefractColor(vec3 view,vec3 normal){\n\tvec3 T = refract(-view, normal, 0.7);\n\treturn getShuiDiColor(vWorldPos.xyz,T,normal); \n}\n\nvec4 calcWaterC(vec3 view, vec3 normal, float von, vec3 R, float rough){\n\t/*\n\t只有浪顶的法线向下，也就是波形形成了交叠的时候，才会这样，所以要通过参数控制避免出现这种情况，而不是在这里保护。\n\tif(dot(R,vec3(0.,1.,0.))<0.){\n\t\tR = -R;\n\t}\n\t*/\n\t//vec3 refr = getRefractColor(-view,normal);\n#ifdef USE_REFR_TEX\t\n\tvec3 refr = texture2D(texUnderWater, gl_FragCoord.xy/u_scrsize+normal.xz/8.).rgb;\n#else\n\tvec3 refr = u_SeaColor;\n#endif\n\tfloat F0=0.02;\n\t//菲涅尔，越大反射越强\n\tfloat f =  F0+(1.0-F0)*exp2((-5.55473*von-6.98316)*von);\n\t//float f = F0+(1.0-F0)*pow(1.-von,5.);\n\t//能看到水底的程度。反射剩余的*水中的衰减\n\t//float a = (1.-f)*(1.-deepk);\n#ifdef CUBE_ENV\n\tvec4 reflc = textureCube(texSky,R);\n#else\n\tvec4 reflc = texPanorama(texSky, R);\n#endif\n#ifdef HDR_ENV\n\tvec3 refl = _RGBEToRGB(reflc)*f;\n#else\n\tvec3 refl = reflc.rgb*f;\n#endif\n\t//return vec4(refl*(1.-rough),1.);\n\t\n\t//vec3 refl = reflc.rgb*f;\n\tvec3 final = mix(refr, u_SeaColor, min(fDeep/10.,1.))+refl*(max(0.,1.-rough));\n#ifdef HDR_ENV\n\tfinal = ACESToneMapping(final,1.);//TODO 这个要uniform传入\n#endif\n\treturn vec4(final,f);\n}\n\nvoid main() {\n    vec3 normal =  normalize(vWorldNorm);\n\t//如果uv=1为100米，希望每个细节纹理表示20米的小波形，则uv缩放是 100/20。细节纹理内部也要用这个值，即pos=uv*20\n\tvec2 ruv = matUVTrans*vUv;\n\tvec3 detailNorm = texture2D(texWaveDetail,fract(ruv*5.)).rgb*2.-vec3(1.);//TODO uv怎么算\n\tfloat texNormScale = 2.*PI*float(NumTexWaves)*Amp_over_L*2.5;\n\tdetailNorm *= vec3(texNormScale,1.,texNormScale);\n\t//旋转\n\t//细节纹理来自rendertarget，因此需要颠倒z\n\t\n\tmatTBNOff = mat3(matUVTrans[0][0],0.,matUVTrans[1][0],\n\t0.,1.,0.,\n\tmatUVTrans[0][1],0.,matUVTrans[1][1]\n\t);\n\t\n\t/*\n\tmatTBNOff = mat3(0.,0.,1.,\n\t0.,1.,0.,\n\t-1.,0.,0.\n\t);\n\t*/\n\n    mat3 tsn = mat3( vWorldBin, normal, vWorldTan);\t\n    //normal = normalize(tsn * matTBNOff * detailNorm);\n\tnormal = normalize(tsn * detailNorm); //这个应该更正确。因为本身方向就是根据uv算的，如果是静态图片才需要转换。\n\t//vec4 normtex = texture2D( texNormal, vUv );\n    vec3 view   = -normalize(vViewDir);//view 是指向camera的\n    float NoV = saturate(dot( view, normal ));\n    //vec3 R = 2. * NoV * normal - view;\n\t\n#ifdef USE_FOAM\t\n\tvec4 foamc = (texture2D(texFoam,vUv*50.)+texture2D(texFoam,vUv*20.))/2.;\n\tfloat nearcoast = 1.-min(fDeep/10.,1.);// 1.-vWaterInfo.r;\n\tfloat foams = (nearcoast/4.+fFoam)*2.*nearcoast;\n#else\n\tfloat foams =0.;\n#endif\n\t\n\tvec3 R = reflect(-view,normal);\n\tvec4 wc = calcWaterC(view, normal,NoV,R, foams);\n\n\tgl_FragColor.rgb = wc.rgb;//normalize(detailNorm).rrr;//((normal)+vec3(0.0))/1.;//normalize(normal).rgb;//texture2D(texWaveDetail,vUv).rgb;// fracColor * texture2D(texUnderWater, vUv*20.0).rgb;// vec3(1.0);//pbrl.rgb;\n    gl_FragColor.a = 1.0;//wc.a;\n#ifdef USE_FOAM\n\tgl_FragColor.rgb = mix(gl_FragColor.rgb,vec3(1.),foamc.a*foams);\n\tgl_FragColor.a = foamc.r;\n#endif\n\t//if(mod(vUv.x*100.,1.0)<0.02 || mod(vUv.y*100.,1.0)<0.02) gl_FragColor.rgb=vec3(0.5,.5,.5);\n\t//gl_FragColor.rgb = detailNorm;\n}\n",r=ci.add(p,e,t,i,n),ji.SHADERDEFINE_CUBE_ENV=r.registerMaterialDefine("CUBE_ENV"),ji.SHADERDEFINE_HDR_ENV=r.registerMaterialDefine("HDR_ENV"),ji.SHADERDEFINE_SHOW_NORMAL=r.registerMaterialDefine("SHOW_NORMAL"),ji.SHADERDEFINE_USEVERTEXHEIGHT=r.registerMaterialDefine("USE_VERTEX_DEEPINFO"),ji.SHADERDEFINE_USE_FOAM=r.registerMaterialDefine("USE_FOAM"),ji.SHADERDEFINE_USE_REFRACT_TEX=r.registerMaterialDefine("USE_REFR_TEX"),i={a_CornerTextureCoordinate:17,a_MeshPosition:0,a_MeshColor:1,a_MeshTextureCoordinate:2,a_ShapePositionStartLifeTime:30,a_DirectionTime:32,a_StartColor:19,a_EndColor:23,a_StartSize:20,a_StartRotation0:22,a_StartSpeed:31,a_Random0:34,a_Random1:35,a_SimulationWorldPostion:36,a_SimulationWorldRotation:37},n={u_Tintcolor:[2,1],u_TilingOffset:[3,1],u_texture:[1,1],u_WorldPosition:[0,2],u_WorldRotation:[1,2],u_PositionScale:[4,2],u_SizeScale:[5,2],u_ScalingMode:[6,2],u_Gravity:[7,2],u_ThreeDStartRotation:[8,2],u_StretchedBillboardLengthScale:[9,2],u_StretchedBillboardSpeedScale:[10,2],u_SimulationSpace:[11,2],u_CurrentTime:[12,2],u_ColorOverLifeGradientAlphas:[22,2],u_ColorOverLifeGradientColors:[23,2],u_MaxColorOverLifeGradientAlphas:[24,2],u_MaxColorOverLifeGradientColors:[25,2],u_VOLVelocityConst:[13,2],u_VOLVelocityGradientX:[14,2],u_VOLVelocityGradientY:[15,2],u_VOLVelocityGradientZ:[16,2],u_VOLVelocityConstMax:[17,2],u_VOLVelocityGradientMaxX:[18,2],u_VOLVelocityGradientMaxY:[19,2],u_VOLVelocityGradientMaxZ:[20,2],u_VOLSpaceType:[21,2],u_SOLSizeGradient:[26,2],u_SOLSizeGradientX:[27,2],u_SOLSizeGradientY:[28,2],u_SOLSizeGradientZ:[29,2],u_SOLSizeGradientMax:[30,2],u_SOLSizeGradientMaxX:[31,2],u_SOLSizeGradientMaxY:[32,2],u_SOLSizeGradientMaxZ:[33,2],u_ROLAngularVelocityConst:[34,2],u_ROLAngularVelocityConstSeprarate:[35,2],u_ROLAngularVelocityGradient:[36,2],u_ROLAngularVelocityGradientX:[37,2],u_ROLAngularVelocityGradientY:[38,2],u_ROLAngularVelocityGradientZ:[39,2],u_ROLAngularVelocityGradientW:[40,2],u_ROLAngularVelocityConstMax:[41,2],u_ROLAngularVelocityConstMaxSeprarate:[42,2],u_ROLAngularVelocityGradientMax:[43,2],u_ROLAngularVelocityGradientMaxX:[44,2],u_ROLAngularVelocityGradientMaxY:[45,2],u_ROLAngularVelocityGradientMaxZ:[46,2],u_ROLAngularVelocityGradientMaxW:[47,2],u_TSACycles:[48,2],u_TSASubUVLength:[49,2],u_TSAGradientUVs:[50,2],u_TSAMaxGradientUVs:[51,2],u_CameraPosition:[0,3],u_CameraDirection:[5,3],u_CameraUp:[6,3],u_View:[1,3],u_Projection:[2,3],u_FogStart:[1,4],u_FogRange:[2,4],u_FogColor:[0,4]};var u=Oi.nameKey.add("PARTICLESHURIKEN");e="#ifdef HIGHPRECISION\n  precision highp float;\n#else\n  precision mediump float;\n#endif\n\n#if defined(SPHERHBILLBOARD)||defined(STRETCHEDBILLBOARD)||defined(HORIZONTALBILLBOARD)||defined(VERTICALBILLBOARD)\n\tattribute vec4 a_CornerTextureCoordinate;\n#endif\n#ifdef RENDERMODE_MESH\n\tattribute vec3 a_MeshPosition;\n\tattribute vec4 a_MeshColor;\n\tattribute vec2 a_MeshTextureCoordinate;\n\tvarying vec4 v_MeshColor;\n#endif\n\nattribute vec4 a_ShapePositionStartLifeTime;\nattribute vec4 a_DirectionTime;\nattribute vec4 a_StartColor;\nattribute vec3 a_StartSize;\nattribute vec3 a_StartRotation0;\nattribute float a_StartSpeed;\n#if defined(COLOROVERLIFETIME)||defined(RANDOMCOLOROVERLIFETIME)||defined(SIZEOVERLIFETIMERANDOMCURVES)||defined(SIZEOVERLIFETIMERANDOMCURVESSEPERATE)||defined(ROTATIONOVERLIFETIMERANDOMCONSTANTS)||defined(ROTATIONOVERLIFETIMERANDOMCURVES)\n  attribute vec4 a_Random0;\n#endif\n#if defined(TEXTURESHEETANIMATIONRANDOMCURVE)||defined(VELOCITYOVERLIFETIMERANDOMCONSTANT)||defined(VELOCITYOVERLIFETIMERANDOMCURVE)\n  attribute vec4 a_Random1;\n#endif\nattribute vec3 a_SimulationWorldPostion;\nattribute vec4 a_SimulationWorldRotation;\n\nvarying float v_Discard;\nvarying vec4 v_Color;\n#ifdef DIFFUSEMAP\n\tvarying vec2 v_TextureCoordinate;\n#endif\n\nuniform float u_CurrentTime;\nuniform vec3 u_Gravity;\n\nuniform vec3 u_WorldPosition;\nuniform vec4 u_WorldRotation;\nuniform bool u_ThreeDStartRotation;\nuniform int u_ScalingMode;\nuniform vec3 u_PositionScale;\nuniform vec3 u_SizeScale;\nuniform mat4 u_View;\nuniform mat4 u_Projection;\n\n#ifdef STRETCHEDBILLBOARD\n\tuniform vec3 u_CameraPosition;\n#endif\nuniform vec3 u_CameraDirection;//TODO:只有几种广告牌模式需要用\nuniform vec3 u_CameraUp;\n\nuniform  float u_StretchedBillboardLengthScale;\nuniform  float u_StretchedBillboardSpeedScale;\nuniform int u_SimulationSpace;\n\n#if defined(VELOCITYOVERLIFETIMECONSTANT)||defined(VELOCITYOVERLIFETIMECURVE)||defined(VELOCITYOVERLIFETIMERANDOMCONSTANT)||defined(VELOCITYOVERLIFETIMERANDOMCURVE)\n  uniform  int  u_VOLSpaceType;\n#endif\n#if defined(VELOCITYOVERLIFETIMECONSTANT)||defined(VELOCITYOVERLIFETIMERANDOMCONSTANT)\n  uniform  vec3 u_VOLVelocityConst;\n#endif\n#if defined(VELOCITYOVERLIFETIMECURVE)||defined(VELOCITYOVERLIFETIMERANDOMCURVE)\n  uniform  vec2 u_VOLVelocityGradientX[4];//x为key,y为速度\n  uniform  vec2 u_VOLVelocityGradientY[4];//x为key,y为速度\n  uniform  vec2 u_VOLVelocityGradientZ[4];//x为key,y为速度\n#endif\n#ifdef VELOCITYOVERLIFETIMERANDOMCONSTANT\n  uniform  vec3 u_VOLVelocityConstMax;\n#endif\n#ifdef VELOCITYOVERLIFETIMERANDOMCURVE\n  uniform  vec2 u_VOLVelocityGradientMaxX[4];//x为key,y为速度\n  uniform  vec2 u_VOLVelocityGradientMaxY[4];//x为key,y为速度\n  uniform  vec2 u_VOLVelocityGradientMaxZ[4];//x为key,y为速度\n#endif\n\n#ifdef COLOROVERLIFETIME\n  uniform  vec4 u_ColorOverLifeGradientColors[4];//x为key,yzw为Color\n  uniform  vec2 u_ColorOverLifeGradientAlphas[4];//x为key,y为Alpha\n#endif\n#ifdef RANDOMCOLOROVERLIFETIME\n  uniform  vec4 u_ColorOverLifeGradientColors[4];//x为key,yzw为Color\n  uniform  vec2 u_ColorOverLifeGradientAlphas[4];//x为key,y为Alpha\n  uniform  vec4 u_MaxColorOverLifeGradientColors[4];//x为key,yzw为Color\n  uniform  vec2 u_MaxColorOverLifeGradientAlphas[4];//x为key,y为Alpha\n#endif\n\n\n#if defined(SIZEOVERLIFETIMECURVE)||defined(SIZEOVERLIFETIMERANDOMCURVES)\n  uniform  vec2 u_SOLSizeGradient[4];//x为key,y为尺寸\n#endif\n#ifdef SIZEOVERLIFETIMERANDOMCURVES\n  uniform  vec2 u_SOLSizeGradientMax[4];//x为key,y为尺寸\n#endif\n#if defined(SIZEOVERLIFETIMECURVESEPERATE)||defined(SIZEOVERLIFETIMERANDOMCURVESSEPERATE)\n  uniform  vec2 u_SOLSizeGradientX[4];//x为key,y为尺寸\n  uniform  vec2 u_SOLSizeGradientY[4];//x为key,y为尺寸\n  uniform  vec2 u_SOLSizeGradientZ[4];//x为key,y为尺寸\n#endif\n#ifdef SIZEOVERLIFETIMERANDOMCURVESSEPERATE\n  uniform  vec2 u_SOLSizeGradientMaxX[4];//x为key,y为尺寸\n  uniform  vec2 u_SOLSizeGradientMaxY[4];//x为key,y为尺寸\n  uniform  vec2 u_SOLSizeGradientMaxZ[4];//x为key,y为尺寸\n#endif\n\n\n#ifdef ROTATIONOVERLIFETIME\n  #if defined(ROTATIONOVERLIFETIMECONSTANT)||defined(ROTATIONOVERLIFETIMERANDOMCONSTANTS)\n    uniform  float u_ROLAngularVelocityConst;\n  #endif\n  #ifdef ROTATIONOVERLIFETIMERANDOMCONSTANTS\n    uniform  float u_ROLAngularVelocityConstMax;\n  #endif\n  #if defined(ROTATIONOVERLIFETIMECURVE)||defined(ROTATIONOVERLIFETIMERANDOMCURVES)\n    uniform  vec2 u_ROLAngularVelocityGradient[4];//x为key,y为旋转\n  #endif\n  #ifdef ROTATIONOVERLIFETIMERANDOMCURVES\n    uniform  vec2 u_ROLAngularVelocityGradientMax[4];//x为key,y为旋转\n  #endif\n#endif\n#ifdef ROTATIONOVERLIFETIMESEPERATE\n  #if defined(ROTATIONOVERLIFETIMECONSTANT)||defined(ROTATIONOVERLIFETIMERANDOMCONSTANTS)\n    uniform  vec3 u_ROLAngularVelocityConstSeprarate;\n  #endif\n  #ifdef ROTATIONOVERLIFETIMERANDOMCONSTANTS\n    uniform  vec3 u_ROLAngularVelocityConstMaxSeprarate;\n  #endif\n  #if defined(ROTATIONOVERLIFETIMECURVE)||defined(ROTATIONOVERLIFETIMERANDOMCURVES)\n    uniform  vec2 u_ROLAngularVelocityGradientX[4];\n    uniform  vec2 u_ROLAngularVelocityGradientY[4];\n    uniform  vec2 u_ROLAngularVelocityGradientZ[4];\n\tuniform  vec2 u_ROLAngularVelocityGradientW[4];\n  #endif\n  #ifdef ROTATIONOVERLIFETIMERANDOMCURVES\n    uniform  vec2 u_ROLAngularVelocityGradientMaxX[4];\n    uniform  vec2 u_ROLAngularVelocityGradientMaxY[4];\n    uniform  vec2 u_ROLAngularVelocityGradientMaxZ[4];\n\tuniform  vec2 u_ROLAngularVelocityGradientMaxW[4];\n  #endif\n#endif\n\n#if defined(TEXTURESHEETANIMATIONCURVE)||defined(TEXTURESHEETANIMATIONRANDOMCURVE)\n  uniform  float u_TSACycles;\n  uniform  vec2 u_TSASubUVLength;\n  uniform  vec2 u_TSAGradientUVs[4];//x为key,y为frame\n#endif\n#ifdef TEXTURESHEETANIMATIONRANDOMCURVE\n  uniform  vec2 u_TSAMaxGradientUVs[4];//x为key,y为frame\n#endif\n\n#ifdef FOG\n\tvarying vec3 v_PositionWorld;\n#endif\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\nvec3 rotationByEuler(in vec3 vector,in vec3 rot)\n{\n\tfloat halfRoll = rot.z * 0.5;\n    float halfPitch = rot.x * 0.5;\n\tfloat halfYaw = rot.y * 0.5;\n\n\tfloat sinRoll = sin(halfRoll);\n\tfloat cosRoll = cos(halfRoll);\n\tfloat sinPitch = sin(halfPitch);\n\tfloat cosPitch = cos(halfPitch);\n\tfloat sinYaw = sin(halfYaw);\n\tfloat cosYaw = cos(halfYaw);\n\n\tfloat quaX = (cosYaw * sinPitch * cosRoll) + (sinYaw * cosPitch * sinRoll);\n\tfloat quaY = (sinYaw * cosPitch * cosRoll) - (cosYaw * sinPitch * sinRoll);\n\tfloat quaZ = (cosYaw * cosPitch * sinRoll) - (sinYaw * sinPitch * cosRoll);\n\tfloat quaW = (cosYaw * cosPitch * cosRoll) + (sinYaw * sinPitch * sinRoll);\n\t\n\t//vec4 q=vec4(quaX,quaY,quaZ,quaW);\n\t//vec3 temp = cross(q.xyz, vector) + q.w * vector;\n\t//return (cross(temp, -q.xyz) + dot(q.xyz,vector) * q.xyz + q.w * temp);\n\t\n\tfloat x = quaX + quaX;\n    float y = quaY + quaY;\n    float z = quaZ + quaZ;\n    float wx = quaW * x;\n    float wy = quaW * y;\n    float wz = quaW * z;\n\tfloat xx = quaX * x;\n    float xy = quaX * y;\n\tfloat xz = quaX * z;\n    float yy = quaY * y;\n    float yz = quaY * z;\n    float zz = quaZ * z;\n\n    return vec3(((vector.x * ((1.0 - yy) - zz)) + (vector.y * (xy - wz))) + (vector.z * (xz + wy)),\n                ((vector.x * (xy + wz)) + (vector.y * ((1.0 - xx) - zz))) + (vector.z * (yz - wx)),\n                ((vector.x * (xz - wy)) + (vector.y * (yz + wx))) + (vector.z * ((1.0 - xx) - yy)));\n\t\n}\n\n//假定axis已经归一化\nvec3 rotationByAxis(in vec3 vector,in vec3 axis, in float angle)\n{\n\tfloat halfAngle = angle * 0.5;\n\tfloat sin = sin(halfAngle);\n\t\n\tfloat quaX = axis.x * sin;\n\tfloat quaY = axis.y * sin;\n\tfloat quaZ = axis.z * sin;\n\tfloat quaW = cos(halfAngle);\n\t\n\t//vec4 q=vec4(quaX,quaY,quaZ,quaW);\n\t//vec3 temp = cross(q.xyz, vector) + q.w * vector;\n\t//return (cross(temp, -q.xyz) + dot(q.xyz,vector) * q.xyz + q.w * temp);\n\t\n\tfloat x = quaX + quaX;\n    float y = quaY + quaY;\n    float z = quaZ + quaZ;\n    float wx = quaW * x;\n    float wy = quaW * y;\n    float wz = quaW * z;\n\tfloat xx = quaX * x;\n    float xy = quaX * y;\n\tfloat xz = quaX * z;\n    float yy = quaY * y;\n    float yz = quaY * z;\n    float zz = quaZ * z;\n\n    return vec3(((vector.x * ((1.0 - yy) - zz)) + (vector.y * (xy - wz))) + (vector.z * (xz + wy)),\n                ((vector.x * (xy + wz)) + (vector.y * ((1.0 - xx) - zz))) + (vector.z * (yz - wx)),\n                ((vector.x * (xz - wy)) + (vector.y * (yz + wx))) + (vector.z * ((1.0 - xx) - yy)));\n\t\n}\n\nvec3 rotationByQuaternions(in vec3 v,in vec4 q) \n{\n\treturn v + 2.0 * cross(q.xyz, cross(q.xyz, v) + q.w * v);\n}\n\n \n#if defined(VELOCITYOVERLIFETIMECURVE)||defined(VELOCITYOVERLIFETIMERANDOMCURVE)||defined(SIZEOVERLIFETIMECURVE)||defined(SIZEOVERLIFETIMECURVESEPERATE)||defined(SIZEOVERLIFETIMERANDOMCURVES)||defined(SIZEOVERLIFETIMERANDOMCURVESSEPERATE)\nfloat getCurValueFromGradientFloat(in vec2 gradientNumbers[4],in float normalizedAge)\n{\n\tfloat curValue;\n\tfor(int i=1;i<4;i++)\n\t{\n\t\tvec2 gradientNumber=gradientNumbers[i];\n\t\tfloat key=gradientNumber.x;\n\t\tif(key>=normalizedAge)\n\t\t{\n\t\t\tvec2 lastGradientNumber=gradientNumbers[i-1];\n\t\t\tfloat lastKey=lastGradientNumber.x;\n\t\t\tfloat age=(normalizedAge-lastKey)/(key-lastKey);\n\t\t\tcurValue=mix(lastGradientNumber.y,gradientNumber.y,age);\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn curValue;\n}\n#endif\n\n#if defined(VELOCITYOVERLIFETIMECURVE)||defined(VELOCITYOVERLIFETIMERANDOMCURVE)||defined(ROTATIONOVERLIFETIMECURVE)||defined(ROTATIONOVERLIFETIMERANDOMCURVES)\nfloat getTotalValueFromGradientFloat(in vec2 gradientNumbers[4],in float normalizedAge)\n{\n\tfloat totalValue=0.0;\n\tfor(int i=1;i<4;i++)\n\t{\n\t\tvec2 gradientNumber=gradientNumbers[i];\n\t\tfloat key=gradientNumber.x;\n\t\tvec2 lastGradientNumber=gradientNumbers[i-1];\n\t\tfloat lastValue=lastGradientNumber.y;\n\t\t\n\t\tif(key>=normalizedAge){\n\t\t\tfloat lastKey=lastGradientNumber.x;\n\t\t\tfloat age=(normalizedAge-lastKey)/(key-lastKey);\n\t\t\ttotalValue+=(lastValue+mix(lastValue,gradientNumber.y,age))/2.0*a_ShapePositionStartLifeTime.w*(normalizedAge-lastKey);\n\t\t\tbreak;\n\t\t}\n\t\telse{\n\t\t\ttotalValue+=(lastValue+gradientNumber.y)/2.0*a_ShapePositionStartLifeTime.w*(key-lastGradientNumber.x);\n\t\t}\n\t}\n\treturn totalValue;\n}\n#endif\n\n#if defined(COLOROVERLIFETIME)||defined(RANDOMCOLOROVERLIFETIME)\nvec4 getColorFromGradient(in vec2 gradientAlphas[4],in vec4 gradientColors[4],in float normalizedAge)\n{\n\tvec4 overTimeColor;\n\tfor(int i=1;i<4;i++)\n\t{\n\t\tvec2 gradientAlpha=gradientAlphas[i];\n\t\tfloat alphaKey=gradientAlpha.x;\n\t\tif(alphaKey>=normalizedAge)\n\t\t{\n\t\t\tvec2 lastGradientAlpha=gradientAlphas[i-1];\n\t\t\tfloat lastAlphaKey=lastGradientAlpha.x;\n\t\t\tfloat age=(normalizedAge-lastAlphaKey)/(alphaKey-lastAlphaKey);\n\t\t\toverTimeColor.a=mix(lastGradientAlpha.y,gradientAlpha.y,age);\n\t\t\tbreak;\n\t\t}\n\t}\n\t\n\tfor(int i=1;i<4;i++)\n\t{\n\t\tvec4 gradientColor=gradientColors[i];\n\t\tfloat colorKey=gradientColor.x;\n\t\tif(colorKey>=normalizedAge)\n\t\t{\n\t\t\tvec4 lastGradientColor=gradientColors[i-1];\n\t\t\tfloat lastColorKey=lastGradientColor.x;\n\t\t\tfloat age=(normalizedAge-lastColorKey)/(colorKey-lastColorKey);\n\t\t\toverTimeColor.rgb=mix(gradientColors[i-1].yzw,gradientColor.yzw,age);\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn overTimeColor;\n}\n#endif\n\n\n#if defined(TEXTURESHEETANIMATIONCURVE)||defined(TEXTURESHEETANIMATIONRANDOMCURVE)\nfloat getFrameFromGradient(in vec2 gradientFrames[4],in float normalizedAge)\n{\n\tfloat overTimeFrame;\n\tfor(int i=1;i<4;i++)\n\t{\n\t\tvec2 gradientFrame=gradientFrames[i];\n\t\tfloat key=gradientFrame.x;\n\t\tif(key>=normalizedAge)\n\t\t{\n\t\t\tvec2 lastGradientFrame=gradientFrames[i-1];\n\t\t\tfloat lastKey=lastGradientFrame.x;\n\t\t\tfloat age=(normalizedAge-lastKey)/(key-lastKey);\n\t\t\toverTimeFrame=mix(lastGradientFrame.y,gradientFrame.y,age);\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn floor(overTimeFrame);\n}\n#endif\n\n#if defined(VELOCITYOVERLIFETIMECONSTANT)||defined(VELOCITYOVERLIFETIMECURVE)||defined(VELOCITYOVERLIFETIMERANDOMCONSTANT)||defined(VELOCITYOVERLIFETIMERANDOMCURVE)\nvec3 computeParticleLifeVelocity(in float normalizedAge)\n{\n  vec3 outLifeVelocity;\n  #ifdef VELOCITYOVERLIFETIMECONSTANT\n\t outLifeVelocity=u_VOLVelocityConst; \n  #endif\n  #ifdef VELOCITYOVERLIFETIMECURVE\n     outLifeVelocity= vec3(getCurValueFromGradientFloat(u_VOLVelocityGradientX,normalizedAge),getCurValueFromGradientFloat(u_VOLVelocityGradientY,normalizedAge),getCurValueFromGradientFloat(u_VOLVelocityGradientZ,normalizedAge));\n  #endif\n  #ifdef VELOCITYOVERLIFETIMERANDOMCONSTANT\n\t outLifeVelocity=mix(u_VOLVelocityConst,u_VOLVelocityConstMax,vec3(a_Random1.y,a_Random1.z,a_Random1.w)); \n  #endif\n  #ifdef VELOCITYOVERLIFETIMERANDOMCURVE\n     outLifeVelocity=vec3(mix(getCurValueFromGradientFloat(u_VOLVelocityGradientX,normalizedAge),getCurValueFromGradientFloat(u_VOLVelocityGradientMaxX,normalizedAge),a_Random1.y),\n\t                 mix(getCurValueFromGradientFloat(u_VOLVelocityGradientY,normalizedAge),getCurValueFromGradientFloat(u_VOLVelocityGradientMaxY,normalizedAge),a_Random1.z),\n\t\t\t\t\t mix(getCurValueFromGradientFloat(u_VOLVelocityGradientZ,normalizedAge),getCurValueFromGradientFloat(u_VOLVelocityGradientMaxZ,normalizedAge),a_Random1.w));\n  #endif\n\t\t\t\t\t\n  return outLifeVelocity;\n} \n#endif\n\nvec3 computeParticlePosition(in vec3 startVelocity, in vec3 lifeVelocity,in float age,in float normalizedAge,vec3 gravityVelocity,vec4 worldRotation)\n{\n   vec3 startPosition;\n   vec3 lifePosition;\n   #if defined(VELOCITYOVERLIFETIMECONSTANT)||defined(VELOCITYOVERLIFETIMECURVE)||defined(VELOCITYOVERLIFETIMERANDOMCONSTANT)||defined(VELOCITYOVERLIFETIMERANDOMCURVE)\n\t#ifdef VELOCITYOVERLIFETIMECONSTANT\n\t\t  startPosition=startVelocity*age;\n\t\t  lifePosition=lifeVelocity*age;\n\t#endif\n\t#ifdef VELOCITYOVERLIFETIMECURVE\n\t\t  startPosition=startVelocity*age;\n\t\t  lifePosition=vec3(getTotalValueFromGradientFloat(u_VOLVelocityGradientX,normalizedAge),getTotalValueFromGradientFloat(u_VOLVelocityGradientY,normalizedAge),getTotalValueFromGradientFloat(u_VOLVelocityGradientZ,normalizedAge));\n\t#endif\n\t#ifdef VELOCITYOVERLIFETIMERANDOMCONSTANT\n\t\t  startPosition=startVelocity*age;\n\t\t  lifePosition=lifeVelocity*age;\n\t#endif\n\t#ifdef VELOCITYOVERLIFETIMERANDOMCURVE\n\t\t  startPosition=startVelocity*age;\n\t\t  lifePosition=vec3(mix(getTotalValueFromGradientFloat(u_VOLVelocityGradientX,normalizedAge),getTotalValueFromGradientFloat(u_VOLVelocityGradientMaxX,normalizedAge),a_Random1.y)\n\t      ,mix(getTotalValueFromGradientFloat(u_VOLVelocityGradientY,normalizedAge),getTotalValueFromGradientFloat(u_VOLVelocityGradientMaxY,normalizedAge),a_Random1.z)\n\t      ,mix(getTotalValueFromGradientFloat(u_VOLVelocityGradientZ,normalizedAge),getTotalValueFromGradientFloat(u_VOLVelocityGradientMaxZ,normalizedAge),a_Random1.w));\n\t#endif\n\t\n\tvec3 finalPosition;\n\tif(u_VOLSpaceType==0){\n\t  if(u_ScalingMode!=2)\n\t   finalPosition =rotationByQuaternions(u_PositionScale*(a_ShapePositionStartLifeTime.xyz+startPosition+lifePosition),worldRotation);\n\t  else\n\t   finalPosition =rotationByQuaternions(u_PositionScale*a_ShapePositionStartLifeTime.xyz+startPosition+lifePosition,worldRotation);\n\t}\n\telse{\n\t  if(u_ScalingMode!=2)\n\t    finalPosition = rotationByQuaternions(u_PositionScale*(a_ShapePositionStartLifeTime.xyz+startPosition),worldRotation)+lifePosition;\n\t  else\n\t    finalPosition = rotationByQuaternions(u_PositionScale*a_ShapePositionStartLifeTime.xyz+startPosition,worldRotation)+lifePosition;\n\t}\n  #else\n\t startPosition=startVelocity*age;\n\t vec3 finalPosition;\n\t if(u_ScalingMode!=2)\n\t   finalPosition = rotationByQuaternions(u_PositionScale*(a_ShapePositionStartLifeTime.xyz+startPosition),worldRotation);\n\t else\n\t   finalPosition = rotationByQuaternions(u_PositionScale*a_ShapePositionStartLifeTime.xyz+startPosition,worldRotation);\n  #endif\n  \n  if(u_SimulationSpace==0)\n    finalPosition=finalPosition+a_SimulationWorldPostion;\n  else if(u_SimulationSpace==1) \n    finalPosition=finalPosition+u_WorldPosition;\n  \n  finalPosition+=0.5*gravityVelocity*age;\n \n  return  finalPosition;\n}\n\n\nvec4 computeParticleColor(in vec4 color,in float normalizedAge)\n{\n\t#ifdef COLOROVERLIFETIME\n\t  color*=getColorFromGradient(u_ColorOverLifeGradientAlphas,u_ColorOverLifeGradientColors,normalizedAge);\n\t#endif\n\t\n\t#ifdef RANDOMCOLOROVERLIFETIME\n\t  color*=mix(getColorFromGradient(u_ColorOverLifeGradientAlphas,u_ColorOverLifeGradientColors,normalizedAge),getColorFromGradient(u_MaxColorOverLifeGradientAlphas,u_MaxColorOverLifeGradientColors,normalizedAge),a_Random0.y);\n\t#endif\n\n    return color;\n}\n\nvec2 computeParticleSizeBillbard(in vec2 size,in float normalizedAge)\n{\n\t#ifdef SIZEOVERLIFETIMECURVE\n\t\tsize*=getCurValueFromGradientFloat(u_SOLSizeGradient,normalizedAge);\n\t#endif\n\t#ifdef SIZEOVERLIFETIMERANDOMCURVES\n\t    size*=mix(getCurValueFromGradientFloat(u_SOLSizeGradient,normalizedAge),getCurValueFromGradientFloat(u_SOLSizeGradientMax,normalizedAge),a_Random0.z); \n\t#endif\n\t#ifdef SIZEOVERLIFETIMECURVESEPERATE\n\t\tsize*=vec2(getCurValueFromGradientFloat(u_SOLSizeGradientX,normalizedAge),getCurValueFromGradientFloat(u_SOLSizeGradientY,normalizedAge));\n\t#endif\n\t#ifdef SIZEOVERLIFETIMERANDOMCURVESSEPERATE\n\t    size*=vec2(mix(getCurValueFromGradientFloat(u_SOLSizeGradientX,normalizedAge),getCurValueFromGradientFloat(u_SOLSizeGradientMaxX,normalizedAge),a_Random0.z)\n\t    ,mix(getCurValueFromGradientFloat(u_SOLSizeGradientY,normalizedAge),getCurValueFromGradientFloat(u_SOLSizeGradientMaxY,normalizedAge),a_Random0.z));\n\t#endif\n\treturn size;\n}\n\n#ifdef RENDERMODE_MESH\nvec3 computeParticleSizeMesh(in vec3 size,in float normalizedAge)\n{\n\t#ifdef SIZEOVERLIFETIMECURVE\n\t\tsize*=getCurValueFromGradientFloat(u_SOLSizeGradient,normalizedAge);\n\t#endif\n\t#ifdef SIZEOVERLIFETIMERANDOMCURVES\n\t    size*=mix(getCurValueFromGradientFloat(u_SOLSizeGradient,normalizedAge),getCurValueFromGradientFloat(u_SOLSizeGradientMax,normalizedAge),a_Random0.z); \n\t#endif\n\t#ifdef SIZEOVERLIFETIMECURVESEPERATE\n\t\tsize*=vec3(getCurValueFromGradientFloat(u_SOLSizeGradientX,normalizedAge),getCurValueFromGradientFloat(u_SOLSizeGradientY,normalizedAge),getCurValueFromGradientFloat(u_SOLSizeGradientZ,normalizedAge));\n\t#endif\n\t#ifdef SIZEOVERLIFETIMERANDOMCURVESSEPERATE\n\t    size*=vec3(mix(getCurValueFromGradientFloat(u_SOLSizeGradientX,normalizedAge),getCurValueFromGradientFloat(u_SOLSizeGradientMaxX,normalizedAge),a_Random0.z)\n\t    ,mix(getCurValueFromGradientFloat(u_SOLSizeGradientY,normalizedAge),getCurValueFromGradientFloat(u_SOLSizeGradientMaxY,normalizedAge),a_Random0.z)\n\t\t,mix(getCurValueFromGradientFloat(u_SOLSizeGradientZ,normalizedAge),getCurValueFromGradientFloat(u_SOLSizeGradientMaxZ,normalizedAge),a_Random0.z));\n\t#endif\n\treturn size;\n}\n#endif\n\nfloat computeParticleRotationFloat(in float rotation,in float age,in float normalizedAge)\n{ \n\t#ifdef ROTATIONOVERLIFETIME\n\t\t#ifdef ROTATIONOVERLIFETIMECONSTANT\n\t\t\tfloat ageRot=u_ROLAngularVelocityConst*age;\n\t        rotation+=ageRot;\n\t\t#endif\n\t\t#ifdef ROTATIONOVERLIFETIMECURVE\n\t\t\trotation+=getTotalValueFromGradientFloat(u_ROLAngularVelocityGradient,normalizedAge);\n\t\t#endif\n\t\t#ifdef ROTATIONOVERLIFETIMERANDOMCONSTANTS\n\t\t\tfloat ageRot=mix(u_ROLAngularVelocityConst,u_ROLAngularVelocityConstMax,a_Random0.w)*age;\n\t        rotation+=ageRot;\n\t    #endif\n\t\t#ifdef ROTATIONOVERLIFETIMERANDOMCURVES\n\t\t\trotation+=mix(getTotalValueFromGradientFloat(u_ROLAngularVelocityGradient,normalizedAge),getTotalValueFromGradientFloat(u_ROLAngularVelocityGradientMax,normalizedAge),a_Random0.w);\n\t\t#endif\n\t#endif\n\t#ifdef ROTATIONOVERLIFETIMESEPERATE\n\t\t#ifdef ROTATIONOVERLIFETIMECONSTANT\n\t\t\tfloat ageRot=u_ROLAngularVelocityConstSeprarate.z*age;\n\t        rotation+=ageRot;\n\t\t#endif\n\t\t#ifdef ROTATIONOVERLIFETIMECURVE\n\t\t\trotation+=getTotalValueFromGradientFloat(u_ROLAngularVelocityGradientZ,normalizedAge);\n\t\t#endif\n\t\t#ifdef ROTATIONOVERLIFETIMERANDOMCONSTANTS\n\t\t\tfloat ageRot=mix(u_ROLAngularVelocityConstSeprarate.z,u_ROLAngularVelocityConstMaxSeprarate.z,a_Random0.w)*age;\n\t        rotation+=ageRot;\n\t    #endif\n\t\t#ifdef ROTATIONOVERLIFETIMERANDOMCURVES\n\t\t\trotation+=mix(getTotalValueFromGradientFloat(u_ROLAngularVelocityGradientZ,normalizedAge),getTotalValueFromGradientFloat(u_ROLAngularVelocityGradientMaxZ,normalizedAge),a_Random0.w));\n\t\t#endif\n\t#endif\n\treturn rotation;\n}\n\n\n#if defined(RENDERMODE_MESH)&&(defined(ROTATIONOVERLIFETIME)||defined(ROTATIONOVERLIFETIMESEPERATE))\nvec3 computeParticleRotationVec3(in vec3 rotation,in float age,in float normalizedAge)\n{ \n\t#ifdef ROTATIONOVERLIFETIME\n\t#ifdef ROTATIONOVERLIFETIMECONSTANT\n\t\t\tfloat ageRot=u_ROLAngularVelocityConst*age;\n\t        rotation+=ageRot;\n\t\t#endif\n\t\t#ifdef ROTATIONOVERLIFETIMECURVE\n\t\t\trotation+=getTotalValueFromGradientFloat(u_ROLAngularVelocityGradient,normalizedAge);\n\t\t#endif\n\t\t#ifdef ROTATIONOVERLIFETIMERANDOMCONSTANTS\n\t\t\tfloat ageRot=mix(u_ROLAngularVelocityConst,u_ROLAngularVelocityConstMax,a_Random0.w)*age;\n\t        rotation+=ageRot;\n\t    #endif\n\t\t#ifdef ROTATIONOVERLIFETIMERANDOMCURVES\n\t\t\trotation+=mix(getTotalValueFromGradientFloat(u_ROLAngularVelocityGradient,normalizedAge),getTotalValueFromGradientFloat(u_ROLAngularVelocityGradientMax,normalizedAge),a_Random0.w);\n\t\t#endif\n\t#endif\n\t#ifdef ROTATIONOVERLIFETIMESEPERATE\n\t#ifdef ROTATIONOVERLIFETIMECONSTANT\n\t\t\tvec3 ageRot=u_ROLAngularVelocityConstSeprarate*age;\n\t        rotation+=ageRot;\n\t\t#endif\n\t\t#ifdef ROTATIONOVERLIFETIMECURVE\n\t\t\trotation+=vec3(getTotalValueFromGradientFloat(u_ROLAngularVelocityGradientX,normalizedAge),getTotalValueFromGradientFloat(u_ROLAngularVelocityGradientY,normalizedAge),getTotalValueFromGradientFloat(u_ROLAngularVelocityGradientZ,normalizedAge));\n\t\t#endif\n\t\t#ifdef ROTATIONOVERLIFETIMERANDOMCONSTANTS\n\t\t\tvec3 ageRot=mix(u_ROLAngularVelocityConstSeprarate,u_ROLAngularVelocityConstMaxSeprarate,a_Random0.w)*age;\n\t        rotation+=ageRot;\n\t    #endif\n\t\t#ifdef ROTATIONOVERLIFETIMERANDOMCURVES\n\t\t\trotation+=vec3(mix(getTotalValueFromGradientFloat(u_ROLAngularVelocityGradientX,normalizedAge),getTotalValueFromGradientFloat(u_ROLAngularVelocityGradientMaxX,normalizedAge),a_Random0.w)\n\t        ,mix(getTotalValueFromGradientFloat(u_ROLAngularVelocityGradientY,normalizedAge),getTotalValueFromGradientFloat(u_ROLAngularVelocityGradientMaxY,normalizedAge),a_Random0.w)\n\t        ,mix(getTotalValueFromGradientFloat(u_ROLAngularVelocityGradientZ,normalizedAge),getTotalValueFromGradientFloat(u_ROLAngularVelocityGradientMaxZ,normalizedAge),a_Random0.w));\n\t\t#endif\n\t#endif\n\treturn rotation;\n}\n#endif\n\nvec2 computeParticleUV(in vec2 uv,in float normalizedAge)\n{ \n\t#ifdef TEXTURESHEETANIMATIONCURVE\n\t\tfloat cycleNormalizedAge=normalizedAge*u_TSACycles;\n\t\tfloat frame=getFrameFromGradient(u_TSAGradientUVs,cycleNormalizedAge-floor(cycleNormalizedAge));\n\t\tfloat totalULength=frame*u_TSASubUVLength.x;\n\t\tfloat floorTotalULength=floor(totalULength);\n\t    uv.x+=totalULength-floorTotalULength;\n\t\tuv.y+=floorTotalULength*u_TSASubUVLength.y;\n    #endif\n\t#ifdef TEXTURESHEETANIMATIONRANDOMCURVE\n\t\tfloat cycleNormalizedAge=normalizedAge*u_TSACycles;\n\t\tfloat uvNormalizedAge=cycleNormalizedAge-floor(cycleNormalizedAge);\n\t    float frame=floor(mix(getFrameFromGradient(u_TSAGradientUVs,uvNormalizedAge),getFrameFromGradient(u_TSAMaxGradientUVs,uvNormalizedAge),a_Random1.x));\n\t\tfloat totalULength=frame*u_TSASubUVLength.x;\n\t\tfloat floorTotalULength=floor(totalULength);\n\t    uv.x+=totalULength-floorTotalULength;\n\t\tuv.y+=floorTotalULength*u_TSASubUVLength.y;\n    #endif\n\treturn uv;\n}\n\nvoid main()\n{\n\tfloat age = u_CurrentTime - a_DirectionTime.w;\n\tfloat normalizedAge = age/a_ShapePositionStartLifeTime.w;\n\tvec3 lifeVelocity;\n\tif(normalizedAge<1.0){ \n\tvec3 startVelocity=a_DirectionTime.xyz*a_StartSpeed;\n\t#if defined(VELOCITYOVERLIFETIMECONSTANT)||defined(VELOCITYOVERLIFETIMECURVE)||defined(VELOCITYOVERLIFETIMERANDOMCONSTANT)||defined(VELOCITYOVERLIFETIMERANDOMCURVE)\n\t\tlifeVelocity= computeParticleLifeVelocity(normalizedAge);//计算粒子生命周期速度\n\t#endif \n\tvec3 gravityVelocity=u_Gravity*age;\n\t\n\tvec4 worldRotation;\n\tif(u_SimulationSpace==0)\n\t\tworldRotation=a_SimulationWorldRotation;\n\telse\n\t\tworldRotation=u_WorldRotation;\n\t\n\tvec3 center=computeParticlePosition(startVelocity, lifeVelocity, age, normalizedAge,gravityVelocity,worldRotation);//计算粒子位置\n   \n   \n   #ifdef SPHERHBILLBOARD\n\t\tvec2 corner=a_CornerTextureCoordinate.xy;//Billboard模式z轴无效\n        vec3 cameraUpVector =normalize(u_CameraUp);//TODO:是否外面归一化\n        vec3 sideVector = normalize(cross(u_CameraDirection,cameraUpVector));\n        vec3 upVector = normalize(cross(sideVector,u_CameraDirection));\n\t    corner*=computeParticleSizeBillbard(a_StartSize.xy,normalizedAge);\n\t\t#if defined(ROTATIONOVERLIFETIME)||defined(ROTATIONOVERLIFETIMESEPERATE)\n\t\t\tif(u_ThreeDStartRotation){\n\t\t\t\tvec3 rotation=vec3(a_StartRotation0.xy,computeParticleRotationFloat(a_StartRotation0.z,age,normalizedAge));\n\t\t\t\tcenter += u_SizeScale.xzy*rotationByEuler(corner.x*sideVector+corner.y*upVector,rotation);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tfloat rot = computeParticleRotationFloat(a_StartRotation0.x, age,normalizedAge);\n\t\t\t\tfloat c = cos(rot);\n\t\t\t\tfloat s = sin(rot);\n\t\t\t\tmat2 rotation= mat2(c, -s, s, c);\n\t\t\t\tcorner=rotation*corner;\n\t\t\t\tcenter += u_SizeScale.xzy*(corner.x*sideVector+corner.y*upVector);\n\t\t\t}\n\t\t#else\n\t\t\tif(u_ThreeDStartRotation){\n\t\t\t\tcenter += u_SizeScale.xzy*rotationByEuler(corner.x*sideVector+corner.y*upVector,a_StartRotation0);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tfloat c = cos(a_StartRotation0.x);\n\t\t\t\tfloat s = sin(a_StartRotation0.x);\n\t\t\t\tmat2 rotation= mat2(c, -s, s, c);\n\t\t\t\tcorner=rotation*corner;\n\t\t\t\tcenter += u_SizeScale.xzy*(corner.x*sideVector+corner.y*upVector);\n\t\t\t}\n\t\t#endif\n   #endif\n   \n   #ifdef STRETCHEDBILLBOARD\n\tvec2 corner=a_CornerTextureCoordinate.xy;//Billboard模式z轴无效\n\tvec3 velocity;\n\t#if defined(VELOCITYOVERLIFETIMECONSTANT)||defined(VELOCITYOVERLIFETIMECURVE)||defined(VELOCITYOVERLIFETIMERANDOMCONSTANT)||defined(VELOCITYOVERLIFETIMERANDOMCURVE)\n\t    if(u_VOLSpaceType==0)\n\t\t  velocity=rotationByQuaternions(u_SizeScale*(startVelocity+lifeVelocity),worldRotation)+gravityVelocity;\n\t    else\n\t\t  velocity=rotationByQuaternions(u_SizeScale*startVelocity,worldRotation)+lifeVelocity+gravityVelocity;\n    #else\n\t    velocity= rotationByQuaternions(u_SizeScale*startVelocity,worldRotation)+gravityVelocity;\n    #endif\t\n\t\tvec3 cameraUpVector = normalize(velocity);\n\t\tvec3 direction = normalize(center-u_CameraPosition);\n        vec3 sideVector = normalize(cross(direction,normalize(velocity)));\n\t\t\n\t\tsideVector=u_SizeScale.xzy*sideVector;\n\t\tcameraUpVector=length(vec3(u_SizeScale.x,0.0,0.0))*cameraUpVector;\n\t\t\n\t    vec2 size=computeParticleSizeBillbard(a_StartSize.xy,normalizedAge);\n\t\t\n\t    const mat2 rotaionZHalfPI=mat2(0.0, -1.0, 1.0, 0.0);\n\t    corner=rotaionZHalfPI*corner;\n\t    corner.y=corner.y-abs(corner.y);\n\t\t\n\t    float speed=length(velocity);//TODO:\n\t    center +=sign(u_SizeScale.x)*(sign(u_StretchedBillboardLengthScale)*size.x*corner.x*sideVector+(speed*u_StretchedBillboardSpeedScale+size.y*u_StretchedBillboardLengthScale)*corner.y*cameraUpVector);\n   #endif\n   \n   #ifdef HORIZONTALBILLBOARD\n\t\tvec2 corner=a_CornerTextureCoordinate.xy;//Billboard模式z轴无效\n        const vec3 cameraUpVector=vec3(0.0,0.0,1.0);\n\t    const vec3 sideVector = vec3(-1.0,0.0,0.0);\n\t\t\n\t\tfloat rot = computeParticleRotationFloat(a_StartRotation0.x, age,normalizedAge);\n        float c = cos(rot);\n        float s = sin(rot);\n        mat2 rotation= mat2(c, -s, s, c);\n\t    corner=rotation*corner*cos(0.78539816339744830961566084581988);//TODO:临时缩小cos45,不确定U3D原因\n\t\tcorner*=computeParticleSizeBillbard(a_StartSize.xy,normalizedAge);\n        center +=u_SizeScale.xzy*(corner.x*sideVector+ corner.y*cameraUpVector);\n   #endif\n   \n   #ifdef VERTICALBILLBOARD\n\t\tvec2 corner=a_CornerTextureCoordinate.xy;//Billboard模式z轴无效\n        const vec3 cameraUpVector =vec3(0.0,1.0,0.0);\n        vec3 sideVector = normalize(cross(u_CameraDirection,cameraUpVector));\n\t\t\n\t\tfloat rot = computeParticleRotationFloat(a_StartRotation0.x, age,normalizedAge);\n        float c = cos(rot);\n        float s = sin(rot);\n        mat2 rotation= mat2(c, -s, s, c);\n\t    corner=rotation*corner*cos(0.78539816339744830961566084581988);//TODO:临时缩小cos45,不确定U3D原因\n\t\tcorner*=computeParticleSizeBillbard(a_StartSize.xy,normalizedAge);\n        center +=u_SizeScale.xzy*(corner.x*sideVector+ corner.y*cameraUpVector);\n   #endif\n   \n   #ifdef RENDERMODE_MESH\n\t    vec3 size=computeParticleSizeMesh(a_StartSize,normalizedAge);\n\t\t#if defined(ROTATIONOVERLIFETIME)||defined(ROTATIONOVERLIFETIMESEPERATE)\n\t\t\tif(u_ThreeDStartRotation){\n\t\t\t\tvec3 rotation=vec3(a_StartRotation0.xy,-computeParticleRotationFloat(a_StartRotation0.z, age,normalizedAge));\n\t\t\t\tcenter+= rotationByQuaternions(u_SizeScale*rotationByEuler(a_MeshPosition*size,rotation),worldRotation);\n\t\t\t}\n\t\t\telse{\n\t\t\t\t#ifdef ROTATIONOVERLIFETIME\n\t\t\t\t\tfloat angle=computeParticleRotationFloat(a_StartRotation0.x, age,normalizedAge);\n\t\t\t\t\tif(a_ShapePositionStartLifeTime.x!=0.0||a_ShapePositionStartLifeTime.y!=0.0){\n\t\t\t\t\t\tcenter+= (rotationByQuaternions(rotationByAxis(u_SizeScale*a_MeshPosition*size,normalize(cross(vec3(0.0,0.0,1.0),vec3(a_ShapePositionStartLifeTime.xy,0.0))),angle),worldRotation));//已验证\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\t#ifdef SHAPE\n\t\t\t\t\t\t\tcenter+= u_SizeScale.xzy*(rotationByQuaternions(rotationByAxis(a_MeshPosition*size,vec3(0.0,-1.0,0.0),angle),worldRotation));\n\t\t\t\t\t\t#else\n\t\t\t\t\t\t\tif(u_SimulationSpace==0)\n\t\t\t\t\t\t\t\tcenter+=rotationByAxis(u_SizeScale*a_MeshPosition*size,vec3(0.0,0.0,-1.0),angle);//已验证\n\t\t\t\t\t\t\telse if(u_SimulationSpace==1)\n\t\t\t\t\t\t\t\tcenter+=rotationByQuaternions(u_SizeScale*rotationByAxis(a_MeshPosition*size,vec3(0.0,0.0,-1.0),angle),worldRotation);//已验证\n\t\t\t\t\t\t#endif\n\t\t\t\t\t}\n\t\t\t\t#endif\n\t\t\t\t#ifdef ROTATIONOVERLIFETIMESEPERATE\n\t\t\t\t\t//TODO:是否应合并if(u_ThreeDStartRotation)分支代码,待测试\n\t\t\t\t\tvec3 angle=computeParticleRotationVec3(vec3(0.0,0.0,a_StartRotation0.z), age,normalizedAge);\n\t\t\t\t\tcenter+= (rotationByQuaternions(rotationByEuler(u_SizeScale*a_MeshPosition*size,vec3(angle.x,angle.y,angle.z)),worldRotation));//已验证\n\t\t\t\t#endif\t\n\t\t\t}\n\t\t#else\n\t\t\tif(u_ThreeDStartRotation){\n\t\t\t\tcenter+= rotationByQuaternions(u_SizeScale*rotationByEuler(a_MeshPosition*size,a_StartRotation0),worldRotation);//已验证\n\t\t\t}\n\t\t\telse{\n\t\t\t\tif(a_ShapePositionStartLifeTime.x!=0.0||a_ShapePositionStartLifeTime.y!=0.0){\n\t\t\t\t\tif(u_SimulationSpace==0)\n\t\t\t\t\t\tcenter+= rotationByAxis(u_SizeScale*a_MeshPosition*size,normalize(cross(vec3(0.0,0.0,1.0),vec3(a_ShapePositionStartLifeTime.xy,0.0))),a_StartRotation0.x);\n\t\t\t\t\telse if(u_SimulationSpace==1)\n\t\t\t\t\t\tcenter+= (rotationByQuaternions(u_SizeScale*rotationByAxis(a_MeshPosition*size,normalize(cross(vec3(0.0,0.0,1.0),vec3(a_ShapePositionStartLifeTime.xy,0.0))),a_StartRotation0.x),worldRotation));//已验证\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\t#ifdef SHAPE\n\t\t\t\t\t\tif(u_SimulationSpace==0)\n\t\t\t\t\t\t\tcenter+= u_SizeScale*rotationByAxis(a_MeshPosition*size,vec3(0.0,-1.0,0.0),a_StartRotation0.x);\n\t\t\t\t\t\telse if(u_SimulationSpace==1)\n\t\t\t\t\t\t\tcenter+= rotationByQuaternions(u_SizeScale*rotationByAxis(a_MeshPosition*size,vec3(0.0,-1.0,0.0),a_StartRotation0.x),worldRotation);\t\n\t\t\t\t\t#else\n\t\t\t\t\t\tif(u_SimulationSpace==0)\n\t\t\t\t\t\t\tcenter+= rotationByAxis(u_SizeScale*a_MeshPosition*size,vec3(0.0,0.0,-1.0),a_StartRotation0.x);\n\t\t\t\t\t\telse if(u_SimulationSpace==1)\n\t\t\t\t\t\t\tcenter+= rotationByQuaternions(u_SizeScale*rotationByAxis(a_MeshPosition*size,vec3(0.0,0.0,-1.0),a_StartRotation0.x),worldRotation);//已验证\n\t\t\t\t\t#endif\n\t\t\t\t}\n\t\t\t}\n\t\t#endif\n\t\tv_MeshColor=a_MeshColor;\n   #endif\n   \n    gl_Position=u_Projection*u_View*vec4(center,1.0);\n    v_Color = computeParticleColor(a_StartColor, normalizedAge);\n\t#ifdef DIFFUSEMAP\n\t\t#if defined(SPHERHBILLBOARD)||defined(STRETCHEDBILLBOARD)||defined(HORIZONTALBILLBOARD)||defined(VERTICALBILLBOARD)\n\t\t\tv_TextureCoordinate =computeParticleUV(a_CornerTextureCoordinate.zw, normalizedAge);\n\t\t#endif\n\t\t#ifdef RENDERMODE_MESH\n\t\t\tv_TextureCoordinate =computeParticleUV(a_MeshTextureCoordinate, normalizedAge);\n\t\t#endif\n\t\t\n\t\t#ifdef TILINGOFFSET\n\t\t\tv_TextureCoordinate=vec2(v_TextureCoordinate.x,1.0-v_TextureCoordinate.y)*u_TilingOffset.xy+vec2(u_TilingOffset.z,-u_TilingOffset.w);//需要特殊处理\n\t\t\tv_TextureCoordinate=vec2(v_TextureCoordinate.x,1.0-v_TextureCoordinate.y);//需要特殊处理\n\t\t#endif\n\t#endif\n    v_Discard=0.0;\n\t  \n\t#ifdef FOG\n\t\tv_PositionWorld=center;\n\t#endif\n   }\n   else\n\t{\n\t\tv_Discard=1.0;\n\t}\n}\n\n",t="#ifdef HIGHPRECISION\n  precision highp float;\n#else\n  precision mediump float;\n#endif\n\nvarying float v_Discard;\nvarying vec4 v_Color;\nvarying vec2 v_TextureCoordinate;\nuniform sampler2D u_texture;\nuniform vec4 u_Tintcolor;\n\n#ifdef RENDERMODE_MESH\n\tvarying vec4 v_MeshColor;\n#endif\n\n#ifdef FOG\n\tvarying vec3 v_PositionWorld;\n\tuniform vec3 u_CameraPosition;\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\t#ifdef ADDTIVEFOG\n\t#else\n\t\tuniform vec3 u_FogColor;\n\t#endif\n#endif\n\n\nvoid main()\n{\t\n\t#ifdef RENDERMODE_MESH\n\t\tgl_FragColor=v_MeshColor;\n\t#else\n\t\tgl_FragColor=vec4(1.0);\t\n\t#endif\n\t\t\n\t#ifdef DIFFUSEMAP\n\t\tif(v_Discard!=0.0)\n\t\t\tdiscard;\n\t\t#ifdef TINTCOLOR\n\t\t\tgl_FragColor*=texture2D(u_texture,v_TextureCoordinate)*u_Tintcolor*2.0*v_Color;\n\t\t#else\n\t\t\tgl_FragColor*=texture2D(u_texture,v_TextureCoordinate)*v_Color;\n\t\t#endif\n\t#else\n\t\t#ifdef TINTCOLOR\n\t\t\tgl_FragColor*=u_Tintcolor*2.0*v_Color;\n\t\t#else\n\t\t\tgl_FragColor*=v_Color;\n\t\t#endif\n\t#endif\n\t\n\t#ifdef FOG\n\t\tvec3 toEye=u_CameraPosition-v_PositionWorld;\n\t\tfloat toEyeLength=length(toEye);\n\t\ttoEye/=toEyeLength;\n\t\t\n\t\tfloat lerpFact=clamp((toEyeLength-u_FogStart)/u_FogRange,0.0,1.0);\n\t\t#ifdef ADDTIVEFOG\n\t\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,vec3(0.0,0.0,0.0),lerpFact);\n\t\t#else\n\t\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n\t\t#endif\n\t#endif\n}",r=ci.add(u,e,t,i,n),Ki.SHADERDEFINE_DIFFUSEMAP=r.registerMaterialDefine("DIFFUSEMAP"),Ki.SHADERDEFINE_TINTCOLOR=r.registerMaterialDefine("TINTCOLOR"),Ki.SHADERDEFINE_ADDTIVEFOG=r.registerMaterialDefine("ADDTIVEFOG"),Ki.SHADERDEFINE_TILINGOFFSET=r.registerMaterialDefine("TILINGOFFSET"),yn.SHADERDEFINE_RENDERMODE_BILLBOARD=r.registerSpriteDefine("SPHERHBILLBOARD"),yn.SHADERDEFINE_RENDERMODE_STRETCHEDBILLBOARD=r.registerSpriteDefine("STRETCHEDBILLBOARD"),yn.SHADERDEFINE_RENDERMODE_HORIZONTALBILLBOARD=r.registerSpriteDefine("HORIZONTALBILLBOARD"),yn.SHADERDEFINE_RENDERMODE_VERTICALBILLBOARD=r.registerSpriteDefine("VERTICALBILLBOARD"),yn.SHADERDEFINE_COLOROVERLIFETIME=r.registerSpriteDefine("COLOROVERLIFETIME"),yn.SHADERDEFINE_RANDOMCOLOROVERLIFETIME=r.registerSpriteDefine("RANDOMCOLOROVERLIFETIME"),yn.SHADERDEFINE_VELOCITYOVERLIFETIMECONSTANT=r.registerSpriteDefine("VELOCITYOVERLIFETIMECONSTANT"),yn.SHADERDEFINE_VELOCITYOVERLIFETIMECURVE=r.registerSpriteDefine("VELOCITYOVERLIFETIMECURVE"),yn.SHADERDEFINE_VELOCITYOVERLIFETIMERANDOMCONSTANT=r.registerSpriteDefine("VELOCITYOVERLIFETIMERANDOMCONSTANT"),yn.SHADERDEFINE_VELOCITYOVERLIFETIMERANDOMCURVE=r.registerSpriteDefine("VELOCITYOVERLIFETIMERANDOMCURVE"),yn.SHADERDEFINE_TEXTURESHEETANIMATIONCURVE=r.registerSpriteDefine("TEXTURESHEETANIMATIONCURVE"),yn.SHADERDEFINE_TEXTURESHEETANIMATIONRANDOMCURVE=r.registerSpriteDefine("TEXTURESHEETANIMATIONRANDOMCURVE"),yn.SHADERDEFINE_ROTATIONOVERLIFETIME=r.registerSpriteDefine("ROTATIONOVERLIFETIME"),yn.SHADERDEFINE_ROTATIONOVERLIFETIMESEPERATE=r.registerSpriteDefine("ROTATIONOVERLIFETIMESEPERATE"),yn.SHADERDEFINE_ROTATIONOVERLIFETIMECONSTANT=r.registerSpriteDefine("ROTATIONOVERLIFETIMECONSTANT"),yn.SHADERDEFINE_ROTATIONOVERLIFETIMECURVE=r.registerSpriteDefine("ROTATIONOVERLIFETIMECURVE"),yn.SHADERDEFINE_ROTATIONOVERLIFETIMERANDOMCONSTANTS=r.registerSpriteDefine("ROTATIONOVERLIFETIMERANDOMCONSTANTS"),yn.SHADERDEFINE_ROTATIONOVERLIFETIMERANDOMCURVES=r.registerSpriteDefine("ROTATIONOVERLIFETIMERANDOMCURVES"),yn.SHADERDEFINE_SIZEOVERLIFETIMECURVE=r.registerSpriteDefine("SIZEOVERLIFETIMECURVE"),yn.SHADERDEFINE_SIZEOVERLIFETIMECURVESEPERATE=r.registerSpriteDefine("SIZEOVERLIFETIMECURVESEPERATE"),yn.SHADERDEFINE_SIZEOVERLIFETIMERANDOMCURVES=r.registerSpriteDefine("SIZEOVERLIFETIMERANDOMCURVES"),yn.SHADERDEFINE_SIZEOVERLIFETIMERANDOMCURVESSEPERATE=r.registerSpriteDefine("SIZEOVERLIFETIMERANDOMCURVESSEPERATE"),yn.SHADERDEFINE_RENDERMODE_MESH=r.registerSpriteDefine("RENDERMODE_MESH"),yn.SHADERDEFINE_SHAPE=r.registerSpriteDefine("SHAPE"),i={a_Position:0,a_Texcoord0:2,a_Time:33},n={u_Texture:[1,1],u_Albedo:[2,1],u_Color:[3,1],u_CurrentTime:[2,2],u_Duration:[3,2],u_MvpMatrix:[1,2]};var d=Oi.nameKey.add("GLITTER");e="attribute vec4 a_Position;\nattribute vec2 a_Texcoord0;\nattribute float a_Time;\n\nuniform mat4 u_MvpMatrix;\nuniform  float u_CurrentTime;\nuniform  vec4 u_Color;\nuniform float u_Duration;\n\nvarying vec2 v_Texcoord;\nvarying vec4 v_Color;\n\n\nvoid main()\n{\n  gl_Position = u_MvpMatrix * a_Position;\n  \n  float age = u_CurrentTime-a_Time;\n  float normalizedAge = clamp(age / u_Duration,0.0,1.0);\n   \n  v_Texcoord=a_Texcoord0;\n  \n  v_Color=u_Color;\n  v_Color.a*=1.0-normalizedAge;\n}\n",t="#ifdef HIGHPRECISION\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\nuniform vec4 u_Albedo;\nuniform sampler2D u_Texture;\n\nvarying vec2 v_Texcoord;\nvarying vec4 v_Color;\n\n\nvoid main()\n{\t\n  gl_FragColor=texture2D(u_Texture, v_Texcoord)*v_Color;\n  gl_FragColor=gl_FragColor*u_Albedo;\n}\n\n",r=ci.add(d,e,t,i,n),i={a_Position:0},n={u_Intensity:[1,1],u_AlphaBlending:[2,1],u_CubeTexture:[3,1],u_MvpMatrix:[4,3]};var _=Oi.nameKey.add("SkyBox");e="attribute vec4 a_Position;\nuniform mat4 u_MvpMatrix;\nvarying vec3 v_Texcoord;\n\n\nvoid main()\n{\n  gl_Position = (u_MvpMatrix*a_Position).xyww;\n  v_Texcoord=a_Position.xyz;\n}\n",t="#ifdef HIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\nuniform float u_Intensity;\nuniform float u_AlphaBlending;\nuniform samplerCube u_CubeTexture;\n\nvarying vec3 v_Texcoord;\n\n\nvoid main()\n{\t\n  gl_FragColor=vec4(textureCube(u_CubeTexture, v_Texcoord).rgb*u_Intensity,u_AlphaBlending);\n}\n\n",ci.add(_,e,t,i,n),i={a_Position:0,a_Texcoord0:2},n={u_Intensity:[1,1],u_AlphaBlending:[2,1],u_texture:[3,1],u_MvpMatrix:[4,3]};var m=Oi.nameKey.add("SkyDome");e="attribute vec4 a_Position;\nattribute vec2 a_Texcoord0;\nuniform mat4 u_MvpMatrix;\nvarying vec2 v_Texcoord;\n\n\nvoid main()\n{\n  gl_Position = (u_MvpMatrix*a_Position).xyww;\n  v_Texcoord = a_Texcoord0;\n}\n",t="#ifdef HIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\nuniform float u_Intensity;\nuniform float u_AlphaBlending;\nuniform sampler2D u_texture;\n\nvarying vec2 v_Texcoord;\n\n\nvoid main()\n{\t\n  gl_FragColor=vec4(texture2D(u_texture, v_Texcoord).rgb*u_Intensity,u_AlphaBlending);\n}\n\n",ci.add(m,e,t,i,n),i={a_Position:0,a_Normal:3,a_Texcoord0:2,a_Texcoord1:15},n={u_MvpMatrix:[1,2],u_WorldMat:[0,2],u_LightmapScaleOffset:[2,2],u_LightMap:[3,2],u_SplatAlphaTexture:[0,1],u_NormalTexture:[1,1],u_DiffuseTexture1:[2,1],u_DiffuseTexture2:[3,1],u_DiffuseTexture3:[4,1],u_DiffuseTexture4:[5,1],u_DiffuseScale1:[6,1],u_DiffuseScale2:[7,1],u_DiffuseScale3:[8,1],u_DiffuseScale4:[9,1],u_MaterialDiffuse:[11,1],u_MaterialAmbient:[10,1],u_MaterialSpecular:[12,1],u_CameraPos:[0,3],u_FogStart:[1,4],u_FogRange:[2,4],u_FogColor:[0,4],"u_DirectionLight.Direction":[3,4],"u_DirectionLight.Diffuse":[4,4],"u_PointLight.Position":[5,4],"u_PointLight.Range":[6,4],"u_PointLight.Attenuation":[7,4],"u_PointLight.Diffuse":[8,4],"u_SpotLight.Position":[9,4],"u_SpotLight.Direction":[10,4],"u_SpotLight.Range":[12,4],"u_SpotLight.Spot":[11,4],"u_SpotLight.Attenuation":[13,4],"u_SpotLight.Diffuse":[14,4],u_AmbientColor:[21,4],u_shadowMap1:[18,4],u_shadowMap2:[19,4],u_shadowMap3:[20,4],u_shadowPSSMDistance:[15,4],u_lightShadowVP:[16,4],u_shadowPCFoffset:[17,4]};var f=Oi.nameKey.add("Terrain");e="attribute vec4 a_Position;\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(LIGHTMAP)\n\tattribute vec3 a_Normal;\n\tvarying vec3 v_Normal;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||(defined(RECEIVESHADOW)&&defined(SHADOWMAP_PSSM1))\n\tuniform mat4 u_WorldMat;\n\tvarying vec3 v_PositionWorld;\n#endif\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n  #ifdef SHADOWMAP_PSSM1 \n  varying vec4 v_lightMVPPos;\n  uniform mat4 u_lightShadowVP[4];\n  #endif\n#endif\n\n#ifdef LIGHTMAP\n\tuniform vec4 u_LightmapScaleOffset;\n\tvarying vec2 v_LightMapUV;\n#endif\n\nattribute vec2 a_Texcoord0;\nattribute vec2 a_Texcoord1;\nvarying vec2 v_Texcoord0;\nvarying vec2 v_Texcoord1;\nuniform mat4 u_MvpMatrix;\n\nvoid main()\n{\n\tgl_Position = u_MvpMatrix * a_Position;\n\tv_Texcoord0=a_Texcoord0;\n\tv_Texcoord1=a_Texcoord1;\n\t\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\tv_Normal=a_Normal;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||(defined(RECEIVESHADOW)&&defined(SHADOWMAP_PSSM1))\n\tv_PositionWorld=(u_WorldMat*a_Position).xyz;\n#endif\n\n#ifdef LIGHTMAP\n\t//这个地方使用a_Normal 并不是真的代表normal，其实凑巧法线图的uv正好是符合 light_Map的UV\n\tv_LightMapUV=vec2(a_Normal.x*u_LightmapScaleOffset.x+u_LightmapScaleOffset.z,(a_Normal.y-1.0)*u_LightmapScaleOffset.y+u_LightmapScaleOffset.w);\n#endif\n\n#ifdef RECEIVESHADOW\n\tv_posViewZ = gl_Position.w;\n\t#ifdef SHADOWMAP_PSSM1\n\t\tv_lightMVPPos = u_lightShadowVP[0] * vec4(v_PositionWorld,1.0);\n\t#endif\n#endif\n\n}",t='#ifdef HIGHPRECISION\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\n#include "LightHelper.glsl";\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\tuniform vec3 u_MaterialDiffuse;\n\tuniform vec4 u_MaterialSpecular;\n\tuniform vec3 u_CameraPos;\n\tvarying vec3 v_Normal;\n\tvarying vec3 v_PositionWorld;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(LIGHTMAP)\n\tuniform vec3 u_MaterialAmbient;\n#endif\n\n#ifdef FOG\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\tuniform vec3 u_FogColor;\n#endif\n\n\n#ifdef DIRECTIONLIGHT\n\tuniform DirectionLight u_DirectionLight;\n#endif\n\n#ifdef POINTLIGHT\n\tuniform PointLight u_PointLight;\n#endif\n\n#ifdef SPOTLIGHT\n\tuniform SpotLight u_SpotLight;\n#endif\n\nuniform vec3 u_AmbientColor;\n\n#include "ShadowHelper.glsl"\n#ifdef RECEIVESHADOW\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\nvarying float v_posViewZ;\n\n\nuniform sampler2D u_SplatAlphaTexture;\nuniform sampler2D u_NormalTexture;\nuniform sampler2D u_DiffuseTexture1;\nuniform sampler2D u_DiffuseTexture2;\nuniform sampler2D u_DiffuseTexture3;\nuniform sampler2D u_DiffuseTexture4;\nuniform vec2 u_DiffuseScale1;\nuniform vec2 u_DiffuseScale2;\nuniform vec2 u_DiffuseScale3;\nuniform vec2 u_DiffuseScale4;\nvarying vec2 v_Texcoord0;\nvarying vec2 v_Texcoord1;\n\n#ifdef LIGHTMAP\n\tuniform sampler2D u_LightMap;\n\tvarying vec2 v_LightMapUV;\n#endif\n\nvoid main()\n{\n#ifdef DETAIL_NUM1\n\tvec4 color1 = texture2D(u_DiffuseTexture1, v_Texcoord1/u_DiffuseScale1);\n\tvec4 splatAlpha = texture2D(u_SplatAlphaTexture, v_Texcoord0);\n\tgl_FragColor.xyz = color1.xyz;\n#endif\n#ifdef DETAIL_NUM2\n\tvec4 color1 = texture2D(u_DiffuseTexture1, v_Texcoord1/u_DiffuseScale1);\n\tvec4 color2 = texture2D(u_DiffuseTexture2, v_Texcoord1/u_DiffuseScale2);\n\tvec4 splatAlpha = texture2D(u_SplatAlphaTexture, v_Texcoord0);\n\tgl_FragColor.xyz = color1.xyz * (1.0-splatAlpha.r) + color2.xyz * splatAlpha.r;\n#endif\n#ifdef DETAIL_NUM3\n\tvec4 color1 = texture2D(u_DiffuseTexture1, v_Texcoord1/u_DiffuseScale1);\n\tvec4 color2 = texture2D(u_DiffuseTexture2, v_Texcoord1/u_DiffuseScale2);\n\tvec4 color3 = texture2D(u_DiffuseTexture3, v_Texcoord1/u_DiffuseScale3);\n\tvec4 splatAlpha = texture2D(u_SplatAlphaTexture, v_Texcoord0);\n\tgl_FragColor.xyz = color1.xyz * (1.0-(splatAlpha.r+splatAlpha.g)) + color2.xyz * splatAlpha.r + color3.xyz * splatAlpha.g;\n#endif\n#ifdef DETAIL_NUM4\n\tvec4 color1 = texture2D(u_DiffuseTexture1, v_Texcoord1/u_DiffuseScale1);\n\tvec4 color2 = texture2D(u_DiffuseTexture2, v_Texcoord1/u_DiffuseScale2);\n\tvec4 color3 = texture2D(u_DiffuseTexture3, v_Texcoord1/u_DiffuseScale3);\n\tvec4 color4 = texture2D(u_DiffuseTexture4, v_Texcoord1/u_DiffuseScale4);\n\tvec4 splatAlpha = texture2D(u_SplatAlphaTexture, v_Texcoord0);\n\tgl_FragColor.xyz = color1.xyz * (1.0-(splatAlpha.r+splatAlpha.g+splatAlpha.b))+ color2.xyz * splatAlpha.r + color3.xyz * splatAlpha.g + color4.xyz * splatAlpha.b;\n#endif\n\tgl_FragColor.w = splatAlpha.a;\n\t\t\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n    vec3 normal = texture2D(u_NormalTexture,v_Normal.xy).xyz;\n\tnormal = normal*2.0 - vec3(1.0);\n\tvec3 diffuse = vec3(0.0);\n\tvec3 ambient = vec3(0.0);\n\tvec3 specular= vec3(0.0);\n\tvec3 dif, amb, spe;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)\n\tvec3 toEye;\n\t#ifdef FOG\n\t\ttoEye=u_CameraPos-v_PositionWorld;\n\t\tfloat toEyeLength=length(toEye);\n\t\ttoEye/=toEyeLength;\n\t#else\n\t\ttoEye=normalize(u_CameraPos-v_PositionWorld);\n\t#endif\n#endif\n\n#ifdef DIRECTIONLIGHT\n\tcomputeDirectionLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_DirectionLight,u_AmbientColor,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n \n#ifdef POINTLIGHT\n\tcomputePointLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_PointLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef SPOTLIGHT\n\tComputeSpotLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_SpotLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef RECEIVESHADOW\n\tfloat shadowValue = 1.0;\n\t#ifdef SHADOWMAP_PSSM3\n\t\tshadowValue = getShadowPSSM3( u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif\n\t#ifdef SHADOWMAP_PSSM2\n\t\tshadowValue = getShadowPSSM2( u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif \n\t#ifdef SHADOWMAP_PSSM1\n\t\tshadowValue = getShadowPSSM1( u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.001);\n\t#endif\n#endif\n\n#ifdef LIGHTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient + texture2D(u_LightMap, v_LightMapUV).rgb);\n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient + texture2D(u_LightMap, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient + texture2D(u_LightMap, v_LightMapUV).rgb);\n\t\t#endif\n\t#endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t#ifdef RECEIVESHADOW\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse*shadowValue) + specular * shadowValue,gl_FragColor.a);\n\t#else\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse) + specular, gl_FragColor.a);\n\t#endif\n#endif\n\n#ifdef FOG\n\tfloat lerpFact=clamp((toEyeLength-u_FogStart)/u_FogRange,0.0,1.0);\n\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n#endif\n}\n\n';var g=ci.add(f,e,t,i,n);Gi.SHADERDEFINE_DETAIL_NUM1=g.registerMaterialDefine("DETAIL_NUM1"),Gi.SHADERDEFINE_DETAIL_NUM2=g.registerMaterialDefine("DETAIL_NUM2"),Gi.SHADERDEFINE_DETAIL_NUM4=g.registerMaterialDefine("DETAIL_NUM4"),Gi.SHADERDEFINE_DETAIL_NUM3=g.registerMaterialDefine("DETAIL_NUM3"),i={a_Position:0,a_Normal:3,a_Texcoord0:2},n={u_MvpMatrix:[1,2],u_WorldMat:[0,2],u_CameraPos:[0,3],u_LightmapScaleOffset:[2,2],u_LightMap:[3,2],u_SplatAlphaTexture:[0,1],u_DiffuseTexture1:[1,1],u_DiffuseTexture2:[2,1],u_DiffuseTexture3:[3,1],u_DiffuseTexture4:[4,1],u_DiffuseTexture5:[5,1],u_DiffuseScaleOffset1:[6,1],u_DiffuseScaleOffset2:[7,1],u_DiffuseScaleOffset3:[8,1],u_DiffuseScaleOffset4:[9,1],u_DiffuseScaleOffset5:[10,1],u_MaterialAlbedo:[14,1],u_MaterialDiffuse:[12,1],u_MaterialAmbient:[11,1],u_MaterialSpecular:[13,1],u_FogStart:[1,4],u_FogRange:[2,4],u_FogColor:[0,4],"u_DirectionLight.Direction":[3,4],"u_DirectionLight.Diffuse":[4,4],"u_PointLight.Position":[5,4],"u_PointLight.Range":[6,4],"u_PointLight.Attenuation":[7,4],"u_PointLight.Diffuse":[8,4],"u_SpotLight.Position":[9,4],"u_SpotLight.Direction":[10,4],"u_SpotLight.Range":[12,4],"u_SpotLight.Spot":[11,4],"u_SpotLight.Attenuation":[13,4],"u_SpotLight.Diffuse":[14,4],u_AmbientColor:[21,4],u_shadowMap1:[18,4],u_shadowMap2:[19,4],u_shadowMap3:[20,4],u_shadowPSSMDistance:[15,4],u_lightShadowVP:[16,4],u_shadowPCFoffset:[17,4]};var y=Oi.nameKey.add("ExtendTerrain");e="attribute vec4 a_Position;\nattribute vec2 a_Texcoord0;\n\nuniform mat4 u_MvpMatrix;\n\nvarying vec2 v_Texcoord0;\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(LIGHTMAP)\n\tattribute vec3 a_Normal;\n\tvarying vec3 v_Normal;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||(defined(RECEIVESHADOW)&&defined(SHADOWMAP_PSSM1))\n\tuniform mat4 u_WorldMat;\n\tvarying vec3 v_PositionWorld;\n#endif\n\n#ifdef LIGHTMAP\n\tvarying vec2 v_LightMapUV;\n\tuniform vec4 u_LightmapScaleOffset;\n#endif\n\n#ifdef RECEIVESHADOW\n\tvarying float v_posViewZ;\n\t#ifdef SHADOWMAP_PSSM1 \n\t\tvarying vec4 v_lightMVPPos;\n\t\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n#endif\n\nvoid main()\n{\n\tgl_Position = u_MvpMatrix * a_Position;\n  \n\tv_Texcoord0 = a_Texcoord0;\n  \n\t#ifdef LIGHTMAP\n\t\tv_LightMapUV = vec2(a_Texcoord0.x*u_LightmapScaleOffset.x+u_LightmapScaleOffset.z,(a_Texcoord0.y-1.0)*u_LightmapScaleOffset.y+u_LightmapScaleOffset.w);\n\t#endif\n  \n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tv_Normal = a_Normal;\n\t#endif\n\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||(defined(RECEIVESHADOW)&&defined(SHADOWMAP_PSSM1))\n\t\tv_PositionWorld=(u_WorldMat*a_Position).xyz;\n\t#endif\n\n\t#ifdef RECEIVESHADOW\n\t\tv_posViewZ = gl_Position.w;\n\t\t#ifdef SHADOWMAP_PSSM1\n\t\t\tv_lightMVPPos = u_lightShadowVP[0] * vec4(v_PositionWorld,1.0);\n\t\t#endif\n\t#endif\n}",t='#ifdef HIGHPRECISION\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\n#include "LightHelper.glsl";\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)\n\tuniform vec3 u_MaterialDiffuse;\n\tuniform vec4 u_MaterialSpecular;\n\tuniform vec3 u_CameraPos;\n\tvarying vec3 v_Normal;\n\tvarying vec3 v_PositionWorld;\n#endif\n\n#ifdef FOG\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\tuniform vec3 u_FogColor;\n#endif\n\n\n#ifdef DIRECTIONLIGHT\n\tuniform DirectionLight u_DirectionLight;\n#endif\n\n#ifdef POINTLIGHT\n\tuniform PointLight u_PointLight;\n#endif\n\n#ifdef SPOTLIGHT\n\tuniform SpotLight u_SpotLight;\n#endif\n\nuniform vec3 u_AmbientColor;\n\n#include "ShadowHelper.glsl"\n#ifdef RECEIVESHADOW\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\nvarying float v_posViewZ;\n\n\nuniform sampler2D u_SplatAlphaTexture;\n\nuniform sampler2D u_DiffuseTexture1;\nuniform sampler2D u_DiffuseTexture2;\nuniform sampler2D u_DiffuseTexture3;\nuniform sampler2D u_DiffuseTexture4;\nuniform sampler2D u_DiffuseTexture5;\n\nuniform vec4 u_DiffuseScaleOffset1;\nuniform vec4 u_DiffuseScaleOffset2;\nuniform vec4 u_DiffuseScaleOffset3;\nuniform vec4 u_DiffuseScaleOffset4;\nuniform vec4 u_DiffuseScaleOffset5;\n\nvarying vec2 v_Texcoord0;\n\nuniform vec3 u_MaterialAmbient;\nuniform vec4 u_MaterialAlbedo;\n\n#ifdef LIGHTMAP\n\tuniform sampler2D u_LightMap;\n\tvarying vec2 v_LightMapUV;\n#endif\n\nvoid main()\n{\n\t#ifdef ExtendTerrain_DETAIL_NUM1\n\t\tvec4 splatAlpha = texture2D(u_SplatAlphaTexture, v_Texcoord0);\n\t\tvec4 color1 = texture2D(u_DiffuseTexture1, v_Texcoord0 * u_DiffuseScaleOffset1.xy);\n\t\tgl_FragColor.xyz = color1.xyz * splatAlpha.r;\n\t#endif\n\t#ifdef ExtendTerrain_DETAIL_NUM2\n\t\tvec4 splatAlpha = texture2D(u_SplatAlphaTexture, v_Texcoord0);\n\t\tvec4 color1 = texture2D(u_DiffuseTexture1, v_Texcoord0 * u_DiffuseScaleOffset1.xy);\n\t\tvec4 color2 = texture2D(u_DiffuseTexture2, v_Texcoord0 * u_DiffuseScaleOffset2.xy);\n\t\tgl_FragColor.xyz = color1.xyz * splatAlpha.r + color2.xyz * (1.0 - splatAlpha.r);\n\t#endif\n\t#ifdef ExtendTerrain_DETAIL_NUM3\n\t\tvec4 splatAlpha = texture2D(u_SplatAlphaTexture, v_Texcoord0);\n\t\tvec4 color1 = texture2D(u_DiffuseTexture1, v_Texcoord0 * u_DiffuseScaleOffset1.xy);\n\t\tvec4 color2 = texture2D(u_DiffuseTexture2, v_Texcoord0 * u_DiffuseScaleOffset2.xy);\n\t\tvec4 color3 = texture2D(u_DiffuseTexture3, v_Texcoord0 * u_DiffuseScaleOffset3.xy);\n\t\tgl_FragColor.xyz = color1.xyz * splatAlpha.r  + color2.xyz * splatAlpha.g + color3.xyz * (1.0 - splatAlpha.r - splatAlpha.g);\n\t#endif\n\t#ifdef ExtendTerrain_DETAIL_NUM4\n\t\tvec4 splatAlpha = texture2D(u_SplatAlphaTexture, v_Texcoord0);\n\t\tvec4 color1 = texture2D(u_DiffuseTexture1, v_Texcoord0 * u_DiffuseScaleOffset1.xy);\n\t\tvec4 color2 = texture2D(u_DiffuseTexture2, v_Texcoord0 * u_DiffuseScaleOffset2.xy);\n\t\tvec4 color3 = texture2D(u_DiffuseTexture3, v_Texcoord0 * u_DiffuseScaleOffset3.xy);\n\t\tvec4 color4 = texture2D(u_DiffuseTexture4, v_Texcoord0 * u_DiffuseScaleOffset4.xy);\n\t\tgl_FragColor.xyz = color1.xyz * splatAlpha.r  + color2.xyz * splatAlpha.g + color3.xyz * splatAlpha.b + color4.xyz * (1.0 - splatAlpha.r - splatAlpha.g - splatAlpha.b);\n\t#endif\n\t#ifdef ExtendTerrain_DETAIL_NUM5\n\t\tvec4 splatAlpha = texture2D(u_SplatAlphaTexture, v_Texcoord0);\n\t\tvec4 color1 = texture2D(u_DiffuseTexture1, v_Texcoord0 * u_DiffuseScaleOffset1.xy);\n\t\tvec4 color2 = texture2D(u_DiffuseTexture2, v_Texcoord0 * u_DiffuseScaleOffset2.xy);\n\t\tvec4 color3 = texture2D(u_DiffuseTexture3, v_Texcoord0 * u_DiffuseScaleOffset3.xy);\n\t\tvec4 color4 = texture2D(u_DiffuseTexture4, v_Texcoord0 * u_DiffuseScaleOffset4.xy);\n\t\tvec4 color5 = texture2D(u_DiffuseTexture5, v_Texcoord0 * u_DiffuseScaleOffset5.xy);\n\t\tgl_FragColor.xyz = color1.xyz * splatAlpha.r  + color2.xyz * splatAlpha.g + color3.xyz * splatAlpha.b + color4.xyz * splatAlpha.a + color5.xyz * (1.0 - splatAlpha.r - splatAlpha.g - splatAlpha.b - splatAlpha.a);\n\t#endif\n\t\tgl_FragColor.w = splatAlpha.a;\n\t\t\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n    vec3 normal = v_Normal;\n\tvec3 diffuse = vec3(0.0);\n\tvec3 ambient = vec3(0.0);\n\tvec3 specular= vec3(0.0);\n\tvec3 dif, amb, spe;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)\n\tvec3 toEye;\n\t#ifdef FOG\n\t\ttoEye=u_CameraPos-v_PositionWorld;\n\t\tfloat toEyeLength=length(toEye);\n\t\ttoEye/=toEyeLength;\n\t#else\n\t\ttoEye=normalize(u_CameraPos-v_PositionWorld);\n\t#endif\n#endif\n\n#ifdef DIRECTIONLIGHT\n\tcomputeDirectionLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_DirectionLight,u_AmbientColor,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n \n#ifdef POINTLIGHT\n\tcomputePointLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_PointLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef SPOTLIGHT\n\tComputeSpotLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_SpotLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef RECEIVESHADOW\n\tfloat shadowValue = 1.0;\n\t#ifdef SHADOWMAP_PSSM3\n\t\tshadowValue = getShadowPSSM3( u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif\n\t#ifdef SHADOWMAP_PSSM2\n\t\tshadowValue = getShadowPSSM2( u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif \n\t#ifdef SHADOWMAP_PSSM1\n\t\tshadowValue = getShadowPSSM1( u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.001);\n\t#endif\n#endif\n\n#ifdef LIGHTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient + texture2D(u_LightMap, v_LightMapUV).rgb);\n\t#else\n\t\t#if defined(RECEIVESHADOW)\t\t\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb * shadowValue);\n\t\t\t//vec3 tColor= u_MaterialAmbient + texture2D(u_LightMap, v_LightMapUV).rgb * shadowValue + mix(vec3(0.15,0.15,0.15),vec3(0.0),shadowValue);\n\t\t\t//gl_FragColor.rgb*=tColor;\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient + texture2D(u_LightMap, v_LightMapUV).rgb);\n\t\t#endif\n\t#endif\n#endif\n\ngl_FragColor=gl_FragColor*u_MaterialAlbedo;\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t#ifdef RECEIVESHADOW\n\t\tgl_FragColor = vec4( gl_FragColor.rgb*(ambient + diffuse*shadowValue) + specular * shadowValue,gl_FragColor.a);\n\t#else\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse) + specular, gl_FragColor.a);\n\t#endif\n#endif\n\n#ifdef FOG\n\tfloat lerpFact=clamp((toEyeLength-u_FogStart)/u_FogRange,0.0,1.0);\n\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n#endif\n}\n\n\n\n\n\n';var v=ci.add(y,e,t,i,n);v.addSpriteDefines(un.shaderDefines),v.addMaterialDefines(Ui.shaderDefines),i={a_Position:0,a_OffsetVector:41,a_Texcoord0X:38,a_Texcoord0Y:40,a_BirthTime:33},n={u_MvpMatrix:[1,2],u_VMatrix:[1,3],u_PMatrix:[2,3],u_TilingOffset:[3,1],u_MainTexture:[1,1],u_MainColor:[2,1],u_CurTime:[3,2],u_LifeTime:[4,2],u_WidthCurve:[5,2],u_WidthCurveKeyLength:[6,2],u_GradientColorkey:[7,2],u_GradientAlphakey:[8,2]};var x=Oi.nameKey.add("Trail");e="attribute vec3 a_Position;\nattribute vec3 a_OffsetVector;\nattribute vec4 a_Color;\nattribute float a_Texcoord0X;\nattribute float a_Texcoord0Y;\nattribute float a_BirthTime;\n\nuniform mat4 u_VMatrix;\nuniform mat4 u_PMatrix;\n\nuniform vec4 u_TilingOffset;\n\nuniform float u_CurTime;\nuniform float u_LifeTime;\nuniform vec4 u_WidthCurve[10];\nuniform int u_WidthCurveKeyLength;\n\nuniform vec4 u_GradientColorkey[10];\nuniform vec2 u_GradientAlphakey[10];\n\nvarying vec2 v_Texcoord0;\nvarying vec4 v_Color;\n\nfloat hermiteInterpolate(float t, float outTangent, float inTangent, float duration, float value1, float value2)\n{\n\tfloat t2 = t * t;\n\tfloat t3 = t2 * t;\n\tfloat a = 2.0 * t3 - 3.0 * t2 + 1.0;\n\tfloat b = t3 - 2.0 * t2 + t;\n\tfloat c = t3 - t2;\n\tfloat d = -2.0 * t3 + 3.0 * t2;\n\treturn a * value1 + b * outTangent * duration + c * inTangent * duration + d * value2;\n}\n\nfloat getCurWidth(in float normalizeTime)\n{\n\tif(normalizeTime == 0.0){\n\t\treturn u_WidthCurve[0].w;\n\t}\n\telse if(normalizeTime >= 1.0){\n\t\treturn u_WidthCurve[u_WidthCurveKeyLength - 1].w;\n\t}\n\telse{\n\t\tfor(int i = 0; i < 10; i ++ )\n\t\t{\n\t\t\tif(normalizeTime == u_WidthCurve[i].x)\n\t\t\t{\n\t\t\t\treturn u_WidthCurve[i].w;\n\t\t\t}\n\t\t\t\n\t\t\tvec4 lastFrame = u_WidthCurve[i];\n\t\t\tvec4 nextFrame = u_WidthCurve[i + 1];\n\t\t\tif(normalizeTime > lastFrame.x && normalizeTime < nextFrame.x)\n\t\t\t{\n\t\t\t\tfloat duration = nextFrame.x - lastFrame.x;\n\t\t\t\tfloat t = (normalizeTime - lastFrame.x) / duration;\n\t\t\t\tfloat outTangent = lastFrame.z;\n\t\t\t\tfloat inTangent = nextFrame.y;\n\t\t\t\tfloat value1 = lastFrame.w;\n\t\t\t\tfloat value2 = nextFrame.w;\n\t\t\t\treturn hermiteInterpolate(t, outTangent, inTangent, duration, value1, value2);\n\t\t\t}\n\t\t}\t\n\t}\n}\t\n\nvec4 getColorFromGradientByBlend(in vec4 gradientColors[10], in vec2 gradientAlphas[10], in float normalizeTime)\n{\n\tvec4 color;\n\tfor(int i = 1; i < 10; i++)\n\t{\n\t\tvec4 gradientColor = gradientColors[i];\n\t\tfloat colorKey = gradientColor.w;\n\t\tif(colorKey >= normalizeTime)\n\t\t{\n\t\t\tvec4 lastGradientColor = gradientColors[i-1];\n\t\t\tfloat lastColorKey = lastGradientColor.w;\n\t\t\tfloat age = (normalizeTime - lastColorKey) / (colorKey - lastColorKey);\n\t\t\tcolor.rgb = mix(gradientColors[i-1].xyz, gradientColor.xyz, age);\n\t\t\tbreak;\n\t\t}\n\t}\n\tfor(int i = 1; i < 10; i++)\n\t{\n\t\tvec2 gradientAlpha = gradientAlphas[i];\n\t\tfloat alphaKey = gradientAlpha.y;\n\t\tif(alphaKey >= normalizeTime)\n\t\t{\n\t\t\tvec2 lastGradientAlpha = gradientAlphas[i-1];\n\t\t\tfloat lastAlphaKey = lastGradientAlpha.y;\n\t\t\tfloat age = (normalizeTime - lastAlphaKey) / (alphaKey - lastAlphaKey);\n\t\t\tcolor.a = mix(lastGradientAlpha.x, gradientAlpha.x, age);\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn color;\n}\n\nvec4 getColorFromGradientByFixed(in vec4 gradientColors[10], in vec2 gradientAlphas[10], in float normalizeTime)\n{\n\tvec4 color;\n\tfor(int i = 1; i < 10; i++)\n\t{\n\t\tvec4 gradientColor = gradientColors[i];\n\t\tif(gradientColor.w >= normalizeTime)\n\t\t{\n\t\t\tcolor.rgb = gradientColor.xyz;\n\t\t\tbreak;\n\t\t}\n\t}\n\tfor(int i = 1; i < 10; i++)\n\t{\n\t\tvec2 gradientAlpha = gradientAlphas[i];\n\t\tif(gradientAlpha.y >= normalizeTime)\n\t\t{\n\t\t\tcolor.a = gradientAlpha.x;\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn color;\n}\n\nvoid main()\n{\n\tfloat normalizeTime = (u_CurTime - a_BirthTime) / u_LifeTime;\n\t\n\tgl_Position = u_PMatrix * u_VMatrix * vec4(a_Position + a_OffsetVector * getCurWidth(normalizeTime),1.0);\n\t\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0 = (vec2(a_Texcoord0X, a_Texcoord0Y) * u_TilingOffset.xy) + u_TilingOffset.zw;\n\t#else\n\t\tv_Texcoord0 = vec2(a_Texcoord0X, a_Texcoord0Y);\n\t#endif\n\t\n\t#ifdef GRADIENTMODE_BLEND\n\t\tv_Color = getColorFromGradientByBlend(u_GradientColorkey, u_GradientAlphakey, normalizeTime);\n\t#else\n\t\tv_Color = getColorFromGradientByFixed(u_GradientColorkey, u_GradientAlphakey, normalizeTime);\n\t#endif\n}\n\n\n\n",t="#ifdef HIGHPRECISION\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\nuniform sampler2D u_MainTexture;\nuniform vec4 u_MainColor;\n\nvarying vec2 v_Texcoord0;\nvarying vec4 v_Color;\n\nvoid main()\n{\t\n\tvec4 color = 2.0 * u_MainColor * v_Color;\n\t#ifdef DIFFUSETEXTURE\n\t\tvec4 mainTextureColor = texture2D(u_MainTexture, v_Texcoord0);\n\t\tcolor *= mainTextureColor;\n\t#endif\n\tgl_FragColor = color;\n}\n\n";var b=ci.add(x,e,t,i,n);Ji.SHADERDEFINE_DIFFUSETEXTURE=b.registerMaterialDefine("DIFFUSETEXTURE"),Ji.SHADERDEFINE_TILINGOFFSET=b.registerSpriteDefine("TILINGOFFSET"),xn.SHADERDEFINE_GRADIENTMODE_BLEND=b.registerSpriteDefine("GRADIENTMODE_BLEND")},e}(),Ft=function(){function e(){this._data=null,this._data=[]}a(e,"laya.d3.shader.ValusArray");var t=e.prototype;return t.setValue=function(e,t){this._data[e]=t},r(0,t,"data",function(){return this._data}),e}(),Ht=function(){function e(){this._currentPSSM=-1,this._numberOfPSSM=3,this._maxDistance=200,this._ratioOfDistance=1/this._numberOfPSSM,this._statesDirty=!0,this._lightCulling=null,this._renderTarget=null,this._lightVPMatrix=null,this._lightCameras=null,this._shadowQuenes=null,this._shadowMapTextureSize=1024,this._scene=null,this._PCFType=0,this._shaderValueLightVP=null,this._shaderValueVPs=null,this._spiltDistance=new Array(4),this._globalParallelLightDir=new At(0,-1,0),this._boundingSphere=new Array(4),this._boundingBox=new Array(4),this._frustumPos=new Array(16),this._uniformDistance=new Array(4),this._logDistance=new Array(4),this._dimension=new Array(4),this._tempLookAt3=new At,this._tempLookAt4=new Rt,this._tempValue=new Rt,this._tempPos=new At,this._tempLightUp=new At,this._tempMin=new Rt,this._tempMax=new Rt,this._tempMatrix44=new Ct,this._splitFrustumCulling=new bt(Ct.DEFAULT),this._tempScaleMatrix44=new Ct,this._shadowPCFOffset=new Nt(1/1024,1/1024),this._shaderValueDistance=new Rt;var e=0;for(e=0;e<this._spiltDistance.length;e++)this._spiltDistance[e]=0;for(e=0;e<this._dimension.length;e++)this._dimension[e]=new Nt;for(e=0;e<this._frustumPos.length;e++)this._frustumPos[e]=new At;for(e=0;e<this._boundingBox.length;e++)this._boundingBox[e]=new xt(new At,new At);for(e=0;e<this._boundingSphere.length;e++)this._boundingSphere[e]=new wt(new At,0);Ct.createScaling(new At(.5,.5,1),this._tempScaleMatrix44),this._tempScaleMatrix44.elements[12]=.5,this._tempScaleMatrix44.elements[13]=.5}a(e,"laya.d3.shadowMap.ParallelSplitShadowMap");var t=e.prototype;return t.setInfo=function(e,t,i,n,a,r){a>3&&(this._numberOfPSSM=3),this._scene=e,this._maxDistance=t,this.PSSMNum=a,this._globalParallelLightDir=i,this._ratioOfDistance=1/this._numberOfPSSM;for(var o=0;o<this._spiltDistance.length;o++)this._spiltDistance[o]=0;this._shadowMapTextureSize=n,this._shadowPCFOffset.x=1/this._shadowMapTextureSize,this._shadowPCFOffset.y=1/this._shadowMapTextureSize,this.setPCFType(r),this._statesDirty=!0},t.setPCFType=function(e){switch(this._PCFType=e,this._PCFType){case 0:this._scene.addShaderDefine(laya.d3.shadowMap.ParallelSplitShadowMap.SHADERDEFINE_SHADOW_PCF_NO),this._scene.removeShaderDefine(laya.d3.shadowMap.ParallelSplitShadowMap.SHADERDEFINE_SHADOW_PCF1),this._scene.removeShaderDefine(laya.d3.shadowMap.ParallelSplitShadowMap.SHADERDEFINE_SHADOW_PCF2),this._scene.removeShaderDefine(laya.d3.shadowMap.ParallelSplitShadowMap.SHADERDEFINE_SHADOW_PCF3);break;case 1:this._scene.addShaderDefine(laya.d3.shadowMap.ParallelSplitShadowMap.SHADERDEFINE_SHADOW_PCF1),this._scene.removeShaderDefine(laya.d3.shadowMap.ParallelSplitShadowMap.SHADERDEFINE_SHADOW_PCF_NO),this._scene.removeShaderDefine(laya.d3.shadowMap.ParallelSplitShadowMap.SHADERDEFINE_SHADOW_PCF2),this._scene.removeShaderDefine(laya.d3.shadowMap.ParallelSplitShadowMap.SHADERDEFINE_SHADOW_PCF3);break;case 2:this._scene.addShaderDefine(laya.d3.shadowMap.ParallelSplitShadowMap.SHADERDEFINE_SHADOW_PCF2),this._scene.removeShaderDefine(laya.d3.shadowMap.ParallelSplitShadowMap.SHADERDEFINE_SHADOW_PCF_NO),this._scene.removeShaderDefine(laya.d3.shadowMap.ParallelSplitShadowMap.SHADERDEFINE_SHADOW_PCF1),this._scene.removeShaderDefine(laya.d3.shadowMap.ParallelSplitShadowMap.SHADERDEFINE_SHADOW_PCF3);break;case 3:this._scene.addShaderDefine(laya.d3.shadowMap.ParallelSplitShadowMap.SHADERDEFINE_SHADOW_PCF3),this._scene.removeShaderDefine(laya.d3.shadowMap.ParallelSplitShadowMap.SHADERDEFINE_SHADOW_PCF_NO),this._scene.removeShaderDefine(laya.d3.shadowMap.ParallelSplitShadowMap.SHADERDEFINE_SHADOW_PCF1),this._scene.removeShaderDefine(laya.d3.shadowMap.ParallelSplitShadowMap.SHADERDEFINE_SHADOW_PCF2)}},t.getPCFType=function(){return this._PCFType},t.setFarDistance=function(e){this._maxDistance!=e&&(this._maxDistance=e,this._statesDirty=!0)},t.getFarDistance=function(){return this._maxDistance},t._setGlobalParallelLightDir=function(e){this._globalParallelLightDir=e},t.getGlobalParallelLightDir=function(){return this._globalParallelLightDir},t.getCurrentPSSM=function(){return this._currentPSSM},t.getLightCamera=function(e){return this._lightCameras[e]},t._beginSampler=function(e,t){if(e<0||e>this._numberOfPSSM)throw new Error("ParallelSplitShadowMap: beginSample invalid index");this._currentPSSM=e,this._update(t)},t.endSampler=function(e){this._currentPSSM=-1},t._calcAllLightCameraInfo=function(e){if(1===this._numberOfPSSM)this._beginSampler(0,e),this.endSampler(e);else for(var t=0,i=this._numberOfPSSM+1;t<i;t++)this._beginSampler(t,e),this.endSampler(e)},t._recalculate=function(e,t,i){this._calcSplitDistance(e),this._calcBoundingBox(t,i),this._rebuildRenderInfo()},t._update=function(e){var t=e.nearPlane,i=e.fieldOfView,n=e.aspectRatio;(this._statesDirty||this.lastNearPlane!==t||this.lastFieldOfView!==i||this.lastAspectRatio!==n)&&(this._recalculate(t,i,n),this._uploadShaderValue(),this._statesDirty=!1,this.lastNearPlane=t,this.lastFieldOfView=i,this.lastAspectRatio=n),this._calcLightViewProject(e)},t._uploadShaderValue=function(){var e=this._scene;switch(this._numberOfPSSM){case 1:e.addShaderDefine(laya.d3.shadowMap.ParallelSplitShadowMap.SHADERDEFINE_SHADOW_PSSM1),e.removeShaderDefine(laya.d3.shadowMap.ParallelSplitShadowMap.SHADERDEFINE_SHADOW_PSSM2),e.removeShaderDefine(laya.d3.shadowMap.ParallelSplitShadowMap.SHADERDEFINE_SHADOW_PSSM3);break;case 2:e.addShaderDefine(laya.d3.shadowMap.ParallelSplitShadowMap.SHADERDEFINE_SHADOW_PSSM2),e.removeShaderDefine(laya.d3.shadowMap.ParallelSplitShadowMap.SHADERDEFINE_SHADOW_PSSM1),e.removeShaderDefine(laya.d3.shadowMap.ParallelSplitShadowMap.SHADERDEFINE_SHADOW_PSSM3);break;case 3:e.addShaderDefine(laya.d3.shadowMap.ParallelSplitShadowMap.SHADERDEFINE_SHADOW_PSSM3),e.removeShaderDefine(laya.d3.shadowMap.ParallelSplitShadowMap.SHADERDEFINE_SHADOW_PSSM1),e.removeShaderDefine(laya.d3.shadowMap.ParallelSplitShadowMap.SHADERDEFINE_SHADOW_PSSM2)}var t=e._shaderValues;switch(t.setValue(15,this._shaderValueDistance.elements),t.setValue(16,this._shaderValueLightVP),t.setValue(17,this._shadowPCFOffset.elements),this._numberOfPSSM){case 3:t.setValue(18,this.getRenderTarget(1)),t.setValue(19,this.getRenderTarget(2)),t.setValue(20,this.getRenderTarget(3));break;case 2:t.setValue(18,this.getRenderTarget(1)),t.setValue(19,this.getRenderTarget(2));break;case 1:t.setValue(18,this.getRenderTarget(1))}},t._calcSplitDistance=function(e){var t=this._maxDistance,i=1/this._numberOfPSSM,n=0;for(n=0;n<=this._numberOfPSSM;n++)this._uniformDistance[n]=e+(t-e)*n*i;var a=t/e;for(n=0;n<=this._numberOfPSSM;n++){var r=Math.pow(a,n*i);this._logDistance[n]=e*r}for(n=0;n<=this._numberOfPSSM;n++)this._spiltDistance[n]=this._uniformDistance[n]*this._ratioOfDistance+this._logDistance[n]*(1-this._ratioOfDistance);this._shaderValueDistance.x=this._spiltDistance[1],this._shaderValueDistance.y=this._spiltDistance[2],this._shaderValueDistance.z=this._spiltDistance[3],this._shaderValueDistance.w=this._spiltDistance[4]},t._calcBoundingBox=function(e,t){var i=3.1415926*e/180,n=Math.tan(i/2),a=NaN,r=NaN,o=NaN,s=0;for(s=0;s<=this._numberOfPSSM;s++){r=(a=(o=this._spiltDistance[s])*n)*t;var h=this._frustumPos[4*s+0].elements;h[0]=-r,h[1]=-a,h[2]=-o,(h=this._frustumPos[4*s+1].elements)[0]=r,h[1]=-a,h[2]=-o,(h=this._frustumPos[4*s+2].elements)[0]=-r,h[1]=a,h[2]=-o,(h=this._frustumPos[4*s+3].elements)[0]=r,h[1]=a,h[2]=-o,(h=this._dimension[s].elements)[0]=r,h[1]=a}var l,c,p,u;for(s=1;s<=this._numberOfPSSM;s++)l=this._dimension[s].elements,(c=this._boundingBox[s].min.elements)[0]=-l[0],c[1]=-l[1],c[2]=-this._spiltDistance[s],(p=this._boundingBox[s].max.elements)[0]=l[0],p[1]=l[1],p[2]=-this._spiltDistance[s-1],(u=this._boundingSphere[s].center.elements)[0]=.5*(c[0]+p[0]),u[1]=.5*(c[1]+p[1]),u[2]=.5*(c[2]+p[2]),this._boundingSphere[s].radius=.5*Math.sqrt(Math.pow(p[0]-c[0],2)+Math.pow(p[1]-c[1],2)+Math.pow(p[2]-c[2],2));c=this._boundingBox[0].min.elements,l=this._dimension[this._numberOfPSSM].elements,c[0]=-l[0],c[1]=-l[1],c[2]=-this._spiltDistance[this._numberOfPSSM],(p=this._boundingBox[0].max.elements)[0]=l[0],p[1]=l[1],p[2]=-this._spiltDistance[0],(u=this._boundingSphere[0].center.elements)[0]=.5*(c[0]+p[0]),u[1]=.5*(c[1]+p[1]),u[2]=.5*(c[2]+p[2]),this._boundingSphere[0].radius=.5*Math.sqrt(Math.pow(p[0]-c[0],2)+Math.pow(p[1]-c[1],2)+Math.pow(p[2]-c[2],2))},t.calcSplitFrustum=function(e){this._currentPSSM>0?Ct.createPerspective(3.1416*e.fieldOfView/180,e.aspectRatio,this._spiltDistance[this._currentPSSM-1],this._spiltDistance[this._currentPSSM],this._tempMatrix44):Ct.createPerspective(3.1416*e.fieldOfView/180,e.aspectRatio,this._spiltDistance[0],this._spiltDistance[this._numberOfPSSM],this._tempMatrix44),Ct.multiply(this._tempMatrix44,e.viewMatrix,this._tempMatrix44),this._splitFrustumCulling.matrix=this._tempMatrix44},t._rebuildRenderInfo=function(){var e=this._numberOfPSSM+1,t=0;if(null==this._renderTarget)for(this._renderTarget=o(e),this._renderTarget[0]=null,t=1;t<e;t++)this._renderTarget[t]=new rn(this._shadowMapTextureSize,this._shadowMapTextureSize,6408,5121,33189,!1,!1,9728,9728);else if(this._renderTarget.length!=e)for(this.disposeAllRenderTarget(),this._renderTarget.length=e,this._renderTarget[0]=null,t=1;t<e;t++)this._renderTarget[t]=new rn(this._shadowMapTextureSize,this._shadowMapTextureSize,6408,5121,33189,!1,!1,9728,9728);else for(t=1;t<e;t++)null!=this._renderTarget[t]&&this._renderTarget[t].width==this._shadowMapTextureSize&&this._renderTarget[t].height==this._shadowMapTextureSize||(null!=this._renderTarget[t]&&this._renderTarget[t].destroy(),this._renderTarget[t]=new rn(this._shadowMapTextureSize,this._shadowMapTextureSize,6408,5121,33189,!1,!1,9728,9728));if(null==this._lightCulling||this._lightCulling.length!=e)for(this._lightCulling?this._lightCulling.length=e:this._lightCulling=o(e),t=0;t<this._lightCulling.length;t++)this._lightCulling[t]=new bt(Ct.DEFAULT);if(null==this._lightVPMatrix||this._lightVPMatrix.length!=e)for(this._lightVPMatrix?this._lightVPMatrix.length=e:this._lightVPMatrix=o(e),t=0;t<this._lightVPMatrix.length;t++)this._lightVPMatrix[t]=new Ct;if(null==this._lightCameras||this._lightCameras.length!=e)for(this._lightCameras?this._lightCameras.length=e:this._lightCameras=o(e),t=0;t<this._lightCameras.length;t++)this._lightCameras[t]=new mn,this._lightCameras[t].name="lightCamera"+t;if(null==this._shadowQuenes||this._shadowQuenes.length!=this._numberOfPSSM)for(this._shadowQuenes?this._shadowQuenes.length=this._numberOfPSSM:this._shadowQuenes=o(this._numberOfPSSM),t=0;t<this._shadowQuenes.length;t++)this._shadowQuenes[t]=new pe(this._scene);if(null==this._shaderValueVPs||this._shaderValueVPs.length!=e)for(this._shaderValueVPs?this._shaderValueVPs.length=e:this._shaderValueVPs=o(e),this._shaderValueLightVP=new Float32Array(16*e),t=0;t<e;t++)this._shaderValueVPs[t]=new Float32Array(this._shaderValueLightVP.buffer,64*t)},t._calcLightViewProject=function(t){var i=this._boundingSphere[this._currentPSSM],n=t.transform.worldMatrix;i.radius;i.center.cloneTo(this._tempLookAt3),At.transformV3ToV4(this._tempLookAt3,n,this._tempLookAt4);var a=this._tempLookAt3.elements,r=this._tempLookAt4.elements;a[0]=r[0],a[1]=r[1],a[2]=r[2];var o=this._tempLightUp.elements,s=t.forward.elements;o[0]=s[0],o[1]=1,o[2]=s[2],At.normalize(this._tempLightUp,this._tempLightUp),At.scale(this._globalParallelLightDir,4*i.radius,this._tempPos),At.subtract(this._tempLookAt3,this._tempPos,this._tempPos);var h=this._lightCameras[this._currentPSSM];h.transform.position=this._tempPos,h.transform.lookAt(this._tempLookAt3,this._tempLightUp,!1);var l=this._tempMax.elements,c=this._tempMin.elements;l[0]=l[1]=l[2]=-1e5,l[3]=1,c[0]=c[1]=c[2]=1e5,c[3]=1,Ct.multiply(h.viewMatrix,n,this._tempMatrix44);var p=this._tempValue.elements,u=[];u.length=8,this._boundingBox[this._currentPSSM].getCorners(u);for(var d=0;d<8;d++){var _=u[d].elements;p[0]=_[0],p[1]=_[1],p[2]=_[2],p[3]=1,Rt.transformByM4x4(this._tempValue,this._tempMatrix44,this._tempValue),c[0]=p[0]<c[0]?p[0]:c[0],c[1]=p[1]<c[1]?p[1]:c[1],c[2]=p[2]<c[2]?p[2]:c[2],l[0]=p[0]>l[0]?p[0]:l[0],l[1]=p[1]>l[1]?p[1]:l[1],l[2]=p[2]>l[2]?p[2]:l[2]}Rt.add(this._tempMax,this._tempMin,this._tempValue),p[0]*=.5,p[1]*=.5,p[2]*=.5,p[3]=1,Rt.transformByM4x4(this._tempValue,h.transform.worldMatrix,this._tempValue);var m=Math.abs(-this._tempMax.z),f=m>this._maxDistance?m:this._maxDistance;At.scale(this._globalParallelLightDir,f,this._tempPos);var g=this._tempPos.elements;g[0]=p[0]-g[0],g[1]=p[1]-g[1],g[2]=p[2]-g[2],h.transform.position=this._tempPos,h.transform.lookAt(this._tempLookAt3,this._tempLightUp,!1),Ct.createOrthoOffCenterRH(c[0],l[0],c[1],l[1],1,f+.5*(l[2]-c[2]),h.projectionMatrix),h.projectionViewMatrix.cloneTo(this._lightVPMatrix[this._currentPSSM]),this._lightCulling[this._currentPSSM].matrix=this._lightVPMatrix[this._currentPSSM],e.multiplyMatrixOutFloat32Array(this._tempScaleMatrix44,this._lightVPMatrix[this._currentPSSM],this._shaderValueVPs[this._currentPSSM])},t.getLightFrustumCulling=function(e){return this._lightCulling[e]},t.getSplitFrustumCulling=function(){return this._splitFrustumCulling},t.getSplitDistance=function(e){return this._spiltDistance[e]},t.setShadowMapTextureSize=function(e){e!==this._shadowMapTextureSize&&(this._shadowMapTextureSize=e,this._shadowPCFOffset.x=1/this._shadowMapTextureSize,this._shadowPCFOffset.y=1/this._shadowMapTextureSize,this._statesDirty=!0)},t.getShadowMapTextureSize=function(){return this._shadowMapTextureSize},t.beginRenderTarget=function(e){this._renderTarget[e].start()},t.endRenderTarget=function(e){this._renderTarget[e].end()},t.getRenderTarget=function(e){return this._renderTarget[e]},t.disposeAllRenderTarget=function(){for(var e=0,t=this._numberOfPSSM+1;e<t;e++)this._renderTarget[e]&&(this._renderTarget[e].destroy(),this._renderTarget[e]=null)},r(0,t,"PSSMNum",function(){return this._numberOfPSSM},function(e){e=(e=e>0?e:1)<=3?e:3,this._numberOfPSSM!=e&&(this._numberOfPSSM=e,this._ratioOfDistance=1/this._numberOfPSSM,this._statesDirty=!0)}),e.multiplyMatrixOutFloat32Array=function(e,t,i){var n,a,r,o,s,h,l;for(a=e.elements,r=t.elements,n=0;n<4;n++)o=a[n],s=a[n+4],h=a[n+8],l=a[n+12],i[n]=o*r[0]+s*r[1]+h*r[2]+l*r[3],i[n+4]=o*r[4]+s*r[5]+h*r[6]+l*r[7],i[n+8]=o*r[8]+s*r[9]+h*r[10]+l*r[11],i[n+12]=o*r[12]+s*r[13]+h*r[14]+l*r[15]},e.SHADERDEFINE_RECEIVE_SHADOW=1,e.SHADERDEFINE_CAST_SHADOW=512,e.SHADERDEFINE_SHADOW_PSSM1=1024,e.SHADERDEFINE_SHADOW_PSSM2=2048,e.SHADERDEFINE_SHADOW_PSSM3=4096,e.SHADERDEFINE_SHADOW_PCF_NO=8192,e.SHADERDEFINE_SHADOW_PCF1=16384,e.SHADERDEFINE_SHADOW_PCF2=32768,e.SHADERDEFINE_SHADOW_PCF3=65536,e.MAX_PSSM_COUNT=3,e}(),zt=function(){function e(){this._boundingSphere=null,this._boundingBox=null,this._sizeOfY=null,this._currentLODLevel=0,this._lastDistanceToEye=NaN,this._originalBoundingSphere=null,this._originalBoundingBox=null,this._originalBoundingBoxCorners=null,this._bUseStrip=!1,this._gridSize=NaN,this._beginGridX=0,this._beginGridZ=0,this._LODError=null,e.__init__(),this._currentLODLevel=0}a(e,"laya.d3.terrain.TerrainLeaf");var t=e.prototype;return t.calcVertextNorml=function(t,i,n,a,r,o){var s=0,h=0;h=-1*e.getHeightFromTerrainHeightData(t-1,i-1,n,a,r),h+=-1*e.getHeightFromTerrainHeightData(t-1,i,n,a,r),h+=-1*e.getHeightFromTerrainHeightData(t-1,i+1,n,a,r),h+=1*e.getHeightFromTerrainHeightData(t+1,i-1,n,a,r),h+=1*e.getHeightFromTerrainHeightData(t+1,i,n,a,r),h+=1*e.getHeightFromTerrainHeightData(t+1,i+1,n,a,r),s=-1*e.getHeightFromTerrainHeightData(t-1,i-1,n,a,r),s+=-1*e.getHeightFromTerrainHeightData(t,i-1,n,a,r),s+=-1*e.getHeightFromTerrainHeightData(t+1,i-1,n,a,r),s+=1*e.getHeightFromTerrainHeightData(t-1,i+1,n,a,r),s+=1*e.getHeightFromTerrainHeightData(t,i+1,n,a,r),s+=1*e.getHeightFromTerrainHeightData(t+1,i+1,n,a,r),o.x=-h,o.y=6,o.z=-s,At.normalize(o,o)},t.calcVertextNormlUV=function(e,t,i,n,a){a.x=e/i,a.y=t/n,a.z=t/n},t.calcVertextBuffer=function(t,i,n,a,r,o,s,h,l,c,p,u){if(1==u&&!e.__ADAPT_MATRIX__){e.__ADAPT_MATRIX__=new Ct;var d=new Ct;Ct.createRotationY(Math.PI,e.__ADAPT_MATRIX__),Ct.createTranslate(new At(0,0,(p-1)*r),d),Ct.multiply(d,e.__ADAPT_MATRIX__,e.__ADAPT_MATRIX__),e.__ADAPT_MATRIX_INV__=new Ct,e.__ADAPT_MATRIX__.invert(e.__ADAPT_MATRIX_INV__)}this._gridSize=r,this._beginGridX=t*e.CHUNK_GRID_NUM+n,this._beginGridZ=i*e.CHUNK_GRID_NUM+a;for(var _=s*h,m=2147483647,f=-2147483648,g=new At,y=0,v=e.LEAF_GRID_NUM+1;y<v;y++)for(var x=0,b=e.LEAF_GRID_NUM+1;x<b;x++)e.__VECTOR3__.x=(this._beginGridX+x)*this._gridSize,e.__VECTOR3__.z=(this._beginGridZ+y)*this._gridSize,e.__VECTOR3__.y=l[(this._beginGridZ+y)*c+(this._beginGridX+x)],m=e.__VECTOR3__.y<m?e.__VECTOR3__.y:m,f=e.__VECTOR3__.y>f?e.__VECTOR3__.y:f,e.__ADAPT_MATRIX__&&At.transformV3ToV3(e.__VECTOR3__,e.__ADAPT_MATRIX__,e.__VECTOR3__),o[_]=e.__VECTOR3__.x,o[++_]=e.__VECTOR3__.y,o[++_]=e.__VECTOR3__.z,_++,this.calcVertextNormlUV(this._beginGridX+x,this._beginGridZ+y,c,p,g),o[_]=g.x,o[++_]=g.y,o[++_]=g.z,o[++_]=(n+x)/e.CHUNK_GRID_NUM,o[++_]=(a+y)/e.CHUNK_GRID_NUM,o[++_]=this._beginGridX+x,o[++_]=this._beginGridZ+y,_++;this._sizeOfY=new Nt(m-1,f+1),this.calcLODErrors(l,c,p),this.calcOriginalBoudingBoxAndSphere()},t.calcSkirtVertextBuffer=function(t,i,n,a,r,o,s,h,l,c,p){this._gridSize=r,this._beginGridX=t*e.CHUNK_GRID_NUM+n,this._beginGridZ=i*e.CHUNK_GRID_NUM+a;var u=s*h,d=0,_=0,m=e.LEAF_GRID_NUM+1,f=new At,g=0,y=0;for(d=0;d<2;d++)for(_=0;_<m;_++)e.__VECTOR3__.x=(this._beginGridX+_)*this._gridSize,e.__VECTOR3__.y=1==d?l[this._beginGridZ*c+(this._beginGridX+_)]:-this._gridSize,e.__VECTOR3__.z=(this._beginGridZ+0)*this._gridSize,e.__ADAPT_MATRIX__&&At.transformV3ToV3(e.__VECTOR3__,e.__ADAPT_MATRIX__,e.__VECTOR3__),o[u]=e.__VECTOR3__.x,o[++u]=e.__VECTOR3__.y,o[++u]=e.__VECTOR3__.z,u++,g=0==d?this._beginGridZ-1:this._beginGridZ,this.calcVertextNormlUV(this._beginGridX+_,g,c,p,f),o[u]=f.x,o[++u]=f.y,o[++u]=f.z,o[++u]=(n+_)/e.CHUNK_GRID_NUM,o[++u]=(a+0)/e.CHUNK_GRID_NUM,o[++u]=this._beginGridX+_,o[++u]=g,u++;for(d=0;d<2;d++)for(_=0;_<m;_++)e.__VECTOR3__.x=(this._beginGridX+_)*this._gridSize,e.__VECTOR3__.y=0==d?l[(this._beginGridZ+e.LEAF_GRID_NUM)*c+(this._beginGridX+_)]:-this._gridSize,e.__VECTOR3__.z=(this._beginGridZ+e.LEAF_GRID_NUM)*this._gridSize,e.__ADAPT_MATRIX__&&At.transformV3ToV3(e.__VECTOR3__,e.__ADAPT_MATRIX__,e.__VECTOR3__),o[u]=e.__VECTOR3__.x,o[++u]=e.__VECTOR3__.y,o[++u]=e.__VECTOR3__.z,u++,g=0==d?this._beginGridZ+e.LEAF_GRID_NUM:this._beginGridZ+e.LEAF_GRID_NUM+1,this.calcVertextNormlUV(this._beginGridX+_,g,c,p,f),o[u]=f.x,o[++u]=f.y,o[++u]=f.z,o[++u]=(n+_)/e.CHUNK_GRID_NUM,o[++u]=(a+e.LEAF_GRID_NUM)/e.CHUNK_GRID_NUM,o[++u]=this._beginGridX+_,o[++u]=g,u++;for(d=0;d<2;d++)for(_=0;_<m;_++)e.__VECTOR3__.x=(this._beginGridX+0)*this._gridSize,e.__VECTOR3__.y=0==d?l[(this._beginGridZ+_)*c+(this._beginGridX+0)]:-this._gridSize,e.__VECTOR3__.z=(this._beginGridZ+_)*this._gridSize,e.__ADAPT_MATRIX__&&At.transformV3ToV3(e.__VECTOR3__,e.__ADAPT_MATRIX__,e.__VECTOR3__),o[u]=e.__VECTOR3__.x,o[++u]=e.__VECTOR3__.y,o[++u]=e.__VECTOR3__.z,u++,y=0==d?this._beginGridX:this._beginGridX-1,this.calcVertextNormlUV(y,this._beginGridZ+_,c,p,f),o[u]=f.x,o[++u]=f.y,o[++u]=f.z,o[++u]=(n+0)/e.CHUNK_GRID_NUM,o[++u]=(a+_)/e.CHUNK_GRID_NUM,o[++u]=y,o[++u]=this._beginGridZ+_,u++;for(d=0;d<2;d++)for(_=0;_<m;_++)e.__VECTOR3__.x=(this._beginGridX+e.LEAF_GRID_NUM)*this._gridSize,e.__VECTOR3__.y=1==d?l[(this._beginGridZ+_)*c+(this._beginGridX+e.LEAF_GRID_NUM)]:-this._gridSize,e.__VECTOR3__.z=(this._beginGridZ+_)*this._gridSize,e.__ADAPT_MATRIX__&&At.transformV3ToV3(e.__VECTOR3__,e.__ADAPT_MATRIX__,e.__VECTOR3__),o[u]=e.__VECTOR3__.x,o[++u]=e.__VECTOR3__.y,o[++u]=e.__VECTOR3__.z,u++,y=0==d?this._beginGridX+e.LEAF_GRID_NUM+1:this._beginGridX+e.LEAF_GRID_NUM,this.calcVertextNormlUV(y,this._beginGridZ+_,c,p,f),o[u]=f.x,o[++u]=f.y,o[++u]=f.z,o[++u]=(n+e.LEAF_GRID_NUM)/e.CHUNK_GRID_NUM,o[++u]=(a+_)/e.CHUNK_GRID_NUM,o[++u]=y,o[++u]=this._beginGridZ+_,u++},t.calcOriginalBoudingBoxAndSphere=function(){var t=new At(this._beginGridX*this._gridSize,this._sizeOfY.x,this._beginGridZ*this._gridSize),i=new At((this._beginGridX+e.LEAF_GRID_NUM)*this._gridSize,this._sizeOfY.y,(this._beginGridZ+e.LEAF_GRID_NUM)*this._gridSize);e.__ADAPT_MATRIX__&&(At.transformV3ToV3(t,e.__ADAPT_MATRIX__,t),At.transformV3ToV3(i,e.__ADAPT_MATRIX__,i)),this._originalBoundingBox=new xt(t,i);var n=new At;At.subtract(i,t,n),At.scale(n,.5,n);var a=new At;At.add(t,n,a),this._originalBoundingSphere=new wt(a,At.scalarLength(n)),this._originalBoundingBoxCorners=o(8,null),this._originalBoundingBox.getCorners(this._originalBoundingBoxCorners),this._boundingBox=new xt(new At(-.5,-.5,-.5),new At(.5,.5,.5)),this._boundingSphere=new wt(new At(0,0,0),1)},t.calcLeafBoudingBox=function(e){for(var t=0;t<8;t++)At.transformCoordinate(this._originalBoundingBoxCorners[t],e,ti._tempBoundBoxCorners[t]);xt.createfromPoints(ti._tempBoundBoxCorners,this._boundingBox)},t.calcLeafBoudingSphere=function(e,t){At.transformCoordinate(this._originalBoundingSphere.center,e,this._boundingSphere.center),this._boundingSphere.radius=this._originalBoundingSphere.radius*t},t.calcLODErrors=function(t,i,n){this._LODError=new Float32Array(e._maxLODLevel+1);for(var a=1,r=0,o=e._maxLODLevel+1;r<o;r++){for(var s=0,h=0,l=e.LEAF_GRID_NUM;h<l;h+=a)for(var c=0,p=e.LEAF_GRID_NUM;c<p;c+=a)for(var u=t[(this._beginGridZ+h)*i+(this._beginGridX+c)],d=t[(this._beginGridZ+h)*i+(this._beginGridX+c)+a],_=t[(this._beginGridZ+h+a)*i+(this._beginGridX+c)],m=t[(this._beginGridZ+h+a)*i+(this._beginGridX+c)+a],f=0;f<a;f++)for(var g=f/a,y=0;y<a;y++){var v=y/a,x=t[(this._beginGridZ+h+f)*i+(this._beginGridX+c)+y],b=v+g<=1?u+(d-u)*v+(_-u)*g:m+(_-m)*(1-v)+(d-m)*(1-g),w=Math.abs(b-x);s=Math.max(s,w)}a*=2,this._LODError[r]=s}},t.determineLod=function(t,i,n,a){var r=At.distance(t,this._boundingSphere.center),o=e._maxLODLevel;if(!a){if(this._lastDistanceToEye==r)return this._currentLODLevel;this._lastDistanceToEye>r&&(o=this._currentLODLevel)}for(var s=o;s>=1;s--)if(_n.LOD_DISTANCE_FACTOR*this._LODError[s]/r*i<n){this._currentLODLevel=s;break}return this._lastDistanceToEye=r,this._currentLODLevel},e.__init__=function(){if(!e._bInit){var t=e.CHUNK_GRID_NUM/e.LEAF_GRID_NUM*(e.CHUNK_GRID_NUM/e.LEAF_GRID_NUM);e._planeLODIndex=o(t);var i=0,n=0,a=0,r=0,s=0,h=0,l=null,c=null;for(i=0;i<t;i++)e._planeLODIndex[i]=new Array(e._maxLODLevel+1);for(i=0,r=e._maxLODLevel+1;i<r;i++)e._planeLODIndex[0][i]=e.calcPlaneLODIndex(i);for(i=1;i<t;i++)for(h=i*e.LEAF_PLANE_VERTEXT_COUNT,n=0,s=e._maxLODLevel+1;n<s;n++){for(l=e._planeLODIndex[0][n],c=new Uint16Array(l.length),a=0;a<l.length;a++)c[a]=l[a]+h;e._planeLODIndex[i][n]=c}for(e._skirtLODIndex=o(t),i=0;i<t;i++)e._skirtLODIndex[i]=new Array(e._maxLODLevel+1);for(i=0,r=e._maxLODLevel+1;i<r;i++)e._skirtLODIndex[0][i]=e.calcSkirtLODIndex(i);for(i=1;i<t;i++)for(h=i*e.LEAF_SKIRT_VERTEXT_COUNT,n=0,s=e._maxLODLevel+1;n<s;n++){for(l=e._skirtLODIndex[0][n],c=new Uint16Array(l.length),a=0;a<l.length;a++)c[a]=l[a]+h;e._skirtLODIndex[i][n]=c}e._bInit=!0}},e.getPlaneLODIndex=function(t,i){return e._planeLODIndex[t][i]},e.getSkirtLODIndex=function(t,i){return e._skirtLODIndex[t][i]},e.calcPlaneLODIndex=function(t){t>e._maxLODLevel&&(t=e._maxLODLevel);var i=e.LEAF_GRID_NUM+1,n=0,a=null,r=laya.d3.terrain.TerrainLeaf.LEAF_GRID_NUM/Math.pow(2,t);a=new Uint16Array(r*r*6);for(var o=laya.d3.terrain.TerrainLeaf.LEAF_GRID_NUM/r,s=0;s<e.LEAF_GRID_NUM;s+=o)for(var h=0;h<e.LEAF_GRID_NUM;h+=o)a[n]=(s+o)*i+h,a[++n]=s*i+h,a[++n]=s*i+h+o,a[++n]=s*i+h+o,a[++n]=(s+o)*i+h+o,a[++n]=(s+o)*i+h,n++;return a},e.calcSkirtLODIndex=function(t){t>e._maxLODLevel&&(t=e._maxLODLevel);var i=e.CHUNK_GRID_NUM/e.LEAF_GRID_NUM*(e.CHUNK_GRID_NUM/e.LEAF_GRID_NUM)*e.LEAF_PLANE_VERTEXT_COUNT,n=e.LEAF_GRID_NUM+1,a=0,r=null,o=laya.d3.terrain.TerrainLeaf.LEAF_GRID_NUM/Math.pow(2,t);r=new Uint16Array(4*o*6);for(var s=laya.d3.terrain.TerrainLeaf.LEAF_GRID_NUM/o,h=0;h<4;h++){for(var l=0;l<e.LEAF_GRID_NUM;l+=s)r[a]=i+n+l,r[++a]=i+l,r[++a]=i+l+s,r[++a]=i+l+s,r[++a]=i+n+l+s,r[++a]=i+n+l,a++;i+=2*n}return r},e.getHeightFromTerrainHeightData=function(e,t,i,n,a){return e=e<0?0:e,e=e>=n?n-1:e,t=t<0?0:t,t=t>=a?a-1:t,i[t*n+e]},e.CHUNK_GRID_NUM=64,e.LEAF_GRID_NUM=32,e.__ADAPT_MATRIX__=null,e.__ADAPT_MATRIX_INV__=null,e._planeLODIndex=null,e._skirtLODIndex=null,e._bInit=!1,n(e,["LEAF_PLANE_VERTEXT_COUNT",function(){return this.LEAF_PLANE_VERTEXT_COUNT=(e.LEAF_GRID_NUM+1)*(e.LEAF_GRID_NUM+1)},"LEAF_SKIRT_VERTEXT_COUNT",function(){return this.LEAF_SKIRT_VERTEXT_COUNT=2*(e.LEAF_GRID_NUM+1)*4},"LEAF_VERTEXT_COUNT",function(){return this.LEAF_VERTEXT_COUNT=e.LEAF_PLANE_VERTEXT_COUNT+e.LEAF_SKIRT_VERTEXT_COUNT},"LEAF_PLANE_MAX_INDEX_COUNT",function(){return this.LEAF_PLANE_MAX_INDEX_COUNT=e.LEAF_GRID_NUM*e.LEAF_GRID_NUM*6},"LEAF_SKIRT_MAX_INDEX_COUNT",function(){return this.LEAF_SKIRT_MAX_INDEX_COUNT=4*e.LEAF_GRID_NUM*6},"LEAF_MAX_INDEX_COUNT",function(){return this.LEAF_MAX_INDEX_COUNT=e.LEAF_PLANE_MAX_INDEX_COUNT+e.LEAF_SKIRT_MAX_INDEX_COUNT},"__VECTOR3__",function(){return this.__VECTOR3__=new At},"_maxLODLevel",function(){return this._maxLODLevel=Math.log2(e.LEAF_GRID_NUM)}]),e}(),Xt=function(){function e(){this.alphaMap=null,this.detailID=null,this.normalMap=null}return a(e,"laya.d3.terrain.unit.ChunkInfo"),e}(),Yt=function(){function e(){this.diffuseTexture=null,this.normalTexture=null,this.scale=null,this.offset=null}return a(e,"laya.d3.terrain.unit.DetailTextureInfo"),e}(),Gt=function(){function e(){this.ambientColor=null,this.diffuseColor=null,this.specularColor=null}return a(e,"laya.d3.terrain.unit.MaterialInfo"),e}(),jt=function(){function e(){}return a(e,"laya.d3.utils.Physics"),e.__init__=function(){e._layerCollsionMatrix.length=31;for(var t=0;t<31;t++){var i=[],n=31-t;i.length=n;for(var a=0;a<n;a++)i[a]=a===n-1;e._layerCollsionMatrix[t]=i}},e.setLayerCollision=function(t,i,n){e._layerCollsionMatrix[t.number][30-i.number]=n},e.getLayerCollision=function(t,i){return e._layerCollsionMatrix[t.number][30-i.number]},e.setColliderCollision=function(e,t,i){i?(delete e._ignoreCollisonMap[t.id],delete t._ignoreCollisonMap[e.id]):(e._ignoreCollisonMap[t.id]=t,t._ignoreCollisonMap[e.id]=e)},e.getIColliderCollision=function(e,t){return!!e._ignoreCollisonMap[t.id]},e.rayCast=function(t,i,n,a){void 0===n&&(n=1.79e308),void 0===a&&(a=0),e._outHitAllInfo.length=0;for(var r=X.getLayerByNumber(a)._colliders,o=0,s=r.length;o<s;o++){var h=r[o];if(h.enable&&(h.raycast(t,e._outHitInfo,n),-1!==e._outHitInfo.distance&&e._outHitInfo.distance<=n)){var l=new qt;e._outHitInfo.cloneTo(l),e._outHitAllInfo.push(l)}}if(0==e._outHitAllInfo.length)return i.sprite3D=null,void(i.distance=-1);for(var c=Number.MAX_VALUE,p=0,u=0;u<e._outHitAllInfo.length;u++)e._outHitAllInfo[u].distance<c&&(c=e._outHitAllInfo[u].distance,p=u);e._outHitAllInfo[p].cloneTo(i)},e.rayCastAll=function(t,i,n,a){void 0===n&&(n=1.79e308),void 0===a&&(a=0),i.length=0;for(var r=X.getLayerByNumber(a)._colliders,o=0,s=r.length;o<s;o++){var h=r[o];if(h.enable&&(e._outHitInfo.distance=-1,e._outHitInfo.sprite3D=null,h.raycast(t,e._outHitInfo,n),-1!==e._outHitInfo.distance&&e._outHitInfo.distance<=n)){var l=new qt;e._outHitInfo.cloneTo(l),i.push(l)}}},e._outHitAllInfo=[],e._layerCollsionMatrix=[],n(e,["_outHitInfo",function(){return this._outHitInfo=new qt},"collisionManager",function(){return this.collisionManager=new ni},"gravity",function(){return this.gravity=new At(0,-9.81,0)}]),e}(),Wt=function(){function e(){}return a(e,"laya.d3.utils.Picker"),e.calculateCursorRay=function(t,i,n,a,r,o){var s=t.elements[0],h=t.elements[1],l=e._tempVector30,c=l.elements;c[0]=s,c[1]=h,c[2]=i.minDepth;var p=e._tempVector31,u=p.elements;u[0]=s,u[1]=h,u[2]=i.maxDepth;var d=o.origin,_=e._tempVector32;i.unprojectFromWVP(l,n,a,r,d),i.unprojectFromWVP(p,n,a,r,_);var m=o.direction.elements;m[0]=_.x-d.x,m[1]=_.y-d.y,m[2]=_.z-d.z,At.normalize(o.direction,o.direction)},e.rayIntersectsPositionsAndIndices=function(t,i,n,a,r){for(var o=n.vertexStride/4,s=n.getVertexElementByUsage(0).offset/4,h=Number.MAX_VALUE,l=-1,c=-1,p=-1,u=0;u<a.length;u+=3){var d=e._tempVector35,_=d.elements,m=a[u]*o,f=m+s;_[0]=i[f],_[1]=i[f+1],_[2]=i[f+2];var g=e._tempVector36,y=g.elements,v=a[u+1]*o,x=v+s;y[0]=i[x],y[1]=i[x+1],y[2]=i[x+2];var b=e._tempVector37,w=b.elements,S=a[u+2]*o,I=S+s;w[0]=i[I],w[1]=i[I+1],w[2]=i[I+2];var M=laya.d3.utils.Picker.rayIntersectsTriangle(t,d,g,b);!isNaN(M)&&M<h&&(h=M,l=m,c=v,p=S)}if(h!==Number.MAX_VALUE){r.distance=h,At.scale(t.direction,h,r.position),At.add(t.origin,r.position,r.position);var C=r.trianglePositions,k=C[0],E=C[1],T=C[2],L=k.elements,D=E.elements,N=T.elements,A=l+s;L[0]=i[A],L[1]=i[A+1],L[2]=i[A+2];var R=c+s;D[0]=i[R],D[1]=i[R+1],D[2]=i[R+2];var B=p+s;N[0]=i[B],N[1]=i[B+1],N[2]=i[B+2];var P=n.getVertexElementByUsage(3);if(P){var O=P.offset/4,V=r.triangleNormals,U=V[0],F=V[1],H=V[2],z=U.elements,X=F.elements,Y=H.elements,G=l+O;z[0]=i[G],z[1]=i[G+1],z[2]=i[G+2];var j=c+O;X[0]=i[j],X[1]=i[j+1],X[2]=i[j+2];var W=p+O;Y[0]=i[W],Y[1]=i[W+1],Y[2]=i[W+2]}return!0}return r.position.toDefault(),r.distance=Number.MAX_VALUE,r.trianglePositions[0].toDefault(),r.trianglePositions[1].toDefault(),r.trianglePositions[2].toDefault(),r.triangleNormals[0].toDefault(),r.triangleNormals[1].toDefault(),r.triangleNormals[2].toDefault(),!1},e.rayIntersectsTriangle=function(t,i,n,a){var r=e._tempVector30,o=e._tempVector31;At.subtract(n,i,r),At.subtract(a,i,o);var s=e._tempVector32;At.cross(t.direction,o,s);var h;if((h=At.dot(r,s))>-Number.MIN_VALUE&&h<Number.MIN_VALUE)return Number.NaN;var l=1/h,c=e._tempVector33;At.subtract(t.origin,i,c);var p;if(p=At.dot(c,s),(p*=l)<0||p>1)return Number.NaN;var u=e._tempVector34;At.cross(c,r,u);var d;if(d=At.dot(t.direction,u),(d*=l)<0||p+d>1)return Number.NaN;var _;return _=At.dot(o,u),(_*=l)<0?Number.NaN:_},n(e,["_tempVector30",function(){return this._tempVector30=new At},"_tempVector31",function(){return this._tempVector31=new At},"_tempVector32",function(){return this._tempVector32=new At},"_tempVector33",function(){return this._tempVector33=new At},"_tempVector34",function(){return this._tempVector34=new At},"_tempVector35",function(){return this._tempVector35=new At},"_tempVector36",function(){return this._tempVector36=new At},"_tempVector37",function(){return this._tempVector37=new At}]),e}(),qt=function(){function e(){this.distance=NaN,this.trianglePositions=null,this.triangleNormals=null,this.position=null,this.sprite3D=null,this.distance=-1,this.trianglePositions=[new At,new At,new At],this.trianglePositions.length=3,this.triangleNormals=[new At,new At,new At],this.triangleNormals.length=3,this.position=new At}a(e,"laya.d3.utils.RaycastHit");return e.prototype.cloneTo=function(e){e.distance=this.distance,this.trianglePositions[0].cloneTo(e.trianglePositions[0]),this.trianglePositions[1].cloneTo(e.trianglePositions[1]),this.trianglePositions[2].cloneTo(e.trianglePositions[2]),this.triangleNormals[0].cloneTo(e.triangleNormals[0]),this.triangleNormals[1].cloneTo(e.triangleNormals[1]),this.triangleNormals[2].cloneTo(e.triangleNormals[2]),this.position.cloneTo(e.position),e.sprite3D=this.sprite3D},e}(),Kt=function(){function e(e,t){this._width=0,this._height=0,this._width=e,this._height=t}a(e,"laya.d3.utils.Size");var t=e.prototype;return r(0,t,"width",function(){return-1===this._width?ue.clientWidth:this._width}),r(0,t,"height",function(){return-1===this._height?ue.clientHeight:this._height}),r(1,e,"fullScreen",function(){return new e(-1,-1)}),e}(),Jt=function(){function e(){}return a(e,"laya.d3.utils.Utils3D"),e._rotationTransformScaleSkinAnimation=function(t,i,n,a,r,o,s,h,l,c,p,u){var d=e._tempArray16_0,_=e._tempArray16_1,m=e._tempArray16_2,f=a+a,g=r+r,y=o+o,v=a*f,x=r*f,b=r*g,w=o*f,S=o*g,I=o*y,M=s*f,C=s*g,k=s*y;d[15]=1,d[0]=1-b-I,d[1]=x+k,d[2]=w-C,d[4]=x-k,d[5]=1-v-I,d[6]=S+M,d[8]=w+C,d[9]=S-M,d[10]=1-v-b,_[15]=1,_[0]=h,_[5]=l,_[10]=c;var E,T,L,D,N;for(E=0;E<4;E++)T=d[E],L=d[E+4],D=d[E+8],N=d[E+12],m[E]=T,m[E+4]=L,m[E+8]=D,m[E+12]=T*t+L*i+D*n+N;for(E=0;E<4;E++)T=m[E],L=m[E+4],D=m[E+8],N=m[E+12],p[E+u]=T*_[0]+L*_[1]+D*_[2]+N*_[3],p[E+u+4]=T*_[4]+L*_[5]+D*_[6]+N*_[7],p[E+u+8]=T*_[8]+L*_[9]+D*_[10]+N*_[11],p[E+u+12]=T*_[12]+L*_[13]+D*_[14]+N*_[15]},e._createNodeByJson=function(t,i,n,a){if(!n)switch(i.type){case"Sprite3D":n=new Pi;break;case"MeshSprite3D":n=new gn;break;case"SkinnedMeshSprite3D":n=new vn;break;case"ShuriKenParticle3D":n=new yn;break;case"TrailSprite3D":n=new xn;break;case"Terrain":n=new _n;break;case"Camera":n=new mn;break;case"DirectionLight":n=new fn;break;default:throw new Error("Utils3D:unidentified class type in (.lh) file.")}var r=i.props;if(r)for(var o in r)n[o]=r[o];var s=i.customProps;s&&(n instanceof laya.d3.core.Sprite3D?(n._parseBaseCustomProps(s),n._parseCustomProps(t,a,s,i),n._parseCustomComponent(t,a,i.components)):n._parseCustomProps(t,a,s,i));var h=i.child;if(h)for(var l=0,c=h.length;l<c;l++){var p=e._createNodeByJson(t,h[l],null,a);n.addChild(p)}return n},e._computeBoneAndAnimationDatasByBindPoseMatrxix=function(e,t,i,n,a,r){var o,s,h=0,l=0,c=e.length;for(o=0;o<c;h+=e[o].keyframeWidth,l+=16,o++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(t[h+0],t[h+1],t[h+2],t[h+3],t[h+4],t[h+5],t[h+6],t[h+7],t[h+8],t[h+9],n,l),0!=o&&(s=16*e[o].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(n,s,n,l,n,l));var p=i.length;for(o=0;o<p;o++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(n,16*r[o],i[o],a,16*o)},e._computeAnimationDatasByArrayAndMatrixFast=function(e,t,i,n){for(var a=0,r=e.length;a<r;a++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(t,16*n[a],e[a],i,16*a)},e._computeBoneAndAnimationDatasByBindPoseMatrxixOld=function(e,t,i,n,a){var r,o,s=0,h=0,l=e.length;for(r=0;r<l;s+=e[r].keyframeWidth,h+=16,r++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(t[s+7],t[s+8],t[s+9],t[s+3],t[s+4],t[s+5],t[s+6],t[s+0],t[s+1],t[s+2],n,h),0!=r&&(o=16*e[r].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(n,o,n,h,n,h));var c=i.length;for(r=0;r<c;r++){var p=16*r;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(n,p,i[r],a,p)}},e._computeAnimationDatasByArrayAndMatrixFastOld=function(e,t,i){for(var n=e.length,a=0;a<n;a++){var r=16*a;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(t,r,e[a],i,r)}},e._computeRootAnimationData=function(e,t,i){for(var n=0,a=0,r=0,o=e.length;n<o;a+=e[n].keyframeWidth,r+=16,n++)laya.d3.utils.Utils3D.createAffineTransformationArray(t[a+0],t[a+1],t[a+2],t[a+3],t[a+4],t[a+5],t[a+6],t[a+7],t[a+8],t[a+9],i,r)},e.transformVector3ArrayByQuat=function(e,t,i,n,a){var r=i.elements,o=e[t],s=e[t+1],h=e[t+2],l=r[0],c=r[1],p=r[2],u=r[3],d=u*o+c*h-p*s,_=u*s+p*o-l*h,m=u*h+l*s-c*o,f=-l*o-c*s-p*h;n[a]=d*u+f*-l+_*-p-m*-c,n[a+1]=_*u+f*-c+m*-l-d*-p,n[a+2]=m*u+f*-p+d*-c-_*-l},e.mulMatrixByArray=function(t,i,n,a,r,o){var s,h,l,c,p;if(r===n){for(n=e._tempArray16_3,s=0;s<16;++s)n[s]=r[o+s];a=0}for(s=0;s<4;s++)h=t[i+s],l=t[i+s+4],c=t[i+s+8],p=t[i+s+12],r[o+s]=h*n[a+0]+l*n[a+1]+c*n[a+2]+p*n[a+3],r[o+s+4]=h*n[a+4]+l*n[a+5]+c*n[a+6]+p*n[a+7],r[o+s+8]=h*n[a+8]+l*n[a+9]+c*n[a+10]+p*n[a+11],r[o+s+12]=h*n[a+12]+l*n[a+13]+c*n[a+14]+p*n[a+15]},e.mulMatrixByArrayFast=function(e,t,i,n,a,r){var o,s,h,l,c;for(o=0;o<4;o++)s=e[t+o],h=e[t+o+4],l=e[t+o+8],c=e[t+o+12],a[r+o]=s*i[n+0]+h*i[n+1]+l*i[n+2]+c*i[n+3],a[r+o+4]=s*i[n+4]+h*i[n+5]+l*i[n+6]+c*i[n+7],a[r+o+8]=s*i[n+8]+h*i[n+9]+l*i[n+10]+c*i[n+11],a[r+o+12]=s*i[n+12]+h*i[n+13]+l*i[n+14]+c*i[n+15]},e.mulMatrixByArrayAndMatrixFast=function(e,t,i,n,a){var r,o,s,h,l,c=i.elements,p=c[0],u=c[1],d=c[2],_=c[3],m=c[4],f=c[5],g=c[6],y=c[7],v=c[8],x=c[9],b=c[10],w=c[11],S=c[12],I=c[13],M=c[14],C=c[15],k=t,E=t+4,T=t+8,L=t+12,D=a,N=a+4,A=a+8,R=a+12;for(r=0;r<4;r++)o=e[k+r],s=e[E+r],h=e[T+r],l=e[L+r],n[D+r]=o*p+s*u+h*d+l*_,n[N+r]=o*m+s*f+h*g+l*y,n[A+r]=o*v+s*x+h*b+l*w,n[R+r]=o*S+s*I+h*M+l*C},e.createAffineTransformationArray=function(e,t,i,n,a,r,o,s,h,l,c,p){var u=n+n,d=a+a,_=r+r,m=n*u,f=n*d,g=n*_,y=a*d,v=a*_,x=r*_,b=o*u,w=o*d,S=o*_;c[p+0]=(1-(y+x))*s,c[p+1]=(f+S)*s,c[p+2]=(g-w)*s,c[p+3]=0,c[p+4]=(f-S)*h,c[p+5]=(1-(m+x))*h,c[p+6]=(v+b)*h,c[p+7]=0,c[p+8]=(g+w)*l,c[p+9]=(v-b)*l,c[p+10]=(1-(m+y))*l,c[p+11]=0,c[p+12]=e,c[p+13]=t,c[p+14]=i,c[p+15]=1},e.transformVector3ArrayToVector3ArrayCoordinate=function(t,i,n,a,r){var o=e._tempArray4_0,s=t[i+0],h=t[i+1],l=t[i+2],c=n.elements;o[0]=s*c[0]+h*c[4]+l*c[8]+c[12],o[1]=s*c[1]+h*c[5]+l*c[9]+c[13],o[2]=s*c[2]+h*c[6]+l*c[10]+c[14],o[3]=1/(s*c[3]+h*c[7]+l*c[11]+c[15]),a[r+0]=o[0]*o[3],a[r+1]=o[1]*o[3],a[r+2]=o[2]*o[3]},e.transformLightingMapTexcoordByUV0Array=function(e,t,i,n,a){var r=i.elements;n[a+0]=e[t+0]*r[0]+r[2],n[a+1]=(e[t+1]-1)*r[1]+r[3]},e.transformLightingMapTexcoordByUV1Array=function(e,t,i,n,a){var r=i.elements;n[a+0]=e[t+0]*r[0]+r[2],n[a+1]=1+e[t+1]*r[1]+r[3]},e.getURLVerion=function(e){var t=e.indexOf("?");return t>=0?e.substr(t):null},e._quaternionCreateFromYawPitchRollArray=function(e,t,i,n){var a=.5*i,r=.5*t,o=.5*e,s=Math.sin(a),h=Math.cos(a),l=Math.sin(r),c=Math.cos(r),p=Math.sin(o),u=Math.cos(o);n[0]=u*l*h+p*c*s,n[1]=p*c*h-u*l*s,n[2]=u*c*s-p*l*h,n[3]=u*c*h+p*l*s},e._createAffineTransformationArray=function(e,t,i,n){var a=t[0],r=t[1],o=t[2],s=t[3],h=a+a,l=r+r,c=o+o,p=a*h,u=a*l,d=a*c,_=r*l,m=r*c,f=o*c,g=s*h,y=s*l,v=s*c,x=i[0],b=i[1],w=i[2];n[0]=(1-(_+f))*x,n[1]=(u+v)*x,n[2]=(d-y)*x,n[3]=0,n[4]=(u-v)*b,n[5]=(1-(p+f))*b,n[6]=(m+g)*b,n[7]=0,n[8]=(d+y)*w,n[9]=(m-g)*w,n[10]=(1-(p+_))*w,n[11]=0,n[12]=e[0],n[13]=e[1],n[14]=e[2],n[15]=1},e._mulMatrixArray=function(e,t,i,n){var a,r,o,s,h,l=t.elements,c=l[0],p=l[1],u=l[2],d=l[3],_=l[4],m=l[5],f=l[6],g=l[7],y=l[8],v=l[9],x=l[10],b=l[11],w=l[12],S=l[13],I=l[14],M=l[15],C=n,k=n+4,E=n+8,T=n+12;for(a=0;a<4;a++)r=e[a],o=e[a+4],s=e[a+8],h=e[a+12],i[C+a]=r*c+o*p+s*u+h*d,i[k+a]=r*_+o*m+s*f+h*g,i[E+a]=r*y+o*v+s*x+h*b,i[T+a]=r*w+o*S+s*I+h*M},e.getYawPitchRoll=function(t,i){e.transformQuat(At.ForwardRH,t,Tt.TEMPVector31),e.transformQuat(At.Up,t,Tt.TEMPVector32);var n=Tt.TEMPVector32.elements;e.angleTo(At.ZERO,Tt.TEMPVector31,Tt.TEMPVector33);var a=Tt.TEMPVector33.elements;a[0]==Math.PI/2?(a[1]=e.arcTanAngle(n[2],n[0]),a[2]=0):a[0]==-Math.PI/2?(a[1]=e.arcTanAngle(-n[2],-n[0]),a[2]=0):(Ct.createRotationY(-a[1],Tt.TEMPMatrix0),Ct.createRotationX(-a[0],Tt.TEMPMatrix1),At.transformCoordinate(Tt.TEMPVector32,Tt.TEMPMatrix0,Tt.TEMPVector32),At.transformCoordinate(Tt.TEMPVector32,Tt.TEMPMatrix1,Tt.TEMPVector32),a[2]=e.arcTanAngle(n[1],-n[0])),a[1]<=-Math.PI&&(a[1]=Math.PI),a[2]<=-Math.PI&&(a[2]=Math.PI),a[1]>=Math.PI&&a[2]>=Math.PI&&(a[1]=0,a[2]=0,a[0]=Math.PI-a[0]),i[0]=a[1],i[1]=a[0],i[2]=a[2]},e.arcTanAngle=function(e,t){return 0==e?1==t?Math.PI/2:-Math.PI/2:e>0?Math.atan(t/e):e<0?t>0?Math.atan(t/e)+Math.PI:Math.atan(t/e)-Math.PI:0},e.angleTo=function(t,i,n){At.subtract(i,t,Tt.TEMPVector30),At.normalize(Tt.TEMPVector30,Tt.TEMPVector30),n.elements[0]=Math.asin(Tt.TEMPVector30.y),n.elements[1]=e.arcTanAngle(-Tt.TEMPVector30.z,-Tt.TEMPVector30.x)},e.transformQuat=function(e,t,i){var n=i.elements,a=e.elements,r=t,o=a[0],s=a[1],h=a[2],l=r[0],c=r[1],p=r[2],u=r[3],d=u*o+c*h-p*s,_=u*s+p*o-l*h,m=u*h+l*s-c*o,f=-l*o-c*s-p*h;n[0]=d*u+f*-l+_*-p-m*-c,n[1]=_*u+f*-c+m*-l-d*-p,n[2]=m*u+f*-p+d*-c-_*-l},e.quaterionNormalize=function(e,t){var i=e[0],n=e[1],a=e[2],r=e[3],o=i*i+n*n+a*a+r*r;o>0&&(o=1/Math.sqrt(o),t[0]=i*o,t[1]=n*o,t[2]=a*o,t[3]=r*o)},e.matrix4x4MultiplyFFF=function(e,t,i){var n,a,r,o,s;if(i===t)for(t=new Float32Array(16),n=0;n<16;++n)t[n]=i[n];for(n=0;n<4;n++)a=e[n],r=e[n+4],o=e[n+8],s=e[n+12],i[n]=a*t[0]+r*t[1]+o*t[2]+s*t[3],i[n+4]=a*t[4]+r*t[5]+o*t[6]+s*t[7],i[n+8]=a*t[8]+r*t[9]+o*t[10]+s*t[11],i[n+12]=a*t[12]+r*t[13]+o*t[14]+s*t[15]},e.matrix4x4MultiplyMFM=function(t,i,n){e.matrix4x4MultiplyFFF(t.elements,i,n.elements)},e._tempVector3_0=new At,e._tempVector3_1=new At,e._tempVector3_2=new At,e._tempVector3_3=new At,e._tempVector3_4=new At,e._tempVector3_5=new At,e._tempVector3_6=new At,e._tempArray4_0=new Float32Array(4),e._tempArray16_0=new Float32Array(16),e._tempArray16_1=new Float32Array(16),e._tempArray16_2=new Float32Array(16),e._tempArray16_3=new Float32Array(16),n(e,["_typeToFunO",function(){return this._typeToFunO={INT16:"writeInt16",SHORT:"writeInt16",UINT16:"writeUint16",UINT32:"writeUint32",FLOAT32:"writeFloat32",INT:"writeInt32",UINT:"writeUint32",BYTE:"writeByte",STRING:"writeUTFString"}}]),e}(),Zt=function(){function e(){}return a(e,"Laya3D"),e._cancelLoadByUrl=function(t){i.loader.cancelLoadByUrl(t),e._innerFirstLevelLoaderManager.cancelLoadByUrl(t),e._innerSecondLevelLoaderManager.cancelLoadByUrl(t),e._innerThirdLevelLoaderManager.cancelLoadByUrl(t),e._innerFourthLevelLoaderManager.cancelLoadByUrl(t)},e._changeWebGLSize=function(e,t){A.onStageResize(e,t),ue.clientWidth=e,ue.clientHeight=t},e.__init__=function(){var t=x.createMap;t.lh=[Pi,"SPRITE3DHIERARCHY"],t.ls=[Bi,"SPRITE3DHIERARCHY"],t.lm=[an,"MESH"],t.lmat=[Yi,"MATERIAL"],t.lpbr=[Hi,"MATERIAL"],t.ltc=[ln,"TEXTURECUBE"],t.jpg=[hn,"nativeimage"],t.jpeg=[hn,"nativeimage"],t.png=[hn,"nativeimage"],t.pkm=[hn,"arraybuffer"],t.lsani=[h,"arraybuffer"],t.lrani=[h,"arraybuffer"],t.raw=[tn,"arraybuffer"],t.mipmaps=[tn,"arraybuffer"],t.thdata=[vi,"arraybuffer"],t.lt=[xi,"TERRAIN"],t.lani=[_i,"arraybuffer"],t.lav=[mi,"json"],t.ani=[h,"arraybuffer"],v.parserMap.SPRITE3DHIERARCHY=e._loadHierarchy,v.parserMap.MESH=e._loadMesh,v.parserMap.MATERIAL=e._loadMaterial,v.parserMap.TEXTURECUBE=e._loadTextureCube,v.parserMap.TERRAIN=e._loadTerrain,e._innerFirstLevelLoaderManager.on("error",null,e._eventLoadManagerError),e._innerSecondLevelLoaderManager.on("error",null,e._eventLoadManagerError),e._innerThirdLevelLoaderManager.on("error",null,e._eventLoadManagerError),e._innerFourthLevelLoaderManager.on("error",null,e._eventLoadManagerError)},e.READ_BLOCK=function(){return e._readData.pos+=4,!0},e.READ_DATA=function(){return e._DATA.offset=e._readData.getUint32(),e._DATA.size=e._readData.getUint32(),!0},e.READ_STRINGS=function(){var t=[],i={offset:0,size:0};i.offset=e._readData.getUint16(),i.size=e._readData.getUint16();e._readData.pos;e._readData.pos=i.offset+e._DATA.offset;for(var n=0;n<i.size;n++){var a=e._readData.readUTFString();-1===a.lastIndexOf(".lmat")&&-1===a.lastIndexOf(".lpbr")||t.push(a)}return t},e.formatRelativePath=function(e,t){var i;if("."===t.charAt(0)){for(var n=(e+t).split("/"),a=0,r=n.length;a<r;a++)if(".."==n[a]){var o=a-1;o>0&&".."!==n[o]&&(n.splice(o,2),a-=2)}i=n.join("/")}else i=e+t;return null!=D.customFormat&&(i=D.customFormat(i,null)),i},e._eventLoadManagerError=function(e){i.loader.event("error",e)},e._addHierarchyInnerUrls=function(t,i,n,a,r,o){var s=e.formatRelativePath(a,r);n&&(s+=n),t.push({url:s,clas:o}),i[r]=s},e._getSprite3DHierarchyInnerUrls=function(t,i,n,a,r,o,s){var h,l=0,c=0;switch(t.type){case"Scene":var p=t.customProps.lightmaps;for(l=0,c=p.length;l<c;l++){var d=p[l].replace(".exr",".png");e._addHierarchyInnerUrls(a,r,o,s,d,hn)}break;case"MeshSprite3D":case"TrailSprite3D":case"LineSprite3D":case"SkinnedMeshSprite3D":var _;if(t.instanceParams)(_=t.instanceParams.loadPath)&&e._addHierarchyInnerUrls(i,r,o,s,_,an);else{(_=(h=t.customProps).meshPath)&&e._addHierarchyInnerUrls(i,r,o,s,_,an);var m=h.materials;if(m)for(l=0,c=m.length;l<c;l++){var f=m[l],g=f.type.split("."),y=u.window;if(g.forEach(function(e){y=y[e]}),"function"!=typeof y)throw"_getSprite3DHierarchyInnerUrls 错误: "+f.type+" 不是类";e._addHierarchyInnerUrls(n,r,o,s,f.path,y)}}break;case"ShuriKenParticle3D":var v=(h=t.customProps).meshPath;v&&e._addHierarchyInnerUrls(i,r,o,s,v,an);var x=h.material;if(x)g=x.type.split("."),y=u.window,g.forEach(function(e){y=y[e]}),e._addHierarchyInnerUrls(n,r,o,s,x.path,y);else{var b=h.materialPath;if(b)e._addHierarchyInnerUrls(n,r,o,s,b,Ki);else{var w=h.texturePath;w&&e._addHierarchyInnerUrls(a,r,o,s,w,hn)}}break;case"Terrain":e._addHierarchyInnerUrls(a,r,o,s,t.customProps.dataPath,xi)}var S=t.components;for(var I in S){var M=S[I];switch(I){case"Animator":var C=M.avatarPath;if(C)e._addHierarchyInnerUrls(a,r,o,s,C,mi);else{var k=M.avatar;k&&e._addHierarchyInnerUrls(a,r,o,s,k.path,mi)}var E=M.clipPaths;for(l=0,c=E.length;l<c;l++)e._addHierarchyInnerUrls(a,r,o,s,E[l],_i)}}var T=t.child;for(l=0,c=T.length;l<c;l++)e._getSprite3DHierarchyInnerUrls(T[l],i,n,a,r,o,s)},e._loadHierarchy=function(t){t.on("loaded",null,e._onHierarchylhLoaded,[t,t._class._getGroup()]),t.load(t.url,"json",!1,null,!0)},e._onHierarchylhLoaded=function(t,i,n){if(t._class.destroyed)t.endLoad();else{var a=t.url,r=Jt.getURLVerion(a),o=D.getPathcaps(a),s=[],h=[],l=[],c={};e._getSprite3DHierarchyInnerUrls(n,s,h,l,c,r,o);var p=s.length+h.length+l.length,u=p+1,d=1/u;if(e._onProcessChange(t,0,d,1),l.length>0){var _=p/u,m=y.create(null,e._onProcessChange,[t,d,_],!1);e._innerFourthLevelLoaderManager.create(l,y.create(null,e._onHierarchyInnerForthLevResouLoaded,[t,i,m,n,c,s,h,d+_*l.length,_]),m,null,null,1,!0,i)}else e._onHierarchyInnerForthLevResouLoaded(t,i,null,n,c,s,h,d,_)}},e._onHierarchyInnerForthLevResouLoaded=function(t,i,n,a,r,o,s,h,l){if(t._class.destroyed)t.endLoad();else if(n&&n.recover(),s.length>0){var c=y.create(null,e._onProcessChange,[t,h,l],!1);e._innerSecondLevelLoaderManager.create(s,y.create(null,e._onHierarchyInnerSecondLevResouLoaded,[t,i,c,a,r,o,h+l*s.length,l]),n,null,null,1,!0,i)}else e._onHierarchyInnerSecondLevResouLoaded(t,i,null,a,r,o,h,l)},e._onHierarchyInnerSecondLevResouLoaded=function(t,i,n,a,r,o,s,h){if(t._class.destroyed)t.endLoad();else if(n&&n.recover(),o.length>0){var l=y.create(null,e._onProcessChange,[t,s,h],!1);e._innerFirstLevelLoaderManager.create(o,y.create(null,e._onHierarchyInnerFirstLevResouLoaded,[t,l,a,r]),n,null,null,1,!0,i)}else e._onHierarchyInnerFirstLevResouLoaded(t,null,a,r)},e._onHierarchyInnerFirstLevResouLoaded=function(e,t,i,n){t&&t.recover(),e.endLoad([i,n])},e._loadTerrain=function(t){t.on("loaded",null,e._onTerrainLtLoaded,[t,t._class._getGroup()]),t.load(t.url,"json",!1,null,!0)},e._onTerrainLtLoaded=function(t,i,n){if(t._class.destroyed)t.endLoad();else{var a,r,o=t.url,s=Jt.getURLVerion(o),h=D.getPathcaps(o),l=[],c={},p=0,u=0,d=n.heightData;a=d.url,r=e.formatRelativePath(h,a),s&&(r+=s),c[a]=r,a=r;var _=n.detailTexture;for(p=0,u=_.length;p<u;p++)l.push({url:_[p].diffuse});var m=n.normalMap;for(p=0,u=m.length;p<u;p++)l.push({url:m[p]});var f=n.alphaMap;for(p=0,u=f.length;p<u;p++)l.push({url:f[p],params:[!1,!1,6408,!0]});for(p=0,u=l.length;p<u;p++){var g=l[p].url;r=e.formatRelativePath(h,g),s&&(r+=s),l[p].url=r,c[g]=r}var v=l.length,x=v+2,b=1/x;e._onProcessChange(t,0,b,1);var w={heightMapLoaded:!1,texturesLoaded:!1},S=y.create(null,e._onProcessChange,[t,b,b],!1);e._innerFourthLevelLoaderManager.create(a,y.create(null,e._onTerrainHeightMapLoaded,[t,S,n,c,w]),S,null,[d.numX,d.numZ,d.bitType,d.value],1,!0,i);var I=y.create(null,e._onProcessChange,[t,2*b,v/x],!1);e._innerFourthLevelLoaderManager.create(l,y.create(null,e._onTerrainTexturesLoaded,[t,I,n,c,w]),I,null,null,1,!0,i)}},e._onTerrainHeightMapLoaded=function(e,t,i,n,a){a.heightMapLoaded=!0,a.texturesLoaded&&(e.endLoad([i,n]),t.recover())},e._onTerrainTexturesLoaded=function(e,t,i,n,a){a.texturesLoaded=!0,a.heightMapLoaded&&(e.endLoad([i,n]),t.recover())},e._loadMesh=function(t){t.on("loaded",null,e._onMeshLmLoaded,[t,t._class._getGroup()]),t.load(t.url,"arraybuffer",!1,null,!0)},e._onMeshLmLoaded=function(t,i,n){if(t._class.destroyed)t.endLoad();else{var a,r,o=t.url,s=Jt.getURLVerion(o),h=D.getPathcaps(o),l={},c=0,p=0,u=0;(e._readData=new _(n)).pos=0;switch(e._readData.readUTFString()){case"LAYAMODEL:02":case"LAYAMODEL:03":case"LAYAMODEL:0301":var d=e._readData.getUint32();e._readData.pos=e._readData.pos+4,u=e._readData.getUint16(),e._readData.pos=e._readData.pos+8*u;var m=e._readData.getUint32();for(u=e._readData.getUint16(),e._readData.pos=d+m,a=[],c=0;c<u;c++){var f=e._readData.readUTFString();-1!==f.lastIndexOf(".lmat")&&a.push(f)}break;default:for(e.READ_BLOCK(),c=0;c<2;c++){var g=e._readData.getUint16(),v=e._strings[g],x=e["READ_"+v];if(null==x)throw new Error("model file err,no this function:"+g+" "+v);1===c?a=x.call():x.call()}}for(c=0,p=a.length;c<p;c++){var b=a[c];r=e.formatRelativePath(h,b),s&&(r+=s),a[c]=r,l[b]=r}if(a.length>0){e._onProcessChange(t,0,.5,1);var w=y.create(null,e._onProcessChange,[t,.5,.5],!1);e._innerSecondLevelLoaderManager.create(a,y.create(null,e._onMeshMateialLoaded,[t,w,n,l]),w,null,null,1,!0,i)}else t.endLoad([n,l])}},e._onMeshMateialLoaded=function(e,t,i,n){e.endLoad([i,n]),t.recover()},e._getMaterialTexturePath=function(t,i,n){var a=t.length-4;return t.indexOf(".dds")!=a&&t.indexOf(".tga")!=a&&t.indexOf(".exr")!=a&&t.indexOf(".DDS")!=a&&t.indexOf(".TGA")!=a&&t.indexOf(".EXR")!=a||(t=t.substr(0,a)+".png"),t=e.formatRelativePath(n,t),i&&(t+=i),t},e._loadMaterial=function(t){t.on("loaded",null,e._onMaterilLmatLoaded,[t,t._class._getGroup()]),t.load(t.url,"json",!1,null,!0)},e._onMaterilLmatLoaded=function(t,i,n){if(t._class.destroyed)t.endLoad();else{var a,r=t.url,o=Jt.getURLVerion(r),s=D.getPathcaps(r),h=[],l={},c=n.customProps,p=n.version;if(p)switch(p){case"LAYAMATERIAL:01":case"LAYAMATERIAL:02":for(var u=n.props.textures,d=0,_=u.length;d<_;d++){var m=u[d],f=m.path;if(f){var g=f.length-4;f.indexOf(".exr")!=g&&f.indexOf(".EXR")!=g||(f=f.substr(0,g)+".png"),a=e.formatRelativePath(s,f),o&&(a+=o),h.push({url:a,params:m.params}),l[f]=a}}break;default:throw new Error("Laya3D:unkonwn version.")}else{var v=c.diffuseTexture.texture2D;if(v&&(a=e._getMaterialTexturePath(v,o,s),h.push(a),l[v]=a),c.normalTexture){var x=c.normalTexture.texture2D;x&&(a=e._getMaterialTexturePath(x,o,s),h.push(a),l[x]=a)}if(c.specularTexture){var b=c.specularTexture.texture2D;b&&(a=e._getMaterialTexturePath(b,o,s),h.push(a),l[b]=a)}if(c.emissiveTexture){var w=c.emissiveTexture.texture2D;w&&(a=e._getMaterialTexturePath(w,o,s),h.push(a),l[w]=a)}if(c.ambientTexture){var S=c.ambientTexture.texture2D;S&&(a=e._getMaterialTexturePath(S,o,s),h.push(a),l[S]=a)}if(c.reflectTexture){var I=c.reflectTexture.texture2D;I&&(a=e._getMaterialTexturePath(I,o,s),h.push(a),l[I]=a)}}var M=h.length,C=M+1,k=1/C;if(e._onProcessChange(t,0,k,1),M>0){var E=y.create(null,e._onProcessChange,[t,k,M/C],!1);e._innerFourthLevelLoaderManager.create(h,y.create(null,e._onMateialTexturesLoaded,[t,E,n,l]),E,hn,null,1,!0,i)}else e._onMateialTexturesLoaded(t,null,n,null)}},e._onMateialTexturesLoaded=function(e,t,i,n){e.endLoad([i,n]),t&&t.recover()},e._loadTextureCube=function(t){t.on("loaded",null,e._onTextureCubeLtcLoaded,[t]),t.load(t.url,"json",!1,null,!0)},e._onTextureCubeLtcLoaded=function(t,i){if(t._class.destroyed)t.endLoad();else{var n=D.getPathcaps(t.url),a=[e.formatRelativePath(n,i.px),e.formatRelativePath(n,i.nx),e.formatRelativePath(n,i.py),e.formatRelativePath(n,i.ny),e.formatRelativePath(n,i.pz),e.formatRelativePath(n,i.nz)];e._onProcessChange(t,0,1/7,1);var r=y.create(null,e._onProcessChange,[t,1/7,6/7],!1);e._innerFourthLevelLoaderManager.load(a,y.create(null,e._onTextureCubeImagesLoaded,[t,a,r]),r,"nativeimage")}},e._onTextureCubeImagesLoaded=function(e,t,i){var n=[];n.length=6;for(var a=0;a<6;a++){var r=t[a];n[a]=v.getRes(r),v.clearRes(r)}e.endLoad(n),i.recover()},e._onProcessChange=function(e,t,i,n){(n=t+n*i)<1&&e.event("progress",n)},e.init=function(t,n,a,r,o,s){void 0===a&&(a=!1),void 0===r&&(r=!1),void 0===o&&(o=!0),void 0===s&&(s=!0),C.update3DLoop=function(){ni._triggerCollision()},C.cancelLoadByUrl=function(t){e._cancelLoadByUrl(t)},f.isAntialias=a,f.isAlpha=r,f.premultipliedAlpha=o,f.isStencil=s,A.enable()?(C.changeWebGLSize=e._changeWebGLSize,S.is3DMode=!0,i.init(t,n),X.__init__(),jt.__init__(),Ui.__init__(),Ut.__init__(),gn.__init__(),V.__init__(),e.__init__(),c.maxTextureCount=2,(e.debugMode||de.debugMode)&&(e._debugPhasorSprite=new le)):alert("Laya3D init error,must support webGL!")},e.HIERARCHY="SPRITE3DHIERARCHY",e.MESH="MESH",e.MATERIAL="MATERIAL",e.PBRMATERIAL="PBRMTL",e.TEXTURECUBE="TEXTURECUBE",e.TERRAIN="TERRAIN",e._readData=null,e._debugPhasorSprite=null,e.debugMode=!1,n(e,["_DATA",function(){return this._DATA={offset:0,size:0}},"_strings",function(){return this._strings=["BLOCK","DATA","STRINGS"]},"_innerFirstLevelLoaderManager",function(){return this._innerFirstLevelLoaderManager=new x},"_innerSecondLevelLoaderManager",function(){return this._innerSecondLevelLoaderManager=new x},"_innerThirdLevelLoaderManager",function(){return this._innerThirdLevelLoaderManager=new x},"_innerFourthLevelLoaderManager",function(){return this._innerFourthLevelLoaderManager=new x}]),e}(),Qt=function(e){function t(e){t.__super.call(this),this._owner=e,this._childs=[],this._localMatrix=new Float32Array(16),this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0}a(t,"laya.d3.animation.AnimationTransform3D",g);var i=t.prototype;return i._getlocalMatrix=function(){return this._localUpdate&&(Jt._createAffineTransformationArray(this._localPosition,this._localRotation,this._localScale,this._localMatrix),this._localUpdate=!1),this._localMatrix},i._onWorldTransform=function(){if(!this._worldUpdate){this._worldUpdate=!0;for(var e=0,t=this._childs.length;e<t;e++)this._childs[e]._onWorldTransform()}},i._setWorldMatrixAndUpdate=function(e){if(this._worldMatrix=e,null==this._parent)throw new Error("don't need to set worldMatrix to root Node.");if(null==this._parent._parent)for(var t=this._getlocalMatrix(),i=0;i<16;++i)this._worldMatrix[i]=t[i];else Jt.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);this._worldUpdate=!1},i._setWorldMatrixNoUpdate=function(e){this._worldMatrix=e},i._setWorldMatrixIgnoreUpdate=function(e){this._worldMatrix=e,this._worldUpdate=!1},i.getLocalPosition=function(){return this._localPosition},i.setLocalPosition=function(e){if(this._parent)this._localPosition=e,this._localUpdate=!0,this._onWorldTransform();else{var t=this._entity.owner._transform,i=this._entity.localPosition,n=i.elements;n[0]=e[0],n[1]=e[1],n[2]=e[2],t.localPosition=i}},i.getLocalRotation=function(){if(this._localQuaternionUpdate){var e=this._localRotationEuler;Jt._quaternionCreateFromYawPitchRollArray(e[1]/t._angleToRandin,e[0]/t._angleToRandin,e[2]/t._angleToRandin,this._localRotation),this._localQuaternionUpdate=!1}return this._localRotation},i.setLocalRotation=function(e){if(this._parent)this._localRotation=e,Jt.quaterionNormalize(this._localRotation,this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var t=this._entity.owner._transform,i=this._entity.localRotation,n=i.elements;n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],t.localRotation=i}},i.getLocalScale=function(){return this._localScale},i.setLocalScale=function(e){if(this._parent)this._localScale=e,this._localUpdate=!0,this._onWorldTransform();else{var t=this._entity.owner._transform,i=this._entity.localScale,n=i.elements;n[0]=e[0],n[1]=e[1],n[2]=e[2],t.localScale=i}},i.getLocalRotationEuler=function(){if(this._locaEulerlUpdate){Jt.getYawPitchRoll(this._localRotation,t._tempVector3);var e=t._tempVector3,i=this._localRotationEuler;i[0]=e[1]*t._angleToRandin,i[1]=e[0]*t._angleToRandin,i[2]=e[2]*t._angleToRandin,this._locaEulerlUpdate=!1}return this._localRotationEuler},i.setLocalRotationEuler=function(e){if(this._parent)Jt._quaternionCreateFromYawPitchRollArray(e[1]/t._angleToRandin,e[0]/t._angleToRandin,e[2]/t._angleToRandin,this._localRotation),this._localRotationEuler=e,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var i=this._entity.owner._transform,n=this._entity.localRotationEuler,a=n.elements;a[0]=e[0],a[1]=e[1],a[2]=e[2],i.localRotationEuler=n}},i.getWorldMatrix=function(){if(this._worldUpdate){if(null!=this._parent._parent)Jt.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);else for(var e=this._getlocalMatrix(),t=0;t<16;++t)this._worldMatrix[t]=e[t];this._worldUpdate=!1}return this._worldMatrix},i.setParent=function(e){if(this._parent!==e){if(this._parent){var t=this._parent._childs,i=t.indexOf(this);t.splice(i,1)}e&&(e._childs.push(this),e&&this._onWorldTransform()),this._parent=e}},n(t,["_tempVector3",function(){return this._tempVector3=new Float32Array(3)},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),t}(),$t=function(e){function t(){this._destroyed=!1,this._id=0,this._enable=!1,this._owner=null,this.started=!1,t.__super.call(this),this._destroyed=!1,this._id=t._uniqueIDCounter,t._uniqueIDCounter++}a(t,"laya.d3.component.Component3D",g);var n=t.prototype;return i.imps(n,{"laya.d3.core.render.IUpdate":!0,"laya.resource.IDestroy":!0}),n._initialize=function(e){this._owner=e,this._enable=!0,this.started=!1,this._load(e)},n._destroy=function(){this._unload(this._owner),this._owner=null,this._destroyed=!0},n._load=function(e){},n._start=function(e){},n._update=function(e){},n._lateUpdate=function(e){},n._preRenderUpdate=function(e){},n._postRenderUpdate=function(e){},n._unload=function(e){this.offAll()},n._cloneTo=function(e){},r(0,n,"id",function(){return this._id}),r(0,n,"destroyed",function(){return this._destroyed}),r(0,n,"owner",function(){return this._owner}),r(0,n,"enable",function(){return this._enable},function(e){this._enable!==e&&(this._enable=e,this.event("enablechanged",this._enable))}),r(0,n,"isSingleton",function(){return t._isSingleton}),t._isSingleton=!0,t._uniqueIDCounter=1,t}(),ei=function(e){function t(){this._destroyed=!1,t.__super.call(this),this._destroyed=!1}a(t,"laya.d3.core.GeometryFilter",g);var n=t.prototype;return i.imps(n,{"laya.resource.IDestroy":!0}),n._destroy=function(){this.offAll(),this._destroyed=!0},r(0,n,"_isAsyncLoaded",function(){return!0}),r(0,n,"_originalBoundingBoxCorners",function(){throw new Error("BaseRender: must override it.")}),r(0,n,"_originalBoundingSphere",function(){throw new Error("BaseRender: must override it.")}),r(0,n,"_originalBoundingBox",function(){throw new Error("BaseRender: must override it.")}),r(0,n,"destroyed",function(){return this._destroyed}),t}(),ti=function(e){function t(e){t.__super.call(this),this._id=++t._uniqueIDCounter,this._indexInSceneFrustumCullingObjects=-1,this._boundingBox=new xt(new At,new At),this._boundingBoxCenter=new At,this._boundingSphere=new wt(new At,0),this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0,this._materials=[],this._renderElements=[],this._isPartOfStaticBatch=!1,this._destroyed=!1,this._owner=e,this._enable=!0,this._materialsInstance=[],this.lightmapIndex=-1,this.castShadow=!1,this.receiveShadow=!1,this.sortingFudge=0,this._owner.transform.on("worldmatrixneedchanged",this,this._onWorldMatNeedChange)}a(t,"laya.d3.core.render.BaseRender",g);var o=t.prototype;return i.imps(o,{"laya.resource.IDestroy":!0}),o._changeMaterialReference=function(e,t){e&&e._removeReference(),t._addReference()},o._getInstanceMaterial=function(e,t){var i=new e.constructor;return e.cloneTo(i),i.name=i.name+"(Instance)",this._materialsInstance[t]=!0,this._changeMaterialReference(this._materials[t],i),this._materials[t]=i,i},o._setShaderValuelightMap=function(e){this._setShaderValueTexture(3,e)},o._onWorldMatNeedChange=function(){this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0},o._renderRenderableBoundBox=function(){var e=Zt._debugPhasorSprite,i=this.boundingBox,n=t._tempBoundBoxCorners;i.getCorners(n),e.line(n[0],t._greenColor,n[1],t._greenColor),e.line(n[2],t._greenColor,n[3],t._greenColor),e.line(n[4],t._greenColor,n[5],t._greenColor),e.line(n[6],t._greenColor,n[7],t._greenColor),e.line(n[0],t._greenColor,n[3],t._greenColor),e.line(n[1],t._greenColor,n[2],t._greenColor),e.line(n[2],t._greenColor,n[6],t._greenColor),e.line(n[3],t._greenColor,n[7],t._greenColor),e.line(n[0],t._greenColor,n[4],t._greenColor),e.line(n[1],t._greenColor,n[5],t._greenColor),e.line(n[4],t._greenColor,n[7],t._greenColor),e.line(n[5],t._greenColor,n[6],t._greenColor)},o._calculateBoundingSphere=function(){throw"BaseRender: must override it."},o._calculateBoundingBox=function(){throw"BaseRender: must override it."},o._setShaderValueTexture=function(e,t){this._owner._shaderValues.setValue(e,t)},o._setShaderValueMatrix4x4=function(e,t){this._owner._shaderValues.setValue(e,t?t.elements:null)},o._setShaderValueColor=function(e,t){this._owner._shaderValues.setValue(e,t?t.elements:null)},o._setShaderValueBuffer=function(e,t){this._owner._shaderValues.setValue(e,t)},o._setShaderValueInt=function(e,t){this._owner._shaderValues.setValue(e,t)},o._setShaderValueBool=function(e,t){this._owner._shaderValues.setValue(e,t)},o._setShaderValueNumber=function(e,t){this._owner._shaderValues.setValue(e,t)},o._setShaderValueVector2=function(e,t){this._owner._shaderValues.setValue(e,t?t.elements:null)},o._addShaderDefine=function(e){this._owner._shaderDefineValue|=e},o._removeShaderDefine=function(e){this._owner._shaderDefineValue&=~e},o._renderUpdate=function(e){return!0},o._applyLightMapParams=function(){if(this._lightmapIndex>=0){var e=this._owner.scene;if(e){var t=e.getlightmaps()[this._lightmapIndex];t?(this._addShaderDefine(un.SAHDERDEFINE_LIGHTMAP),t.loaded?this._setShaderValuelightMap(t):t.once("loaded",this,this._setShaderValuelightMap)):this._removeShaderDefine(un.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(un.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(un.SAHDERDEFINE_LIGHTMAP)},o._updateOctreeNode=function(){var e=this._treeNode;e&&this._octreeNodeNeedChange&&(e.updateObject(this),this._octreeNodeNeedChange=!1)},o._destroy=function(){this.offAll();var e=0,t=0;for(e=0,t=this._renderElements.length;e<t;e++)this._renderElements[e]._destroy();for(e=0,t=this._materials.length;e<t;e++)this._materials[e]._removeReference();this._renderElements=null,this._owner=null,this._materials=null,this._boundingBox=null,this._boundingBoxCenter=null,this._boundingSphere=null,this._lightmapScaleOffset=null,this._destroyed=!0},r(0,o,"boundingSphere",function(){return this._boundingSphereNeedChange&&(this._calculateBoundingSphere(),this._boundingSphereNeedChange=!1),this._boundingSphere}),r(0,o,"id",function(){return this._id}),r(0,o,"material",function(){var e=this._materials[0];if(e&&!this._materialsInstance[0]){var t=this._getInstanceMaterial(e,0);this.event("materialchanged",[this,0,t])}return this._materials[0]},function(e){this.sharedMaterial=e}),r(0,o,"sharedMaterial",function(){return this._materials[0]},function(e){var t=this._materials[0];t!==e&&(this._materials[0]=e,this._materialsInstance[0]=!1,this._changeMaterialReference(t,e),this.event("materialchanged",[this,0,e]))}),r(0,o,"lightmapIndex",function(){return this._lightmapIndex},function(e){this._lightmapIndex=e,this._applyLightMapParams()}),r(0,o,"lightmapScaleOffset",function(){return this._lightmapScaleOffset},function(e){this._lightmapScaleOffset=e,this._setShaderValueColor(2,e),this._addShaderDefine(un.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV)}),r(0,o,"enable",function(){return this._enable},function(e){this._enable=e,this.event("enablechanged",[this,e])}),r(0,o,"materials",function(){for(var e=0,t=this._materials.length;e<t;e++)if(!this._materialsInstance[e]){var i=this._getInstanceMaterial(this._materials[e],e);this.event("materialchanged",[this,e,i])}return this._materials.slice()},function(e){this.sharedMaterials=e}),r(0,o,"sharedMaterials",function(){return this._materials.slice()},function(e){if(!e)throw new Error("MeshRender: shadredMaterials value can't be null.");var t=e.length;this._materialsInstance.length=t;for(var i=0;i<t;i++){var n=this._materials[i];n!==e[i]&&(this._materialsInstance[i]=!1,this._changeMaterialReference(n,e[i]),this.event("materialchanged",[this,i,e[i]]))}this._materials=e}),r(0,o,"boundingBox",function(){return this._boundingBoxNeedChange&&(this._calculateBoundingBox(),this._boundingBoxNeedChange=!1),this._boundingBox}),r(0,o,"boundingBoxCenter",function(){if(this._boundingBoxCenterNeedChange){var e=this.boundingBox;At.add(e.min,e.max,this._boundingBoxCenter),At.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter),this._boundingBoxCenterNeedChange=!1}return this._boundingBoxCenter}),r(0,o,"receiveShadow",function(){return this._receiveShadow},function(e){this._receiveShadow!==e&&(this._receiveShadow=e,e?this._addShaderDefine(Ht.SHADERDEFINE_RECEIVE_SHADOW):this._removeShaderDefine(Ht.SHADERDEFINE_RECEIVE_SHADOW))}),r(0,o,"destroyed",function(){return this._destroyed}),t._uniqueIDCounter=0,n(t,["_tempBoundBoxCorners",function(){return this._tempBoundBoxCorners=[new At,new At,new At,new At,new At,new At,new At,new At]},"_greenColor",function(){return this._greenColor=new Rt(0,1,0,1)}]),t}(),ii=function(e){function t(e){this._owner=null,this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0,this._positionUpdate=!0,this._rotationUpdate=!0,this._scaleUpdate=!0,this._parent=null,this._childs=null,this._dummy=null,this.pivot=null,t.__super.call(this),this._localPosition=new At,this._localRotation=new Tt(0,0,0,1),this._localScale=new At(1,1,1),this._localRotationEuler=new At,this._localMatrix=new Ct,this._position=new At,this._rotation=new Tt(0,0,0,1),this._scale=new At(1,1,1),this._worldMatrix=new Ct,this._forward=new At,this._up=new At,this._right=new At,this._owner=e,this._childs=[]}a(t,"laya.d3.core.Transform3D",g);var i=t.prototype;return i._updateLocalMatrix=function(){if(!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z)Ct.createAffineTransformation(this._localPosition,this.localRotation,this._localScale,this._localMatrix);else{var e=t._tempVector30;At.multiply(this.pivot,this._localScale,e);var i=t._tempVector31;At.subtract(e,this.pivot,i);var n=t._tempVector32,a=this.localRotation;At.transformQuat(e,a,n),At.subtract(n,e,n);var r=t._tempVector33;At.subtract(this._localPosition,i,r),At.subtract(r,n,r),Ct.createAffineTransformation(r,a,this._localScale,this._localMatrix)}},i._onWorldPositionRotationTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._rotationUpdate){this._worldUpdate=this._positionUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var e=0,t=this._childs.length;e<t;e++)this._childs[e]._onWorldPositionRotationTransform()}},i._onWorldPositionScaleTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._scaleUpdate){this._worldUpdate=this._positionUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var e=0,t=this._childs.length;e<t;e++)this._childs[e]._onWorldPositionScaleTransform()}},i._onWorldPositionTransform=function(){if(!this._worldUpdate||!this._positionUpdate){this._worldUpdate=this._positionUpdate=!0,this.event("worldmatrixneedchanged");for(var e=0,t=this._childs.length;e<t;e++)this._childs[e]._onWorldPositionTransform()}},i._onWorldRotationTransform=function(){if(!this._worldUpdate||!this._rotationUpdate){this._worldUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var e=0,t=this._childs.length;e<t;e++)this._childs[e]._onWorldPositionRotationTransform()}},i._onWorldScaleTransform=function(){if(!this._worldUpdate||!this._scaleUpdate){this._worldUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var e=0,t=this._childs.length;e<t;e++)this._childs[e]._onWorldPositionScaleTransform()}},i._onWorldTransform=function(){if(!(this._worldUpdate&&this._positionUpdate&&this._rotationUpdate&&this._scaleUpdate)){this._worldUpdate=this._positionUpdate=this._rotationUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var e=0,t=this._childs.length;e<t;e++)this._childs[e]._onWorldTransform()}},i.translate=function(e,i){void 0===i&&(i=!0),i?(Ct.createFromQuaternion(this.localRotation,t._tempMatrix0),At.transformCoordinate(e,t._tempMatrix0,t._tempVector30),At.add(this.localPosition,t._tempVector30,this._localPosition),this.localPosition=this._localPosition):(At.add(this.position,e,this._position),this.position=this._position)},i.rotate=function(e,i,n){void 0===i&&(i=!0),void 0===n&&(n=!0);var a;n?a=e:(At.scale(e,Math.PI/180,t._tempVector30),a=t._tempVector30),Tt.createFromYawPitchRoll(a.y,a.x,a.z,t._tempQuaternion0),i?(Tt.multiply(this._localRotation,t._tempQuaternion0,this._localRotation),this.localRotation=this._localRotation):(Tt.multiply(t._tempQuaternion0,this.rotation,this._rotation),this.rotation=this._rotation)},i.lookAt=function(e,t,i){void 0===i&&(i=!1);var n,a=e.elements;if(i){if(n=this._localPosition.elements,Math.abs(n[0]-a[0])<It.zeroTolerance&&Math.abs(n[1]-a[1])<It.zeroTolerance&&Math.abs(n[2]-a[2])<It.zeroTolerance)return;Tt.lookAt(this._localPosition,e,t,this._localRotation),this._localRotation.invert(this._localRotation),this.localRotation=this._localRotation}else{var r=this.position;if(n=r.elements,Math.abs(n[0]-a[0])<It.zeroTolerance&&Math.abs(n[1]-a[1])<It.zeroTolerance&&Math.abs(n[2]-a[2])<It.zeroTolerance)return;Tt.lookAt(r,e,t,this._rotation),this._rotation.invert(this._rotation),this.rotation=this._rotation}},r(0,i,"_isFrontFaceInvert",function(){var e=this.scale,t=e.x<0;return e.y<0&&(t=!t),e.z<0&&(t=!t),t}),r(0,i,"owner",function(){return this._owner}),r(0,i,"localRotation",function(){if(this._localQuaternionUpdate){var e=this._localRotationEuler.elements;Tt.createFromYawPitchRoll(e[1]/t._angleToRandin,e[0]/t._angleToRandin,e[2]/t._angleToRandin,this._localRotation)}return this._localRotation},function(e){this._localRotation=e,this._localRotation.normalize(this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),r(0,i,"worldMatrix",function(){return this._worldUpdate&&(null!=this._parent?Ct.multiply(this._parent.worldMatrix,this.localMatrix,this._worldMatrix):this.localMatrix.cloneTo(this._worldMatrix),this._worldUpdate=!1),this._worldMatrix},function(e){null===this._parent?e.cloneTo(this._localMatrix):(this._parent.worldMatrix.invert(this._localMatrix),Ct.multiply(this._localMatrix,e,this._localMatrix)),this.localMatrix=this._localMatrix,this._worldMatrix=e,this._worldUpdate=!1}),r(0,i,"worldNeedUpdate",function(){return this._worldUpdate}),r(0,i,"localMatrix",function(){return this._localUpdate&&(this._updateLocalMatrix(),this._localUpdate=!1),this._localMatrix},function(e){this._localMatrix=e,this._localMatrix.decomposeTransRotScale(this._localPosition,this._localRotation,this._localScale),this._localUpdate=!1,this._onWorldTransform()}),r(0,i,"dummy",function(){return this._dummy},function(e){this._dummy!==e&&(this._dummy&&(this._dummy._entity=null),e&&(e._entity=this),this._dummy=e)}),r(0,i,"localPosition",function(){return this._localPosition},function(e){this._localPosition=e,this._localUpdate=!0,this._onWorldPositionTransform()}),r(0,i,"position",function(){if(this._positionUpdate){if(null!=this._parent){var e=this._parent.position;At.multiply(this._localPosition,this._parent.scale,t._tempVector30),At.transformQuat(t._tempVector30,this._parent.rotation,t._tempVector30),At.add(e,t._tempVector30,this._position)}else this._localPosition.cloneTo(this._position);this._positionUpdate=!1}return this._position},function(e){if(null!=this._parent){At.subtract(e,this._parent.position,this._localPosition);var i=this._parent.scale.elements,n=i[0],a=i[1],r=i[2];if(1!==n||1!==a||1!==r){var o=t._tempVector30,s=o.elements;s[0]=1/n,s[1]=1/a,s[2]=1/r,At.multiply(this._localPosition,o,this._localPosition)}this._parent.rotation.invert(t._tempQuaternion0),At.transformQuat(this._localPosition,t._tempQuaternion0,this._localPosition)}else e.cloneTo(this._localPosition);this.localPosition=this._localPosition,this._position=e,this._positionUpdate=!1}),r(0,i,"localScale",function(){return this._localScale},function(e){this._localScale=e,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldScaleTransform():this._onWorldPositionScaleTransform()}),r(0,i,"localRotationEuler",function(){if(this._locaEulerlUpdate){this._localRotation.getYawPitchRoll(t._tempVector30);var e=t._tempVector30.elements,i=this._localRotationEuler.elements;i[0]=e[1]*t._angleToRandin,i[1]=e[0]*t._angleToRandin,i[2]=e[2]*t._angleToRandin}return this._localRotationEuler},function(e){this._localRotationEuler=e,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!0,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),r(0,i,"rotation",function(){return this._rotationUpdate&&(null!=this._parent?Tt.multiply(this._parent.rotation,this.localRotation,this._rotation):this.localRotation.cloneTo(this._rotation),this._rotationUpdate=!1),this._rotation},function(e){null!=this._parent?(this._parent.rotation.invert(t._tempQuaternion0),Tt.multiply(e,t._tempQuaternion0,this._localRotation)):e.cloneTo(this._localRotation),this.localRotation=this._localRotation,this._rotation=e,this._rotationUpdate=!1}),r(0,i,"scale",function(){return this._scaleUpdate?(null!==this._parent?At.multiply(this._parent.scale,this._localScale,this._scale):this._localScale.cloneTo(this._scale),this._scaleUpdate=!1,this._scale):this._scale},function(e){if(null!==this._parent){var i=this._parent.scale.elements,n=t._tempVector30.elements;n[0]=1/i[0],n[1]=1/i[1],n[2]=1/i[2],At.multiply(e,t._tempVector30,this._localScale)}else e.cloneTo(this._localScale);this.localScale=this._localScale,this._scale=e,this._scaleUpdate=!1}),r(0,i,"rotationEuler",null,function(e){Tt.createFromYawPitchRoll(e.y,e.x,e.z,this._rotation),this.rotation=this._rotation}),r(0,i,"forward",function(){var e=this.worldMatrix.elements;return this._forward.elements[0]=-e[8],this._forward.elements[1]=-e[9],this._forward.elements[2]=-e[10],this._forward}),r(0,i,"up",function(){var e=this.worldMatrix.elements;return this._up.elements[0]=e[4],this._up.elements[1]=e[5],this._up.elements[2]=e[6],this._up}),r(0,i,"right",function(){var e=this.worldMatrix.elements;return this._right.elements[0]=e[0],this._right.elements[1]=e[1],this._right.elements[2]=e[2],this._right}),r(0,i,"parent",function(){return this._parent},function(e){if(this._parent!==e){if(this._parent){var t=this._parent._childs,i=t.indexOf(this);t.splice(i,1)}e&&(e._childs.push(this),e&&this._onWorldTransform()),this._parent=e}}),n(t,["_tempVector30",function(){return this._tempVector30=new At},"_tempVector31",function(){return this._tempVector31=new At},"_tempVector32",function(){return this._tempVector32=new At},"_tempVector33",function(){return this._tempVector33=new At},"_tempQuaternion0",function(){return this._tempQuaternion0=new Tt},"_tempMatrix0",function(){return this._tempMatrix0=new Ct},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),t}(),ni=(function(e){function t(){this._rotation=0,this._matNeedUpdte=!1,t.__super.call(this),this._matrix=new Ct,this._offset=new Nt,this._tiling=new Nt(1,1)}a(t,"laya.d3.core.TransformUV",g);var o=t.prototype;i.imps(o,{"laya.d3.core.IClone":!0}),o._updateMatrix=function(){t._tempOffsetV3.elements[0]=this._offset.x,t._tempOffsetV3.elements[1]=this._offset.y,Tt.createFromYawPitchRoll(0,0,this._rotation,t._tempRotationQua),t._tempTitlingV3.elements[0]=this._tiling.x,t._tempTitlingV3.elements[1]=this._tiling.y,Ct.createAffineTransformation(t._tempOffsetV3,t._tempRotationQua,t._tempTitlingV3,this._matrix)},o.cloneTo=function(e){e._matrix=this._matrix.clone(),e._offset=this._offset.clone(),e._rotation=this._rotation,e._tiling=this._tiling.clone()},o.clone=function(){var e=new this.constructor;return this.cloneTo(e),e},r(0,o,"matrix",function(){return this._matNeedUpdte&&(this._updateMatrix(),this._matNeedUpdte=!1),this._matrix}),r(0,o,"tiling",function(){return this._tiling},function(e){this._tiling=e,this._matNeedUpdte=!0}),r(0,o,"offset",function(){return this._offset},function(e){this._offset=e,this._matNeedUpdte=!0}),r(0,o,"rotation",function(){return this._rotation},function(e){this._rotation=e,this._matNeedUpdte=!0}),n(t,["_tempOffsetV3",function(){return this._tempOffsetV3=new At(0,0,0)},"_tempRotationQua",function(){return this._tempRotationQua=new Tt},"_tempTitlingV3",function(){return this._tempTitlingV3=new At(1,1,1)}])}(),function(e){function t(){t.__super.call(this)}return a(t,"laya.d3.utils.CollisionManager",g),t._onTrigger=function(e,t,i,n,a){var r=0,o=0,s=e.id,h=t.id;if(!e._ignoreCollisonMap[h]){var l=jt.collisionManager,c=e._runtimeCollisonTestMap[h];if(null!=c)if(c)if(e._collisonTo(t))if(e._runtimeCollisonMap[h]){for(r=0,o=i.length;r<o;r++)i[r].onTriggerStay(t);for(r=0,o=n.length;r<o;r++)n[r].onTriggerStay(e);l.event("triggerstay",[e,t])}else{for(e._runtimeCollisonMap[h]=t,e._runtimeCollisonTestMap[h]=!1,t._runtimeCollisonMap[s]=e,a&&(t._runtimeCollisonTestMap[s]=!1),r=0,o=i.length;r<o;r++)i[r].onTriggerEnter(t);for(r=0,o=n.length;r<o;r++)n[r].onTriggerEnter(e);l.event("triggerenter",[e,t])}else{var p=e._runtimeCollisonMap;if(p[h]){for(delete p[h],delete e._runtimeCollisonTestMap[h],delete t._runtimeCollisonMap[s],a&&delete t._runtimeCollisonTestMap[s],r=0,o=i.length;r<o;r++)i[r].onTriggerExit(t);for(r=0,o=n.length;r<o;r++)n[r].onTriggerExit(e);l.event("triggerexit",[e,t])}}else{for(r=0,o=i.length;r<o;r++)i[r].onTriggerStay(t);for(r=0,o=n.length;r<o;r++)n[r].onTriggerStay(e);l.event("triggerstay",[e,t])}else if(e._collisonTo(t)){for(e._runtimeCollisonMap[h]=t,e._runtimeCollisonTestMap[h]=!1,t._runtimeCollisonMap[s]=e,a&&(t._runtimeCollisonTestMap[s]=!1),r=0,o=i.length;r<o;r++)i[r].onTriggerEnter(t);for(r=0,o=n.length;r<o;r++)n[r].onTriggerEnter(e);l.event("triggerenter",[e,t])}}},t._triggerCollision=function(){for(var e=X._collsionTestList,i=e.length,n=jt._layerCollsionMatrix,a=0;a<i;a++)for(var r=e[a],o=X.getLayerByNumber(r),s=o._colliders,h=o._nonRigidbodyOffset,l=i-1;l>=a;l--){var c=e[l];if(n[r][30-c]){var p,u,d,_=0,m=0,f=0,g=0,y=X.getLayerByNumber(c),v=y._colliders,x=y._nonRigidbodyOffset;if(o!==y){for(_=0;_<h;_++)if((p=s[_]).enable){for(d=p.owner._scripts,f=0,g=x;f<g;f++)(u=v[f]).enable&&t._onTrigger(p,u,d,u.owner._scripts,!0);for(f=x,g=v.length;f<g;f++)(u=v[f]).enable&&t._onTrigger(p,u,d,u.owner._scripts,!1)}for(_=h,m=s.length;_<m;_++)if((p=s[_]).enable)for(d=p.owner._scripts,f=0,g=y._nonRigidbodyOffset;f<g;f++)(u=v[f]).enable&&t._onTrigger(u,p,d,u.owner._scripts,!1)}else for(_=0;_<h;_++)if((p=s[_]).enable){for(d=p.owner._scripts,f=_+1,g=h;f<g;f++)(u=v[f]).enable&&t._onTrigger(p,u,d,u.owner._scripts,!0);for(f=h,g=s.length;f<g;f++)(u=v[f]).enable&&t._onTrigger(p,u,d,u.owner._scripts,!1)}}}},t}()),ai=(function(e){function t(){t.__super.call(this)}a(t,"laya.d3.core.glitter.SplineCurvePosition",e);var i=t.prototype;i._CalcVelocity=function(e,t,i){At.subtract(e,t,i),At.scale(i,.5,i)},i.Init=function(t,i,n,a){this._CalcVelocity(i,t,this._tempVector30),this._CalcVelocity(a,n,this._tempVector31),e.prototype.Init.call(this,i,this._tempVector30,a,this._tempVector31)}}(H),function(e){function t(){this.x=NaN,this.y=NaN,this.z=NaN,t.__super.call(this),this.x=1,this.y=1,this.z=1,this.randomDirection=!1}a(t,"laya.d3.core.particleShuriKen.module.shape.BoxShape",e);var i=t.prototype;return i._getShapeBoundBox=function(e){var t=e.min.elements;t[0]=.5*-this.x,t[1]=.5*-this.y,t[2]=.5*-this.z;var i=e.max.elements;i[0]=.5*this.x,i[1]=.5*this.y,i[2]=.5*this.z},i._getSpeedBoundBox=function(e){var t=e.min.elements;t[0]=0,t[1]=0,t[2]=0;var i=e.max.elements;i[0]=0,i[1]=1,i[2]=0},i.generatePositionAndDirection=function(e,t,i,n){var a=e.elements,r=t.elements;i?(i.seed=n[16],ne._randomPointInsideHalfUnitBox(e,i),n[16]=i.seed):ne._randomPointInsideHalfUnitBox(e),a[0]=this.x*a[0],a[1]=this.y*a[1],a[2]=this.z*a[2],this.randomDirection?i?(i.seed=n[17],ne._randomPointUnitSphere(t,i),n[17]=i.seed):ne._randomPointUnitSphere(t):(r[0]=0,r[1]=0,r[2]=1)},i.cloneTo=function(t){e.prototype.cloneTo.call(this,t);var i=t;i.x=this.x,i.y=this.y,i.z=this.z,i.randomDirection=this.randomDirection},t}(ie)),ri=function(e){function t(){this.radius=NaN,this.arc=NaN,this.emitFromEdge=!1,t.__super.call(this),this.radius=1,this.arc=2*Math.PI,this.emitFromEdge=!1,this.randomDirection=!1}a(t,"laya.d3.core.particleShuriKen.module.shape.CircleShape",e);var i=t.prototype;return i._getShapeBoundBox=function(e){var t=e.min.elements;t[0]=t[2]=-this.radius,t[1]=0;var i=e.max.elements;i[0]=i[2]=this.radius,i[1]=0},i._getSpeedBoundBox=function(e){var t=e.min.elements;t[0]=t[1]=-1,t[2]=0;var i=e.max.elements;i[0]=i[1]=1,i[2]=0},i.generatePositionAndDirection=function(e,i,n,a){var r=e.elements,o=t._tempPositionPoint.elements;n?(n.seed=a[16],this.emitFromEdge?ne._randomPointUnitArcCircle(this.arc,t._tempPositionPoint,n):ne._randomPointInsideUnitArcCircle(this.arc,t._tempPositionPoint,n),a[16]=n.seed):this.emitFromEdge?ne._randomPointUnitArcCircle(this.arc,t._tempPositionPoint):ne._randomPointInsideUnitArcCircle(this.arc,t._tempPositionPoint),r[0]=-o[0],r[1]=o[1],r[2]=0,At.scale(e,this.radius,e),this.randomDirection?n?(n.seed=a[17],ne._randomPointUnitSphere(i,n),a[17]=n.seed):ne._randomPointUnitSphere(i):e.cloneTo(i)},i.cloneTo=function(t){e.prototype.cloneTo.call(this,t);var i=t;i.radius=this.radius,i.arc=this.arc,i.emitFromEdge=this.emitFromEdge,i.randomDirection=this.randomDirection},n(t,["_tempPositionPoint",function(){return this._tempPositionPoint=new Nt}]),t}(ie),oi=function(e){function t(){this.angle=NaN,this.radius=NaN,this.length=NaN,this.emitType=0,t.__super.call(this),this.angle=25/180*Math.PI,this.radius=1,this.length=5,this.emitType=0,this.randomDirection=!1}a(t,"laya.d3.core.particleShuriKen.module.shape.ConeShape",e);var i=t.prototype;return i._getShapeBoundBox=function(e){var t=this.radius+this.length*Math.sin(this.angle),i=this.length*Math.cos(this.angle),n=e.min.elements;n[0]=n[1]=-t,n[2]=0;var a=e.max.elements;a[0]=a[1]=t,a[2]=i},i._getSpeedBoundBox=function(e){var t=Math.sin(this.angle),i=e.min.elements;i[0]=i[1]=-t,i[2]=0;var n=e.max.elements;n[0]=i[1]=t,n[2]=1},i.generatePositionAndDirection=function(e,i,n,a){var r,o=e.elements,s=i.elements,h=t._tempPositionPoint.elements,l=NaN,c=NaN,p=Math.cos(this.angle),u=Math.sin(this.angle);switch(this.emitType){case 0:n?(n.seed=a[16],ne._randomPointInsideUnitCircle(t._tempPositionPoint,n),a[16]=n.seed):ne._randomPointInsideUnitCircle(t._tempPositionPoint),l=h[0],c=h[1],o[0]=l*this.radius,o[1]=c*this.radius,o[2]=0,this.randomDirection?(n?(n.seed=a[17],ne._randomPointInsideUnitCircle(t._tempDirectionPoint,n),a[17]=n.seed):ne._randomPointInsideUnitCircle(t._tempDirectionPoint),r=t._tempDirectionPoint.elements,s[0]=r[0]*u,s[1]=r[1]*u):(s[0]=l*u,s[1]=c*u),s[2]=p;break;case 1:n?(n.seed=a[16],ne._randomPointUnitCircle(t._tempPositionPoint,n),a[16]=n.seed):ne._randomPointUnitCircle(t._tempPositionPoint),l=h[0],c=h[1],o[0]=l*this.radius,o[1]=c*this.radius,o[2]=0,this.randomDirection?(n?(n.seed=a[17],ne._randomPointInsideUnitCircle(t._tempDirectionPoint,n),a[17]=n.seed):ne._randomPointInsideUnitCircle(t._tempDirectionPoint),r=t._tempDirectionPoint.elements,s[0]=r[0]*u,s[1]=r[1]*u):(s[0]=l*u,s[1]=c*u),s[2]=p;break;case 2:n?(n.seed=a[16],ne._randomPointInsideUnitCircle(t._tempPositionPoint,n)):ne._randomPointInsideUnitCircle(t._tempPositionPoint),l=h[0],c=h[1],o[0]=l*this.radius,o[1]=c*this.radius,o[2]=0,s[0]=l*u,s[1]=c*u,s[2]=p,At.normalize(i,i),n?(At.scale(i,this.length*n.getFloat(),i),a[16]=n.seed):At.scale(i,this.length*Math.random(),i),At.add(e,i,e),this.randomDirection&&(n?(n.seed=a[17],ne._randomPointUnitSphere(i,n),a[17]=n.seed):ne._randomPointUnitSphere(i));break;case 3:n?(n.seed=a[16],ne._randomPointUnitCircle(t._tempPositionPoint,n)):ne._randomPointUnitCircle(t._tempPositionPoint),l=h[0],c=h[1],o[0]=l*this.radius,o[1]=c*this.radius,o[2]=0,s[0]=l*u,s[1]=c*u,s[2]=p,At.normalize(i,i),n?(At.scale(i,this.length*n.getFloat(),i),a[16]=n.seed):At.scale(i,this.length*Math.random(),i),At.add(e,i,e),this.randomDirection&&(n?(n.seed=a[17],ne._randomPointUnitSphere(i,n),a[17]=n.seed):ne._randomPointUnitSphere(i));break;default:throw new Error("ConeShape:emitType is invalid.")}},i.cloneTo=function(t){e.prototype.cloneTo.call(this,t);var i=t;i.angle=this.angle,i.radius=this.radius,i.length=this.length,i.emitType=this.emitType,i.randomDirection=this.randomDirection},n(t,["_tempPositionPoint",function(){return this._tempPositionPoint=new Nt},"_tempDirectionPoint",function(){return this._tempDirectionPoint=new Nt}]),t}(ie),si=function(e){function t(){this.radius=NaN,this.emitFromShell=!1,t.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}a(t,"laya.d3.core.particleShuriKen.module.shape.HemisphereShape",e);var i=t.prototype;return i._getShapeBoundBox=function(e){var t=e.min.elements;t[0]=t[1]=t[2]=-this.radius;var i=e.max.elements;i[0]=i[1]=this.radius,i[2]=0},i._getSpeedBoundBox=function(e){var t=e.min.elements;t[0]=t[1]=-1,t[2]=0;var i=e.max.elements;i[0]=i[1]=i[2]=1},i.generatePositionAndDirection=function(e,t,i,n){var a=e.elements;i?(i.seed=n[16],this.emitFromShell?ne._randomPointUnitSphere(e,i):ne._randomPointInsideUnitSphere(e,i),n[16]=i.seed):this.emitFromShell?ne._randomPointUnitSphere(e):ne._randomPointInsideUnitSphere(e),At.scale(e,this.radius,e);var r=a[2];r<0&&(a[2]=-1*r),this.randomDirection?i?(i.seed=n[17],ne._randomPointUnitSphere(t,i),n[17]=i.seed):ne._randomPointUnitSphere(t):e.cloneTo(t)},i.cloneTo=function(t){e.prototype.cloneTo.call(this,t);var i=t;i.radius=this.radius,i.emitFromShell=this.emitFromShell,i.randomDirection=this.randomDirection},t}(ie),hi=function(e){function t(){this.radius=NaN,this.emitFromShell=!1,t.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}a(t,"laya.d3.core.particleShuriKen.module.shape.SphereShape",e);var i=t.prototype;return i._getShapeBoundBox=function(e){var t=e.min.elements;t[0]=t[1]=t[2]=-this.radius;var i=e.max.elements;i[0]=i[1]=i[2]=this.radius},i._getSpeedBoundBox=function(e){var t=e.min.elements;t[0]=t[1]=t[2]=-1;var i=e.max.elements;i[0]=i[1]=i[2]=1},i.generatePositionAndDirection=function(e,t,i,n){i?(i.seed=n[16],this.emitFromShell?ne._randomPointUnitSphere(e,i):ne._randomPointInsideUnitSphere(e,i),n[16]=i.seed):this.emitFromShell?ne._randomPointUnitSphere(e):ne._randomPointInsideUnitSphere(e),At.scale(e,this.radius,e),this.randomDirection?i?(i.seed=n[17],ne._randomPointUnitSphere(t,i),n[17]=i.seed):ne._randomPointUnitSphere(t):e.cloneTo(t)},i.cloneTo=function(t){e.prototype.cloneTo.call(this,t);var i=t;i.radius=this.radius,i.emitFromShell=this.emitFromShell,i.randomDirection=this.randomDirection},t}(ie),li=function(e){function t(){this._batchIndexStart=0,this._batchIndexEnd=0,this._skinAnimationDatas=null,t.__super.call(this)}return a(t,"laya.d3.core.render.SubMeshRenderElement",ce),t}(),ci=function(e){function t(e,i,n,a,r,o){this._name=NaN,this._attributeMap=null,this._renderElementUniformMap=null,this._materialUniformMap=null,this._spriteUniformMap=null,this._cameraUniformMap=null,this._sceneUniformMap=null,this.sharders=null,this._spriteDefineCounter=3,this._spriteInt2name=[],this._spriteName2Int={},this._materialDefineCounter=1,this._materialInt2name=[],this._materialName2Int={},this._conchShader=null,this._name=e,this._renderElementUniformMap={},this._materialUniformMap={},this._spriteUniformMap={},this._cameraUniformMap={},this._sceneUniformMap={},this.sharders=[],this._spriteInt2name[Ht.SHADERDEFINE_RECEIVE_SHADOW]="RECEIVESHADOW",this._spriteInt2name[un.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV]="SCALEOFFSETLIGHTINGMAPUV",this._spriteInt2name[un.SAHDERDEFINE_LIGHTMAP]="LIGHTMAP",this._spriteInt2name[vn.SHADERDEFINE_BONE]="BONE",this._materialInt2name[fi.SHADERDEFINE_ALPHATEST]="ALPHATEST";t.__super.call(this,e,i,n,null,{}),this._attributeMap=a;var s;for(s in r){var h=r[s];switch(h[1]){case 0:this._renderElementUniformMap[s]=h[0];break;case 1:this._materialUniformMap[s]=h[0];break;case 2:this._spriteUniformMap[s]=h[0];break;case 3:this._cameraUniformMap[s]=h[0];break;case 4:this._sceneUniformMap[s]=h[0];break;default:throw new Error("ShaderCompile3D: period is unkonw.")}}}a(t,"laya.d3.shader.ShaderCompile3D",k);var i=t.prototype;return i._definesToNameDic=function(e,t){for(var i={},n=1,a=0;a<32&&!((n=1<<a)>e);a++)if(e&n){var r=t[n];r&&(i[r]="")}return i},i.withCompile=function(e,i,n){var a,r,o;if(r=this.sharders[e])if(o=r[i]){if(a=o[n])return a}else o=r[i]=[];else o=(r=this.sharders[e]=[])[i]=[];var s,h=this._definesToNameDic(e,t._globalInt2name),l=this._definesToNameDic(i,this._spriteInt2name),c=this._definesToNameDic(n,this._materialInt2name);if(laya.d3.shader.ShaderCompile3D.debugMode){var p="";for(s in h)p+=s+" ";var u="";for(s in l)u+=s+" ";var d="";for(s in c)d+=s+" ";console.log("ShaderCompile3DDebugMode---(Name:"+Oi.nameKey.getName(this._name)+" PublicDefine:"+e+" SpriteDefine:"+i+" MaterialDefine:"+n+" PublicDefineGroup:"+p+" SpriteDefineGroup:"+u+"MaterialDefineGroup: "+d+")---ShaderCompile3DDebugMode")}var _={},m="";if(h)for(s in h)m+="#define "+s+"\n",_[s]=!0;if(l)for(s in l)m+="#define "+s+"\n",_[s]=!0;if(c)for(s in c)m+="#define "+s+"\n",_[s]=!0;var f=this._VS.toscript(_,[]),g=this._PS.toscript(_,[]);return a=Oi.create(m+f.join("\n"),m+g.join("\n"),this._attributeMap,this._sceneUniformMap,this._cameraUniformMap,this._spriteUniformMap,this._materialUniformMap,this._renderElementUniformMap),o[n]=a,a},i.precompileShaderWithShaderDefine=function(e,t,i){this.withCompile(e,t,i)},i.addMaterialDefines=function(e){var t=e.defines;for(var i in t){var n=t[i],a=parseInt(i);this._materialInt2name[a]=n,this._materialName2Int[n]=a}},i.addSpriteDefines=function(e){var t=e.defines;for(var i in t){var n=t[i],a=parseInt(i);this._spriteInt2name[a]=n,this._spriteName2Int[n]=a}},i.getMaterialDefineByName=function(e){return this._materialName2Int[e]},i.registerMaterialDefine=function(e){var t=Math.pow(2,this._materialDefineCounter++);return this._materialInt2name[t]=e,this._materialName2Int[e]=t,t},i.registerSpriteDefine=function(e){var t=Math.pow(2,this._spriteDefineCounter++);return this._spriteInt2name[t]=e,this._spriteName2Int[e]=t,t},t._globalRegDefine=function(e,i){t._globalInt2name[i]=e},t.add=function(e,i,n,a,r){return laya.d3.shader.ShaderCompile3D._preCompileShader[e]=new t(e,i,n,a,r,k.includes)},t.get=function(e){return laya.d3.shader.ShaderCompile3D._preCompileShader[Oi.nameKey.getID(e)]},t._preCompileShader={},t._globalInt2name=[],t.debugMode=!1,t.SHADERDEFINE_HIGHPRECISION=1,t.SHADERDEFINE_FOG=4,t.SHADERDEFINE_DIRECTIONLIGHT=8,t.SHADERDEFINE_POINTLIGHT=16,t.SHADERDEFINE_SPOTLIGHT=32,t.SHADERDEFINE_UV0=64,t.SHADERDEFINE_COLOR=128,t.SHADERDEFINE_UV1=256,t.SAHDERDEFINE_DEPTHFOG=131072,t}(),pi=function(e){function t(){t.__super.call(this)}a(t,"laya.d3.graphics.MeshSprite3DStaticBatchManager",Ie);var i=t.prototype;return i._getStaticBatch=function(e,t,i,n){var a,r;return r=e?e.id.toString()+i.id.toString()+t.id.toString()+n.toString():i.id.toString()+t.id.toString()+n.toString(),this._staticBatches[r]?a=this._staticBatches[r]:this._staticBatches[r]=a=new ui(r,this,e,t,i),a},i._initStaticBatchs=function(e){this._initBatchRenderElements.sort(t._sortPrepareStaticBatch);for(var i,n,a,r=!1,o=0,s=0,h=this._initBatchRenderElements.length;s<h;s++){var l=this._initBatchRenderElements[s],c=l.renderObj._getVertexBuffer(0);l._sprite3D;if(n===c.vertexDeclaration&&i===l._material){var p;if(r)a._addCombineBatchRenderObjTest(l)?(p=l._staticBatch)!==a&&(p&&p._deleteCombineBatchRenderObj(l),a._addCombineBatchRenderObj(l)):(r=!1,o++);else{var u=this._initBatchRenderElements[s-1],d=u.renderObj,_=l.renderObj;d._getVertexBuffer().vertexCount+_._getVertexBuffer().vertexCount>65535?r=!1:(a=this._getStaticBatch(e,n,i,o),(p=u._staticBatch)!==a&&(p&&p._deleteCombineBatchRenderObj(u),a._addCombineBatchRenderObj(u)),(p=l._staticBatch)!==a&&(p&&p._deleteCombineBatchRenderObj(l),a._addCombineBatchRenderObj(l)),r=!0)}}else r=!1,o=0;i=l._material,n=c.vertexDeclaration}},t._sortPrepareStaticBatch=function(e,t){var i=e._render,n=t._render,a=i.lightmapIndex-n.lightmapIndex;if(0===a){var r=i.receiveShadow-n.receiveShadow;if(0===r){var o=e._mainSortID-t._mainSortID;return 0===o?e.renderObj.triangleCount-t.renderObj.triangleCount:o}return r}return a},t}(),ui=function(e){function t(e,i,n,a,r){this._batchOwnerIndices=null,this._batchOwners=null,this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=null,this._vertexBuffer=null,this._indexBuffer=null,t.__super.call(this,e,i,n),this._batchOwnerIndices=[],this._batchOwners=[],this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=a,this._material=r}a(t,"laya.d3.graphics.SubMeshStaticBatch",Me);var i=t.prototype;return i._compareBatchRenderElement=function(e,t){return e._batchIndexStart>t._batchIndexStart},i._addCombineBatchRenderObjTest=function(e){var t=e.renderObj._vertexCount;return!((t>0?this._currentCombineVertexCount+t:this._currentCombineVertexCount+e.renderObj._getVertexBuffer().vertexCount)>65535)},i._addCombineBatchRenderObj=function(e){var t=e.renderObj,i=t._vertexCount;this._initBatchRenderElements.push(e),e._staticBatch=this,i>0?(this._currentCombineIndexCount+=t._indexCount,this._currentCombineVertexCount+=i):(this._currentCombineIndexCount=this._currentCombineIndexCount+t._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+t._getVertexBuffer().vertexCount),this._needFinishCombine=!0},i._deleteCombineBatchRenderObj=function(e){var t=e.renderObj,i=this._initBatchRenderElements.indexOf(e);if(-1!==i){this._initBatchRenderElements.splice(i,1),e._staticBatch=null;var n=t._vertexCount;n>0?(this._currentCombineIndexCount=this._currentCombineIndexCount-t._indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-n):(this._currentCombineIndexCount=this._currentCombineIndexCount-t._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-t._getVertexBuffer().vertexCount),this._needFinishCombine=!0}},i._finishInit=function(){if(this._needFinishCombine){var e=0,t=0;this._initBatchRenderElements[0]._sprite3D._render.lightmapIndex>=0?this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration):this._material instanceof laya.d3.core.material.StandardMaterial&&this._material.ambientTexture&&(this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration));var i=new Float32Array(this._vertexDeclaration.vertexStride/4*this._currentCombineVertexCount),n=new Uint16Array(this._currentCombineIndexCount);this._vertexBuffer&&(this._vertexBuffer.destroy(),this._indexBuffer.destroy()),this._vertexBuffer=qi.create(this._vertexDeclaration,this._currentCombineVertexCount,35044),this._indexBuffer=Wi.create("ushort",this._currentCombineIndexCount,35044);for(var a=0,r=this._initBatchRenderElements.length;a<r;a++){var o=this._initBatchRenderElements[a],s=o.renderObj,h=s._getStaticBatchBakedVertexs(this._rootOwner?this._rootOwner._transform:null,o._sprite3D),l=s.getIndices(),c=o._sprite3D.transform._isFrontFaceInvert,p=e/(this._vertexDeclaration.vertexStride/4)-s._vertexStart,u=t,d=u+l.length;o._batchIndexStart=u,o._batchIndexEnd=d,n.set(l,t);var _=0;if(c)for(_=u;_<d;_+=3){n[_]=p+n[_];var m=n[_+1],f=n[_+2];n[_+1]=p+f,n[_+2]=p+m}else for(_=u;_<d;_+=3)n[_]=p+n[_],n[_+1]=p+n[_+1],n[_+2]=p+n[_+2];t+=l.length,i.set(h,e),e+=h.length}this._vertexBuffer.setData(i),this._indexBuffer.setData(n),this._needFinishCombine=!1}},i._getCombineRenderElementFromPool=function(){return this._combineRenderElementPool[this._combineRenderElementPoolIndex++]||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=new li)},i._getRenderElement=function(e,t,i){for(var n,a,r=this._batchRenderElements.length,o=!0,s=0;s<r;s++){var h,l=(a=this._batchRenderElements[s])._sprite3D._render;0!==s&&(o=(h=(n=this._batchRenderElements[s-1])._sprite3D._render).lightmapIndex!==l.lightmapIndex||h.receiveShadow!==l.receiveShadow||n._batchIndexEnd!==a._batchIndexStart);var c;if(o){(c=this._getCombineRenderElementFromPool()).renderObj=this,c._material=this._material,c._batchIndexStart=a._batchIndexStart,c._batchIndexEnd=a._batchIndexEnd;var p=l.lightmapIndex,u=p+1,d=this._batchOwnerIndices[u];d||(d=this._batchOwnerIndices[u]=[]);var _,m=d[a._render.receiveShadow?1:0];void 0===m?(d[l.receiveShadow?1:0]=this._batchOwners.length,(_=new gn(null,"StaticBatchMeshSprite3D"))._scene=t,_._transform=this._rootOwner?this._rootOwner._transform:null,_._render.lightmapIndex=p,_._render.receiveShadow=a._render.receiveShadow,this._batchOwners.push(_)):_=this._batchOwners[m],_._render._renderUpdate(i),c._sprite3D=_,e.push(c)}else c._batchIndexEnd=a._batchIndexEnd}},i._beforeRender=function(e){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},i._render=function(e){var t=e.renderElement,i=t._batchIndexStart,n=t._batchIndexEnd-i;A.mainContext.drawElements(4,n,5123,2*i),T.drawCall++,T.trianglesFaces+=n/3},i.dispose=function(){this._batchOwnerIndices=null,this._batchOwners=null,this._vertexDeclaration=null,this._vertexBuffer.destroy(),this._indexBuffer.destroy()},i._getVertexBuffer=function(e){return void 0===e&&(e=0),this._vertexBuffer},t}(),di=(function(e){function t(){t.__super.call(this),t._nameNumber++,this.loadShaderParams(),this.createResource(),this.alphaBlending=1,this.colorIntensity=1}a(t,"laya.d3.resource.models.SkyBox",e);var i=t.prototype;i._getShader=function(e){var t=e.scene._shaderDefineValue;return this._shader=this._shaderCompile.withCompile(t,0,0),this._shader},i.createResource=function(){this._numberVertices=36,this._numberIndices=36;var e=new Uint16Array(this._numberIndices),i=t._vertexDeclaration.vertexStride/4,n=new Float32Array(this._numberVertices*i),a=new At(-.5,.5,.5),r=new At(-.5,-.5,.5),o=new At(.5,.5,.5),s=new At(.5,-.5,.5),h=new At(-.5,.5,-.5),l=new At(.5,.5,-.5),c=new At(-.5,-.5,-.5),p=new At(.5,-.5,-.5),u=0;u=this._addVertex(n,u,a),u=this._addVertex(n,u,r),u=this._addVertex(n,u,o),u=this._addVertex(n,u,r),u=this._addVertex(n,u,s),u=this._addVertex(n,u,o),u=this._addVertex(n,u,h),u=this._addVertex(n,u,l),u=this._addVertex(n,u,c),u=this._addVertex(n,u,c),u=this._addVertex(n,u,l),u=this._addVertex(n,u,p),u=this._addVertex(n,u,a),u=this._addVertex(n,u,l),u=this._addVertex(n,u,h),u=this._addVertex(n,u,a),u=this._addVertex(n,u,o),u=this._addVertex(n,u,l),u=this._addVertex(n,u,r),u=this._addVertex(n,u,c),u=this._addVertex(n,u,p),u=this._addVertex(n,u,r),u=this._addVertex(n,u,p),u=this._addVertex(n,u,s),u=this._addVertex(n,u,a),u=this._addVertex(n,u,c),u=this._addVertex(n,u,r),u=this._addVertex(n,u,h),u=this._addVertex(n,u,c),u=this._addVertex(n,u,a),u=this._addVertex(n,u,o),u=this._addVertex(n,u,s),u=this._addVertex(n,u,p),u=this._addVertex(n,u,l),u=this._addVertex(n,u,o),u=this._addVertex(n,u,p);for(var d=0;d<36;d++)e[d]=d;this._vertexBuffer=new qi(t._vertexDeclaration,this._numberVertices,35044,!0),this._indexBuffer=new Wi("ushort",this._numberIndices,35044,!0),this._vertexBuffer.setData(n),this._indexBuffer.setData(e)},i._addVertex=function(e,t,i){var n=i.elements;return e[t+0]=n[0],e[t+1]=n[1],e[t+2]=n[2],t+3},i.loadShaderParams=function(){this._sharderNameID=Oi.nameKey.getID("SkyBox"),this._shaderCompile=ci._preCompileShader[this._sharderNameID]},i._render=function(e){this._textureCube&&this._textureCube.loaded&&(this._vertexBuffer._bind(),this._indexBuffer._bind(),this._shader=this._getShader(e),this._shader.bind(),e.camera.transform.worldMatrix.cloneTo(t._tempMatrix4x40),t._tempMatrix4x40.transpose(),Ct.multiply(e._projectionMatrix,t._tempMatrix4x40,t._tempMatrix4x41),e.camera._shaderValues.setValue(4,t._tempMatrix4x41.elements),this._shader.uploadCameraUniforms(e.camera._shaderValues.data),this._shaderValue.setValue(1,this._colorIntensity),this._shaderValue.setValue(2,this._alphaBlending),this._shaderValue.setValue(3,this.textureCube),this._shader.uploadAttributes(t._vertexDeclaration.shaderValues.data,null),this._shader.uploadMaterialUniforms(this._shaderValue.data),A.mainContext.drawElements(4,36,5123,0),T.trianglesFaces+=12,T.drawCall++)},i.destroy=function(){e.prototype.destroy.call(this),this._textureCube&&(this._textureCube._removeReference(),this._textureCube=null)},r(0,i,"textureCube",function(){return this._textureCube},function(e){this._textureCube!==e&&(this._textureCube&&this._textureCube._removeReference(),this._textureCube=e,e&&e._addReference())}),t._nameNumber=1,n(t,["_tempMatrix4x40",function(){return this._tempMatrix4x40=new Ct},"_tempMatrix4x41",function(){return this._tempMatrix4x41=new Ct},"_vertexDeclaration",function(){return this._vertexDeclaration=new Ce(12,[new ke(0,"vector3",0)])}])}(Pt),function(e){function t(){this._stacks=16,this._slices=16,this._radius=1,t.__super.call(this),t._nameNumber++,this.loadShaderParams(),this.recreateResource(),this.alphaBlending=1,this.colorIntensity=1}a(t,"laya.d3.resource.models.SkyDome",e);var o=t.prototype;o._getShader=function(e){var t=e.scene._shaderDefineValue;return this._shader=this._shaderCompile.withCompile(t,0,0),this._shader},o.recreateResource=function(){this._numberVertices=(this._stacks+1)*(this._slices+1),this._numberIndices=3*this._stacks*(this._slices+1)*2;for(var e=new Uint16Array(this._numberIndices),i=t._vertexDeclaration.vertexStride/4,n=new Float32Array(this._numberVertices*i),a=Math.PI/this._stacks,r=2*Math.PI/this._slices,o=0,s=0,h=0,l=0;l<this._stacks+1;l++)for(var c=Math.sin(l*a),p=Math.cos(l*a),u=0;u<this._slices+1;u++){var d=c*Math.sin(u*r),_=c*Math.cos(u*r);n[s+0]=d*this._radius,n[s+1]=p*this._radius,n[s+2]=_*this._radius,n[s+3]=-u/this._slices+.75,n[s+4]=l/this._stacks,s+=i,l!=this._stacks-1&&(e[h++]=o+1,e[h++]=o,e[h++]=o+(this._slices+1),e[h++]=o+(this._slices+1),e[h++]=o,e[h++]=o+this._slices,o++)}this._vertexBuffer=new qi(t._vertexDeclaration,this._numberVertices,35044),this._indexBuffer=new Wi("ushort",this._numberIndices,35044),this._vertexBuffer.setData(n),this._indexBuffer.setData(e)},o.loadShaderParams=function(){this._sharderNameID=Oi.nameKey.getID("SkyDome"),this._shaderCompile=ci._preCompileShader[this._sharderNameID]},o._render=function(e){this._texture&&this._texture.loaded&&(this._vertexBuffer._bind(),this._indexBuffer._bind(),this._shader=this._getShader(e),this._shader.bind(),e.camera.transform.worldMatrix.cloneTo(t._tempMatrix4x40),t._tempMatrix4x40.transpose(),Ct.multiply(e._projectionMatrix,t._tempMatrix4x40,t._tempMatrix4x41),e.camera._shaderValues.setValue(4,t._tempMatrix4x41.elements),this._shader.uploadCameraUniforms(e.camera._shaderValues.data),this._shaderValue.setValue(1,this._colorIntensity),this._shaderValue.setValue(2,this._alphaBlending),this._shaderValue.setValue(3,this.texture),this._shader.uploadAttributes(t._vertexDeclaration.shaderValues.data,null),this._shader.uploadMaterialUniforms(this._shaderValue.data),A.mainContext.drawElements(4,this._indexBuffer.indexCount,5123,0),T.trianglesFaces+=this._numberIndices/3,T.drawCall++)},o.onEnvDescLoaded=function(e){var t="",n=Math.max(e.lastIndexOf("/"),e.lastIndexOf("\\"));n>0&&(t=e.substr(0,n+1));var a=i.loader.getRes(e);void 0!=a.ev&&this.__ownerCamera?this.__ownerCamera._shaderValues.setValue(13,Math.pow(2,a.ev)):this.__ownerCamera._shaderValues.setValue(13,Math.pow(2,0)),this.texture=hn.load(t+a.skytex),this.environmentSpecular=tn.load(t+a.prefiltedEnv);var r=new Float32Array(a.IrradianceMat);this.envDiffuseSHRed=r.slice(0,16),this.envDiffuseSHGreen=r.slice(16,32),this.envDiffuseSHBlue=r.slice(32,48)},o.loadEnvInfo=function(e){i.loader.load(e,y.create(this,this.onEnvDescLoaded,[e]))},o.destroy=function(){e.prototype.destroy.call(this),this._texture&&(this._texture._removeReference(),this._texture=null)},r(0,o,"texture",function(){return this._texture},function(e){this._texture!==e&&(this._texture&&this._texture._removeReference(),this._texture=e,e&&e._addReference())}),t._nameNumber=1,n(t,["_tempMatrix4x40",function(){return this._tempMatrix4x40=new Ct},"_tempMatrix4x41",function(){return this._tempMatrix4x41=new Ct},"_vertexDeclaration",function(){return this._vertexDeclaration=new Ce(20,[new ke(0,"vector3",0),new ke(12,"vector2",2)])}])}(Pt),function(e){function t(){this._componentsMap=null,this._typeComponentsIndices=null,this._components=null,this._scripts=null,t.__super.call(this),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[],this._scripts=[]}a(t,"laya.d3.core.ComponentNode",w);var i=t.prototype;return i.addComponent=function(e){var t,i=this._componentsMap.indexOf(e);if(-1===i)t=[],this._componentsMap.push(e),this._typeComponentsIndices.push(t);else if(t=this._typeComponentsIndices[i],this._components[t[0]].isSingleton)throw new Error("无法单实例创建"+e+"组件，"+e+"组件已存在！");var n=m.getInstance(e);return t.push(this._components.length),this._components.push(n),n instanceof laya.d3.component.Script&&this._scripts.push(n),n._initialize(this),n},i._removeComponent=function(e,t){var i=this._typeComponentsIndices[e],n=i[t],a=this._components[n];this._components.splice(n,1),a instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(a),1),i.splice(t,1),0===i.length&&(this._typeComponentsIndices.splice(e,1),this._componentsMap.splice(e,1));for(var r=0,o=this._componentsMap.length;r<o;r++)for(var s=(i=this._typeComponentsIndices[r]).length-1;s>=0;s--){var h=i[s];if(!(h>n))break;i[s]=--h}a._destroy()},i.getComponentByType=function(e,t){void 0===t&&(t=0);var i=this._componentsMap.indexOf(e);return-1===i?null:this._components[this._typeComponentsIndices[i][t]]},i.getComponentsByType=function(e,t){var i=this._componentsMap.indexOf(e);if(-1!==i){var n=this._typeComponentsIndices[i],a=n.length;t.length=a;for(var r=0;r<a;r++)t[r]=this._components[n[r]]}else t.length=0},i.getComponentByIndex=function(e){return this._components[e]},i.removeComponentByType=function(e,t){void 0===t&&(t=0);var i=this._componentsMap.indexOf(e);-1!==i&&this._removeComponent(i,t)},i.removeComponentsByType=function(e){var t=this._componentsMap.indexOf(e);if(-1!==t)for(var i=this._typeComponentsIndices[t],n=0,a=i.length;n<a;i.length<a?a--:n++)this._removeComponent(t,n)},i.removeAllComponent=function(){for(var e=0,t=this._componentsMap.length;e<t;this._componentsMap.length<t?t--:e++)this.removeComponentsByType(this._componentsMap[e])},i._updateComponents=function(e){for(var t=0,i=this._components.length;t<i;t++){var n=this._components[t];!n.started&&(n._start(e),n.started=!0),n.enable&&n._update(e)}},i._lateUpdateComponents=function(e){for(var t=0;t<this._components.length;t++){var i=this._components[t];!i.started&&(i._start(e),i.started=!0),i.enable&&i._lateUpdate(e)}},i._preRenderUpdateComponents=function(e){for(var t=0;t<this._components.length;t++){var i=this._components[t];!i.started&&(i._start(e),i.started=!0),i.enable&&i._preRenderUpdate(e)}},i._postRenderUpdateComponents=function(e){for(var t=0;t<this._components.length;t++){var i=this._components[t];!i.started&&(i._start(e),i.started=!0),i.enable&&i._postRenderUpdate(e)}},t}()),_i=function(e){function t(){this._realTimeCurrentFrameIndexes=null,this._realTimeCurrentTimes=null,this._fullKeyframeIndicesCache=null,this._animationDatasCache=null,this._avatarDatasCache=null,this._skinnedDatasCache=null,this._version=null,this._nodes=null,this._nodesMap=null,this._cachePropertyMap=null,this._nodeToCachePropertyMap=null,this._unCachePropertyMap=null,this._duration=NaN,this._frameRate=0,this._animationEvents=null,this._publicClipDatas=null,this.islooping=!1,t.__super.call(this),this._fullKeyframeIndicesCache={},this._animationDatasCache=[],this._avatarDatasCache=[],this._skinnedDatasCache=[],this._animationEvents=[]}a(t,"laya.d3.animation.AnimationClip",M);var n=t.prototype;return n.duration=function(){return this._duration},n._hermiteInterpolate=function(e,t,i,n){for(var a=e.data,r=e.outTangent,o=e.next,s=o.data,h=o.inTangent,l=!1,c=NaN,p=NaN,u=NaN,d=NaN,_=0,m=n.length;_<m;_++){var f=r[_],g=h[_];if(Number.isFinite(f)&&Number.isFinite(g)){if(!l){var y=t*t,v=y*t;c=2*v-3*y+1,p=v-2*y+t,u=v-y,d=-2*v+3*y,l=!0}n[_]=c*a[_]+p*f*i+u*g*i+d*s[_]}else n[_]=a[_]}},n._getFullKeyframeIndicesWithCache=function(e){return this._fullKeyframeIndicesCache[e]},n._cacheFullKeyframeIndices=function(e,t){this._fullKeyframeIndicesCache[e]=t},n._getAnimationDataWithCache=function(e,t){var i=this._animationDatasCache[e];return i?i[t]:null},n._cacheAnimationData=function(e,t,i){(this._animationDatasCache[e]||(this._animationDatasCache[e]=[]))[t]=i},n._getAvatarDataWithCache=function(e,t,i){var n=this._avatarDatasCache[e.id];if(n){var a=n[t];return a?a[i]:null}return null},n._cacheAvatarData=function(e,t,i,n){var a=this._avatarDatasCache[e.id]||(this._avatarDatasCache[e.id]=[]);(a[t]||(a[t]=[]))[i]=n},n._evaluateAnimationlDatasCacheMode=function(e,t,i,n,a){for(var r=0,o=0,s=0,h=a?a.length:this._nodes.length;s<h;s++){var l=a?a[s]:s,c=this._nodes[l],p=c._cacheProperty;if(e[l]){var u,d=t[l],_=d[i.currentFrameIndex],m=0;if(-1!==_){var f=c.keyFrames[_];if(f.next){a&&!p?(u=n[l])||(u=n[l]=new Float32Array(c.keyFrameWidth)):(u=new Float32Array(c.keyFrameWidth),n[s]=u);var g=NaN,y=f.duration;g=0!==y?(i.currentFrameTime-f.startTime)/y:0,this._hermiteInterpolate(f,g,y,u)}else{if(a&&!p)(u=n[l])||(u=n[l]=new Float32Array(c.keyFrameWidth));else{if(-1!==(m=i._lastFrameIndex)&&d[m]===_)continue;u=new Float32Array(c.keyFrameWidth),n[s]=u}var v=f.data;for(r=0,o=u.length;r<o;r++)u[r]=v[r]}}else{if(a&&!p)(u=n[l])||(u=n[l]=new Float32Array(c.keyFrameWidth));else{if(-1!==(m=i._lastFrameIndex)&&d[m]===_)continue;u=new Float32Array(c.keyFrameWidth),n[s]=u}var x=c.keyFrames[0].data;for(r=0,o=u.length;r<o;r++)u[r]=x[r]}}}},n._evaluateAnimationlDatasRealTime=function(e,t,i,n){var a=0,r=0,o=this._nodes;if(!this._realTimeCurrentFrameIndexes){for(this._realTimeCurrentFrameIndexes=new Int32Array(o.length),a=0,r=o.length;a<r;a++)this._realTimeCurrentFrameIndexes[a]=-1;this._realTimeCurrentTimes=new Float32Array(o.length)}for(a=0,r=n?n.length:this._nodes.length;a<r;a++){var s=n?n[a]:a,h=o[s];t<this._realTimeCurrentTimes[s]&&(this._realTimeCurrentFrameIndexes[s]=-1),this._realTimeCurrentTimes[s]=t;for(var l=this._realTimeCurrentFrameIndexes[s]+1,c=h.keyFrames,p=c.length;l<p;){if(c[l].startTime>t){this._realTimeCurrentFrameIndexes[s]=l-1;break}l++}l===p&&(this._realTimeCurrentFrameIndexes[s]=p-1);var u=0,d=0,_=i[s];_||(_=i[s]=new Float32Array(h.keyFrameWidth));var m=c[this._realTimeCurrentFrameIndexes[s]];if(m){if(m.next){var f=m.duration,g=NaN;g=0!==f?(t-m.startTime)/f:0,this._hermiteInterpolate(m,g,f,_)}else{var y=m.data;for(u=0,d=_.length;u<d;u++)_[u]=y[u]}}else{var v=h.keyFrames[0].data;for(u=0,d=_.length;u<d;u++)_[u]=v[u]}var x=e[s];x&&(n?V._propertySetFuncs[h.propertyNameID](x,null,_):V._propertySetFuncs[h.propertyNameID](null,x,_))}},n._binarySearchEventIndex=function(e){for(var t=0,i=this._animationEvents.length-1,n=0;t<=i;){n=Math.floor((t+i)/2);var a=this._animationEvents[n].time;if(a==e)return n;a>e?i=n-1:t=n+1}return t},n.addEvent=function(e){var t=this._binarySearchEventIndex(e.time);this._animationEvents.splice(t,0,e)},n.onAsynLoaded=function(e,t,i){var n=new _(t);switch(this._version=n.readUTFString(),this._version){case"LAYAANIMATION:01":B.parse(this,n);break;case"LAYAANIMATION:02":P.parse(this,n)}this.completeCreate(),this._endLoaded()},n.disposeResource=function(){this._realTimeCurrentFrameIndexes=null,this._realTimeCurrentTimes=null,this._fullKeyframeIndicesCache=null,this._animationDatasCache=null,this._avatarDatasCache=null,this._skinnedDatasCache=null,this._version=null,this._nodes=null,this._nodesMap=null,this._cachePropertyMap=null,this._nodeToCachePropertyMap=null,this._unCachePropertyMap=null,this._publicClipDatas=null},t.load=function(e){return i.loader.create(e,null,null,t)},t}(),mi=function(e){function t(){t.__super.call(this)}a(t,"laya.d3.core.Avatar",M);var n=t.prototype;return i.imps(n,{"laya.d3.core.IClone":!0}),n._initCloneToAnimator=function(e,t){t._avatarNodeMap[e.name]=e,t._avatarNodes.push(e);for(var i=0,n=e.getChildCount();i<n;i++)this._initCloneToAnimator(e.getChildByIndex(i),t)},n._parseNode=function(e,t){var i=e.props.name;if(t.name=i,t._parent){var n=e.customProps,a=t.transform;a._localRotationEuler=new Float32Array(3),a.setLocalPosition(new Float32Array(n.translate)),a.setLocalRotation(new Float32Array(n.rotation)),a.setLocalScale(new Float32Array(n.scale)),a._setWorldMatrixAndUpdate(new Float32Array(16))}for(var r=e.child,o=0,s=r.length;o<s;o++){var h=r[o],l=new V;t.addChild(l),this._parseNode(h,l)}},n.onAsynLoaded=function(e,t,i){if(this._rootNode=new V,t.version){this._version=t.version;var n=t.rootNode;n&&this._parseNode(n,this._rootNode)}else this._parseNode(t,this._rootNode);this._endLoaded()},n._cloneDatasToAnimator=function(e){var t=this._rootNode.clone();t.transform._setWorldMatrixIgnoreUpdate(null);e._avatarNodeMap={},e._avatarNodes=[],this._initCloneToAnimator(t,e)},n.cloneTo=function(e){var t=e,i=this._rootNode.clone();t._rootNode=i},n.clone=function(){var e=new this.constructor;return this.cloneTo(e),e},t.load=function(e){return i.loader.create(e,null,null,t)},t}(),fi=function(e){function t(){t.__super.call(this),this._shaderDefineValue=0,this._disablePublicShaderDefine=0,this._shaderValues=new Ft,this._values=[],this.renderQueue=2e3,this._alphaTest=!1,this.cull=2,this.blend=0,this.srcBlend=1,this.dstBlend=0,this.srcBlendRGB=1,this.dstBlendRGB=0,this.srcBlendAlpha=1,this.dstBlendAlpha=0,this.blendConstColor=new Rt(1,1,1,1),this.blendEquation=0,this.blendEquationRGB=0,this.blendEquationAlpha=0,this.depthTest=513,this.depthWrite=!0}a(t,"laya.d3.core.material.BaseMaterial",e);var o=t.prototype;return i.imps(o,{"laya.d3.core.IClone":!0}),o._addShaderDefine=function(e){this._shaderDefineValue|=e},o._removeShaderDefine=function(e){this._shaderDefineValue&=~e},o._addDisablePublicShaderDefine=function(e){this._disablePublicShaderDefine|=e},o._removeDisablePublicShaderDefine=function(e){this._disablePublicShaderDefine&=~e},o._setBuffer=function(e,t){this._shaderValues.setValue(e,t),this._values[e]=t},o._getBuffer=function(e){return this._values[e]},o._setMatrix4x4=function(e,t){this._shaderValues.setValue(e,t?t.elements:null),this._values[e]=t},o._getMatrix4x4=function(e){return this._values[e]},o._setInt=function(e,t){this._shaderValues.setValue(e,t),this._values[e]=t},o._getInt=function(e){return this._values[e]},o._setNumber=function(e,t){this._shaderValues.setValue(e,t),this._values[e]=t},o._getNumber=function(e){return this._values[e]},o._setBool=function(e,t){this._shaderValues.setValue(e,t),this._values[e]=t},o._getBool=function(e){return this._values[e]},o._setVector2=function(e,t){this._shaderValues.setValue(e,t?t.elements:null),this._values[e]=t},o._getVector2=function(e){return this._values[e]},o._setColor=function(e,t){this._shaderValues.setValue(e,t?t.elements:null),this._values[e]=t},o._getColor=function(e){return this._values[e]},o._setTexture=function(e,t){var i=this._values[e];this._values[e]=t,this._shaderValues.setValue(e,t),this.referenceCount>0&&(i&&i._removeReference(),t&&t._addReference())},o._getTexture=function(e){return this._values[e]},o._upload=function(){this._shader.uploadMaterialUniforms(this._shaderValues.data)},o._getShader=function(e,t,i){var n=(e|t)&~this._disablePublicShaderDefine;return this._shader=this._shaderCompile.withCompile(n,i,this._shaderDefineValue),this._shader},o._setRenderStateBlendDepth=function(){var e=A.mainContext;switch(R.setDepthMask(e,this.depthWrite),0===this.depthTest?R.setDepthTest(e,!1):(R.setDepthTest(e,!0),R.setDepthFunc(e,this.depthTest)),this.blend){case 0:R.setBlend(e,!1);break;case 1:R.setBlend(e,!0),R.setBlendFunc(e,this.srcBlend,this.dstBlend);break;case 2:R.setBlend(e,!0)}},o._setRenderStateFrontFace=function(e,t){var i=A.mainContext,n=0;switch(this.cull){case 0:R.setCullFace(i,!1);break;case 1:R.setCullFace(i,!0),n=e?t&&t._isFrontFaceInvert?2305:2304:t&&t._isFrontFaceInvert?2304:2305,R.setFrontFace(i,n);break;case 2:R.setCullFace(i,!0),n=e?t&&t._isFrontFaceInvert?2304:2305:t&&t._isFrontFaceInvert?2305:2304,R.setFrontFace(i,n)}},o.onAsynLoaded=function(e,t,i){var n=t[0],a=t[1];switch(n.version){case"LAYAMATERIAL:01":var r=0,o=0,s=n.props;for(var h in s)switch(h){case"vectors":var l=s[h];for(r=0,o=l.length;r<o;r++){var c=l[r],p=c.value;switch(p.length){case 2:this[c.name]=new Nt(p[0],p[1]);break;case 3:this[c.name]=new At(p[0],p[1],p[2]);break;case 4:this[c.name]=new Rt(p[0],p[1],p[2],p[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}}break;case"textures":var u=s[h];for(r=0,o=u.length;r<o;r++){var d=u[r],_=d.path;_&&(this[d.name]=v.getRes(a[_]))}break;case"defines":var m=s[h];for(r=0,o=m.length;r<o;r++){var f=this._shaderCompile.getMaterialDefineByName(m[r]);this._addShaderDefine(f)}break;case"cull":case"blend":case"srcBlend":case"dstBlend":case"depthWrite":this[h]=s[h];break;case"renderQueue":switch(s[h]){case 1:this.renderQueue=2e3;break;case 2:this.renderQueue=3e3}break;default:this[h]=s[h]}break;case"LAYAMATERIAL:02":s=n.props;for(h in s)switch(h){case"vectors":for(r=0,o=(l=s[h]).length;r<o;r++)switch(c=l[r],(p=c.value).length){case 2:this[c.name]=new Nt(p[0],p[1]);break;case 3:this[c.name]=new At(p[0],p[1],p[2]);break;case 4:this[c.name]=new Rt(p[0],p[1],p[2],p[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}break;case"textures":for(r=0,o=(u=s[h]).length;r<o;r++)(_=(d=u[r]).path)&&(this[d.name]=v.getRes(a[_]));break;case"defines":for(r=0,o=(m=s[h]).length;r<o;r++)f=this._shaderCompile.getMaterialDefineByName(m[r]),this._addShaderDefine(f);break;default:this[h]=s[h]}break;default:throw new Error("BaseMaterial:unkonwn version.")}this._endLoaded()},o._addReference=function(){e.prototype._addReference.call(this);for(var t=0,i=this._values.length;t<i;t++){var n=this._values[t];n&&n instanceof laya.d3.resource.BaseTexture&&n._addReference()}},o._removeReference=function(){e.prototype._removeReference.call(this);for(var t=0,i=this._values.length;t<i;t++){var n=this._values[t];n&&n instanceof laya.d3.resource.BaseTexture&&n._removeReference()}},o.disposeResource=function(){this.blendConstColor=null,this._shader=null,this._shaderValues=null;for(var e=0,t=this._values.length;e<t;e++){var i=this._values[e];i&&i instanceof laya.d3.resource.BaseTexture&&i._removeReference()}this._values=null},o.setShaderName=function(e){var t=Oi.nameKey.getID(e);if(-1===t)throw new Error("BaseMaterial: unknown shader name.");this._shaderCompile=ci._preCompileShader[t]},o.cloneTo=function(e){var t=e;t.name=this.name,t.cull=this.cull,t.blend=this.blend,t.srcBlend=this.srcBlend,t.dstBlend=this.dstBlend,t.srcBlendRGB=this.srcBlendRGB,t.dstBlendRGB=this.dstBlendRGB,t.srcBlendAlpha=this.srcBlendAlpha,t.dstBlendAlpha=this.dstBlendAlpha,this.blendConstColor.cloneTo(t.blendConstColor),t.blendEquation=this.blendEquation,t.blendEquationRGB=this.blendEquationRGB,t.blendEquationAlpha=this.blendEquationAlpha,t.depthTest=this.depthTest,t.depthWrite=this.depthWrite,t.renderQueue=this.renderQueue,t._shader=this._shader,t._disablePublicShaderDefine=this._disablePublicShaderDefine,t._shaderDefineValue=this._shaderDefineValue;var i=0,n=0,a=t._shaderValues;t._shaderValues.data.length=this._shaderValues.data.length;var r=this._values.length,o=t._values;for(o.length=r,i=0,n=r;i<n;i++){var s=this._values[i];if(s)if("number"==typeof s)o[i]=s,a.data[i]=s;else if("number"==typeof s&&Math.floor(s)==s)o[i]=s,a.data[i]=s;else if("boolean"==typeof s)o[i]=s,a.data[i]=s;else if(s instanceof laya.d3.math.Vector2){var h=o[i]||(o[i]=new Nt);s.cloneTo(h),a.data[i]=h.elements}else if(s instanceof laya.d3.math.Vector3){var l=o[i]||(o[i]=new At);s.cloneTo(l),a.data[i]=l.elements}else if(s instanceof laya.d3.math.Vector4){var c=o[i]||(o[i]=new Rt);s.cloneTo(c),a.data[i]=c.elements}else if(s instanceof laya.d3.math.Matrix4x4){var p=o[i]||(o[i]=new Ct);s.cloneTo(p),a.data[i]=p.elements}else s instanceof laya.d3.resource.BaseTexture&&(o[i]=s,a.data[i]=s)}},o.clone=function(){var e=new this.constructor;return this.cloneTo(e),e},r(0,o,"alphaTestValue",function(){return this._getNumber(0)},function(e){this._setNumber(0,e)}),r(0,o,"alphaTest",function(){return this._alphaTest},function(e){this._alphaTest=e,e?this._addShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST):this._removeShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST)}),t.__init__=function(){t.SHADERDEFINE_ALPHATEST=t.shaderDefines.registerDefine("ALPHATEST")},t.RENDERQUEUE_OPAQUE=2e3,t.RENDERQUEUE_ALPHATEST=2450,t.RENDERQUEUE_TRANSPARENT=3e3,t.CULL_NONE=0,t.CULL_FRONT=1,t.CULL_BACK=2,t.BLEND_DISABLE=0,t.BLEND_ENABLE_ALL=1,t.BLEND_ENABLE_SEPERATE=2,t.BLENDPARAM_ZERO=0,t.BLENDPARAM_ONE=1,t.BLENDPARAM_SRC_COLOR=768,t.BLENDPARAM_ONE_MINUS_SRC_COLOR=769,t.BLENDPARAM_DST_COLOR=774,t.BLENDPARAM_ONE_MINUS_DST_COLOR=775,t.BLENDPARAM_SRC_ALPHA=770,t.BLENDPARAM_ONE_MINUS_SRC_ALPHA=771,t.BLENDPARAM_DST_ALPHA=772,t.BLENDPARAM_ONE_MINUS_DST_ALPHA=773,t.BLENDPARAM_SRC_ALPHA_SATURATE=776,t.BLENDEQUATION_ADD=0,t.BLENDEQUATION_SUBTRACT=1,t.BLENDEQUATION_REVERSE_SUBTRACT=2,t.DEPTHTEST_OFF=0,t.DEPTHTEST_NEVER=512,t.DEPTHTEST_LESS=513,t.DEPTHTEST_EQUAL=514,t.DEPTHTEST_LEQUAL=515,t.DEPTHTEST_GREATER=516,t.DEPTHTEST_NOTEQUAL=517,t.DEPTHTEST_GEQUAL=518,t.DEPTHTEST_ALWAYS=519,t.SHADERDEFINE_ALPHATEST=1,t.ALPHATESTVALUE=0,n(t,["shaderDefines",function(){return this.shaderDefines=new Vt}]),t}(M),gi=function(e){function t(){this._type=0,this._width=0,this._height=0,this._size=null,this._repeat=!1,this._mipmap=!1,this._minFifter=0,this._magFifter=0,this._format=0,this._source=null,this._conchTexture=null,this._wrapModeU=0,this._wrapModeV=0,t.__super.call(this),this._repeat=!0,this.mipmap=!0,this.minFifter=-1,this.magFifter=-1}a(t,"laya.d3.resource.BaseTexture",M);var i=t.prototype;return r(0,i,"width",function(){return this._width}),r(0,i,"repeat",function(){return this._repeat},function(e){if(this._repeat!==e&&(this._repeat=e,this._source)){var t=A.mainContext;R.bindTexture(t,this._type,this._source);l.isPOT(this._width,this._height)&&this._repeat?(t.texParameteri(this._type,10242,10497),t.texParameteri(this._type,10243,10497)):(t.texParameteri(this._type,10242,33071),t.texParameteri(this._type,10243,33071))}}),r(0,i,"height",function(){return this._height}),r(0,i,"magFifter",function(){return this._magFifter},function(e){this._magFifter=e,e!=this._magFifter&&this._conchTexture&&this._conchTexture.setMaxFifter(e)}),r(0,i,"wrapModeV",function(){return this._wrapModeV}),r(0,i,"size",function(){return this._size}),r(0,i,"wrapModeU",function(){return this._wrapModeU}),r(0,i,"mipmap",function(){return this._mipmap},function(e){this._mipmap=e,this._mipmap!=e&&this._conchTexture&&this._conchTexture.setMipMap(e)}),r(0,i,"minFifter",function(){return this._minFifter},function(e){this._minFifter=e,this._minFifter!=e&&this._conchTexture&&this._conchTexture.setMinFifter(e)}),r(0,i,"format",function(){return this._format}),r(0,i,"source",function(){return this.activeResource(),this._source}),r(0,i,"defaulteTexture",function(){return on.grayTexture}),t.WARPMODE_REPEAT=0,t.WARPMODE_CLAMP=1,t}(),yi=function(e){function t(){this._subMeshCount=0,this._boundingBox=null,this._boundingSphere=null,this._boundingBoxCorners=null,this._positions=null,t.__super.call(this),this._boundingBoxCorners=o(8,null)}a(t,"laya.d3.resource.models.BaseMesh",M);var i=t.prototype;return i._getPositions=function(){throw new Error("未Override,请重载该属性！")},i._generateBoundingObject=function(){this._boundingSphere=new wt(new At,0),wt.createfromPoints(this._positions,this._boundingSphere),this._boundingBox=new xt(new At,new At),xt.createfromPoints(this._positions,this._boundingBox),this._boundingBox.getCorners(this._boundingBoxCorners)},i.getRenderElementsCount=function(){throw new Error("未Override,请重载该属性！")},i.getRenderElement=function(e){throw new Error("未Override,请重载该属性！")},r(0,i,"subMeshCount",function(){return this._subMeshCount}),r(0,i,"boundingBox",function(){return this._boundingBox}),r(0,i,"boundingBoxCorners",function(){return this._boundingBoxCorners}),r(0,i,"boundingSphere",function(){return this._boundingSphere}),t}(),vi=function(e){function t(){this._terrainHeightData=null,this._width=0,this._height=0,this._bitType=0,this._value=NaN,t.__super.call(this)}a(t,"laya.d3.terrain.TerrainHeightData",M);return t.prototype.onAsynLoaded=function(e,t,i){this._width=i[0],this._height=i[1],this._bitType=i[2],this._value=i[3];var n,a=NaN;8==this._bitType?(n=new Uint8Array(t),a=1/255):16==this._bitType&&(n=new Int16Array(t),a=1/32766),this._terrainHeightData=new Float32Array(this._height*this._width);for(var r=0,o=this._height*this._width;r<o;r++)this._terrainHeightData[r]=n[r]*a*this._value/2;this._endLoaded()},t.load=function(e,n,a,r,o){return i.loader.create(e,null,null,t,[n,a,r,o],1,!1)},t}(),xi=function(e){function t(){this._version=NaN,this._cameraCoordinateInverse=!1,this._gridSize=NaN,this._chunkNumX=0,this._chunkNumZ=0,this._heightDataX=0,this._heightDataZ=0,this._heightDataBitType=0,this._heightDataValue=NaN,this._heightDataUrl=null,this._detailTextureInfos=null,this._chunkInfos=null,this._heightData=null,this._materialInfo=null,this._alphaMaps=null,this._normalMaps=null,t.__super.call(this)}a(t,"laya.d3.terrain.TerrainRes",M);var n=t.prototype;return n.parseData=function(e){var t=e[0],i=e[1];if(this._version=t.version,1==this._version){this._cameraCoordinateInverse=t.cameraCoordinateInverse,this._gridSize=t.gridSize,this._chunkNumX=t.chunkNumX,this._chunkNumZ=t.chunkNumZ;var n=t.heightData;if(this._heightDataX=n.numX,this._heightDataZ=n.numZ,this._heightDataBitType=n.bitType,this._heightDataValue=n.value,this._heightDataUrl=i[n.url],this._materialInfo=new Gt,t.material){var a=t.material.ambient,r=t.material.diffuse,s=t.material.specular;this._materialInfo.ambientColor=new At(a[0],a[1],a[2]),this._materialInfo.diffuseColor=new At(r[0],r[1],r[2]),this._materialInfo.specularColor=new Rt(s[0],s[1],s[2],s[3])}var h=t.detailTexture;this._detailTextureInfos=o(h.length);for(var l=0;l<h.length;l++){var c=h[l],p=new Yt;p.diffuseTexture=i[c.diffuse],p.normalTexture=c.normal?i[c.normal]:null,c.scale?p.scale=new Nt(c.scale[0],c.scale[1]):p.scale=new Nt(1,1),c.offset?p.offset=new Nt(c.offset[0],c.offset[1]):p.offset=new Nt(0,0),this._detailTextureInfos[l]=p}var u=t.alphaMap;for(this._alphaMaps=o(u.length),l=0;l<this._alphaMaps.length;l++)this._alphaMaps[l]=t.alphaMap[l];var d=t.normalMap;for(this._normalMaps=o(d.length),l=0;l<this._normalMaps.length;l++)this._normalMaps[l]=t.normalMap[l];var _=t.chunkInfo;if(this._chunkNumX*this._chunkNumZ!=_.length)return alert("terrain data error"),!1;for(this._chunkInfos=o(_.length),l=0;l<_.length;l++){var m=_[l],f=new Xt,g=m.alphaMap.length,y=m.detailID.length;if(g!=y)return alert("terrain chunk data error"),!1;f.alphaMap=o(g),f.detailID=o(y),f.normalMap=i[this._normalMaps[m.normalMap]];for(var x=0;x<g;x++){f.alphaMap[x]=i[this._alphaMaps[m.alphaMap[x]]];var b=m.detailID[x],w=b.length;f.detailID[x]=new Uint8Array(w);for(var S=0;S<w;S++)f.detailID[x][S]=b[S]}this._chunkInfos[l]=f}this._heightData=v.getRes(this._heightDataUrl),this.onLoadTerrainComplete(this._heightData)}return!0},n.onLoadTerrainComplete=function(e){this._endLoaded()},n.onAsynLoaded=function(e,t,i){this.parseData(t)},t.load=function(e){return i.loader.create(e,null,null,t,null,1,!1)},t}(),bi=function(e){function t(){this._player=null,this._templet=null,t.__super.call(this),this._player=new s}a(t,"laya.d3.component.animation.KeyframeAnimations",e);var n=t.prototype;return n._updateAnimtionPlayer=function(){this._player._update(i.timer.delta)},n._addUpdatePlayerToTimer=function(){i.timer.frameLoop(1,this,this._updateAnimtionPlayer)},n._removeUpdatePlayerToTimer=function(){i.timer.clear(this,this._updateAnimtionPlayer)},n._onOwnerActiveHierarchyChanged=function(e){this._owner.displayedInStage&&(e?this._addUpdatePlayerToTimer():this._removeUpdatePlayerToTimer())},n._load=function(e){e.activeInHierarchy&&this._addUpdatePlayerToTimer(),e.on("activeinhierarchychanged",this,this._onOwnerActiveHierarchyChanged)},n._unload=function(t){e.prototype._unload.call(this,t),t.activeInHierarchy&&this._removeUpdatePlayerToTimer(),t.off("activeinhierarchychanged",this,this._onOwnerActiveHierarchyChanged),this._player._destroy(),this._player=null,this._templet=null},r(0,n,"url",null,function(e){console.log("Warning: discard property,please use templet property instead.");var t=i.loader.create(e,null,null,h);this._templet!==t&&(0!==this._player.state&&this._player.stop(!0),this._templet=t,this._player.templet=t,this.event("animationchanged",this))}),r(0,n,"player",function(){return this._player}),r(0,n,"templet",function(){return this._templet},function(e){this._templet!==e&&(0!==this._player.state&&this._player.stop(!0),this._templet=e,this._player.templet=e,this.event("animationchanged",this))}),r(0,n,"currentFrameIndex",function(){return this._player.currentKeyframeIndex}),r(0,n,"currentAnimationClipIndex",function(){return this._player.currentAnimationClipIndex}),r(0,n,"nodeCount",function(){return this._templet.getNodeCount(this._player.currentAnimationClipIndex)}),t}($t),wi=function(e){function t(){t.__super.call(this),this._clipNames=[],this._clips=[],this._playStartFrames=[],this._playEndFrames=[],this._cacheNodesSpriteOwners=[],this._cacheNodesAvatarOwners=[],this._cacheNodesDefaultlValues=[],this._cacheNodesToSpriteMap=[],this._cacheSpriteToNodesMap=[],this._cacheFullFrames=[],this._publicClipsDatas=[],this._playEventIndex=-1,this._updateTransformPropertyLoopCount=-1,this._lastFrameIndex=-1,this._defaultClipIndex=-1,this._cachePlayRate=1,this._currentPlayClip=null,this._currentFrameIndex=-1,this._currentTime=0,this._elapsedPlaybackTime=0,this._startUpdateLoopCount=-1,this.isCache=!0,this.cacheFrameRate=60,this.playbackRate=1,this.playOnWake=!0}a(t,"laya.d3.component.Animator",e);var o=t.prototype;return i.imps(o,{"laya.resource.IDestroy":!0}),o._getAvatarOwnersByClip=function(e){var t=this._clips[e]._nodes,i=t.length,n=this._cacheNodesAvatarOwners[e];n.length=i;var a=this._cacheNodesDefaultlValues[e];a.length=i;for(var r=0;r<i;r++){for(var o=this._avatarNodes[0],s=t[r],h=s.path,l=0,c=h.length;l<c;l++){var p=h[l];if(""===p)break;if(!(o=o.getChildByName(p)))break}if(o){n[r]=o;var u=V._propertyGetFuncs[s.propertyNameID](o);if(u){var d=new Float32Array(s.keyFrameWidth);for(a[r]=d,l=0,c=u.length;l<c;l++)d[l]=u[l]}}}},o._handleSpriteOwnersByClip=function(e){var t=this._clips[e]._nodes,i=t.length,n=this._cacheNodesSpriteOwners[e];n.length=i;var a=this._cacheNodesDefaultlValues[e];a.length=i;for(var r=0;r<i;r++){var o=this._owner,s=t[r],h=s.path,l=0,c=0;for(l=0,c=h.length;l<c;l++){var p=h[l];if(""===p)break;if(!(o=o.getChildByName(p)))break}if(o){n[r]=o;var u=V._propertyGetFuncs[s.propertyNameID](null,o);if(u){var d=new Float32Array(s.keyFrameWidth);for(a[r]=d,l=0,c=u.length;l<c;l++)d[l]=u[l]}}}},o._offClipAndAvatarRelateEvent=function(e,t){e.loaded?t.loaded||t.off("loaded",this,this._getAvatarOwnersByClip):e.off("loaded",this,this._getAvatarOwnersAndInitDatasAsync)},o._getAvatarOwnersByClipAsync=function(e,t){t.loaded?this._getAvatarOwnersByClip(e):t.once("loaded",this,this._getAvatarOwnersByClip,[e])},o._offGetSpriteOwnersByClipAsyncEvent=function(e){e.loaded||e.off("loaded",this,this._getSpriteOwnersByClipAsync)},o._getSpriteOwnersByClipAsync=function(e,t){t.loaded?this._handleSpriteOwnersByClip(e):t.once("loaded",this,this._handleSpriteOwnersByClip,[e])},o._getAvatarOwnersAndInitDatasAsync=function(){for(var e=0,t=this._clips.length;e<t;e++)this._getAvatarOwnersByClipAsync(e,this._clips[e]);for(this._avatar._cloneDatasToAnimator(this),e=0,t=this._avatarNodes.length;e<t;e++)this._checkAnimationNode(this._avatarNodes[e],this._owner)},o._offGetClipCacheFullKeyframeIndicesEvent=function(e){e.loaded||e.off("loaded",this,this._computeCacheFullKeyframeIndices)},o._computeCacheFullKeyframeIndices=function(e){var t=this._clips[e],i=this._cacheFrameRateInterval*this._cachePlayRate,n=t._getFullKeyframeIndicesWithCache(i);if(n)this._cacheFullFrames[e]=n;else{n=this._cacheFullFrames[e]=[];var a=t._nodes,r=a.length;n.length=r;for(var o=Math.ceil(t._duration/i-1e-5)+1,s=0;s<r;s++){var h=a[s],l=new Int32Array(o);l.fill(-1);for(var c=h.keyFrames,p=0,u=c.length;p<u;p++)for(var d=c[p],_=d.startTime,m=_+d.duration;_<=m;){l[Math.ceil(_/i-1e-5)]=p,_+=i}n[s]=l}t._cacheFullKeyframeIndices(i,n)}},o._updateAnimtionPlayer=function(){this._updatePlayer(i.timer.delta/1e3)},o._onOwnerActiveHierarchyChanged=function(){this._owner.activeInHierarchy?(i.timer.frameLoop(1,this,this._updateAnimtionPlayer),this.playOnWake&&this.clip&&this.play()):(0!==this.playState&&(this._stoped=!0),i.timer.clear(this,this._updateAnimtionPlayer))},o._eventScript=function(e,t){for(var i=this._currentPlayClip._animationEvents,n=i.length;this._playEventIndex<n;this._playEventIndex++){var a=i[this._playEventIndex],r=a.time;if(!(e<=r&&r<t))break;for(var o=this._owner._scripts,s=0,h=o.length;s<h;s++){var l=o[s],c=l[a.eventName];c&&c.apply(l,a.params)}}},o._setPlayParams=function(e,t){var i=this._currentTime;this._currentTime=e,this._currentFrameIndex=Math.max(Math.floor(this.currentPlayTime/t-1e-5),0),this._currentFrameTime=this._currentFrameIndex*t,this._eventScript(i,e)},o._setPlayParamsWhenStop=function(e,t){var i=this._currentTime;this._currentTime=e,this._currentFrameIndex=Math.max(Math.floor(e/t-1e-5),0),this._currentFrameTime=this._currentFrameIndex*t,this._eventScript(i,e),this._currentPlayClip=null},o._revertKeyframeNodes=function(e,t){var i=this._cacheNodesDefaultlValues[t],n=e._nodes;if(this._avatar)for(var a=this._cacheNodesAvatarOwners[t],r=0,o=a.length;r<o;r++){var s=a[r];s&&V._propertySetFuncs[n[r].propertyNameID](s,null,i[r])}else{var h=this._cacheNodesSpriteOwners[t];for(r=0,o=h.length;r<o;r++){var l=h[r];l&&V._propertySetFuncs[n[r].propertyNameID](null,l,i[r])}}},o._onAnimationStop=function(){var e,t,i,n=0,a=0;this._lastFrameIndex=-1;var r=this._currentPlayClip._nodes;if(this._avatar){var o=this._cacheNodesAvatarOwners[this._currentPlayClipIndex];for(n=0,a=o.length;n<a;n++){var s=o[n];i=(t=(e=r[n]).keyFrames)[t.length-1].data,s&&V._propertySetFuncs[e.propertyNameID](s,null,i)}}else{var h=this._cacheNodesSpriteOwners[this._currentPlayClipIndex];for(n=0,a=h.length;n<a;n++){var l=h[n];i=(t=(e=r[n]).keyFrames)[t.length-1].data,l&&V._propertySetFuncs[e.propertyNameID](null,l,i)}}},o._setAnimationClipPropertyToAnimationNode=function(e,t,i){for(var n=0,a=t.length;n<a;n++){var r=t[n],o=e[r];if(o){var s=this._currentPlayClip._nodes[r],h=i[r];h&&V._propertySetFuncs[s.propertyNameID](o,null,h)}}},o._setAnimationClipPropertyToSprite3D=function(e,t){for(var i=0,n=e.length;i<n;i++){var a=e[i];if(a){var r=this._currentPlayClip._nodes[i],o=t[i];o&&V._propertySetFuncs[r.propertyNameID](null,a,o)}}},o._handleSpriteOwnersBySprite=function(e,t,i,n){var a=this._clips[e],r=i.join("/"),o=a._nodesMap[r];if(o)for(var s=this._cacheNodesSpriteOwners[e],h=a._nodes,l=this._cacheNodesDefaultlValues[e],c=0,p=o.length;c<p;c++){var u=o[c],d=h.indexOf(u);if(t){s[d]=n;var _=V._propertyGetFuncs[u.propertyNameID](null,n);if(_){var m=l[d];m||(l[d]=m=new Float32Array(u.keyFrameWidth));for(var f=0,g=_.length;f<g;f++)m[f]=_[f]}}else s[d]=null}},o._evaluateAvatarNodesCacheMode=function(e,i,n,a,r){i._evaluateAnimationlDatasCacheMode(e,this._cacheFullFrames[this._currentPlayClipIndex],this,n,r),this._setAnimationClipPropertyToAnimationNode(e,r,n);for(var o=0,s=this._avatarNodes.length;o<s;o++){var h=this._avatarNodes[o].transform;if(h._worldUpdate){var l=new Float32Array(16);a[o]=l,h._setWorldMatrixAndUpdate(l)}else{var c=h.getWorldMatrix();a[o]=c||t.deafaultMatrix}}},o._evaluateAvatarNodesRealTime=function(e,i,n,a,r){i._evaluateAnimationlDatasRealTime(e,this.currentPlayTime,n,r),this._setAnimationClipPropertyToAnimationNode(e,r,n);for(var o=0,s=this._avatarNodes.length;o<s;o++){var h=this._avatarNodes[o].transform;h._worldUpdate?h._setWorldMatrixNoUpdate(a[o]):a[o]=t.deafaultMatrix}},o._updateAvatarNodesToSpriteCacheMode=function(e,i){for(var n=0,a=this._cacheSpriteToNodesMap.length;n<a;n++){var r=this._cacheSpriteToNodesMap[n],o=i[r];if(o!==t.deafaultMatrix){var s=this._avatarNodes[r].transform._entity,h=s.worldMatrix;Jt.matrix4x4MultiplyMFM(this._owner._transform.worldMatrix,o,h),s.worldMatrix=h}}},o._updateAvatarNodesToSpriteRealTime=function(){for(var e=0,i=this._cacheSpriteToNodesMap.length;e<i;e++){var n=this._avatarNodes[this._cacheSpriteToNodesMap[e]],a=n.transform._entity,r=n.transform;if(r._worldUpdate){var o=t._tempMatrix4x40;r._setWorldMatrixAndUpdate(o);var s=a.worldMatrix;Jt.matrix4x4MultiplyMFM(this._owner._transform.worldMatrix,o,s),a.worldMatrix=s}}},o._updatePlayer=function(e){if(null!=this._currentPlayClip&&!this._stoped&&this._currentPlayClip.loaded){var t=this._cacheFrameRateInterval*this._cachePlayRate,i=0;this._startUpdateLoopCount!==T.loopCount&&(i=e*this.playbackRate,this._elapsedPlaybackTime+=i);var n=this._currentPlayClip._frameRate,a=this._playStartFrames[this._currentPlayClipIndex]/n,r=Math.min(this._playEndFrames[this._currentPlayClipIndex]/n,this._currentPlayClip._duration)-a;if(!this._currentPlayClip.islooping&&this._elapsedPlaybackTime>=r)return this._onAnimationStop(),this._setPlayParamsWhenStop(r,t),void this.event("stopped");if(i+=this._currentTime,r>0)if(i>=r)do{(i-=r)<r&&(this._setPlayParams(i,t),this.event("complete")),this._playEventIndex=0,this._eventScript(0,i)}while(i>=r);else this._setPlayParams(i,t);else this._currentTime=this._currentFrameTime=this._currentFrameIndex=this._playEventIndex=0,this.event("complete")}},o._update=function(e){var t=this._currentPlayClip;if(2===this.playState&&t&&t.loaded){var n=this.playbackRate*i.timer.scale,a=this._cachePlayRate;this._canCache=this.isCache&&n>=a;var r,o=-1;if(this._canCache){if(o=this._currentFrameIndex,this._lastFrameIndex===o)return;if(r=t._getAnimationDataWithCache(a,o),this._avatar){var s=this._cacheNodesAvatarOwners[this._currentPlayClipIndex],h=t._cachePropertyMap,l=h.length;l>0&&(r||((r=[]).length=l,t._cacheAnimationData(a,o,r),t._evaluateAnimationlDatasCacheMode(s,this._cacheFullFrames[this._currentPlayClipIndex],this,r,h)),this._setAnimationClipPropertyToAnimationNode(s,h,r)),this._curAvatarNodeDatas=t._getAvatarDataWithCache(this._avatar,this._cachePlayRate,o),this._curAvatarNodeDatas||(this._curAvatarNodeDatas=[],this._curAvatarNodeDatas.length=this._avatarNodes.length,t._cacheAvatarData(this._avatar,this._cachePlayRate,o,this._curAvatarNodeDatas),this._evaluateAvatarNodesCacheMode(s,t,t._publicClipDatas,this._curAvatarNodeDatas,t._unCachePropertyMap)),this._updateAvatarNodesToSpriteCacheMode(t,this._curAvatarNodeDatas)}else{var c=this._cacheNodesSpriteOwners[this._currentPlayClipIndex];r||((r=[]).length=this._currentPlayClip._nodes.length,t._evaluateAnimationlDatasCacheMode(c,this._cacheFullFrames[this._currentPlayClipIndex],this,r,null),t._cacheAnimationData(a,o,r)),this._setAnimationClipPropertyToSprite3D(c,r)}}else if(r=t._publicClipDatas,this._avatar){if(t._evaluateAnimationlDatasRealTime(this._cacheNodesAvatarOwners[this._currentPlayClipIndex],this.currentPlayTime,r,t._cachePropertyMap),!this._publicAvatarNodeDatas){this._publicAvatarNodeDatas=[];var p=this._avatarNodes.length;this._publicAvatarNodeDatas.length=p;for(var u=1;u<p;u++)this._publicAvatarNodeDatas[u]=new Float32Array(16)}this._curAvatarNodeDatas=this._publicAvatarNodeDatas,this._evaluateAvatarNodesRealTime(this._cacheNodesAvatarOwners[this._currentPlayClipIndex],t,r,this._curAvatarNodeDatas,t._unCachePropertyMap),this._updateAvatarNodesToSpriteRealTime()}else t._evaluateAnimationlDatasRealTime(this._cacheNodesSpriteOwners[this._currentPlayClipIndex],this.currentPlayTime,r,null);this._lastFrameIndex=o}},o._checkAnimationNode=function(e,t){e.name!==t.name||t._transform.dummy||t._isLinkSpriteToAnimationNode(this,e,!0);for(var i=0,n=t._childs.length;i<n;i++)this._checkAnimationNode(e,t.getChildAt(i))},o._load=function(e){e.activeInHierarchy&&i.timer.frameLoop(1,this,this._updateAnimtionPlayer),this._owner.on("activeinhierarchychanged",this,this._onOwnerActiveHierarchyChanged)},o._unload=function(t){e.prototype._unload.call(this,t),t.activeInHierarchy&&i.timer.clear(this,this._updateAnimtionPlayer),this._owner.off("activeinhierarchychanged",this,this._onOwnerActiveHierarchyChanged),this._curAvatarNodeDatas=null},o._destroy=function(){e.prototype._destroy.call(this);for(var t=0,i=this._clips.length;t<i;t++)this._clips[t]._removeReference();this._currentPlayClip=null,this._clipNames=null,this._cacheNodesSpriteOwners=null,this._cacheNodesAvatarOwners=null,this._cacheNodesDefaultlValues=null,this._clips=null,this._cacheFullFrames=null},o._cloneTo=function(e){var t=e;t.avatar=this.avatar;this._clips.length;for(var i=0,n=this._clips.length;i<n;i++)t.addClip(this._clips[i]);if(this.clip&&(t.clip=this.clip),this._linkSpritesData){t._linkSpritesData={};for(var a in this._linkSpritesData)t._linkSpritesData[a]=this._linkSpritesData[a].slice()}},o.addClip=function(e,t,i,n){void 0===i&&(i=0),void 0===n&&(n=4294967295),t=t||e.name;var a=this._clipNames.indexOf(t);if(-1!==a){if(this._clips[a]!==e)throw new Error("Animation:this playName has exist with another clip.")}else{var r=this._clips.indexOf(e);if(i<0||n<0)throw new Error("Animator:startFrame and endFrame must large than zero.");if(i>n)throw new Error("Animator:startFrame must less than endFrame.");this._clipNames.push(t),this._clips.push(e),this._playStartFrames.push(i),this._playEndFrames.push(n),this._cacheNodesSpriteOwners.push([]),this._cacheNodesAvatarOwners.push([]),this._cacheNodesDefaultlValues.push([]),this._publicClipsDatas.push([]),e._addReference(),r=this._clips.length-1,this._avatar?this._avatar.loaded?this._getAvatarOwnersByClipAsync(r,e):this._avatar.once("loaded",this,this._getAvatarOwnersByClipAsync,[r,e]):this._getSpriteOwnersByClipAsync(r,e),e.loaded?this._computeCacheFullKeyframeIndices(r):e.once("loaded",this,this._computeCacheFullKeyframeIndices,[r])}},o.removeClip=function(e){var t=this._clips.indexOf(e);-1!==t&&(this._avatar?this._offClipAndAvatarRelateEvent(this._avatar,e):this._offGetSpriteOwnersByClipAsyncEvent(e),this._offGetClipCacheFullKeyframeIndicesEvent(e),this._clipNames.splice(t,1),this._clips.splice(t,1),this._playStartFrames.splice(t,1),this._playEndFrames.splice(t,1),this._cacheNodesSpriteOwners.splice(t,1),this._cacheNodesAvatarOwners.splice(t,1),this._cacheNodesDefaultlValues.splice(t,1),this._publicClipsDatas.splice(t,1),e._removeReference())},o.removeClipByName=function(e){var t=this._clipNames.indexOf(e);if(-1!==t){var i=this._clips[t];this._avatar?this._offClipAndAvatarRelateEvent(this._avatar,i):this._offGetSpriteOwnersByClipAsyncEvent(i),this._offGetClipCacheFullKeyframeIndicesEvent(i),this._clipNames.splice(t,1),this._clips.splice(t,1),this._playStartFrames.splice(t,1),this._playEndFrames.splice(t,1),this._cacheNodesSpriteOwners.splice(t,1),this._cacheNodesAvatarOwners.splice(t,1),this._cacheNodesDefaultlValues.splice(t,1),this._publicClipsDatas.splice(t,1)}},o.getClip=function(e){var t=this._clipNames.indexOf(e);return-1!==t?this._clips[t]:null},o.getClipCount=function(){return this._clips.length},o.play=function(e,t){if(void 0===t&&(t=1),!e&&-1==this._defaultClipIndex)throw new Error("Animator:must have  default clip value,please set clip property.");e?(this._currentPlayClipIndex=this._clipNames.indexOf(e),this._currentPlayClip=this._clips[this._currentPlayClipIndex]):(this._currentPlayClipIndex=this._defaultClipIndex,this._currentPlayClip=this._clips[this._defaultClipIndex]),this._currentTime=0,this._currentFrameTime=0,this._elapsedPlaybackTime=0,this._playEventIndex=0,this.playbackRate=t,this._stoped=!1,this._currentFrameIndex=0,this._startUpdateLoopCount=T.loopCount,this._lastPlayAnimationClip&&this._lastPlayAnimationClip!==this._currentPlayClip&&this._revertKeyframeNodes(this._lastPlayAnimationClip,this._lastPlayAnimationClipIndex),this._updatePlayer(0),this._lastPlayAnimationClip=this._currentPlayClip,this._lastPlayAnimationClipIndex=this._currentPlayClipIndex},o.stop=function(){0!==this.playState&&(this._stoped=!0,this.event("stopped"))},o._getLinkSpritePath=function(e,t){t.unshift(e.name);var i=e._parent;i._hierarchyAnimator===this?this._getLinkSpritePath(i,t):t.shift()},o.linkSprite3DToAvatarNode=function(e,t){if(t._hierarchyAnimator===this){if(this._avatar){var i=this._avatarNodeMap[e];if(i){this._linkSpritesData=this._linkSpritesData||{};var n=[];return this._getLinkSpritePath(t,n),this._linkSpritesData[e]=n,t._isLinkSpriteToAnimationNode(this,i,!0),!0}return!1}return!1}throw"Animator:sprite3D must belong to this Animator"},o.unLinkSprite3DToAvatarNode=function(e){if(this._avatar){var t=e.transform.dummy;if(t){var i=this._avatarNodeMap[t._owner.name];return e._isLinkSpriteToAnimationNode(this,i,!1),!0}return!1}return!1},r(0,o,"playState",function(){return null==this._currentPlayClip?0:this._stoped?0:2}),r(0,o,"avatar",function(){return this._avatar},function(e){if(this._avatar!==e){var t=this._avatar;this._avatar=e;for(var i=this._clips.length,n=0;n<i;n++)this._offClipAndAvatarRelateEvent(t,this._clips[n]);e&&(e.loaded?this._getAvatarOwnersAndInitDatasAsync():e.once("loaded",this,this._getAvatarOwnersAndInitDatasAsync))}}),r(0,o,"cacheFrameRate",function(){return this._cacheFrameRate},function(e){if(this._cacheFrameRate!==e){this._cacheFrameRate=e,this._cacheFrameRateInterval=1/this._cacheFrameRate;for(var t=0,i=this._clips.length;t<i;t++)this._clips[t].loaded&&this._computeCacheFullKeyframeIndices(t)}}),r(0,o,"clip",function(){return this._clips[this._defaultClipIndex]},function(e){var t=e?this._clips.indexOf(e):-1;this._defaultClipIndex!==t&&(-1!==this._defaultClipIndex&&this.removeClip(this._clips[this._defaultClipIndex]),-1!==t&&this.addClip(e,e.name),this._defaultClipIndex=t)}),r(0,o,"currentFrameIndex",function(){return this._currentFrameIndex}),r(0,o,"cachePlayRate",function(){return this._cachePlayRate},function(e){if(this._cachePlayRate!==e){this._cachePlayRate=e;for(var t=0,i=this._clips.length;t<i;t++)this._clips[t].loaded&&this._computeCacheFullKeyframeIndices(t)}}),r(0,o,"currentFrameTime",function(){return this._currentFrameTime}),r(0,o,"currentPlayClip",function(){return this._currentPlayClip}),r(0,o,"currentPlayTime",function(){return this._currentTime+this._playStartFrames[this._currentPlayClipIndex]/this._currentPlayClip._frameRate}),r(0,o,"playbackTime",null,function(e){if(null!=this._currentPlayClip&&this._currentPlayClip&&this._currentPlayClip.loaded){this._startUpdateLoopCount=T.loopCount;var t=this._cacheFrameRateInterval*this._cachePlayRate;this._currentTime=e,this._currentFrameIndex=Math.floor(this.currentPlayTime/t),this._currentFrameTime=this._currentFrameIndex*t}}),r(0,o,"paused",function(){return this._stoped},function(e){this._stoped=e,e&&this.event("paused")}),n(t,["deafaultMatrix",function(){return this.deafaultMatrix=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])},"_tempMatrix4x40",function(){return this._tempMatrix4x40=new Float32Array(16)}]),t}($t),Si=(function(e){function t(){this._attachSkeleton=null,this._extenData=null,this.attachBones=null,this.matrixs=null,t.__super.call(this),this.attachBones=[],this.matrixs=[]}a(t,"laya.d3.component.AttachPoint",e);var i=t.prototype;i._load=function(t){e.prototype._load.call(this,t),this._attachSkeleton=t.getComponentByType(Zi)},i._update=function(e){if(this._attachSkeleton&&!this._attachSkeleton.destroyed&&0!==this._attachSkeleton.player.state&&this._attachSkeleton.curBonesDatas){var t=this._attachSkeleton.player,i=this._attachSkeleton.templet;this.matrixs.length=this.attachBones.length;for(var n=this._attachSkeleton.curBonesDatas,a=this.owner.transform.worldMatrix,r=0,o=this.attachBones.length;r<o;r++){var s=16*i.getNodeIndexWithName(t.currentAnimationClipIndex,this.attachBones[r]),h=this.matrixs[r];h||(h=this.matrixs[r]=new Ct);for(var l=h.elements,c=0;c<16;c++)l[c]=n[s+c];Ct.multiply(a,h,h)}this.event("complete")}}}($t),function(e){function t(){t.__super.call(this),this._isRigidbody=!1,this._runtimeCollisonMap={},this._runtimeCollisonTestMap={},this._ignoreCollisonMap={},this.isTrigger=!0}a(t,"laya.d3.component.physics.Collider",e);var i=t.prototype;return i._clearCollsionMap=function(){for(var e in this._runtimeCollisonMap){var t=this._runtimeCollisonMap[e];delete t._runtimeCollisonMap[this.id],t._isRigidbody&&delete t._runtimeCollisonTestMap[this.id];var i=t.id;delete this._runtimeCollisonMap[i],this._isRigidbody&&delete this._runtimeCollisonTestMap[i]}},i._unload=function(e){for(var t in this._runtimeCollisonMap){var i=this._runtimeCollisonMap[t];delete i._runtimeCollisonMap[this.id],i._isRigidbody&&delete i._runtimeCollisonTestMap[this.id],delete this._ignoreCollisonMap[t]._ignoreCollisonMap[this.id]}},i._setIsRigidbody=function(e){if(this._isRigidbody!==e){this._isRigidbody=e;var t=this._owner;if(t.displayedInStage){var i=t.layer;i._removeCollider(this),i._addCollider(this)}}},i._getType=function(){return-1},i._collisonTo=function(e){return!1},i.raycast=function(e,t,i){throw void 0===i&&(i=1.79e308),new Error("Collider:Must override it.")},r(0,i,"enable",e.prototype._$get_enable,function(e){if(this._enable!==e){this._owner.displayedInStage&&(e||this._clearCollsionMap()),this._enable=e,this.event("enablechanged",this._enable)}}),r(0,i,"isSingleton",function(){return t._isSingleton}),t._isSingleton=!1,t}($t)),Ii=function(e){function t(){t.__super.call(this)}a(t,"laya.d3.component.Rigidbody",e);return r(0,t.prototype,"enable",e.prototype._$get_enable,function(e){if(this._enable!==e){for(var t=this._owner._colliders,i=0,n=t.length;i<n;i++){var a=t[i];a._setIsRigidbody(e);var r=a._runtimeCollisonMap,o=a._runtimeCollisonTestMap;if(!e)for(var s in r)delete o[s]}this._enable=e,this.event("enablechanged",this._enable)}}),t}($t),Mi=(function(e){function t(){t.__super.call(this)}a(t,"laya.d3.component.Script",$t);var i=t.prototype;i.onTriggerEnter=function(e){},i.onTriggerExit=function(e){},i.onTriggerStay=function(e){},r(0,i,"isSingleton",function(){return t._isSingleton}),t._isSingleton=!1}(),function(e){function t(e){t.__super.call(this,e)}a(t,"laya.d3.core.GlitterRender",ti);var i=t.prototype;return i._calculateBoundingBox=function(){var e=this._boundingBox.min.elements;e[0]=-Number.MAX_VALUE,e[1]=-Number.MAX_VALUE,e[2]=-Number.MAX_VALUE;var t=this._boundingBox.min.elements;t[0]=Number.MAX_VALUE,t[1]=Number.MAX_VALUE,t[2]=Number.MAX_VALUE},i._calculateBoundingSphere=function(){var e=this._boundingSphere.center.elements;e[0]=0,e[1]=0,e[2]=0,this._boundingSphere.radius=Number.MAX_VALUE},i._renderUpdate=function(e){this._setShaderValueMatrix4x4(0,this._owner.transform.worldMatrix);var t=this._owner.getProjectionViewWorldMatrix(e);this._setShaderValueMatrix4x4(1,t);var i=this._owner.templet;return this._setShaderValueNumber(3,i.lifeTime),this._setShaderValueNumber(2,i._currentTime),!0},t}()),Ci=function(e){function t(e){this._owner=null,this._sharedMesh=null,t.__super.call(this),this._owner=e}a(t,"laya.d3.core.MeshFilter",e);var i=t.prototype;return i._sharedMeshLoaded=function(){this.event("loaded")},i._destroy=function(){e.prototype._destroy.call(this),this._owner=null,this._sharedMesh&&(this._sharedMesh._removeReference(),this._sharedMesh=null)},r(0,i,"sharedMesh",function(){return this._sharedMesh},function(e){var t=this._sharedMesh;t&&t._removeReference(),this._sharedMesh=e,e._addReference(),this.event("meshchanged",[this,t,e]),e.loaded||this._sharedMesh.once("loaded",this,this._sharedMeshLoaded)}),r(0,i,"_isAsyncLoaded",function(){return this._sharedMesh.loaded}),r(0,i,"_originalBoundingBoxCorners",function(){return this._sharedMesh.boundingBoxCorners}),r(0,i,"_originalBoundingSphere",function(){return this._sharedMesh.boundingSphere}),r(0,i,"_originalBoundingBox",function(){return this._sharedMesh.boundingBox}),t}(ei),ki=function(e){function t(e){t.__super.call(this,e),e.meshFilter.on("meshchanged",this,this._onMeshChanged)}a(t,"laya.d3.core.MeshRender",ti);var i=t.prototype;return i._onMeshChanged=function(e,t,i){i.loaded?this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0:i.once("loaded",this,this._onMeshLoaed)},i._onMeshLoaed=function(e,t){this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0},i._calculateBoundingSphereByInitSphere=function(e){var t=NaN,i=this._owner.transform,n=i.scale.elements,a=Math.abs(n[0]),r=Math.abs(n[1]),o=Math.abs(n[2]);t=a>=r&&a>=o?a:r>=o?r:o,At.transformCoordinate(e.center,i.worldMatrix,this._boundingSphere.center),this._boundingSphere.radius=e.radius*t},i._calculateBoundBoxByInitCorners=function(e){for(var t=this._owner.transform.worldMatrix,i=0;i<8;i++)At.transformCoordinate(e[i],t,ti._tempBoundBoxCorners[i]);xt.createfromPoints(ti._tempBoundBoxCorners,this._boundingBox)},i._calculateBoundingSphere=function(){var e=this._owner.meshFilter.sharedMesh;null==e||null==e.boundingSphere?this._boundingSphere.toDefault():this._calculateBoundingSphereByInitSphere(e.boundingSphere)},i._calculateBoundingBox=function(){var e=this._owner.meshFilter.sharedMesh;null==e||null==e.boundingBox?this._boundingBox.toDefault():this._calculateBoundBoxByInitCorners(e.boundingBoxCorners)},i._renderUpdate=function(e){var t=this._owner.transform;if(t){this._setShaderValueMatrix4x4(0,t.worldMatrix);var i=this._owner.getProjectionViewWorldMatrix(e);this._setShaderValueMatrix4x4(1,i)}else this._setShaderValueMatrix4x4(0,Ct.DEFAULT),this._setShaderValueMatrix4x4(1,e);return Zt.debugMode&&this._renderRenderableBoundBox(),!0},t}(),Ei=function(e){function t(e){t.__super.call(this),this._tempRotationMatrix=new Ct,this._uvLength=new Nt,this._firstActiveElement=0,this._firstNewElement=0,this._firstFreeElement=0,this._firstRetiredElement=0,this._owner=e,this._ownerRender=e.particleRender,this._boundingBoxCorners=o(8,null),this._boundingSphere=new wt(new At,Number.MAX_VALUE),this._boundingBox=new xt(new At(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),new At(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE)),this._currentTime=0,this._isEmitting=!1,this._isPlaying=!1,this._isPaused=!1,this._burstsIndex=0,this._frameRateTime=0,this._emissionTime=0,this._totalDelayTime=0,this._simulateUpdate=!1,this._bufferMaxParticles=1,this.duration=5,this.looping=!0,this.prewarm=!1,this.startDelayType=0,this.startDelay=0,this.startDelayMin=0,this.startDelayMax=0,this._startLifetimeType=0,this._startLifetimeConstant=5,this._startLifeTimeGradient=new Q,this._startLifetimeConstantMin=0,this._startLifetimeConstantMax=5,this._startLifeTimeGradientMin=new Q,this._startLifeTimeGradientMax=new Q,this._maxStartLifetime=5,this.startSpeedType=0,this.startSpeedConstant=5,this.startSpeedConstantMin=0,this.startSpeedConstantMax=5,this.threeDStartSize=!1,this.startSizeType=0,this.startSizeConstant=1,this.startSizeConstantSeparate=new At(1,1,1),this.startSizeConstantMin=0,this.startSizeConstantMax=1,this.startSizeConstantMinSeparate=new At(0,0,0),this.startSizeConstantMaxSeparate=new At(1,1,1),this.threeDStartRotation=!1,this.startRotationType=0,this.startRotationConstant=0,this.startRotationConstantSeparate=new At(0,0,0),this.startRotationConstantMin=0,this.startRotationConstantMax=0,this.startRotationConstantMinSeparate=new At(0,0,0),this.startRotationConstantMaxSeparate=new At(0,0,0),this.randomizeRotationDirection=0,this.startColorType=0,this.startColorConstant=new Rt(1,1,1,1),this.startColorConstantMin=new Rt(1,1,1,1),this.startColorConstantMax=new Rt(1,1,1,1),this.gravityModifier=0,this.simulationSpace=1,this.scaleMode=0,this.playOnAwake=!0,this._rand=new Lt(0),this.autoRandomSeed=!0,this.randomSeed=new Uint32Array(1),this._randomSeeds=new Uint32Array(t._RANDOMOFFSET.length),this.isPerformanceMode=!0,this._emission=new j,this._emission.enbale=!0,this._owner.on("activeinhierarchychanged",this,this._onOwnerActiveHierarchyChanged)}a(t,"laya.d3.core.particleShuriKen.ShurikenParticleSystem",e);var s=t.prototype;return i.imps(s,{"laya.d3.core.render.IRenderable":!0,"laya.d3.core.IClone":!0}),s._getVertexBuffer=function(e){return void 0===e&&(e=0),0===e?this._vertexBuffer:null},s._getIndexBuffer=function(){return this._indexBuffer},s._generateBoundingSphere=function(){var e=this._boundingSphere.center.elements;e[0]=0,e[1]=0,e[2]=0,this._boundingSphere.radius=Number.MAX_VALUE},s._generateBoundingBox=function(){var e=this._owner.particleRender,i=this._boundingBox.min,n=this._boundingBox.max,a=0,r=0,o=NaN;switch(this.startLifetimeType){case 0:o=this.startLifetimeConstant;break;case 1:o=-Number.MAX_VALUE;var s=s;for(a=0,r=s.gradientCount;a<r;a++)o=Math.max(o,s.getValueByIndex(a));break;case 2:o=Math.max(this.startLifetimeConstantMin,this.startLifetimeConstantMax);break;case 3:o=-Number.MAX_VALUE;var h=h;for(a=0,r=h.gradientCount;a<r;a++)o=Math.max(o,h.getValueByIndex(a));var l=l;for(a=0,r=l.gradientCount;a<r;a++)o=Math.max(o,l.getValueByIndex(a))}var c=NaN,p=NaN;switch(this.startSpeedType){case 0:c=p=this.startSpeedConstant;break;case 1:break;case 2:c=this.startLifetimeConstantMin,p=this.startLifetimeConstantMax}var u,d,_,m;this._shape&&this._shape.enable||(u=d=At.ZERO,_=At.ZERO,m=At.UnitZ);var f=new At(_.x*c,_.y*c,_.z*c),g=new At(m.x*p,m.y*p,m.z*p);if(this._velocityOverLifetime&&this._velocityOverLifetime.enbale){var y=this._velocityOverLifetime.velocity;switch(y.type){case 0:y.constant;break;case 1:new At(y.gradientX.getAverageValue(),y.gradientY.getAverageValue(),y.gradientZ.getAverageValue());break;case 2:y.constantMin,y.constantMax;break;case 3:new At(y.gradientXMin.getAverageValue(),y.gradientYMin.getAverageValue(),y.gradientZMin.getAverageValue()),new At(y.gradientXMax.getAverageValue(),y.gradientYMax.getAverageValue(),y.gradientZMax.getAverageValue())}}var v,x,b=this._owner.transform,w=b.position,S=t._tempVector39,I=S.elements,M=e.renderMode;switch(this.scaleMode){case 0:var C=b.scale;v=C,I[0]=C.x,I[1]=C.z,I[2]=C.y,1===M&&(x=C);break;case 1:var k=b.localScale;v=k,I[0]=k.x,I[1]=k.z,I[2]=k.y,1===M&&(x=k);break;case 2:v=b.scale,I[0]=I[1]=I[2]=1,1===M&&(x=At.ONE)}var E,T;switch(this._velocityOverLifetime&&this._velocityOverLifetime.enbale||(E=new At(f.x*o,f.y*o,f.z*o),T=new At(g.x*o,g.y*o,g.z*o),2!=this.scaleMode?(At.add(u,E,i),At.multiply(v,i,i),At.add(d,T,n),At.multiply(v,n,n)):(At.multiply(v,u,i),At.add(i,E,i),At.multiply(v,d,n),At.add(n,T,n))),this.simulationSpace){case 0:break;case 1:At.add(i,w,i),At.add(n,w,n)}var L=NaN,D=NaN;switch(this.startSizeType){case 0:if(this.threeDStartSize){var N=N;L=Math.max(N.x,N.y),1===M&&(D=N.y)}else L=this.startSizeConstant,1===M&&(D=this.startSizeConstant);break;case 1:break;case 2:if(this.threeDStartSize){var A=A;L=Math.max(A.x,A.y),1===M&&(D=A.y)}else L=this.startSizeConstantMax,1===M&&(D=this.startSizeConstantMax)}if(this._sizeOverLifetime&&this._sizeOverLifetime.enbale){this._sizeOverLifetime.size;L*=this._sizeOverLifetime.size.getMaxSizeInGradient()}var R=t._tempVector30,B=R.elements,P=NaN,O=NaN;switch(M){case 0:P=L*t.halfKSqrtOf2,At.scale(S,L,R),At.subtract(i,R,i),At.add(n,R,n);break;case 1:var V=t._tempVector31,U=t._tempVector32,F=t._tempVector33,H=t._tempVector34;this._velocityOverLifetime&&this._velocityOverLifetime.enbale||(At.multiply(x,g,U),At.multiply(x,f,F));var z=D*e.stretchedBillboardLengthScale,X=At.scalarLength(U)*e.stretchedBillboardSpeedScale+z,Y=At.scalarLength(F)*e.stretchedBillboardSpeedScale+z,G=t._tempVector35,j=t._tempVector36;At.normalize(U,G),At.scale(G,X,H),At.subtract(T,H,H),At.normalize(F,j),At.scale(j,Y,V),At.add(E,V,V),P=L*t.halfKSqrtOf2,At.scale(S,P,R);var W=t._tempVector37,q=t._tempVector38;At.scale(G,.5,W),At.scale(j,.5,q),At.multiply(W,S,W),At.multiply(q,S,q),At.add(i,q,i),At.min(i,H,i),At.subtract(i,R,i),At.subtract(n,W,n),At.max(n,V,n),At.add(n,R,n);break;case 2:O=.5*(L*=Math.cos(.7853981633974483)),B[0]=S.x*O,B[1]=S.z*O,At.subtract(i,R,i),At.add(n,R,n);break;case 3:O=.5*(L*=Math.cos(.7853981633974483)),At.scale(S,O,R),At.subtract(i,R,i),At.add(n,R,n)}this._boundingBox.getCorners(this._boundingBoxCorners)},s._updateEmission=function(){if(i.stage.isVisibility&&this.isAlive)if(this._simulateUpdate)this._simulateUpdate=!1;else{var e=this._startUpdateLoopCount===T.loopCount||this._isPaused?0:i.timer.delta/1e3;e=Math.min(t._maxElapsedTime,e),this._updateParticles(e)}},s._updateParticles=function(e){(4!==this._ownerRender.renderMode||this._ownerRender.mesh)&&(this._currentTime+=e,this._retireActiveParticles(),this._freeRetiredParticles(),this._totalDelayTime+=e,this._totalDelayTime<this._playStartDelay||this._emission.enbale&&this._isEmitting&&!this._isPaused&&this._advanceTime(e,this._currentTime))},s._updateParticlesSimulationRestart=function(e){this._firstActiveElement=0,this._firstNewElement=0,this._firstFreeElement=0,this._firstRetiredElement=0,this._burstsIndex=0,this._frameRateTime=e,this._emissionTime=0,this._totalDelayTime=0,this._currentTime=e;var t=e;t<this._playStartDelay?this._totalDelayTime=t:this._emission.enbale&&this._advanceTime(e,e)},s._addUpdateEmissionToTimer=function(){i.timer.frameLoop(1,this,this._updateEmission)},s._removeUpdateEmissionToTimer=function(){i.timer.clear(this,this._updateEmission)},s._onOwnerActiveHierarchyChanged=function(e){this._owner.displayedInStage&&(e?this._addUpdateEmissionToTimer():this._removeUpdateEmissionToTimer())},s._retireActiveParticles=function(){for(;this._firstActiveElement!=this._firstNewElement;){var e=this._firstActiveElement*this._floatCountPerVertex*this._vertexStride,t=e+this._timeIndex;if(this._currentTime-this._vertices[t]+1e-4<this._vertices[e+this._startLifeTimeIndex])break;this._vertices[t]=this._drawCounter,this._firstActiveElement++,this._firstActiveElement>=this._bufferMaxParticles&&(this._firstActiveElement=0)}},s._freeRetiredParticles=function(){for(;this._firstRetiredElement!=this._firstActiveElement;){var e=this._drawCounter-this._vertices[this._firstRetiredElement*this._floatCountPerVertex*this._vertexStride+this._timeIndex];if(this.isPerformanceMode&&e<3)break;this._firstRetiredElement++,this._firstRetiredElement>=this._bufferMaxParticles&&(this._firstRetiredElement=0)}},s._burst=function(e,t){for(var i=0,n=this._emission._bursts,a=n.length;this._burstsIndex<a;this._burstsIndex++){var r=n[this._burstsIndex],o=r.time;if(!(e<=o&&o<t))break;var s=0;this.autoRandomSeed?s=b.lerp(r.minCount,r.maxCount,Math.random()):(this._rand.seed=this._randomSeeds[0],s=b.lerp(r.minCount,r.maxCount,this._rand.getFloat()),this._randomSeeds[0]=this._rand.seed),i+=s}return i},s._advanceTime=function(e,t){var i=0,n=this._emissionTime;this._emissionTime+=e;var a=0;if(this._emissionTime>this.duration){if(!this.looping){for(a=Math.min(this.maxParticles-this.aliveParticleCount,a),i=0;i<a;i++)this.emit(t);return this._isPlaying=!1,void this.stop()}a+=this._burst(n,this._emissionTime),this._emissionTime-=this.duration,this.event("complete"),this._burstsIndex=0,a+=this._burst(0,this._emissionTime)}else a+=this._burst(n,this._emissionTime);for(a=Math.min(this.maxParticles-this.aliveParticleCount,a),i=0;i<a;i++)this.emit(t);var r=this.emission.emissionRate;if(r>0){var o=1/r;for(this._frameRateTime+=o,this._frameRateTime=this._currentTime-(this._currentTime-this._frameRateTime)%this._maxStartLifetime;this._frameRateTime<=t&&this.emit(this._frameRateTime);)this._frameRateTime+=o;this._frameRateTime=Math.floor(t/o)*o}},s._initBufferDatas=function(){this._vertexBuffer&&(this._vertexBuffer.destroy(),this._indexBuffer.destroy());var e=this._ownerRender,t=e.renderMode;if(-1!==t&&this.maxParticles>0){var i,n,a=0,r=0,o=0,s=0,h=0,l=e.mesh;if(4===t){if(l){if(l._vertexBuffers.length>1)throw new Error("ShurikenParticleSystem: submesh Count mesh be One or all subMeshes have the same vertexDeclaration.");n=mt.vertexDeclaration,this._floatCountPerVertex=n.vertexStride/4,this._startLifeTimeIndex=12,this._timeIndex=16,this._vertexStride=l._vertexBuffers[0].vertexCount;var c=this._bufferMaxParticles*this._vertexStride,p=c%65535;if(Math.floor(c/65535)+1>1)throw new Error("ShurikenParticleSystem:the maxParticleCount multiply mesh vertexCount is large than 65535.");this._vertexBuffer=qi.create(n,p,35048),this._vertices=new Float32Array(this._floatCountPerVertex*p),this._indexStride=l._indexBuffer.indexCount;var u=l._indexBuffer.getData(),d=this._bufferMaxParticles*this._indexStride;for(this._indexBuffer=Wi.create("ushort",d,35044),i=new Uint16Array(d),s=0,a=0;a<this._bufferMaxParticles;a++){var _=a*this._vertexStride;for(r=0,o=u.length;r<o;r++)i[s++]=_+u[r]}this._indexBuffer.setData(i)}}else{for(n=_t.vertexDeclaration,this._floatCountPerVertex=n.vertexStride/4,this._startLifeTimeIndex=7,this._timeIndex=11,this._vertexStride=4,this._vertexBuffer=qi.create(n,this._bufferMaxParticles*this._vertexStride,35048),this._vertices=new Float32Array(this._floatCountPerVertex*this._bufferMaxParticles*this._vertexStride),a=0;a<this._bufferMaxParticles;a++)h=a*this._floatCountPerVertex*this._vertexStride,this._vertices[h]=-.5,this._vertices[h+1]=-.5,this._vertices[h+2]=0,this._vertices[h+3]=1,h+=this._floatCountPerVertex,this._vertices[h]=.5,this._vertices[h+1]=-.5,this._vertices[h+2]=1,this._vertices[h+3]=1,h+=this._floatCountPerVertex,this._vertices[h]=.5,this._vertices[h+1]=.5,this._vertices[h+2]=1,this._vertices[h+3]=0,h+=this._floatCountPerVertex,this._vertices[h]=-.5,this._vertices[h+1]=.5,this._vertices[h+2]=0,this._vertices[h+3]=0;for(this._indexStride=6,this._indexBuffer=Wi.create("ushort",6*this._bufferMaxParticles,35044),i=new Uint16Array(6*this._bufferMaxParticles),a=0;a<this._bufferMaxParticles;a++){s=6*a;var m=a*this._vertexStride,f=m+2;i[s++]=m,i[s++]=f,i[s++]=m+1,i[s++]=m,i[s++]=m+3,i[s++]=f}this._indexBuffer.setData(i)}}},s._destroy=function(){e.prototype._destroy.call(this),this._owner.activeInHierarchy&&this._removeUpdateEmissionToTimer(),this._vertexBuffer.destroy(),this._indexBuffer.destroy(),this._emission._destroy(),this._owner=null,this._vertices=null,this._vertexBuffer=null,this._indexBuffer=null,this._emission=null,this._shape=null,this.startLifeTimeGradient=null,this.startLifeTimeGradientMin=null,this.startLifeTimeGradientMax=null,this.startSizeConstantSeparate=null,this.startSizeConstantMinSeparate=null,this.startSizeConstantMaxSeparate=null,this.startRotationConstantSeparate=null,this.startRotationConstantMinSeparate=null,this.startRotationConstantMaxSeparate=null,this.startColorConstant=null,this.startColorConstantMin=null,this.startColorConstantMax=null,this._velocityOverLifetime=null,this._colorOverLifetime=null,this._sizeOverLifetime=null,this._rotationOverLifetime=null,this._textureSheetAnimation=null},s.emit=function(e){var i=t._tempPosition,n=t._tempDirection;if(this._shape&&this._shape.enable)this.autoRandomSeed?this._shape.generatePositionAndDirection(i,n):this._shape.generatePositionAndDirection(i,n,this._rand,this._randomSeeds);else{var a=i.elements,r=n.elements;a[0]=a[1]=a[2]=0,r[0]=r[1]=0,r[2]=1}return this.addParticle(i,n,e)},s.addParticle=function(e,t,i){At.normalize(t,t);var n=this._firstFreeElement+1;if(n>=this._bufferMaxParticles&&(n=0),n===this._firstRetiredElement)return!1;he.create(this,this._ownerRender,this._owner.transform);if(this._currentTime-i>=he.startLifeTime)return!0;var a=NaN,r=NaN,o=NaN,s=NaN,h=NaN,l=NaN,c=NaN,p=this._velocityOverLifetime&&this._velocityOverLifetime.enbale;if(p){var u=this._velocityOverLifetime.velocity.type;2===u||3===u?this.autoRandomSeed?(a=Math.random(),r=Math.random(),o=Math.random()):(this._rand.seed=this._randomSeeds[9],a=this._rand.getFloat(),r=this._rand.getFloat(),o=this._rand.getFloat(),this._randomSeeds[9]=this._rand.seed):p=!1}else p=!1;var d=this._colorOverLifetime&&this._colorOverLifetime.enbale;if(d){3===this._colorOverLifetime.color.type?this.autoRandomSeed?s=Math.random():(this._rand.seed=this._randomSeeds[10],s=this._rand.getFloat(),this._randomSeeds[10]=this._rand.seed):d=!1}else d=!1;var _=this._sizeOverLifetime&&this._sizeOverLifetime.enbale;if(_){3===this._sizeOverLifetime.size.type?this.autoRandomSeed?h=Math.random():(this._rand.seed=this._randomSeeds[11],h=this._rand.getFloat(),this._randomSeeds[11]=this._rand.seed):_=!1}else _=!1;var m=this._rotationOverLifetime&&this._rotationOverLifetime.enbale;if(m){var f=this._rotationOverLifetime.angularVelocity.type;2===f||3===f?this.autoRandomSeed?l=Math.random():(this._rand.seed=this._randomSeeds[12],l=this._rand.getFloat(),this._randomSeeds[12]=this._rand.seed):m=!1}else m=!1;var g=this._textureSheetAnimation&&this._textureSheetAnimation.enable;if(g){3===this._textureSheetAnimation.frame.type?this.autoRandomSeed?c=Math.random():(this._rand.seed=this._randomSeeds[15],c=this._rand.getFloat(),this._randomSeeds[15]=this._rand.seed):g=!1}else g=!1;var y,v=this._firstFreeElement*this._floatCountPerVertex*this._vertexStride,x=he.startUVInfo[0],b=he.startUVInfo[1],w=he.startUVInfo[2],S=he.startUVInfo[3],I=e.elements,M=t.elements,C=0,k=0,E=0,T=0,L=0,D=this._ownerRender;if(4===D.renderMode){var N=D.mesh._vertexBuffers[0];y=N.getData();var A=N.vertexDeclaration;k=A.getVertexElementByUsage(0).offset/4;var R=A.getVertexElementByUsage(1);E=R?R.offset/4:-1;var B=A.getVertexElementByUsage(2);T=B?B.offset/4:-1,C=A.vertexStride/4,L=0}else{this._vertices[v+2]=w,this._vertices[v+3]=S+b;var P=v+this._floatCountPerVertex;this._vertices[P+2]=w+x,this._vertices[P+3]=S+b;var O=P+this._floatCountPerVertex;this._vertices[O+2]=w+x,this._vertices[O+3]=S;var V=O+this._floatCountPerVertex;this._vertices[V+2]=w,this._vertices[V+3]=S}for(var U=v,F=v+this._floatCountPerVertex*this._vertexStride;U<F;U+=this._floatCountPerVertex){var H=0;if(4===D.renderMode){H=U;var z=C*L++,X=z+k;this._vertices[H++]=y[X++],this._vertices[H++]=y[X++],this._vertices[H++]=y[X],-1===E?(this._vertices[H++]=1,this._vertices[H++]=1,this._vertices[H++]=1,this._vertices[H++]=1):(X=z+E,this._vertices[H++]=y[X++],this._vertices[H++]=y[X++],this._vertices[H++]=y[X++],this._vertices[H++]=y[X]),-1===T?(this._vertices[H++]=0,this._vertices[H++]=0):(X=z+T,this._vertices[H++]=w+y[X++]*x,this._vertices[H++]=S+y[X]*b)}else H=U+4;switch(this._vertices[H++]=I[0],this._vertices[H++]=I[1],this._vertices[H++]=I[2],this._vertices[H++]=he.startLifeTime,this._vertices[H++]=M[0],this._vertices[H++]=M[1],this._vertices[H++]=M[2],this._vertices[H++]=i,this._vertices[H++]=he.startColor[0],this._vertices[H++]=he.startColor[1],this._vertices[H++]=he.startColor[2],this._vertices[H++]=he.startColor[3],this._vertices[H++]=he.startSize[0],this._vertices[H++]=he.startSize[1],this._vertices[H++]=he.startSize[2],this._vertices[H++]=he.startRotation[0],this._vertices[H++]=he.startRotation[1],this._vertices[H++]=he.startRotation[2],this._vertices[H++]=he.startSpeed,d&&(this._vertices[H+1]=s),_&&(this._vertices[H+2]=h),m&&(this._vertices[H+3]=l),g&&(this._vertices[H+4]=c),p&&(this._vertices[H+5]=a,this._vertices[H+6]=r,this._vertices[H+7]=o),this.simulationSpace){case 0:H+=8,this._vertices[H++]=he.simulationWorldPostion[0],this._vertices[H++]=he.simulationWorldPostion[1],this._vertices[H++]=he.simulationWorldPostion[2],this._vertices[H++]=he.simulationWorldRotation[0],this._vertices[H++]=he.simulationWorldRotation[1],this._vertices[H++]=he.simulationWorldRotation[2],this._vertices[H++]=he.simulationWorldRotation[3];break;case 1:break;default:throw new Error("ShurikenParticleMaterial: SimulationSpace value is invalid.")}}return this._firstFreeElement=n,!0},s.addNewParticlesToVertexBuffer=function(){var e=0;this._firstNewElement<this._firstFreeElement?(e=this._firstNewElement*this._vertexStride*this._floatCountPerVertex,this._vertexBuffer.setData(this._vertices,e,e,(this._firstFreeElement-this._firstNewElement)*this._vertexStride*this._floatCountPerVertex)):(e=this._firstNewElement*this._vertexStride*this._floatCountPerVertex,this._vertexBuffer.setData(this._vertices,e,e,(this._bufferMaxParticles-this._firstNewElement)*this._vertexStride*this._floatCountPerVertex),this._firstFreeElement>0&&this._vertexBuffer.setData(this._vertices,0,0,this._firstFreeElement*this._vertexStride*this._floatCountPerVertex)),this._firstNewElement=this._firstFreeElement},s._beforeRender=function(e){return this._firstNewElement!=this._firstFreeElement&&this.addNewParticlesToVertexBuffer(),this._drawCounter++,this._firstActiveElement!=this._firstFreeElement&&(this._vertexBuffer._bind(),this._indexBuffer._bind(),!0)},s._render=function(e){var t=0,i=A.mainContext;this._firstActiveElement<this._firstFreeElement?(t=(this._firstFreeElement-this._firstActiveElement)*this._indexStride,i.drawElements(4,t,5123,2*this._firstActiveElement*this._indexStride),T.trianglesFaces+=t/3,T.drawCall++):(t=(this._bufferMaxParticles-this._firstActiveElement)*this._indexStride,i.drawElements(4,t,5123,2*this._firstActiveElement*this._indexStride),T.trianglesFaces+=t/3,T.drawCall++,this._firstFreeElement>0&&(t=this._firstFreeElement*this._indexStride,i.drawElements(4,t,5123,0),T.trianglesFaces+=t/3,T.drawCall++))},s.play=function(){if(this._burstsIndex=0,this._isEmitting=!0,this._isPlaying=!0,this._isPaused=!1,this._emissionTime=0,this._totalDelayTime=0,!this.autoRandomSeed)for(var e=0,i=this._randomSeeds.length;e<i;e++)this._randomSeeds[e]=this.randomSeed[0]+t._RANDOMOFFSET[e];switch(this.startDelayType){case 0:this._playStartDelay=this.startDelay;break;case 1:this.autoRandomSeed?this._playStartDelay=b.lerp(this.startDelayMin,this.startDelayMax,Math.random()):(this._rand.seed=this._randomSeeds[2],this._playStartDelay=b.lerp(this.startDelayMin,this.startDelayMax,this._rand.getFloat()),this._randomSeeds[2]=this._rand.seed);break;default:throw new Error("Utils3D: startDelayType is invalid.")}this._frameRateTime=this._currentTime+this._playStartDelay,this._startUpdateLoopCount=T.loopCount,this.event("played")},s.pause=function(){this._isPaused=!0,this.event("paused")},s.simulate=function(e,t){void 0===t&&(t=!0),this._simulateUpdate=!0,t?this._updateParticlesSimulationRestart(e):(this._isPaused=!1,this._updateParticles(e)),this.pause()},s.stop=function(){this._burstsIndex=0,this._isEmitting=!1,this._emissionTime=0,this.event("stopped")},s.cloneTo=function(e){var t=e;t.duration=this.duration,t.looping=this.looping,t.prewarm=this.prewarm,t.startDelayType=this.startDelayType,t.startDelay=this.startDelay,t.startDelayMin=this.startDelayMin,t.startDelayMax=this.startDelayMax,t._maxStartLifetime=this._maxStartLifetime,t.startLifetimeType=this.startLifetimeType,t.startLifetimeConstant=this.startLifetimeConstant,this.startLifeTimeGradient.cloneTo(t.startLifeTimeGradient),t.startLifetimeConstantMin=this.startLifetimeConstantMin,t.startLifetimeConstantMax=this.startLifetimeConstantMax,this.startLifeTimeGradientMin.cloneTo(t.startLifeTimeGradientMin),this.startLifeTimeGradientMax.cloneTo(t.startLifeTimeGradientMax),t.startSpeedType=this.startSpeedType,t.startSpeedConstant=this.startSpeedConstant,t.startSpeedConstantMin=this.startSpeedConstantMin,t.startSpeedConstantMax=this.startSpeedConstantMax,t.threeDStartSize=this.threeDStartSize,t.startSizeType=this.startSizeType,t.startSizeConstant=this.startSizeConstant,this.startSizeConstantSeparate.cloneTo(t.startSizeConstantSeparate),t.startSizeConstantMin=this.startSizeConstantMin,t.startSizeConstantMax=this.startSizeConstantMax,this.startSizeConstantMinSeparate.cloneTo(t.startSizeConstantMinSeparate),this.startSizeConstantMaxSeparate.cloneTo(t.startSizeConstantMaxSeparate),t.threeDStartRotation=this.threeDStartRotation,t.startRotationType=this.startRotationType,t.startRotationConstant=this.startRotationConstant,this.startRotationConstantSeparate.cloneTo(t.startRotationConstantSeparate),t.startRotationConstantMin=this.startRotationConstantMin,t.startRotationConstantMax=this.startRotationConstantMax,this.startRotationConstantMinSeparate.cloneTo(t.startRotationConstantMinSeparate),this.startRotationConstantMaxSeparate.cloneTo(t.startRotationConstantMaxSeparate),t.randomizeRotationDirection=this.randomizeRotationDirection,t.startColorType=this.startColorType,this.startColorConstant.cloneTo(t.startColorConstant),this.startColorConstantMin.cloneTo(t.startColorConstantMin),this.startColorConstantMax.cloneTo(t.startColorConstantMax),t.gravityModifier=this.gravityModifier,t.simulationSpace=this.simulationSpace,t.scaleMode=this.scaleMode,t.playOnAwake=this.playOnAwake,t.maxParticles=this.maxParticles,this._emission&&(t._emission=this._emission.clone()),this.shape&&(t.shape=this.shape.clone()),this.velocityOverLifetime&&(t.velocityOverLifetime=this.velocityOverLifetime.clone()),this.colorOverLifetime&&(t.colorOverLifetime=this.colorOverLifetime.clone()),this.sizeOverLifetime&&(t.sizeOverLifetime=this.sizeOverLifetime.clone()),this.rotationOverLifetime&&(t.rotationOverLifetime=this.rotationOverLifetime.clone()),this.textureSheetAnimation&&(t.textureSheetAnimation=this.textureSheetAnimation.clone()),t.isPerformanceMode=this.isPerformanceMode,t._isEmitting=this._isEmitting,t._isPlaying=this._isPlaying,t._isPaused=this._isPaused,t._playStartDelay=this._playStartDelay,t._frameRateTime=this._frameRateTime,t._emissionTime=this._emissionTime,t._totalDelayTime=this._totalDelayTime,t._burstsIndex=this._burstsIndex},s.clone=function(){var e=new this.constructor;return this.cloneTo(e),e},s._getVertexBuffers=function(){return null},r(0,s,"maxParticles",function(){return this._bufferMaxParticles-1},function(e){var t=e+1;t!==this._bufferMaxParticles&&(this._bufferMaxParticles=t,this._initBufferDatas())}),r(0,s,"isEmitting",function(){return this._isEmitting}),r(0,s,"isAlive",function(){return!!(this._isPlaying||this.aliveParticleCount>0)}),r(0,s,"shape",function(){return this._shape},function(e){this._shape!==e&&(e&&e.enable?this._ownerRender._addShaderDefine(yn.SHADERDEFINE_SHAPE):this._ownerRender._removeShaderDefine(yn.SHADERDEFINE_SHAPE),this._shape=e)}),r(0,s,"rotationOverLifetime",function(){return this._rotationOverLifetime},function(e){var t=this._ownerRender;if(e){var i=e.angularVelocity;if(!i)return;var n=i.separateAxes,a=i.type;if(e.enbale)switch(n?t._addShaderDefine(yn.SHADERDEFINE_ROTATIONOVERLIFETIMESEPERATE):t._addShaderDefine(yn.SHADERDEFINE_ROTATIONOVERLIFETIME),a){case 0:t._addShaderDefine(yn.SHADERDEFINE_ROTATIONOVERLIFETIMECONSTANT);break;case 1:t._addShaderDefine(yn.SHADERDEFINE_ROTATIONOVERLIFETIMECURVE);break;case 2:t._addShaderDefine(yn.SHADERDEFINE_ROTATIONOVERLIFETIMERANDOMCONSTANTS);break;case 3:t._addShaderDefine(yn.SHADERDEFINE_ROTATIONOVERLIFETIMERANDOMCURVES)}else t._removeShaderDefine(yn.SHADERDEFINE_ROTATIONOVERLIFETIME),t._removeShaderDefine(yn.SHADERDEFINE_ROTATIONOVERLIFETIMESEPERATE),t._removeShaderDefine(yn.SHADERDEFINE_ROTATIONOVERLIFETIMECONSTANT),t._removeShaderDefine(yn.SHADERDEFINE_ROTATIONOVERLIFETIMECURVE),t._removeShaderDefine(yn.SHADERDEFINE_ROTATIONOVERLIFETIMERANDOMCONSTANTS),t._removeShaderDefine(yn.SHADERDEFINE_ROTATIONOVERLIFETIMERANDOMCURVES);switch(a){case 0:n?t._setShaderValueColor(35,i.constantSeparate):t._setShaderValueNumber(34,i.constant);break;case 1:n?(t._setShaderValueBuffer(37,i.gradientX._elements),t._setShaderValueBuffer(38,i.gradientY._elements),t._setShaderValueBuffer(39,i.gradientZ._elements),t._setShaderValueBuffer(40,i.gradientW._elements)):t._setShaderValueBuffer(36,i.gradient._elements);break;case 2:n?(t._setShaderValueColor(35,i.constantMinSeparate),t._setShaderValueColor(42,i.constantMaxSeparate)):(t._setShaderValueNumber(34,i.constantMin),t._setShaderValueNumber(41,i.constantMax));break;case 3:n?(t._setShaderValueBuffer(37,i.gradientXMin._elements),t._setShaderValueBuffer(44,i.gradientXMax._elements),t._setShaderValueBuffer(38,i.gradientYMin._elements),t._setShaderValueBuffer(45,i.gradientYMax._elements),t._setShaderValueBuffer(39,i.gradientZMin._elements),t._setShaderValueBuffer(46,i.gradientZMax._elements),t._setShaderValueBuffer(40,i.gradientWMin._elements),t._setShaderValueBuffer(47,i.gradientWMax._elements)):(t._setShaderValueBuffer(36,i.gradientMin._elements),t._setShaderValueBuffer(43,i.gradientMax._elements))}}else t._removeShaderDefine(yn.SHADERDEFINE_ROTATIONOVERLIFETIME),t._removeShaderDefine(yn.SHADERDEFINE_ROTATIONOVERLIFETIMESEPERATE),t._removeShaderDefine(yn.SHADERDEFINE_ROTATIONOVERLIFETIMECONSTANT),t._removeShaderDefine(yn.SHADERDEFINE_ROTATIONOVERLIFETIMECURVE),t._removeShaderDefine(yn.SHADERDEFINE_ROTATIONOVERLIFETIMERANDOMCONSTANTS),t._removeShaderDefine(yn.SHADERDEFINE_ROTATIONOVERLIFETIMERANDOMCURVES),t._setShaderValueColor(35,null),t._setShaderValueColor(42,null),t._setShaderValueNumber(34,void 0),t._setShaderValueNumber(41,void 0),t._setShaderValueBuffer(37,null),t._setShaderValueBuffer(44,null),t._setShaderValueBuffer(38,null),t._setShaderValueBuffer(45,null),t._setShaderValueBuffer(39,null),t._setShaderValueBuffer(46,null),t._setShaderValueBuffer(40,null),t._setShaderValueBuffer(47,null),t._setShaderValueBuffer(36,null),t._setShaderValueBuffer(43,null);this._rotationOverLifetime=e}),r(0,s,"emission",function(){return this._emission}),r(0,s,"emissionTime",function(){return this._emissionTime>this.duration?this.duration:this._emissionTime}),r(0,s,"aliveParticleCount",function(){return this._firstNewElement>=this._firstRetiredElement?this._firstNewElement-this._firstRetiredElement:this._bufferMaxParticles-this._firstRetiredElement+this._firstNewElement}),r(0,s,"isPlaying",function(){return this._isPlaying}),r(0,s,"isPaused",function(){return this._isPaused}),r(0,s,"startLifetimeType",function(){return this._startLifetimeType},function(e){var t=0,i=0;switch(this.startLifetimeType){case 0:this._maxStartLifetime=this.startLifetimeConstant;break;case 1:this._maxStartLifetime=-Number.MAX_VALUE;var n=n;for(t=0,i=n.gradientCount;t<i;t++)this._maxStartLifetime=Math.max(this._maxStartLifetime,n.getValueByIndex(t));break;case 2:this._maxStartLifetime=Math.max(this.startLifetimeConstantMin,this.startLifetimeConstantMax);break;case 3:this._maxStartLifetime=-Number.MAX_VALUE;var a=a;for(t=0,i=a.gradientCount;t<i;t++)this._maxStartLifetime=Math.max(this._maxStartLifetime,a.getValueByIndex(t));var r=r;for(t=0,i=r.gradientCount;t<i;t++)this._maxStartLifetime=Math.max(this._maxStartLifetime,r.getValueByIndex(t))}this._startLifetimeType=e}),r(0,s,"_originalBoundingSphere",function(){return this._boundingSphere}),r(0,s,"startLifetimeConstant",function(){return this._startLifetimeConstant},function(e){0===this._startLifetimeType&&(this._maxStartLifetime=e),this._startLifetimeConstant=e}),r(0,s,"startLifetimeConstantMin",function(){return this._startLifetimeConstantMin},function(e){2===this._startLifetimeType&&(this._maxStartLifetime=Math.max(e,this._startLifetimeConstantMax)),this._startLifetimeConstantMin=e}),r(0,s,"startLifeTimeGradient",function(){return this._startLifeTimeGradient},function(e){if(1===this._startLifetimeType){this._maxStartLifetime=-Number.MAX_VALUE;for(var t=0,i=e.gradientCount;t<i;t++)this._maxStartLifetime=Math.max(this._maxStartLifetime,e.getValueByIndex(t))}this._startLifeTimeGradient=e}),r(0,s,"startLifetimeConstantMax",function(){return this._startLifetimeConstantMax},function(e){2===this._startLifetimeType&&(this._maxStartLifetime=Math.max(this._startLifetimeConstantMin,e)),this._startLifetimeConstantMax=e}),r(0,s,"startLifeTimeGradientMin",function(){return this._startLifeTimeGradientMin},function(e){if(3===this._startLifetimeType){var t=0,i=0;for(this._maxStartLifetime=-Number.MAX_VALUE,t=0,i=e.gradientCount;t<i;t++)this._maxStartLifetime=Math.max(this._maxStartLifetime,e.getValueByIndex(t));for(t=0,i=this._startLifeTimeGradientMax.gradientCount;t<i;t++)this._maxStartLifetime=Math.max(this._maxStartLifetime,this._startLifeTimeGradientMax.getValueByIndex(t))}this._startLifeTimeGradientMin=e}),r(0,s,"startLifeTimeGradientMax",function(){return this._startLifeTimeGradientMax},function(e){if(3===this._startLifetimeType){var t=0,i=0;for(this._maxStartLifetime=-Number.MAX_VALUE,t=0,i=this._startLifeTimeGradientMin.gradientCount;t<i;t++)this._maxStartLifetime=Math.max(this._maxStartLifetime,this._startLifeTimeGradientMin.getValueByIndex(t));for(t=0,i=e.gradientCount;t<i;t++)this._maxStartLifetime=Math.max(this._maxStartLifetime,e.getValueByIndex(t))}this._startLifeTimeGradientMax=e}),r(0,s,"velocityOverLifetime",function(){return this._velocityOverLifetime},function(e){var t=this._ownerRender;if(e){var i=e.velocity,n=i.type;if(e.enbale)switch(n){case 0:t._addShaderDefine(yn.SHADERDEFINE_VELOCITYOVERLIFETIMECONSTANT);break;case 1:t._addShaderDefine(yn.SHADERDEFINE_VELOCITYOVERLIFETIMECURVE);break;case 2:t._addShaderDefine(yn.SHADERDEFINE_VELOCITYOVERLIFETIMERANDOMCONSTANT);break;case 3:t._addShaderDefine(yn.SHADERDEFINE_VELOCITYOVERLIFETIMERANDOMCURVE)}else t._removeShaderDefine(yn.SHADERDEFINE_VELOCITYOVERLIFETIMECONSTANT),t._removeShaderDefine(yn.SHADERDEFINE_VELOCITYOVERLIFETIMECURVE),t._removeShaderDefine(yn.SHADERDEFINE_VELOCITYOVERLIFETIMERANDOMCONSTANT),t._removeShaderDefine(yn.SHADERDEFINE_VELOCITYOVERLIFETIMERANDOMCURVE);switch(n){case 0:t._setShaderValueColor(13,i.constant);break;case 1:t._setShaderValueBuffer(14,i.gradientX._elements),t._setShaderValueBuffer(15,i.gradientY._elements),t._setShaderValueBuffer(16,i.gradientZ._elements);break;case 2:t._setShaderValueColor(13,i.constantMin),t._setShaderValueColor(17,i.constantMax);break;case 3:t._setShaderValueBuffer(14,i.gradientXMin._elements),t._setShaderValueBuffer(18,i.gradientXMax._elements),t._setShaderValueBuffer(15,i.gradientYMin._elements),t._setShaderValueBuffer(19,i.gradientYMax._elements),t._setShaderValueBuffer(16,i.gradientZMin._elements),t._setShaderValueBuffer(20,i.gradientZMax._elements)}t._setShaderValueInt(21,e.space)}else t._removeShaderDefine(yn.SHADERDEFINE_VELOCITYOVERLIFETIMECONSTANT),t._removeShaderDefine(yn.SHADERDEFINE_VELOCITYOVERLIFETIMECURVE),t._removeShaderDefine(yn.SHADERDEFINE_VELOCITYOVERLIFETIMERANDOMCONSTANT),t._removeShaderDefine(yn.SHADERDEFINE_VELOCITYOVERLIFETIMERANDOMCURVE),t._setShaderValueColor(13,null),t._setShaderValueBuffer(14,null),t._setShaderValueBuffer(15,null),t._setShaderValueBuffer(16,null),t._setShaderValueColor(13,null),t._setShaderValueColor(17,null),t._setShaderValueBuffer(14,null),t._setShaderValueBuffer(18,null),t._setShaderValueBuffer(15,null),t._setShaderValueBuffer(19,null),t._setShaderValueBuffer(16,null),t._setShaderValueBuffer(20,null),t._setShaderValueInt(21,void 0);this._velocityOverLifetime=e}),r(0,s,"colorOverLifetime",function(){return this._colorOverLifetime},function(e){var t=this._ownerRender;if(e){var i=e.color;if(e.enbale)switch(i.type){case 1:t._addShaderDefine(yn.SHADERDEFINE_COLOROVERLIFETIME);break;case 3:t._addShaderDefine(yn.SHADERDEFINE_RANDOMCOLOROVERLIFETIME)}else t._removeShaderDefine(yn.SHADERDEFINE_COLOROVERLIFETIME),t._removeShaderDefine(yn.SHADERDEFINE_RANDOMCOLOROVERLIFETIME);switch(i.type){case 1:var n=i.gradient;t._setShaderValueBuffer(22,n._alphaElements),t._setShaderValueBuffer(23,n._rgbElements);break;case 3:var a=i.gradientMin,r=i.gradientMax;t._setShaderValueBuffer(22,a._alphaElements),t._setShaderValueBuffer(23,a._rgbElements),t._setShaderValueBuffer(24,r._alphaElements),t._setShaderValueBuffer(25,r._rgbElements)}}else t._removeShaderDefine(yn.SHADERDEFINE_COLOROVERLIFETIME),t._removeShaderDefine(yn.SHADERDEFINE_RANDOMCOLOROVERLIFETIME),t._setShaderValueBuffer(22,n._alphaElements),t._setShaderValueBuffer(23,n._rgbElements),t._setShaderValueBuffer(22,a._alphaElements),t._setShaderValueBuffer(23,a._rgbElements),t._setShaderValueBuffer(24,r._alphaElements),t._setShaderValueBuffer(25,r._rgbElements);this._colorOverLifetime=e}),r(0,s,"sizeOverLifetime",function(){return this._sizeOverLifetime},function(e){var t=this._ownerRender;if(e){var i=e.size,n=i.separateAxes,a=i.type;if(e.enbale)switch(a){case 0:n?t._addShaderDefine(yn.SHADERDEFINE_SIZEOVERLIFETIMECURVESEPERATE):t._addShaderDefine(yn.SHADERDEFINE_SIZEOVERLIFETIMECURVE);break;case 2:n?t._addShaderDefine(yn.SHADERDEFINE_SIZEOVERLIFETIMERANDOMCURVESSEPERATE):t._addShaderDefine(yn.SHADERDEFINE_SIZEOVERLIFETIMERANDOMCURVES)}else t._removeShaderDefine(yn.SHADERDEFINE_SIZEOVERLIFETIMECURVE),t._removeShaderDefine(yn.SHADERDEFINE_SIZEOVERLIFETIMECURVESEPERATE),t._removeShaderDefine(yn.SHADERDEFINE_SIZEOVERLIFETIMERANDOMCURVES),t._removeShaderDefine(yn.SHADERDEFINE_SIZEOVERLIFETIMERANDOMCURVESSEPERATE);switch(a){case 0:n?(t._setShaderValueBuffer(27,i.gradientX._elements),t._setShaderValueBuffer(28,i.gradientY._elements),t._setShaderValueBuffer(29,i.gradientZ._elements)):t._setShaderValueBuffer(26,i.gradient._elements);break;case 2:n?(t._setShaderValueBuffer(27,i.gradientXMin._elements),t._setShaderValueBuffer(31,i.gradientXMax._elements),t._setShaderValueBuffer(28,i.gradientYMin._elements),t._setShaderValueBuffer(32,i.gradientYMax._elements),t._setShaderValueBuffer(29,i.gradientZMin._elements),t._setShaderValueBuffer(33,i.gradientZMax._elements)):(t._setShaderValueBuffer(26,i.gradientMin._elements),t._setShaderValueBuffer(30,i.gradientMax._elements))}}else t._removeShaderDefine(yn.SHADERDEFINE_SIZEOVERLIFETIMECURVE),t._removeShaderDefine(yn.SHADERDEFINE_SIZEOVERLIFETIMECURVESEPERATE),t._removeShaderDefine(yn.SHADERDEFINE_SIZEOVERLIFETIMERANDOMCURVES),t._removeShaderDefine(yn.SHADERDEFINE_SIZEOVERLIFETIMERANDOMCURVESSEPERATE),t._setShaderValueBuffer(27,null),t._setShaderValueBuffer(31,null),t._setShaderValueBuffer(28,null),t._setShaderValueBuffer(32,null),t._setShaderValueBuffer(29,null),t._setShaderValueBuffer(33,null),t._setShaderValueBuffer(26,null),t._setShaderValueBuffer(30,null);this._sizeOverLifetime=e}),r(0,s,"textureSheetAnimation",function(){return this._textureSheetAnimation},function(e){var t=this._ownerRender;if(e){var i=e.frame,n=i.type;if(e.enable)switch(n){case 1:t._addShaderDefine(yn.SHADERDEFINE_TEXTURESHEETANIMATIONCURVE);break;case 3:t._addShaderDefine(yn.SHADERDEFINE_TEXTURESHEETANIMATIONRANDOMCURVE)}else t._removeShaderDefine(yn.SHADERDEFINE_TEXTURESHEETANIMATIONCURVE),t._removeShaderDefine(yn.SHADERDEFINE_TEXTURESHEETANIMATIONRANDOMCURVE);if(1===n||3===n){t._setShaderValueInt(48,e.cycles);var a=e.tiles,r=this._uvLength.elements;r[0]=1/a.x,r[1]=1/a.y,t._setShaderValueVector2(49,this._uvLength)}switch(n){case 1:t._setShaderValueBuffer(50,i.frameOverTimeData._elements);break;case 3:t._setShaderValueBuffer(50,i.frameOverTimeDataMin._elements),t._setShaderValueBuffer(51,i.frameOverTimeDataMax._elements)}}else t._removeShaderDefine(yn.SHADERDEFINE_TEXTURESHEETANIMATIONCURVE),t._removeShaderDefine(yn.SHADERDEFINE_TEXTURESHEETANIMATIONRANDOMCURVE),t._setShaderValueInt(48,void 0),t._setShaderValueVector2(49,null),t._setShaderValueBuffer(50,null),t._setShaderValueBuffer(51,null);this._textureSheetAnimation=e}),r(0,s,"_vertexBufferCount",function(){return 1}),r(0,s,"triangleCount",function(){return this._indexBuffer?this._indexBuffer.indexCount/3:0}),r(0,s,"_originalBoundingBox",function(){return this._boundingBox}),r(0,s,"_originalBoundingBoxCorners",function(){return this._boundingBoxCorners}),t.halfKSqrtOf2=.71,n(t,["_RANDOMOFFSET",function(){return this._RANDOMOFFSET=new Uint32Array([592910910,3276756734,322376503,306581307,1793934638,3737431713,2527743459,2368504881,4085612399,3774601268,326370691,1494990940,1089181156,3159510623,2941263940,2786374529,271901988,4233252447])},"_maxElapsedTime",function(){return this._maxElapsedTime=1/3},"_tempVector30",function(){return this._tempVector30=new At},"_tempVector31",function(){return this._tempVector31=new At},"_tempVector32",function(){return this._tempVector32=new At},"_tempVector33",function(){return this._tempVector33=new At},"_tempVector34",function(){return this._tempVector34=new At},"_tempVector35",function(){return this._tempVector35=new At},"_tempVector36",function(){return this._tempVector36=new At},"_tempVector37",function(){return this._tempVector37=new At},"_tempVector38",function(){return this._tempVector38=new At},"_tempVector39",function(){return this._tempVector39=new At},"_tempPosition",function(){return this._tempPosition=new At},"_tempDirection",function(){return this._tempDirection=new At}]),t}(ei),Ti=function(e){function t(e){this._finalGravity=new At,this._tempRotationMatrix=new Ct,t.__super.call(this,e),this._defaultBoundBox=new xt(new At,new At),this._renderMode=-1,this.stretchedBillboardCameraSpeedScale=0,this.stretchedBillboardSpeedScale=0,this.stretchedBillboardLengthScale=1}a(t,"laya.d3.core.particleShuriKen.ShurikenParticleRender",e);var n=t.prototype;return n._calculateBoundingBox=function(){var e=this._boundingBox.min.elements;e[0]=-Number.MAX_VALUE,e[1]=-Number.MAX_VALUE,e[2]=-Number.MAX_VALUE;var t=this._boundingBox.min.elements;t[0]=Number.MAX_VALUE,t[1]=Number.MAX_VALUE,t[2]=Number.MAX_VALUE},n._calculateBoundingSphere=function(){var e=this._owner.particleSystem._boundingSphere,t=NaN,i=this._owner.transform,n=i.scale.elements,a=Math.abs(n[0]),r=Math.abs(n[1]),o=Math.abs(n[2]);t=a>=r&&a>=o?a:r>=o?r:o,At.transformCoordinate(e.center,i.worldMatrix,this._boundingSphere.center),this._boundingSphere.radius=e.radius*t},n._renderUpdate=function(e){var t=this._owner.particleSystem;if(!i.stage.isVisibility||!t.isAlive)return!1;var n=this._owner.transform;switch(t.simulationSpace){case 0:break;case 1:this._setShaderValueColor(0,n.position),this._setShaderValueColor(1,n.rotation);break;default:throw new Error("ShurikenParticleMaterial: SimulationSpace value is invalid.")}switch(t.scaleMode){case 0:var a=n.scale;this._setShaderValueColor(4,a),this._setShaderValueColor(5,a);break;case 1:var r=n.localScale;this._setShaderValueColor(4,r),this._setShaderValueColor(5,r);break;case 2:this._setShaderValueColor(4,n.scale),this._setShaderValueColor(5,At.ONE)}var o=this._finalGravity.elements,s=jt.gravity.elements,h=t.gravityModifier;return o[0]=s[0]*h,o[1]=s[1]*h,o[2]=s[2]*h,this._setShaderValueBuffer(7,o),this._setShaderValueInt(11,t.simulationSpace),this._setShaderValueBool(8,t.threeDStartRotation),this._setShaderValueInt(6,t.scaleMode),this._setShaderValueInt(9,this.stretchedBillboardLengthScale),this._setShaderValueInt(10,this.stretchedBillboardSpeedScale),this._setShaderValueNumber(12,t._currentTime),Zt.debugMode&&this._renderRenderableBoundBox(),!0},n._destroy=function(){e.prototype._destroy.call(this),this._mesh&&(this._mesh._removeReference(),this._mesh=null)},r(0,n,"boundingBox",function(){return this._owner.particleSystem.isAlive?(this._boundingBoxNeedChange&&(this._calculateBoundingBox(),this._boundingBoxNeedChange=!1),this._boundingBox):this._defaultBoundBox}),r(0,n,"renderMode",function(){return this._renderMode},function(e){if(this._renderMode!==e){switch(this._renderMode){case 0:this._removeShaderDefine(yn.SHADERDEFINE_RENDERMODE_BILLBOARD);break;case 1:this._removeShaderDefine(yn.SHADERDEFINE_RENDERMODE_STRETCHEDBILLBOARD);break;case 2:this._removeShaderDefine(yn.SHADERDEFINE_RENDERMODE_HORIZONTALBILLBOARD);break;case 3:this._removeShaderDefine(yn.SHADERDEFINE_RENDERMODE_VERTICALBILLBOARD);break;case 4:this._removeShaderDefine(yn.SHADERDEFINE_RENDERMODE_MESH)}switch(this._renderMode=e,e){case 0:this._addShaderDefine(yn.SHADERDEFINE_RENDERMODE_BILLBOARD);break;case 1:this._addShaderDefine(yn.SHADERDEFINE_RENDERMODE_STRETCHEDBILLBOARD);break;case 2:this._addShaderDefine(yn.SHADERDEFINE_RENDERMODE_HORIZONTALBILLBOARD);break;case 3:this._addShaderDefine(yn.SHADERDEFINE_RENDERMODE_VERTICALBILLBOARD);break;case 4:this._addShaderDefine(yn.SHADERDEFINE_RENDERMODE_MESH);break;default:throw new Error("ShurikenParticleRender: unknown renderMode Value.")}this._owner.particleSystem._initBufferDatas()}}),r(0,n,"mesh",function(){return this._mesh},function(e){this._mesh!==e&&(this._mesh&&this._mesh._removeReference(),this._mesh=e,e&&e._addReference(),this._owner.particleSystem._initBufferDatas())}),t}(ti),Li=function(e){function t(e){this._owner=null,this._trailRenderElements=null,this._minVertexDistance=NaN,this._widthMultiplier=NaN,this._time=NaN,this._widthCurve=null,this._colorGradient=null,this._textureMode=0,this._curtime=0,this._curSubTrailFinishCurTime=0,this._curSubTrailFinished=!1,this._hasLifeSubTrail=!1,this._trailTotalLength=0,this._trailSupplementLength=0,this._trailDeadLength=0,this._isStart=!1,this._trailRenderElementIndex=0,t.__super.call(this),this._curSubTrailFinishPosition=new At,this._curSubTrailFinishDirection=new At,this._owner=e,this._trailRenderElements=[],this.addRenderElement()}a(t,"laya.d3.core.trail.TrailFilter",e);var i=t.prototype;return i.getRenderElementsCount=function(){return this._trailRenderElements.length},i.addRenderElement=function(){for(var e=0;e<this._trailRenderElements.length;e++)if(1==this._trailRenderElements[e]._isDead)return this._trailRenderElements[e].reActivate(),e;var t=new ve(this);return this._trailRenderElements.push(t),this._trailRenderElements.length-1},i.getRenderElement=function(e){return this._trailRenderElements[e]},i._update=function(e){this._curtime+=e.elapsedTime/1e3,this._owner._render._setShaderValueNumber(3,this._curtime),this._curSubTrailFinished&&(this._curSubTrailFinished=!1,this._trailRenderElementIndex=this.addRenderElement(),this.event("trailfilterchange",[this._trailRenderElementIndex,this._trailRenderElements[this._trailRenderElementIndex]]))},i.reset=function(){for(var e=0;e<this._trailRenderElements.length;e++)this._trailRenderElements[e].reActivate();this._isStart=!1,this._hasLifeSubTrail=!1,this._curSubTrailFinished=!1,this._curSubTrailFinishCurTime=0,this._trailTotalLength=0,this._trailSupplementLength=0,this._trailDeadLength=0},i._destroy=function(){e.prototype._destroy.call(this);for(var t=0;t<this._trailRenderElements.length;t++)this._trailRenderElements[t]._destroy();this._trailRenderElements=null,this._widthCurve=null,this._colorGradient=null,this._curSubTrailFinishPosition=null,this._curSubTrailFinishDirection=null},r(0,i,"widthMultiplier",function(){return this._widthMultiplier},function(e){this._widthMultiplier=e}),r(0,i,"time",function(){return this._time},function(e){this._time=e,this._owner._render._setShaderValueNumber(4,e)}),r(0,i,"widthCurve",function(){return this._widthCurve},function(e){this._widthCurve=e;var t=new Float32Array(4*e.length),i=0,n=0,a=0;for(i=0,n=e.length;i<n;i++)t[a++]=e[i].time,t[a++]=e[i].inTangent,t[a++]=e[i].outTangent,t[a++]=e[i].value;this._owner._render._setShaderValueBuffer(5,t),this._owner._render._setShaderValueInt(6,e.length)}),r(0,i,"minVertexDistance",function(){return this._minVertexDistance},function(e){this._minVertexDistance=e}),r(0,i,"colorGradient",function(){return this._colorGradient},function(e){this._colorGradient=e,this._owner._render._setShaderValueBuffer(7,e._colorKeyData),this._owner._render._setShaderValueBuffer(8,e._alphaKeyData),0==e.mode?this._owner._render._addShaderDefine(xn.SHADERDEFINE_GRADIENTMODE_BLEND):this._owner._render._removeShaderDefine(xn.SHADERDEFINE_GRADIENTMODE_BLEND)}),r(0,i,"textureMode",function(){return this._textureMode},function(e){this._textureMode=e}),t}(ei),Di=function(e){function t(e){t.__super.call(this,e)}a(t,"laya.d3.core.trail.TrailRenderer",ti);var i=t.prototype;return i._calculateBoundingBox=function(){var e=this._boundingBox.min.elements;e[0]=-Number.MAX_VALUE,e[1]=-Number.MAX_VALUE,e[2]=-Number.MAX_VALUE;var t=this._boundingBox.min.elements;t[0]=Number.MAX_VALUE,t[1]=Number.MAX_VALUE,t[2]=Number.MAX_VALUE},i._calculateBoundingSphere=function(){var e=this._boundingSphere.center.elements;e[0]=0,e[1]=0,e[2]=0,this._boundingSphere.radius=Number.MAX_VALUE},i._renderUpdate=function(e){return!0},t}(),Ni=function(e){function t(e){this._floatCountPerVertex=6,this._owner=null,this._vertices=null,this._vertexBuffer=null,this._firstActiveElement=0,this._firstNewElement=0,this._firstFreeElement=0,this._firstRetiredElement=0,this._currentTime=NaN,this._drawCounter=0,this.scLeft=null,this.scRight=null,this._numPositionMode=0,this._numPositionVelocityMode=0,this._lastTime=NaN,this._needPatch=!1,this._lastPatchAddPos0=null,this._lastPatchAddPos1=null,this._lastPatchAddTime=NaN,this.lifeTime=NaN,this.minSegmentDistance=NaN,this.minInterpDistance=NaN,this.maxSlerpCount=0,this._maxSegments=0,t.__super.call(this),this._tempVector0=new At,this._tempVector1=new At,this._tempVector2=new At,this._tempVector3=new At,this._posModeLastPosition0=new At,this._posModeLastPosition1=new At,this._posModePosition0=new At,this._posModePosition1=new At,this._posVelModePosition0=new At,this._posVelModeVelocity0=new At,this._posVelModePosition1=new At,this._posVelModeVelocity1=new At,this._owner=e,this._lastTime=0,this._firstActiveElement=0,this._firstNewElement=0,this._firstFreeElement=0,this._firstRetiredElement=0,this._currentTime=0,this._drawCounter=0,this._needPatch=!1,this._lastPatchAddPos0=new At,this._lastPatchAddPos1=new At,this.scLeft=new H,this.scRight=new H,this.lifeTime=.5,this.minSegmentDistance=.1,this.minInterpDistance=.6,this.maxSlerpCount=128,this._maxSegments=200,this._owner.on("activeinhierarchychanged",this,this._onActiveHierarchyChanged)}a(t,"laya.d3.resource.tempelet.GlitterTemplet",e);var n=t.prototype;return i.imps(n,{"laya.d3.core.render.IRenderable":!0}),n._getVertexBuffer=function(e){return void 0===e&&(e=0),0===e?this._vertexBuffer:null},n._getIndexBuffer=function(){return null},n._initialize=function(){this._vertexBuffer=qi.create(Ee.vertexDeclaration,2*this.maxSegments,35048),this._vertices=new Float32Array(this.maxSegments*this._floatCountPerVertex*2)},n._onActiveHierarchyChanged=function(e){e||(this._numPositionMode=0,this._numPositionVelocityMode=0,this._firstActiveElement=0,this._firstNewElement=0,this._firstFreeElement=0,this._firstRetiredElement=0,this._currentTime=0,this._drawCounter=0)},n._updateTextureCoordinates=function(){this._firstActiveElement<this._firstFreeElement?this._updateSubTextureCoordinates(this._firstActiveElement,2*(this._firstFreeElement-this._firstActiveElement)):(this._updateSubTextureCoordinates(this._firstActiveElement,2*(this.maxSegments-this._firstActiveElement)),this._firstFreeElement>0&&this._updateSubTextureCoordinates(0,2*this._firstFreeElement))},n._updateSubTextureCoordinates=function(e,t){for(var i=2*e,n=0;n<t;n+=2){var a=i+n,r=a*this._floatCountPerVertex,o=(a+1)*this._floatCountPerVertex;this._vertices[r+3]=this._vertices[o+3]=(this._vertices[r+5]-this._currentTime)/this.lifeTime}},n._retireActiveGlitter=function(){for(var e=this.lifeTime,t=2*this._floatCountPerVertex;this._firstActiveElement!=this._firstNewElement;){var i=this._firstActiveElement*t+5;if(this._currentTime-this._vertices[i]<e)break;this._vertices[i]=this._drawCounter,this._firstActiveElement++,this._firstActiveElement>=this.maxSegments&&(this._firstActiveElement=0)}},n._freeRetiredGlitter=function(){for(var e=2*this._floatCountPerVertex;this._firstRetiredElement!=this._firstActiveElement;){if(this._drawCounter-this._vertices[this._firstRetiredElement*e+5]<3)break;this._firstRetiredElement++,this._firstRetiredElement>=this.maxSegments&&(this._firstRetiredElement=0)}},n._calcVelocity=function(e,t,i){At.subtract(e,t,i),At.scale(i,.5,i)},n._addNewGlitterSegementToVertexBuffer=function(){var e=0;this._firstActiveElement<this._firstFreeElement?(e=2*this._firstActiveElement*this._floatCountPerVertex,this._vertexBuffer.setData(this._vertices,e,e,2*(this._firstFreeElement-this._firstActiveElement)*this._floatCountPerVertex)):(e=2*this._firstActiveElement*this._floatCountPerVertex,this._vertexBuffer.setData(this._vertices,e,e,2*(this.maxSegments-this._firstActiveElement)*this._floatCountPerVertex),this._firstFreeElement>0&&this._vertexBuffer.setData(this._vertices,0,0,2*this._firstFreeElement*this._floatCountPerVertex)),this._firstNewElement=this._firstFreeElement},n._addGlitter=function(e,t,i){this._needPatch&&(this._needPatch=!1,this._addGlitter(this._lastPatchAddPos0,this._lastPatchAddPos1,this._lastPatchAddTime));var n=this._firstFreeElement+1;n>=this.maxSegments&&(n=0,e.cloneTo(this._lastPatchAddPos0),t.cloneTo(this._lastPatchAddPos1),this._lastPatchAddTime=i,this._needPatch=!0),n===this._firstRetiredElement&&console.log("GlitterTemplet:current segement count have large than maxSegments,please adjust the  value of maxSegments or add Glitter Vertex Frequency.");var a=e.elements,r=t.elements,o=0,s=this._firstFreeElement*this._floatCountPerVertex*2;for(o=0;o<3;o++)this._vertices[s+o]=a[o];this._vertices[s+3]=0,this._vertices[s+4]=0,this._vertices[s+5]=i;var h=s+this._floatCountPerVertex;for(o=0;o<3;o++)this._vertices[h+o]=r[o];this._vertices[h+3]=0,this._vertices[h+4]=1,this._vertices[h+5]=i,this._firstFreeElement=n},n._update=function(e){this._currentTime+=e/1e3,this._retireActiveGlitter(),this._freeRetiredGlitter(),this._firstActiveElement==this._firstFreeElement&&(this._currentTime=0),this._firstRetiredElement==this._firstActiveElement&&(this._drawCounter=0),this._updateTextureCoordinates()},n._beforeRender=function(e){return this._firstNewElement!=this._firstFreeElement&&this._addNewGlitterSegementToVertexBuffer(),this._drawCounter++,this._firstActiveElement!=this._firstFreeElement&&(this._vertexBuffer.bindWithIndexBuffer(null),!0)},n._render=function(e){var t=0,i=A.mainContext;this._firstActiveElement<this._firstFreeElement?(t=2*(this._firstFreeElement-this._firstActiveElement),i.drawArrays(5,2*this._firstActiveElement,t),T.trianglesFaces+=t-2,T.drawCall++):(t=2*(this.maxSegments-this._firstActiveElement),i.drawArrays(5,2*this._firstActiveElement,t),T.trianglesFaces+=t-2,T.drawCall++,this._firstFreeElement>0&&(t=2*this._firstFreeElement,i.drawArrays(5,0,t),T.trianglesFaces+=t-2,T.drawCall++))},n.addVertexPosition=function(e,t){if(this._owner.activeInHierarchy)if(this._numPositionMode<2)0===this._numPositionMode?(e.cloneTo(this._posModeLastPosition0),t.cloneTo(this._posModeLastPosition1)):(e.cloneTo(this._posModePosition0),t.cloneTo(this._posModePosition1)),this._numPositionMode++;else{var i=this._tempVector2;this._calcVelocity(e,this._posModeLastPosition0,i);var n=this._tempVector3;this._calcVelocity(t,this._posModeLastPosition1,n),this.addVertexPositionVelocity(this._posModePosition0,i,this._posModePosition1,n),this._posModePosition0.cloneTo(this._posModeLastPosition0),this._posModePosition1.cloneTo(this._posModeLastPosition1),e.cloneTo(this._posModePosition0),t.cloneTo(this._posModePosition1)}},n.addVertexPositionVelocity=function(e,t,i,n){if(this._owner.activeInHierarchy){if(0===this._numPositionVelocityMode)this._numPositionVelocityMode++;else{var a=this._tempVector0;At.subtract(e,this._posVelModePosition0,a);var r=At.scalarLength(a);At.subtract(i,this._posVelModePosition1,a);var o=At.scalarLength(a),s=0,h=h;if(r<h&&o<h)return;if(1===(s=1+Math.floor(Math.max(r,o)/this.minInterpDistance)))this._addGlitter(e,i,this._currentTime);else{s=Math.min(s,this.maxSlerpCount),this.scLeft.Init(this._posVelModePosition0,this._posVelModeVelocity0,e,t),this.scRight.Init(this._posVelModePosition1,this._posVelModeVelocity1,i,n);for(var l=1/s,c=l,p=this._currentTime-this._lastTime,u=1;u<=s;u++){var d=this._tempVector0;this.scLeft.Slerp(c,d);var _=this._tempVector1;this.scRight.Slerp(c,_);var m=this._lastTime+p*u/s;this._addGlitter(d,_,m),c+=l}}}this._lastTime=this._currentTime,e.cloneTo(this._posVelModePosition0),t.cloneTo(this._posVelModeVelocity0),i.cloneTo(this._posVelModePosition1),n.cloneTo(this._posVelModeVelocity1)}},n._destroy=function(){e.prototype._destroy.call(this),this._tempVector0=null,this._tempVector1=null,this._tempVector2=null,this._tempVector3=null,this._owner=null,this._vertices=null,this._vertexBuffer.destroy(),this._vertexBuffer=null,this.scLeft=null,this.scRight=null,this._posModeLastPosition0=null,this._posModeLastPosition1=null,this._posModePosition0=null,this._posModePosition1=null,this._posVelModePosition0=null,this._posVelModeVelocity0=null,this._posVelModePosition1=null,this._posVelModeVelocity1=null,this._lastPatchAddPos0=null,this._lastPatchAddPos1=null},n._getVertexBuffers=function(){return null},r(0,n,"maxSegments",function(){return this._maxSegments-1},function(e){var t=e+1;t!==this._maxSegments&&(this._maxSegments=t,this._vertexBuffer&&this._vertexBuffer.destroy(),this._initialize())}),r(0,n,"_vertexBufferCount",function(){return 1}),r(0,n,"triangleCount",function(){var e=0;return this._firstActiveElement<this._firstFreeElement?e=2*(this._firstFreeElement-this._firstActiveElement)-2:(e=2*(this.maxSegments-this._firstActiveElement)-2,e+=2*this._firstFreeElement-2),e}),r(0,n,"_originalBoundingSphere",function(){return i.superGet(ei,this,"_originalBoundingSphere")}),r(0,n,"_originalBoundingBox",function(){return i.superGet(ei,this,"_originalBoundingBox")}),t}(ei),Ai=function(e){function t(e,i,n,a,r,s,h,l){this._owner=null,this._gridSize=NaN,this.memorySize=0,this._numberVertices=0,this._maxNumberIndices=0,this._currentNumberIndices=0,this._numberTriangle=0,this._vertexBuffer=null,this._indexBuffer=null,this._boundingSphere=null,this._boundingBox=null,this._indexArrayBuffer=null,this._boundingBoxCorners=null,this._leafs=null,this._leafNum=0,this._terrainHeightData=null,this._terrainHeightDataWidth=0,this._terrainHeightDataHeight=0,this._chunkOffsetX=0,this._chunkOffsetZ=0,this._cameraCoordinateInverse=!1,this._cameraPos=null,this._currentLOD=0,this._perspectiveFactor=NaN,this._LODTolerance=0,t.__super.call(this),this._owner=e,this._cameraPos=new At,this._chunkOffsetX=i,this._chunkOffsetZ=n,this._gridSize=a,this._terrainHeightData=r,this._terrainHeightDataWidth=s,this._terrainHeightDataHeight=h,this._leafNum=zt.CHUNK_GRID_NUM/zt.LEAF_GRID_NUM*(zt.CHUNK_GRID_NUM/zt.LEAF_GRID_NUM),this._leafs=o(this._leafNum),this._cameraCoordinateInverse=l;for(var c=0;c<this._leafNum;c++)this._leafs[c]=new zt;this.recreateResource()}a(t,"laya.d3.terrain.TerrainFilter",e);var s=t.prototype;return i.imps(s,{"laya.d3.core.render.IRenderable":!0}),s._destroy=function(){e.prototype._destroy.call(this),this._owner=null,this._vertexBuffer&&this._vertexBuffer.destroy(),this._indexBuffer&&this._indexBuffer.destroy()},s.recreateResource=function(){this._currentNumberIndices=0,this._numberTriangle=0;var e=zt.LEAF_VERTEXT_COUNT,t=zt.LEAF_MAX_INDEX_COUNT;this._numberVertices=e*this._leafNum,this._maxNumberIndices=t*this._leafNum,this._indexArrayBuffer=new Uint16Array(this._maxNumberIndices);var i=ut.vertexDeclaration,n=i.vertexStride/4,a=new Float32Array(this._numberVertices*n),r=zt.CHUNK_GRID_NUM/zt.LEAF_GRID_NUM,o=0,s=0,h=0;for(o=0;o<this._leafNum;o++)s=o%r,h=Math.floor(o/r),this._leafs[o].calcVertextBuffer(this._chunkOffsetX,this._chunkOffsetZ,s*zt.LEAF_GRID_NUM,h*zt.LEAF_GRID_NUM,this._gridSize,a,o*zt.LEAF_PLANE_VERTEXT_COUNT,n,this._terrainHeightData,this._terrainHeightDataWidth,this._terrainHeightDataHeight,this._cameraCoordinateInverse);for(o=0;o<this._leafNum;o++)s=o%r,h=Math.floor(o/r),this._leafs[o].calcSkirtVertextBuffer(this._chunkOffsetX,this._chunkOffsetZ,s*zt.LEAF_GRID_NUM,h*zt.LEAF_GRID_NUM,this._gridSize,a,this._leafNum*zt.LEAF_PLANE_VERTEXT_COUNT+o*zt.LEAF_SKIRT_VERTEXT_COUNT,n,this._terrainHeightData,this._terrainHeightDataWidth,this._terrainHeightDataHeight);this.assembleIndexInit(),this._vertexBuffer=new qi(i,this._numberVertices,35044,!1),this._indexBuffer=new Wi("ushort",this._maxNumberIndices,35044,!1),this._vertexBuffer.setData(a),this._indexBuffer.setData(this._indexArrayBuffer),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.calcOriginalBoudingBoxAndSphere()},s.setLODLevel=function(e){if(4!=e.length)return!0;var t=(e[0]+1<<24)+(e[1]+1<<16)+(e[2]+1<<8)+(e[3]+1);return this._currentLOD!=t&&(this._currentLOD=t,!0)},s.assembleIndexInit=function(){this._currentNumberIndices=0,this._numberTriangle=0;for(var e=0,t=0;t<this._leafNum;t++){var i=zt.getPlaneLODIndex(t,0);this._indexArrayBuffer.set(i,e),e+=i.length;var n=zt.getSkirtLODIndex(t,0);this._indexArrayBuffer.set(n,e),e+=n.length,this._currentNumberIndices+=i.length+n.length}this._numberTriangle=this._currentNumberIndices/3},s.isNeedAssemble=function(e,t){var i=Math.min(e.viewport.width,e.viewport.height)/(2*Math.tan(Math.PI*e.fieldOfView/180));return this._perspectiveFactor!=i?(this._perspectiveFactor=i,1):this._LODTolerance!=_n.LOD_TOLERANCE_VALUE?(this._LODTolerance=_n.LOD_TOLERANCE_VALUE,1):0==At.equals(t,this._cameraPos)?(this._cameraPos.x=t.x,this._cameraPos.y=t.y,this._cameraPos.z=t.z,2):0},s.assembleIndex=function(e,i){var n=this.isNeedAssemble(e,i);if(n>0){for(var a=0;a<this._leafNum;a++)t._TEMP_ARRAY_BUFFER[a]=this._leafs[a].determineLod(i,this._perspectiveFactor,_n.LOD_TOLERANCE_VALUE,1==n);if(this.setLODLevel(t._TEMP_ARRAY_BUFFER)){this._currentNumberIndices=0,this._numberTriangle=0;var r=0;for(a=0;a<this._leafNum;a++){var o=t._TEMP_ARRAY_BUFFER[a],s=zt.getPlaneLODIndex(a,o);this._indexArrayBuffer.set(s,r),r+=s.length;var h=zt.getSkirtLODIndex(a,o);this._indexArrayBuffer.set(h,r),r+=h.length,this._currentNumberIndices+=s.length+h.length}return this._numberTriangle=this._currentNumberIndices/3,!0}}return!1},s.calcOriginalBoudingBoxAndSphere=function(){for(var e=new Nt(2147483647,-2147483647),t=0;t<this._leafNum;t++)e.x=this._leafs[t]._sizeOfY.x<e.x?this._leafs[t]._sizeOfY.x:e.x,e.y=this._leafs[t]._sizeOfY.y>e.y?this._leafs[t]._sizeOfY.y:e.y;var i=new At(this._chunkOffsetX*zt.CHUNK_GRID_NUM*this._gridSize,e.x,this._chunkOffsetZ*zt.CHUNK_GRID_NUM*this._gridSize),n=new At((this._chunkOffsetX+1)*zt.CHUNK_GRID_NUM*this._gridSize,e.y,(this._chunkOffsetZ+1)*zt.CHUNK_GRID_NUM*this._gridSize);zt.__ADAPT_MATRIX__&&(At.transformV3ToV3(i,zt.__ADAPT_MATRIX__,i),At.transformV3ToV3(n,zt.__ADAPT_MATRIX__,n)),this._boundingBox=new xt(i,n);var a=new At;At.subtract(n,i,a),At.scale(a,.5,a);var r=new At;At.add(i,a,r),this._boundingSphere=new wt(r,At.scalarLength(a)),this._boundingBoxCorners=o(8,null),this._boundingBox.getCorners(this._boundingBoxCorners)},s.calcLeafBoudingBox=function(e){for(var t=0;t<this._leafNum;t++)this._leafs[t].calcLeafBoudingBox(e)},s.calcLeafBoudingSphere=function(e,t){for(var i=0;i<this._leafNum;i++)this._leafs[i].calcLeafBoudingSphere(e,t)},s._getVertexBuffer=function(e){return void 0===e&&(e=0),0==e?this._vertexBuffer:null},s._getIndexBuffer=function(){return this._indexBuffer},s._beforeRender=function(e){this._vertexBuffer._bind(),this._indexBuffer._bind();if(0==e.renderElement._material.blend){var t=e.camera;this.assembleIndex(t,t.position)&&this._indexBuffer.setData(this._indexArrayBuffer)}return!0},s._getVertexBuffers=function(){return null},s._render=function(e){A.mainContext.drawElements(_n.RENDER_LINE_MODEL?1:4,this._currentNumberIndices,5123,0),T.trianglesFaces+=this._numberTriangle,T.drawCall++},r(0,s,"_originalBoundingSphere",function(){return this._boundingSphere}),r(0,s,"_originalBoundingBox",function(){return this._boundingBox}),r(0,s,"_vertexBufferCount",function(){return this._numberVertices}),r(0,s,"triangleCount",function(){return this._numberTriangle}),n(t,["_TEMP_ARRAY_BUFFER",function(){return this._TEMP_ARRAY_BUFFER=new Uint32Array(zt.CHUNK_GRID_NUM/zt.LEAF_GRID_NUM*zt.CHUNK_GRID_NUM/zt.LEAF_GRID_NUM)}]),t}(ei),Ri=function(e){function t(e){this._terrainSprite3DOwner=null,t.__super.call(this,e),this._terrainSprite3DOwner=e}a(t,"laya.d3.terrain.TerrainRender",e);var i=t.prototype;return i._calculateBoundingSphere=function(){var e=this._terrainSprite3DOwner.terrainFilter;if(null==e)this._boundingSphere.toDefault();else{var t=e._originalBoundingSphere,i=NaN,n=this._terrainSprite3DOwner.transform,a=n.scale;i=a.x>=a.y&&a.x>=a.z?a.x:a.y>=a.z?a.y:a.z,At.transformCoordinate(t.center,n.worldMatrix,this._boundingSphere.center),this._boundingSphere.radius=t.radius*i,e.calcLeafBoudingSphere(n.worldMatrix,i)}},i._calculateBoundingBox=function(){var e=this._terrainSprite3DOwner.terrainFilter;if(null==e)this._boundingBox.toDefault();else{for(var t=this._terrainSprite3DOwner.transform.worldMatrix,i=e._boundingBoxCorners,n=0;n<8;n++)At.transformCoordinate(i[n],t,ti._tempBoundBoxCorners[n]);xt.createfromPoints(ti._tempBoundBoxCorners,this._boundingBox),e.calcLeafBoudingBox(t)}},i._renderUpdate=function(e){this._setShaderValueMatrix4x4(0,this._owner.transform.worldMatrix);var t=this._owner.getProjectionViewWorldMatrix(e);return this._setShaderValueMatrix4x4(1,t),!0},i._destroy=function(){e.prototype._destroy.call(this),this._terrainSprite3DOwner=null},t}(ti),Bi=function(e){function t(){this._time=0,this._enableLightCount=3,this._customRenderQueneIndex=11,this.enableLight=!0,t.__super.call(this),this._renderState=new ue,this._lights=[],this._quenes=[],this._cameraPool=[],this._renderableSprite3Ds=[],this.__loaded=!0,this._lightmaps=[],this._shaderValues=new Ft,this.parallelSplitShadowMaps=[],this._dynamicBatchManager=new we,this._cullingRenders=[],this._cullingRendersLength=0,this.enableFog=!1,this.fogStart=300,this.fogRange=1e3,this.fogColor=new At(.7,.7,.7),this.ambientColor=new At(.212,.227,.259),A.shaderHighPrecision&&this.addShaderDefine(ci.SHADERDEFINE_HIGHPRECISION),this.on("display",this,this._display),this.on("undisplay",this,this._unDisplay),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[]}a(t,"laya.d3.core.scene.Scene",e);var n=t.prototype;return i.imps(n,{"laya.webgl.submit.ISubmit":!0,"laya.resource.ICreateResource":!0}),n._setUrl=function(e){this._url=e},n._getGroup=function(){return this._group},n._setGroup=function(e){this._group=e},n._display=function(){i.stage._scenes.push(this),i.stage._scenes.sort(t._sortScenes);for(var e=0,n=this._childs.length;e<n;e++){var a=this._childs[e];a.active&&a._activeHierarchy()}},n._unDisplay=function(){var e=i.stage._scenes;e.splice(e.indexOf(this),1);for(var t=0,n=this._childs.length;t<n;t++){var a=this._childs[t];a.active&&a._inActiveHierarchy()}},n._addChild3D=function(e){e.transform._onWorldTransform(),e._setBelongScene(this),this.displayedInStage&&e.active&&e._activeHierarchy()},n._removeChild3D=function(e){e.transform.parent=null,this.displayedInStage&&e.active&&e._inActiveHierarchy(),e._setUnBelongScene()},n.initOctree=function(e,t,i,n,a){void 0===a&&(a=6),this.treeSize=new At(e,t,i),this.treeLevel=a,this.treeRoot=new de(this,0),this.treeRoot.init(n,this.treeSize)},n._prepareUpdateToRenderState=function(e,t){t.elapsedTime=this._lastCurrentTime?this.timer.currTimer-this._lastCurrentTime:0,this._lastCurrentTime=this.timer.currTimer,t.scene=this},n._prepareSceneToRender=function(e){var t=this._lights.length;if(t>0)for(var i=0,n=0;n<t&&!(this._lights[n]._prepareToScene(e)&&++i>=this._enableLightCount);n++);},n._updateChilds=function(e){for(var t=0,i=this._childs.length;t<i;++t)this._childs[t]._update(e)},n._preRenderScene=function(e,t,i){var n=t._viewMatrix,a=t._projectionMatrix,r=t._projectionViewMatrix,o=0,s=0,h=t.camera;for(h.useOcclusionCulling?this.treeRoot?Se.renderObjectCullingOctree(i,this,h,n,a,r):Se.renderObjectCulling(i,this,h,n,a,r):Se.renderObjectCullingNoBoundFrustum(this,h,n,a,r),o=0,s=this._quenes.length;o<s;o++)this._quenes[o]&&this._quenes[o]._preRender(t)},n._clear=function(e,t){var i=t._viewport,n=t.camera,a=i.x,r=n.renderTargetSize.height-i.y-i.height,o=i.width,s=i.height;e.viewport(a,r,o,s);var h=256,l=n.renderTarget;switch(n.clearFlag){case 0:var c=n.clearColor;if(c){e.enable(3089),e.scissor(a,r,o,s);var p=c.elements;e.clearColor(p[0],p[1],p[2],p[3]),h|=16384}if(l)switch(c||(h=16384),l.depthStencilFormat){case 33189:h|=256;break;case 36168:h|=1024;break;case 34041:h|=256,h|=1024}e.clear(h),c&&e.disable(3089);break;case 1:case 2:if(l)switch(h=16384,l.depthStencilFormat){case 33189:h|=256;break;case 36168:h|=1024;break;case 34041:h|=256,h|=1024}e.clear(h);break;case 3:break;default:throw new Error("BaseScene:camera clearFlag invalid.")}},n._renderScene=function(e,t){var i,n=t.camera,a=0,r=0;for(a=0;a<2;a++)(i=this._quenes[a])&&(n.renderTarget?i._render(t,!0):i._render(t,!1));if(1===n.clearFlag){var o=n.sky;o&&(R.setCullFace(e,!1),R.setDepthFunc(e,515),R.setDepthMask(e,!1),o._render(t),R.setDepthFunc(e,513),R.setDepthMask(e,!0))}for(a=2,r=this._quenes.length;a<r;a++)(i=this._quenes[a])&&(i._sortAlpha(t.camera.transform.position),n.renderTarget?i._render(t,!0):i._render(t,!1))},n._set3DRenderConfig=function(e){e.disable(3042),R._blend=!1,e.blendFunc(770,771),R._sFactor=770,R._dFactor=771,e.disable(2929),R._depthTest=!1,e.enable(2884),R._cullFace=!0,e.depthMask(1),R._depthMask=!0,e.frontFace(2304),R._frontFace=2304},n._set2DRenderConfig=function(e){R.setBlend(e,!0),R.setBlendFunc(e,1,771),R.setDepthTest(e,!1),R.setCullFace(e,!1),R.setDepthMask(e,!0),R.setFrontFace(e,2305),e.viewport(0,0,I.width,I.height)},n._parseCustomProps=function(e,t,i,n){var a=n.customProps.lightmaps,r=a.length,o=this._lightmaps;o.length=r;for(var s=0;s<r;s++)o[s]=v.getRes(t[a[s].replace(".exr",".png")]);this.setlightmaps(o);var h=n.customProps.ambientColor;h&&(this.ambientColor=new At(h[0],h[1],h[2]));var l=n.customProps.fogColor;l&&(this.fogColor=new At(l[0],l[1],l[2]))},n._addLight=function(e){this._lights.indexOf(e)<0&&this._lights.push(e)},n._removeLight=function(e){var t=this._lights.indexOf(e);t>=0&&this._lights.splice(t,1)},n._updateScene=function(){var e=this._renderState;this._prepareUpdateToRenderState(A.mainContext,e),this._updateComponents(e),this._updateChilds(e),this._lateUpdateComponents(e),this._time+=e.elapsedTime/1e3,this._shaderValues.setValue(22,this._time)},n._updateSceneConch=function(){var e=this._renderState;this._prepareUpdateToRenderState(A.mainContext,e),this._updateComponents(e),this._lateUpdateComponents(e),this._prepareSceneToRender(e);for(var t=0,i=this._cameraPool.length;t<i;t++){var n=this._cameraPool[t];e.camera=n,n._prepareCameraToRender()}},n._preRenderShadow=function(e,t,i,n,a){this.treeRoot?Se.renderShadowObjectCullingOctree(this,t,i,n,a):Se.renderShadowObjectCulling(this,t,i,n,a);for(var r=0,o=i.length;r<o;r++)i[r]&&i[r]._preRender(e)},n._renderShadowMap=function(e,t,i){var n=this.parallelSplitShadowMaps[0];n._calcAllLightCameraInfo(i);var a=n.PSSMNum;this._preRenderShadow(t,n._lightCulling,n._shadowQuenes,n._lightVPMatrix[0],a),this.addShaderDefine(Ht.SHADERDEFINE_CAST_SHADOW);var r,o,s;if(a>1)for(var h=0;h<a;h++)r=n.getRenderTarget(h+1),n.beginRenderTarget(h+1),e.clearColor(1,1,1,1),e.clear(16640),e.viewport(0,0,r.width,r.height),t.camera=s=n.getLightCamera(h),s._prepareCameraToRender(),s._prepareCameraViewProject(s.viewMatrix,s.projectionMatrix),t._projectionViewMatrix=n._lightVPMatrix[h+1],(o=n._shadowQuenes[h])._preRender(t),o._renderShadow(t,!1),n.endRenderTarget(h+1);else r=n.getRenderTarget(1),n.beginRenderTarget(1),e.clearColor(1,1,1,1),e.clear(16640),e.viewport(0,0,r.width,r.height),t.camera=s=n.getLightCamera(0),s._prepareCameraToRender(),s._prepareCameraViewProject(s.viewMatrix,s.projectionMatrix),t._projectionViewMatrix=n._lightVPMatrix[0],(o=n._shadowQuenes[0])._preRender(t),o._renderShadow(t,!0),n.endRenderTarget(1);this.removeShaderDefine(Ht.SHADERDEFINE_CAST_SHADOW)},n.addTreeNode=function(e){this.treeRoot.addTreeNode(e)},n.removeTreeNode=function(e){this.treeSize&&e._treeNode&&e._treeNode.removeObject(e)},n.setlightmaps=function(e){this._lightmaps=e;for(var t=0,i=this._renderableSprite3Ds.length;t<i;t++)this._renderableSprite3Ds[t]._render._applyLightMapParams()},n.getlightmaps=function(){return this._lightmaps},n.addChildAt=function(e,t){if(!(e instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!e||this.destroyed||e===this)return e;if(e.zOrder&&this._set$P("hasZorder",!0),t>=0&&t<=this._childs.length){if(e._parent===this){var i=this.getChildIndex(e);this._childs.splice(i,1),this._childs.splice(t,0,e),this.conchModel&&(this.conchModel.removeChild(e.conchModel),this.conchModel.addChildAt(e.conchModel,t)),this._childChanged()}else e.parent&&e.parent.removeChild(e),this._childs===w.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(t,0,e),this.conchModel&&this.conchModel.addChildAt(e.conchModel,t),e.parent=this,this._addChild3D(e);return e}throw new Error("appendChildAt:The index is out of bounds")},n.addChild=function(e){if(!(e instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!e||this.destroyed||e===this)return e;if(e.zOrder&&this._set$P("hasZorder",!0),e._parent===this){var t=this.getChildIndex(e);t!==this._childs.length-1&&(this._childs.splice(t,1),this._childs.push(e),this.conchModel&&(this.conchModel.removeChild(e.conchModel),this.conchModel.addChildAt(e.conchModel,this._childs.length-1)),this._childChanged())}else e.parent&&e.parent.removeChild(e),this._childs===w.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(e),this.conchModel&&this.conchModel.addChildAt(e.conchModel,this._childs.length-1),e.parent=this,this._childChanged(),this._addChild3D(e);return e},n.removeChildAt=function(e){var t=this.getChildAt(e);return t&&(this._removeChild3D(t),this._childs.splice(e,1),this.conchModel&&this.conchModel.removeChild(t.conchModel),t.parent=null),t},n.removeChildren=function(e,t){if(void 0===e&&(e=0),void 0===t&&(t=2147483647),this._childs&&this._childs.length>0){var i=this._childs;if(0===e&&t>=r){var n=i;this._childs=w.ARRAY_EMPTY}else n=i.splice(e,t-e);for(var a=0,r=n.length;a<r;a++)this._removeChild3D(n[a]),n[a].parent=null,this.conchModel&&this.conchModel.removeChild(n[a].conchModel)}return this},n.addFrustumCullingObject=function(e){this.treeRoot?this.addTreeNode(e):(this._cullingRendersLength===this._cullingRenders.length?this._cullingRenders.push(e):this._cullingRenders[this._cullingRendersLength]=e,e._indexInSceneFrustumCullingObjects=this._cullingRendersLength++)},n.removeFrustumCullingObject=function(e){if(this.treeRoot)this.removeTreeNode(e);else{this._cullingRendersLength--;var t=e._indexInSceneFrustumCullingObjects;if(t!==this._cullingRendersLength){var i=this._cullingRenders[this._cullingRendersLength];this._cullingRenders[t]=i,i._indexInSceneFrustumCullingObjects=t,e._indexInSceneFrustumCullingObjects=-1}}},n.getRenderQueue=function(e){return e<3e3?this._quenes[1]||(this._quenes[1]=new pe(this)):this._quenes[2]||(this._quenes[2]=new pe(this))},n.addRenderQuene=function(){this._quenes[this._customRenderQueneIndex++]=new pe(this)},n.addShaderDefine=function(e){this._shaderDefineValue|=e},n.removeShaderDefine=function(e){this._shaderDefineValue&=~e},n.addScript=function(e){return this._addComponent(e)},n.getScriptByType=function(e,t){return void 0===t&&(t=0),this._getComponentByType(e,t)},n.getScriptsByType=function(e,t){this._getComponentsByType(e,t)},n.getScriptByIndex=function(e){return this._getComponentByIndex(e)},n.removeScriptByType=function(e,t){void 0===t&&(t=0),this._removeComponentByType(e,t)},n.removeScriptsByType=function(e){this._removeComponentByType(e)},n.removeAllScript=function(){this._removeAllComponent()},n.render=function(e,t,i){S._context.ctx._renderKey=0,this._childs.length>0&&e.addRenderObject(this)},n.renderSubmit=function(){var e=A.mainContext,t=this._renderState;this._set3DRenderConfig(e),this._prepareSceneToRender(this._renderState);var i,n=0,a=0;if(Zt.debugMode||de.debugMode)for(n=0,a=this._cameraPool.length;n<a;n++)i=this._cameraPool[n],Zt._debugPhasorSprite.begin(1,i),i.activeInHierarchy&&i._renderCamera(e,t,this),Zt._debugPhasorSprite.end();else for(n=0,a=this._cameraPool.length;n<a;n++)(i=this._cameraPool[n]).activeInHierarchy&&i._renderCamera(e,t,this);return this._set2DRenderConfig(e),1},n.onAsynLoaded=function(e,t,i){var n=t[0];if("Scene"!==n.type)throw new Error("Scene: the .lh file root type must be Scene,please use other function to  load  this file.");var a=t[1];Jt._createNodeByJson(this,n,this,a),this.event("hierarchyloaded",[this]),this.__loaded=!0},n.destroy=function(t){void 0===t&&(t=!0),this.destroyed||(e.prototype.destroy.call(this,t),this._renderState=null,this._lights=null,this._lightmaps=null,this._renderTargetTexture=null,this._shaderValues=null,this._cullingRenders=null,this._dynamicBatchManager=null,this._quenes=null,this._cameraPool=null,this._renderableSprite3Ds=null,this.treeRoot=null,this.treeSize=null,this.parallelSplitShadowMaps=null,this._typeComponentsIndices=null,this._components=null,v.clearRes(this.url),this.loaded||Zt._cancelLoadByUrl(this.url))},n.getRenderType=function(){return 0},n.releaseRender=function(){},n._addComponent=function(e){var t,i=this._componentsMap.indexOf(e);if(-1===i)t=[],this._componentsMap.push(e),this._typeComponentsIndices.push(t);else if(t=this._typeComponentsIndices[i],this._components[t[0]].isSingleton)throw new Error("无法单实例创建"+e+"组件，"+e+"组件已存在！");var n=m.getInstance(e);t.push(this._components.length),this._components.push(n);return n._initialize(this),n},n._removeComponent=function(e,t){var i=this._typeComponentsIndices[e],n=i[t],a=this._components[n];this._components.splice(n,1),i.splice(t,1),0===i.length&&(this._typeComponentsIndices.splice(e,1),this._componentsMap.splice(e,1));for(var r=0,o=this._componentsMap.length;r<o;r++)for(var s=(i=this._typeComponentsIndices[r]).length-1;s>=0;s--){var h=i[s];if(!(h>n))break;i[s]=--h}a._destroy()},n._getComponentByType=function(e,t){void 0===t&&(t=0);var i=this._componentsMap.indexOf(e);return-1===i?null:this._components[this._typeComponentsIndices[i][t]]},n._getComponentsByType=function(e,t){var i=this._componentsMap.indexOf(e);if(-1!==i){var n=this._typeComponentsIndices[i],a=n.length;t.length=a;for(var r=0;r<a;r++)t[r]=this._components[n[r]]}else t.length=0},n._getComponentByIndex=function(e){return this._components[e]},n._removeComponentByType=function(e,t){void 0===t&&(t=0);var i=this._componentsMap.indexOf(e);-1!==i&&this._removeComponent(i,t)},n._removeComponentsByType=function(e){var t=this._componentsMap.indexOf(e);if(-1!==t)for(var i=this._typeComponentsIndices[t],n=0,a=i.length;n<a;i.length<a?a--:n++)this._removeComponent(t,n)},n._removeAllComponent=function(){for(var e=0,t=this._componentsMap.length;e<t;this._componentsMap.length<t?t--:e++)this._removeComponentsByType(this._componentsMap[e])},n._updateComponents=function(e){for(var t=0,i=this._components.length;t<i;t++){var n=this._components[t];!n.started&&(n._start(e),n.started=!0),n.enable&&n._update(e)}},n._lateUpdateComponents=function(e){for(var t=0;t<this._components.length;t++){var i=this._components[t];!i.started&&(i._start(e),i.started=!0),i.enable&&i._lateUpdate(e)}},n._preRenderUpdateComponents=function(e){for(var t=0;t<this._components.length;t++){var i=this._components[t];!i.started&&(i._start(e),i.started=!0),i.enable&&i._preRenderUpdate(e)}},n._postRenderUpdateComponents=function(e){for(var t=0;t<this._components.length;t++){var i=this._components[t];!i.started&&(i._start(e),i.started=!0),i.enable&&i._postRenderUpdate(e)}},r(0,n,"_loaded",null,function(e){this.__loaded=e}),r(0,n,"fogColor",function(){return this._fogColor},function(e){this._fogColor=e,this._shaderValues.setValue(0,e.elements)}),r(0,n,"enableFog",function(){return this._enableFog},function(e){this._enableFog!==e&&(this._enableFog=e,e?(this.addShaderDefine(ci.SHADERDEFINE_FOG),this.removeShaderDefine(ci.SAHDERDEFINE_DEPTHFOG)):this.removeShaderDefine(ci.SHADERDEFINE_FOG))}),r(0,n,"url",function(){return this._url}),r(0,n,"loaded",function(){return this.__loaded}),r(0,n,"enableDepthFog",function(){return this._enableDepthFog},function(e){this._enableDepthFog!=e&&(this._enableDepthFog=e,e?(this.addShaderDefine(ci.SAHDERDEFINE_DEPTHFOG),this.removeShaderDefine(ci.SHADERDEFINE_FOG)):this.removeShaderDefine(ci.SAHDERDEFINE_DEPTHFOG))}),r(0,n,"fogStart",function(){return this._fogStart},function(e){this._fogStart=e,this._shaderValues.setValue(1,e)}),r(0,n,"fogRange",function(){return this._fogRange},function(e){this._fogRange=e,this._shaderValues.setValue(2,e)}),r(0,n,"ambientColor",function(){return this._ambientColor},function(e){this._ambientColor=e,this._shaderValues.setValue(21,e.elements)}),r(0,n,"scene",function(){return this}),r(0,n,"renderableSprite3Ds",function(){return this._renderableSprite3Ds.slice()}),t._sortScenes=function(e,n){if(e.parent===i.stage&&n.parent===i.stage){var a=i.stage._childs;return a.indexOf(e)-a.indexOf(n)}return e.parent!==i.stage&&n.parent!==i.stage?t._sortScenes(e.parent,n.parent):e.parent===i.stage?-1:1},t.load=function(e){return i.loader.create(e,null,null,t)},t.FOGCOLOR=0,t.FOGSTART=1,t.FOGRANGE=2,t.LIGHTDIRECTION=3,t.LIGHTDIRCOLOR=4,t.POINTLIGHTPOS=5,t.POINTLIGHTRANGE=6,t.POINTLIGHTATTENUATION=7,t.POINTLIGHTCOLOR=8,t.SPOTLIGHTPOS=9,t.SPOTLIGHTDIRECTION=10,t.SPOTLIGHTSPOT=11,t.SPOTLIGHTRANGE=12,t.SPOTLIGHTATTENUATION=13,t.SPOTLIGHTCOLOR=14,t.SHADOWDISTANCE=15,t.SHADOWLIGHTVIEWPROJECT=16,t.SHADOWMAPPCFOFFSET=17,t.SHADOWMAPTEXTURE1=18,t.SHADOWMAPTEXTURE2=19,t.SHADOWMAPTEXTURE3=20,t.AMBIENTCOLOR=21,t.TIME=22,t}(E),Pi=function(e){function t(e){t.__super.call(this),this.__loaded=!0,this._projectionViewWorldUpdateLoopCount=-1,this._activeInHierarchy=!1,this._projectionViewWorldMatrix=new Ct,this._shaderValues=new Ft,this._colliders=[],this._id=++t._uniqueIDCounter,this._transform=new ii(this),this.name=e||"Sprite3D-"+t._nameNumberCounter++,this.layer=X.currentCreationLayer,this.active=!0}a(t,"laya.d3.core.Sprite3D",di);var n=t.prototype;return i.imps(n,{"laya.d3.core.render.IUpdate":!0,"laya.resource.ICreateResource":!0,"laya.d3.core.IClone":!0}),n._setUrl=function(e){this._url=e},n._getGroup=function(){return this._group},n._setGroup=function(e){this._group=e},n._addChild3D=function(e){e.transform.parent=this.transform,this._hierarchyAnimator&&(!e._hierarchyAnimator&&e._setHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(e,!0,[e.name])),this._scene&&(e._setBelongScene(this._scene),this._activeInHierarchy&&e._active&&e._activeHierarchy())},n._removeChild3D=function(e){e.transform.parent=null,this._scene&&(this._activeInHierarchy&&e._active&&e._inActiveHierarchy(),e._setUnBelongScene()),this._hierarchyAnimator&&(e._hierarchyAnimator==this._hierarchyAnimator&&e._clearHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(e,!1,[e.name]))},n._parseBaseCustomProps=function(e){var t=this.transform.localPosition;t.fromArray(e.translate),this.transform.localPosition=t;var i=this.transform.localRotation;i.fromArray(e.rotation),this.transform.localRotation=i;var n=this.transform.localScale;n.fromArray(e.scale),this.transform.localScale=n;var a=e.layer;null!=a&&(this.layer=X.getLayerByNumber(a))},n._parseCustomComponent=function(e,t,i){for(var n in i){var a=i[n];switch(n){case"Animator":var r=this.addComponent(wi);if(a.avatarPath)r.avatar=v.getRes(t[a.avatarPath]);else{var o=a.avatar;if(o){r.avatar=v.getRes(t[o.path]);var s=o.linkSprites;s&&e.once("hierarchyloaded",this,this._onRootNodeHierarchyLoaded,[r,s])}}for(var h=a.clipPaths,l=h.length,c=0;c<l;c++)r.addClip(v.getRes(t[h[c]]));r.clip=v.getRes(t[h[0]]);var p=a.playOnWake;void 0!==p&&(r.playOnWake=p);break;case"Rigidbody":this.addComponent(Ii);break;case"SphereCollider":var u=this.addComponent(en);u.isTrigger=a.isTrigger;var d=u.center;d.fromArray(a.center),u.center=d,u.radius=a.radius;break;case"BoxCollider":var _=this.addComponent(Qi);_.isTrigger=a.isTrigger,_.center.fromArray(a.center);var m=_.size;m.fromArray(a.size),_.size=m;break;case"MeshCollider":this.addComponent($i)}}},n._onRootNodeHierarchyLoaded=function(e,t){for(var i in t){for(var n=this,a=t[i],r=0,o=a.length;r<o;r++){var s=a[r];if(""===s)break;if(!(n=n.getChildByName(s)))break}n&&e.linkSprite3DToAvatarNode(i,n)}},n._setHierarchyAnimator=function(e,t){this._changeHierarchyAnimator(e);for(var i=0,n=this._childs.length;i<n;i++){var a=this._childs[i];a._hierarchyAnimator==t&&a._setHierarchyAnimator(e,t)}},n._clearHierarchyAnimator=function(e,t){this._changeHierarchyAnimator(t);for(var i=0,n=this._childs.length;i<n;i++){var a=this._childs[i];a._hierarchyAnimator==e&&a._clearHierarchyAnimator(e,t)}},n._getAnimatorToLinkSprite3D=function(e,t,i){var n=this.getComponentByType(wi);if(n&&(n.avatar?n.avatar._version||e._setAnimatorToLinkAvatar(n,t):e._setAnimatorToLinkSprite3DNoAvatar(n,t,i)),this._parent&&this._parent instanceof laya.d3.core.Sprite3D){i.unshift(this._parent.name);var a=this._parent;a._hierarchyAnimator&&a._getAnimatorToLinkSprite3D(e,t,i)}},n._setAnimatorToLinkSprite3DNoAvatar=function(e,t,i){var n=0,a=0;for(n=0,a=e.getClipCount();n<a;n++)e._handleSpriteOwnersBySprite(n,t,i,this);for(n=0,a=this._childs.length;n<a;n++){var r=this._childs[n],o=i.length;i.push(r.name),r._setAnimatorToLinkSprite3DNoAvatar(e,t,i),i.splice(o,1)}},n._changeHierarchyAnimator=function(e){this._hierarchyAnimator=e},n._isLinkSpriteToAnimationNode=function(e,t,i){var n=e._avatarNodes.indexOf(t),a=e._cacheSpriteToNodesMap;if(i)this._transform.dummy=t.transform,e._cacheNodesToSpriteMap[n]=a.length,a.push(n);else{this._transform.dummy=null;var r=e._cacheNodesToSpriteMap[n];e._cacheNodesToSpriteMap[n]=null,a.splice(r,1)}},n._setBelongScene=function(e){this._scene=e;for(var t=0,i=this._childs.length;t<i;t++)this._childs[t]._setBelongScene(e)},n._setUnBelongScene=function(){this._scene=null;for(var e=0,t=this._childs.length;e<t;e++)this._childs[e]._setUnBelongScene()},n._activeHierarchy=function(){var e=0,t=0;for(this._activeInHierarchy=!0,this._addSelfRenderObjects(),e=0,t=this._colliders.length;e<t;e++)this._layer._addCollider(this._colliders[e]);for(this.event("activeinhierarchychanged",!0),e=0,t=this._childs.length;e<t;e++){var i=this._childs[e];i._active&&i._activeHierarchy()}},n._inActiveHierarchy=function(){var e=0,t=0;for(this._activeInHierarchy=!1,this._clearSelfRenderObjects(),e=0,t=this._colliders.length;e<t;e++){var i=this._colliders[e];i._clearCollsionMap(),this._layer._removeCollider(i)}for(this.event("activeinhierarchychanged",!1),e=0,t=this._childs.length;e<t;e++){var n=this._childs[e];n._active&&n._inActiveHierarchy()}},n.addComponent=function(e){var t,i=this._componentsMap.indexOf(e);if(-1===i)t=[],this._componentsMap.push(e),this._typeComponentsIndices.push(t);else if(t=this._typeComponentsIndices[i],this._components[t[0]].isSingleton)throw new Error("无法单实例创建"+e+"组件，"+e+"组件已存在！");var n=m.getInstance(e);if(t.push(this._components.length),this._components.push(n),n instanceof laya.d3.component.physics.Collider){this.getComponentByType(Ii)&&(n._isRigidbody=!0),this._activeInHierarchy&&this._layer._addCollider(n),this._colliders.push(n)}else if(n instanceof laya.d3.component.Animator){var a=n;this._setHierarchyAnimator(a,this._parent?this._parent._hierarchyAnimator:null),this._setAnimatorToLinkSprite3DNoAvatar(a,!0,[])}else if(n instanceof laya.d3.component.Rigidbody)for(var r=0,o=this._colliders.length;r<o;r++)this._colliders[r]._setIsRigidbody(!0);return n instanceof laya.d3.component.Script&&this._scripts.push(n),n._initialize(this),n},n._removeComponent=function(e,t){var i=0,n=0,a=this._typeComponentsIndices[e],r=a[t],o=this._components[r];if(o instanceof laya.d3.component.physics.Collider){var s=o;this._activeInHierarchy&&this._layer._removeCollider(s),this._colliders.splice(this._colliders.indexOf(s),1)}else if(o instanceof laya.d3.component.Animator){var h=o;this._clearHierarchyAnimator(h,this._parent?this._parent._hierarchyAnimator:null)}else if(o instanceof laya.d3.component.Rigidbody)for(i=0,n=this._colliders.length;i<n;i++){var l=this._colliders[i];l._setIsRigidbody(!1);var c=l._runtimeCollisonMap,p=l._runtimeCollisonTestMap;for(var u in c)delete p[u]}for(this._components.splice(r,1),o instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(o),1),a.splice(t,1),0===a.length&&(this._typeComponentsIndices.splice(e,1),this._componentsMap.splice(e,1)),i=0,n=this._componentsMap.length;i<n;i++)for(var d=(a=this._typeComponentsIndices[i]).length-1;d>=0;d--){var _=a[d];if(!(_>r))break;a[d]=--_}o._destroy()},n._clearSelfRenderObjects=function(){},n._addSelfRenderObjects=function(){},n._parseCustomProps=function(e,t,i,n){},n._updateChilds=function(e){var t=this._childs.length;if(0!==t)for(var i=0;i<t;++i)this._childs[i]._update(e)},n._getSortID=function(e,t){return 1e3*t.id+e._getVertexBuffer().vertexDeclaration.id},n._update=function(e){e.owner=this,this._activeInHierarchy&&(this._updateComponents(e),this._lateUpdateComponents(e),T.spriteCount++,this._childs.length&&this._updateChilds(e))},n.getProjectionViewWorldMatrix=function(e){return Ct.multiply(e,this.transform.worldMatrix,this._projectionViewWorldMatrix),this._projectionViewWorldMatrix},n.loadHierarchy=function(e){this.addChild(laya.d3.core.Sprite3D.load(e))},n.addChildAt=function(e,t){if(!(e instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!e||this.destroyed||e===this)return e;if(e.zOrder&&this._set$P("hasZorder",!0),t>=0&&t<=this._childs.length){if(e._parent===this){var i=this.getChildIndex(e);this._childs.splice(i,1),this._childs.splice(t,0,e),this.conchModel&&(this.conchModel.removeChild(e.conchModel),this.conchModel.addChildAt(e.conchModel,t)),this._childChanged()}else e.parent&&e.parent.removeChild(e),this._childs===w.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(t,0,e),this.conchModel&&this.conchModel.addChildAt(e.conchModel,t),e.parent=this,this._addChild3D(e);return e}throw new Error("appendChildAt:The index is out of bounds")},n.addChild=function(e){if(!(e instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!e||this.destroyed||e===this)return e;if(e.zOrder&&this._set$P("hasZorder",!0),e._parent===this){var t=this.getChildIndex(e);t!==this._childs.length-1&&(this._childs.splice(t,1),this._childs.push(e),this.conchModel&&(this.conchModel.removeChild(e.conchModel),this.conchModel.addChildAt(e.conchModel,this._childs.length-1)),this._childChanged())}else e.parent&&e.parent.removeChild(e),this._childs===w.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(e),this.conchModel&&this.conchModel.addChildAt(e.conchModel,this._childs.length-1),e.parent=this,this._childChanged(),this._addChild3D(e);return e},n.removeChildAt=function(e){var t=this.getChildAt(e);return t&&(this._removeChild3D(t),this._childs.splice(e,1),this.conchModel&&this.conchModel.removeChild(t.conchModel),t.parent=null),t},n.removeChildren=function(e,t){if(void 0===e&&(e=0),void 0===t&&(t=2147483647),this._childs&&this._childs.length>0){var i=this._childs;if(0===e&&t>=r){var n=i;this._childs=w.ARRAY_EMPTY}else n=i.splice(e,t-e);for(var a=0,r=n.length;a<r;a++)this._removeChild3D(n[a]),n[a].parent=null,this.conchModel&&this.conchModel.removeChild(n[a].conchModel)}return this},n.onAsynLoaded=function(e,t,i){var n=t[0];if("Sprite3D"!==n.type)throw new Error("Sprite3D: The .lh file root type must be Sprite3D,please use other function to  load  this file.");var a=t[1];Jt._createNodeByJson(this,n,this,a),this.event("hierarchyloaded",[this]),this.__loaded=!0},n.cloneTo=function(e){if(this.destroyed)throw new Error("Sprite3D: Can't be cloned if the Sprite3D has destroyed.");var t=e;t.name=this.name,t._destroyed=this._destroyed,t.timer=this.timer,t._$P=this._$P,t.active=this._active;var i=t.transform.localPosition;this.transform.localPosition.cloneTo(i),t.transform.localPosition=i;var n=t.transform.localRotation;this.transform.localRotation.cloneTo(n),t.transform.localRotation=n;var a=t.transform.localScale;this.transform.localScale.cloneTo(a),t.transform.localScale=a,t.isStatic=this.isStatic;var r=0,o=0;for(r=0,o=this._componentsMap.length;r<o;r++){var s=t.addComponent(this._componentsMap[r]);this._components[r]._cloneTo(s)}for(r=0,o=this._childs.length;r<o;r++)t.addChild(this._childs[r].clone());var h=t.getComponentByType(wi);if(h){var l=h._linkSpritesData;if(l)for(var c in l){for(var p=l[c],u=t,d=0,_=p.length;d<_&&(u=u.getChildByName(p[d]));d++);if(u){var m=h._avatarNodeMap[c];u._isLinkSpriteToAnimationNode(h,m,!0)}}}},n.clone=function(){var e=new this.constructor;return this.cloneTo(e),e},n.destroy=function(e){if(void 0===e&&(e=!0),!this.destroyed){laya.display.Node.prototype.destroy.call(this,e);var t=0,i=0;for(t=0,i=this._components.length;t<i;t++)this._components[t]._destroy();this._components=null,this._componentsMap=null,this._typeComponentsIndices=null,this._transform=null,this._colliders=null,v.clearRes(this.url),this.loaded||Zt._cancelLoadByUrl(this.url)}},n._handleSpriteToAvatar=function(e,t){e._avatarNodes;var i=e._avatarNodeMap[this.name];i&&i.name===this.name&&!this._transform.dummy&&this._isLinkSpriteToAnimationNode(e,i,t)},n._setAnimatorToLinkAvatar=function(e,t){this._handleSpriteToAvatar(e,t);for(var i=0,n=this._childs.length;i<n;i++){this._childs[i]._setAnimatorToLinkAvatar(e,t)}},r(0,n,"activeInHierarchy",function(){return this._activeInHierarchy}),r(0,n,"_loaded",null,function(e){this.__loaded=e}),r(0,n,"active",function(){return this._active},function(e){this._active!==e&&(this._active=e,this._parent&&(this._parent===this._scene&&this._parent.displayedInStage||this._parent._activeInHierarchy)&&(e?this._activeHierarchy():this._inActiveHierarchy()))}),r(0,n,"componentsCount",function(){return this._components.length}),r(0,n,"loaded",function(){return this.__loaded}),r(0,n,"id",function(){return this._id}),r(0,n,"url",function(){return this._url}),r(0,n,"layer",function(){return this._layer},function(e){if(this._layer!==e){if(!e)throw new Error("Layer value can be null.");if(this._activeInHierarchy){var t=0,i=this._colliders.length;if(this._layer)for(t=0;t<i;t++)this._layer._removeCollider(this._colliders[t]);for(t=0;t<i;t++)e._addCollider(this._colliders[t])}this._layer=e,this.event("layerchanged",e)}}),r(0,n,"scene",function(){return this._scene}),r(0,n,"transform",function(){return this._transform}),t.instantiate=function(e,t,i,n,a){void 0===i&&(i=!0);var r=e.clone();t&&t.addChild(r);var o=r.transform;if(i){var s=o.worldMatrix;e.transform.worldMatrix.cloneTo(s),o.worldMatrix=s}else n&&(o.position=n),a&&(o.rotation=a);return r},t.load=function(e){return i.loader.create(e,null,null,t)},t.WORLDMATRIX=0,t.MVPMATRIX=1,t._uniqueIDCounter=0,t._nameNumberCounter=0,t}(),Oi=function(e){function t(e,i,n,a,r,o,s,h){if(this._curActTexIndex=0,this._program=null,this._attributeParams=null,this._uniformParams=null,this._attributeParamsMap=[],this._sceneUniformParamsMap=[],this._cameraUniformParamsMap=[],this._spriteUniformParamsMap=[],this._materialUniformParamsMap=[],this._renderElementUniformParamsMap=[],t.__super.call(this),!e||!i)throw"Shader Error";this._id=++t._count,this._vs=e,this._ps=i,this._attributeMap=n,this._sceneUniformMap=a,this._cameraUniformMap=r,this._spriteUniformMap=o,this._materialUniformMap=s,this._renderElementUniformMap=h,this.recreateResource()}a(t,"laya.d3.shader.Shader3D",p);var i=t.prototype;return i.recreateResource=function(){this._compile(),this.completeCreate(),this.memorySize=0},i.disposeResource=function(){A.mainContext.deleteShader(this._vshader),A.mainContext.deleteShader(this._pshader),A.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._attributeParams=null,this._uniformParams=null,this.memorySize=0,this._curActTexIndex=0},i._compile=function(){if(this._vs&&this._ps&&!this._attributeParams&&!this._uniformParams){this._reCompile=!0,this._attributeParams=[],this._uniformParams=[];var e=[this._vs,this._ps],i=A.mainContext;if(this._program=i.createProgram(),this._vshader=t._createShader(i,e[0],35633),this._pshader=t._createShader(i,e[1],35632),i.attachShader(this._program,this._vshader),i.attachShader(this._program,this._pshader),i.linkProgram(this._program),!S.isConchApp&&ci.debugMode&&!i.getProgramParameter(this._program,35714))throw i.getProgramInfoLog(this._program);var n,a=0,r=0,o=0;for(o=S.isConchApp?i.getProgramParameterEx(this._vs,this._ps,"",35721):i.getProgramParameter(this._program,35721),a=0;a<o;a++){var s=null;n={vartype:"attribute",ivartype:0,attrib:s=S.isConchApp?i.getActiveAttribEx(this._vs,this._ps,"",a):i.getActiveAttrib(this._program,a),location:i.getAttribLocation(this._program,s.name),name:s.name,type:s.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._attributeParams.push(n)}var h=0;for(h=S.isConchApp?i.getProgramParameterEx(this._vs,this._ps,"",35718):i.getProgramParameter(this._program,35718),a=0;a<h;a++){var l=null;l=S.isConchApp?i.getActiveUniformEx(this._vs,this._ps,"",a):i.getActiveUniform(this._program,a),(n={vartype:"uniform",ivartype:1,attrib:s,location:i.getUniformLocation(this._program,l.name),name:l.name,type:l.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")>0&&(n.name=n.name.substr(0,n.name.length-3),n.isArray=!0,n.location=i.getUniformLocation(this._program,n.name)),this._uniformParams.push(n)}for(a=0,r=this._attributeParams.length;a<r;a++)(n=this._attributeParams[a]).indexOfParams=a,n.index=1,n.value=[n.location,null],n.codename=n.name,n.name=null!=this._attributeMap[n.codename]?this._attributeMap[n.codename]:n.codename,this._attributeParamsMap.push(n.name),this._attributeParamsMap.push(n),n._this=this,n.uploadedValue=[],n.fun=this._attribute;for(a=0,r=this._uniformParams.length;a<r;a++)switch(n=this._uniformParams[a],n.indexOfParams=a,n.index=1,n.value=[n.location,null],n.codename=n.name,null!=this._sceneUniformMap[n.codename]?(n.name=this._sceneUniformMap[n.codename],this._sceneUniformParamsMap.push(n.name),this._sceneUniformParamsMap.push(n)):null!=this._cameraUniformMap[n.codename]?(n.name=this._cameraUniformMap[n.codename],this._cameraUniformParamsMap.push(n.name),this._cameraUniformParamsMap.push(n)):null!=this._spriteUniformMap[n.codename]?(n.name=this._spriteUniformMap[n.codename],this._spriteUniformParamsMap.push(n.name),this._spriteUniformParamsMap.push(n)):null!=this._materialUniformMap[n.codename]?(n.name=this._materialUniformMap[n.codename],this._materialUniformParamsMap.push(n.name),this._materialUniformParamsMap.push(n)):null!=this._renderElementUniformMap[n.codename]?(n.name=this._renderElementUniformMap[n.codename],this._renderElementUniformParamsMap.push(n.name),this._renderElementUniformParamsMap.push(n)):console.log("Shader:can't find uinform name:"+n.codename+" in shader file."),n._this=this,n.uploadedValue=[],n.type){case 5124:n.fun=n.isArray?this._uniform1iv:this._uniform1i;break;case 5126:n.fun=n.isArray?this._uniform1fv:this._uniform1f;break;case 35664:n.fun=n.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:n.fun=n.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:n.fun=n.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:n.fun=this._uniform_sampler2D;break;case 35680:n.fun=this._uniform_samplerCube;break;case 35676:n.fun=this._uniformMatrix4fv;break;case 35670:n.fun=this._uniform1i;break;case 35674:n.fun=this._uinformMatrix2fv;break;case 35675:n.fun=this._uinformMatrix3fv;break;default:throw new Error("compile shader err!")}}},i._attribute=function(e,t){var i=A.mainContext,n=d._enableAtributes,a=e.location;return n[a]||i.enableVertexAttribArray(a),i.vertexAttribPointer(a,t[0],t[1],t[2],t[3],t[4]),n[a]=d._bindVertexBuffer,1},i._uniform1f=function(e,t){var i=e.uploadedValue;return i[0]!==t?(A.mainContext.uniform1f(e.location,i[0]=t),1):0},i._uniform1fv=function(e,t){if(t.length<4){var i=e.uploadedValue;return i[0]!==t[0]||i[1]!==t[1]||i[2]!==t[2]||i[3]!==t[3]?(A.mainContext.uniform1fv(e.location,t),i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],1):0}return A.mainContext.uniform1fv(e.location,t),1},i._uniform_vec2=function(e,t){var i=e.uploadedValue;return i[0]!==t[0]||i[1]!==t[1]?(A.mainContext.uniform2f(e.location,i[0]=t[0],i[1]=t[1]),1):0},i._uniform_vec2v=function(e,t){if(t.length<2){var i=e.uploadedValue;return i[0]!==t[0]||i[1]!==t[1]||i[2]!==t[2]||i[3]!==t[3]?(A.mainContext.uniform2fv(e.location,t),i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],1):0}return A.mainContext.uniform2fv(e.location,t),1},i._uniform_vec3=function(e,t){var i=e.uploadedValue;return i[0]!==t[0]||i[1]!==t[1]||i[2]!==t[2]?(A.mainContext.uniform3f(e.location,i[0]=t[0],i[1]=t[1],i[2]=t[2]),1):0},i._uniform_vec3v=function(e,t){return A.mainContext.uniform3fv(e.location,t),1},i._uniform_vec4=function(e,t){var i=e.uploadedValue;return i[0]!==t[0]||i[1]!==t[1]||i[2]!==t[2]||i[3]!==t[3]?(A.mainContext.uniform4f(e.location,i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3]),1):0},i._uniform_vec4v=function(e,t){return A.mainContext.uniform4fv(e.location,t),1},i._uniformMatrix2fv=function(e,t){return A.mainContext.uniformMatrix2fv(e.location,!1,t),1},i._uniformMatrix3fv=function(e,t){return A.mainContext.uniformMatrix3fv(e.location,!1,t),1},i._uniformMatrix4fv=function(e,t){return A.mainContext.uniformMatrix4fv(e.location,!1,t),1},i._uinformMatrix2fv=function(e,t){return A.mainContext.uniformMatrix2fv(e.location,!1,t),1},i._uinformMatrix3fv=function(e,t){return A.mainContext.uniformMatrix3fv(e.location,!1,t),1},i._uniform1i=function(e,t){var i=e.uploadedValue;return i[0]!==t?(A.mainContext.uniform1i(e.location,i[0]=t),1):0},i._uniform1iv=function(e,t){return A.mainContext.uniform1iv(e.location,t),1},i._uniform_ivec2=function(e,t){var i=e.uploadedValue;return i[0]!==t[0]||i[1]!==t[1]?(A.mainContext.uniform2i(e.location,i[0]=t[0],i[1]=t[1]),1):0},i._uniform_ivec2v=function(e,t){return A.mainContext.uniform2iv(e.location,t),1},i._uniform_vec3i=function(e,t){var i=e.uploadedValue;return i[0]!==t[0]||i[1]!==t[1]||i[2]!==t[2]?(A.mainContext.uniform3i(e.location,i[0]=t[0],i[1]=t[1],i[2]=t[2]),1):0},i._uniform_vec3vi=function(e,t){return A.mainContext.uniform3iv(e.location,t),1},i._uniform_vec4i=function(e,t){var i=e.uploadedValue;return i[0]!==t[0]||i[1]!==t[1]||i[2]!==t[2]||i[3]!==t[3]?(A.mainContext.uniform4i(e.location,i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3]),1):0},i._uniform_vec4vi=function(e,t){return A.mainContext.uniform4iv(e.location,t),1},i._uniform_sampler2D=function(e,i){var n=i.source||i.defaulteTexture.source,a=A.mainContext,r=e.uploadedValue;if(null==r[0]){if(this._curActTexIndex>7)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return r[0]=this._curActTexIndex,a.uniform1i(e.location,this._curActTexIndex),a.activeTexture(t._TEXTURES[this._curActTexIndex]),n&&R.bindTexture(a,3553,n),this._curActTexIndex++,1}return a.activeTexture(t._TEXTURES[r[0]]),n&&R.bindTexture(a,3553,n),0},i._uniform_samplerCube=function(e,i){var n=i.source||i.defaulteTexture.source,a=A.mainContext,r=e.uploadedValue;if(null==r[0]){if(this._curActTexIndex>7)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return r[0]=this._curActTexIndex,a.uniform1i(e.location,this._curActTexIndex),a.activeTexture(t._TEXTURES[this._curActTexIndex]),n?R.bindTexture(a,34067,n):R.bindTexture(a,34067,sn.grayTexture.source),this._curActTexIndex++,1}return a.activeTexture(t._TEXTURES[r[0]]),n?R.bindTexture(a,34067,n):R.bindTexture(a,34067,sn.grayTexture.source),0},i._noSetValue=function(e){console.log("no....:"+e.name)},i.bind=function(){return p.activeShader=this,p.bindShader=this,this.activeResource(),R.UseProgram(this._program)},i.uploadAttributes=function(e,t){for(var i,n,a=0,r=0,o=this._attributeParamsMap.length;r<o;r+=2)n=this._attributeParamsMap[r+1],null!=(i=e[this._attributeParamsMap[r]])&&(t&&t[n.name]&&t[n.name].bind(),a+=n.fun.call(this,n,i));T.shaderCall+=a},i.uploadAttributesX=function(e,t){for(var i,n,a=0,r=0,o=this._attributeParamsMap.length;r<o;r+=2)n=this._attributeParamsMap[r+1],null!=(i=e[this._attributeParamsMap[r]])&&(t._bind(),a+=n.fun.call(this,n,i));T.shaderCall+=a},i.uploadSceneUniforms=function(e){for(var t,i,n=0,a=0,r=this._sceneUniformParamsMap.length;a<r;a+=2)i=this._sceneUniformParamsMap[a+1],null!=(t=e[this._sceneUniformParamsMap[a]])&&(n+=i.fun.call(this,i,t));T.shaderCall+=n},i.uploadCameraUniforms=function(e){for(var t,i,n=0,a=0,r=this._cameraUniformParamsMap.length;a<r;a+=2)i=this._cameraUniformParamsMap[a+1],null!=(t=e[this._cameraUniformParamsMap[a]])&&(n+=i.fun.call(this,i,t));T.shaderCall+=n},i.uploadSpriteUniforms=function(e){for(var t,i,n=0,a=0,r=this._spriteUniformParamsMap.length;a<r;a+=2)i=this._spriteUniformParamsMap[a+1],null!=(t=e[this._spriteUniformParamsMap[a]])&&(n+=i.fun.call(this,i,t));T.shaderCall+=n},i.uploadMaterialUniforms=function(e){for(var t,i,n=0,a=0,r=this._materialUniformParamsMap.length;a<r;a+=2)i=this._materialUniformParamsMap[a+1],null!=(t=e[this._materialUniformParamsMap[a]])&&(n+=i.fun.call(this,i,t));T.shaderCall+=n},i.uploadRenderElementUniforms=function(e){for(var t,i,n=0,a=0,r=this._renderElementUniformParamsMap.length;a<r;a+=2)i=this._renderElementUniformParamsMap[a+1],null!=(t=e[this._renderElementUniformParamsMap[a]])&&(n+=i.fun.call(this,i,t));T.shaderCall+=n},t.create=function(e,i,n,a,r,o,s,h){return new t(e,i,n,a,r,o,s,h)},t.addInclude=function(e,t){k.addInclude(e,t)},t._createShader=function(e,t,i){var n=e.createShader(i);if(e.shaderSource(n,t),e.compileShader(n),ci.debugMode&&!e.getShaderParameter(n,35713))throw e.getShaderInfoLog(n);return n},t.PERIOD_RENDERELEMENT=0,t.PERIOD_MATERIAL=1,t.PERIOD_SPRITE=2,t.PERIOD_CAMERA=3,t.PERIOD_SCENE=4,t._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,33991],t._count=0,n(t,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"nameKey",function(){return this.nameKey=new L}]),t}(),Vi=function(e){function t(){t.__super.call(this),this.setShaderName("BLINNPHONG"),this._albedoIntensity=1,this._albedoColor=new Rt(1,1,1,1),this._setColor(6,new Rt(1,1,1,1)),this._setColor(8,new At(1,1,1)),this._setNumber(9,.078125),this._setColor(10,new At(1,1,1)),this._setNumber(0,.5),this._setColor(11,new Rt(1,1,0,0)),this._enableLighting=!0,this.renderMode=0}a(t,"laya.d3.core.material.BlinnPhongMaterial",e);var o=t.prototype;return o.disableLight=function(){this._addDisablePublicShaderDefine(ci.SHADERDEFINE_POINTLIGHT|ci.SHADERDEFINE_SPOTLIGHT|ci.SHADERDEFINE_DIRECTIONLIGHT)},o.disableFog=function(){this._addDisablePublicShaderDefine(ci.SHADERDEFINE_FOG)},o.cloneTo=function(t){e.prototype.cloneTo.call(this,t);var i=t;i._enableLighting=this._enableLighting,i._albedoIntensity=this._albedoIntensity,this._albedoColor.cloneTo(i._albedoColor)},r(0,o,"renderMode",null,function(e){switch(e){case 0:this.renderQueue=2e3,this.depthWrite=!0,this.cull=2,this.blend=0,this.alphaTest=!1,this.depthTest=513,this._removeShaderDefine(t.SHADERDEFINE_ADDTIVEFOG);break;case 1:this.depthWrite=!0,this.cull=2,this.blend=0,this.renderQueue=2e3,this.alphaTest=!0,this.depthTest=513,this._removeShaderDefine(t.SHADERDEFINE_ADDTIVEFOG);break;case 2:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this.depthTest=513,this._removeShaderDefine(t.SHADERDEFINE_ADDTIVEFOG);break;case 3:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this.depthTest=513,this._addShaderDefine(t.SHADERDEFINE_ADDTIVEFOG);break;default:throw new Error("Material:renderMode value error.")}this._conchMaterial&&this._conchMaterial.setRenderMode(e)}),r(0,o,"normalTexture",function(){return this._getTexture(2)},function(e){e?this._addShaderDefine(laya.d3.core.material.BlinnPhongMaterial.SHADERDEFINE_NORMALMAP):this._removeShaderDefine(laya.d3.core.material.BlinnPhongMaterial.SHADERDEFINE_NORMALMAP),this._setTexture(2,e)}),r(0,o,"reflectColor",function(){return this._getColor(10)},function(e){this._setColor(10,e)}),r(0,o,"tilingOffset",function(){return this._getColor(11)},function(e){if(e){var t=e.elements;1!=t[0]||1!=t[1]||0!=t[2]||0!=t[3]?this._addShaderDefine(laya.d3.core.material.BlinnPhongMaterial.SHADERDEFINE_TILINGOFFSET):this._removeShaderDefine(laya.d3.core.material.BlinnPhongMaterial.SHADERDEFINE_TILINGOFFSET)}else this._removeShaderDefine(laya.d3.core.material.BlinnPhongMaterial.SHADERDEFINE_TILINGOFFSET);this._setColor(11,e)}),r(0,o,"specularColor",function(){return this._getColor(8)},function(e){this._setColor(8,e)}),r(0,o,"albedoColor",function(){return this._albedoColor},function(e){var t=this._getColor(6);Rt.scale(e,this._albedoIntensity,t),this._albedoColor=e}),r(0,o,"albedoIntensity",function(){return this._albedoIntensity},function(e){if(this._albedoIntensity!==e){var t=this._getColor(6);Rt.scale(this._albedoColor,e,t),this._albedoIntensity=e}}),r(0,o,"albedoTexture",function(){return this._getTexture(1)},function(e){e?this._addShaderDefine(laya.d3.core.material.BlinnPhongMaterial.SHADERDEFINE_DIFFUSEMAP):this._removeShaderDefine(laya.d3.core.material.BlinnPhongMaterial.SHADERDEFINE_DIFFUSEMAP),this._setTexture(1,e)}),r(0,o,"shininess",function(){return this._getNumber(9)},function(e){e=Math.max(0,Math.min(1,e)),this._setNumber(9,e)}),r(0,o,"specularTexture",function(){return this._getTexture(3)},function(e){e?this._addShaderDefine(laya.d3.core.material.BlinnPhongMaterial.SHADERDEFINE_SPECULARMAP):this._removeShaderDefine(laya.d3.core.material.BlinnPhongMaterial.SHADERDEFINE_SPECULARMAP),this._setTexture(3,e)}),r(0,o,"reflectTexture",function(){return this._getTexture(5)},function(e){e?this._addShaderDefine(laya.d3.core.material.BlinnPhongMaterial.SHADERDEFINE_REFLECTMAP):this._removeShaderDefine(laya.d3.core.material.BlinnPhongMaterial.SHADERDEFINE_REFLECTMAP),this._setTexture(5,e)}),r(0,o,"enableLighting",function(){return this._enableLighting},function(e){this._enableLighting!==e&&(e?this._removeDisablePublicShaderDefine(ci.SHADERDEFINE_POINTLIGHT|ci.SHADERDEFINE_SPOTLIGHT|ci.SHADERDEFINE_DIRECTIONLIGHT):this._addDisablePublicShaderDefine(ci.SHADERDEFINE_POINTLIGHT|ci.SHADERDEFINE_SPOTLIGHT|ci.SHADERDEFINE_DIRECTIONLIGHT),this._enableLighting=e)}),t.__init__=function(){t.SHADERDEFINE_DIFFUSEMAP=t.shaderDefines.registerDefine("DIFFUSEMAP"),t.SHADERDEFINE_NORMALMAP=t.shaderDefines.registerDefine("NORMALMAP"),t.SHADERDEFINE_SPECULARMAP=t.shaderDefines.registerDefine("SPECULARMAP"),t.SHADERDEFINE_REFLECTMAP=t.shaderDefines.registerDefine("REFLECTMAP"),t.SHADERDEFINE_TILINGOFFSET=t.shaderDefines.registerDefine("TILINGOFFSET"),t.SHADERDEFINE_ADDTIVEFOG=t.shaderDefines.registerDefine("ADDTIVEFOG")},t.load=function(e){return i.loader.create(e,null,null,t)},t.SPECULARSOURCE_DIFFUSEMAPALPHA=0,t.SPECULARSOURCE_SPECULARMAP=0,t.RENDERMODE_OPAQUE=0,t.RENDERMODE_CUTOUT=1,t.RENDERMODE_TRANSPARENT=2,t.RENDERMODE_ADDTIVE=3,t.SHADERDEFINE_DIFFUSEMAP=0,t.SHADERDEFINE_NORMALMAP=0,t.SHADERDEFINE_SPECULARMAP=0,t.SHADERDEFINE_REFLECTMAP=0,t.SHADERDEFINE_TILINGOFFSET=0,t.SHADERDEFINE_ADDTIVEFOG=0,t.ALBEDOTEXTURE=1,t.NORMALTEXTURE=2,t.SPECULARTEXTURE=3,t.EMISSIVETEXTURE=4,t.REFLECTTEXTURE=5,t.ALBEDOCOLOR=6,t.MATERIALSPECULAR=8,t.SHININESS=9,t.MATERIALREFLECT=10,t.TILINGOFFSET=11,n(t,["defaultMaterial",function(){return this.defaultMaterial=new t},"shaderDefines",function(){return this.shaderDefines=new Vt(fi.shaderDefines)}]),t}(fi),Ui=function(e){function t(){t.__super.call(this),this.setShaderName("ExtendTerrain"),this.renderMode=1}a(t,"laya.d3.core.material.ExtendTerrainMaterial",fi);var i=t.prototype;return i._setDetailNum=function(e){switch(e){case 1:this._addShaderDefine(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM1),this._removeShaderDefine(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM2),this._removeShaderDefine(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM3),this._removeShaderDefine(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM4),this._removeShaderDefine(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM5);break;case 2:this._addShaderDefine(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM2),this._removeShaderDefine(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM1),this._removeShaderDefine(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM3),this._removeShaderDefine(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM4),this._removeShaderDefine(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM5);break;case 3:this._addShaderDefine(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM3),this._removeShaderDefine(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM1),this._removeShaderDefine(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM2),this._removeShaderDefine(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM4),this._removeShaderDefine(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM5);break;case 4:this._addShaderDefine(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM4),this._removeShaderDefine(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM1),this._removeShaderDefine(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM2),this._removeShaderDefine(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM3),this._removeShaderDefine(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM5);break;case 5:this._addShaderDefine(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM5),this._removeShaderDefine(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM1),this._removeShaderDefine(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM2),this._removeShaderDefine(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM3),this._removeShaderDefine(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM4)}},i.disableLight=function(){this._addDisablePublicShaderDefine(ci.SHADERDEFINE_POINTLIGHT|ci.SHADERDEFINE_SPOTLIGHT|ci.SHADERDEFINE_DIRECTIONLIGHT)},r(0,i,"diffuseScaleOffset2",null,function(e){this._setColor(7,e)}),r(0,i,"splatAlphaTexture",function(){return this._getTexture(0)},function(e){this._setTexture(0,e)}),r(0,i,"diffuseScaleOffset3",null,function(e){this._setColor(8,e)}),r(0,i,"diffuseTexture1",null,function(e){this._setTexture(1,e),this._setDetailNum(1)}),r(0,i,"renderMode",null,function(e){switch(e){case 1:this.renderQueue=2e3,this.depthWrite=!0,this.cull=2,this.blend=0,this.depthTest=513;break;case 2:this.renderQueue=2e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.depthTest=515;break;default:throw new Error("ExtendTerrainMaterial:renderMode value error.")}this._conchMaterial&&this._conchMaterial.setRenderMode(e)}),r(0,i,"diffuseTexture2",function(){return this._getTexture(2)},function(e){this._setTexture(2,e),this._setDetailNum(2)}),r(0,i,"diffuseScaleOffset1",null,function(e){this._setColor(6,e)}),r(0,i,"diffuseTexture3",function(){return this._getTexture(3)},function(e){this._setTexture(3,e),this._setDetailNum(3)}),r(0,i,"diffuseTexture4",function(){return this._getTexture(4)},function(e){this._setTexture(4,e),this._setDetailNum(4)}),r(0,i,"diffuseTexture5",function(){return this._getTexture(5)},function(e){this._setTexture(5,e),this._setDetailNum(5)}),r(0,i,"diffuseScaleOffset4",null,function(e){this._setColor(9,e)}),r(0,i,"diffuseScaleOffset5",null,function(e){this._setColor(10,e)}),r(0,i,"albedo",function(){return this._getColor(14)},function(e){this._setColor(14,e)}),r(0,i,"ambientColor",function(){return this._getColor(11)},function(e){this._setColor(11,e)}),r(0,i,"diffuseColor",function(){return this._getColor(12)},function(e){this._setColor(12,e)}),r(0,i,"specularColor",function(){return this._getColor(13)},function(e){this._setColor(13,e)}),t.__init__=function(){t.SHADERDEFINE_DETAIL_NUM1=t.shaderDefines.registerDefine("ExtendTerrain_DETAIL_NUM1"),t.SHADERDEFINE_DETAIL_NUM2=t.shaderDefines.registerDefine("ExtendTerrain_DETAIL_NUM2"),t.SHADERDEFINE_DETAIL_NUM3=t.shaderDefines.registerDefine("ExtendTerrain_DETAIL_NUM3"),t.SHADERDEFINE_DETAIL_NUM4=t.shaderDefines.registerDefine("ExtendTerrain_DETAIL_NUM4"),t.SHADERDEFINE_DETAIL_NUM5=t.shaderDefines.registerDefine("ExtendTerrain_DETAIL_NUM5")},t.RENDERMODE_OPAQUE=1,t.RENDERMODE_TRANSPARENT=2,t.SPLATALPHATEXTURE=0,t.DIFFUSETEXTURE1=1,t.DIFFUSETEXTURE2=2,t.DIFFUSETEXTURE3=3,t.DIFFUSETEXTURE4=4,t.DIFFUSETEXTURE5=5,t.DIFFUSESCALEOFFSET1=6,t.DIFFUSESCALEOFFSET2=7,t.DIFFUSESCALEOFFSET3=8,t.DIFFUSESCALEOFFSET4=9,t.DIFFUSESCALEOFFSET5=10,t.MATERIALAMBIENT=11,t.MATERIALDIFFUSE=12,t.MATERIALSPECULAR=13,t.MATERIALALBEDO=14,t.SHADERDEFINE_DETAIL_NUM1=0,t.SHADERDEFINE_DETAIL_NUM2=0,t.SHADERDEFINE_DETAIL_NUM3=0,t.SHADERDEFINE_DETAIL_NUM4=0,t.SHADERDEFINE_DETAIL_NUM5=0,n(t,["shaderDefines",function(){return this.shaderDefines=new Vt(fi.shaderDefines)}]),t}(),Fi=function(e){function t(){t.__super.call(this),this.setShaderName("GLITTER"),this.renderMode=1,this._setColor(3,new Rt(1,1,1,1)),this._setColor(2,new Rt(1,1,1,1))}a(t,"laya.d3.core.material.GlitterMaterial",e);var o=t.prototype;return o.setShaderName=function(t){e.prototype.setShaderName.call(this,t)},r(0,o,"renderMode",null,function(e){switch(e){case 1:this.renderQueue=2e3,this.depthWrite=!0,this.cull=2,this.blend=0;break;case 2:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0;break;case 13:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771;break;case 14:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771;break;case 15:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1;break;case 16:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1;break;case 5:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771;break;case 6:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771;break;case 7:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1;break;case 8:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1;break;case 9:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771;break;case 10:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771;break;case 11:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1;break;case 12:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1;break;default:throw new Error("Material:renderMode value error.")}this._conchMaterial&&this._conchMaterial.setRenderMode(e)}),r(0,o,"diffuseTexture",function(){return this._getTexture(1)},function(e){this._setTexture(1,e)}),r(0,o,"albedo",function(){return this._getColor(2)},function(e){this._setColor(2,e)}),r(0,o,"color",function(){return this._getColor(3)},function(e){this._setColor(3,e)}),t.load=function(e){return i.loader.create(e,null,null,t)},t.RENDERMODE_OPAQUE=1,t.RENDERMODE_OPAQUEDOUBLEFACE=2,t.RENDERMODE_TRANSPARENT=13,t.RENDERMODE_TRANSPARENTDOUBLEFACE=14,t.RENDERMODE_ADDTIVE=15,t.RENDERMODE_ADDTIVEDOUBLEFACE=16,t.RENDERMODE_DEPTHREAD_TRANSPARENT=5,t.RENDERMODE_DEPTHREAD_TRANSPARENTDOUBLEFACE=6,t.RENDERMODE_DEPTHREAD_ADDTIVE=7,t.RENDERMODE_DEPTHREAD_ADDTIVEDOUBLEFACE=8,t.RENDERMODE_NONDEPTH_TRANSPARENT=9,t.RENDERMODE_NONDEPTH_TRANSPARENTDOUBLEFACE=10,t.RENDERMODE_NONDEPTH_ADDTIVE=11,t.RENDERMODE_NONDEPTH_ADDTIVEDOUBLEFACE=12,t.DIFFUSETEXTURE=1,t.ALBEDO=2,t.UNICOLOR=3,n(t,["defaultMaterial",function(){return this.defaultMaterial=new t}]),t}(fi),Hi=function(e){function t(){if(this._transformUV=null,t.__super.call(this),!laya.d3.core.material.PBRMaterial.pbrlutTex){var e=u.window.__pbrlutdata;if(!e)throw alert("no pbr lutdata, need pbrlut.js"),"no pbr lutdata, need pbrlut.js";var i=tn.create(new Uint32Array(e).buffer,256,256,9728,9728,!1);laya.d3.core.material.PBRMaterial.pbrlutTex=i}this._setTexture(4,laya.d3.core.material.PBRMaterial.pbrlutTex),this.setShaderName("PBR"),this._setNumber(0,.5),this.use_groundtruth=!1}a(t,"laya.d3.core.material.PBRMaterial",e);var o=t.prototype;return o.disableLight=function(){this._addDisablePublicShaderDefine(ci.SHADERDEFINE_POINTLIGHT|ci.SHADERDEFINE_SPOTLIGHT|ci.SHADERDEFINE_DIRECTIONLIGHT)},o.disableFog=function(){this._addDisablePublicShaderDefine(ci.SHADERDEFINE_FOG)},o.onAsynLoaded=function(t,i,n){e.prototype.onAsynLoaded.call(this,t,i,n)},o.radicalInverse_VdC=function(e){var t=new Uint32Array(1);return function(e){return e=e<<16|e>>>16,e=(1431655765&e)<<1|(2863311530&e)>>>1,e=(858993459&e)<<2|(3435973836&e)>>>2,e=(252645135&e)<<4|(4042322160&e)>>>4,e=(16711935&e)<<8|(4278255360&e)>>>8,t[0]=e,2.3283064365386963e-10*t[0]}(e)},o.createHammersleyTex=function(e,t){var i=new Uint8Array(e*t*4),n=0,a=0;for(a=0;a<e*t;a++){var r=this.radicalInverse_VdC(a);i[n++]=255*r,i[n++]=0,i[n++]=0,i[n++]=255}return i},r(0,o,"normalTexture",function(){return this._getTexture(2)},function(e){this._setTexture(2,e)}),r(0,o,"has_tangent",null,function(e){this._addShaderDefine(t.SHADERDEFINE_HAS_TANGENT)}),r(0,o,"roughness",function(){return this._getNumber(6)},function(e){this._setNumber(6,e),this._addShaderDefine(t.SHADERDEFINE_FIX_ROUGHNESS)}),r(0,o,"metaless",function(){return this._getNumber(7)},function(e){this._setNumber(7,e),this._addShaderDefine(t.SHADERDEFINE_FIX_METALESS)}),r(0,o,"pbrlutTexture",function(){return this._getTexture(4)},function(e){this._setTexture(4,e)}),r(0,o,"use_groundtruth",null,function(e){if(e){if(this._addShaderDefine(t.SHADERDEFINE_USE_GROUNDTRUTH),!laya.d3.core.material.PBRMaterial.HammersleyNoiseTex){var i=this.createHammersleyTex(32,32);laya.d3.core.material.PBRMaterial.HammersleyNoiseTex=tn.create(i.buffer,32,32,9728,9728,!1)}this._setTexture(15,t.HammersleyNoiseTex)}else laya.d3.core.material.PBRMaterial.HammersleyNoiseTex=null,this._removeShaderDefine(t.SHADERDEFINE_USE_GROUNDTRUTH)}),r(0,o,"transformUV",function(){return this._transformUV},function(e){this._transformUV=e,this._setMatrix4x4(8,e.matrix),this._conchMaterial&&this._conchMaterial.setShaderValue(8,e.matrix.elements,0)}),r(0,o,"diffuseTexture",function(){return this._getTexture(1)},function(e){this._setTexture(1,e)}),r(0,o,"renderMode",null,function(e){switch(e){case 1:this.renderQueue=2e3,this.depthWrite=!0,this.cull=2,this.blend=0,this.alphaTest=!1;break;case 2:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!1;break;case 3:this.depthWrite=!0,this.cull=2,this.blend=0,this.renderQueue=2e3;break;case 13:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771;break;default:throw new Error("PBRMaterial:renderMode value error.")}}),r(0,o,"pbrInfoTexture",function(){return this._getTexture(3)},function(e){this._setTexture(3,e),this._addShaderDefine(t.SHADERDEFINE_HAS_PBRINFO)}),r(0,o,"testClipZ",null,function(e){this._addShaderDefine(t.SHADERDEFINE_TEST_CLIPZ)}),t.__init__=function(){t.SHADERDEFINE_FIX_METALESS=t.shaderDefines.registerDefine("FIX_METALESS"),t.SHADERDEFINE_FIX_ROUGHNESS=t.shaderDefines.registerDefine("FIX_ROUGHNESS"),t.SHADERDEFINE_HAS_TANGENT=t.shaderDefines.registerDefine("HAS_TANGENT"),t.SHADERDEFINE_HAS_PBRINFO=t.shaderDefines.registerDefine("HAS_PBRINFO"),t.SHADERDEFINE_USE_GROUNDTRUTH=t.shaderDefines.registerDefine("USE_GROUNDTRUTH"),t.SHADERDEFINE_TEST_CLIPZ=t.shaderDefines.registerDefine("CLIPZ")},t.load=function(e){return i.loader.create(e,null,null,t)},t.DIFFUSETEXTURE=1,t.NORMALTEXTURE=2,t.PBRINFOTEXTURE=3,t.PBRLUTTEXTURE=4,t.UVANIAGE=5,t.MATERIALROUGHNESS=6,t.MATERIALMETALESS=7,t.UVMATRIX=8,t.UVAGE=9,t.AOOBJPOS=14,t.HSNOISETEXTURE=15,t.SHADERDEFINE_FIX_ROUGHNESS=0,t.SHADERDEFINE_FIX_METALESS=0,t.SHADERDEFINE_HAS_TANGENT=0,t.SHADERDEFINE_TEST_CLIPZ=0,t.SHADERDEFINE_HAS_PBRINFO=0,t.SHADERDEFINE_USE_GROUNDTRUTH=0,t.RENDERMODE_OPAQUE=1,t.RENDERMODE_OPAQUEDOUBLEFACE=2,t.RENDERMODE_CUTOUT=3,t.RENDERMODE_CUTOUTDOUBLEFACE=4,t.RENDERMODE_TRANSPARENT=13,t.pbrlutTex=null,t.HammersleyNoiseTex=null,n(t,["defaultMaterial",function(){return this.defaultMaterial=new t},"shaderDefines",function(){return this.shaderDefines=new Vt(fi.shaderDefines)}]),t}(fi),zi=function(e){function t(){t.__super.call(this),this.setShaderName("PBRSpecular"),this._setColor(7,new Rt(1,1,1,1)),this._setColor(9,new Rt(0,0,0,0)),this._setColor(8,new Rt(.2,.2,.2,.2)),this._setNumber(10,.5),this._setNumber(11,1),this._setNumber(12,0),this._setNumber(13,1),this._setNumber(14,1),this._setNumber(15,.001),this._setBool(16,!1),this._setNumber(0,.5)}a(t,"laya.d3.core.material.PBRSpecularMaterial",fi);var i=t.prototype;return r(0,i,"albedoColor",function(){return this._getColor(7)},function(e){this._setColor(7,e)}),r(0,i,"specularTexture",function(){return this._getTexture(2)},function(e){e?this._addShaderDefine(laya.d3.core.material.PBRSpecularMaterial.SHADERDEFINE_SPECULARTEXTURE):this._removeShaderDefine(laya.d3.core.material.PBRSpecularMaterial.SHADERDEFINE_SPECULARTEXTURE),this._setTexture(2,e)}),r(0,i,"albedoTexture",function(){return this._getTexture(1)},function(e){e?this._addShaderDefine(laya.d3.core.material.PBRSpecularMaterial.SHADERDEFINE_DIFFUSETEXTURE):this._removeShaderDefine(laya.d3.core.material.PBRSpecularMaterial.SHADERDEFINE_DIFFUSETEXTURE),this._setTexture(1,e)}),r(0,i,"occlusionTexture",function(){return this._getTexture(5)},function(e){e?this._addShaderDefine(laya.d3.core.material.PBRSpecularMaterial.SHADERDEFINE_OCCLUSIONTEXTURE):this._removeShaderDefine(laya.d3.core.material.PBRSpecularMaterial.SHADERDEFINE_OCCLUSIONTEXTURE),this._setTexture(5,e)}),r(0,i,"normalTexture",function(){return this._getTexture(3)},function(e){e?this._addShaderDefine(laya.d3.core.material.PBRSpecularMaterial.SHADERDEFINE_NORMALTEXTURE):this._removeShaderDefine(laya.d3.core.material.PBRSpecularMaterial.SHADERDEFINE_NORMALTEXTURE),this._setTexture(3,e)}),r(0,i,"parallaxTexture",function(){return this._getTexture(4)},function(e){e?this._addShaderDefine(laya.d3.core.material.PBRSpecularMaterial.SHADERDEFINE_PARALLAXTEXTURE):this._removeShaderDefine(laya.d3.core.material.PBRSpecularMaterial.SHADERDEFINE_PARALLAXTEXTURE),this._setTexture(4,e)}),r(0,i,"emissionColor",function(){return this._getColor(9)},function(e){this._setColor(9,e)}),r(0,i,"normalTextureScale",function(){return this._getNumber(14)},function(e){this._setNumber(14,e)}),r(0,i,"parallaxTextureScale",function(){return this._getNumber(15)},function(e){e=Math.max(.005,Math.min(.08,e)),this._setNumber(15,e)}),r(0,i,"occlusionTextureStrength",function(){return this._getNumber(13)},function(e){e=Math.max(0,Math.min(1,e)),this._setNumber(13,e)}),r(0,i,"specularColor",function(){return this._getColor(8)},function(e){this._setColor(8,e)}),r(0,i,"smoothness",function(){return this._getNumber(10)},function(e){e=Math.max(0,Math.min(1,e)),this._setNumber(10,e)}),r(0,i,"smoothnessTextureScale",function(){return this._getNumber(11)},function(e){e=Math.max(0,Math.min(1,e)),this._setNumber(11,e)}),r(0,i,"smoothnessSource",function(){return this._getNumber(12)},function(e){1==e?this._addShaderDefine(laya.d3.core.material.PBRSpecularMaterial.SHADERDEFINE_SMOOTHNESSSOURCE_DIFFUSETEXTURE_ALPHA):(this._removeShaderDefine(laya.d3.core.material.PBRSpecularMaterial.SHADERDEFINE_SMOOTHNESSSOURCE_DIFFUSETEXTURE_ALPHA),e=0),this._setNumber(12,e)}),r(0,i,"enableEmission",function(){return this._getBool(16)},function(e){e?this._addShaderDefine(laya.d3.core.material.PBRSpecularMaterial.SHADERDEFINE_EMISSION):this._removeShaderDefine(laya.d3.core.material.PBRSpecularMaterial.SHADERDEFINE_EMISSION),this._setBool(16,e)}),r(0,i,"emissionTexture",function(){return this._getTexture(6)},function(e){e?this._addShaderDefine(laya.d3.core.material.PBRSpecularMaterial.SHADERDEFINE_EMISSIONTEXTURE):this._removeShaderDefine(laya.d3.core.material.PBRSpecularMaterial.SHADERDEFINE_EMISSIONTEXTURE),this._setTexture(6,e)}),r(0,i,"tilingOffset",function(){return this._getColor(17)},function(e){if(e){var t=e.elements;1!=t[0]||1!=t[1]||0!=t[2]||0!=t[3]?this._addShaderDefine(laya.d3.core.material.PBRSpecularMaterial.SHADERDEFINE_TILINGOFFSET):this._removeShaderDefine(laya.d3.core.material.PBRSpecularMaterial.SHADERDEFINE_TILINGOFFSET)}else this._removeShaderDefine(laya.d3.core.material.PBRSpecularMaterial.SHADERDEFINE_TILINGOFFSET);this._setColor(17,e)}),t.__init__=function(){t.SHADERDEFINE_DIFFUSETEXTURE=t.shaderDefines.registerDefine("DIFFUSETEXTURE"),t.SHADERDEFINE_SPECULARTEXTURE=t.shaderDefines.registerDefine("SPECULARTEXTURE"),t.SHADERDEFINE_SMOOTHNESSSOURCE_DIFFUSETEXTURE_ALPHA=t.shaderDefines.registerDefine("SMOOTHNESSSOURCE_DIFFUSETEXTURE_ALPHA"),t.SHADERDEFINE_NORMALTEXTURE=t.shaderDefines.registerDefine("NORMALTEXTURE"),t.SHADERDEFINE_PARALLAXTEXTURE=t.shaderDefines.registerDefine("PARALLAXTEXTURE"),t.SHADERDEFINE_OCCLUSIONTEXTURE=t.shaderDefines.registerDefine("OCCLUSIONTEXTURE"),t.SHADERDEFINE_EMISSION=t.shaderDefines.registerDefine("EMISSION"),t.SHADERDEFINE_EMISSIONTEXTURE=t.shaderDefines.registerDefine("EMISSIONTEXTURE"),t.SHADERDEFINE_TILINGOFFSET=t.shaderDefines.registerDefine("TILINGOFFSET")},t.SmoothnessSource_MetallicGlossTexture_Alpha=0,t.SmoothnessSource_DiffuseTexture_Alpha=1,t.SHADERDEFINE_DIFFUSETEXTURE=0,t.SHADERDEFINE_NORMALTEXTURE=0,t.SHADERDEFINE_SMOOTHNESSSOURCE_DIFFUSETEXTURE_ALPHA=0,t.SHADERDEFINE_SPECULARTEXTURE=0,t.SHADERDEFINE_OCCLUSIONTEXTURE=0,t.SHADERDEFINE_PARALLAXTEXTURE=0,t.SHADERDEFINE_EMISSION=0,t.SHADERDEFINE_EMISSIONTEXTURE=0,t.SHADERDEFINE_TILINGOFFSET=0,t.DIFFUSETEXTURE=1,t.SPECULARTEXTURE=2,t.NORMALTEXTURE=3,t.PARALLAXTEXTURE=4,t.OCCLUSIONTEXTURE=5,t.EMISSIONTEXTURE=6,t.DIFFUSECOLOR=7,t.SPECULARCOLOR=8,t.EMISSIONCOLOR=9,t.SMOOTHNESS=10,t.SMOOTHNESSSCALE=11,t.SMOOTHNESSSOURCE=12,t.OCCLUSIONSTRENGTH=13,t.NORMALSCALE=14,t.PARALLAXSCALE=15,t.ENABLEEMISSION=16,t.TILINGOFFSET=17,n(t,["shaderDefines",function(){return this.shaderDefines=new Vt(fi.shaderDefines)}]),t}(),Xi=function(e){function t(){t.__super.call(this),this.setShaderName("PBRStandard"),this._setColor(7,new Rt(1,1,1,1)),this._setColor(8,new Rt(0,0,0,0)),this._setNumber(9,0),this._setNumber(10,.5),this._setNumber(11,1),this._setNumber(12,0),this._setNumber(13,1),this._setNumber(14,1),this._setNumber(15,.001),this._setBool(16,!1),this._setNumber(0,.5)}a(t,"laya.d3.core.material.PBRStandardMaterial",fi);var i=t.prototype;return r(0,i,"albedoColor",function(){return this._getColor(7)},function(e){this._setColor(7,e)}),r(0,i,"albedoTexture",function(){return this._getTexture(1)},function(e){e?this._addShaderDefine(laya.d3.core.material.PBRStandardMaterial.SHADERDEFINE_DIFFUSETEXTURE):this._removeShaderDefine(laya.d3.core.material.PBRStandardMaterial.SHADERDEFINE_DIFFUSETEXTURE),this._setTexture(1,e)}),r(0,i,"enableEmission",function(){return this._getBool(16)},function(e){e?this._addShaderDefine(laya.d3.core.material.PBRStandardMaterial.SHADERDEFINE_EMISSION):this._removeShaderDefine(laya.d3.core.material.PBRStandardMaterial.SHADERDEFINE_EMISSION),this._setBool(16,e)}),r(0,i,"metallicGlossTexture",function(){return this._getTexture(2)},function(e){e?this._addShaderDefine(laya.d3.core.material.PBRStandardMaterial.SHADERDEFINE_METALLICGLOSSTEXTURE):this._removeShaderDefine(laya.d3.core.material.PBRStandardMaterial.SHADERDEFINE_METALLICGLOSSTEXTURE),this._setTexture(2,e)}),r(0,i,"occlusionTexture",function(){return this._getTexture(5)},function(e){e?this._addShaderDefine(laya.d3.core.material.PBRStandardMaterial.SHADERDEFINE_OCCLUSIONTEXTURE):this._removeShaderDefine(laya.d3.core.material.PBRStandardMaterial.SHADERDEFINE_OCCLUSIONTEXTURE),this._setTexture(5,e)}),r(0,i,"normalTexture",function(){return this._getTexture(3)},function(e){e?this._addShaderDefine(laya.d3.core.material.PBRStandardMaterial.SHADERDEFINE_NORMALTEXTURE):this._removeShaderDefine(laya.d3.core.material.PBRStandardMaterial.SHADERDEFINE_NORMALTEXTURE),this._setTexture(3,e)}),r(0,i,"parallaxTexture",function(){return this._getTexture(4)},function(e){e?this._addShaderDefine(laya.d3.core.material.PBRStandardMaterial.SHADERDEFINE_PARALLAXTEXTURE):this._removeShaderDefine(laya.d3.core.material.PBRStandardMaterial.SHADERDEFINE_PARALLAXTEXTURE),this._setTexture(4,e)}),r(0,i,"emissionColor",function(){return this._getColor(8)},function(e){this._setColor(8,e)}),r(0,i,"normalTextureScale",function(){return this._getNumber(14)},function(e){this._setNumber(14,e)}),r(0,i,"parallaxTextureScale",function(){return this._getNumber(15)},function(e){e=Math.max(.005,Math.min(.08,e)),this._setNumber(15,e)}),r(0,i,"occlusionTextureStrength",function(){return this._getNumber(13)},function(e){e=Math.max(0,Math.min(1,e)),this._setNumber(13,e)}),r(0,i,"metallic",function(){return this._getNumber(9)},function(e){e=Math.max(0,Math.min(1,e)),this._setNumber(9,e)}),r(0,i,"smoothness",function(){return this._getNumber(10)},function(e){e=Math.max(0,Math.min(1,e)),this._setNumber(10,e)}),r(0,i,"smoothnessTextureScale",function(){return this._getNumber(11)},function(e){e=Math.max(0,Math.min(1,e)),this._setNumber(11,e)}),r(0,i,"smoothnessSource",function(){return this._getNumber(12)},function(e){1==e?this._addShaderDefine(laya.d3.core.material.PBRStandardMaterial.SHADERDEFINE_SMOOTHNESSSOURCE_DIFFUSETEXTURE_ALPHA):(this._removeShaderDefine(laya.d3.core.material.PBRStandardMaterial.SHADERDEFINE_SMOOTHNESSSOURCE_DIFFUSETEXTURE_ALPHA),e=0),this._setNumber(12,e)}),r(0,i,"emissionTexture",function(){return this._getTexture(6)},function(e){e?this._addShaderDefine(laya.d3.core.material.PBRStandardMaterial.SHADERDEFINE_EMISSIONTEXTURE):this._removeShaderDefine(laya.d3.core.material.PBRStandardMaterial.SHADERDEFINE_EMISSIONTEXTURE),this._setTexture(6,e)}),r(0,i,"tilingOffset",function(){return this._getColor(17)},function(e){if(e){var t=e.elements;1!=t[0]||1!=t[1]||0!=t[2]||0!=t[3]?this._addShaderDefine(laya.d3.core.material.PBRStandardMaterial.SHADERDEFINE_TILINGOFFSET):this._removeShaderDefine(laya.d3.core.material.PBRStandardMaterial.SHADERDEFINE_TILINGOFFSET)}else this._removeShaderDefine(laya.d3.core.material.PBRStandardMaterial.SHADERDEFINE_TILINGOFFSET);this._setColor(17,e)}),t.__init__=function(){t.SHADERDEFINE_DIFFUSETEXTURE=t.shaderDefines.registerDefine("DIFFUSETEXTURE"),t.SHADERDEFINE_METALLICGLOSSTEXTURE=t.shaderDefines.registerDefine("METALLICGLOSSTEXTURE"),t.SHADERDEFINE_SMOOTHNESSSOURCE_DIFFUSETEXTURE_ALPHA=t.shaderDefines.registerDefine("SMOOTHNESSSOURCE_DIFFUSETEXTURE_ALPHA"),t.SHADERDEFINE_NORMALTEXTURE=t.shaderDefines.registerDefine("NORMALTEXTURE"),t.SHADERDEFINE_PARALLAXTEXTURE=t.shaderDefines.registerDefine("PARALLAXTEXTURE"),t.SHADERDEFINE_OCCLUSIONTEXTURE=t.shaderDefines.registerDefine("OCCLUSIONTEXTURE"),t.SHADERDEFINE_EMISSION=t.shaderDefines.registerDefine("EMISSION"),t.SHADERDEFINE_EMISSIONTEXTURE=t.shaderDefines.registerDefine("EMISSIONTEXTURE"),t.SHADERDEFINE_TILINGOFFSET=t.shaderDefines.registerDefine("TILINGOFFSET")},t.SmoothnessSource_MetallicGlossTexture_Alpha=0,t.SmoothnessSource_DiffuseTexture_Alpha=1,t.SHADERDEFINE_DIFFUSETEXTURE=0,t.SHADERDEFINE_NORMALTEXTURE=0,t.SHADERDEFINE_SMOOTHNESSSOURCE_DIFFUSETEXTURE_ALPHA=0,t.SHADERDEFINE_METALLICGLOSSTEXTURE=0,t.SHADERDEFINE_OCCLUSIONTEXTURE=0,t.SHADERDEFINE_PARALLAXTEXTURE=0,t.SHADERDEFINE_EMISSION=0,t.SHADERDEFINE_EMISSIONTEXTURE=0,t.SHADERDEFINE_TILINGOFFSET=0,t.DIFFUSETEXTURE=1,t.METALLICGLOSSTEXTURE=2,t.NORMALTEXTURE=3,t.PARALLAXTEXTURE=4,t.OCCLUSIONTEXTURE=5,t.EMISSIONTEXTURE=6,t.DIFFUSECOLOR=7,t.EMISSIONCOLOR=8,t.METALLIC=9,t.SMOOTHNESS=10,t.SMOOTHNESSSCALE=11,t.SMOOTHNESSSOURCE=12,t.OCCLUSIONSTRENGTH=13,t.NORMALSCALE=14,t.PARALLAXSCALE=15,t.ENABLEEMISSION=16,t.TILINGOFFSET=17,n(t,["shaderDefines",function(){return this.shaderDefines=new Vt(fi.shaderDefines)}]),t}(),Yi=function(e){function t(){this._transformUV=null,t.__super.call(this),this.setShaderName("SIMPLE"),this._setColor(9,new At(.6,.6,.6)),this._setColor(10,new At(1,1,1)),this._setColor(11,new Rt(1,1,1,8)),this._setColor(12,new At(1,1,1)),this._setColor(7,new Rt(1,1,1,1)),this._setNumber(0,.5),this._setColor(15,new Rt(1,1,0,0)),this.renderMode=1}a(t,"laya.d3.core.material.StandardMaterial",e);var o=t.prototype;return o.disableLight=function(){this._addDisablePublicShaderDefine(ci.SHADERDEFINE_POINTLIGHT|ci.SHADERDEFINE_SPOTLIGHT|ci.SHADERDEFINE_DIRECTIONLIGHT)},o.disableFog=function(){this._addDisablePublicShaderDefine(ci.SHADERDEFINE_FOG)},o.onAsynLoaded=function(i,n,a){var r=n[0];if(r.version)e.prototype.onAsynLoaded.call(this,i,n,a);else{var o=n[1],s=r.props;for(var h in s)this[h]=s[h];t._parseStandardMaterial(o,this,r),this._endLoaded()}},o.cloneTo=function(t){e.prototype.cloneTo.call(this,t);var i=t;this._transformUV&&(i._transformUV=this._transformUV.clone())},r(0,o,"ambientColor",function(){return this._getColor(9)},function(e){this._setColor(9,e)}),r(0,o,"ambientTexture",function(){return this._getTexture(5)},function(e){e?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP),this._setTexture(5,e)}),r(0,o,"renderMode",null,function(e){switch(e){case 1:this.renderQueue=2e3,this.depthWrite=!0,this.cull=2,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(t.SHADERDEFINE_ADDTIVEFOG);break;case 2:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(t.SHADERDEFINE_ADDTIVEFOG);break;case 3:this.depthWrite=!0,this.cull=2,this.blend=0,this.renderQueue=2e3,this.alphaTest=!0,this._removeShaderDefine(t.SHADERDEFINE_ADDTIVEFOG);break;case 4:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!0,this._removeShaderDefine(t.SHADERDEFINE_ADDTIVEFOG);break;case 13:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(t.SHADERDEFINE_ADDTIVEFOG);break;case 14:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(t.SHADERDEFINE_ADDTIVEFOG);break;case 15:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(t.SHADERDEFINE_ADDTIVEFOG);break;case 16:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(t.SHADERDEFINE_ADDTIVEFOG);break;case 5:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(t.SHADERDEFINE_ADDTIVEFOG);break;case 6:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(t.SHADERDEFINE_ADDTIVEFOG);break;case 7:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(t.SHADERDEFINE_ADDTIVEFOG);break;case 8:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(t.SHADERDEFINE_ADDTIVEFOG);break;case 9:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(t.SHADERDEFINE_ADDTIVEFOG);break;case 10:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(t.SHADERDEFINE_ADDTIVEFOG);break;case 11:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(t.SHADERDEFINE_ADDTIVEFOG);break;case 12:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(t.SHADERDEFINE_ADDTIVEFOG);break;default:throw new Error("Material:renderMode value error.")}this._conchMaterial&&this._conchMaterial.setRenderMode(e)}),r(0,o,"reflectColor",function(){return this._getColor(12)},function(e){this._setColor(12,e)}),r(0,o,"tilingOffset",function(){return this._getColor(15)},function(e){if(e){var t=e.elements;1!=t[0]||1!=t[1]||0!=t[2]||0!=t[3]?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET)}else this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET);this._setColor(15,e)}),r(0,o,"albedo",function(){return this._getColor(7)},function(e){this._setColor(7,e)}),r(0,o,"diffuseColor",function(){return this._getColor(10)},function(e){this._setColor(10,e)}),r(0,o,"albedoColor",function(){return this._getColor(7)},function(e){this._setColor(7,e)}),r(0,o,"specularColor",function(){return this._getColor(11)},function(e){this._setColor(11,e)}),r(0,o,"diffuseTexture",function(){return this._getTexture(1)},function(e){e?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP),this._setTexture(1,e)}),r(0,o,"normalTexture",function(){return this._getTexture(2)},function(e){e?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP),this._setTexture(2,e)}),r(0,o,"specularTexture",function(){return this._getTexture(3)},function(e){e?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP),this._setTexture(3,e)}),r(0,o,"emissiveTexture",function(){return this._getTexture(4)},function(e){e?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP),this._setTexture(4,e)}),r(0,o,"reflectTexture",function(){return this._getTexture(6)},function(e){e?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP),this._setTexture(6,e)}),r(0,o,"transformUV",function(){return this._transformUV},function(e){this._transformUV=e,this._setMatrix4x4(13,e.matrix),e?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM),this._conchMaterial&&this._conchMaterial.setShaderValue(13,e.matrix.elements,0)}),t.__init__=function(){t.SHADERDEFINE_DIFFUSEMAP=t.shaderDefines.registerDefine("DIFFUSEMAP"),t.SHADERDEFINE_NORMALMAP=t.shaderDefines.registerDefine("NORMALMAP"),t.SHADERDEFINE_SPECULARMAP=t.shaderDefines.registerDefine("SPECULARMAP"),t.SHADERDEFINE_EMISSIVEMAP=t.shaderDefines.registerDefine("EMISSIVEMAP"),t.SHADERDEFINE_AMBIENTMAP=t.shaderDefines.registerDefine("AMBIENTMAP"),t.SHADERDEFINE_REFLECTMAP=t.shaderDefines.registerDefine("REFLECTMAP"),t.SHADERDEFINE_UVTRANSFORM=t.shaderDefines.registerDefine("UVTRANSFORM"),t.SHADERDEFINE_TILINGOFFSET=t.shaderDefines.registerDefine("TILINGOFFSET"),t.SHADERDEFINE_ADDTIVEFOG=t.shaderDefines.registerDefine("ADDTIVEFOG")},t.load=function(e){return i.loader.create(e,null,null,t)},t._parseStandardMaterial=function(e,t,i){var n=i.customProps,a=n.ambientColor;t.ambientColor=new At(a[0],a[1],a[2]);var r=n.diffuseColor;t.diffuseColor=new At(r[0],r[1],r[2]);var o=n.specularColor;t.specularColor=new Rt(o[0],o[1],o[2],o[3]);var s=n.reflectColor;t.reflectColor=new At(s[0],s[1],s[2]);var h=n.albedoColor;h&&(t.albedo=new Rt(h[0],h[1],h[2],h[3]));var l=n.diffuseTexture.texture2D;l&&(t.diffuseTexture=v.getRes(e[l]));var c=n.normalTexture.texture2D;c&&(t.normalTexture=v.getRes(e[c]));var p=n.specularTexture.texture2D;p&&(t.specularTexture=v.getRes(e[p]));var u=n.emissiveTexture.texture2D;u&&(t.emissiveTexture=v.getRes(e[u]));var d=n.ambientTexture.texture2D;d&&(t.ambientTexture=v.getRes(e[d]));var _=n.reflectTexture.texture2D;_&&(t.reflectTexture=v.getRes(e[_]))},t.RENDERMODE_OPAQUE=1,t.RENDERMODE_OPAQUEDOUBLEFACE=2,t.RENDERMODE_CUTOUT=3,t.RENDERMODE_CUTOUTDOUBLEFACE=4,t.RENDERMODE_TRANSPARENT=13,t.RENDERMODE_TRANSPARENTDOUBLEFACE=14,t.RENDERMODE_ADDTIVE=15,t.RENDERMODE_ADDTIVEDOUBLEFACE=16,t.RENDERMODE_DEPTHREAD_TRANSPARENT=5,t.RENDERMODE_DEPTHREAD_TRANSPARENTDOUBLEFACE=6,t.RENDERMODE_DEPTHREAD_ADDTIVE=7,t.RENDERMODE_DEPTHREAD_ADDTIVEDOUBLEFACE=8,t.RENDERMODE_NONDEPTH_TRANSPARENT=9,t.RENDERMODE_NONDEPTH_TRANSPARENTDOUBLEFACE=10,t.RENDERMODE_NONDEPTH_ADDTIVE=11,t.RENDERMODE_NONDEPTH_ADDTIVEDOUBLEFACE=12,t.SHADERDEFINE_DIFFUSEMAP=0,t.SHADERDEFINE_NORMALMAP=0,t.SHADERDEFINE_SPECULARMAP=0,t.SHADERDEFINE_EMISSIVEMAP=0,t.SHADERDEFINE_AMBIENTMAP=0,t.SHADERDEFINE_REFLECTMAP=0,t.SHADERDEFINE_UVTRANSFORM=0,t.SHADERDEFINE_TILINGOFFSET=0,t.SHADERDEFINE_ADDTIVEFOG=0,t.DIFFUSETEXTURE=1,t.NORMALTEXTURE=2,t.SPECULARTEXTURE=3,t.EMISSIVETEXTURE=4,t.AMBIENTTEXTURE=5,t.REFLECTTEXTURE=6,t.ALBEDO=7,t.UVANIAGE=8,t.MATERIALAMBIENT=9,t.MATERIALDIFFUSE=10,t.MATERIALSPECULAR=11,t.MATERIALREFLECT=12,t.UVMATRIX=13,t.UVAGE=14,t.TILINGOFFSET=15,n(t,["defaultMaterial",function(){return this.defaultMaterial=new t},"shaderDefines",function(){return this.shaderDefines=new Vt(fi.shaderDefines)}]),t}(fi),Gi=function(e){function t(){this._diffuseScale1=null,this._diffuseScale2=null,this._diffuseScale3=null,this._diffuseScale4=null,t.__super.call(this),this.setShaderName("Terrain"),this.renderMode=1,this._diffuseScale1=new Nt,this._diffuseScale2=new Nt,this._diffuseScale3=new Nt,this._diffuseScale4=new Nt,this.ambientColor=new At(.6,.6,.6),this.diffuseColor=new At(1,1,1),this.specularColor=new Rt(.2,.2,.2,32)}a(t,"laya.d3.core.material.TerrainMaterial",e);var o=t.prototype;return o.setDiffuseScale1=function(e,t){this._diffuseScale1.x=e,this._diffuseScale1.y=t,this._setColor(6,this._diffuseScale1)},o.setDiffuseScale2=function(e,t){this._diffuseScale2.x=e,this._diffuseScale2.y=t,this._setColor(7,this._diffuseScale2)},o.setDiffuseScale3=function(e,t){this._diffuseScale3.x=e,this._diffuseScale3.y=t,this._setColor(8,this._diffuseScale3)},o.setDiffuseScale4=function(e,t){this._diffuseScale4.x=e,this._diffuseScale4.y=t,this._setColor(9,this._diffuseScale4)},o.setDetailNum=function(e){switch(e){case 1:this._addShaderDefine(laya.d3.core.material.TerrainMaterial.SHADERDEFINE_DETAIL_NUM1),this._removeShaderDefine(laya.d3.core.material.TerrainMaterial.SHADERDEFINE_DETAIL_NUM2),this._removeShaderDefine(laya.d3.core.material.TerrainMaterial.SHADERDEFINE_DETAIL_NUM3),this._removeShaderDefine(laya.d3.core.material.TerrainMaterial.SHADERDEFINE_DETAIL_NUM4);break;case 2:this._addShaderDefine(laya.d3.core.material.TerrainMaterial.SHADERDEFINE_DETAIL_NUM2),this._removeShaderDefine(laya.d3.core.material.TerrainMaterial.SHADERDEFINE_DETAIL_NUM1),this._removeShaderDefine(laya.d3.core.material.TerrainMaterial.SHADERDEFINE_DETAIL_NUM3),this._removeShaderDefine(laya.d3.core.material.TerrainMaterial.SHADERDEFINE_DETAIL_NUM4);break;case 3:this._addShaderDefine(laya.d3.core.material.TerrainMaterial.SHADERDEFINE_DETAIL_NUM3),this._removeShaderDefine(laya.d3.core.material.TerrainMaterial.SHADERDEFINE_DETAIL_NUM1),this._removeShaderDefine(laya.d3.core.material.TerrainMaterial.SHADERDEFINE_DETAIL_NUM2),this._removeShaderDefine(laya.d3.core.material.TerrainMaterial.SHADERDEFINE_DETAIL_NUM4);break;case 4:this._addShaderDefine(laya.d3.core.material.TerrainMaterial.SHADERDEFINE_DETAIL_NUM4),this._removeShaderDefine(laya.d3.core.material.TerrainMaterial.SHADERDEFINE_DETAIL_NUM1),this._removeShaderDefine(laya.d3.core.material.TerrainMaterial.SHADERDEFINE_DETAIL_NUM2),this._removeShaderDefine(laya.d3.core.material.TerrainMaterial.SHADERDEFINE_DETAIL_NUM3)}},o.disableLight=function(){this._addDisablePublicShaderDefine(ci.SHADERDEFINE_POINTLIGHT|ci.SHADERDEFINE_SPOTLIGHT|ci.SHADERDEFINE_DIRECTIONLIGHT)},o.setShaderName=function(t){e.prototype.setShaderName.call(this,t)},r(0,o,"renderMode",null,function(e){switch(e){case 1:this.renderQueue=2e3,this.depthWrite=!0,this.cull=2,this.blend=0,this.depthTest=513;break;case 2:this.renderQueue=2e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.depthTest=515;break;default:throw new Error("TerrainMaterial:renderMode value error.")}this._conchMaterial&&this._conchMaterial.setRenderMode(e)}),r(0,o,"diffuseTexture2",function(){return this._getTexture(3)},function(e){this._setTexture(3,e)}),r(0,o,"ambientColor",function(){return this._getColor(10)},function(e){this._setColor(10,e)}),r(0,o,"diffuseTexture4",function(){return this._getTexture(5)},function(e){this._setTexture(5,e)}),r(0,o,"diffuseColor",function(){return this._getColor(11)},function(e){this._setColor(11,e)}),r(0,o,"diffuseTexture1",function(){return this._getTexture(2)},function(e){this._setTexture(2,e)}),r(0,o,"specularColor",function(){return this._getColor(12)},function(e){this._setColor(12,e)}),r(0,o,"diffuseTexture3",function(){return this._getTexture(4)},function(e){this._setTexture(4,e)}),r(0,o,"splatAlphaTexture",function(){return this._getTexture(0)},function(e){this._setTexture(0,e)}),r(0,o,"normalTexture",function(){return this._getTexture(1)},function(e){this._setTexture(1,e)}),t.__init__=function(){t.SHADERDEFINE_DETAIL_NUM1=t.shaderDefines.registerDefine("DETAIL_NUM1"),t.SHADERDEFINE_DETAIL_NUM2=t.shaderDefines.registerDefine("DETAIL_NUM2"),t.SHADERDEFINE_DETAIL_NUM4=t.shaderDefines.registerDefine("DETAIL_NUM4"),t.SHADERDEFINE_DETAIL_NUM3=t.shaderDefines.registerDefine("DETAIL_NUM3")},t.load=function(e){return i.loader.create(e,null,null,t)},t.RENDERMODE_OPAQUE=1,t.RENDERMODE_TRANSPARENT=2,t.SPLATALPHATEXTURE=0,t.NORMALTEXTURE=1,t.DIFFUSETEXTURE1=2,t.DIFFUSETEXTURE2=3,t.DIFFUSETEXTURE3=4,t.DIFFUSETEXTURE4=5,t.DIFFUSESCALE1=6,t.DIFFUSESCALE2=7,t.DIFFUSESCALE3=8,t.DIFFUSESCALE4=9,t.MATERIALAMBIENT=10,t.MATERIALDIFFUSE=11,t.MATERIALSPECULAR=12,t.SHADERDEFINE_DETAIL_NUM1=0,t.SHADERDEFINE_DETAIL_NUM2=0,t.SHADERDEFINE_DETAIL_NUM3=0,t.SHADERDEFINE_DETAIL_NUM4=0,n(t,["defaultMaterial",function(){return this.defaultMaterial=new t},"shaderDefines",function(){return this.shaderDefines=new Vt(fi.shaderDefines)}]),t}(fi),ji=function(e){function t(){this._useVertexDeep=!1,t.__super.call(this),this.setShaderName("Water")}a(t,"laya.d3.core.material.WaterMaterial",e);var o=t.prototype;return o.disableFog=function(){this._addDisablePublicShaderDefine(ci.SHADERDEFINE_FOG)},o.onAsynLoaded=function(t,i,n){e.prototype.onAsynLoaded.call(this,t,i,n)},r(0,o,"diffuseTexture",function(){return this._getTexture(1)},function(e){this._setTexture(1,e)}),r(0,o,"normalTexture",function(){return this._getTexture(2)},function(e){this._setTexture(2,e)}),r(0,o,"underWaterTexture",function(){return this._getTexture(3)},function(e){this._setTexture(3,e)}),r(0,o,"deepColorTexture",function(){return this._getTexture(10)},function(e){this._setTexture(10,e)}),r(0,o,"useFoam",null,function(e){e?this._addShaderDefine(t.SHADERDEFINE_USE_FOAM):this._removeShaderDefine(t.SHADERDEFINE_USE_FOAM)}),r(0,o,"skyTexture",function(){return this._getTexture(11)},function(e){this._setTexture(11,e)}),r(0,o,"deepScale",function(){return this._getNumber(20)},function(e){this._setNumber(20,e)}),r(0,o,"detailTexture",function(){return this._getTexture(9)},function(e){this._setTexture(9,e)}),r(0,o,"foamTexture",function(){return this._getTexture(17)},function(e){this._setTexture(17,e)}),r(0,o,"waterInfoTexture",function(){return this._getTexture(16)},function(e){this._setTexture(16,e)}),r(0,o,"vertexDispTexture",function(){return this._getTexture(4)},function(e){this._setTexture(4,e)}),r(0,o,"currentTm",function(){return this._getNumber(8)},function(e){this._setNumber(8,e)}),r(0,o,"waveInfo",function(){return this._getBuffer(12)},function(e){this._setBuffer(12,e)}),r(0,o,"waveInfoD",function(){return this._getBuffer(13)},function(e){this._setBuffer(13,e)}),r(0,o,"waveMainDir",function(){return this._getNumber(14)},function(e){this._setNumber(14,e*Math.PI/180)}),r(0,o,"geoWaveUVScale",function(){return this._getNumber(18)},function(e){this._setNumber(18,e)}),r(0,o,"windSpeed",function(){return 0},function(e){}),r(0,o,"scrsize",null,function(e){this._setBuffer(15,e)}),r(0,o,"seaColor",function(){return this._getBuffer(19)},function(e){this._setBuffer(19,e)}),r(0,o,"useVertexDeep",function(){return this._useVertexDeep},function(e){this._useVertexDeep=e,e?this._addShaderDefine(t.SHADERDEFINE_USEVERTEXHEIGHT):this._removeShaderDefine(t.SHADERDEFINE_USEVERTEXHEIGHT)}),r(0,o,"windDir",function(){return 0},function(e){}),r(0,o,"useRefractTexture",null,function(e){e?this._addShaderDefine(t.SHADERDEFINE_USE_REFRACT_TEX):this._removeShaderDefine(t.SHADERDEFINE_USE_REFRACT_TEX)}),r(0,o,"renderMode",null,function(e){switch(e){case 1:this.renderQueue=2e3,this.depthWrite=!0,this.cull=2,this.blend=0,this.alphaTest=!1;break;case 2:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!1;break;case 3:this.depthWrite=!0,this.cull=2,this.blend=0,this.renderQueue=2e3;break;case 13:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771;break;default:throw new Error("PBRMaterial:renderMode value error.")}}),t.__init__=function(){t.SHADERDEFINE_CUBE_ENV=t.shaderDefines.registerDefine("CUBE_ENV"),t.SHADERDEFINE_HDR_ENV=t.shaderDefines.registerDefine("HDR_ENV"),t.SHADERDEFINE_SHOW_NORMAL=t.shaderDefines.registerDefine("SHOW_NORMAL"),t.SHADERDEFINE_USEVERTEXHEIGHT=t.shaderDefines.registerDefine("USE_VERTEX_DEEPINFO"),t.SHADERDEFINE_USE_FOAM=t.shaderDefines.registerDefine("USE_FOAM"),t.SHADERDEFINE_USE_REFRACT_TEX=t.shaderDefines.registerDefine("USE_REFR_TEX")},t.load=function(e){return i.loader.create(e,null,null,t)},t.DIFFUSETEXTURE=1,t.NORMALTEXTURE=2,t.UNDERWATERTEXTURE=3,t.VERTEXDISPTEXTURE=4,t.UVANIAGE=5,t.UVMATRIX=6,t.UVAGE=7,t.CURTM=8,t.DETAILTEXTURE=9,t.DEEPCOLORTEXTURE=10,t.SKYTEXTURE=11,t.WAVEINFO=12,t.WAVEINFOD=13,t.WAVEMAINDIR=14,t.SCRSIZE=15,t.WATERINFO=16,t.FOAMTEXTURE=17,t.GEOWAVE_UV_SCALE=18,t.SEA_COLOR=19,t.WAVEINFODEEPSCALE=20,t.SHADERDEFINE_SHOW_NORMAL=0,t.SHADERDEFINE_CUBE_ENV=0,t.SHADERDEFINE_HDR_ENV=0,t.SHADERDEFINE_USE_FOAM=0,t.SHADERDEFINE_USE_REFRACT_TEX=0,t.SHADERDEFINE_USEVERTEXHEIGHT=0,t.RENDERMODE_OPAQUE=1,t.RENDERMODE_OPAQUEDOUBLEFACE=2,t.RENDERMODE_CUTOUT=3,t.RENDERMODE_CUTOUTDOUBLEFACE=4,t.RENDERMODE_TRANSPARENT=13,n(t,["defaultMaterial",function(){return this.defaultMaterial=new t},"shaderDefines",function(){return this.shaderDefines=new Vt(fi.shaderDefines)}]),t}(fi),Wi=function(e){function t(e,i,n,a){this._indexType=null,this._indexTypeByteCount=0,this._indexCount=0,this._canRead=!1,void 0===n&&(n=35044),void 0===a&&(a=!1),t.__super.call(this),this._indexType=e,this._indexCount=i,this._bufferUsage=n,this._bufferType=34963,this._canRead=a;var r=0;if("ushort"==e)this._indexTypeByteCount=2;else{if("ubyte"!=e)throw new Error("unidentification index type.");this._indexTypeByteCount=1}r=this._indexTypeByteCount*i,this._byteLength=r,this._bind(),d._gl.bufferData(this._bufferType,r,this._bufferUsage),a?("ushort"==e?this._buffer=new Uint16Array(i):"ubyte"==e&&(this._buffer=new Uint8Array(i)),this.memorySize=2*r):this.memorySize=r}a(t,"laya.d3.graphics.IndexBuffer3D",e);var i=t.prototype;return i.setData=function(e,t,i,n){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=4294967295);var a=0;if("ushort"==this._indexType?(a=2,0===i&&4294967295===n||(e=new Uint16Array(e.buffer,i*a,n))):"ubyte"==this._indexType&&(a=1,0===i&&4294967295===n||(e=new Uint8Array(e.buffer,i*a,n))),this._bind(),d._gl.bufferSubData(this._bufferType,t*a,e),this._canRead)if(0!==t||0!==i||4294967295!==n){var r=this._buffer.length-t;n>r&&(n=r);for(var o=0;o<n;o++)this._buffer[t+o]=e[o]}else this._buffer=e},i.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},i.disposeResource=function(){e.prototype.disposeResource.call(this),this._buffer=null,this.memorySize=0},r(0,i,"indexType",function(){return this._indexType}),r(0,i,"indexTypeByteCount",function(){return this._indexTypeByteCount}),r(0,i,"indexCount",function(){return this._indexCount}),r(0,i,"canRead",function(){return this._canRead}),t.INDEXTYPE_UBYTE="ubyte",t.INDEXTYPE_USHORT="ushort",t.create=function(e,i,n,a){return void 0===n&&(n=35044),void 0===a&&(a=!1),new t(e,i,n,a)},t}(d),qi=function(e){function t(e,i,n,a){this._vertexDeclaration=null,this._vertexCount=0,this._canRead=!1,void 0===a&&(a=!1),t.__super.call(this),this._vertexDeclaration=e,this._vertexCount=i,this._bufferUsage=n,this._bufferType=34962,this._canRead=a,this.memorySize=this._byteLength=this._vertexDeclaration.vertexStride*i,this._bind(),d._gl.bufferData(this._bufferType,this._byteLength,this._bufferUsage),a&&(this._buffer=new Float32Array(this._byteLength/4))}a(t,"laya.d3.graphics.VertexBuffer3D",e);var i=t.prototype;return i.bindWithIndexBuffer=function(e){e&&e._bind(),this._bind()},i.setData=function(e,t,i,n){if(void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=4294967295),0===i&&4294967295===n||(e=new Float32Array(e.buffer,4*i,n)),this._bind(),d._gl.bufferSubData(this._bufferType,4*t,e),this._canRead)if(0!==t||0!==i||4294967295!==n){var a=this._buffer.length-t;n>a&&(n=a);for(var r=0;r<n;r++)this._buffer[t+r]=e[r]}else this._buffer=e},i.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},i.disposeResource=function(){for(var t=A.mainContext,i=this._vertexDeclaration.getVertexElements(),n=d._enableAtributes,a=0,r=i.length;a<r;a++)n[a]===this._glBuffer&&(t.disableVertexAttribArray(a),n[a]=null);e.prototype.disposeResource.call(this),this._buffer=null,this._vertexDeclaration=null,this.memorySize=0},r(0,i,"vertexDeclaration",function(){return this._vertexDeclaration}),r(0,i,"vertexCount",function(){return this._vertexCount}),r(0,i,"canRead",function(){return this._canRead}),t.create=function(e,i,n,a){return void 0===n&&(n=35044),void 0===a&&(a=!1),new t(e,i,n,a)},t}(d),Ki=function(e){function t(){t.__super.call(this),this.setShaderName("PARTICLESHURIKEN"),this.renderMode=6}a(t,"laya.d3.core.particleShuriKen.ShurikenParticleMaterial",e);var o=t.prototype;return o.onAsynLoaded=function(i,n,a){var r=n[0];if(r.version)e.prototype.onAsynLoaded.call(this,i,n,a);else{var o=n[1],s=r.props;for(var h in s)this[h]=s[h];t._parseShurikenParticleMaterial(o,this,r),this._endLoaded()}},r(0,o,"renderMode",null,function(e){switch(e){case 1:this.renderQueue=2e3,this.depthWrite=!0,this.cull=2,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(t.SHADERDEFINE_ADDTIVEFOG);break;case 2:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(t.SHADERDEFINE_ADDTIVEFOG);break;case 3:this.depthWrite=!0,this.cull=2,this.blend=0,this.renderQueue=2e3,this.alphaTest=!0,this._removeShaderDefine(t.SHADERDEFINE_ADDTIVEFOG);break;case 4:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!0,this._removeShaderDefine(t.SHADERDEFINE_ADDTIVEFOG);break;case 13:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(t.SHADERDEFINE_ADDTIVEFOG);break;case 14:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(t.SHADERDEFINE_ADDTIVEFOG);break;case 15:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(t.SHADERDEFINE_ADDTIVEFOG);break;case 16:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(t.SHADERDEFINE_ADDTIVEFOG);break;case 5:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(t.SHADERDEFINE_ADDTIVEFOG);break;case 6:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(t.SHADERDEFINE_ADDTIVEFOG);break;case 7:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(t.SHADERDEFINE_ADDTIVEFOG);break;case 8:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(t.SHADERDEFINE_ADDTIVEFOG);break;case 9:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(t.SHADERDEFINE_ADDTIVEFOG);break;case 10:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(t.SHADERDEFINE_ADDTIVEFOG);break;case 11:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(t.SHADERDEFINE_ADDTIVEFOG);break;case 12:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(t.SHADERDEFINE_ADDTIVEFOG);break;default:throw new Error("Material:renderMode value error.")}this._conchMaterial&&this._conchMaterial.setRenderMode(e)}),r(0,o,"tintColor",function(){return this._getColor(2)},function(e){e?this._addShaderDefine(laya.d3.core.particleShuriKen.ShurikenParticleMaterial.SHADERDEFINE_TINTCOLOR):this._removeShaderDefine(laya.d3.core.particleShuriKen.ShurikenParticleMaterial.SHADERDEFINE_TINTCOLOR),this._setColor(2,e)}),r(0,o,"tilingOffset",function(){return this._getColor(3)},function(e){if(e){var t=e.elements;1!=t[0]||1!=t[1]||0!=t[2]||0!=t[3]?this._addShaderDefine(laya.d3.core.particleShuriKen.ShurikenParticleMaterial.SHADERDEFINE_TILINGOFFSET):this._removeShaderDefine(laya.d3.core.particleShuriKen.ShurikenParticleMaterial.SHADERDEFINE_TILINGOFFSET)}else this._removeShaderDefine(laya.d3.core.particleShuriKen.ShurikenParticleMaterial.SHADERDEFINE_TILINGOFFSET);this._setColor(3,e)}),r(0,o,"diffuseTexture",function(){return this._getTexture(1)},function(e){e?this._addShaderDefine(laya.d3.core.particleShuriKen.ShurikenParticleMaterial.SHADERDEFINE_DIFFUSEMAP):this._removeShaderDefine(laya.d3.core.particleShuriKen.ShurikenParticleMaterial.SHADERDEFINE_DIFFUSEMAP),this._setTexture(1,e)}),t.__init__=function(){t.SHADERDEFINE_DIFFUSEMAP=t.shaderDefines.registerDefine("DIFFUSEMAP"),t.SHADERDEFINE_TINTCOLOR=t.shaderDefines.registerDefine("TINTCOLOR"),t.SHADERDEFINE_ADDTIVEFOG=t.shaderDefines.registerDefine("ADDTIVEFOG"),t.SHADERDEFINE_TILINGOFFSET=t.shaderDefines.registerDefine("TILINGOFFSET")},t.load=function(e){return i.loader.create(e,null,null,t)},t._parseShurikenParticleMaterial=function(e,t,i){var n=i.customProps,a=n.diffuseTexture.texture2D;a&&(t.diffuseTexture=v.getRes(e[a]));var r=n.tintColor;r&&(t.tintColor=new Rt(r[0],r[1],r[2],r[3]))},t.RENDERMODE_OPAQUE=1,t.RENDERMODE_OPAQUEDOUBLEFACE=2,t.RENDERMODE_CUTOUT=3,t.RENDERMODE_CUTOUTDOUBLEFACE=4,t.RENDERMODE_TRANSPARENT=13,t.RENDERMODE_TRANSPARENTDOUBLEFACE=14,t.RENDERMODE_ADDTIVE=15,t.RENDERMODE_ADDTIVEDOUBLEFACE=16,t.RENDERMODE_DEPTHREAD_TRANSPARENT=5,t.RENDERMODE_DEPTHREAD_TRANSPARENTDOUBLEFACE=6,t.RENDERMODE_DEPTHREAD_ADDTIVE=7,t.RENDERMODE_DEPTHREAD_ADDTIVEDOUBLEFACE=8,t.RENDERMODE_NONDEPTH_TRANSPARENT=9,t.RENDERMODE_NONDEPTH_TRANSPARENTDOUBLEFACE=10,t.RENDERMODE_NONDEPTH_ADDTIVE=11,t.RENDERMODE_NONDEPTH_ADDTIVEDOUBLEFACE=12,t.SHADERDEFINE_DIFFUSEMAP=0,t.SHADERDEFINE_TINTCOLOR=0,t.SHADERDEFINE_TILINGOFFSET=0,t.SHADERDEFINE_ADDTIVEFOG=0,t.DIFFUSETEXTURE=1,t.TINTCOLOR=2,t.TILINGOFFSET=3,n(t,["defaultMaterial",function(){return this.defaultMaterial=new t},"shaderDefines",function(){return this.shaderDefines=new Vt(fi.shaderDefines)}]),t}(fi),Ji=function(e){function t(){t.__super.call(this),this.setShaderName("Trail"),this._setColor(2,new Rt(1,1,1,1))}a(t,"laya.d3.core.trail.TrailMaterial",fi);var o=t.prototype;return r(0,o,"tintColor",function(){return this._getColor(2)},function(e){this._setColor(2,e)}),r(0,o,"diffuseTexture",function(){return this._getTexture(1)},function(e){e?this._addShaderDefine(laya.d3.core.trail.TrailMaterial.SHADERDEFINE_DIFFUSETEXTURE):this._removeShaderDefine(laya.d3.core.trail.TrailMaterial.SHADERDEFINE_DIFFUSETEXTURE),this._setTexture(1,e)}),r(0,o,"tilingOffset",function(){return this._getColor(3)},function(e){if(e){var t=e.elements;1!=t[0]||1!=t[1]||0!=t[2]||0!=t[3]?this._addShaderDefine(laya.d3.core.trail.TrailMaterial.SHADERDEFINE_TILINGOFFSET):this._removeShaderDefine(laya.d3.core.trail.TrailMaterial.SHADERDEFINE_TILINGOFFSET)}else this._removeShaderDefine(laya.d3.core.trail.TrailMaterial.SHADERDEFINE_TILINGOFFSET);this._setColor(3,e)}),t.__init__=function(){t.SHADERDEFINE_DIFFUSETEXTURE=t.shaderDefines.registerDefine("DIFFUSETEXTURE"),t.SHADERDEFINE_TILINGOFFSET=t.shaderDefines.registerDefine("TILINGOFFSET")},t.load=function(e){return i.loader.create(e,null,null,t)},t.SHADERDEFINE_DIFFUSETEXTURE=0,t.SHADERDEFINE_TILINGOFFSET=0,t.DIFFUSETEXTURE=1,t.TINTCOLOR=2,t.TILINGOFFSET=3,n(t,["defaultMaterial",function(){return this.defaultMaterial=new t},"shaderDefines",function(){return this.shaderDefines=new Vt(fi.shaderDefines)}]),t}(),Zi=(function(e){function t(){this._animationSprites=null,this._animationSpritesInitLocalMatrix=null,this._tempCurAnimationData=null,this._curOriginalData=null,this._lastFrameIndex=-1,this._curAnimationDatas=null,t.__super.call(this),this._animationSprites=[],this._animationSpritesInitLocalMatrix=[]}a(t,"laya.d3.component.animation.RigidAnimations",e);var n=t.prototype;n._init=function(){for(var e=this._templet.getNodes(this.currentAnimationClipIndex),t=this._owner,i=e.length,n=0,a=new Uint16Array(this._templet.getPublicExtData()),r=0;r<i;r++){var o=a.slice(n+1,n+1+a[n]);n+=a[n]+1;for(var s=1;s<o.length;s++){o[s];t=t._childs[o[s]]}var h=t.getChildByName(e[r].name);if(!h)break;this._animationSprites[r]=h;var l=this._animationSpritesInitLocalMatrix[r];l||(l=this._animationSpritesInitLocalMatrix[r]=new Ct),h.transform.localMatrix.cloneTo(l),t=this._owner}},n._animtionPlay=function(){this._templet.loaded?this._init():this._templet.once("loaded",this,this._init)},n._animtionStop=function(){if(this._lastFrameIndex=-1,this._player.returnToZeroStopped){this._curAnimationDatas=null;for(var e=0;e<this._animationSprites.length;e++)this._animationSprites[e].transform.localMatrix=this._animationSpritesInitLocalMatrix[e]}},n._effectAnimation=function(e){for(var t=0,i=this._animationSprites.length;t<i;t++){for(var n=this._animationSprites[t],a=n.transform.localMatrix,r=a.elements,o=0;o<16;o++)r[o]=this._curAnimationDatas[16*t+o];n.transform.localMatrix=a}},n._load=function(t){e.prototype._load.call(this,t),this._player.on("stopped",this,this._animtionStop),this._player.on("played",this,this._animtionPlay)},n._update=function(e){if(2===this._player.state&&this._templet&&this._templet.loaded){var t=this._player.playbackRate*i.timer.scale,n=this._player.cachePlayRate,a=this._player.isCache&&t>=n,r=a?this.currentFrameIndex:-1;if(-1===r||this._lastFrameIndex!==r){var o=this.currentAnimationClipIndex,s=this._templet.getNodes(o),h=this._templet._animationDatasCache;if(a){var l=this._templet.getAnimationDataWithCache(n,h,o,r);if(l)return this._curAnimationDatas=l,this._lastFrameIndex=r,void this._effectAnimation(s)}var c=16*s.length;a?this._curAnimationDatas=new Float32Array(c):(this._tempCurAnimationData||(this._tempCurAnimationData=new Float32Array(c)),this._curAnimationDatas=this._tempCurAnimationData),this._curOriginalData||(this._curOriginalData=new Float32Array(this._templet.getTotalkeyframesLength(o))),a?this._templet.getOriginalData(o,this._curOriginalData,this._player._fullFrames[o],r,this._player.currentFrameTime):this._templet.getOriginalDataUnfixedRate(o,this._curOriginalData,this._player.currentPlayTime),Jt._computeRootAnimationData(s,this._curOriginalData,this._curAnimationDatas),a&&this._templet.setAnimationDataWithCache(n,h,o,r,this._curAnimationDatas),this._lastFrameIndex=r,this._effectAnimation(s)}}},n._unload=function(t){e.prototype._unload.call(this,t),this._animationSprites=null,this._animationSpritesInitLocalMatrix=null,this._tempCurAnimationData=null,this._curOriginalData=null,this._curAnimationDatas=null},r(0,n,"url",null,function(e){console.log("Warning: discard property,please use templet property instead.");var t=i.loader.create(e,null,null,h);this._templet!==t&&(0!==this._player.state&&this._player.stop(!0),this._templet=t,this._player.templet=t,this._curOriginalData=null,this._curAnimationDatas=null,this._tempCurAnimationData=null,this._templet._animationDatasCache||(this._templet._animationDatasCache=[]),this.event("animationchanged",this))}),r(0,n,"templet",e.prototype._$get_templet,function(e){this._templet!==e&&(0!==this._player.state&&this._player.stop(!0),this._templet=e,this._player.templet=e,this._curOriginalData=null,this._curAnimationDatas=null,this._tempCurAnimationData=null,this._templet._animationDatasCache||(this._templet._animationDatasCache=[]),this.event("animationchanged",this))})}(bi),function(e){function t(){this._tempCurAnimationData=null,this._tempCurBonesData=null,this._curOriginalData=null,this._lastFrameIndex=-1,this._curMeshAnimationData=null,this._curBonesDatas=null,this._curAnimationDatas=null,this._ownerMesh=null,this._boneIndexToMeshList=null,this._oldVersion=!1,t.__super.call(this),this._boneIndexToMeshList=[]}a(t,"laya.d3.component.animation.SkinAnimations",e);var n=t.prototype;return n._computeBoneIndexToMeshOnTemplet=function(){this._templet.loaded?this._computeBoneIndexToMeshOnMesh():this._templet.once("loaded",this,this._computeBoneIndexToMeshOnMesh)},n._computeBoneIndexToMeshOnMesh=function(){"LAYAANIMATION:02"===this._templet._aniVersion?this._oldVersion=!1:this._oldVersion=!0;var e=this._owner.meshFilter.sharedMesh;e.loaded?this._computeBoneIndexToMesh(e):e.on("loaded",this,this._computeBoneIndexToMesh)},n._computeBoneIndexToMesh=function(e){var t=e._boneNames;if(t)for(var i=t.length,n=this._templet._anis,a=0,r=n.length;a<r;a++){var o=this._boneIndexToMeshList[a];o||(o=this._boneIndexToMeshList[a]=[]),o.length=i;for(var s=n[a],h=0;h<i;h++)o[h]=s.bone3DMap[t[h]]}},n._getAnimationDatasWithCache=function(e,t,i,n,a){var r=i[n];if(r){var o=r[e];if(o){var s=o[t.id];return s?s[a]:null}return null}return null},n._setAnimationDatasWithCache=function(e,t,i,n,a,r){var o=i[n]||(i[n]={}),s=o[e]||(o[e]={});(s[t.id]||(s[t.id]=[]))[a]=r},n._onAnimationPlayMeshLoaded=function(){for(var e=this._ownerMesh.meshRender._renderElements,t=0,i=e.length;t<i;t++)e[t]._canDynamicBatch=!1},n._onAnimationPlay=function(){this._ownerMesh._render._addShaderDefine(vn.SHADERDEFINE_BONE);var e=this._ownerMesh.meshFilter.sharedMesh;e.loaded?this._onAnimationPlayMeshLoaded():e.once("loaded",this,this._onAnimationPlayMeshLoaded)},n._onAnimationStop=function(){this._lastFrameIndex=-1,this._player.returnToZeroStopped&&(this._curBonesDatas=null,this._curAnimationDatas=null,this._ownerMesh._render._removeShaderDefine(vn.SHADERDEFINE_BONE));for(var e=this._ownerMesh.meshRender._renderElements,t=0,i=e.length;t<i;t++)e[t]._canDynamicBatch=!0},n._load=function(t){e.prototype._load.call(this,t),this._ownerMesh=t,this._player.on("played",this,this._onAnimationPlay),this._player.on("stopped",this,this._onAnimationStop),this._owner.meshFilter.on("meshchanged",this,this._computeBoneIndexToMeshOnTemplet)},n._update=function(e){var n=this._ownerMesh.meshFilter.sharedMesh;if(2===this._player.state&&this._templet&&this._templet.loaded&&n.loaded){var a=this._player.playbackRate*i.timer.scale,r=this._player.cachePlayRate,o=this._player.isCache&&a>=r,s=o?this.currentFrameIndex:-1;if(-1===s||this._lastFrameIndex!==s){var h=this.currentAnimationClipIndex,l=this._templet._animationDatasCache[0],c=this._templet._animationDatasCache[1];if(o){var p=this._getAnimationDatasWithCache(r,n,c,h,s);if(p)return this._curAnimationDatas=p,this._curBonesDatas=this._templet.getAnimationDataWithCache(r,l,h,s),void(this._lastFrameIndex=s)}var u=!1;o&&(this._curBonesDatas=this._templet.getAnimationDataWithCache(r,l,h,s),u=!!this._curBonesDatas);var d=this._templet.getNodes(h),_=16*d.length,m=n.InverseAbsoluteBindPoses;this._oldVersion?this._curMeshAnimationData||(this._curMeshAnimationData=new Float32Array(_)):this._curMeshAnimationData||(this._curMeshAnimationData=new Float32Array(16*m.length));var f,g,y=0,v=0,x=0,b=n.getSubMeshCount();if(o){for(this._curAnimationDatas=[],this._curAnimationDatas.length=b,y=0;y<b;y++)for(f=this._curAnimationDatas[y]=[],x=(g=n.getSubMesh(y))._boneIndicesList.length,f.length=x,v=0;v<x;v++)f[v]=new Float32Array(16*g._boneIndicesList[v].length);u||(this._curBonesDatas=new Float32Array(_))}else{if(!this._tempCurAnimationData)for(this._tempCurAnimationData=[],this._tempCurAnimationData.length=b,y=0;y<b;y++)for(f=this._tempCurAnimationData[y]=[],x=(g=n.getSubMesh(y))._boneIndicesList.length,f.length=x,v=0;v<x;v++)f[v]=new Float32Array(16*g._boneIndicesList[v].length);this._tempCurBonesData||(this._tempCurBonesData=new Float32Array(_)),this._curAnimationDatas=this._tempCurAnimationData,this._curBonesDatas=this._tempCurBonesData}if(this._curOriginalData||(this._curOriginalData=new Float32Array(this._templet.getTotalkeyframesLength(h))),o?this._templet.getOriginalData(h,this._curOriginalData,this._player._fullFrames[h],s,this._player.currentFrameTime):this._templet.getOriginalDataUnfixedRate(h,this._curOriginalData,this._player.currentPlayTime),this._oldVersion)o&&u?Jt._computeAnimationDatasByArrayAndMatrixFastOld(m,this._curBonesDatas,this._curMeshAnimationData):Jt._computeBoneAndAnimationDatasByBindPoseMatrxixOld(d,this._curOriginalData,m,this._curBonesDatas,this._curMeshAnimationData);else{var w=this._boneIndexToMeshList[h];o&&u?Jt._computeAnimationDatasByArrayAndMatrixFast(m,this._curBonesDatas,this._curMeshAnimationData,w):Jt._computeBoneAndAnimationDatasByBindPoseMatrxix(d,this._curOriginalData,m,this._curBonesDatas,this._curMeshAnimationData,w)}for(y=0;y<b;y++){var S=n.getSubMesh(y)._boneIndicesList;for(x=S.length,f=this._curAnimationDatas[y],v=0;v<x;v++)t._splitAnimationDatas(S[v],this._curMeshAnimationData,f[v])}o&&(this._setAnimationDatasWithCache(r,n,c,h,s,this._curAnimationDatas),u||this._templet.setAnimationDataWithCache(r,l,h,s,this._curBonesDatas)),this._lastFrameIndex=s}}},n._preRenderUpdate=function(e){var t=e.renderElement.renderObj;this._curAnimationDatas?t._skinAnimationDatas=this._curAnimationDatas[t._indexInMesh]:t._skinAnimationDatas=null},n._unload=function(t){2==this.player.state&&this._ownerMesh._render._removeShaderDefine(vn.SHADERDEFINE_BONE),this._templet&&!this._templet.loaded&&this._templet.off("loaded",this,this._computeBoneIndexToMeshOnMesh);var i=this._ownerMesh.meshFilter.sharedMesh;i.loaded||i.off("loaded",this,this._onAnimationPlayMeshLoaded),e.prototype._unload.call(this,t),this._tempCurAnimationData=null,this._tempCurBonesData=null,this._curOriginalData=null,this._curMeshAnimationData=null,this._curBonesDatas=null,this._curAnimationDatas=null,this._ownerMesh=null},r(0,n,"curBonesDatas",function(){return this._curBonesDatas}),r(0,n,"templet",e.prototype._$get_templet,function(e){this._templet!==e&&(0!==this._player.state&&this._player.stop(!0),this._templet=e,this._player.templet=e,this._computeBoneIndexToMeshOnTemplet(),this._curOriginalData=null,this._curMeshAnimationData=null,this._tempCurBonesData=null,this._tempCurAnimationData=null,this._templet._animationDatasCache||(this._templet._animationDatasCache=[[],[]]),this.event("animationchanged",this))}),t._splitAnimationDatas=function(e,t,i){for(var n=0,a=e.length,r=0;n<a;n++)for(var o=0;o<16;o++,r++)i[r]=t[(e[n]<<4)+o]},t}(bi)),Qi=function(e){function t(){this._size=null,this._transformOrientedBoundBox=null,this.center=null,t.__super.call(this),this._needUpdate=!1}a(t,"laya.d3.component.physics.BoxCollider",Si);var i=t.prototype;return i._updateCollider=function(){if(this._needUpdate){var e=this._transformOrientedBoundBox.transformation,i=this._owner.transform,n=i.rotation,a=i.scale,r=this.center.elements;0===r[0]&&0===r[1]&&0===r[2]?Ct.createAffineTransformation(i.position,n,At.ONE,e):(At.multiply(this.center,a,t._deviationV3),At.transformQuat(t._deviationV3,n,t._deviationV3),At.add(i.position,t._deviationV3,t._deviationV3),Ct.createAffineTransformation(t._deviationV3,n,At.ONE,e)),this._transformOrientedBoundBox.transformation=e;var o=this._transformOrientedBoundBox.extents.elements,s=this._size.elements,h=a.elements;o[0]=.5*s[0]*h[0],o[1]=.5*s[1]*h[1],o[2]=.5*s[2]*h[2],this._needUpdate=!1}},i._onWorldMatrixChanged=function(){this._needUpdate=!0;for(var e in this._runtimeCollisonMap)this._runtimeCollisonTestMap[e]=!0,this._runtimeCollisonMap[e]._runtimeCollisonTestMap[this.id]=!0},i._initialize=function(e){laya.d3.component.Component3D.prototype._initialize.call(this,e),this._transformOrientedBoundBox=new kt(new At,new Ct),this._size=new At,this.center=new At,e.transform.on("worldmatrixneedchanged",this,this._onWorldMatrixChanged),this._needUpdate=!0},i._getType=function(){return 1},i._collisonTo=function(e){switch(e._getType()){case 0:return 0!==this.boundBox.containsSphere(e.boundSphere);case 1:return 0!==this.boundBox.containsOrientedBoundBox(e.boundBox);case 2:var t=e;if(0!==this.boundBox.containsBoundBox(t._boundBox)){for(var i=e.mesh._positions,n=0,a=i.length;n<a;n++)if(1===this.boundBox.containsPoint(i[n]))return!0;return!1}return!1;default:throw new Error("BoxCollider:unknown collider type.")}},i._cloneTo=function(e){var t=e,i=t.size;this.size.cloneTo(i),t.size=i,this.center.cloneTo(t.center)},i.raycast=function(e,t,i){void 0===i&&(i=1.79e308),this._updateCollider();var n=this._transformOrientedBoundBox.intersectsRay(e,t.position);return-1!==n&&n<=i?(t.distance=n,t.sprite3D=this._owner,!0):(t.distance=-1,t.sprite3D=null,!1)},i.setFromBoundBox=function(e){kt.createByBoundBox(e,this._transformOrientedBoundBox);var t=this._transformOrientedBoundBox.extents;this._size=new At(2*t.x,2*t.y,2*t.z),this.center=new At,At.add(e.min,e.max,this.center),At.scale(this.center,.5,this.center),this._needUpdate=!0},r(0,i,"boundBox",function(){return this._updateCollider(),this._transformOrientedBoundBox}),r(0,i,"size",function(){return this._size},function(e){this._size=e,this._needUpdate=!0}),n(t,["_deviationV3",function(){return this._deviationV3=new At},"_obbCenterV3",function(){return this._obbCenterV3=new At}]),t}(),$i=function(e){function t(){this._transformBoundingBox=null,this._mesh=null,t.__super.call(this),this._transformBoundingBox=new xt(new At,new At),this._needUpdate=!1}a(t,"laya.d3.component.physics.MeshCollider",Si);var i=t.prototype;return i._updateBoundBoxCollider=function(){if(this._needUpdate){for(var e=this._owner.transform.worldMatrix,i=this._mesh.boundingBoxCorners,n=0;n<8;n++)At.transformCoordinate(i[n],e,t._tempBoundBoxCorners[n]);xt.createfromPoints(t._tempBoundBoxCorners,this._transformBoundingBox),this._needUpdate=!1}},i._raycastMesh=function(e,i,n,a){void 0===a&&(a=1.79e308);var r=i.transform.worldMatrix,o=t._tempMatrix4x40;r.invert(o);var s=e.origin,h=e.direction,l=t._tempRay0;At.transformCoordinate(s,o,l.origin),At.TransformNormal(h,o,l.direction);for(var c=Number.MAX_VALUE,p=0,u=this._mesh.getRenderElementsCount();p<u;p++){var d=this._mesh.getRenderElement(p),_=d._getVertexBuffer(0),m=_.getData(),f=d._getIndexBuffer().getData(),g=t._tempRaycastHit;if(Wt.rayIntersectsPositionsAndIndices(l,m,_.vertexDeclaration,f,g)){At.transformCoordinate(g.position,r,g.position);var y=t._tempVector30;At.subtract(s,g.position,y);var v=At.scalarLength(y);if(v<a&&v<c){g.distance=v,g.sprite3D=i;var x=g.trianglePositions;At.transformCoordinate(x[0],r,x[0]),At.transformCoordinate(x[1],r,x[1]),At.transformCoordinate(x[2],r,x[2]);var b=g.triangleNormals;return At.transformCoordinate(b[0],r,b[0]),At.transformCoordinate(b[1],r,b[1]),At.transformCoordinate(b[2],r,b[2]),c=v,g.cloneTo(n),!0}return!1}}return!1},i._onWorldMatrixChanged=function(){this._needUpdate=!0},i._initialize=function(e){laya.d3.component.Component3D.prototype._initialize.call(this,e),e.transform.on("worldmatrixneedchanged",this,this._onWorldMatrixChanged),this._needUpdate=!0},i._getType=function(){return 2},i._collisonTo=function(e){var t=0,i=0,n=this.mesh._positions;switch(e._getType()){case 0:var a=e;if(0!==St.sphereContainsBox(a.boundSphere,this._boundBox)){for(t=0,i=n.length;t<i;t++)if(1===St.sphereContainsPoint(a.boundSphere,n[t]))return!0;return!1}return!1;case 1:var r=e;if(0!==r.boundBox.containsBoundBox(this._boundBox)){for(t=0,i=n.length;t<i;t++)if(1===r.boundBox.containsPoint(n[t]))return!0;return!1}return!1;case 2:var o=e;return 1!==St.intersectsBoxAndBox(o._boundBox,this._boundBox);default:throw new Error("MeshCollider:unknown collider type.")}},i._cloneTo=function(e){e.mesh=this._mesh},i.raycast=function(e,t,i){if(void 0===i&&(i=1.79e308),null==this._mesh||!this._mesh.loaded)return!1;var n=St.intersectsRayAndBoxRD(e,this._boundBox);return!!(-1!==n&&n<=i&&this._raycastMesh(e,this._owner,t,i))||(t.distance=-1,t.sprite3D=null,!1)},r(0,i,"_boundBox",function(){return this._updateBoundBoxCollider(),this._transformBoundingBox}),r(0,i,"mesh",function(){return this._mesh},function(e){this._mesh=e}),n(t,["_tempRay0",function(){return this._tempRay0=new Dt(new At,new At)},"_tempVector30",function(){return this._tempVector30=new At},"_tempMatrix4x40",function(){return this._tempMatrix4x40=new Ct},"_tempRaycastHit",function(){return this._tempRaycastHit=new qt},"_tempBoundBoxCorners",function(){return this._tempBoundBoxCorners=[new At,new At,new At,new At,new At,new At,new At,new At]}]),t}(),en=function(e){function t(){this._originalBoundSphere=null,this._transformBoundSphere=null,t.__super.call(this),this._needUpdate=!1}a(t,"laya.d3.component.physics.SphereCollider",Si);var i=t.prototype;return i._updateCollider=function(){if(this._needUpdate){var e=NaN,t=this._owner.transform,i=t.scale;e=i.x>=i.y&&i.x>=i.z?i.x:i.y>=i.z?i.y:i.z,At.transformCoordinate(this._originalBoundSphere.center,t.worldMatrix,this._transformBoundSphere.center),this._transformBoundSphere.radius=this._originalBoundSphere.radius*e,this._needUpdate=!1}},i._onWorldMatrixChanged=function(){this._needUpdate=!0;for(var e in this._runtimeCollisonMap)this._runtimeCollisonTestMap[e]=!0,this._runtimeCollisonMap[e]._runtimeCollisonTestMap[this.id]=!0},i._initialize=function(e){laya.d3.component.Component3D.prototype._initialize.call(this,e),this._originalBoundSphere=new wt(new At(0,0,0),.5),this._transformBoundSphere=new wt(new At(0,0,0),.5),e.transform.on("worldmatrixneedchanged",this,this._onWorldMatrixChanged),this._needUpdate=!0},i._getType=function(){return 0},i._collisonTo=function(e){switch(e._getType()){case 0:return 0!==St.sphereContainsSphere(this.boundSphere,e.boundSphere);case 1:return 0!==e.boundBox.containsSphere(this.boundSphere);case 2:var t=e;if(0!==St.sphereContainsBox(this.boundSphere,t._boundBox)){for(var i=t.mesh._positions,n=0,a=i.length;n<a;n++)if(1===St.sphereContainsPoint(this.boundSphere,i[n]))return!0;return!1}return!1;default:throw new Error("SphereCollider:unknown collider type.")}},i._cloneTo=function(e){var t=e;t.radius=this.radius;var i=t.center;this.center.cloneTo(i),t.center=i},i.raycast=function(e,t,i){void 0===i&&(i=1.79e308),this._updateCollider();var n=this._transformBoundSphere.intersectsRayPoint(e,t.position);return-1!==n&&n<=i?(t.distance=n,t.sprite3D=this._owner,!0):(t.distance=-1,t.sprite3D=null,!1)},r(0,i,"center",function(){return this._originalBoundSphere.center},function(e){this._originalBoundSphere.center=e}),r(0,i,"radius",function(){return this._originalBoundSphere.radius},function(e){this._originalBoundSphere.radius=e}),r(0,i,"boundSphere",function(){return this._updateCollider(),this._transformBoundSphere}),t}(),tn=function(e){function t(){this.simLodInfo=null,this._src=null,this._buffer=null,this._mipmaps=null,this._recreateLock=!1,this._needReleaseAgain=!1,t.__super.call(this),this._type=3553}a(t,"laya.d3.resource.DataTexture2D",gi);var o=t.prototype;return o.genDebugMipmaps=function(){var e=[];return e.push(new Uint8Array(new Uint32Array(131072).fill(4278190335).buffer)),e.push(new Uint8Array(new Uint32Array(32768).fill(4278223103).buffer)),e.push(new Uint8Array(new Uint32Array(8192).fill(4278255615).buffer)),e.push(new Uint8Array(new Uint32Array(2048).fill(4278255360).buffer)),e.push(new Uint8Array(new Uint32Array(512).fill(4286595072).buffer)),e.push(new Uint8Array(new Uint32Array(128).fill(4294901760).buffer)),e.push(new Uint8Array(new Uint32Array(32).fill(4294901888).buffer)),e.push(new Uint8Array(new Uint32Array(8).fill(0).buffer)),e.push(new Uint8Array(new Uint32Array(2).fill(4286611584).buffer)),e.push(new Uint8Array(new Uint32Array(1).fill(4294967295).buffer)),e},o._onTextureLoaded=function(e){},o._createWebGlTexture=function(){if(!this._buffer&&!this._mipmaps)throw"create GLTextur err:no data";var e=A.mainContext;e.getExtension("EXT_shader_texture_lod");var i=this._source=e.createTexture(),n=this._width,a=this._height,r=R.curBindTexTarget,o=R.curBindTexValue;if(R.bindTexture(e,this._type,i),this._mipmaps){if(laya.d3.resource.DataTexture2D.lodasatlas){var s=0;e.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null);for(var h=0;h<this._mipmaps.length;h++){if(this._mipmaps[h].byteLength!=c*p*4)throw"mipmap size error  level:"+h;e.texSubImage2D(this._type,0,t.simLodRect[s++],t.simLodRect[s++],t.simLodRect[s++],t.simLodRect[s++],6408,5121,new Uint8Array(this._mipmaps[h]))}this.minFifter=9729,this.magFifter=9729}else{var c=this._width,p=this._height;for(s=0,e.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null),h=0;h<this._mipmaps.length;h++){if(this._mipmaps[h].byteLength!=c*p*4)throw"mipmap size error  level:"+h;e.texImage2D(this._type,h,6408,c,p,0,6408,5121,new Uint8Array(this._mipmaps[h])),p/=2,(c/=2)<1&&(c=1),p<1&&(p=1),this.minFifter=9987,this.magFifter=9729}}this.mipmap=!1}else e.texImage2D(this._type,0,6408,n,a,0,6408,5121,new Uint8Array(this._buffer));var u=this._minFifter,d=this._magFifter,_=this._repeat?10497:33071,m=l.isPOT(n,a);if(!m)throw"data texture must be POT";this._mipmap||this._mipmaps?-1!==u||(u=9987):-1!==u||(u=9729),-1!==d||(d=9729),e.texParameteri(this._type,10241,u),e.texParameteri(this._type,10240,d),e.texParameteri(this._type,10242,_),this._mipmaps?e.texParameteri(this._type,10243,33071):e.texParameteri(this._type,10243,_),this._mipmap&&e.generateMipmap(this._type),r&&o&&R.bindTexture(e,r,o),this.src&&this.src.length>0&&(this._buffer=null),this.memorySize=m?n*a*4*(1+1/3):n*a*4,this._recreateLock=!1},o.recreateResource=function(){if(this._buffer||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._buffer||this._mipmaps){if(this._recreateLock)return;this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0}},o.onAsynLoaded=function(e,t,i){var n;i&&(n=i[0].call(this,t)),n&&(this._width=n.width,this._height=n.height,this._buffer=n.data),this._src=e,this._size=new Kt(this._width,this._height),this._conchTexture?alert("怎么给runtime传递datatexture数据"):this.activeResource(),this._endLoaded()},o.getPixels=function(){return new Uint8Array(this._buffer)},o.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(A.mainContext.deleteTexture(this._source),this._source=null,this._buffer=null,this.memorySize=0)},r(0,o,"src",function(){return this._src}),t.create=function(e,i,n,a,r,o){if(void 0===a&&(a=9729),void 0===r&&(r=9729),void 0===o&&(o=!0),!e||e.byteLength<i*n*4)throw"DataTexture2D create error";var s=new t;return s._buffer=e,s._width=i,s._height=n,s._mipmap=o,s._magFifter=a,s._minFifter=r,s._size=new Kt(s._width,s._height),s._conchTexture?alert("怎么给runtime传递datatexture数据"):s.activeResource(),s},t.load=function(e,n,a,r,o){void 0===n&&(n=0),void 0===a&&(a=0),void 0===r&&(r=9729),void 0===o&&(o=9729);if("mipmaps"===N.getFileExtension(e)){var s=i.loader.create(e,null,null,t,[function(e){this._mipmaps=[];var t=new Uint32Array(e);this._width=t[0];var i=512;if(laya.d3.resource.DataTexture2D.lodasatlas&&(this._width*=2,i=1024),this._width!=i)throw console.error("现在只支持512x256的环境贴图。当前的是"+t[0]),"现在只支持512x256的环境贴图。当前的是"+t[0];this._height=t[1];for(var n=laya.d3.resource.DataTexture2D.lodasatlas?this._width/2:this._width,a=this._height,r=8;;){var o=n*a*4;if(r+o>e.byteLength)throw"load mipmaps data size error ";var s=new Uint8Array(e,r,o);if(this._mipmaps.push(s),r+=o,1==n&&1==a)break;a/=2,(n/=2)<1&&(n=1),a<1&&(a=1)}return null}]);if(laya.d3.resource.DataTexture2D.lodasatlas){s.simLodInfo=new Float32Array(40);for(var h=0;h<s.simLodInfo.length;)s.simLodInfo[h]=(t.simLodRect[h]+.5)/1024,h++,s.simLodInfo[h]=(t.simLodRect[h]+.5)/256,h++,s.simLodInfo[h]=Math.max(t.simLodRect[h]-1,.1)/1024,h++,s.simLodInfo[h]=Math.max(t.simLodRect[h]-1.5,.1)/256,h++}return s}if("number"==typeof n)return i.loader.create(e,null,null,t,[function(e){return this._width=n,this._height=a,this._buffer=e,null}]);if("function"==typeof n)return i.loader.create(e,null,null,t,[n]);throw new Error("unknown params.")},t.lodasatlas=!1,n(t,["simLodRect",function(){return this.simLodRect=new Uint32Array([0,0,512,256,512,0,256,128,768,0,128,64,896,0,64,32,960,0,32,16,992,0,16,8,1008,0,8,4,1016,0,4,2,1020,0,2,1,1022,0,1,1])}]),t}(),nn=function(e){function t(){this._numberVertices=0,this._numberIndices=0,this._vertexBuffer=null,this._indexBuffer=null,t.__super.call(this)}a(t,"laya.d3.resource.models.PrimitiveMesh",yi);var n=t.prototype;return i.imps(n,{"laya.d3.core.render.IRenderable":!0}),n._getVertexBuffer=function(e){return void 0===e&&(e=0),0===e?this._vertexBuffer:null},n._getVertexBuffers=function(){return null},n._getIndexBuffer=function(){return this._indexBuffer},n._getPositions=function(){var e,t=[],i=this._vertexBuffer.vertexDeclaration.getVertexElements(),n=0;for(n=0;n<i.length;n++){var a=i[n];if("vector3"===a.elementFormat&&0===a.elementUsage){e=a;break}}var r=this._vertexBuffer.getData();for(n=0;n<r.length;n+=this._vertexBuffer.vertexDeclaration.vertexStride/4){var o=n+e.offset/4,s=new At(r[o+0],r[o+1],r[o+2]);t.push(s)}return t},n.getRenderElement=function(e){return this},n.getRenderElementsCount=function(){return 1},n.disposeResource=function(){this._vertexBuffer&&(this._vertexBuffer.destroy(),this._vertexBuffer=null),this._indexBuffer&&(this._indexBuffer.destroy(),this._indexBuffer=null),this.memorySize=0},n._beforeRender=function(e){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},n._render=function(e){A.mainContext.drawElements(4,this._numberIndices,5123,0),T.drawCall++,T.trianglesFaces+=this._numberIndices/3},r(0,n,"_vertexBufferCount",function(){return 1}),r(0,n,"triangleCount",function(){return this._indexBuffer.indexCount/3}),t}(),an=function(e){function t(){this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null,this._skinnedDatas=null,t.__super.call(this),this._subMeshes=[],this._materials=[],this._vertexBuffers=[]}a(t,"laya.d3.resource.models.Mesh",yi);var n=t.prototype;return n._getPositions=function(){var e,t,i,n,a,r=[],o=0,s=0,h=0;if(0!==this._vertexBuffers.length){var l=this._vertexBuffers.length;for(o=0;o<l;o++){for(i=(e=this._vertexBuffers[o]).vertexDeclaration.getVertexElements(),s=0;s<i.length;s++)if("vector3"===(n=i[s]).elementFormat&&0===n.elementUsage){t=n;break}for(a=e.getData(),s=0;s<a.length;s+=e.vertexDeclaration.vertexStride/4)h=s+t.offset/4,r.push(new At(a[h+0],a[h+1],a[h+2]))}}else{var c=this._subMeshes.length;for(o=0;o<c;o++){for(i=(e=this._subMeshes[o]._getVertexBuffer()).vertexDeclaration.getVertexElements(),s=0;s<i.length;s++)if("vector3"===(n=i[s]).elementFormat&&0===n.elementUsage){t=n;break}for(a=e.getData(),s=0;s<a.length;s+=e.vertexDeclaration.vertexStride/4)h=s+t.offset/4,r.push(new At(a[h+0],a[h+1],a[h+2]))}}return r},n._setSubMeshes=function(e){this._subMeshes=e,this._subMeshCount=e.length;for(var t=0;t<this._subMeshCount;t++)e[t]._indexInMesh=t;this._positions=this._getPositions(),this._generateBoundingObject()},n.onAsynLoaded=function(e,t,i){var n=t[0],a=t[1];vt.read(n,this,this._materials,this._subMeshes,a),this.completeCreate(),this._endLoaded()},n.getSubMesh=function(e){return this._subMeshes[e]},n.getSubMeshCount=function(){return this._subMeshes.length},n.getRenderElementsCount=function(){return this._subMeshes.length},n.getRenderElement=function(e){return this._subMeshes[e]},n.disposeResource=function(){for(var e=0;e<this._subMeshes.length;e++)this._subMeshes[e].dispose();this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null},r(0,n,"materials",function(){return this._materials.slice()}),r(0,n,"InverseAbsoluteBindPoses",function(){return this._inverseBindPoses}),t.load=function(e){return i.loader.create(e,null,null,t)},t}(),rn=function(e){function t(e,i,n,a,r,o,s,h,l){this._alreadyResolved=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._frameBuffer=null,this._depthStencilBuffer=null,void 0===n&&(n=6408),void 0===a&&(a=5121),void 0===r&&(r=33189),void 0===o&&(o=!1),void 0===s&&(s=!1),void 0===h&&(h=-1),void 0===l&&(l=-1),t.__super.call(this),this._type=3553,this._width=e,this._height=i,this._size=new Kt(e,i),this._surfaceFormat=n,this._surfaceType=a,this._depthStencilFormat=r,this._mipmap=o,this._repeat=s,this._minFifter=h,this._magFifter=l,this.activeResource(),this._alreadyResolved=!0}a(t,"laya.d3.resource.RenderTexture",gi);var n=t.prototype;return n.recreateResource=function(){var e=A.mainContext;this._frameBuffer=e.createFramebuffer(),this._source=e.createTexture();var t=R.curBindTexTarget,i=R.curBindTexValue;R.bindTexture(e,this._type,this._source),e.texImage2D(this._type,0,6408,this._width,this._height,0,this._surfaceFormat,this._surfaceType,null);var n=this._minFifter,a=this._magFifter,r=this._repeat?10497:33071;if(l.isPOT(this._width,this._height)?(this._mipmap?-1!==n||(n=9987):-1!==n||(n=9729),-1!==a||(a=9729),e.texParameteri(this._type,10241,n),e.texParameteri(this._type,10240,a),e.texParameteri(this._type,10242,r),e.texParameteri(this._type,10243,r),this._mipmap&&e.generateMipmap(this._type)):(-1!==n||(n=9729),-1!==a||(a=9729),e.texParameteri(this._type,10241,n),e.texParameteri(this._type,10240,a),e.texParameteri(this._type,10242,33071),e.texParameteri(this._type,10243,33071)),e.bindFramebuffer(36160,this._frameBuffer),e.framebufferTexture2D(36160,36064,3553,this._source,0),this._depthStencilFormat)switch(this._depthStencilBuffer=e.createRenderbuffer(),e.bindRenderbuffer(36161,this._depthStencilBuffer),e.renderbufferStorage(36161,this._depthStencilFormat,this._width,this._height),this._depthStencilFormat){case 33189:e.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:e.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:e.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}e.bindFramebuffer(36160,null),t&&i&&R.bindTexture(e,t,i),e.bindRenderbuffer(36161,null),this.memorySize=this._width*this._height*4,this.completeCreate()},n.start=function(){A.mainContext.bindFramebuffer(36160,this.frameBuffer),t._currentRenderTarget=this,this._alreadyResolved=!1},n.end=function(){A.mainContext.bindFramebuffer(36160,null),t._currentRenderTarget=null,this._alreadyResolved=!0},n.getData=function(e,t,i,n){var a=A.mainContext;a.bindFramebuffer(36160,this._frameBuffer);if(!(36053===a.checkFramebufferStatus(36160)))return a.bindFramebuffer(36160,null),null;var r=new Uint8Array(this._width*this._height*4);return a.readPixels(e,t,i,n,this._surfaceFormat,this._surfaceType,r),a.bindFramebuffer(36160,null),r},n.disposeResource=function(){if(this._frameBuffer){var e=A.mainContext;e.deleteTexture(this._source),e.deleteFramebuffer(this._frameBuffer),e.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0}},r(0,n,"surfaceFormat",function(){return this._surfaceFormat}),r(0,n,"surfaceType",function(){return this._surfaceType}),r(0,n,"depthStencilFormat",function(){return this._depthStencilFormat}),r(0,n,"source",function(){return this._alreadyResolved?i.superGet(gi,this,"source"):null}),r(0,n,"depthStencilBuffer",function(){return this._depthStencilBuffer}),r(0,n,"frameBuffer",function(){return this._frameBuffer}),t._currentRenderTarget=null,t}(),on=function(e){function t(e){this._color=null,this._pixels=null,t.__super.call(this),this._type=3553,this._width=1,this._height=1,this._size=new Kt(this.width,this.height),this._color=e,this._pixels=new Uint8Array([255*e.x,255*e.y,255*e.z,255*e.w])}a(t,"laya.d3.resource.SolidColorTexture2D",gi);var i=t.prototype;return i._createWebGlTexture=function(){var e=A.mainContext,t=this._source=e.createTexture(),i=this._width,n=this._height,a=R.curBindTexTarget,r=R.curBindTexValue;R.bindTexture(e,this._type,t),e.texImage2D(this._type,0,6408,i,n,0,6408,5121,this._pixels);var o=this._minFifter,s=this._magFifter,h=this._repeat?10497:33071,c=l.isPOT(i,n);c?(this._mipmap?-1!==o||(o=9987):-1!==o||(o=9729),-1!==s||(s=9729),e.texParameteri(this._type,10241,o),e.texParameteri(this._type,10240,s),e.texParameteri(this._type,10242,h),e.texParameteri(this._type,10243,h),this._mipmap&&e.generateMipmap(this._type)):(-1!==o||(o=9729),-1!==s||(s=9729),e.texParameteri(this._type,10241,o),e.texParameteri(this._type,10240,s),e.texParameteri(this._type,10242,33071),e.texParameteri(this._type,10243,33071)),a&&r&&R.bindTexture(e,a,r),this.memorySize=c?i*n*4*(1+1/3):i*n*4},i.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},i.disposeResource=function(){this._source&&(A.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},n(t,["magentaTexture",function(){return this.magentaTexture=new t(new Rt(1,0,1,1))},"grayTexture",function(){return this.grayTexture=new t(new Rt(.5,.5,.5,1))}]),t}(),sn=function(e){function t(e){this._color=null,this._pixels=null,this._texCount=6,t.__super.call(this),this._type=34067,this._width=1,this._height=1,this._size=new Kt(this.width,this.height),this._color=e,this._pixels=new Uint8Array([255*e.x,255*e.y,255*e.z,255*e.w])}a(t,"laya.d3.resource.SolidColorTextureCube",gi);var i=t.prototype;return i._createWebGlTexture=function(){var e=A.mainContext,t=this._source=e.createTexture(),i=this._width,n=this._height,a=R.curBindTexTarget,r=R.curBindTexValue;R.bindTexture(e,this._type,t),e.texImage2D(34069,0,6408,i,n,0,6408,5121,this._pixels),e.texImage2D(34070,0,6408,i,n,0,6408,5121,this._pixels),e.texImage2D(34071,0,6408,i,n,0,6408,5121,this._pixels),e.texImage2D(34072,0,6408,i,n,0,6408,5121,this._pixels),e.texImage2D(34073,0,6408,i,n,0,6408,5121,this._pixels),e.texImage2D(34074,0,6408,i,n,0,6408,5121,this._pixels);var o=this.minFifter,s=this.magFifter,h=this._repeat?10497:33071,c=l.isPOT(i,n);c?(this.mipmap?-1!==o||(o=9987):-1!==o||(o=9729),-1!==s||(s=9729),e.texParameteri(this._type,10241,o),e.texParameteri(this._type,10240,s),e.texParameteri(this._type,10242,h),e.texParameteri(this._type,10243,h),this.mipmap&&e.generateMipmap(this._type)):(-1!==o||(o=9729),-1!==s||(s=9729),e.texParameteri(this._type,10241,o),e.texParameteri(this._type,10240,s),e.texParameteri(this._type,10242,33071),e.texParameteri(this._type,10243,33071)),a&&r&&R.bindTexture(e,a,r),this.memorySize=c?i*n*4*(1+1/3)*this._texCount:i*n*4*this._texCount},i.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},i.disposeResource=function(){this._source&&(A.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},n(t,["magentaTexture",function(){return this.magentaTexture=new t(new Rt(1,0,1,1))},"grayTexture",function(){return this.grayTexture=new t(new Rt(.5,.5,.5,1))}]),t}(),hn=function(t){function n(e,t,i,a){this._canRead=!1,this._image=null,this._pixels=null,void 0===e&&(e=!1),void 0===t&&(t=!0),void 0===i&&(i=6408),void 0===a&&(a=!0),n.__super.call(this),this._type=3553,this._repeat=t,this._canRead=e,this._format=i,this._mipmap=a}a(n,"laya.d3.resource.Texture2D",gi);var o=n.prototype;return o._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var e=A.mainContext,t=this._source=e.createTexture(),i=this._width,n=this._height,a=R.curBindTexTarget,r=R.curBindTexValue;switch(R.bindTexture(e,this._type,t),this._format){case 6407:case 6408:this._canRead?e.texImage2D(this._type,0,this._format,i,n,0,this._format,5121,this._pixels):e.texImage2D(this._type,0,this._format,this._format,5121,this._image);break;case A.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:e.compressedTexImage2D(this._type,0,this._format,this._width,this._height,0,this._image)}var o=this._minFifter,s=this._magFifter,h=this._repeat?10497:33071,c=0==this._wrapModeU?10497:33071,p=0==this._wrapModeV?10497:33071,u=l.isPOT(i,n);u?(this._mipmap?-1!==o||(o=9987):-1!==o||(o=9729),-1!==s||(s=9729),e.texParameteri(this._type,10241,o),e.texParameteri(this._type,10240,s),e.texParameteri(this._type,10242,h),e.texParameteri(this._type,10243,h),e.texParameteri(this._type,10242,c),e.texParameteri(this._type,10243,p),this._mipmap&&e.generateMipmap(this._type)):(-1!==o||(o=9729),-1!==s||(s=9729),e.texParameteri(this._type,10241,o),e.texParameteri(this._type,10240,s),e.texParameteri(this._type,10242,33071),e.texParameteri(this._type,10243,33071)),a&&r&&R.bindTexture(e,a,r),this._image.onload=null,this._image=null,this.memorySize=u?i*n*4*(1+1/3):i*n*4},o.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},o.onAsynLoaded=function(t,i,n){if(n){var a=n[0];void 0!==a&&(this._canRead=a);var r=n[1];void 0!==r&&(this._repeat=r);var o=n[2];void 0!==o&&(this._format=o);var s=n[3];void 0!==s&&(this._mipmap=s);var h=n.wrapModeU;void 0!==h&&(this._wrapModeU=h);var l=n.wrapModeV;void 0!==l&&(this._wrapModeV=l)}switch(this._format){case 6407:case 6408:this._image=i;var c=i.width,p=i.height;this._width=c,this._height=p,this._size=new Kt(c,p),this._canRead&&(S.isConchApp?i instanceof e.HTMLElement&&(this._pixels=new Uint8Array(i.getImageData(0,0,c,p))):(u.canvas.size(c,p),u.canvas.clear(),u.context.drawImage(i,0,0,c,p),this._pixels=new Uint8Array(u.context.getImageData(0,0,c,p).data.buffer)));break;case A.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:var d=new _(i);d.readUTFBytes(4),d.readUTFBytes(2),d.getInt16();d.endian="bigEndian",this._width=d.getInt16(),this._height=d.getInt16(),this._size=new Kt(this._width,this._height);d.getInt16(),d.getInt16();this._image=new Uint8Array(i,d.pos)}this.recreateResource(),this._endLoaded()},o.getPixels=function(){if(this._canRead)return this._pixels;throw new Error("Texture2D: must set texture canRead is true.")},o.disposeResource=function(){this._source&&(A.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0)},r(0,o,"_src",function(){return this.url}),r(0,o,"src",function(){return this.url}),n.load=function(e){return i.loader.create(e,null,null,n)},n}(),ln=(function(t){function n(e,t,i,a){n.__super.call(this,e,t,i,a)}a(n,"laya.d3.resource.Texture2D_caps",hn);var o=n.prototype;o._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var e=A.mainContext,t=this._source=e.createTexture(),i=this._width,n=this._height,a=R.curBindTexTarget,r=R.curBindTexValue;switch(R.bindTexture(e,this._type,t),this._format){case 6407:case 6408:this._canRead?e.texImage2D(this._type,0,this._format,i,n,0,this._format,5121,this._pixels):e.texImage2D(this._type,0,this._format,this._format,5121,this._image);break;case A.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:e.compressedTexImage2D(this._type,0,this._format,this._width,this._height,0,this._image)}var o=this._minFifter,s=this._magFifter,h=this._repeat?10497:33071,c=0==this._wrapModeU?10497:33071,p=0==this._wrapModeV?10497:33071,u=l.isPOT(i,n);u?(this._mipmap?-1!==o||(o=9987):-1!==o||(o=9729),-1!==s||(s=9729),e.texParameteri(this._type,10241,o),e.texParameteri(this._type,10240,s),e.texParameteri(this._type,10242,h),e.texParameteri(this._type,10243,h),e.texParameteri(this._type,10242,c),e.texParameteri(this._type,10243,p),this._mipmap&&e.generateMipmap(this._type)):(-1!==o||(o=9729),-1!==s||(s=9729),e.texParameteri(this._type,10241,o),e.texParameteri(this._type,10240,s),e.texParameteri(this._type,10242,33071),e.texParameteri(this._type,10243,33071)),a&&r&&R.bindTexture(e,a,r),this._image.onload=null,this.memorySize=u?i*n*4*(1+1/3):i*n*4},o.recreateResource=function(){this._source||(this._createWebGlTexture(),this.completeCreate())},o.clearTexture=function(){this._source&&(A.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},o.onAsynLoaded=function(t,i,n){if(n){var a=n[0];void 0!==a&&(this._canRead=a);var r=n[1];void 0!==r&&(this._repeat=r);var o=n[2];void 0!==o&&(this._format=o);var s=n[3];void 0!==s&&(this._mipmap=s);var h=n.wrapModeU;void 0!==h&&(this._wrapModeU=h);var l=n.wrapModeV;void 0!==l&&(this._wrapModeV=l)}switch(this._format){case 6407:case 6408:this._image=i;var c=i.width,p=i.height;this._width=c,this._height=p,this._size=new Kt(c,p),this._canRead&&(S.isConchApp?i instanceof e.HTMLElement&&(this._pixels=new Uint8Array(i.getImageData(0,0,c,p))):(u.canvas.size(c,p),u.canvas.clear(),u.context.drawImage(i,0,0,c,p),this._pixels=new Uint8Array(u.context.getImageData(0,0,c,p).data.buffer)));break;case A.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:var d=new _(i);d.readUTFBytes(4),d.readUTFBytes(2),d.getInt16();d.endian="bigEndian",this._width=d.getInt16(),this._height=d.getInt16(),this._size=new Kt(this._width,this._height);d.getInt16(),d.getInt16();this._image=new Uint8Array(i,d.pos)}this._endLoaded()},r(0,o,"_src",function(){return this.url}),r(0,o,"src",function(){return this.url}),n.load=function(e){return i.loader.create(e,null,null,n)}}(),function(e){function t(){t.__super.call(this),this._type=34067}a(t,"laya.d3.resource.TextureCube",gi);var n=t.prototype;return n._onTextureLoaded=function(e){this._images=e;for(var t=2147483647,i=2147483647,n=0;n<6;n++){var a=e[n];t=Math.min(t,a.width),i=Math.min(i,a.height)}this._width=t,this._height=i,this._size=new Kt(t,i)},n._createWebGlTexture=function(){var e=0;for(e=0;e<6;e++)if(!this._images[e])throw"create GLTextur err:no data:"+this._images[e];var t=A.mainContext,i=this._source=t.createTexture(),n=this._width,a=this._height,r=R.curBindTexTarget,o=R.curBindTexValue;R.bindTexture(t,this._type,i),t.texImage2D(34069,0,6408,6408,5121,this._images[0]),t.texImage2D(34070,0,6408,6408,5121,this._images[1]),t.texImage2D(34071,0,6408,6408,5121,this._images[2]),t.texImage2D(34072,0,6408,6408,5121,this._images[3]),t.texImage2D(34073,0,6408,6408,5121,this._images[4]),t.texImage2D(34074,0,6408,6408,5121,this._images[5]);var s=this.minFifter,h=this.magFifter,c=this._repeat?10497:33071,p=l.isPOT(n,a);for(p?(this.mipmap?-1!==s||(s=9987):-1!==s||(s=9729),-1!==h||(h=9729),t.texParameteri(this._type,10241,s),t.texParameteri(this._type,10240,h),t.texParameteri(this._type,10242,c),t.texParameteri(this._type,10243,c),this.mipmap&&t.generateMipmap(this._type)):(-1!==s||(s=9729),-1!==h||(h=9729),t.texParameteri(this._type,10241,s),t.texParameteri(this._type,10240,h),t.texParameteri(this._type,10242,33071),t.texParameteri(this._type,10243,33071)),r&&o&&R.bindTexture(t,r,o),e=0;e<6;e++)this._images[e].onload=null,this._images[e]=null;this.memorySize=p?n*a*4*(1+1/3)*6:n*a*4*6},n.recreateResource=function(){null!=this._url&&(this._createWebGlTexture(),this.completeCreate())},n.onAsynLoaded=function(e,t,i){this._onTextureLoaded(t),this.activeResource(),this._endLoaded()},n.disposeResource=function(){this._source&&(A.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},r(0,n,"defaulteTexture",function(){return sn.grayTexture}),t.load=function(e){return i.loader.create(e,null,null,t)},t}()),cn=function(e){function t(e){this._hasIndependentBound=!0,t.__super.call(this,e),this._owner.transform.off("worldmatrixneedchanged",this,this._onWorldMatNeedChange),this._cacheAnimationNodeIndex=[],this._cacheAnimationNode=[],this._localBoundingBoxCorners=o(8,null),this._owner.meshFilter.on("meshchanged",this,this._$3__onMeshChanged)}a(t,"laya.d3.core.SkinnedMeshRender",e);var i=t.prototype;return i._getCacheAnimationNodes=function(){var e=this._cacheMesh._boneNames,t=e.length;this._cacheAnimationNode.length=t,this._cacheAnimationNodeIndex.length=t;for(var i=this._cacheAnimator._avatarNodes,n=this._cacheAnimator._avatarNodeMap,a=0;a<t;a++){var r=n[e[a]];this._cacheAnimationNode[a]=r,this._cacheAnimationNodeIndex[a]=i.indexOf(r)}},i._offComputeBoneIndexToMeshEvent=function(e,t){e.loaded?t.loaded||t.off("loaded",this,this._getCacheAnimationNodes):e.off("loaded",this,this._computeBoneIndexToMeshWithAsyncMesh)},i._computeBoneIndexToMeshWithAsyncAvatar=function(){this._cacheAvatar.loaded?this._computeBoneIndexToMeshWithAsyncMesh():this._cacheAvatar.once("loaded",this,this._computeBoneIndexToMeshWithAsyncMesh)},i._computeBoneIndexToMeshWithAsyncMesh=function(){this._cacheMesh.loaded?this._getCacheAnimationNodes():this._cacheMesh.on("loaded",this,this._getCacheAnimationNodes)},i._$3__onMeshChanged=function(e,t,i){this._cacheMesh=i,t&&!t.loaded&&i.off("loaded",this,this._onMeshLoaded),i.loaded?this._onMeshLoaded(i):i.on("loaded",this,this._onMeshLoaded),this._cacheAvatar&&(t&&this._offComputeBoneIndexToMeshEvent(this._cacheAvatar,t),i&&this._computeBoneIndexToMeshWithAsyncAvatar())},i._onMeshLoaded=function(e){var t=e.subMeshCount;this._subSkinnedDatas=[],this._subSkinnedDatas.length=t;for(var i=0;i<t;i++)for(var n=this._subSkinnedDatas[i]=[],a=e.getSubMesh(i)._boneIndicesList,r=0,o=a.length;r<o;r++)n[r]=new Float32Array(16*a[r].length)},i._setCacheAnimator=function(e){this._cacheAnimator=e,this._rootBone&&(this._rootIndex=e._avatarNodes.indexOf(e._avatarNodeMap[this._rootBone]))},i._setRootBone=function(e){this._rootBone=e,this._cacheAnimator&&(this._rootIndex=this._cacheAnimator._avatarNodes.indexOf(this._cacheAnimator._avatarNodeMap[e]))},i._setCacheAvatar=function(e){this._cacheAvatar!==e&&(this._cacheMesh?(this._cacheAvatar&&this._offComputeBoneIndexToMeshEvent(this._cacheAvatar,this._cacheMesh),this._cacheAvatar=e,e&&(this._addShaderDefine(vn.SHADERDEFINE_BONE),this._computeBoneIndexToMeshWithAsyncAvatar())):this._cacheAvatar=e)},i._calculateBoundingBox=function(){if(this._hasIndependentBound){if(this._cacheAnimator){var t=this._owner.transform,i=t.worldMatrix;if(this._cacheAnimator._canCache){var n=this._cacheAnimator._curAvatarNodeDatas;Jt.matrix4x4MultiplyMFM(this._cacheAnimator.owner.transform.worldMatrix,n[this._rootIndex],i)}else Jt.matrix4x4MultiplyMFM(this._cacheAnimator.owner.transform.worldMatrix,this._cacheAnimator._avatarNodeMap[this._rootBone].transform.getWorldMatrix(),i);t.worldMatrix=i;null==this._cacheAnimator._avatarNodeMap[this._rootBone]||null==this._localBoundBox?this._boundingBox.toDefault():this._calculateBoundBoxByInitCorners(this._localBoundingBoxCorners)}}else e.prototype._calculateBoundingBox.call(this)},i._calculateBoundingSphere=function(){if(this._hasIndependentBound){if(this._cacheAnimator){var t=this._owner.transform,i=t.worldMatrix;if(this._cacheAnimator._canCache){var n=this._cacheAnimator._curAvatarNodeDatas;Jt.matrix4x4MultiplyMFM(this._cacheAnimator.owner.transform.worldMatrix,n[this._rootIndex],i)}else Jt.matrix4x4MultiplyMFM(this._cacheAnimator.owner.transform.worldMatrix,this._cacheAnimator._avatarNodeMap[this._rootBone].transform.getWorldMatrix(),i);t.worldMatrix=i;null==this._cacheAnimator._avatarNodeMap[this._rootBone]||null==this.localBoundSphere?this._boundingSphere.toDefault():this._calculateBoundingSphereByInitSphere(this.localBoundSphere)}}else e.prototype._calculateBoundingSphere.call(this)},i._updateOctreeNode=function(){var e=this._treeNode;e&&e.updateObject(this)},i._renderUpdate=function(e){var i,n=this._cacheAnimator,a=this._cacheMesh.subMeshCount,r=this._owner.transform;if(n){var o=n._canCache,s=this._cacheAnimator._curAvatarNodeDatas,h=n.owner;if(this._setShaderValueMatrix4x4(0,h._transform.worldMatrix),i=h.getProjectionViewWorldMatrix(e),this._setShaderValueMatrix4x4(1,i),this._cacheMesh&&this._cacheMesh.loaded&&this._cacheAvatar&&this._cacheAvatar.loaded){var l=0,c=0,p=this._cacheMesh._inverseBindPoses,u=this._cacheMesh._skinnedDatas;if(o)for(l=0,c=p.length;l<c;l++)Jt._mulMatrixArray(s[this._cacheAnimationNodeIndex[l]],p[l],u,16*l);else for(l=0,c=p.length;l<c;l++)Jt._mulMatrixArray(this._cacheAnimationNode[l].transform.getWorldMatrix(),p[l],u,16*l);for(l=0;l<a;l++){for(var d=this._cacheMesh.getSubMesh(l)._boneIndicesList,_=d.length,m=this._subSkinnedDatas[l],f=0;f<_;f++)t._splitAnimationDatas(d[f],u,m[f]);this._renderElements[l]._skinAnimationDatas=m}}}else this._setShaderValueMatrix4x4(0,r.worldMatrix),i=this._owner.getProjectionViewWorldMatrix(e),this._setShaderValueMatrix4x4(1,i);return Zt.debugMode&&this._renderRenderableBoundBox(),!0},r(0,i,"localBoundBox",function(){return this._localBoundBox},function(e){this._localBoundBox=e,e.getCorners(this._localBoundingBoxCorners)}),r(0,i,"boundingSphere",function(){return this._calculateBoundingSphere(),this._boundingSphere}),r(0,i,"boundingBox",function(){return this._calculateBoundingBox(),this._boundingBox}),r(0,i,"boundingBoxCenter",function(){var e=this.boundingBox;return At.add(e.min,e.max,this._boundingBoxCenter),At.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter),this._boundingBoxCenter}),t._splitAnimationDatas=function(e,t,i){for(var n=0,a=e.length,r=0;n<a;n++)for(var o=e[n]<<4,s=0;s<16;s++,r++)i[r]=t[o+s]},t}(ki),pn=function(e){function t(e,n){t.__super.call(this),void 0===e&&(e=.3),void 0===n&&(n=1e3),this._tempVector3=new At,this._position=new At,this._up=new At,this._forward=new At,this._right=new At,this._fieldOfView=60,this._useUserProjectionMatrix=!1,this._orthographic=!1,this._viewportExpressedInClipSpace=!0,this._renderTargetSize=Kt.fullScreen,this._orthographicVerticalSize=10,this.renderingOrder=0,this._nearPlane=e,this._farPlane=n,this.cullingMask=2147483647,this.clearFlag=0,this.useOcclusionCulling=!0,this._calculateProjectionMatrix(),i.stage.on("resize",this,this._onScreenSizeChanged)}a(t,"laya.d3.core.BaseCamera",e);var o=t.prototype;return o._sortCamerasByRenderingOrder=function(){if(this._displayedInStage)for(var e=this.scene._cameraPool,t=e.length-1,i=0;i<t;i++)if(e[i].renderingOrder>e[t].renderingOrder){var n=e[i];e[i]=e[t],e[t]=n}},o._calculateProjectionMatrix=function(){},o._onScreenSizeChanged=function(){this._calculateProjectionMatrix()},o._prepareCameraToRender=function(){X._currentCameraCullingMask=this.cullingMask;var e=this._shaderValues;e.setValue(0,this.transform.position.elements),e.setValue(5,this.forward.elements),e.setValue(6,this.up.elements)},o._prepareCameraViewProject=function(e,t){var i=this._shaderValues;i.setValue(1,e.elements),i.setValue(2,t.elements)},o._renderCamera=function(e,t,i){},o.addLayer=function(e){29!==e.number&&30!=e.number&&(this.cullingMask=this.cullingMask|e.mask)},o.removeLayer=function(e){29!==e.number&&30!=e.number&&(this.cullingMask=this.cullingMask&~e.mask)},o.addAllLayers=function(){this.cullingMask=2147483647},o.removeAllLayers=function(){this.cullingMask=0|X.getLayerByNumber(29).mask|X.getLayerByNumber(30).mask},o.ResetProjectionMatrix=function(){this._useUserProjectionMatrix=!1,this._calculateProjectionMatrix()},o.moveForward=function(e){this._tempVector3.elements[0]=this._tempVector3.elements[1]=0,this._tempVector3.elements[2]=e,this.transform.translate(this._tempVector3)},o.moveRight=function(e){this._tempVector3.elements[1]=this._tempVector3.elements[2]=0,this._tempVector3.elements[0]=e,this.transform.translate(this._tempVector3)},o.moveVertical=function(e){this._tempVector3.elements[0]=this._tempVector3.elements[2]=0,this._tempVector3.elements[1]=e,this.transform.translate(this._tempVector3,!1)},o._addSelfRenderObjects=function(){var e=this.scene._cameraPool,t=e.length;if(t>0){for(var i=t-1;i>=0;i--)if(this.renderingOrder<=e[i].renderingOrder){e.splice(i+1,0,this);break}}else e.push(this),this.scene.conchModel&&this.scene.conchModel.setCurrentCamera(this.conchModel)},o._clearSelfRenderObjects=function(){var e=this.scene._cameraPool;e.splice(e.indexOf(this),1)},o.destroy=function(t){void 0===t&&(t=!0),this._sky&&this._sky.destroy(),this.renderTarget=null,i.stage.off("resize",this,this._onScreenSizeChanged),e.prototype.destroy.call(this,t)},r(0,o,"sky",function(){return this._sky},function(e){this._sky=e,e._ownerCamera=this}),r(0,o,"forward",function(){var e=this.transform.worldMatrix.elements,t=this._forward.elements;return t[0]=-e[8],t[1]=-e[9],t[2]=-e[10],this._forward}),r(0,o,"position",function(){var e=this.transform.worldMatrix.elements,t=this._position.elements;return t[0]=e[12],t[1]=e[13],t[2]=e[14],this._position}),r(0,o,"renderTarget",function(){return this._renderTarget},function(e){this._renderTarget=e,null!=e&&(this._renderTargetSize=e.size)}),r(0,o,"up",function(){var e=this.transform.worldMatrix.elements,t=this._up.elements;return t[0]=e[4],t[1]=e[5],t[2]=e[6],this._up}),r(0,o,"right",function(){var e=this.transform.worldMatrix.elements,t=this._right.elements;return t[0]=e[0],t[1]=e[1],t[2]=e[2],this._right}),r(0,o,"renderTargetSize",function(){return this._renderTargetSize},function(e){null!=this.renderTarget&&this._renderTargetSize,this._renderTargetSize=e,this._calculateProjectionMatrix()}),r(0,o,"fieldOfView",function(){return this._fieldOfView},function(e){this._fieldOfView=e,this._calculateProjectionMatrix()}),r(0,o,"nearPlane",function(){return this._nearPlane},function(e){this._nearPlane=e,this._calculateProjectionMatrix()}),r(0,o,"farPlane",function(){return this._farPlane},function(e){this._farPlane=e,this._calculateProjectionMatrix()}),r(0,o,"orthographic",function(){return this._orthographic},function(e){this._orthographic=e,this._calculateProjectionMatrix()}),r(0,o,"orthographicVerticalSize",function(){return this._orthographicVerticalSize},function(e){this._orthographicVerticalSize=e,this._calculateProjectionMatrix()}),r(0,o,"renderingOrder",function(){return this._renderingOrder},function(e){this._renderingOrder=e,this._sortCamerasByRenderingOrder()}),t.CAMERAPOS=0,t.VIEWMATRIX=1,t.PROJECTMATRIX=2,t.VPMATRIX=3,t.VPMATRIX_NO_TRANSLATE=4,t.CAMERADIRECTION=5,t.CAMERAUP=6,t.ENVIRONMENTDIFFUSE=7,t.ENVIRONMENTSPECULAR=8,t.SIMLODINFO=9,t.DIFFUSEIRRADMATR=10,t.DIFFUSEIRRADMATG=11,t.DIFFUSEIRRADMATB=12,t.HDREXPOSURE=13,t.RENDERINGTYPE_DEFERREDLIGHTING="DEFERREDLIGHTING",t.RENDERINGTYPE_FORWARDRENDERING="FORWARDRENDERING",t.CLEARFLAG_SOLIDCOLOR=0,t.CLEARFLAG_SKY=1,t.CLEARFLAG_DEPTHONLY=2,t.CLEARFLAG_NONE=3,n(t,["_invertYScaleMatrix",function(){return this._invertYScaleMatrix=new Ct(1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1)},"_invertYProjectionMatrix",function(){return this._invertYProjectionMatrix=new Ct},"_invertYProjectionViewMatrix",function(){return this._invertYProjectionViewMatrix=new Ct}]),t}(Pi),un=function(e){function t(e){this._render=null,this._geometryFilter=null,t.__super.call(this,e)}a(t,"laya.d3.core.RenderableSprite3D",e);var i=t.prototype;return i._addToInitStaticBatchManager=function(){},i._setBelongScene=function(t){e.prototype._setBelongScene.call(this,t),t._renderableSprite3Ds.push(this),this._render._applyLightMapParams()},i._setUnBelongScene=function(){var t=this._scene._renderableSprite3Ds,i=t.indexOf(this);t.splice(i,1),this._render._removeShaderDefine(laya.d3.core.RenderableSprite3D.SAHDERDEFINE_LIGHTMAP),e.prototype._setUnBelongScene.call(this)},i._update=function(e){e.owner=this,this._activeInHierarchy&&(this._updateComponents(e),this._render._updateOctreeNode(),this._lateUpdateComponents(e),T.spriteCount++,this._childs.length&&this._updateChilds(e))},i.destroy=function(t){void 0===t&&(t=!0),e.prototype.destroy.call(this,t),this._render._destroy(),this._render=null},t.__init__=function(){t.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=t.shaderDefines.registerDefine("SCALEOFFSETLIGHTINGMAPUV"),t.SAHDERDEFINE_LIGHTMAP=t.shaderDefines.registerDefine("LIGHTMAP")},t.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=2,t.SAHDERDEFINE_LIGHTMAP=4,t.LIGHTMAPSCALEOFFSET=2,t.LIGHTMAP=3,n(t,["shaderDefines",function(){return this.shaderDefines=new Vt}]),t}(Pi),dn=function(e){function t(){this._intensityColor=null,this._intensity=NaN,this._shadow=!1,this._shadowFarPlane=0,this._shadowMapSize=0,this._shadowMapCount=0,this._shadowMapPCFType=0,this._parallelSplitShadowMap=null,this._lightmapBakedType=0,this.color=null,t.__super.call(this),this._intensity=1,this._intensityColor=new At,this.color=new At(1,1,1),this._shadow=!1,this._shadowFarPlane=8,this._shadowMapSize=512,this._shadowMapCount=1,this._shadowMapPCFType=0,this._lightmapBakedType=t.LIGHTMAPBAKEDTYPE_REALTIME}a(t,"laya.d3.core.light.LightSprite",Pi);var i=t.prototype;return i._parseCustomProps=function(e,t,i,n){var a=i.color,r=this.color.elements;r[0]=a[0],r[1]=a[1],r[2]=a[2]},i._addSelfRenderObjects=function(){this.lightmapBakedType!==t.LIGHTMAPBAKEDTYPE_BAKED&&this._scene._addLight(this)},i._clearSelfRenderObjects=function(){this.lightmapBakedType!==t.LIGHTMAPBAKEDTYPE_BAKED&&this._scene._removeLight(this)},i._prepareToScene=function(e){return!1},r(0,i,"lightmapBakedType",function(){return this._lightmapBakedType},function(e){this._lightmapBakedType!==e&&(this._lightmapBakedType=e,this._activeInHierarchy&&(e!==t.LIGHTMAPBAKEDTYPE_BAKED?this._scene._addLight(this):this._scene._removeLight(this)))}),r(0,i,"shadowPCFType",function(){return this._shadowMapPCFType},function(e){this._shadowMapPCFType=e,this._parallelSplitShadowMap&&this._parallelSplitShadowMap.setPCFType(e)}),r(0,i,"intensity",function(){return this._intensity},function(e){this._intensity=e}),r(0,i,"shadow",function(){return this._shadow},function(e){throw new Error("LightSprite: must override it.")}),r(0,i,"shadowDistance",function(){return this._shadowFarPlane},function(e){this._shadowFarPlane=e,this._parallelSplitShadowMap&&this._parallelSplitShadowMap.setFarDistance(e)}),r(0,i,"shadowPSSMCount",function(){return this._shadowMapCount},function(e){this._shadowMapCount=e,this._parallelSplitShadowMap&&(this._parallelSplitShadowMap.PSSMNum=e)}),r(0,i,"shadowResolution",function(){return this._shadowMapSize},function(e){this._shadowMapSize=e,this._parallelSplitShadowMap&&this._parallelSplitShadowMap.setShadowMapTextureSize(e)}),r(0,i,"diffuseColor",function(){return console.log("LightSprite: discard property,please use color property instead."),this.color},function(e){console.log("LightSprite: discard property,please use color property instead."),this.color=e}),t.LIGHTMAPBAKEDTYPE_REALTIME=0,t.LIGHTMAPBAKEDTYPE_MIXED=1,t.LIGHTMAPBAKEDTYPE_BAKED=2,t}(),_n=function(e){function t(e){this._terrainRes=null,this._lightmapScaleOffset=null,t.__super.call(this),this._lightmapScaleOffset=new Rt(1,1,0,0),e&&(this._terrainRes=e,e.loaded?this.buildTerrain(e):e.once("loaded",this,this.buildTerrain))}a(t,"laya.d3.terrain.Terrain",Pi);var n=t.prototype;return n._parseCustomProps=function(e,t,i,n){this.terrainRes=v.getRes(t[i.dataPath]);var a=i.lightmapIndex;null!=a&&this.setLightmapIndex(a);var r=i.lightmapScaleOffset;r&&this.setLightmapScaleOffset(new Rt(r[0],r[1],r[2],r[3]))},n.setLightmapIndex=function(e){for(var t=0;t<this._childs.length;t++){this._childs[t].terrainRender.lightmapIndex=e}},n.setLightmapScaleOffset=function(e){if(e){e.cloneTo(this._lightmapScaleOffset);for(var t=0;t<this._childs.length;t++){this._childs[t].terrainRender.lightmapScaleOffset=this._lightmapScaleOffset}}},n.disableLight=function(){for(var e=0,t=this._childs.length;e<t;e++)for(var i=this._childs[e],n=0,a=i._render.sharedMaterials.length;n<a;n++){i._render.sharedMaterials[n].disableLight()}},n.buildTerrain=function(e){for(var t=e._chunkNumX,i=e._chunkNumZ,n=e._heightData,a=0,r=0;r<i;r++)for(var o=0;o<t;o++){for(var s=new bn(o,r,e._gridSize,n._terrainHeightData,n._width,n._height,e._cameraCoordinateInverse),h=e._chunkInfos[a++],l=0;l<h.alphaMap.length;l++){var c=h.detailID[l].length,p=c>0?e._detailTextureInfos[h.detailID[l][0]].diffuseTexture:null,u=c>1?e._detailTextureInfos[h.detailID[l][1]].diffuseTexture:null,d=c>2?e._detailTextureInfos[h.detailID[l][2]].diffuseTexture:null,_=c>3?e._detailTextureInfos[h.detailID[l][3]].diffuseTexture:null,m=c>0?e._detailTextureInfos[h.detailID[l][0]].scale:null,f=c>1?e._detailTextureInfos[h.detailID[l][1]].scale:null,g=c>2?e._detailTextureInfos[h.detailID[l][2]].scale:null,y=c>3?e._detailTextureInfos[h.detailID[l][3]].scale:null;s.buildRenderElementAndMaterial(c,h.normalMap,h.alphaMap[l],p,u,d,_,e._materialInfo.ambientColor,e._materialInfo.diffuseColor,e._materialInfo.specularColor,m?m.x:1,m?m.y:1,f?f.x:1,f?f.y:1,g?g.x:1,g?g.y:1,y?y.x:1,y?y.y:1)}s.terrainRender.receiveShadow=!0,s.terrainRender.lightmapScaleOffset=this._lightmapScaleOffset,this.addChild(s)}},n.width=function(){return this._terrainRes._chunkNumX*zt.CHUNK_GRID_NUM*this._terrainRes._gridSize},n.depth=function(){return this._terrainRes._chunkNumZ*zt.CHUNK_GRID_NUM*this._terrainRes._gridSize},n.getHeightXZ=function(e,i){if(!this._terrainRes||!this._terrainRes.loaded)return NaN;if(e-=this.transform.position.x,i-=this.transform.position.z,t.__VECTOR3__||(t.__VECTOR3__=new At),t.__VECTOR3__.elements[0]=e,t.__VECTOR3__.elements[1]=0,t.__VECTOR3__.elements[2]=i,At.transformV3ToV3(t.__VECTOR3__,zt.__ADAPT_MATRIX_INV__,t.__VECTOR3__),e=t.__VECTOR3__.elements[0],i=t.__VECTOR3__.elements[2],e<0||e>this.width()||i<0||i>this.depth())return NaN;var n=this._terrainRes._gridSize,a=parseInt(""+e/n),r=parseInt(""+i/n),o=e-a*n,s=i-r*n,h=NaN,l=NaN,c=NaN,p=NaN,u=NaN,d=this._terrainRes._heightData;return o+s>n?(h=d._terrainHeightData[(r+1-1)*d._width+a+1],l=d._terrainHeightData[(r+1-1)*d._width+a],c=d._terrainHeightData[(r-1)*d._width+a+1],p=(n-o)/n,u=(n-s)/n,h+(l-h)*p+(c-h)*u):(h=d._terrainHeightData[Math.max(0,r-1)*d._width+a],l=d._terrainHeightData[Math.min(d._width*d._height-1,(r+1-1)*d._width+a)],c=d._terrainHeightData[Math.min(d._width*d._height-1,Math.max(0,r-1)*d._width+a+1)],p=o/n,u=s/n,h+(l-h)*u+(c-h)*p)},r(0,n,"terrainRes",null,function(e){e&&(this._terrainRes=e,e.loaded?this.buildTerrain(e):e.once("loaded",this,this.buildTerrain))}),t.load=function(e){return i.loader.create(e,null,null,t,null,1,!1)},t.RENDER_LINE_MODEL=!1,t.LOD_TOLERANCE_VALUE=4,t.LOD_DISTANCE_FACTOR=2,t.__VECTOR3__=null,t}(),mn=(function(e){function t(e,i,n){this._long=NaN,this._width=NaN,this._height=NaN,void 0===e&&(e=1),void 0===i&&(i=1),void 0===n&&(n=1),t.__super.call(this),this._long=e,this._width=i,this._height=n,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}a(t,"laya.d3.resource.models.BoxMesh",nn);var i=t.prototype;i.recreateResource=function(){this._numberVertices=24,this._numberIndices=36;var e=Ze.vertexDeclaration,t=(e.vertexStride,this._long/2),i=this._height/2,n=this._width/2,a=new Float32Array([-t,i,-n,0,1,0,0,0,t,i,-n,0,1,0,1,0,t,i,n,0,1,0,1,1,-t,i,n,0,1,0,0,1,-t,-i,-n,0,-1,0,0,1,t,-i,-n,0,-1,0,1,1,t,-i,n,0,-1,0,1,0,-t,-i,n,0,-1,0,0,0,-t,i,-n,-1,0,0,0,0,-t,i,n,-1,0,0,1,0,-t,-i,n,-1,0,0,1,1,-t,-i,-n,-1,0,0,0,1,t,i,-n,1,0,0,1,0,t,i,n,1,0,0,0,0,t,-i,n,1,0,0,0,1,t,-i,-n,1,0,0,1,1,-t,i,n,0,0,1,0,0,t,i,n,0,0,1,1,0,t,-i,n,0,0,1,1,1,-t,-i,n,0,0,1,0,1,-t,i,-n,0,0,-1,1,0,t,i,-n,0,0,-1,0,0,t,-i,-n,0,0,-1,0,1,-t,-i,-n,0,0,-1,1,1]),r=new Uint16Array([0,1,2,2,3,0,4,7,6,6,5,4,8,9,10,10,11,8,12,15,14,14,13,12,16,17,18,18,19,16,20,23,22,22,21,20]);this._vertexBuffer=new qi(e,this._numberVertices,35044,!0),this._indexBuffer=new Wi("ushort",this._numberIndices,35044,!0),this._vertexBuffer.setData(a),this._indexBuffer.setData(r),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},r(0,i,"long",function(){return this._long},function(e){this._long!==e&&(this._long=e,this.releaseResource(),this.activeResource())}),r(0,i,"width",function(){return this._width},function(e){this._width!==e&&(this._width=e,this.releaseResource(),this.activeResource())}),r(0,i,"height",function(){return this._height},function(e){this._height!==e&&(this._height=e,this.releaseResource(),this.activeResource())})}(),function(e){function t(e,i,n,a){this._radius=NaN,this._height=NaN,this._slices=0,this._stacks=0,void 0===e&&(e=.5),void 0===i&&(i=2),void 0===n&&(n=16),void 0===a&&(a=32),t.__super.call(this),this._radius=e,this._height=i<2*e?2*e:i,this._stacks=n,this._slices=a,this.recreateResource(),this._positions=this._getPositions(),this._generateBoundingObject()}a(t,"laya.d3.resource.models.CapsuleMesh",nn);var i=t.prototype;i.recreateResource=function(){this._numberVertices=(this._stacks+1)*(this.slices+1)*2+2*(this._slices+1),this._numberIndices=3*this._stacks*(this._slices+1)*2*2+2*this._slices*3;var e=Ze.vertexDeclaration,t=e.vertexStride/4,i=new Float32Array(this._numberVertices*t),n=new Uint16Array(this._numberIndices),a=Math.PI/2/this._stacks,r=2*Math.PI/this._slices,o=this._height/2-this._radius,s=0,h=0,l=0,c=0,p=0,u=0,d=0,_=0;for(d=0;d<=this._stacks;d++)for(_=0;_<=this._slices;_++)s=this._radius*Math.cos(d*a)*Math.cos(_*r+Math.PI),h=this._radius*Math.sin(d*a),l=this._radius*Math.cos(d*a)*Math.sin(_*r+Math.PI),i[c++]=s,i[c++]=h+o,i[c++]=l,i[c++]=s,i[c++]=h,i[c++]=l,i[c++]=1-_/this._slices,i[c++]=(1-d/this._stacks)*(Math.PI*this._radius/2/(this._height+Math.PI*this._radius)),d<this._stacks&&(n[p++]=d*(this._slices+1)+_+(this._slices+1),n[p++]=d*(this._slices+1)+_,n[p++]=d*(this._slices+1)+_+1,n[p++]=d*(this._slices+1)+_+this._slices,n[p++]=d*(this._slices+1)+_,n[p++]=d*(this._slices+1)+_+(this._slices+1));for(u+=(this._stacks+1)*(this._slices+1),d=0;d<=this._stacks;d++)for(_=0;_<=this._slices;_++)s=this._radius*Math.cos(d*a)*Math.cos(_*r+Math.PI),h=this._radius*Math.sin(-d*a),l=this._radius*Math.cos(d*a)*Math.sin(_*r+Math.PI),i[c++]=s,i[c++]=h-o,i[c++]=l,i[c++]=s,i[c++]=h,i[c++]=l,i[c++]=1-_/this._slices,i[c++]=(d/this._stacks*(Math.PI*this._radius/2)+(this._height+Math.PI*this._radius/2))/(this._height+Math.PI*this._radius),d<this._stacks&&(n[p++]=u+d*(this._slices+1)+_,n[p++]=u+d*(this._slices+1)+_+(this._slices+1),n[p++]=u+d*(this._slices+1)+_+1,n[p++]=u+d*(this._slices+1)+_,n[p++]=u+d*(this._slices+1)+_+this._slices,n[p++]=u+d*(this._slices+1)+_+(this._slices+1));for(u+=(this._stacks+1)*(this._slices+1),_=0;_<=this._slices;_++)s=this._radius*Math.cos(_*r+Math.PI),h=o,l=this._radius*Math.sin(_*r+Math.PI),i[c++]=s,i[c+8*(this._slices+1)-1]=s,i[c++]=h,i[c+8*(this._slices+1)-1]=-h,i[c++]=l,i[c+8*(this._slices+1)-1]=l,i[c++]=s,i[c+8*(this._slices+1)-1]=s,i[c++]=0,i[c+8*(this._slices+1)-1]=0,i[c++]=l,i[c+8*(this._slices+1)-1]=l,i[c++]=1-1*_/this._slices,i[c+8*(this._slices+1)-1]=1-1*_/this._slices,i[c++]=Math.PI*this._radius/2/(this._height+Math.PI*this._radius),i[c+8*(this._slices+1)-1]=(Math.PI*this._radius/2+this._height)/(this._height+Math.PI*this._radius);for(_=0;_<this._slices;_++)n[p++]=_+u+(this._slices+1),n[p++]=_+u+1,n[p++]=_+u,n[p++]=_+u+(this._slices+1),n[p++]=_+u+(this._slices+1)+1,n[p++]=_+u+1;u+=2*(this._slices+1),this._vertexBuffer=new qi(e,this._numberVertices,35044,!0),this._indexBuffer=new Wi("ushort",this._numberIndices,35044,!0),this._vertexBuffer.setData(i),this._indexBuffer.setData(n),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},r(0,i,"radius",function(){return this._radius},function(e){this._radius!==e&&(this._radius=e,this.releaseResource(),this.activeResource())}),r(0,i,"height",function(){return this._height},function(e){this._height!==e&&(this._height=e,this.releaseResource(),this.activeResource())}),r(0,i,"stacks",function(){return this._stacks},function(e){this._stacks!==e&&(this._stacks=e,this.releaseResource(),this.activeResource())}),r(0,i,"slices",function(){return this._slices},function(e){this._slices!==e&&(this._slices=e,this.releaseResource(),this.activeResource())})}(),function(e){function t(e,i,n){this._radius=NaN,this._height=NaN,this._slices=0,void 0===e&&(e=.5),void 0===i&&(i=2),void 0===n&&(n=32),t.__super.call(this),this._radius=e,this._height=i,this._slices=n,this.recreateResource(),this._positions=this._getPositions(),this._generateBoundingObject()}a(t,"laya.d3.resource.models.CylinderMesh",nn);var i=t.prototype;i.recreateResource=function(){this._numberVertices=this._slices+1+1+2*(this._slices+1)+(this._slices+1+1),this._numberIndices=3*this._slices+6*this._slices+3*this._slices;for(var e=Ze.vertexDeclaration,t=e.vertexStride/4,i=new Float32Array(this._numberVertices*t),n=new Uint16Array(this._numberIndices),a=2*Math.PI/this._slices,r=this._height/2,o=0,s=0,h=0,l=0,c=0,p=0,u=0,d=0;d<=this._slices;d++)0===d&&(i[p++]=0,i[p++]=r,i[p++]=0,i[p++]=0,i[p++]=1,i[p++]=0,i[p++]=.5,i[p++]=.5),o=d*a,h=Math.cos(o)*this._radius,l=r,c=Math.sin(o)*this._radius,i[p++]=h,i[p++]=l,i[p++]=c,i[p++]=0,i[p++]=1,i[p++]=0,i[p++]=.5+.5*Math.cos(o),i[p++]=.5+.5*Math.sin(o);for(var _=0;_<this._slices;_++)n[u++]=0,n[u++]=_+1,n[u++]=_+2;s+=this._slices+1+1;for(var m=0;m<=this._slices;m++)o=m*a,h=Math.cos(o+Math.PI)*this._radius,l=r,c=Math.sin(o+Math.PI)*this._radius,i[p++]=h,i[p+8*(this._slices+1)-1]=h,i[p++]=l,i[p+8*(this._slices+1)-1]=-l,i[p++]=c,i[p+8*(this._slices+1)-1]=c,i[p++]=h,i[p+8*(this._slices+1)-1]=h,i[p++]=0,i[p+8*(this._slices+1)-1]=0,i[p++]=c,i[p+8*(this._slices+1)-1]=c,i[p++]=1-1*m/this._slices,i[p+8*(this._slices+1)-1]=1-1*m/this._slices,i[p++]=0,i[p+8*(this._slices+1)-1]=1;p+=8*(this._slices+1);for(var f=0;f<this._slices;f++)n[u++]=f+s+(this._slices+1),n[u++]=f+s+1,n[u++]=f+s,n[u++]=f+s+(this._slices+1),n[u++]=f+s+(this._slices+1)+1,n[u++]=f+s+1;s+=2*(this._slices+1);for(var g=0;g<=this._slices;g++)0===g&&(i[p++]=0,i[p++]=-r,i[p++]=0,i[p++]=0,i[p++]=-1,i[p++]=0,i[p++]=.5,i[p++]=.5),o=g*a,h=Math.cos(o+Math.PI)*this._radius,l=-r,c=Math.sin(o+Math.PI)*this._radius,i[p++]=h,i[p++]=l,i[p++]=c,i[p++]=0,i[p++]=-1,i[p++]=0,i[p++]=.5+.5*Math.cos(o),i[p++]=.5+.5*Math.sin(o);for(var y=0;y<this._slices;y++)n[u++]=0+s,n[u++]=y+2+s,n[u++]=y+1+s;s+=this._slices+1+1,this._vertexBuffer=new qi(e,this._numberVertices,35044,!0),this._indexBuffer=new Wi("ushort",this._numberIndices,35044,!0),this._vertexBuffer.setData(i),this._indexBuffer.setData(n),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},r(0,i,"radius",function(){return this._radius},function(e){this._radius!==e&&(this._radius=e,this.releaseResource(),this.activeResource())}),r(0,i,"height",function(){return this._height},function(e){this._height!==e&&(this._height=e,this.releaseResource(),this.activeResource())}),r(0,i,"slices",function(){return this._slices},function(e){this._slices!==e&&(this._slices=e,this.releaseResource(),this.activeResource())})}(),function(e){function t(e,i,n,a){this._long=NaN,this._width=NaN,this._stacks=0,this._slices=0,void 0===e&&(e=10),void 0===i&&(i=10),void 0===n&&(n=10),void 0===a&&(a=10),t.__super.call(this),this._long=e,this._width=i,this._stacks=n,this._slices=a,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}a(t,"laya.d3.resource.models.PlaneMesh",nn);var i=t.prototype;i.recreateResource=function(){this._numberVertices=(this._stacks+1)*(this._slices+1),this._numberIndices=this._stacks*this._slices*2*3;for(var e=new Uint16Array(this._numberIndices),t=Ze.vertexDeclaration,i=t.vertexStride/4,n=new Float32Array(this._numberVertices*i),a=this._long/2,r=this._width/2,o=this._long/this._stacks,s=this._width/this._slices,h=0,l=0;l<=this._slices;l++)for(var c=0;c<=this._stacks;c++)n[h++]=c*o-a,n[h++]=0,n[h++]=l*s-r,n[h++]=0,n[h++]=1,n[h++]=0,n[h++]=1*c/this._stacks,n[h++]=1*l/this._slices;var p=0;for(l=0;l<this._slices;l++)for(c=0;c<this._stacks;c++)e[p++]=(l+1)*(this._stacks+1)+c,e[p++]=l*(this._stacks+1)+c,e[p++]=(l+1)*(this._stacks+1)+c+1,e[p++]=l*(this._stacks+1)+c,e[p++]=l*(this._stacks+1)+c+1,e[p++]=(l+1)*(this._stacks+1)+c+1;this._vertexBuffer=new qi(t,this._numberVertices,35044,!0),this._indexBuffer=new Wi("ushort",this._numberIndices,35044,!0),this._vertexBuffer.setData(n),this._indexBuffer.setData(e),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},r(0,i,"long",function(){return this._long},function(e){this._long!==e&&(this._long=e,this.releaseResource(),this.activeResource())}),r(0,i,"width",function(){return this._width},function(e){this._width!==e&&(this._width=e,this.releaseResource(),this.activeResource())}),r(0,i,"stacks",function(){return this._stacks},function(e){this._stacks!==e&&(this._stacks=e,this.releaseResource(),this.activeResource())}),r(0,i,"slices",function(){return this._slices},function(e){this._slices!==e&&(this._slices=e,this.releaseResource(),this.activeResource())})}(),function(e){function t(e,i){this._long=NaN,this._width=NaN,void 0===e&&(e=1),void 0===i&&(i=1),t.__super.call(this),this._long=e,this._width=i,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}a(t,"laya.d3.resource.models.QuadMesh",nn);var i=t.prototype;i.recreateResource=function(){this._numberVertices=4,this._numberIndices=6;var e=Ze.vertexDeclaration,t=(e.vertexStride,this._long/2),i=this._width/2,n=new Float32Array([-t,i,0,0,0,1,0,0,t,i,0,0,0,1,1,0,-t,-i,0,0,0,1,0,1,t,-i,0,0,0,1,1,1]),a=new Uint16Array([0,1,2,3,2,1]);this._vertexBuffer=new qi(e,this._numberVertices,35044,!0),this._indexBuffer=new Wi("ushort",this._numberIndices,35044,!0),this._vertexBuffer.setData(n),this._indexBuffer.setData(a),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},r(0,i,"long",function(){return this._long},function(e){this._long!==e&&(this._long=e,this.releaseResource(),this.activeResource())}),r(0,i,"width",function(){return this._width},function(e){this._width!==e&&(this._width=e,this.releaseResource(),this.activeResource())})}(),function(e){function t(e,i,n){this._radius=NaN,this._slices=0,this._stacks=0,void 0===e&&(e=.5),void 0===i&&(i=32),void 0===n&&(n=32),t.__super.call(this),this._radius=e,this._stacks=i,this._slices=n,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}a(t,"laya.d3.resource.models.SphereMesh",nn);var i=t.prototype;i.recreateResource=function(){this._numberVertices=(this._stacks+1)*(this._slices+1),this._numberIndices=3*this._stacks*(this._slices+1)*2;for(var e=new Uint16Array(this._numberIndices),t=Ze.vertexDeclaration,i=t.vertexStride/4,n=new Float32Array(this._numberVertices*i),a=Math.PI/this._stacks,r=2*Math.PI/this._slices,o=0,s=0,h=0,l=0;l<this._stacks+1;l++)for(var c=Math.sin(l*a),p=Math.cos(l*a),u=0;u<this._slices+1;u++){var d=c*Math.sin(u*r+1*Math.PI/2),_=c*Math.cos(u*r+1*Math.PI/2);n[s+0]=d*this._radius,n[s+1]=p*this._radius,n[s+2]=_*this._radius,n[s+3]=d,n[s+4]=p,n[s+5]=_,n[s+6]=u/this._slices,n[s+7]=l/this._stacks,s+=i,l!=this._stacks-1&&(e[h++]=o+(this._slices+1),e[h++]=o,e[h++]=o+1,e[h++]=o+this._slices,e[h++]=o,e[h++]=o+(this._slices+1),o++)}this._vertexBuffer=new qi(t,this._numberVertices,35044,!0),this._indexBuffer=new Wi("ushort",this._numberIndices,35044,!0),this._vertexBuffer.setData(n),this._indexBuffer.setData(e),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},r(0,i,"radius",function(){return this._radius},function(e){this._radius!==e&&(this._radius=e,this.releaseResource(),this.activeResource())}),r(0,i,"slices",function(){return this._slices},function(e){this._slices!==e&&(this._slices=e,this.releaseResource(),this.activeResource())}),r(0,i,"stacks",function(){return this._stacks},function(e){this._stacks!==e&&(this._stacks=e,this.releaseResource(),this.activeResource())})}(),function(e){function t(e,i,n){void 0===e&&(e=0),void 0===i&&(i=.3),void 0===n&&(n=1e3),this._viewMatrix=new Ct,this._projectionMatrix=new Ct,this._projectionViewMatrix=new Ct,this._viewport=new Bt(0,0,0,0),this._normalizedViewport=new Bt(0,0,1,1),this._aspectRatio=e,this._boundFrustumUpdate=!0,this._boundFrustum=new bt(Ct.DEFAULT),t.__super.call(this,i,n),this.transform.on("worldmatrixneedchanged",this,this._onWorldMatrixChanged)}a(t,"laya.d3.core.Camera",pn);var o=t.prototype;return o._onWorldMatrixChanged=function(){this._boundFrustumUpdate=!0},o._parseCustomProps=function(e,t,i,n){var a=i.clearColor;this.clearColor=new Rt(a[0],a[1],a[2],a[3]);var r=i.viewport;this.normalizedViewport=new Bt(r[0],r[1],r[2],r[3])},o._calculateProjectionMatrix=function(){if(!this._useUserProjectionMatrix)if(this._orthographic){var e=this.orthographicVerticalSize*this.aspectRatio*.5,t=.5*this.orthographicVerticalSize;Ct.createOrthoOffCenterRH(-e,e,-t,t,this.nearPlane,this.farPlane,this._projectionMatrix)}else Ct.createPerspective(3.1416*this.fieldOfView/180,this.aspectRatio,this.nearPlane,this.farPlane,this._projectionMatrix);this._boundFrustumUpdate=!0},o._update=function(e){this.conchModel&&(this.conchModel.setViewMatrix(this.viewMatrix.elements),this.conchModel.setProjectMatrix(this.projectionMatrix.elements)),laya.d3.core.Sprite3D.prototype._update.call(this,e)},o._renderCamera=function(e,t,i){i.parallelSplitShadowMaps[0]&&i._renderShadowMap(e,t,this),t.camera=this,this._prepareCameraToRender(),i._preRenderUpdateComponents(t);var n,a;n=t._viewMatrix=this.viewMatrix;var r=this._renderTarget;r?(r.start(),Ct.multiply(pn._invertYScaleMatrix,this._projectionMatrix,pn._invertYProjectionMatrix),Ct.multiply(pn._invertYScaleMatrix,this.projectionViewMatrix,pn._invertYProjectionViewMatrix),a=t._projectionMatrix=pn._invertYProjectionMatrix,t._projectionViewMatrix=pn._invertYProjectionViewMatrix):(a=t._projectionMatrix=this._projectionMatrix,t._projectionViewMatrix=this.projectionViewMatrix),this._prepareCameraViewProject(n,a),t._viewport=this.viewport,i._preRenderScene(e,t,this.boundFrustum),i._clear(e,t),i._renderScene(e,t),i._postRenderUpdateComponents(t),r&&r.end()},o.viewportPointToRay=function(e,t){Wt.calculateCursorRay(e,this.viewport,this._projectionMatrix,this.viewMatrix,null,t)},o.normalizedViewportPointToRay=function(e,i){var n=t._tempVector20,a=this.viewport,r=e.elements,o=n.elements;o[0]=r[0]*a.width,o[1]=r[1]*a.height,Wt.calculateCursorRay(n,this.viewport,this._projectionMatrix,this.viewMatrix,null,i)},o.worldToViewportPoint=function(e,t){Ct.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.viewport.project(e,this._projectionViewMatrix,t);var n=t.elements;n[0]=n[0]/i.stage.clientScaleX,n[1]=n[1]/i.stage.clientScaleY},o.worldToNormalizedViewportPoint=function(e,t){Ct.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.normalizedViewport.project(e,this._projectionViewMatrix,t);var n=t.elements;n[0]=n[0]/i.stage.clientScaleX,n[1]=n[1]/i.stage.clientScaleY},o.convertScreenCoordToOrthographicCoord=function(e,t){if(this._orthographic){var i=ue.clientWidth,n=ue.clientHeight,a=this.orthographicVerticalSize*this.aspectRatio/i,r=this.orthographicVerticalSize/n,o=e.elements,s=t.elements;return s[0]=(-i/2+o[0])*a,s[1]=(n/2-o[1])*r,s[2]=(this.nearPlane-this.farPlane)*(o[2]+1)/2-this.nearPlane,At.transformCoordinate(t,this.transform.worldMatrix,t),!0}return!1},r(0,o,"projectionViewMatrix",function(){return Ct.multiply(this.projectionMatrix,this.viewMatrix,this._projectionViewMatrix),this._projectionViewMatrix}),r(0,o,"aspectRatio",function(){if(0===this._aspectRatio){var e=this.viewport;return e.width/e.height}return this._aspectRatio},function(e){if(e<0)throw new Error("Camera: the aspect ratio has to be a positive real number.");this._aspectRatio=e,this._calculateProjectionMatrix()}),r(0,o,"boundFrustum",function(){return this._boundFrustumUpdate&&(this._boundFrustum.matrix=this.projectionViewMatrix),this._boundFrustum}),r(0,o,"needViewport",function(){var e=this.normalizedViewport;return 0===e.x&&0===e.y&&1===e.width&&1===e.height}),r(0,o,"viewport",function(){if(this._viewportExpressedInClipSpace){var e=this._normalizedViewport,t=this.renderTargetSize,i=t.width,n=t.height;this._viewport.x=e.x*i,this._viewport.y=e.y*n,this._viewport.width=e.width*i,this._viewport.height=e.height*n}return this._viewport},function(e){if(null!=this.renderTarget&&(e.x<0||e.y<0||0==e.width||0==e.height))throw new Error("Camera: viewport size invalid.","value");this._viewportExpressedInClipSpace=!1,this._viewport=e,this._calculateProjectionMatrix()}),r(0,o,"normalizedViewport",function(){if(!this._viewportExpressedInClipSpace){var e=this._viewport,t=this.renderTargetSize,i=t.width,n=t.height;this._normalizedViewport.x=e.x/i,this._normalizedViewport.y=e.y/n,this._normalizedViewport.width=e.width/i,this._normalizedViewport.height=e.height/n}return this._normalizedViewport},function(e){e.x<0&&(e.x=0,console.warn("Camera: viewport.x must large than 0.0.")),e.y<0&&(e.y=0,console.warn("Camera: viewport.y must large than 0.0.")),e.x+e.width>1&&(e.width=1-e.x,console.warn("Camera: viewport.width + viewport.x must less than 1.0.")),e.y+e.height>1&&(e.height=1-e.y,console.warn("Camera: viewport.height + viewport.y must less than 1.0.")),this._viewportExpressedInClipSpace=!0,this._normalizedViewport=e,this._calculateProjectionMatrix()}),r(0,o,"projectionMatrix",function(){return this._projectionMatrix},function(e){this._projectionMatrix=e,this._useUserProjectionMatrix=!0}),r(0,o,"viewMatrix",function(){return this.transform.worldMatrix.invert(this._viewMatrix),this._viewMatrix}),n(t,["_tempVector20",function(){return this._tempVector20=new Nt}]),t}()),fn=(function(e){function t(){t.__super.call(this),this._render=new Mi(this),this._render.on("materialchanged",this,this._onMaterialChanged);var e=new Fi;this._render.sharedMaterial=e,this._geometryFilter=new Ni(this),e.renderMode=8,this._changeRenderObject(0)}a(t,"laya.d3.core.glitter.Glitter",e);var i=t.prototype;i._changeRenderObject=function(e){var t=this._render._renderElements,i=t[e];i||(i=t[e]=new ce),i._render=this._render;var n=this._render.sharedMaterials[e];n||(n=Fi.defaultMaterial);var a=this._geometryFilter;return i._mainSortID=0,i._sprite3D=this,i.renderObj=a,i._material=n,i},i._onMaterialChanged=function(e,t,i){t<e._renderElements.length&&this._changeRenderObject(t)},i._clearSelfRenderObjects=function(){this.scene.removeFrustumCullingObject(this._render)},i._addSelfRenderObjects=function(){this.scene.addFrustumCullingObject(this._render)},i._update=function(t){this._geometryFilter._update(t.elapsedTime),e.prototype._update.call(this,t)},i.addGlitterByPositions=function(e,t){this._geometryFilter.addVertexPosition(e,t)},i.addGlitterByPositionsVelocitys=function(e,t,i,n){this._geometryFilter.addVertexPositionVelocity(e,t,i,n)},i.cloneTo=function(e){var t=e,i=t.templet,n=this._geometryFilter;i.lifeTime=n.lifeTime,i.minSegmentDistance=n.minSegmentDistance,i.minInterpDistance=n.minInterpDistance,i.maxSlerpCount=n.maxSlerpCount,i._maxSegments=n._maxSegments;var a=t._render,r=this._render;a.sharedMaterials=r.sharedMaterials,a.enable=r.enable,laya.d3.core.Sprite3D.prototype.cloneTo.call(this,e)},i.destroy=function(t){void 0===t&&(t=!0),this.destroyed||(e.prototype.destroy.call(this,t),this._geometryFilter._destroy(),this._geometryFilter=null)},r(0,i,"templet",function(){return this._geometryFilter}),r(0,i,"glitterRender",function(){return this._render}),t.CURRENTTIME=2,t.DURATION=3}(un),function(e){function t(){this._direction=null,this._updateDirection=!1,t.__super.call(this),this._updateDirection=!1,this._direction=new At,this.transform.on("worldmatrixneedchanged",this,this._onWorldMatrixChange)}a(t,"laya.d3.core.light.DirectionLight",e);var i=t.prototype;return i._initShadow=function(){if(this._shadow)this._parallelSplitShadowMap=new Ht,this.scene.parallelSplitShadowMaps.push(this._parallelSplitShadowMap),this.transform.worldMatrix.getForward(this._direction),At.normalize(this._direction,this._direction),this._parallelSplitShadowMap.setInfo(this.scene,this._shadowFarPlane,this._direction,this._shadowMapSize,this._shadowMapCount,this._shadowMapPCFType);else{var e=this.scene.parallelSplitShadowMaps;e.splice(e.indexOf(this._parallelSplitShadowMap),1),this._parallelSplitShadowMap.disposeAllRenderTarget(),this._parallelSplitShadowMap=null,this.scene.removeShaderDefine(Ht.SHADERDEFINE_SHADOW_PSSM1),this.scene.removeShaderDefine(Ht.SHADERDEFINE_SHADOW_PSSM2),this.scene.removeShaderDefine(Ht.SHADERDEFINE_SHADOW_PSSM3)}},i._addSelfRenderObjects=function(){e.prototype._addSelfRenderObjects.call(this),this._shadow&&this._initShadow()},i._clearSelfRenderObjects=function(){var e=this.scene,t=e._shaderValues;t.setValue(4,null),t.setValue(3,null),e.removeShaderDefine(ci.SHADERDEFINE_DIRECTIONLIGHT)},i._prepareToScene=function(e){var t=e.scene;if(t.enableLight&&this._activeInHierarchy){var i=t._shaderValues;return t.addShaderDefine(ci.SHADERDEFINE_DIRECTIONLIGHT),At.scale(this.color,this._intensity,this._intensityColor),i.setValue(4,this._intensityColor.elements),this.transform.worldMatrix.getForward(this._direction),At.normalize(this._direction,this._direction),i.setValue(3,this._direction.elements),!0}return t.removeShaderDefine(ci.SHADERDEFINE_DIRECTIONLIGHT),!1},i._onWorldMatrixChange=function(){this._updateDirection=!0},r(0,i,"shadow",e.prototype._$get_shadow,function(e){this._shadow!==e&&(this._shadow=e,this.scene&&this._initShadow())}),r(0,i,"direction",function(){return console.log("Warning: discard property,please use transform's property instead."),this._updateDirection&&(this.transform.worldMatrix.getForward(this._direction),At.normalize(this._direction,this._direction),this._updateDirection=!1),this._direction},function(e){console.log("Warning: discard property,please use transform's property instead.");var t=this.transform.worldMatrix;t.setForward(e),this.transform.worldMatrix=t,At.normalize(e,e),this._direction=e,this.shadow&&this._parallelSplitShadowMap&&this._parallelSplitShadowMap._setGlobalParallelLightDir(this._direction)}),t}(dn)),gn=(function(e){function t(){this._range=NaN,this._attenuation=null,t.__super.call(this),this._range=6,this._attenuation=new At(.6,.6,.6)}a(t,"laya.d3.core.light.PointLight",dn);var i=t.prototype;i._clearSelfRenderObjects=function(){var e=this.scene,t=e._shaderValues;t.setValue(8,null),t.setValue(5,null),t.setValue(6,null),t.setValue(7,null),e.removeShaderDefine(ci.SHADERDEFINE_POINTLIGHT)},i._prepareToScene=function(e){var t=e.scene;if(t.enableLight&&this._activeInHierarchy){var i=t._shaderValues;return t.addShaderDefine(ci.SHADERDEFINE_POINTLIGHT),At.scale(this.color,this._intensity,this._intensityColor),i.setValue(8,this._intensityColor.elements),i.setValue(5,this.transform.position.elements),i.setValue(6,this.range),i.setValue(7,this.attenuation.elements),!0}return t.removeShaderDefine(ci.SHADERDEFINE_POINTLIGHT),!1},r(0,i,"range",function(){return this._range},function(e){this._range=e}),r(0,i,"attenuation",function(){return this._attenuation},function(e){this._attenuation=e})}(),function(e){function t(){this._updateDirection=!1,this._direction=null,this._spot=NaN,this._range=NaN,this._attenuation=null,t.__super.call(this),this._updateDirection=!1,this.direction=new At(0,-1,-1),this._attenuation=new At(.6,.6,.6),this._spot=96,this._range=6,this.transform.on("worldmatrixneedchanged",this,this._onWorldMatrixChange)}a(t,"laya.d3.core.light.SpotLight",dn);var i=t.prototype;i._onWorldMatrixChange=function(){this._updateDirection=!0},i._clearSelfRenderObjects=function(){var e=this.scene,t=e._shaderValues;t.setValue(14,null),t.setValue(9,null),t.setValue(10,null),t.setValue(12,null),t.setValue(11,null),t.setValue(13,null),e.removeShaderDefine(ci.SHADERDEFINE_SPOTLIGHT)},i._prepareToScene=function(e){var t=e.scene;if(t.enableLight&&this._activeInHierarchy){var i=t._shaderValues;return t.addShaderDefine(ci.SHADERDEFINE_SPOTLIGHT),At.scale(this.color,this._intensity,this._intensityColor),i.setValue(14,this._intensityColor.elements),i.setValue(9,this.transform.position.elements),this.transform.worldMatrix.getForward(this._direction),At.normalize(this._direction,this._direction),i.setValue(10,this._direction.elements),i.setValue(12,this.range),i.setValue(11,this.spot),i.setValue(13,this.attenuation.elements),!0}return t.removeShaderDefine(ci.SHADERDEFINE_SPOTLIGHT),!1},r(0,i,"spot",function(){return this._spot},function(e){this._spot=e}),r(0,i,"direction",function(){return console.log("Warning: discard property,please use transform's property instead."),this._updateDirection&&(this.transform.worldMatrix.getForward(this._direction),this._updateDirection=!1),this._direction},function(e){console.log("Warning: discard property,please use transform's property instead.");var t=this.transform.worldMatrix;t.setForward(e),this.transform.worldMatrix=t,this._direction=e}),r(0,i,"range",function(){return this._range},function(e){this._range=e}),r(0,i,"attenuation",function(){return this._attenuation},function(e){this._attenuation=e})}(),function(e){function t(e,i){t.__super.call(this,i),this._geometryFilter=new Ci(this),this._render=new ki(this),this._geometryFilter.on("meshchanged",this,this._onMeshChanged),this._render.on("materialchanged",this,this._onMaterialChanged),e&&(this._geometryFilter.sharedMesh=e,e instanceof laya.d3.resource.models.Mesh&&(e.loaded?this._render.sharedMaterials=e.materials:e.once("loaded",this,this._applyMeshMaterials)))}a(t,"laya.d3.core.MeshSprite3D",e);var o=t.prototype;return o._changeRenderObjectByMesh=function(e){var t=this._render._renderElements,i=t[e];i||(i=t[e]=new li),i._render=this._render;var n=this._render.sharedMaterials[e];n||(n=Yi.defaultMaterial);var a=this._geometryFilter.sharedMesh.getRenderElement(e);return i._mainSortID=this._getSortID(a,n),i._sprite3D=this,i.renderObj=a,i._material=n,i},o._changeRenderObjectByMaterial=function(e,t){var i=this._render._renderElements[e];t||(t=Yi.defaultMaterial);var n=this._geometryFilter.sharedMesh.getRenderElement(e);return i._mainSortID=this._getSortID(n,t),i._sprite3D=this,i.renderObj=n,i._material=t,i},o._changeRenderObjectsByMesh=function(){var e=this._geometryFilter.sharedMesh.getRenderElementsCount();this._render._renderElements.length=e;for(var t=0;t<e;t++)this._changeRenderObjectByMesh(t)},o._onMeshChanged=function(e){var t=e.sharedMesh;t.loaded?this._changeRenderObjectsByMesh():t.once("loaded",this,this._onMeshLoaded)},o._onMeshLoaded=function(e){e===this.meshFilter.sharedMesh&&this._changeRenderObjectsByMesh()},o._onMaterialChanged=function(e,t,i){t<this._render._renderElements.length&&this._changeRenderObjectByMaterial(t,i)},o._clearSelfRenderObjects=function(){this.scene.removeFrustumCullingObject(this._render)},o._addSelfRenderObjects=function(){this.scene.addFrustumCullingObject(this._render)},o._parseCustomProps=function(e,t,i,n){var a=this.meshRender,r=i.lightmapIndex;null!=r&&(a.lightmapIndex=r);var o=i.lightmapScaleOffset;o&&(a.lightmapScaleOffset=new Rt(o[0],o[1],o[2],o[3]));var s,h;if(n.instanceParams)(s=n.instanceParams.loadPath)&&(h=v.getRes(t[s]),this.meshFilter.sharedMesh=h,h.loaded?a.sharedMaterials=h.materials:h.once("loaded",this,this._applyMeshMaterials));else{(s=i.meshPath)&&(h=v.getRes(t[s]),this.meshFilter.sharedMesh=h);var l=i.materials;if(l){var c=a.sharedMaterials,p=l.length;c.length=p;for(var u=0;u<p;u++)c[u]=v.getRes(t[l[u].path]);a.sharedMaterials=c}}},o._applyMeshMaterials=function(e){for(var t=this._render.sharedMaterials,i=e.materials,n=0,a=i.length;n<a;n++)t[n]||(t[n]=i[n]);this._render.sharedMaterials=t},o._addToInitStaticBatchManager=function(){t._staticBatchManager._addInitBatchSprite(this)},o.cloneTo=function(e){var t=e;t._geometryFilter.sharedMesh=this._geometryFilter.sharedMesh;var i=this._render,n=t._render;n.enable=i.enable,n.sharedMaterials=i.sharedMaterials,n.castShadow=i.castShadow;var a=i.lightmapScaleOffset;a&&(n.lightmapScaleOffset=a.clone()),n.lightmapIndex=i.lightmapIndex,n.receiveShadow=i.receiveShadow,n.sortingFudge=i.sortingFudge,laya.d3.core.Sprite3D.prototype.cloneTo.call(this,e)},o.destroy=function(t){if(void 0===t&&(t=!0),!this.destroyed){var i=this.meshFilter.sharedMesh;i.loaded||i.off("loaded",this,this._applyMeshMaterials),e.prototype.destroy.call(this,t),this._geometryFilter._destroy()}},r(0,o,"meshFilter",function(){return this._geometryFilter}),r(0,o,"meshRender",function(){return this._render}),t.__init__=function(){Ie._staticBatchManagers.push(t._staticBatchManager)},t.load=function(e){return i.loader.create(e,null,null,t)},n(t,["_staticBatchManager",function(){return this._staticBatchManager=new pi}]),t}(un)),yn=function(e){function t(e){t.__super.call(this),this._render=new Ti(this),this._render.on("materialchanged",this,this._onMaterialChanged),this._geometryFilter=new Ei(this),this._createRenderElement(0),e&&(this._render.sharedMaterial=e)}a(t,"laya.d3.core.particleShuriKen.ShuriKenParticle3D",e);var o=t.prototype;return o._initParticleVelocity=function(e){for(var t=new Q,i=e.velocitys,n=0,a=i.length;n<a;n++){var r=i[n];t.add(r.key,r.value)}return t},o._initParticleColor=function(e){var t=new J,i=e.alphas,n=0,a=0;for(n=0,a=i.length;n<a;n++){var r=i[n];t.addAlpha(r.key,r.value)}var o=e.rgbs;for(n=0,a=o.length;n<a;n++){var s=o[n],h=s.value;t.addRGB(s.key,new At(h[0],h[1],h[2]))}return t},o._initParticleSize=function(e){for(var t=new Q,i=e.sizes,n=0,a=i.length;n<a;n++){var r=i[n];t.add(r.key,r.value)}return t},o._initParticleRotation=function(e){for(var t=new Q,i=e.angularVelocitys,n=0,a=i.length;n<a;n++){var r=i[n];t.add(r.key,r.value/180*Math.PI)}return t},o._initParticleFrame=function(e){for(var t=new Z,i=e.frames,n=0,a=i.length;n<a;n++){var r=i[n];t.add(r.key,r.value)}return t},o._createRenderElement=function(e){var t=this._render._renderElements[e]=new ce;t._render=this._render;var i=this._render.sharedMaterials[e];i||(i=Ki.defaultMaterial);var n=this._geometryFilter;t._mainSortID=0,t._sprite3D=this,t.renderObj=n,t._material=i},o._onMaterialChanged=function(e,t,i){var n=e._renderElements;if(t<n.length){n[t]._material=i||Ki.defaultMaterial}},o._clearSelfRenderObjects=function(){this.scene.removeFrustumCullingObject(this._render)},o._addSelfRenderObjects=function(){this.scene.addFrustumCullingObject(this._render)},o._parseCustomProps=function(e,i,n,a){var r,o=Math.PI/180,s=0,h=0,l=this.particleRender,c=n.material;if(c)r=v.getRes(i[c.path]);else{var p=n.materialPath;p?r=v.getRes(i[p]):(r=new Ki).diffuseTexture=i?v.getRes(i[n.texturePath]):hn.load(n.texturePath)}l.sharedMaterial=r;var u=n.meshPath;u&&(l.mesh=v.getRes(i[u])),l.renderMode=n.renderMode,l.stretchedBillboardCameraSpeedScale=n.stretchedBillboardCameraSpeedScale,l.stretchedBillboardSpeedScale=n.stretchedBillboardSpeedScale,l.stretchedBillboardLengthScale=n.stretchedBillboardLengthScale,l.sortingFudge=n.sortingFudge?n.sortingFudge:0;var d=this.particleSystem;d.isPerformanceMode=n.isPerformanceMode,d.duration=n.duration,d.looping=n.looping,d.prewarm=n.prewarm,d.startDelayType=n.startDelayType,d.startDelay=n.startDelay,d.startDelayMin=n.startDelayMin,d.startDelayMax=n.startDelayMax,d.startLifetimeType=n.startLifetimeType,d.startLifetimeConstant=n.startLifetimeConstant,d.startLifeTimeGradient=t._initStartLife(n.startLifetimeGradient),d.startLifetimeConstantMin=n.startLifetimeConstantMin,d.startLifetimeConstantMax=n.startLifetimeConstantMax,d.startLifeTimeGradientMin=t._initStartLife(n.startLifetimeGradientMin),d.startLifeTimeGradientMax=t._initStartLife(n.startLifetimeGradientMax),d.startSpeedType=n.startSpeedType,d.startSpeedConstant=n.startSpeedConstant,d.startSpeedConstantMin=n.startSpeedConstantMin,d.startSpeedConstantMax=n.startSpeedConstantMax,d.threeDStartSize=n.threeDStartSize,d.startSizeType=n.startSizeType,d.startSizeConstant=n.startSizeConstant;var _=n.startSizeConstantSeparate,m=d.startSizeConstantSeparate.elements;m[0]=_[0],m[1]=_[1],m[2]=_[2],d.startSizeConstantMin=n.startSizeConstantMin,d.startSizeConstantMax=n.startSizeConstantMax;var f=n.startSizeConstantMinSeparate,g=d.startSizeConstantMinSeparate.elements;g[0]=f[0],g[1]=f[1],g[2]=f[2];var y=n.startSizeConstantMaxSeparate,x=d.startSizeConstantMaxSeparate.elements;x[0]=y[0],x[1]=y[1],x[2]=y[2],d.threeDStartRotation=n.threeDStartRotation,d.startRotationType=n.startRotationType,d.startRotationConstant=n.startRotationConstant*o;var b=n.startRotationConstantSeparate,w=d.startRotationConstantSeparate.elements;w[0]=b[0]*o,w[1]=b[1]*o,w[2]=b[2]*o,d.startRotationConstantMin=n.startRotationConstantMin*o,d.startRotationConstantMax=n.startRotationConstantMax*o;var S=n.startRotationConstantMinSeparate,I=d.startRotationConstantMinSeparate.elements;I[0]=S[0]*o,I[1]=S[1]*o,I[2]=S[2]*o;var M=n.startRotationConstantMaxSeparate,C=d.startRotationConstantMaxSeparate.elements;C[0]=M[0]*o,C[1]=M[1]*o,C[2]=M[2]*o,d.randomizeRotationDirection=n.randomizeRotationDirection,d.startColorType=n.startColorType;var k=n.startColorConstant,E=d.startColorConstant.elements;E[0]=k[0],E[1]=k[1],E[2]=k[2],E[3]=k[3];var T=n.startColorConstantMin,L=d.startColorConstantMin.elements;L[0]=T[0],L[1]=T[1],L[2]=T[2],L[3]=T[3];var D=n.startColorConstantMax,N=d.startColorConstantMax.elements;N[0]=D[0],N[1]=D[1],N[2]=D[2],N[3]=D[3],d.gravityModifier=n.gravityModifier,d.simulationSpace=n.simulationSpace,d.scaleMode=n.scaleMode,d.playOnAwake=n.playOnAwake,d.maxParticles=n.maxParticles;var A=n.autoRandomSeed;null!=A&&(d.autoRandomSeed=A);var R=n.randomSeed;null!=R&&(d.randomSeed[0]=R);var B=n.emission,P=d.emission;if(B){P.emissionRate=B.emissionRate;var O=B.bursts;if(O)for(s=0,h=O.length;s<h;s++){var V=O[s];P.addBurst(new Y(V.time,V.min,V.max))}P.enbale=B.enable}else P.enbale=!1;var U=n.shape;if(U){var F;switch(U.shapeType){case 0:var H;F=H=new hi,H.radius=U.sphereRadius,H.emitFromShell=U.sphereEmitFromShell,H.randomDirection=U.sphereRandomDirection;break;case 1:var z;F=z=new si,z.radius=U.hemiSphereRadius,z.emitFromShell=U.hemiSphereEmitFromShell,z.randomDirection=U.hemiSphereRandomDirection;break;case 2:var X;F=X=new oi,X.angle=U.coneAngle*o,X.radius=U.coneRadius,X.length=U.coneLength,X.emitType=U.coneEmitType,X.randomDirection=U.coneRandomDirection;break;case 3:var j;F=j=new ai,j.x=U.boxX,j.y=U.boxY,j.z=U.boxZ,j.randomDirection=U.boxRandomDirection;break;case 7:var J;F=J=new ri,J.radius=U.circleRadius,J.arc=U.circleArc*o,J.emitFromEdge=U.circleEmitFromEdge,J.randomDirection=U.circleRandomDirection;break;default:var Z;F=Z=new ri,Z.radius=U.circleRadius,Z.arc=U.circleArc*o,Z.emitFromEdge=U.circleEmitFromEdge,Z.randomDirection=U.circleRandomDirection}F.enable=U.enable,d.shape=F}var Q=n.velocityOverLifetime;if(Q){var ie,ne=Q.velocity;switch(ne.type){case 0:var he=ne.constant;ie=ee.createByConstant(new At(he[0],he[1],he[2]));break;case 1:ie=ee.createByGradient(this._initParticleVelocity(ne.gradientX),this._initParticleVelocity(ne.gradientY),this._initParticleVelocity(ne.gradientZ));break;case 2:var le=ne.constantMin,ce=ne.constantMax;ie=ee.createByRandomTwoConstant(new At(le[0],le[1],le[2]),new At(ce[0],ce[1],ce[2]));break;case 3:ie=ee.createByRandomTwoGradient(this._initParticleVelocity(ne.gradientXMin),this._initParticleVelocity(ne.gradientXMax),this._initParticleVelocity(ne.gradientYMin),this._initParticleVelocity(ne.gradientYMax),this._initParticleVelocity(ne.gradientZMin),this._initParticleVelocity(ne.gradientZMax))}var pe=new se(ie);pe.space=Q.space,pe.enbale=Q.enable,d.velocityOverLifetime=pe}var ue=n.colorOverLifetime;if(ue){var de,_e=ue.color;switch(_e.type){case 0:var me=_e.constant;de=K.createByConstant(new Rt(me[0],me[1],me[2],me[3]));break;case 1:de=K.createByGradient(this._initParticleColor(_e.gradient));break;case 2:var fe=_e.constantMin,ge=_e.constantMax;de=K.createByRandomTwoConstant(new Rt(fe[0],fe[1],fe[2],fe[3]),new Rt(ge[0],ge[1],ge[2],ge[3]));break;case 3:de=K.createByRandomTwoGradient(this._initParticleColor(_e.gradientMin),this._initParticleColor(_e.gradientMax))}var ye=new G(de);ye.enbale=ue.enable,d.colorOverLifetime=ye}var ve=n.sizeOverLifetime;if(ve){var xe,be=ve.size;switch(be.type){case 0:xe=be.separateAxes?$.createByGradientSeparate(this._initParticleSize(be.gradientX),this._initParticleSize(be.gradientY),this._initParticleSize(be.gradientZ)):$.createByGradient(this._initParticleSize(be.gradient));break;case 1:if(be.separateAxes){var we=be.constantMinSeparate,Se=be.constantMaxSeparate;xe=$.createByRandomTwoConstantSeparate(new At(we[0],we[1],we[2]),new At(Se[0],Se[1],Se[2]))}else xe=$.createByRandomTwoConstant(be.constantMin,be.constantMax);break;case 2:xe=be.separateAxes?$.createByRandomTwoGradientSeparate(this._initParticleSize(be.gradientXMin),this._initParticleSize(be.gradientYMin),this._initParticleSize(be.gradientZMin),this._initParticleSize(be.gradientXMax),this._initParticleSize(be.gradientYMax),this._initParticleSize(be.gradientZMax)):$.createByRandomTwoGradient(this._initParticleSize(be.gradientMin),this._initParticleSize(be.gradientMax))}var Ie=new ae(xe);Ie.enbale=ve.enable,d.sizeOverLifetime=Ie}var Me=n.rotationOverLifetime;if(Me){var Ce,ke=Me.angularVelocity;switch(ke.type){case 0:ke.separateAxes||(Ce=q.createByConstant(ke.constant*o));break;case 1:ke.separateAxes||(Ce=q.createByGradient(this._initParticleRotation(ke.gradient)));break;case 2:if(ke.separateAxes){var Ee=ke.constantMinSeparate,Te=ke.constantMaxSeparate;Ce=q.createByRandomTwoConstantSeparate(new At(Ee[0]*o,Ee[1]*o,Ee[2]*o),new At(Te[0]*o,Te[1]*o,Te[2]*o))}else Ce=q.createByRandomTwoConstant(ke.constantMin*o,ke.constantMax*o);break;case 3:ke.separateAxes||(Ce=q.createByRandomTwoGradient(this._initParticleRotation(ke.gradientMin),this._initParticleRotation(ke.gradientMax)))}var Le=new te(Ce);Le.enbale=Me.enable,d.rotationOverLifetime=Le}var De=n.textureSheetAnimation;if(De){var Ne,Ae=De.frame;switch(Ae.type){case 0:Ne=W.createByConstant(Ae.constant);break;case 1:Ne=W.createByOverTime(this._initParticleFrame(Ae.overTime));break;case 2:Ne=W.createByRandomTwoConstant(Ae.constantMin,Ae.constantMax);break;case 3:Ne=W.createByRandomTwoOverTime(this._initParticleFrame(Ae.overTimeMin),this._initParticleFrame(Ae.overTimeMax))}var Re,Be=De.startFrame;switch(Be.type){case 0:Re=re.createByConstant(Be.constant);break;case 1:Re=re.createByRandomTwoConstant(Be.constantMin,Be.constantMax)}var Pe=new oe(Ne,Re);Pe.enable=De.enable;var Oe=De.tiles;Pe.tiles=new Nt(Oe[0],Oe[1]),Pe.type=De.type,Pe.randomRow=De.randomRow;var Ve=De.rowIndex;void 0!==Ve&&(Pe.rowIndex=Ve),Pe.cycles=De.cycles,d.textureSheetAnimation=Pe}},o._activeHierarchy=function(){laya.d3.core.Sprite3D.prototype._activeHierarchy.call(this),this.particleSystem.playOnAwake&&this.particleSystem.play()},o._inActiveHierarchy=function(){laya.d3.core.Sprite3D.prototype._inActiveHierarchy.call(this),this.particleSystem.isAlive&&this.particleSystem.simulate(0,!0)},o.cloneTo=function(e){var t=e,i=t._geometryFilter;this._geometryFilter.cloneTo(i);var n=t._render,a=this._render;n.sharedMaterials=a.sharedMaterials,n.enable=a.enable,n.renderMode=a.renderMode,n.mesh=a.mesh,n.stretchedBillboardCameraSpeedScale=a.stretchedBillboardCameraSpeedScale,n.stretchedBillboardSpeedScale=a.stretchedBillboardSpeedScale,n.stretchedBillboardLengthScale=a.stretchedBillboardLengthScale,n.sortingFudge=a.sortingFudge,laya.d3.core.Sprite3D.prototype.cloneTo.call(this,e)},o.destroy=function(t){void 0===t&&(t=!0),this.destroyed||(e.prototype.destroy.call(this,t),this._geometryFilter._destroy(),this._geometryFilter=null)},r(0,o,"particleSystem",function(){return this._geometryFilter}),r(0,o,"particleRender",function(){return this._render}),t.__init__=function(){t.SHADERDEFINE_RENDERMODE_BILLBOARD=t.shaderDefines.registerDefine("SPHERHBILLBOARD"),t.SHADERDEFINE_RENDERMODE_STRETCHEDBILLBOARD=t.shaderDefines.registerDefine("STRETCHEDBILLBOARD"),t.SHADERDEFINE_RENDERMODE_HORIZONTALBILLBOARD=t.shaderDefines.registerDefine("HORIZONTALBILLBOARD"),t.SHADERDEFINE_RENDERMODE_VERTICALBILLBOARD=t.shaderDefines.registerDefine("VERTICALBILLBOARD"),t.SHADERDEFINE_COLOROVERLIFETIME=t.shaderDefines.registerDefine("COLOROVERLIFETIME"),t.SHADERDEFINE_RANDOMCOLOROVERLIFETIME=t.shaderDefines.registerDefine("RANDOMCOLOROVERLIFETIME"),t.SHADERDEFINE_VELOCITYOVERLIFETIMECONSTANT=t.shaderDefines.registerDefine("VELOCITYOVERLIFETIMECONSTANT"),t.SHADERDEFINE_VELOCITYOVERLIFETIMECURVE=t.shaderDefines.registerDefine("VELOCITYOVERLIFETIMECURVE"),t.SHADERDEFINE_VELOCITYOVERLIFETIMERANDOMCONSTANT=t.shaderDefines.registerDefine("VELOCITYOVERLIFETIMERANDOMCONSTANT"),t.SHADERDEFINE_VELOCITYOVERLIFETIMERANDOMCURVE=t.shaderDefines.registerDefine("VELOCITYOVERLIFETIMERANDOMCURVE"),t.SHADERDEFINE_TEXTURESHEETANIMATIONCURVE=t.shaderDefines.registerDefine("TEXTURESHEETANIMATIONCURVE"),t.SHADERDEFINE_TEXTURESHEETANIMATIONRANDOMCURVE=t.shaderDefines.registerDefine("TEXTURESHEETANIMATIONRANDOMCURVE"),t.SHADERDEFINE_ROTATIONOVERLIFETIME=t.shaderDefines.registerDefine("ROTATIONOVERLIFETIME"),t.SHADERDEFINE_ROTATIONOVERLIFETIMESEPERATE=t.shaderDefines.registerDefine("ROTATIONOVERLIFETIMESEPERATE"),t.SHADERDEFINE_ROTATIONOVERLIFETIMECONSTANT=t.shaderDefines.registerDefine("ROTATIONOVERLIFETIMECONSTANT"),t.SHADERDEFINE_ROTATIONOVERLIFETIMECURVE=t.shaderDefines.registerDefine("ROTATIONOVERLIFETIMECURVE"),t.SHADERDEFINE_ROTATIONOVERLIFETIMERANDOMCONSTANTS=t.shaderDefines.registerDefine("ROTATIONOVERLIFETIMERANDOMCURVES"),t.SHADERDEFINE_ROTATIONOVERLIFETIMERANDOMCURVES=t.shaderDefines.registerDefine("ROTATIONOVERLIFETIMERANDOMCURVES"),t.SHADERDEFINE_SIZEOVERLIFETIMECURVE=t.shaderDefines.registerDefine("SIZEOVERLIFETIMECURVE"),t.SHADERDEFINE_SIZEOVERLIFETIMECURVESEPERATE=t.shaderDefines.registerDefine("SIZEOVERLIFETIMECURVESEPERATE"),t.SHADERDEFINE_SIZEOVERLIFETIMERANDOMCURVES=t.shaderDefines.registerDefine("SIZEOVERLIFETIMERANDOMCURVES"),t.SHADERDEFINE_SIZEOVERLIFETIMERANDOMCURVESSEPERATE=t.shaderDefines.registerDefine("SIZEOVERLIFETIMERANDOMCURVESSEPERATE"),t.SHADERDEFINE_RENDERMODE_MESH=t.shaderDefines.registerDefine("RENDERMODE_MESH"),t.SHADERDEFINE_SHAPE=t.shaderDefines.registerDefine("SHAPE")},t.load=function(e){return i.loader.create(e,null,null,t)},t._initStartLife=function(e){for(var t=new Q,i=e.startLifetimes,n=0,a=i.length;n<a;n++){var r=i[n];t.add(r.key,r.value)}return t},t.SHADERDEFINE_RENDERMODE_BILLBOARD=0,t.SHADERDEFINE_RENDERMODE_STRETCHEDBILLBOARD=0,t.SHADERDEFINE_RENDERMODE_HORIZONTALBILLBOARD=0,t.SHADERDEFINE_RENDERMODE_VERTICALBILLBOARD=0,t.SHADERDEFINE_COLOROVERLIFETIME=0,t.SHADERDEFINE_RANDOMCOLOROVERLIFETIME=0,t.SHADERDEFINE_VELOCITYOVERLIFETIMECONSTANT=0,t.SHADERDEFINE_VELOCITYOVERLIFETIMECURVE=0,t.SHADERDEFINE_VELOCITYOVERLIFETIMERANDOMCONSTANT=0,t.SHADERDEFINE_VELOCITYOVERLIFETIMERANDOMCURVE=0,t.SHADERDEFINE_TEXTURESHEETANIMATIONCURVE=0,t.SHADERDEFINE_TEXTURESHEETANIMATIONRANDOMCURVE=0,t.SHADERDEFINE_ROTATIONOVERLIFETIME=0,t.SHADERDEFINE_ROTATIONOVERLIFETIMESEPERATE=0,t.SHADERDEFINE_ROTATIONOVERLIFETIMECONSTANT=0,t.SHADERDEFINE_ROTATIONOVERLIFETIMECURVE=0,t.SHADERDEFINE_ROTATIONOVERLIFETIMERANDOMCONSTANTS=0,t.SHADERDEFINE_ROTATIONOVERLIFETIMERANDOMCURVES=0,t.SHADERDEFINE_SIZEOVERLIFETIMECURVE=0,t.SHADERDEFINE_SIZEOVERLIFETIMECURVESEPERATE=0,t.SHADERDEFINE_SIZEOVERLIFETIMERANDOMCURVES=0,t.SHADERDEFINE_SIZEOVERLIFETIMERANDOMCURVESSEPERATE=0,t.SHADERDEFINE_RENDERMODE_MESH=0,t.SHADERDEFINE_SHAPE=0,t.WORLDPOSITION=0,t.WORLDROTATION=1,t.POSITIONSCALE=4,t.SIZESCALE=5,t.SCALINGMODE=6,t.GRAVITY=7,t.THREEDSTARTROTATION=8,t.STRETCHEDBILLBOARDLENGTHSCALE=9,t.STRETCHEDBILLBOARDSPEEDSCALE=10,t.SIMULATIONSPACE=11,t.CURRENTTIME=12,t.VOLVELOCITYCONST=13,t.VOLVELOCITYGRADIENTX=14,t.VOLVELOCITYGRADIENTY=15,t.VOLVELOCITYGRADIENTZ=16,t.VOLVELOCITYCONSTMAX=17,t.VOLVELOCITYGRADIENTXMAX=18,t.VOLVELOCITYGRADIENTYMAX=19,t.VOLVELOCITYGRADIENTZMAX=20,t.VOLSPACETYPE=21,t.COLOROVERLIFEGRADIENTALPHAS=22,t.COLOROVERLIFEGRADIENTCOLORS=23,t.MAXCOLOROVERLIFEGRADIENTALPHAS=24,t.MAXCOLOROVERLIFEGRADIENTCOLORS=25,t.SOLSIZEGRADIENT=26,t.SOLSIZEGRADIENTX=27,t.SOLSIZEGRADIENTY=28,t.SOLSizeGradientZ=29,t.SOLSizeGradientMax=30,t.SOLSIZEGRADIENTXMAX=31,t.SOLSIZEGRADIENTYMAX=32,t.SOLSizeGradientZMAX=33,t.ROLANGULARVELOCITYCONST=34,t.ROLANGULARVELOCITYCONSTSEPRARATE=35,t.ROLANGULARVELOCITYGRADIENT=36,t.ROLANGULARVELOCITYGRADIENTX=37,t.ROLANGULARVELOCITYGRADIENTY=38,t.ROLANGULARVELOCITYGRADIENTZ=39,t.ROLANGULARVELOCITYGRADIENTW=40,t.ROLANGULARVELOCITYCONSTMAX=41,t.ROLANGULARVELOCITYCONSTMAXSEPRARATE=42,t.ROLANGULARVELOCITYGRADIENTMAX=43,t.ROLANGULARVELOCITYGRADIENTXMAX=44,t.ROLANGULARVELOCITYGRADIENTYMAX=45,t.ROLANGULARVELOCITYGRADIENTZMAX=46,t.ROLANGULARVELOCITYGRADIENTWMAX=47,t.TEXTURESHEETANIMATIONCYCLES=48,t.TEXTURESHEETANIMATIONSUBUVLENGTH=49,t.TEXTURESHEETANIMATIONGRADIENTUVS=50,t.TEXTURESHEETANIMATIONGRADIENTMAXUVS=51,n(t,["shaderDefines",function(){return this.shaderDefines=new Vt(un.shaderDefines)}]),t}(un),vn=function(e){function t(e,i){this._subMeshOffset=null,t.__super.call(this,i),this._subMeshOffset=[],this._geometryFilter=new Ci(this),this._render=new cn(this),this._geometryFilter.on("meshchanged",this,this._onMeshChanged),this._render.on("materialchanged",this,this._onMaterialChanged),e&&(this._geometryFilter.sharedMesh=e)}a(t,"laya.d3.core.SkinnedMeshSprite3D",e);var o=t.prototype;return o._changeRenderObjectByMesh=function(e){var t=this._render._renderElements,i=t[e];i||(i=t[e]=new li),i._render=this._render;var n=this._render.sharedMaterials[e];n||(n=Yi.defaultMaterial);var a=this._geometryFilter.sharedMesh.getRenderElement(e);return i._mainSortID=this._getSortID(a,n),i._sprite3D=this,i.renderObj=a,i._material=n,i},o._changeRenderObjectByMaterial=function(e,t){var i=this._render._renderElements[e];t||(t=Yi.defaultMaterial);var n=this._geometryFilter.sharedMesh.getRenderElement(e);return i._mainSortID=this._getSortID(n,t),i._sprite3D=this,i.renderObj=n,i._material=t,i},o._changeRenderObjectsByMesh=function(){var e=this._geometryFilter.sharedMesh.getRenderElementsCount();this._render._renderElements.length=e;for(var t=0;t<e;t++)this._changeRenderObjectByMesh(t)},o._onMeshChanged=function(e){var t=e.sharedMesh;t.loaded?this._changeRenderObjectsByMesh():t.once("loaded",this,this._changeRenderObjectsByMesh)},o._onMaterialChanged=function(e,t,i){t<this._render._renderElements.length&&this._changeRenderObjectByMaterial(t,i)},o._parseCustomProps=function(e,t,i,n){var a=this.skinnedMeshRender,r=i.lightmapIndex;null!=r&&(a.lightmapIndex=r);var o=i.lightmapScaleOffset;o&&(a.lightmapScaleOffset=new Rt(o[0],o[1],o[2],o[3]));var s,h;if(n.instanceParams)(s=n.instanceParams.loadPath)&&(h=v.getRes(t[s]),this.meshFilter.sharedMesh=h,h.loaded?a.sharedMaterials=h.materials:h.once("loaded",this,this._applyMeshMaterials));else{(s=i.meshPath)&&(h=v.getRes(t[s]),this.meshFilter.sharedMesh=h);var l=i.materials;if(l){var c=a.sharedMaterials,p=l.length;c.length=p;for(var u=0;u<p;u++)c[u]=v.getRes(t[l[u].path]);a.sharedMaterials=c}var d=i.rootBone;d&&a._setRootBone(d);var _=i.boundBox;if(_){var m=_.min,f=_.max,g=new xt(new At(m[0],m[1],m[2]),new At(f[0],f[1],f[2]));a.localBoundBox=g}else a._hasIndependentBound=!1;var y=i.boundSphere;if(y){var x=y.center,b=new wt(new At(x[0],x[1],x[2]),y.radius);a.localBoundSphere=b}}},o._changeHierarchyAnimator=function(e){if(e){var t=this.skinnedMeshRender;t._setCacheAnimator(e);var i=e.avatar;i&&t._setCacheAvatar(i)}laya.d3.core.Sprite3D.prototype._changeHierarchyAnimator.call(this,e)},o._clearSelfRenderObjects=function(){this._scene.removeFrustumCullingObject(this._render)},o._addSelfRenderObjects=function(){this._scene.addFrustumCullingObject(this._render)},o._applyMeshMaterials=function(e){for(var t=this._render.sharedMaterials,i=e.materials,n=0,a=i.length;n<a;n++)t[n]||(t[n]=i[n]);this._render.sharedMaterials=t},o.cloneTo=function(e){var t=e;t._geometryFilter.sharedMesh=this._geometryFilter.sharedMesh;var i=this._render,n=t._render;n.enable=i.enable,n.sharedMaterials=i.sharedMaterials,n.castShadow=i.castShadow;var a=i.lightmapScaleOffset;a&&(n.lightmapScaleOffset=a.clone()),n.receiveShadow=i.receiveShadow,n.sortingFudge=i.sortingFudge,n._rootBone=i._rootBone;var r=i.localBoundSphere;r&&(n.localBoundSphere=r.clone());var o=i.localBoundBox;o&&(n.localBoundBox=o.clone()),n._hasIndependentBound=i._hasIndependentBound,laya.d3.core.Sprite3D.prototype.cloneTo.call(this,e)},o.destroy=function(t){void 0===t&&(t=!0),this.destroyed||(e.prototype.destroy.call(this,t),this._geometryFilter._destroy())},r(0,o,"meshFilter",function(){return this._geometryFilter}),r(0,o,"skinnedMeshRender",function(){return this._render}),t.__init__=function(){t.SHADERDEFINE_BONE=t.shaderDefines.registerDefine("BONE")},t.load=function(e){return i.loader.create(e,null,null,t)},t.SHADERDEFINE_BONE=8,t.BONES=0,n(t,["shaderDefines",function(){return this.shaderDefines=new Vt(un.shaderDefines)}]),t}(un),xn=(function(e){function t(e,i,n,a,r){void 0===e&&(e=.1),void 0===i&&(i=0),void 0===n&&(n=0),void 0===a&&(a=.3),void 0===r&&(r=1e3),this._tempMatrix=new Ct,this._leftViewMatrix=new Ct,this._leftProjectionMatrix=new Ct,this._leftProjectionViewMatrix=new Ct,this._leftViewport=new Bt(0,0,0,0),this._leftNormalizedViewport=new Bt(0,0,.5,1),this._leftAspectRatio=i,this._rightViewMatrix=new Ct,this._rightProjectionMatrix=new Ct,this._rightProjectionViewMatrix=new Ct,this._rightViewport=new Bt(0,0,0,0),this._rightNormalizedViewport=new Bt(.5,0,.5,1),this._rightAspectRatio=n,this._pupilDistande=e,this._leftBoundFrustumUpdate=!0,this._leftBoundFrustum=new bt(Ct.DEFAULT),this._rightBoundFrustumUpdate=!0,this._rightBoundFrustum=new bt(Ct.DEFAULT),t.__super.call(this,a,r),this.transform.on("worldmatrixneedchanged",this,this._onWorldMatrixChanged)}a(t,"laya.d3.core.VRCamera",pn);var i=t.prototype;i._onWorldMatrixChanged=function(){this._leftBoundFrustumUpdate=this._rightBoundFrustumUpdate=!0},i._calculatePupilOffset=function(){var e=this._tempVector3;return At.scale(this.right,this._pupilDistande/2,e),e.elements},i._calculateLeftProjectionMatrix=function(){if(!this._useUserProjectionMatrix)if(this._orthographic){var e=this.orthographicVerticalSize*this.leftAspectRatio*.5,t=.5*this.orthographicVerticalSize;Ct.createOrthoOffCenterRH(-e,e,-t,t,this.nearPlane,this.farPlane,this._leftProjectionMatrix)}else Ct.createPerspective(3.1416*this.fieldOfView/180,this.leftAspectRatio,this.nearPlane,this.farPlane,this._rightProjectionMatrix);this._leftBoundFrustumUpdate=!0},i._calculateRightProjectionMatrix=function(){if(!this._useUserProjectionMatrix)if(this._orthographic){var e=this.orthographicVerticalSize*this.rightAspectRatio*.5,t=.5*this.orthographicVerticalSize;Ct.createOrthoOffCenterRH(-e,e,t,t,this.nearPlane,this.farPlane,this._rightProjectionMatrix)}else Ct.createPerspective(3.1416*this.fieldOfView/180,this.rightAspectRatio,this.nearPlane,this.farPlane,this._rightProjectionMatrix);this._rightBoundFrustumUpdate=!0},i._calculateProjectionMatrix=function(){if(!this._useUserProjectionMatrix)if(this._orthographic){var e=this.orthographicVerticalSize*this.leftAspectRatio*.5,t=.5*this.orthographicVerticalSize,i=this.orthographicVerticalSize*this.rightAspectRatio*.5,n=.5*this.orthographicVerticalSize;Ct.createOrthoOffCenterRH(-e,e,-t,t,this.nearPlane,this.farPlane,this._leftProjectionMatrix),Ct.createOrthoOffCenterRH(-i,i,n,n,this.nearPlane,this.farPlane,this._rightProjectionMatrix)}else Ct.createPerspective(3.1416*this.fieldOfView/180,this.leftAspectRatio,this.nearPlane,this.farPlane,this._leftProjectionMatrix),Ct.createPerspective(3.1416*this.fieldOfView/180,this.rightAspectRatio,this.nearPlane,this.farPlane,this._rightProjectionMatrix);this._leftBoundFrustumUpdate=this._rightBoundFrustumUpdate=!0},i._renderCamera=function(e,t,i){t.camera=this,this._prepareCameraToRender(),i._preRenderUpdateComponents(t);var n,a;n=t._viewMatrix=this.leftViewMatrix;var r=this._renderTarget;r?(r.start(),Ct.multiply(pn._invertYScaleMatrix,this._leftProjectionMatrix,pn._invertYProjectionMatrix),Ct.multiply(pn._invertYScaleMatrix,this.leftProjectionViewMatrix,pn._invertYProjectionViewMatrix),a=t._projectionMatrix=pn._invertYProjectionMatrix,t._projectionViewMatrix=pn._invertYProjectionViewMatrix):(a=t._projectionMatrix=this._leftProjectionMatrix,t._projectionViewMatrix=this.leftProjectionViewMatrix),this._prepareCameraViewProject(n,a),t._viewport=this.leftViewport,i._preRenderScene(e,t,this.leftBoundFrustum),i._clear(e,t),i._renderScene(e,t);var o,s;o=t._viewMatrix=this.rightViewMatrix,r?(r.start(),Ct.multiply(pn._invertYScaleMatrix,this._rightProjectionMatrix,pn._invertYProjectionMatrix),Ct.multiply(pn._invertYScaleMatrix,this.rightProjectionViewMatrix,pn._invertYProjectionViewMatrix),t._projectionMatrix=pn._invertYProjectionMatrix,s=t._projectionViewMatrix=pn._invertYProjectionViewMatrix):(s=t._projectionMatrix=this._rightProjectionMatrix,t._projectionViewMatrix=this.rightProjectionViewMatrix),this._prepareCameraViewProject(o,s),t._viewport=this.rightViewport,i._preRenderScene(e,t,this.rightBoundFrustum),i._clear(e,t),i._renderScene(e,t),i._postRenderUpdateComponents(t),r&&r.end()},r(0,i,"rightBoundFrustum",function(){return this._rightBoundFrustumUpdate&&(this._rightBoundFrustum.matrix=this.rightProjectionViewMatrix),this._rightBoundFrustum}),r(0,i,"leftNormalizedViewport",function(){if(!this._viewportExpressedInClipSpace){var e=this._leftViewport,t=this.renderTargetSize,i=t.width,n=t.height;this._leftNormalizedViewport.x=e.x/i,this._leftNormalizedViewport.y=e.y/n,this._leftNormalizedViewport.width=e.width/i,this._leftNormalizedViewport.height=e.height/n}return this._leftNormalizedViewport}),r(0,i,"rightViewport",function(){if(this._viewportExpressedInClipSpace){var e=this._rightNormalizedViewport,t=this.renderTargetSize,i=t.width,n=t.height;this._rightViewport.x=e.x*i,this._rightViewport.y=e.y*n,this._rightViewport.width=e.width*i,this._rightViewport.height=e.height*n}return this._rightViewport}),r(0,i,"viewport",null,function(e){if(null!=this.renderTarget&&(e.x<0||e.y<0||0==e.width||0==e.height))throw new Error("VRCamera: viewport size invalid.","value");this._viewportExpressedInClipSpace=!1,this._leftViewport=new Bt(0,0,e.width/2,e.height),this._rightViewport=new Bt(e.width/2,0,e.width/2,e.height),this._calculateProjectionMatrix()}),r(0,i,"leftAspectRatio",function(){if(0===this._leftAspectRatio){var e=this.leftViewport;return e.width/e.height}return this._leftAspectRatio}),r(0,i,"rightAspectRatio",function(){if(0===this._rightAspectRatio){var e=this.rightViewport;return e.width/e.height}return this._rightAspectRatio}),r(0,i,"aspectRatio",null,function(e){if(e<0)throw new Error("VRCamera: the aspect ratio has to be a positive real number.");this._leftAspectRatio=e,this._rightAspectRatio=e,this._calculateRightProjectionMatrix()}),r(0,i,"rightNormalizedViewport",function(){if(!this._viewportExpressedInClipSpace){var e=this._rightViewport,t=this.renderTargetSize,i=t.width,n=t.height;this._rightNormalizedViewport.x=e.x/i,this._rightNormalizedViewport.y=e.y/n,this._rightNormalizedViewport.width=e.width/i,this._rightNormalizedViewport.height=e.height/n}return this._rightNormalizedViewport}),r(0,i,"normalizedViewport",null,function(e){if(e.x<0||e.y<0||e.x+e.width>1||e.x+e.height>1)throw new Error("VRCamera: viewport size invalid.","value");this._viewportExpressedInClipSpace=!0,this._leftNormalizedViewport=new Bt(0,0,e.width/2,e.height),this._rightNormalizedViewport=new Bt(e.width/2,0,e.width/2,e.height),this._calculateProjectionMatrix()}),r(0,i,"leftViewport",function(){if(this._viewportExpressedInClipSpace){var e=this._leftNormalizedViewport,t=this.renderTargetSize,i=t.width,n=t.height;this._leftViewport.x=e.x*i,this._leftViewport.y=e.y*n,this._leftViewport.width=e.width*i,this._leftViewport.height=e.height*n}return this._leftViewport}),r(0,i,"needLeftViewport",function(){var e=this.leftNormalizedViewport;return 0===e.x&&0===e.y&&1===e.width&&1===e.height}),r(0,i,"needRightViewport",function(){var e=this.rightNormalizedViewport;return 0===e.x&&0===e.y&&1===e.width&&1===e.height}),r(0,i,"leftViewMatrix",function(){var e=this._calculatePupilOffset(),t=this._tempMatrix;this.transform.worldMatrix.cloneTo(t);var i=t.elements;return i[12]-=e[0],i[13]-=e[1],i[14]-=e[2],t.invert(this._leftViewMatrix),this._leftViewMatrix}),r(0,i,"rightViewMatrix",function(){var e=this._calculatePupilOffset(),t=this._tempMatrix;this.transform.worldMatrix.cloneTo(t);var i=t.elements;return i[12]+=e[0],i[13]+=e[1],i[14]+=e[2],t.invert(this._rightViewMatrix),this._rightViewMatrix}),r(0,i,"leftProjectionMatrix",function(){return this._leftProjectionMatrix}),r(0,i,"leftProjectionViewMatrix",function(){return Ct.multiply(this.leftProjectionMatrix,this.leftViewMatrix,this._leftProjectionViewMatrix),this._leftProjectionViewMatrix}),r(0,i,"rightProjectionMatrix",function(){return this._rightProjectionMatrix}),r(0,i,"rightProjectionViewMatrix",function(){return Ct.multiply(this.rightProjectionMatrix,this.rightViewMatrix,this._rightProjectionViewMatrix),this._rightProjectionViewMatrix}),r(0,i,"leftBoundFrustum",function(){return this._leftBoundFrustumUpdate&&(this._leftBoundFrustum.matrix=this.leftProjectionViewMatrix),this._leftBoundFrustum})}(),function(e){function t(){t.__super.call(this),this._geometryFilter=new Li(this),this._render=new Di(this),this._changeRenderObjectsByMaterial(this._render,0,Ji.defaultMaterial),this._render.on("materialchanged",this,this._changeRenderObjectsByMaterial),this._geometryFilter.on("trailfilterchange",this,this._changeRenderObjectsByRenderElement)}a(t,"laya.d3.core.trail.TrailSprite3D",e);var i=t.prototype;return i._changeRenderObjectsByMaterial=function(e,t,i){var n=this._geometryFilter.getRenderElementsCount();this._render._renderElements.length=n;for(var a=0;a<n;a++)this._changeRenderObjectByMaterial(a,i)},i._changeRenderObjectByMaterial=function(e,t){var i=this._render._renderElements;t||(t=Ji.defaultMaterial);var n=i[e];n||(n=i[e]=new ce),n._sprite3D=this,n.renderObj=this._geometryFilter.getRenderElement(e),n._render=this._render,n._material=t},i._changeRenderObjectsByRenderElement=function(e,t){var i=this._render._renderElements,n=i[e];n||(n=i[e]=new ce),n._sprite3D=this,n.renderObj=t,n._render=this._render,n._material=this._render.sharedMaterial},i._clearSelfRenderObjects=function(){this.scene.removeFrustumCullingObject(this._render)},i._addSelfRenderObjects=function(){this.scene.addFrustumCullingObject(this._render)},i._update=function(t){e.prototype._update.call(this,t),this._geometryFilter._update(t)},i._parseCustomProps=function(e,t,i,n){var a=this._render,r=this._geometryFilter,o=0,s=0,h=i.materials;if(h){var l=a.sharedMaterials,c=h.length;for(l.length=c,o=0;o<c;o++)l[o]=v.getRes(t[h[o].path]);a.sharedMaterials=l}var p=n.props;r.time=p.time,r.minVertexDistance=p.minVertexDistance,r.widthMultiplier=p.widthMultiplier,r.textureMode=p.textureMode;var u=[],d=i.widthCurve;for(o=0,s=d.length;o<s;o++){var _=new ye;_.time=d[o].time,_.inTangent=d[o].inTangent,_.outTangent=d[o].outTangent,_.value=d[o].value,u.push(_)}r.widthCurve=u;var m=i.colorGradient,f=new me;f.mode=m.mode;var g,y,x=[],b=m.colorKeys;for(o=0,s=b.length;o<s;o++)y=b[o],g=new ge(new _e(y.value[0],y.value[1],y.value[2],1),y.time),x.push(g);var w,S,I=[],M=m.alphaKeys;for(o=0,s=M.length;o<s;o++)S=M[o],w=new fe(S.value,S.time),I.push(w);f.setKeys(x,I),r.colorGradient=f},i.reset=function(){this.trailFilter.reset()},i.cloneTo=function(e){laya.d3.core.Sprite3D.prototype.cloneTo.call(this,e);var t=0,i=0,n=e,a=n.trailFilter;a.time=this.trailFilter.time,a.minVertexDistance=this.trailFilter.minVertexDistance,a.widthMultiplier=this.trailFilter.widthMultiplier;var r=this.trailFilter.widthCurve,o=[];for(t=0,i=r.length;t<i;t++){var s=new ye;r[t].cloneTo(s),o.push(s)}a.widthCurve=o;var h=new me;this.trailFilter.colorGradient.cloneTo(h),a.colorGradient=h,a.textureMode=this.trailFilter.textureMode;n.trailRender.sharedMaterial=this.trailRender.sharedMaterial},i.destroy=function(t){void 0===t&&(t=!0),this.destroyed||(e.prototype.destroy.call(this,t),this._geometryFilter._destroy(),this._geometryFilter=null)},r(0,i,"trailFilter",function(){return this._geometryFilter}),r(0,i,"trailRender",function(){return this._render}),t.__init__=function(){t.SHADERDEFINE_GRADIENTMODE_BLEND=t.shaderDefines.registerDefine("GRADIENTMODE_BLEND")},t.CURTIME=3,t.LIFETIME=4,t.WIDTHCURVE=5,t.WIDTHCURVEKEYLENGTH=6,t.GRADIENTCOLORKEY=7,t.GRADIENTALPHAKEY=8,t.SHADERDEFINE_GRADIENTMODE_BLEND=0,n(t,["shaderDefines",function(){return this.shaderDefines=new Vt(un.shaderDefines)}]),t}(un)),bn=function(e){function t(e,i,n,a,r,o,s,h){t.__super.call(this,h),this._geometryFilter=new Ai(this,e,i,n,a,r,o,s),this._render=new Ri(this)}a(t,"laya.d3.terrain.TerrainChunk",e);var n=t.prototype;return n.buildRenderElementAndMaterial=function(e,t,i,n,a,r,o,s,h,l,c,p,u,d,_,m,f,g){void 0===c&&(c=1),void 0===p&&(p=1),void 0===u&&(u=1),void 0===d&&(d=1),void 0===_&&(_=1),void 0===m&&(m=1),void 0===f&&(f=1),void 0===g&&(g=1);var y=new Gi;h&&(y.diffuseColor=h),s&&(y.ambientColor=s),l&&(y.specularColor=l),y.splatAlphaTexture=v.getRes(i),y.normalTexture=t?v.getRes(t):null,y.diffuseTexture1=n?v.getRes(n):null,y.diffuseTexture2=a?v.getRes(a):null,y.diffuseTexture3=r?v.getRes(r):null,y.diffuseTexture4=o?v.getRes(o):null,y.setDiffuseScale1(c,p),y.setDiffuseScale2(u,d),y.setDiffuseScale3(_,m),y.setDiffuseScale4(f,g),y.setDetailNum(e),0!=this._render._renderElements.length&&(y.renderMode=2);var x=new ce;x._mainSortID=0,x._sprite3D=this,x.renderObj=this._geometryFilter,x._material=y,this._render._materials.push(y),this._render._renderElements.push(x)},n._clearSelfRenderObjects=function(){this.scene.removeFrustumCullingObject(this._render)},n._addSelfRenderObjects=function(){this.scene.addFrustumCullingObject(this._render)},n._applyMeshMaterials=function(e){for(var t=this._render.sharedMaterials,i=e.materials,n=0,a=i.length;n<a;n++)t[n]||(t[n]=i[n]);this._render.sharedMaterials=t},n.cloneTo=function(e){console.log("Terrain Chunk can't clone")},n.destroy=function(t){void 0===t&&(t=!0),this.destroyed||(e.prototype.destroy.call(this,t),this._geometryFilter._destroy())},r(0,n,"terrainFilter",function(){return this._geometryFilter}),r(0,n,"terrainRender",function(){return this._render}),t.load=function(e){return i.loader.create(e,null,null,t,null,1,!1)},t}(un);!function(e){function t(e,i,n){this._minX=NaN,this._minZ=NaN,this._cellSize=null,this._heightMap=null,t.__super.call(this,e,n),this._heightMap=i,this._cellSize=new Nt}a(t,"laya.d3.core.MeshTerrainSprite3D",gn);var i=t.prototype;i._disableRotation=function(){var e=this.transform.rotation;e.elements[0]=0,e.elements[1]=0,e.elements[2]=0,e.elements[3]=1,this.transform.rotation=e},i._getScaleX=function(){var e=this.transform.worldMatrix.elements,t=e[0],i=e[1],n=e[2];return Math.sqrt(t*t+i*i+n*n)},i._getScaleZ=function(){var e=this.transform.worldMatrix.elements,t=e[8],i=e[9],n=e[10];return Math.sqrt(t*t+i*i+n*n)},i._initCreateFromMesh=function(e,t){this._heightMap=z.creatFromMesh(this.meshFilter.sharedMesh,e,t,this._cellSize);var i=this.meshFilter.sharedMesh.boundingBox,n=i.min;i.max;this._minX=n.x,this._minZ=n.z},i._initCreateFromMeshHeightMap=function(e,t,i){var n=this,a=this.meshFilter.sharedMesh.boundingBox;e.loaded?(this._heightMap=z.createFromImage(e,t,i),this._computeCellSize(a)):e.once("loaded",null,function(){n._heightMap=z.createFromImage(e,t,i),n._computeCellSize(a)});var r=a.min;a.max;this._minX=r.x,this._minZ=r.z},i._computeCellSize=function(e){var t=e.min,i=e.max,n=t.x,a=t.z,r=i.x-n,o=i.z-a;this._cellSize.elements[0]=r/(this._heightMap.width-1),this._cellSize.elements[1]=o/(this._heightMap.height-1)},i._update=function(e){this._disableRotation(),laya.d3.core.RenderableSprite3D.prototype._update.call(this,e)},i.getHeight=function(e,i){t._tempVector3.elements[0]=e,t._tempVector3.elements[1]=0,t._tempVector3.elements[2]=i,this._disableRotation();var n=this.transform.worldMatrix;n.invert(t._tempMatrix4x4),At.transformCoordinate(t._tempVector3,t._tempMatrix4x4,t._tempVector3),e=t._tempVector3.elements[0],i=t._tempVector3.elements[2];var a=(e-this._minX)/this._cellSize.x,r=(i-this._minZ)/this._cellSize.y,o=Math.floor(r),s=Math.floor(a),h=a-s,l=r-o,c=NaN,p=NaN,u=n.elements,d=u[4],_=u[5],m=u[6],f=Math.sqrt(d*d+_*_+m*m),g=u[13],y=this._heightMap.getHeight(o,s+1),v=this._heightMap.getHeight(o+1,s);if(isNaN(y)||isNaN(v))return NaN;if(h+l<=1){var x=this._heightMap.getHeight(o,s);return isNaN(x)?NaN:(c=y-x,p=v-x,(x+h*c+l*p)*f+g)}var b=this._heightMap.getHeight(o+1,s+1);return isNaN(b)?NaN:(c=v-b,p=y-b,(b+(1-h)*c+(1-l)*p)*f+g)},r(0,i,"minX",function(){var e=this.transform.worldMatrix.elements;return this._minX*this._getScaleX()+e[12]}),r(0,i,"width",function(){return(this._heightMap.width-1)*this._cellSize.x*this._getScaleX()}),r(0,i,"minZ",function(){var e=this.transform.worldMatrix.elements;return this._minZ*this._getScaleZ()+e[14]}),r(0,i,"depth",function(){return(this._heightMap.height-1)*this._cellSize.y*this._getScaleZ()}),t.createFromMesh=function(e,i,n,a){var r=new t(e,null,a);return e.loaded?r._initCreateFromMesh(i,n):e.once("loaded",r,r._initCreateFromMesh,[i,n]),r},t.createFromMeshAndHeightMap=function(e,i,n,a,r){var o=new t(e,null,r);return e.loaded?o._initCreateFromMeshHeightMap(i,n,a):e.once("loaded",o,o._initCreateFromMeshHeightMap,[i,n,a]),o},n(t,["_tempVector3",function(){return this._tempVector3=new At},"_tempMatrix4x4",function(){return this._tempMatrix4x4=new Ct}])}()}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});for(var i in Laya){var n=Laya[i];n&&n.__isclass&&(t[i]=n)}}),function(e,t){"object"==typeof exports?module.exports=exports=t():"function"==typeof define&&define.amd?define([],t):e.CryptoJS=t()}(this,function(){var e=e||function(e,t){var i=Object.create||function(){function e(){}return function(t){var i;return e.prototype=t,i=new e,e.prototype=null,i}}(),n={},a=n.lib={},r=a.Base={extend:function(e){var t=i(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},o=a.WordArray=r.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=void 0!=t?t:4*e.length},toString:function(e){return(e||h).stringify(this)},concat:function(e){var t=this.words,i=e.words,n=this.sigBytes,a=e.sigBytes;if(this.clamp(),n%4)for(o=0;o<a;o++){var r=i[o>>>2]>>>24-o%4*8&255;t[n+o>>>2]|=r<<24-(n+o)%4*8}else for(var o=0;o<a;o+=4)t[n+o>>>2]=i[o>>>2];return this.sigBytes+=a,this},clamp:function(){var t=this.words,i=this.sigBytes;t[i>>>2]&=4294967295<<32-i%4*8,t.length=e.ceil(i/4)},clone:function(){var e=r.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var i,n=[],a=function(t){var t=t,i=987654321;return function(){var n=((i=36969*(65535&i)+(i>>16)&4294967295)<<16)+(t=18e3*(65535&t)+(t>>16)&4294967295)&4294967295;return n/=4294967296,(n+=.5)*(e.random()>.5?1:-1)}},r=0;r<t;r+=4){var s=a(4294967296*(i||e.random()));i=987654071*s(),n.push(4294967296*s()|0)}return new o.init(n,t)}}),s=n.enc={},h=s.Hex={stringify:function(e){for(var t=e.words,i=e.sigBytes,n=[],a=0;a<i;a++){var r=t[a>>>2]>>>24-a%4*8&255;n.push((r>>>4).toString(16)),n.push((15&r).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,i=[],n=0;n<t;n+=2)i[n>>>3]|=parseInt(e.substr(n,2),16)<<24-n%8*4;return new o.init(i,t/2)}},l=s.Latin1={stringify:function(e){for(var t=e.words,i=e.sigBytes,n=[],a=0;a<i;a++){var r=t[a>>>2]>>>24-a%4*8&255;n.push(String.fromCharCode(r))}return n.join("")},parse:function(e){for(var t=e.length,i=[],n=0;n<t;n++)i[n>>>2]|=(255&e.charCodeAt(n))<<24-n%4*8;return new o.init(i,t)}},c=s.Utf8={stringify:function(e){try{return decodeURIComponent(escape(l.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return l.parse(unescape(encodeURIComponent(e)))}},p=a.BufferedBlockAlgorithm=r.extend({reset:function(){this._data=new o.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=c.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var i=this._data,n=i.words,a=i.sigBytes,r=this.blockSize,s=a/(4*r),h=(s=t?e.ceil(s):e.max((0|s)-this._minBufferSize,0))*r,l=e.min(4*h,a);if(h){for(var c=0;c<h;c+=r)this._doProcessBlock(n,c);var p=n.splice(0,h);i.sigBytes-=l}return new o.init(p,l)},clone:function(){var e=r.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),u=(a.Hasher=p.extend({cfg:r.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){p.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){e&&this._append(e);return this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,i){return new e.init(i).finalize(t)}},_createHmacHelper:function(e){return function(t,i){return new u.HMAC.init(e,i).finalize(t)}}}),n.algo={});return n}(Math);return function(){var t=e,i=t.lib.WordArray;t.enc.Base64={stringify:function(e){var t=e.words,i=e.sigBytes,n=this._map;e.clamp();for(var a=[],r=0;r<i;r+=3)for(var o=(t[r>>>2]>>>24-r%4*8&255)<<16|(t[r+1>>>2]>>>24-(r+1)%4*8&255)<<8|t[r+2>>>2]>>>24-(r+2)%4*8&255,s=0;s<4&&r+.75*s<i;s++)a.push(n.charAt(o>>>6*(3-s)&63));var h=n.charAt(64);if(h)for(;a.length%4;)a.push(h);return a.join("")},parse:function(e){var t=e.length,n=this._map,a=this._reverseMap;if(!a){a=this._reverseMap=[];for(var r=0;r<n.length;r++)a[n.charCodeAt(r)]=r}var o=n.charAt(64);if(o){var s=e.indexOf(o);-1!==s&&(t=s)}return function(e,t,n){for(var a=[],r=0,o=0;o<t;o++)if(o%4){var s=n[e.charCodeAt(o-1)]<<o%4*2,h=n[e.charCodeAt(o)]>>>6-o%4*2;a[r>>>2]|=(s|h)<<24-r%4*8,r++}return i.create(a,r)}(e,t,a)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(t){function i(e,t,i,n,a,r,o){var s=e+(t&i|~t&n)+a+o;return(s<<r|s>>>32-r)+t}function n(e,t,i,n,a,r,o){var s=e+(t&n|i&~n)+a+o;return(s<<r|s>>>32-r)+t}function a(e,t,i,n,a,r,o){var s=e+(t^i^n)+a+o;return(s<<r|s>>>32-r)+t}function r(e,t,i,n,a,r,o){var s=e+(i^(t|~n))+a+o;return(s<<r|s>>>32-r)+t}var o=e,s=o.lib,h=s.WordArray,l=s.Hasher,c=o.algo,p=[];!function(){for(var e=0;e<64;e++)p[e]=4294967296*t.abs(t.sin(e+1))|0}();var u=c.MD5=l.extend({_doReset:function(){this._hash=new h.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var o=0;o<16;o++){var s=t+o,h=e[s];e[s]=16711935&(h<<8|h>>>24)|4278255360&(h<<24|h>>>8)}var l=this._hash.words,c=e[t+0],u=e[t+1],d=e[t+2],_=e[t+3],m=e[t+4],f=e[t+5],g=e[t+6],y=e[t+7],v=e[t+8],x=e[t+9],b=e[t+10],w=e[t+11],S=e[t+12],I=e[t+13],M=e[t+14],C=e[t+15],k=l[0],E=l[1],T=l[2],L=l[3];E=r(E=r(E=r(E=r(E=a(E=a(E=a(E=a(E=n(E=n(E=n(E=n(E=i(E=i(E=i(E=i(E,T=i(T,L=i(L,k=i(k,E,T,L,c,7,p[0]),E,T,u,12,p[1]),k,E,d,17,p[2]),L,k,_,22,p[3]),T=i(T,L=i(L,k=i(k,E,T,L,m,7,p[4]),E,T,f,12,p[5]),k,E,g,17,p[6]),L,k,y,22,p[7]),T=i(T,L=i(L,k=i(k,E,T,L,v,7,p[8]),E,T,x,12,p[9]),k,E,b,17,p[10]),L,k,w,22,p[11]),T=i(T,L=i(L,k=i(k,E,T,L,S,7,p[12]),E,T,I,12,p[13]),k,E,M,17,p[14]),L,k,C,22,p[15]),T=n(T,L=n(L,k=n(k,E,T,L,u,5,p[16]),E,T,g,9,p[17]),k,E,w,14,p[18]),L,k,c,20,p[19]),T=n(T,L=n(L,k=n(k,E,T,L,f,5,p[20]),E,T,b,9,p[21]),k,E,C,14,p[22]),L,k,m,20,p[23]),T=n(T,L=n(L,k=n(k,E,T,L,x,5,p[24]),E,T,M,9,p[25]),k,E,_,14,p[26]),L,k,v,20,p[27]),T=n(T,L=n(L,k=n(k,E,T,L,I,5,p[28]),E,T,d,9,p[29]),k,E,y,14,p[30]),L,k,S,20,p[31]),T=a(T,L=a(L,k=a(k,E,T,L,f,4,p[32]),E,T,v,11,p[33]),k,E,w,16,p[34]),L,k,M,23,p[35]),T=a(T,L=a(L,k=a(k,E,T,L,u,4,p[36]),E,T,m,11,p[37]),k,E,y,16,p[38]),L,k,b,23,p[39]),T=a(T,L=a(L,k=a(k,E,T,L,I,4,p[40]),E,T,c,11,p[41]),k,E,_,16,p[42]),L,k,g,23,p[43]),T=a(T,L=a(L,k=a(k,E,T,L,x,4,p[44]),E,T,S,11,p[45]),k,E,C,16,p[46]),L,k,d,23,p[47]),T=r(T,L=r(L,k=r(k,E,T,L,c,6,p[48]),E,T,y,10,p[49]),k,E,M,15,p[50]),L,k,f,21,p[51]),T=r(T,L=r(L,k=r(k,E,T,L,S,6,p[52]),E,T,_,10,p[53]),k,E,b,15,p[54]),L,k,u,21,p[55]),T=r(T,L=r(L,k=r(k,E,T,L,v,6,p[56]),E,T,C,10,p[57]),k,E,g,15,p[58]),L,k,I,21,p[59]),T=r(T,L=r(L,k=r(k,E,T,L,m,6,p[60]),E,T,w,10,p[61]),k,E,d,15,p[62]),L,k,x,21,p[63]),l[0]=l[0]+k|0,l[1]=l[1]+E|0,l[2]=l[2]+T|0,l[3]=l[3]+L|0},_doFinalize:function(){var e=this._data,i=e.words,n=8*this._nDataBytes,a=8*e.sigBytes;i[a>>>5]|=128<<24-a%32;var r=t.floor(n/4294967296),o=n;i[15+(a+64>>>9<<4)]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),i[14+(a+64>>>9<<4)]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),e.sigBytes=4*(i.length+1),this._process();for(var s=this._hash,h=s.words,l=0;l<4;l++){var c=h[l];h[l]=16711935&(c<<8|c>>>24)|4278255360&(c<<24|c>>>8)}return s},clone:function(){var e=l.clone.call(this);return e._hash=this._hash.clone(),e}});o.MD5=l._createHelper(u),o.HmacMD5=l._createHmacHelper(u)}(Math),function(){var t=e,i=t.lib,n=i.WordArray,a=i.Hasher,r=[],o=t.algo.SHA1=a.extend({_doReset:function(){this._hash=new n.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var i=this._hash.words,n=i[0],a=i[1],o=i[2],s=i[3],h=i[4],l=0;l<80;l++){if(l<16)r[l]=0|e[t+l];else{var c=r[l-3]^r[l-8]^r[l-14]^r[l-16];r[l]=c<<1|c>>>31}var p=(n<<5|n>>>27)+h+r[l];p+=l<20?1518500249+(a&o|~a&s):l<40?1859775393+(a^o^s):l<60?(a&o|a&s|o&s)-1894007588:(a^o^s)-899497514,h=s,s=o,o=a<<30|a>>>2,a=n,n=p}i[0]=i[0]+n|0,i[1]=i[1]+a|0,i[2]=i[2]+o|0,i[3]=i[3]+s|0,i[4]=i[4]+h|0},_doFinalize:function(){var e=this._data,t=e.words,i=8*this._nDataBytes,n=8*e.sigBytes;return t[n>>>5]|=128<<24-n%32,t[14+(n+64>>>9<<4)]=Math.floor(i/4294967296),t[15+(n+64>>>9<<4)]=i,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=a.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA1=a._createHelper(o),t.HmacSHA1=a._createHmacHelper(o)}(),function(t){var i=e,n=i.lib,a=n.WordArray,r=n.Hasher,o=i.algo,s=[],h=[];!function(){function e(e){for(var i=t.sqrt(e),n=2;n<=i;n++)if(!(e%n))return!1;return!0}function i(e){return 4294967296*(e-(0|e))|0}for(var n=2,a=0;a<64;)e(n)&&(a<8&&(s[a]=i(t.pow(n,.5))),h[a]=i(t.pow(n,1/3)),a++),n++}();var l=[],c=o.SHA256=r.extend({_doReset:function(){this._hash=new a.init(s.slice(0))},_doProcessBlock:function(e,t){for(var i=this._hash.words,n=i[0],a=i[1],r=i[2],o=i[3],s=i[4],c=i[5],p=i[6],u=i[7],d=0;d<64;d++){if(d<16)l[d]=0|e[t+d];else{var _=l[d-15],m=(_<<25|_>>>7)^(_<<14|_>>>18)^_>>>3,f=l[d-2],g=(f<<15|f>>>17)^(f<<13|f>>>19)^f>>>10;l[d]=m+l[d-7]+g+l[d-16]}var y=n&a^n&r^a&r,v=(n<<30|n>>>2)^(n<<19|n>>>13)^(n<<10|n>>>22),x=u+((s<<26|s>>>6)^(s<<21|s>>>11)^(s<<7|s>>>25))+(s&c^~s&p)+h[d]+l[d];u=p,p=c,c=s,s=o+x|0,o=r,r=a,a=n,n=x+(v+y)|0}i[0]=i[0]+n|0,i[1]=i[1]+a|0,i[2]=i[2]+r|0,i[3]=i[3]+o|0,i[4]=i[4]+s|0,i[5]=i[5]+c|0,i[6]=i[6]+p|0,i[7]=i[7]+u|0},_doFinalize:function(){var e=this._data,i=e.words,n=8*this._nDataBytes,a=8*e.sigBytes;return i[a>>>5]|=128<<24-a%32,i[14+(a+64>>>9<<4)]=t.floor(n/4294967296),i[15+(a+64>>>9<<4)]=n,e.sigBytes=4*i.length,this._process(),this._hash},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}});i.SHA256=r._createHelper(c),i.HmacSHA256=r._createHmacHelper(c)}(Math),function(){function t(e){return e<<8&4278255360|e>>>8&16711935}var i=e,n=i.lib.WordArray,a=i.enc;a.Utf16=a.Utf16BE={stringify:function(e){for(var t=e.words,i=e.sigBytes,n=[],a=0;a<i;a+=2){var r=t[a>>>2]>>>16-a%4*8&65535;n.push(String.fromCharCode(r))}return n.join("")},parse:function(e){for(var t=e.length,i=[],a=0;a<t;a++)i[a>>>1]|=e.charCodeAt(a)<<16-a%2*16;return n.create(i,2*t)}};a.Utf16LE={stringify:function(e){for(var i=e.words,n=e.sigBytes,a=[],r=0;r<n;r+=2){var o=t(i[r>>>2]>>>16-r%4*8&65535);a.push(String.fromCharCode(o))}return a.join("")},parse:function(e){for(var i=e.length,a=[],r=0;r<i;r++)a[r>>>1]|=t(e.charCodeAt(r)<<16-r%2*16);return n.create(a,2*i)}}}(),function(){if("function"==typeof ArrayBuffer){var t=e.lib.WordArray,i=t.init;(t.init=function(e){if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),(e instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array)&&(e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),e instanceof Uint8Array){for(var t=e.byteLength,n=[],a=0;a<t;a++)n[a>>>2]|=e[a]<<24-a%4*8;i.call(this,n,t)}else i.apply(this,arguments)}).prototype=t}}(),function(t){function i(e,t,i){return e^t^i}function n(e,t,i){return e&t|~e&i}function a(e,t,i){return(e|~t)^i}function r(e,t,i){return e&i|t&~i}function o(e,t,i){return e^(t|~i)}function s(e,t){return e<<t|e>>>32-t}var h=e,l=h.lib,c=l.WordArray,p=l.Hasher,u=h.algo,d=c.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),_=c.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),m=c.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),f=c.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),g=c.create([0,1518500249,1859775393,2400959708,2840853838]),y=c.create([1352829926,1548603684,1836072691,2053994217,0]),v=u.RIPEMD160=p.extend({_doReset:function(){this._hash=c.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(R=0;R<16;R++){var h=t+R,l=e[h];e[h]=16711935&(l<<8|l>>>24)|4278255360&(l<<24|l>>>8)}var c,p,u,v,x,b,w,S,I,M,C=this._hash.words,k=g.words,E=y.words,T=d.words,L=_.words,D=m.words,N=f.words;b=c=C[0],w=p=C[1],S=u=C[2],I=v=C[3],M=x=C[4];for(var A,R=0;R<80;R+=1)A=c+e[t+T[R]]|0,A+=R<16?i(p,u,v)+k[0]:R<32?n(p,u,v)+k[1]:R<48?a(p,u,v)+k[2]:R<64?r(p,u,v)+k[3]:o(p,u,v)+k[4],A=(A=s(A|=0,D[R]))+x|0,c=x,x=v,v=s(u,10),u=p,p=A,A=b+e[t+L[R]]|0,A+=R<16?o(w,S,I)+E[0]:R<32?r(w,S,I)+E[1]:R<48?a(w,S,I)+E[2]:R<64?n(w,S,I)+E[3]:i(w,S,I)+E[4],A=(A=s(A|=0,N[R]))+M|0,b=M,M=I,I=s(S,10),S=w,w=A;A=C[1]+u+I|0,C[1]=C[2]+v+M|0,C[2]=C[3]+x+b|0,C[3]=C[4]+c+w|0,C[4]=C[0]+p+S|0,C[0]=A},_doFinalize:function(){var e=this._data,t=e.words,i=8*this._nDataBytes,n=8*e.sigBytes;t[n>>>5]|=128<<24-n%32,t[14+(n+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),e.sigBytes=4*(t.length+1),this._process();for(var a=this._hash,r=a.words,o=0;o<5;o++){var s=r[o];r[o]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8)}return a},clone:function(){var e=p.clone.call(this);return e._hash=this._hash.clone(),e}});h.RIPEMD160=p._createHelper(v),h.HmacRIPEMD160=p._createHmacHelper(v)}(Math),function(){var t=e,i=t.lib.Base,n=t.enc.Utf8;t.algo.HMAC=i.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=n.parse(t));var i=e.blockSize,a=4*i;t.sigBytes>a&&(t=e.finalize(t)),t.clamp();for(var r=this._oKey=t.clone(),o=this._iKey=t.clone(),s=r.words,h=o.words,l=0;l<i;l++)s[l]^=1549556828,h[l]^=909522486;r.sigBytes=o.sigBytes=a,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,i=t.finalize(e);t.reset();return t.finalize(this._oKey.clone().concat(i))}})}(),function(){var t=e,i=t.lib,n=i.Base,a=i.WordArray,r=t.algo,o=r.SHA1,s=r.HMAC,h=r.PBKDF2=n.extend({cfg:n.extend({keySize:4,hasher:o,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var i=this.cfg,n=s.create(i.hasher,e),r=a.create(),o=a.create([1]),h=r.words,l=o.words,c=i.keySize,p=i.iterations;h.length<c;){var u=n.update(t).finalize(o);n.reset();for(var d=u.words,_=d.length,m=u,f=1;f<p;f++){m=n.finalize(m),n.reset();for(var g=m.words,y=0;y<_;y++)d[y]^=g[y]}r.concat(u),l[0]++}return r.sigBytes=4*c,r}});t.PBKDF2=function(e,t,i){return h.create(i).compute(e,t)}}(),function(){var t=e,i=t.lib,n=i.Base,a=i.WordArray,r=t.algo,o=r.MD5,s=r.EvpKDF=n.extend({cfg:n.extend({keySize:4,hasher:o,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var i=this.cfg,n=i.hasher.create(),r=a.create(),o=r.words,s=i.keySize,h=i.iterations;o.length<s;){l&&n.update(l);var l=n.update(e).finalize(t);n.reset();for(var c=1;c<h;c++)l=n.finalize(l),n.reset();r.concat(l)}return r.sigBytes=4*s,r}});t.EvpKDF=function(e,t,i){return s.create(i).compute(e,t)}}(),function(){var t=e,i=t.lib.WordArray,n=t.algo,a=n.SHA256,r=n.SHA224=a.extend({_doReset:function(){this._hash=new i.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var e=a._doFinalize.call(this);return e.sigBytes-=4,e}});t.SHA224=a._createHelper(r),t.HmacSHA224=a._createHmacHelper(r)}(),function(t){var i=e,n=i.lib,a=n.Base,r=n.WordArray,o=i.x64={};o.Word=a.extend({init:function(e,t){this.high=e,this.low=t}}),o.WordArray=a.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=void 0!=t?t:8*e.length},toX32:function(){for(var e=this.words,t=e.length,i=[],n=0;n<t;n++){var a=e[n];i.push(a.high),i.push(a.low)}return r.create(i,this.sigBytes)},clone:function(){for(var e=a.clone.call(this),t=e.words=this.words.slice(0),i=t.length,n=0;n<i;n++)t[n]=t[n].clone();return e}})}(),function(t){var i=e,n=i.lib,a=n.WordArray,r=n.Hasher,o=i.x64.Word,s=i.algo,h=[],l=[],c=[];!function(){for(var e=1,t=0,i=0;i<24;i++){h[e+5*t]=(i+1)*(i+2)/2%64;var n=(2*e+3*t)%5;e=t%5,t=n}for(e=0;e<5;e++)for(t=0;t<5;t++)l[e+5*t]=t+(2*e+3*t)%5*5;for(var a=1,r=0;r<24;r++){for(var s=0,p=0,u=0;u<7;u++){if(1&a){var d=(1<<u)-1;d<32?p^=1<<d:s^=1<<d-32}128&a?a=a<<1^113:a<<=1}c[r]=o.create(s,p)}}();var p=[];!function(){for(var e=0;e<25;e++)p[e]=o.create()}();var u=s.SHA3=r.extend({cfg:r.cfg.extend({outputLength:512}),_doReset:function(){for(var e=this._state=[],t=0;t<25;t++)e[t]=new o.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(e,t){for(var i=this._state,n=this.blockSize/2,a=0;a<n;a++){var r=e[t+2*a],o=e[t+2*a+1];r=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),o=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8);(E=i[a]).high^=o,E.low^=r}for(var s=0;s<24;s++){for(C=0;C<5;C++){for(var u=0,d=0,_=0;_<5;_++){u^=(E=i[C+5*_]).high,d^=E.low}var m=p[C];m.high=u,m.low=d}for(C=0;C<5;C++)for(var f=p[(C+4)%5],g=p[(C+1)%5],y=g.high,v=g.low,u=f.high^(y<<1|v>>>31),d=f.low^(v<<1|y>>>31),_=0;_<5;_++){(E=i[C+5*_]).high^=u,E.low^=d}for(k=1;k<25;k++){var x=(E=i[k]).high,b=E.low,w=h[k];if(w<32)var u=x<<w|b>>>32-w,d=b<<w|x>>>32-w;else var u=b<<w-32|x>>>64-w,d=x<<w-32|b>>>64-w;var S=p[l[k]];S.high=u,S.low=d}var I=p[0],M=i[0];I.high=M.high,I.low=M.low;for(var C=0;C<5;C++)for(_=0;_<5;_++){var k,E=i[k=C+5*_],T=p[k],L=p[(C+1)%5+5*_],D=p[(C+2)%5+5*_];E.high=T.high^~L.high&D.high,E.low=T.low^~L.low&D.low}var E=i[0],N=c[s];E.high^=N.high,E.low^=N.low}},_doFinalize:function(){var e=this._data,i=e.words,n=(this._nDataBytes,8*e.sigBytes),r=32*this.blockSize;i[n>>>5]|=1<<24-n%32,i[(t.ceil((n+1)/r)*r>>>5)-1]|=128,e.sigBytes=4*i.length,this._process();for(var o=this._state,s=this.cfg.outputLength/8,h=s/8,l=[],c=0;c<h;c++){var p=o[c],u=p.high,d=p.low;u=16711935&(u<<8|u>>>24)|4278255360&(u<<24|u>>>8),d=16711935&(d<<8|d>>>24)|4278255360&(d<<24|d>>>8),l.push(d),l.push(u)}return new a.init(l,s)},clone:function(){for(var e=r.clone.call(this),t=e._state=this._state.slice(0),i=0;i<25;i++)t[i]=t[i].clone();return e}});i.SHA3=r._createHelper(u),i.HmacSHA3=r._createHmacHelper(u)}(Math),function(){function t(){return r.create.apply(r,arguments)}var i=e,n=i.lib.Hasher,a=i.x64,r=a.Word,o=a.WordArray,s=i.algo,h=[t(1116352408,3609767458),t(1899447441,602891725),t(3049323471,3964484399),t(3921009573,2173295548),t(961987163,4081628472),t(1508970993,3053834265),t(2453635748,2937671579),t(2870763221,3664609560),t(3624381080,2734883394),t(310598401,1164996542),t(607225278,1323610764),t(1426881987,3590304994),t(1925078388,4068182383),t(2162078206,991336113),t(2614888103,633803317),t(3248222580,3479774868),t(3835390401,2666613458),t(4022224774,944711139),t(264347078,2341262773),t(604807628,2007800933),t(770255983,1495990901),t(1249150122,1856431235),t(1555081692,3175218132),t(1996064986,2198950837),t(2554220882,3999719339),t(2821834349,766784016),t(2952996808,2566594879),t(3210313671,3203337956),t(3336571891,1034457026),t(3584528711,2466948901),t(113926993,3758326383),t(338241895,168717936),t(666307205,1188179964),t(773529912,1546045734),t(1294757372,1522805485),t(1396182291,2643833823),t(1695183700,2343527390),t(1986661051,1014477480),t(2177026350,1206759142),t(2456956037,344077627),t(2730485921,1290863460),t(2820302411,3158454273),t(3259730800,3505952657),t(3345764771,106217008),t(3516065817,3606008344),t(3600352804,1432725776),t(4094571909,1467031594),t(275423344,851169720),t(430227734,3100823752),t(506948616,1363258195),t(659060556,3750685593),t(883997877,3785050280),t(958139571,3318307427),t(1322822218,3812723403),t(1537002063,2003034995),t(1747873779,3602036899),t(1955562222,1575990012),t(2024104815,1125592928),t(2227730452,2716904306),t(2361852424,442776044),t(2428436474,593698344),t(2756734187,3733110249),t(3204031479,2999351573),t(3329325298,3815920427),t(3391569614,3928383900),t(3515267271,566280711),t(3940187606,3454069534),t(4118630271,4000239992),t(116418474,1914138554),t(174292421,2731055270),t(289380356,3203993006),t(460393269,320620315),t(685471733,587496836),t(852142971,1086792851),t(1017036298,365543100),t(1126000580,2618297676),t(1288033470,3409855158),t(1501505948,4234509866),t(1607167915,987167468),t(1816402316,1246189591)],l=[];!function(){for(var e=0;e<80;e++)l[e]=t()}();var c=s.SHA512=n.extend({_doReset:function(){this._hash=new o.init([new r.init(1779033703,4089235720),new r.init(3144134277,2227873595),new r.init(1013904242,4271175723),new r.init(2773480762,1595750129),new r.init(1359893119,2917565137),new r.init(2600822924,725511199),new r.init(528734635,4215389547),new r.init(1541459225,327033209)])},_doProcessBlock:function(e,t){for(var i=this._hash.words,n=i[0],a=i[1],r=i[2],o=i[3],s=i[4],c=i[5],p=i[6],u=i[7],d=n.high,_=n.low,m=a.high,f=a.low,g=r.high,y=r.low,v=o.high,x=o.low,b=s.high,w=s.low,S=c.high,I=c.low,M=p.high,C=p.low,k=u.high,E=u.low,T=d,L=_,D=m,N=f,A=g,R=y,B=v,P=x,O=b,V=w,U=S,F=I,H=M,z=C,X=k,Y=E,G=0;G<80;G++){var j=l[G];if(G<16)var W=j.high=0|e[t+2*G],q=j.low=0|e[t+2*G+1];else{var K=l[G-15],J=K.high,Z=K.low,Q=(J>>>1|Z<<31)^(J>>>8|Z<<24)^J>>>7,$=(Z>>>1|J<<31)^(Z>>>8|J<<24)^(Z>>>7|J<<25),ee=l[G-2],te=ee.high,ie=ee.low,ne=(te>>>19|ie<<13)^(te<<3|ie>>>29)^te>>>6,ae=(ie>>>19|te<<13)^(ie<<3|te>>>29)^(ie>>>6|te<<26),re=l[G-7],oe=re.high,se=re.low,he=l[G-16],le=he.high,ce=he.low,W=(W=(W=Q+oe+((q=$+se)>>>0<$>>>0?1:0))+ne+((q=q+ae)>>>0<ae>>>0?1:0))+le+((q=q+ce)>>>0<ce>>>0?1:0);j.high=W,j.low=q}var pe=O&U^~O&H,ue=V&F^~V&z,de=T&D^T&A^D&A,_e=L&N^L&R^N&R,me=(T>>>28|L<<4)^(T<<30|L>>>2)^(T<<25|L>>>7),fe=(L>>>28|T<<4)^(L<<30|T>>>2)^(L<<25|T>>>7),ge=(O>>>14|V<<18)^(O>>>18|V<<14)^(O<<23|V>>>9),ye=(V>>>14|O<<18)^(V>>>18|O<<14)^(V<<23|O>>>9),ve=h[G],xe=ve.high,be=ve.low,we=Y+ye,Se=X+ge+(we>>>0<Y>>>0?1:0),Ie=fe+_e;X=H,Y=z,H=U,z=F,U=O,F=V,O=B+(Se=(Se=(Se=Se+pe+((we=we+ue)>>>0<ue>>>0?1:0))+xe+((we=we+be)>>>0<be>>>0?1:0))+W+((we=we+q)>>>0<q>>>0?1:0))+((V=P+we|0)>>>0<P>>>0?1:0)|0,B=A,P=R,A=D,R=N,D=T,N=L,T=Se+(me+de+(Ie>>>0<fe>>>0?1:0))+((L=we+Ie|0)>>>0<we>>>0?1:0)|0}_=n.low=_+L,n.high=d+T+(_>>>0<L>>>0?1:0),f=a.low=f+N,a.high=m+D+(f>>>0<N>>>0?1:0),y=r.low=y+R,r.high=g+A+(y>>>0<R>>>0?1:0),x=o.low=x+P,o.high=v+B+(x>>>0<P>>>0?1:0),w=s.low=w+V,s.high=b+O+(w>>>0<V>>>0?1:0),I=c.low=I+F,c.high=S+U+(I>>>0<F>>>0?1:0),C=p.low=C+z,p.high=M+H+(C>>>0<z>>>0?1:0),E=u.low=E+Y,u.high=k+X+(E>>>0<Y>>>0?1:0)},_doFinalize:function(){var e=this._data,t=e.words,i=8*this._nDataBytes,n=8*e.sigBytes;t[n>>>5]|=128<<24-n%32,t[30+(n+128>>>10<<5)]=Math.floor(i/4294967296),t[31+(n+128>>>10<<5)]=i,e.sigBytes=4*t.length,this._process();return this._hash.toX32()},clone:function(){var e=n.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:32});i.SHA512=n._createHelper(c),i.HmacSHA512=n._createHmacHelper(c)}(),function(){var t=e,i=t.x64,n=i.Word,a=i.WordArray,r=t.algo,o=r.SHA512,s=r.SHA384=o.extend({_doReset:function(){this._hash=new a.init([new n.init(3418070365,3238371032),new n.init(1654270250,914150663),new n.init(2438529370,812702999),new n.init(355462360,4144912697),new n.init(1731405415,4290775857),new n.init(2394180231,1750603025),new n.init(3675008525,1694076839),new n.init(1203062813,3204075428)])},_doFinalize:function(){var e=o._doFinalize.call(this);return e.sigBytes-=16,e}});t.SHA384=o._createHelper(s),t.HmacSHA384=o._createHmacHelper(s)}(),e.lib.Cipher||function(t){var i=e,n=i.lib,a=n.Base,r=n.WordArray,o=n.BufferedBlockAlgorithm,s=i.enc,h=(s.Utf8,s.Base64),l=i.algo.EvpKDF,c=n.Cipher=o.extend({cfg:a.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,i){this.cfg=this.cfg.extend(i),this._xformMode=e,this._key=t,this.reset()},reset:function(){o.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){e&&this._append(e);return this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function e(e){return"string"==typeof e?v:g}return function(t){return{encrypt:function(i,n,a){return e(n).encrypt(t,i,n,a)},decrypt:function(i,n,a){return e(n).decrypt(t,i,n,a)}}}}()}),p=(n.StreamCipher=c.extend({_doFinalize:function(){return this._process(!0)},blockSize:1}),i.mode={}),u=n.BlockCipherMode=a.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}}),d=p.CBC=function(){function e(e,i,n){var a=this._iv;if(a){r=a;this._iv=t}else var r=this._prevBlock;for(var o=0;o<n;o++)e[i+o]^=r[o]}var i=u.extend();return i.Encryptor=i.extend({processBlock:function(t,i){var n=this._cipher,a=n.blockSize;e.call(this,t,i,a),n.encryptBlock(t,i),this._prevBlock=t.slice(i,i+a)}}),i.Decryptor=i.extend({processBlock:function(t,i){var n=this._cipher,a=n.blockSize,r=t.slice(i,i+a);n.decryptBlock(t,i),e.call(this,t,i,a),this._prevBlock=r}}),i}(),_=(i.pad={}).Pkcs7={pad:function(e,t){for(var i=4*t,n=i-e.sigBytes%i,a=n<<24|n<<16|n<<8|n,o=[],s=0;s<n;s+=4)o.push(a);var h=r.create(o,n);e.concat(h)},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},m=(n.BlockCipher=c.extend({cfg:c.cfg.extend({mode:d,padding:_}),reset:function(){c.reset.call(this);var e=this.cfg,t=e.iv,i=e.mode;if(this._xformMode==this._ENC_XFORM_MODE)n=i.createEncryptor;else{var n=i.createDecryptor;this._minBufferSize=1}this._mode&&this._mode.__creator==n?this._mode.init(this,t&&t.words):(this._mode=n.call(i,this,t&&t.words),this._mode.__creator=n)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);t=this._process(!0)}else{var t=this._process(!0);e.unpad(t)}return t},blockSize:4}),n.CipherParams=a.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}})),f=(i.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext,i=e.salt;if(i)n=r.create([1398893684,1701076831]).concat(i).concat(t);else var n=t;return n.toString(h)},parse:function(e){var t=h.parse(e),i=t.words;if(1398893684==i[0]&&1701076831==i[1]){var n=r.create(i.slice(2,4));i.splice(0,4),t.sigBytes-=16}return m.create({ciphertext:t,salt:n})}},g=n.SerializableCipher=a.extend({cfg:a.extend({format:f}),encrypt:function(e,t,i,n){n=this.cfg.extend(n);var a=e.createEncryptor(i,n),r=a.finalize(t),o=a.cfg;return m.create({ciphertext:r,key:i,iv:o.iv,algorithm:e,mode:o.mode,padding:o.padding,blockSize:e.blockSize,formatter:n.format})},decrypt:function(e,t,i,n){n=this.cfg.extend(n),t=this._parse(t,n.format);return e.createDecryptor(i,n).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}}),y=(i.kdf={}).OpenSSL={execute:function(e,t,i,n){n||(n=r.random(8));var a=l.create({keySize:t+i}).compute(e,n),o=r.create(a.words.slice(t),4*i);return a.sigBytes=4*t,m.create({key:a,iv:o,salt:n})}},v=n.PasswordBasedCipher=g.extend({cfg:g.cfg.extend({kdf:y}),encrypt:function(e,t,i,n){var a=(n=this.cfg.extend(n)).kdf.execute(i,e.keySize,e.ivSize);n.iv=a.iv;var r=g.encrypt.call(this,e,t,a.key,n);return r.mixIn(a),r},decrypt:function(e,t,i,n){n=this.cfg.extend(n),t=this._parse(t,n.format);var a=n.kdf.execute(i,e.keySize,e.ivSize,t.salt);n.iv=a.iv;return g.decrypt.call(this,e,t,a.key,n)}})}(),e.mode.CFB=function(){function t(e,t,i,n){var a=this._iv;if(a){r=a.slice(0);this._iv=void 0}else var r=this._prevBlock;n.encryptBlock(r,0);for(var o=0;o<i;o++)e[t+o]^=r[o]}var i=e.lib.BlockCipherMode.extend();return i.Encryptor=i.extend({processBlock:function(e,i){var n=this._cipher,a=n.blockSize;t.call(this,e,i,a,n),this._prevBlock=e.slice(i,i+a)}}),i.Decryptor=i.extend({processBlock:function(e,i){var n=this._cipher,a=n.blockSize,r=e.slice(i,i+a);t.call(this,e,i,a,n),this._prevBlock=r}}),i}(),e.mode.ECB=function(){var t=e.lib.BlockCipherMode.extend();return t.Encryptor=t.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),t.Decryptor=t.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),t}(),e.pad.AnsiX923={pad:function(e,t){var i=e.sigBytes,n=4*t,a=n-i%n,r=i+a-1;e.clamp(),e.words[r>>>2]|=a<<24-r%4*8,e.sigBytes+=a},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},e.pad.Iso10126={pad:function(t,i){var n=4*i,a=n-t.sigBytes%n;t.concat(e.lib.WordArray.random(a-1)).concat(e.lib.WordArray.create([a<<24],1))},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},e.pad.Iso97971={pad:function(t,i){t.concat(e.lib.WordArray.create([2147483648],1)),e.pad.ZeroPadding.pad(t,i)},unpad:function(t){e.pad.ZeroPadding.unpad(t),t.sigBytes--}},e.mode.OFB=function(){var t=e.lib.BlockCipherMode.extend(),i=t.Encryptor=t.extend({processBlock:function(e,t){var i=this._cipher,n=i.blockSize,a=this._iv,r=this._keystream;a&&(r=this._keystream=a.slice(0),this._iv=void 0),i.encryptBlock(r,0);for(var o=0;o<n;o++)e[t+o]^=r[o]}});return t.Decryptor=i,t}(),e.pad.NoPadding={pad:function(){},unpad:function(){}},function(t){var i=e,n=i.lib.CipherParams,a=i.enc.Hex;i.format.Hex={stringify:function(e){return e.ciphertext.toString(a)},parse:function(e){var t=a.parse(e);return n.create({ciphertext:t})}}}(),function(){var t=e,i=t.lib.BlockCipher,n=t.algo,a=[],r=[],o=[],s=[],h=[],l=[],c=[],p=[],u=[],d=[];!function(){for(var e=[],t=0;t<256;t++)e[t]=t<128?t<<1:t<<1^283;for(var i=0,n=0,t=0;t<256;t++){var _=n^n<<1^n<<2^n<<3^n<<4;_=_>>>8^255&_^99,a[i]=_,r[_]=i;var m=e[i],f=e[m],g=e[f],y=257*e[_]^16843008*_;o[i]=y<<24|y>>>8,s[i]=y<<16|y>>>16,h[i]=y<<8|y>>>24,l[i]=y;y=16843009*g^65537*f^257*m^16843008*i;c[_]=y<<24|y>>>8,p[_]=y<<16|y>>>16,u[_]=y<<8|y>>>24,d[_]=y,i?(i=m^e[e[e[g^m]]],n^=e[e[n]]):i=n=1}}();var _=[0,1,2,4,8,16,32,64,128,27,54],m=n.AES=i.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var e=this._keyPriorReset=this._key,t=e.words,i=e.sigBytes/4,n=4*((this._nRounds=i+6)+1),r=this._keySchedule=[],o=0;o<n;o++)if(o<i)r[o]=t[o];else{l=r[o-1];o%i?i>6&&o%i==4&&(l=a[l>>>24]<<24|a[l>>>16&255]<<16|a[l>>>8&255]<<8|a[255&l]):(l=a[(l=l<<8|l>>>24)>>>24]<<24|a[l>>>16&255]<<16|a[l>>>8&255]<<8|a[255&l],l^=_[o/i|0]<<24),r[o]=r[o-i]^l}for(var s=this._invKeySchedule=[],h=0;h<n;h++){o=n-h;if(h%4)l=r[o];else var l=r[o-4];s[h]=h<4||o<=4?l:c[a[l>>>24]]^p[a[l>>>16&255]]^u[a[l>>>8&255]]^d[a[255&l]]}}},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,o,s,h,l,a)},decryptBlock:function(e,t){i=e[t+1];e[t+1]=e[t+3],e[t+3]=i,this._doCryptBlock(e,t,this._invKeySchedule,c,p,u,d,r);var i=e[t+1];e[t+1]=e[t+3],e[t+3]=i},_doCryptBlock:function(e,t,i,n,a,r,o,s){for(var h=this._nRounds,l=e[t]^i[0],c=e[t+1]^i[1],p=e[t+2]^i[2],u=e[t+3]^i[3],d=4,_=1;_<h;_++){var m=n[l>>>24]^a[c>>>16&255]^r[p>>>8&255]^o[255&u]^i[d++],f=n[c>>>24]^a[p>>>16&255]^r[u>>>8&255]^o[255&l]^i[d++],g=n[p>>>24]^a[u>>>16&255]^r[l>>>8&255]^o[255&c]^i[d++],y=n[u>>>24]^a[l>>>16&255]^r[c>>>8&255]^o[255&p]^i[d++];l=m,c=f,p=g,u=y}var m=(s[l>>>24]<<24|s[c>>>16&255]<<16|s[p>>>8&255]<<8|s[255&u])^i[d++],f=(s[c>>>24]<<24|s[p>>>16&255]<<16|s[u>>>8&255]<<8|s[255&l])^i[d++],g=(s[p>>>24]<<24|s[u>>>16&255]<<16|s[l>>>8&255]<<8|s[255&c])^i[d++],y=(s[u>>>24]<<24|s[l>>>16&255]<<16|s[c>>>8&255]<<8|s[255&p])^i[d++];e[t]=m,e[t+1]=f,e[t+2]=g,e[t+3]=y},keySize:8});t.AES=i._createHelper(m)}(),function(){function t(e,t){var i=(this._lBlock>>>e^this._rBlock)&t;this._rBlock^=i,this._lBlock^=i<<e}function i(e,t){var i=(this._rBlock>>>e^this._lBlock)&t;this._lBlock^=i,this._rBlock^=i<<e}var n=e,a=n.lib,r=a.WordArray,o=a.BlockCipher,s=n.algo,h=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],l=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],c=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],p=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],u=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],d=s.DES=o.extend({_doReset:function(){for(var e=this._key.words,t=[],i=0;i<56;i++){var n=h[i]-1;t[i]=e[n>>>5]>>>31-n%32&1}for(var a=this._subKeys=[],r=0;r<16;r++){for(var o=a[r]=[],s=c[r],i=0;i<24;i++)o[i/6|0]|=t[(l[i]-1+s)%28]<<31-i%6,o[4+(i/6|0)]|=t[28+(l[i+24]-1+s)%28]<<31-i%6;o[0]=o[0]<<1|o[0]>>>31;for(i=1;i<7;i++)o[i]=o[i]>>>4*(i-1)+3;o[7]=o[7]<<5|o[7]>>>27}for(var p=this._invSubKeys=[],i=0;i<16;i++)p[i]=a[15-i]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._subKeys)},decryptBlock:function(e,t){this._doCryptBlock(e,t,this._invSubKeys)},_doCryptBlock:function(e,n,a){this._lBlock=e[n],this._rBlock=e[n+1],t.call(this,4,252645135),t.call(this,16,65535),i.call(this,2,858993459),i.call(this,8,16711935),t.call(this,1,1431655765);for(var r=0;r<16;r++){for(var o=a[r],s=this._lBlock,h=this._rBlock,l=0,c=0;c<8;c++)l|=p[c][((h^o[c])&u[c])>>>0];this._lBlock=h,this._rBlock=s^l}var d=this._lBlock;this._lBlock=this._rBlock,this._rBlock=d,t.call(this,1,1431655765),i.call(this,8,16711935),i.call(this,2,858993459),t.call(this,16,65535),t.call(this,4,252645135),e[n]=this._lBlock,e[n+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});n.DES=o._createHelper(d);var _=s.TripleDES=o.extend({_doReset:function(){var e=this._key.words;this._des1=d.createEncryptor(r.create(e.slice(0,2))),this._des2=d.createEncryptor(r.create(e.slice(2,4))),this._des3=d.createEncryptor(r.create(e.slice(4,6)))},encryptBlock:function(e,t){this._des1.encryptBlock(e,t),this._des2.decryptBlock(e,t),this._des3.encryptBlock(e,t)},decryptBlock:function(e,t){this._des3.decryptBlock(e,t),this._des2.encryptBlock(e,t),this._des1.decryptBlock(e,t)},keySize:6,ivSize:2,blockSize:2});n.TripleDES=o._createHelper(_)}(),function(){function t(){for(var e=this._S,t=this._i,i=this._j,n=0,a=0;a<4;a++){i=(i+e[t=(t+1)%256])%256;var r=e[t];e[t]=e[i],e[i]=r,n|=e[(e[t]+e[i])%256]<<24-8*a}return this._i=t,this._j=i,n}var i=e,n=i.lib.StreamCipher,a=i.algo,r=a.RC4=n.extend({_doReset:function(){for(var e=this._key,t=e.words,i=e.sigBytes,n=this._S=[],a=0;a<256;a++)n[a]=a;for(var a=0,r=0;a<256;a++){var o=a%i,s=t[o>>>2]>>>24-o%4*8&255;r=(r+n[a]+s)%256;var h=n[a];n[a]=n[r],n[r]=h}this._i=this._j=0},_doProcessBlock:function(e,i){e[i]^=t.call(this)},keySize:8,ivSize:0});i.RC4=n._createHelper(r);var o=a.RC4Drop=r.extend({cfg:r.cfg.extend({drop:192}),_doReset:function(){r._doReset.call(this);for(var e=this.cfg.drop;e>0;e--)t.call(this)}});i.RC4Drop=n._createHelper(o)}(),e.mode.CTRGladman=function(){function t(e){if(255==(e>>24&255)){var t=e>>16&255,i=e>>8&255,n=255&e;255===t?(t=0,255===i?(i=0,255===n?n=0:++n):++i):++t,e=0,e+=t<<16,e+=i<<8,e+=n}else e+=1<<24;return e}var i=e.lib.BlockCipherMode.extend(),n=i.Encryptor=i.extend({processBlock:function(e,i){var n=this._cipher,a=n.blockSize,r=this._iv,o=this._counter;r&&(o=this._counter=r.slice(0),this._iv=void 0),function(e){0===(e[0]=t(e[0]))&&(e[1]=t(e[1]))}(o);var s=o.slice(0);n.encryptBlock(s,0);for(var h=0;h<a;h++)e[i+h]^=s[h]}});return i.Decryptor=n,i}(),function(){function t(){for(var e=this._X,t=this._C,i=0;i<8;i++)r[i]=t[i];t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<r[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<r[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<r[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<r[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<r[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<r[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<r[6]>>>0?1:0)|0,this._b=t[7]>>>0<r[7]>>>0?1:0;for(i=0;i<8;i++){var n=e[i]+t[i],a=65535&n,s=n>>>16,h=((a*a>>>17)+a*s>>>15)+s*s,l=((4294901760&n)*n|0)+((65535&n)*n|0);o[i]=h^l}e[0]=o[0]+(o[7]<<16|o[7]>>>16)+(o[6]<<16|o[6]>>>16)|0,e[1]=o[1]+(o[0]<<8|o[0]>>>24)+o[7]|0,e[2]=o[2]+(o[1]<<16|o[1]>>>16)+(o[0]<<16|o[0]>>>16)|0,e[3]=o[3]+(o[2]<<8|o[2]>>>24)+o[1]|0,e[4]=o[4]+(o[3]<<16|o[3]>>>16)+(o[2]<<16|o[2]>>>16)|0,e[5]=o[5]+(o[4]<<8|o[4]>>>24)+o[3]|0,e[6]=o[6]+(o[5]<<16|o[5]>>>16)+(o[4]<<16|o[4]>>>16)|0,e[7]=o[7]+(o[6]<<8|o[6]>>>24)+o[5]|0}var i=e,n=i.lib.StreamCipher,a=[],r=[],o=[],s=i.algo.Rabbit=n.extend({_doReset:function(){for(var e=this._key.words,i=this.cfg.iv,n=0;n<4;n++)e[n]=16711935&(e[n]<<8|e[n]>>>24)|4278255360&(e[n]<<24|e[n]>>>8);var a=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],r=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];this._b=0;for(n=0;n<4;n++)t.call(this);for(n=0;n<8;n++)r[n]^=a[n+4&7];if(i){var o=i.words,s=o[0],h=o[1],l=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),c=16711935&(h<<8|h>>>24)|4278255360&(h<<24|h>>>8),p=l>>>16|4294901760&c,u=c<<16|65535&l;r[0]^=l,r[1]^=p,r[2]^=c,r[3]^=u,r[4]^=l,r[5]^=p,r[6]^=c,r[7]^=u;for(n=0;n<4;n++)t.call(this)}},_doProcessBlock:function(e,i){var n=this._X;t.call(this),a[0]=n[0]^n[5]>>>16^n[3]<<16,a[1]=n[2]^n[7]>>>16^n[5]<<16,a[2]=n[4]^n[1]>>>16^n[7]<<16,a[3]=n[6]^n[3]>>>16^n[1]<<16;for(var r=0;r<4;r++)a[r]=16711935&(a[r]<<8|a[r]>>>24)|4278255360&(a[r]<<24|a[r]>>>8),e[i+r]^=a[r]},blockSize:4,ivSize:2});i.Rabbit=n._createHelper(s)}(),e.mode.CTR=function(){var t=e.lib.BlockCipherMode.extend(),i=t.Encryptor=t.extend({processBlock:function(e,t){var i=this._cipher,n=i.blockSize,a=this._iv,r=this._counter;a&&(r=this._counter=a.slice(0),this._iv=void 0);var o=r.slice(0);i.encryptBlock(o,0),r[n-1]=r[n-1]+1|0;for(var s=0;s<n;s++)e[t+s]^=o[s]}});return t.Decryptor=i,t}(),function(){function t(){for(var e=this._X,t=this._C,i=0;i<8;i++)r[i]=t[i];t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<r[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<r[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<r[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<r[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<r[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<r[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<r[6]>>>0?1:0)|0,this._b=t[7]>>>0<r[7]>>>0?1:0;for(i=0;i<8;i++){var n=e[i]+t[i],a=65535&n,s=n>>>16,h=((a*a>>>17)+a*s>>>15)+s*s,l=((4294901760&n)*n|0)+((65535&n)*n|0);o[i]=h^l}e[0]=o[0]+(o[7]<<16|o[7]>>>16)+(o[6]<<16|o[6]>>>16)|0,e[1]=o[1]+(o[0]<<8|o[0]>>>24)+o[7]|0,e[2]=o[2]+(o[1]<<16|o[1]>>>16)+(o[0]<<16|o[0]>>>16)|0,e[3]=o[3]+(o[2]<<8|o[2]>>>24)+o[1]|0,e[4]=o[4]+(o[3]<<16|o[3]>>>16)+(o[2]<<16|o[2]>>>16)|0,e[5]=o[5]+(o[4]<<8|o[4]>>>24)+o[3]|0,e[6]=o[6]+(o[5]<<16|o[5]>>>16)+(o[4]<<16|o[4]>>>16)|0,e[7]=o[7]+(o[6]<<8|o[6]>>>24)+o[5]|0}var i=e,n=i.lib.StreamCipher,a=[],r=[],o=[],s=i.algo.RabbitLegacy=n.extend({_doReset:function(){var e=this._key.words,i=this.cfg.iv,n=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],a=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];this._b=0;for(u=0;u<4;u++)t.call(this);for(u=0;u<8;u++)a[u]^=n[u+4&7];if(i){var r=i.words,o=r[0],s=r[1],h=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),l=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),c=h>>>16|4294901760&l,p=l<<16|65535&h;a[0]^=h,a[1]^=c,a[2]^=l,a[3]^=p,a[4]^=h,a[5]^=c,a[6]^=l,a[7]^=p;for(var u=0;u<4;u++)t.call(this)}},_doProcessBlock:function(e,i){var n=this._X;t.call(this),a[0]=n[0]^n[5]>>>16^n[3]<<16,a[1]=n[2]^n[7]>>>16^n[5]<<16,a[2]=n[4]^n[1]>>>16^n[7]<<16,a[3]=n[6]^n[3]>>>16^n[1]<<16;for(var r=0;r<4;r++)a[r]=16711935&(a[r]<<8|a[r]>>>24)|4278255360&(a[r]<<24|a[r]>>>8),e[i+r]^=a[r]},blockSize:4,ivSize:2});i.RabbitLegacy=n._createHelper(s)}(),e.pad.ZeroPadding={pad:function(e,t){var i=4*t;e.clamp(),e.sigBytes+=i-(e.sigBytes%i||i)},unpad:function(e){for(var t=e.words,i=e.sigBytes-1;!(t[i>>>2]>>>24-i%4*8&255);)i--;e.sigBytes=i+1}},e}),Object.getPrototypeOf||(Object.getPrototypeOf=function(e){if(e!==Object(e))throw TypeError("Object.getPrototypeOf called on non-object");return e.__proto__||e.constructor.prototype||Object.prototype}),"function"!=typeof Object.getOwnPropertyNames&&(Object.getOwnPropertyNames=function(e){if(e!==Object(e))throw TypeError("Object.getOwnPropertyNames called on non-object");var t,i=[];for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&i.push(t);return i}),"function"!=typeof Object.create&&(Object.create=function(e,t){function i(){}if("object"!=typeof e)throw TypeError();i.prototype=e;var n=new i;if(e&&(n.constructor=i),void 0!==t){if(t!==Object(t))throw TypeError();Object.defineProperties(n,t)}return n}),function(){if(!Object.defineProperty||!function(){try{return Object.defineProperty({},"x",{}),!0}catch(e){return!1}}()){var e=Object.defineProperty;Object.defineProperty=function(t,i,n){if(e)try{return e(t,i,n)}catch(e){}if(t!==Object(t))throw TypeError("Object.defineProperty called on non-object");return Object.prototype.__defineGetter__&&"get"in n&&Object.prototype.__defineGetter__.call(t,i,n.get),Object.prototype.__defineSetter__&&"set"in n&&Object.prototype.__defineSetter__.call(t,i,n.set),"value"in n&&(t[i]=n.value),t}}}(),"function"!=typeof Object.defineProperties&&(Object.defineProperties=function(e,t){if(e!==Object(e))throw TypeError("Object.defineProperties called on non-object");var i;for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&Object.defineProperty(e,i,t[i]);return e}),Object.keys||(Object.keys=function(e){if(e!==Object(e))throw TypeError("Object.keys called on non-object");var t,i=[];for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&i.push(t);return i}),Function.prototype.bind||(Function.prototype.bind=function(e){if("function"!=typeof this)throw TypeError("Bind must be called on a function");var t=Array.prototype.slice.call(arguments,1),i=this,n=function(){},a=function(){return i.apply(this instanceof n?this:e,t.concat(Array.prototype.slice.call(arguments)))};return this.prototype&&(n.prototype=this.prototype),a.prototype=new n,a}),Array.isArray=Array.isArray||function(e){return Boolean(e&&"[object Array]"===Object.prototype.toString.call(Object(e)))},Array.prototype.indexOf||(Array.prototype.indexOf=function(e){if(void 0===this||null===this)throw TypeError();var t=Object(this),i=t.length>>>0;if(0===i)return-1;var n=0;if(arguments.length>0&&(n=Number(arguments[1]),isNaN(n)?n=0:0!==n&&n!==1/0&&n!==-1/0&&(n=(n>0||-1)*Math.floor(Math.abs(n)))),n>=i)return-1;for(var a=n>=0?n:Math.max(i-Math.abs(n),0);a<i;a++)if(a in t&&t[a]===e)return a;return-1}),Array.prototype.lastIndexOf||(Array.prototype.lastIndexOf=function(e){if(void 0===this||null===this)throw TypeError();var t=Object(this),i=t.length>>>0;if(0===i)return-1;var n=i;arguments.length>1&&((n=Number(arguments[1]))!==n?n=0:0!==n&&n!==1/0&&n!==-1/0&&(n=(n>0||-1)*Math.floor(Math.abs(n))));for(var a=n>=0?Math.min(n,i-1):i-Math.abs(n);a>=0;a--)if(a in t&&t[a]===e)return a;return-1}),Array.prototype.every||(Array.prototype.every=function(e){if(void 0===this||null===this)throw TypeError();var t=Object(this),i=t.length>>>0;if("function"!=typeof e)throw TypeError();var n,a=arguments[1];for(n=0;n<i;n++)if(n in t&&!e.call(a,t[n],n,t))return!1;return!0}),Array.prototype.some||(Array.prototype.some=function(e){if(void 0===this||null===this)throw TypeError();var t=Object(this),i=t.length>>>0;if("function"!=typeof e)throw TypeError();var n,a=arguments[1];for(n=0;n<i;n++)if(n in t&&e.call(a,t[n],n,t))return!0;return!1}),Array.prototype.forEach||(Array.prototype.forEach=function(e){if(void 0===this||null===this)throw TypeError();var t=Object(this),i=t.length>>>0;if("function"!=typeof e)throw TypeError();var n,a=arguments[1];for(n=0;n<i;n++)n in t&&e.call(a,t[n],n,t)}),Array.prototype.map||(Array.prototype.map=function(e){if(void 0===this||null===this)throw TypeError();var t=Object(this),i=t.length>>>0;if("function"!=typeof e)throw TypeError();var n=[];n.length=i;var a,r=arguments[1];for(a=0;a<i;a++)a in t&&(n[a]=e.call(r,t[a],a,t));return n}),Array.prototype.filter||(Array.prototype.filter=function(e){if(void 0===this||null===this)throw TypeError();var t=Object(this),i=t.length>>>0;if("function"!=typeof e)throw TypeError();var n,a=[],r=arguments[1];for(n=0;n<i;n++)if(n in t){var o=t[n];e.call(r,o,n,t)&&a.push(o)}return a}),Array.prototype.reduce||(Array.prototype.reduce=function(e){if(void 0===this||null===this)throw TypeError();var t=Object(this),i=t.length>>>0;if("function"!=typeof e)throw TypeError();if(0===i&&1===arguments.length)throw TypeError();var n,a=0;if(arguments.length>=2)n=arguments[1];else for(;;){if(a in t){n=t[a++];break}if(++a>=i)throw TypeError()}for(;a<i;)a in t&&(n=e.call(void 0,n,t[a],a,t)),a++;return n}),Array.prototype.reduceRight||(Array.prototype.reduceRight=function(e){if(void 0===this||null===this)throw TypeError();var t=Object(this),i=t.length>>>0;if("function"!=typeof e)throw TypeError();if(0===i&&1===arguments.length)throw TypeError();var n,a=i-1;if(arguments.length>=2)n=arguments[1];else for(;;){if(a in this){n=this[a--];break}if(--a<0)throw TypeError()}for(;a>=0;)a in t&&(n=e.call(void 0,n,t[a],a,t)),a--;return n}),String.prototype.trim||(String.prototype.trim=function(){return String(this).replace(/^\s+/,"").replace(/\s+$/,"")}),Date.now||(Date.now=function(){return Number(new Date)}),Date.prototype.toISOString||(Date.prototype.toISOString=function(){function e(e){return("00"+e).slice(-2)}return this.getUTCFullYear()+"-"+e(this.getUTCMonth()+1)+"-"+e(this.getUTCDate())+"T"+e(this.getUTCHours())+":"+e(this.getUTCMinutes())+":"+e(this.getUTCSeconds())+"."+function(e){return("000"+e).slice(-3)}(this.getUTCMilliseconds())+"Z"}),function(e){"use strict";function t(t){return t===e?D:t}function i(e,t){for(var i=Object.getOwnPropertyDescriptor(e,t),n=Object.getPrototypeOf(e);!i&&n;)i=Object.getOwnPropertyDescriptor(n,t),n=Object.getPrototypeOf(n);return i}function n(e,t,i,n){t in e&&!n&&!L||("function"==typeof i?Object.defineProperty(e,t,{value:i,configurable:!0,enumerable:!1,writable:!0}):Object.defineProperty(e,t,{value:i,configurable:!1,enumerable:!1,writable:!1}))}function a(e,t,i){Object.defineProperty(e,t,{value:i,configurable:!1,enumerable:!1,writable:!0})}function r(){function e(e){var i="function"==typeof e.valueOf&&e.valueOf(t);return i===e?null:i}var t=M(null);return{clear:function(){t=M(null)},remove:function(t){var i=e(t);return!(!i||!g(i,"value")||(delete i.value,0))},get:function(t,i){var n=e(t);return n&&g(n,"value")?n.value:i},has:function(t){var i=e(t);return Boolean(i&&g(i,"value"))},set:function(i,n){(e(i)||function(e){var i=e.valueOf,n=M(null);return Object.defineProperty(e,"valueOf",{value:function(t){return function(a){return a===t?n:i.apply(e,arguments)}}(t),configurable:!0,writeable:!0,enumerable:!1}),n}(i)).value=n}}}function o(t){switch(typeof t){case"undefined":return"undefined";case"boolean":return"boolean";case"number":return"number";case"string":return"string";case"symbol":return"symbol";default:return null===t?"null":t instanceof e.Symbol?"symbol":"object"}}function s(e){return e=Number(e),A(e)?0:0===e||e===1/0||e===-1/0?e:(e<0?-1:1)*z(U(e))}function h(e){return e>>>0}function l(e){if(null===e||e===D)throw TypeError();return Object(e)}function c(e){var t=s(e);return t<=0?0:t===1/0?9007199254740991:G(t,9007199254740991)}function p(e){return"function"==typeof e}function u(e){return!!/Constructor/.test(Object.prototype.toString.call(e))||!!/Function/.test(Object.prototype.toString.call(e))||"function"==typeof e}function d(e,t){if(typeof e!=typeof t)return!1;switch(typeof e){case"undefined":return!0;case"number":return e!=e&&t!=t||(0===e&&0===t?1/e==1/t:e===t);case"boolean":case"string":case"object":default:return e===t}}function _(e,t){if(typeof e!=typeof t)return!1;switch(typeof e){case"undefined":return!0;case"number":return e!=e&&t!=t||e===t;case"boolean":case"string":case"object":default:return e===t}}function m(e,t){var i=function(e,t){return l(e)[t]}(e,t);if(i===D||null===i)return D;if(!p(i))throw TypeError();return i}function f(e,t){for(;e;){if(Object.prototype.hasOwnProperty.call(e,t))return!0;if("object"!==o(e))return!1;var i=Object.getPrototypeOf(e);if(i===e)return!1;e=i}return!1}function g(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function y(e,t){arguments.length<2&&(t=m(e,te));var i=t.call(e);if("object"!==o(i))throw TypeError();return i}function v(e){return e.value}function x(e,t){var i=function(e,t){if(arguments.length<2)var i=e.next();else i=e.next(t);if("object"!==o(i))throw TypeError();return i}(e,t),n=i.done;return!0!==Boolean(n)&&i}function b(e,t){var i={};return i.value=e,i.done=t,i}function w(e,t,i){N(function(){t.apply(D,i)})}function S(e){}function I(e){return Object.getOwnPropertyNames(e)}function M(e,t){return Object.create(e,t)}function C(){}function k(){}function E(e,t){var i=l(e),n=new k;return a(n,"[[IteratedObject]]",i),a(n,"[[ArrayIteratorNextIndex]]",0),a(n,"[[ArrayIterationKind]]",t),n}var T,L=!1,D=void 0,N=function(e,t){return e?function(t){e.resolve().then(function(){t()})}:t?function(e){t(e)}:function(e){setTimeout(e,0)}}(e.Promise,e.setImmediate),A=e.isNaN,R=e.parseInt,B=e.parseFloat,P=Math.E,O=Math.LOG10E,V=Math.LOG2E,U=Math.abs,F=Math.ceil,H=Math.exp,z=Math.floor,X=Math.log,Y=Math.max,G=Math.min,j=Math.pow,W=Math.random,q=Math.sqrt,K=String.prototype.match,J=String.prototype.replace,Z=String.prototype.search,Q=String.prototype.split,$=Object.create(null);!function(){function i(e){if(!(this instanceof i))return new i(e,r);if(this instanceof i&&arguments[1]!==r)throw TypeError();var t=e===D?D:String(e);return a(this,"[[SymbolData]]",function(e){return Array(e+1).join("x").replace(/x/g,function(){return W()<.5?"‌":"‍"})}(128)),a(this,"[[Description]]",t),o[this]=this,this}var r=Object.create(null),o={};T=function(e){return o[e]};var s=[];"Symbol"in e&&!L||(e.Symbol=i),n(i,"for",function(e){for(var t=String(e),n=0;n<s.length;++n){var a=s[n];if(d(a["[[key]]"],t))return a["[[symbol]]"]}var r=i(e);return s.push({"[[key]]":t,"[[symbol]]":r}),r}),n(e.Symbol,"iterator",e.Symbol("Symbol.iterator")),n(i,"keyFor",function(e){if(!(e instanceof i))throw TypeError();for(var t=0;t<s.length;++t){var n=s[t];if(d(n["[[symbol]]"],e))return n["[[key]]"]}return D}),n(e.Symbol,"match",e.Symbol("Symbol.match")),n(e.Symbol,"replace",e.Symbol("Symbol.replace")),n(e.Symbol,"search",e.Symbol("Symbol.search")),n(e.Symbol,"split",e.Symbol("Symbol.split")),n(e.Symbol,"toStringTag",e.Symbol("Symbol.toStringTag")),Object.defineProperty(i.prototype,"toString",{value:function(){var e=t(this),i=e["[[Description]]"];return"Symbol("+(i===D?"":i)+e["[[SymbolData]]"]+")"},configurable:!0,writeable:!0,enumerable:!1}),Object.defineProperty(i.prototype,"valueOf",{value:function(){throw TypeError()},configurable:!0,writeable:!0,enumerable:!1})}();var ee={},te=e.Symbol.iterator,ie=e.Symbol.match,ne=e.Symbol.replace,ae=e.Symbol.search,re=e.Symbol.split,oe=e.Symbol.toStringTag;n(Object,"assign",function(e,t){var i=l(e);if(arguments.length<2)return i;for(var n=1;n<arguments.length;){var a=arguments[n++];if(a===D||null===a)var r=[];else{var o=l(a);r=I(o)}for(var s=0;s<r.length;++s){var h=r[s],c=Object.getOwnPropertyDescriptor(o,h);if(c!==D&&c.enumerable){var p=o[h];i[h]=p}}}return i}),function(){function t(e){return!T(e)}var i="symbol"==typeof e.Symbol(),a=Object.getOwnPropertyNames,r=Object.keys,o="object"==typeof window?a(window):[];n(Object,"getOwnPropertyNames",function(e){if("[object Window]"===Object.prototype.toString.call(e))try{return a(e).filter(t)}catch(e){return o.slice()}return a(e).filter(t)},!i),n(Object,"getOwnPropertySymbols",function(e){return a(e).filter(T).map(T)},!i),n(Object,"keys",function(e){return r(e).filter(t)},!i)}(),n(Object,"is",function(e,t){return d(e,t)}),n(Object,"setPrototypeOf",function(e,t){if("object"!==o(e))throw TypeError();if("object"!==o(t)&&"null"!==o(t))throw TypeError();return e.__proto__=t,e});var se=Object.prototype.toString;n(Object.prototype,"toString",function(){var e=t(this);return e===Object(e)&&oe in e?"[object "+e[oe]+"]":se.apply(e,arguments)}),n(e.Symbol.prototype,e.Symbol.toStringTag,"Symbol"),n(Number,"EPSILON",function(){var e,t;for(e=1;1+e!==1;e/=2)t=e;return t}()),n(Number,"isFinite",function(e){return"number"===o(e)&&e==e&&e!==1/0&&e!==-1/0}),n(Number,"isInteger",function(e){return"number"===o(e)&&e==e&&e!==1/0&&e!==-1/0&&s(e)===e}),n(Number,"isNaN",function(e){return"number"===o(e)&&e!=e}),n(Number,"isSafeInteger",function(e){if("number"!==o(e))return!1;if(e!=e||e===1/0||e===-1/0)return!1;var t=s(e);return t===e&&U(t)<=9007199254740991}),n(Number,"MAX_SAFE_INTEGER",9007199254740991),n(Number,"MIN_SAFE_INTEGER",-9007199254740991),n(Number,"parseFloat",B),n(Number,"parseInt",R),n(Math,oe,"Math"),n(Math,"acosh",function(e){return e=Number(e),X(e+q(e*e-1))}),n(Math,"asinh",function(e){if(e=Number(e),d(e,-0))return e;var t=q(e*e+1);return X(t===-e?0:e+t)}),n(Math,"atanh",function(e){return 0===(e=Number(e))?e:X((1+e)/(1-e))/2}),n(Math,"cbrt",function(e){if(e=Number(e),A(e/e))return e;var t=j(U(e),1/3),i=e/t/t;return t+t*(i-t)/(2*t+i)}),n(Math,"clz32",function(e){function t(e){return 240&e?128&e?0:64&e?1:32&e?2:3:8&e?4:4&e?5:2&e?6:1&e?7:8}return 4278190080&(e=h(e))?t(e>>24):16711680&e?t(e>>16)+8:65280&e?t(e>>8)+16:t(e)+24}),n(Math,"cosh",function(e){return e=Number(e),(j(P,e)+j(P,-e))/2}),n(Math,"expm1",function(e){return e=Number(e),d(e,-0)?-0:U(e)<1e-5?e+.5*e*e:H(e)-1}),n(Math,"fround",function(e){return A(e)?NaN:1/e==1/0||1/e==-1/0||e===1/0||e===-1/0?e:new Float32Array([e])[0]}),n(Math,"hypot",function(){for(var e=[],t=0,i=!1,n=0;n<arguments.length;++n){var a=U(Number(arguments[n]));if(a===1/0)return a;a!=a&&(i=!0),a>t&&(t=a),e[n]=a}if(i)return NaN;if(0===t)return 0;var r=0;for(n=0;n<e.length;++n){var o=e[n]/t;r+=o*o}return t*q(r)}),n(Math,"imul",function(e,t){var i=h(e),n=h(t),a=65535&i,r=65535&n;return a*r+((i>>>16&65535)*r+a*(n>>>16&65535)<<16>>>0)|0},"imul"in Math&&0===Math.imul(1,2147483648)),n(Math,"log1p",function(e){return(e=Number(e))<-1?NaN:d(e,-0)?-0:U(e)>1e-4?X(1+e):(-.5*e+1)*e}),n(Math,"log10",function(e){return e=Number(e),X(e)*O}),n(Math,"log2",function(e){return e=Number(e),X(e)*V}),n(Math,"sign",function(e){return(e=Number(e))<0?-1:e>0?1:e}),n(Math,"sinh",function(e){return e=Number(e),d(e,-0)?e:(j(P,e)-j(P,-e))/2}),n(Math,"tanh",function(e){e=Number(e);var t=j(P,2*e)-1,i=j(P,2*e)+1;return d(e,-0)?e:t===i?1:t/i}),n(Math,"trunc",function(e){return e=Number(e),A(e)?NaN:e<0?F(e):z(e)});var he=function(){var e={},t=Symbol();return e[Symbol.match]=function(){return t},"".match(e)===t}();n(String,"fromCodePoint",function(){for(var e=arguments,t=e.length,i=[],n=0;n<t;){var a=e[n],r=Number(a);if(!d(r,s(r))||r<0||r>1114111)throw RangeError("Invalid code point "+r);r<65536?i.push(String.fromCharCode(r)):(r-=65536,i.push(String.fromCharCode(55296+(r>>10))),i.push(String.fromCharCode(r%1024+56320))),n+=1}return i.join("")}),n(String,"raw",function(e){var t=[].slice.call(arguments,1),i=Object(e).raw,n=Object(i),a=c(n.length);if(a<=0)return"";for(var r=[],o=0;;){var s=n[o],h=String(s);if(r.push(h),o+1===a)return r.join("");s=t[o];var l=String(s);r.push(l),o+=1}}),n(String.prototype,"codePointAt",function(e){var i=t(this),n=String(i),a=s(e),r=n.length;if(a<0||a>=r)return D;var o=n.charCodeAt(a);if(o<55296||o>56319||a+1===r)return o;var h=n.charCodeAt(a+1);return h<56320||h>57343?o:1024*(o-55296)+(h-56320)+65536}),n(String.prototype,"endsWith",function(e){var i=arguments[1],n=t(this),a=String(n),r=String(e),o=a.length,h=i===D?o:s(i),l=G(Y(h,0),o),c=r.length,p=l-c;return!(p<0)&&a.substring(p,p+c)===r}),n(String.prototype,"includes",function(e){var i=arguments[1],n=t(this),a=String(n),r=String(e),o=s(i),h=a.length,l=G(Y(o,0),h);return-1!==a.indexOf(r,l)}),n(String.prototype,"match",function(e){var i=t(this),n=String(i);if(f(e,ie))var a=e;else a=new RegExp(e);return a[ie](n)},!he),n(String.prototype,"repeat",function(e){var i=t(this),n=String(i),a=s(e);if(a<0)throw RangeError();if(a===1/0)throw RangeError();return new Array(a+1).join(n)}),n(String.prototype,"replace",function(e,i){var n=t(this);return f(e,ne)?e[ne](n,i):J.call(n,e,i)},!he),n(String.prototype,"search",function(e){var i=t(this),n=String(i);if(f(e,ae))var a=e;else a=new RegExp(e);return a[ae](n)},!he),n(String.prototype,"split",function(e,i){var n=t(this);return f(e,re)?e[re](n,i):Q.call(n,e,i)},!he),n(String.prototype,"startsWith",function(e){var i=arguments[1],n=t(this),a=String(n),r=String(e),o=s(i),h=a.length,l=G(Y(o,0),h),c=r.length;return!(c+l>h)&&a.substring(l,l+c)===r}),n(String.prototype,te,function(){return function(e,t){var i=String(e),n=new C;return a(n,"[[IteratedString]]",i),a(n,"[[StringIteratorNextIndex]]",0),a(n,"[[StringIterationKind]]",t),n}(this,"value")});var le=Object.create(ee);C.prototype=le,n(le,"next",function(){var e=l(this),t=String(e["[[IteratedString]]"]),i=e["[[StringIteratorNextIndex]]"];if(i>=t.length)return a(e,"[[StringIteratorNextIndex]]",1/0),b(D,!0);var n=t.codePointAt(i);return a(e,"[[StringIteratorNextIndex]]",i+(n>65535?2:1)),b(String.fromCodePoint(n),!1)}),n(le,oe,"String Iterator"),"flags"in RegExp.prototype||Object.defineProperty(RegExp.prototype,"flags",{get:function(){var e=String(this);return e.substring(e.lastIndexOf("/")+1)}}),n(RegExp.prototype,ie,function(e){var i=t(this);return K.call(e,i)}),n(RegExp.prototype,ne,function(e,i){var n=t(this);return J.call(e,n,i)}),n(RegExp.prototype,ae,function(e){var i=t(this);return Z.call(e,i)}),n(RegExp.prototype,re,function(e,i){var n=t(this);return Q.call(e,n,i)}),n(Array,"from",function(e){var i=arguments[1],n=arguments[2],a=t(this);if(i===D)var r=!1;else{if(!p(i))throw TypeError();var o=n;r=!0}var s=m(e,te);if(s!==D){if(u(a))var h=new a;else h=new Array(0);for(var d=y(e,s),_=0;;){var f=x(d);if(!1===f)return h.length=_,h;var g=v(f);if(r)var b=i.call(o,g);else b=g;h[_]=b,_+=1}}var w=l(e),S=c(w.length);for(h=u(a)?new a(S):new Array(S),_=0;_<S;){var I=w[_];b=r?i.call(o,I,_):I,h[_]=b,_+=1}return h.length=S,h}),n(Array,"of",function(){var e,i=arguments,n=h(i.length),a=t(this);e=u(a)?l(e=new a(n)):new Array(n);for(var r=0;r<n;)e[r]=i[r],r+=1;return e.length=n,e}),n(Array.prototype,"copyWithin",function(e,t){var i=arguments[2],n=l(this),a=c(n.length);a=Y(a,0);var r,o=s(e);r=o<0?Y(a+o,0):G(o,a);var h,p=s(t);h=p<0?Y(a+p,0):G(p,a);var u,d;d=(u=i===D?a:s(i))<0?Y(a+u,0):G(u,a);var _,m=G(d-h,a-r);for(h<r&&r<h+m?(_=-1,h=h+m-1,r=r+m-1):_=1;m>0;){var g=String(h),y=String(r);if(f(n,g)){var v=n[g];n[y]=v}else delete n[y];h+=_,r+=_,m-=1}return n});var ce="entries"in Array.prototype&&"next"in[].entries();n(Array.prototype,"entries",function(){return E(this,"key+value")},!ce),n(Array.prototype,"fill",function(e){var t=arguments[1],i=arguments[2],n=l(this),a=c(n.length);a=Y(a,0);var r,o=s(t);r=o<0?Y(a+o,0):G(o,a);var h,p;for(p=(h=i===D?a:s(i))<0?Y(a+h,0):G(h,a);r<p;)n[String(r)]=e,r+=1;return n}),n(Array.prototype,"find",function(e){var t=l(this),i=s(t.length);if(!p(e))throw TypeError();for(var n=arguments.length>1?arguments[1]:D,a=0;a<i;){var r=String(a);if(f(t,r)){var o=t[r],h=e.call(n,o,a,t);if(Boolean(h))return o}++a}return D}),n(Array.prototype,"findIndex",function(e){var t=l(this),i=c(t.length);if(!p(e))throw TypeError();for(var n=arguments.length>1?arguments[1]:D,a=0;a<i;){var r=String(a);if(f(t,r)){var o=t[r],s=e.call(n,o,a,t);if(Boolean(s))return a}++a}return-1}),n(Array.prototype,"keys",function(){return E(this,"key")},!ce),n(Array.prototype,"values",function(){return E(this,"value")},!ce),n(Array.prototype,te,Array.prototype.values);var pe=Object.create(ee);k.prototype=pe,n(pe,"next",function(){var e=t(this);if("object"!==o(e))throw TypeError();var i,n,r=e["[[IteratedObject]]"],s=e["[[ArrayIteratorNextIndex]]"],l=e["[[ArrayIterationKind]]"],c=h(r.length);if(-1!==l.indexOf("sparse"))for(var p=!1;!p&&s<c;)(p=f(r,i=String(s)))||(s+=1);if(s>=c)return a(e,"[[ArrayIteratorNextIndex]]",1/0),b(D,!0);if(i=s,a(e,"[[ArrayIteratorNextIndex]]",s+1),-1!==l.indexOf("value")&&(n=r[i]),-1!==l.indexOf("key+value"))return b([i,n],!1);if(-1!==l.indexOf("key"))return b(i,!1);if("value"===l)return b(n,!1);throw Error("Internal error")}),n(pe,oe,"Array Iterator"),["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"].forEach(function(i){if(i in e){var a=e[i];n(a,"from",function(e){var i=arguments[1],n=arguments[2],a=t(this);if(!u(a))throw TypeError();if(i===D)var r=!1;else{if(p(i))throw TypeError();var o=n;r=!0}var s=m(e,te);if(s!==D){for(var h=y(e,s),d=[],_=!0;!1!==_;)if(!1!==(_=x(h))){var f=v(_);d.push(f)}for(var g=d.length,b=new a(g),w=0;w<g;){var S=d.shift();if(r)var I=i.call(o,S);else I=S;b[w]=I,++w}return b}var M=l(e);for(b=new a(g=c(M.length)),w=0;w<g;)S=M[w],I=r?i.call(o,S,w):S,b[w]=I,++w;return b}),n(a,"of",function(){for(var e=arguments,i=e.length,n=new(t(this))(i),a=0;a<i;)n[a]=e[a],++a;return n}),n(a.prototype,"copyWithin",Array.prototype.copyWithin),n(a.prototype,"entries",Array.prototype.entries),n(a.prototype,"every",Array.prototype.every),n(a.prototype,"fill",function(e){var t=arguments[1],i=arguments[2],n=l(this),a=c(n.length);a=Y(a,0);var r,o=s(t);r=o<0?Y(a+o,0):G(o,a);var h,p;for(p=(h=i===D?a:s(i))<0?Y(a+h,0):G(h,a);r<p;)n[String(r)]=e,r+=1;return n}),n(a.prototype,"filter",function(e){var t=arguments[1],i=l(this),n=c(i.length);if(!p(e))throw TypeError();for(var a=t,r=i.constructor,o=[],s=0,h=0;s<n;){var u=i[s];e.call(a,u,s,i)&&(o.push(u),++h),++s}for(var d=new r(h),_=0,m=0;m<o.length;++m){var f=o[m];d[_]=f,++_}return d}),n(a.prototype,"find",Array.prototype.find),n(a.prototype,"findIndex",Array.prototype.findIndex),n(a.prototype,"forEach",Array.prototype.forEach),n(a.prototype,"indexOf",Array.prototype.indexOf),n(a.prototype,"join",Array.prototype.join),n(a.prototype,"keys",Array.prototype.keys),n(a.prototype,"lastIndexOf",Array.prototype.lastIndexOf),n(a.prototype,"map",function(e){var t=arguments[1],i=l(this),n=c(i.length);if(!p(e))throw TypeError();var a=t,r=D,o=i.constructor;u(o)&&(r=new o(n)),r===D&&(r=new Array(n));for(var s=0;s<n;){if(f(i,s)){var h=i[s],d=e.call(a,h,s,i);r[s]=d}++s}return r}),n(a.prototype,"reduce",Array.prototype.reduce),n(a.prototype,"reduceRight",Array.prototype.reduceRight),n(a.prototype,"reverse",Array.prototype.reverse),n(a.prototype,"slice",function(e,t){var i=l(this),n=c(i.length),a=s(e),r=a<0?Y(n+a,0):G(a,n),o=t===D?n:s(t),h=o<0?Y(n+o,0):G(o,n),p=h-r,d=i.constructor;if(!u(d))throw TypeError();for(var _=new d(p),m=0;r<h;){var f=i[r];_[m]=f,++r,++m}return _}),n(a.prototype,"some",Array.prototype.some),n(a.prototype,"sort",function(){var e=arguments[0];return Array.prototype.sort.call(this,function(t,i){return t!=t&&i!=i?0:t!=t?1:i!=i?-1:e!==D?e(t,i):t<i?-1:t>i?1:0})}),n(a.prototype,"values",Array.prototype.values),n(a.prototype,te,a.prototype.values),n(a.prototype,oe,i)}}),function(){function i(){var e=t(this),i=arguments[0];if("object"!==o(e))throw TypeError();if("[[MapData]]"in e)throw TypeError();if(i!==D){var n=e.set;if(!p(n))throw TypeError();var r=y(l(i))}if(a(e,"[[MapData]]",{keys:[],values:[]}),r===D)return e;for(;;){var s=x(r);if(!1===s)return e;var h=v(s);if("object"!==o(h))throw TypeError();var c=h[0],u=h[1];n.call(e,c,u)}return e}function r(e,t){var i;if(t==t)return e.keys.indexOf(t);for(i=0;i<e.keys.length;i+=1)if(_(e.keys[i],t))return i;return-1}function s(){}function h(e,t){if("object"!==o(e))throw TypeError();if(!("[[MapData]]"in e))throw TypeError();if(e["[[MapData]]"]===D)throw TypeError();var i=new s;return a(i,"[[Map]]",e),a(i,"[[MapNextIndex]]",0),a(i,"[[MapIterationKind]]",t),i}"Map"in e&&!L&&!function(){try{return new e.Map([]),!1}catch(e){return!0}}()&&!function(){try{return!(new e.Map).entries().next}catch(e){return!0}}()&&1===new e.Map([["a",1]]).size||(e.Map=i);n(i.prototype={},"clear",function(){var e=t(this);if("object"!==o(e))throw TypeError();if(!("[[MapData]]"in e))throw TypeError();if(e["[[MapData]]"]===D)throw TypeError();var i=e["[[MapData]]"];return i.keys.length=0,i.values.length=0,D}),n(i.prototype,"delete",function(e){var i=t(this);if("object"!==o(i))throw TypeError();if(!("[[MapData]]"in i))throw TypeError();if(i["[[MapData]]"]===D)throw TypeError();var n=i["[[MapData]]"],a=r(n,e);return!(a<0||(n.keys[a]=$,n.values[a]=$,0))}),n(i.prototype,"entries",function(){var e=t(this);if("object"!==o(e))throw TypeError();return h(e,"key+value")}),n(i.prototype,"forEach",function(e){var i=arguments[1],n=t(this);if("object"!==o(n))throw TypeError();if(!("[[MapData]]"in n))throw TypeError();if(n["[[MapData]]"]===D)throw TypeError();var a=n["[[MapData]]"];if(!p(e))throw TypeError("First argument to forEach is not callable.");for(var r=0;r<a.keys.length;++r)a.keys[r]!==$&&e.call(i,a.values[r],a.keys[r],n);return D}),n(i.prototype,"get",function(e){var i=t(this);if("object"!==o(i))throw TypeError();if(!("[[MapData]]"in i))throw TypeError();if(i["[[MapData]]"]===D)throw TypeError();var n=i["[[MapData]]"],a=r(n,e);return a>=0?n.values[a]:D}),n(i.prototype,"has",function(e){var i=t(this);if("object"!==o(i))throw TypeError();if(!("[[MapData]]"in i))throw TypeError();if(i["[[MapData]]"]===D)throw TypeError();return r(i["[[MapData]]"],e)>=0}),n(i.prototype,"keys",function(){var e=t(this);if("object"!==o(e))throw TypeError();return h(e,"key")}),n(i.prototype,"set",function(e,i){var n=t(this);if("object"!==o(n))throw TypeError();if(!("[[MapData]]"in n))throw TypeError();if(n["[[MapData]]"]===D)throw TypeError();var a=n["[[MapData]]"],s=r(a,e);return s<0&&(s=a.keys.length),d(e,-0)&&(e=0),a.keys[s]=e,a.values[s]=i,n}),Object.defineProperty(i.prototype,"size",{get:function(){var e=t(this);if("object"!==o(e))throw TypeError();if(!("[[MapData]]"in e))throw TypeError();if(e["[[MapData]]"]===D)throw TypeError();for(var i=e["[[MapData]]"],n=0,a=0;a<i.keys.length;++a)i.keys[a]!==$&&(n+=1);return n}}),n(i.prototype,"values",function(){var e=t(this);if("object"!==o(e))throw TypeError();return h(e,"value")}),n(i.prototype,te,function(){var e=t(this);if("object"!==o(e))throw TypeError();return h(e,"key+value")}),n(e.Map.prototype,oe,"Map");var c=Object.create(ee);s.prototype=c,n(c,"next",function(){var e=t(this);if("object"!==o(e))throw TypeError();for(var i=e["[[Map]]"],n=e["[[MapNextIndex]]"],r=e["[[MapIterationKind]]"],s=i["[[MapData]]"];n<s.keys.length;){var h={key:s.keys[n],value:s.values[n]};if(n=n+=1,a(e,"[[MapNextIndex]]",n),h.key!==$)return"key"===r?b(h.key,!1):"value"===r?b(h.value,!1):b([h.key,h.value],!1)}return b(D,!0)}),n(c,oe,"Map Iterator")}(),function(){function i(){var e=t(this),i=arguments[0];if("object"!==o(e))throw TypeError();if("[[SetData]]"in e)throw TypeError();if(i!==D){var n=e.add;if(!p(n))throw TypeError();var r=y(l(i))}if(a(e,"[[SetData]]",[]),r===D)return e;for(;;){var s=x(r);if(!1===s)return e;var h=v(s);n.call(e,h)}return e}function r(e,t){var i;if(t==t)return e.indexOf(t);for(i=0;i<e.length;i+=1)if(_(e[i],t))return i;return-1}function s(){}function h(e,t){if("object"!==o(e))throw TypeError();if(!("[[SetData]]"in e))throw TypeError();if(e["[[SetData]]"]===D)throw TypeError();var i=new s;return a(i,"[[IteratedSet]]",e),a(i,"[[SetNextIndex]]",0),a(i,"[[SetIterationKind]]",t),i}"Set"in e&&!L&&!function(){try{return!(new e.Set).entries().next}catch(e){return!0}}()&&1===new e.Set([1]).size||(e.Set=i);n(i.prototype={},"add",function(e){var i=t(this);if("object"!==o(i))throw TypeError();if(!("[[SetData]]"in i))throw TypeError();if(i["[[SetData]]"]===D)throw TypeError();d(e,-0)&&(e=0);var n=r(i["[[SetData]]"],e);return n<0&&(n=i["[[SetData]]"].length),i["[[SetData]]"][n]=e,i}),n(i.prototype,"clear",function(){var e=t(this);if("object"!==o(e))throw TypeError();if(!("[[SetData]]"in e))throw TypeError();if(e["[[SetData]]"]===D)throw TypeError();return e["[[SetData]]"].length=0,D}),n(i.prototype,"delete",function(e){var i=t(this);if("object"!==o(i))throw TypeError();if(!("[[SetData]]"in i))throw TypeError();if(i["[[SetData]]"]===D)throw TypeError();var n=i["[[SetData]]"],a=r(n,e);return!(a<0||(n[a]=$,0))}),n(i.prototype,"entries",function(){var e=t(this);if("object"!==o(e))throw TypeError();return h(e,"key+value")}),n(i.prototype,"forEach",function(e){var i=arguments[1],n=t(this);if("object"!==o(n))throw TypeError();if(!("[[SetData]]"in n))throw TypeError();if(n["[[SetData]]"]===D)throw TypeError();var a=n["[[SetData]]"];if(!p(e))throw TypeError("First argument to forEach is not callable.");for(var r=0;r<a.length;++r)a[r]!==$&&e.call(i,a[r],a[r],n)}),n(i.prototype,"has",function(e){var i=t(this);if("object"!==o(i))throw TypeError();if(!("[[SetData]]"in i))throw TypeError();if(i["[[SetData]]"]===D)throw TypeError();return-1!==r(i["[[SetData]]"],e)}),Object.defineProperty(i.prototype,"size",{get:function(){var e=t(this);if("object"!==o(e))throw TypeError();if(!("[[SetData]]"in e))throw TypeError();if(e["[[SetData]]"]===D)throw TypeError();for(var i=e["[[SetData]]"],n=0,a=0;a<i.length;++a)i[a]!==$&&(n+=1);return n}}),n(i.prototype,"values",function(){var e=t(this);if("object"!==o(e))throw TypeError();return h(e,"value")}),i.prototype.keys=i.prototype.values,n(i.prototype,te,function(){var e=t(this);if("object"!==o(e))throw TypeError();return h(e)}),n(e.Set.prototype,oe,"Set");var c=Object.create(ee);s.prototype=c,n(c,"next",function(){var e=t(this);if("object"!==o(e))throw TypeError();for(var i=e["[[IteratedSet]]"],n=e["[[SetNextIndex]]"],r=e["[[SetIterationKind]]"],s=i["[[SetData]]"];n<s.length;){var h=s[n];if(n=n+=1,a(e,"[[SetNextIndex]]",n),h!==$)return"key+value"===r?b([h,h],!1):b(h,!1)}return b(D,!0)}),n(c,oe,"Set Iterator")}(),function(){function i(){var e=t(this),i=arguments[0];if("object"!==o(e))throw TypeError();if("[[WeakMapData]]"in e)throw TypeError();if(i!==D){var n=e.set;if(!p(n))throw TypeError();var s=y(l(i))}if(a(e,"[[WeakMapData]]",new r),s===D)return e;for(;;){var h=x(s);if(!1===h)return e;var c=v(h);if("object"!==o(c))throw TypeError();var u=c[0],d=c[1];n.call(e,u,d)}return e}"WeakMap"in e&&!L||(e.WeakMap=i);n(i.prototype={},"delete",function(e){var i=t(this);if("object"!==o(i))throw TypeError();if(i["[[WeakMapData]]"]===D)throw TypeError();if("object"!==o(e))throw TypeError("Expected object");return i["[[WeakMapData]]"].remove(e)}),n(i.prototype,"get",function(e,i){var n=t(this);if("object"!==o(n))throw TypeError();if(n["[[WeakMapData]]"]===D)throw TypeError();if("object"!==o(e))throw TypeError("Expected object");return n["[[WeakMapData]]"].get(e,i)}),n(i.prototype,"has",function(e){var i=t(this);if("object"!==o(i))throw TypeError();if(i["[[WeakMapData]]"]===D)throw TypeError();if("object"!==o(e))throw TypeError("Expected object");return i["[[WeakMapData]]"].has(e)}),n(i.prototype,"set",function(e,i){var n=t(this);if("object"!==o(n))throw TypeError();if(n["[[WeakMapData]]"]===D)throw TypeError();if("object"!==o(e))throw TypeError("Expected object");return n["[[WeakMapData]]"].set(e,i),n}),n(e.WeakMap.prototype,oe,"WeakMap"),function(){var t=new e.WeakMap,i=e.WeakMap.prototype.set;n(e.WeakMap.prototype,"set",function(){return i.apply(this,arguments),this},t.set({},0)!==t)}()}(),function(){function i(){var e=t(this),i=arguments[0];if("object"!==o(e))throw TypeError();if("[[WeakSetData]]"in e)throw TypeError();if(i!==D){var n=e.add;if(!p(n))throw TypeError();var s=y(l(i))}if(a(e,"[[WeakSetData]]",new r),s===D)return e;for(;;){var h=x(s);if(!1===h)return e;var c=v(h);n.call(e,c)}return e}"WeakSet"in e&&!L||(e.WeakSet=i);n(i.prototype={},"add",function(e){var i=t(this);if("object"!==o(i))throw TypeError();if(i["[[WeakSetData]]"]===D)throw TypeError();if("object"!==o(e))throw TypeError("Expected object");return i["[[WeakSetData]]"].set(e,!0),i}),n(i.prototype,"delete",function(e){var i=t(this);if("object"!==o(i))throw TypeError();if(i["[[WeakSetData]]"]===D)throw TypeError();if("object"!==o(e))throw TypeError("Expected object");return i["[[WeakSetData]]"].remove(e)}),n(i.prototype,"has",function(e){var i=t(this);if("object"!==o(i))throw TypeError();if(i["[[WeakSetData]]"]===D)throw TypeError();if("object"!==o(e))throw TypeError("Expected object");return i["[[WeakSetData]]"].has(e)}),n(e.WeakSet.prototype,oe,"WeakSet"),function(){var t=new e.WeakSet,i=e.WeakSet.prototype.add;n(e.WeakSet.prototype,"add",function(){return i.apply(this,arguments),this},t.add({})!==t)}()}(),"ArrayBuffer"in e&&(n(ArrayBuffer,"isView",function(e){return"object"===o(e)&&"buffer"in e&&e.buffer instanceof ArrayBuffer}),n(ArrayBuffer.prototype,oe,"ArrayBuffer")),"DataView"in e&&n(DataView.prototype,oe,"DataView"),n(JSON,oe,"JSON"),n(ee,te,function(){return this}),function(){function i(e){var t={"[[value]]":!1},i=function(){var e=function(t){var i=e["[[Promise]]"],n=e["[[AlreadyResolved]]"];if(n["[[value]]"])return D;if(a(n,"[[value]]",!0),d(t,i)){var s=TypeError();return l(i,s)}if("object"!==o(t))return r(i,t);try{var h=t.then}catch(h){return l(i,h)}return p(h)?(w(0,_,[i,t,h]),D):r(i,t)};return e}();a(i,"[[Promise]]",e),a(i,"[[AlreadyResolved]]",t);var n=function(){var e=function(t){var i=e["[[Promise]]"],n=e["[[AlreadyResolved]]"];return n["[[value]]"]?D:(a(n,"[[value]]",!0),l(i,t))};return e}();return a(n,"[[Promise]]",e),a(n,"[[AlreadyResolved]]",t),{"[[Resolve]]":i,"[[Reject]]":n}}function r(e,t){var i=e["[[PromiseFulfillReactions]]"];return a(e,"[[PromiseResult]]",t),a(e,"[[PromiseFulfillReactions]]",D),a(e,"[[PromiseRejectReactions]]",D),a(e,"[[PromiseState]]","fulfilled"),c(i,t)}function s(e){return function(e,t){var i={};a(i,"[[Promise]]",e),a(i,"[[Resolve]]",D),a(i,"[[Reject]]",D);var n=function(){var e=function(t,i){var n=e["[[Capability]]"];if(n["[[Resolve]]"]!==D)throw TypeError();if(n["[[Reject]]"]!==D)throw TypeError();return a(n,"[[Resolve]]",t),a(n,"[[Reject]]",i),D};return e}();a(n,"[[Capability]]",i);var r=e=new t(n);if(a(i,"[[Promise]]",e),!p(i["[[Resolve]]"]))throw TypeError();if(!p(i["[[Reject]]"]))throw TypeError();if("object"===o(r)&&!d(e,r))throw TypeError();return i}(D,e)}function h(e){return"object"===o(e)&&"[[PromiseState]]"in e&&e["[[PromiseState]]"]!==D}function l(e,t){var i=e["[[PromiseRejectReactions]]"];return a(e,"[[PromiseResult]]",t),a(e,"[[PromiseFulfillReactions]]",D),a(e,"[[PromiseRejectReactions]]",D),a(e,"[[PromiseState]]","rejected"),c(i,t)}function c(e,t){for(var i=0,n=e.length;i<n;++i)w(0,u,[e[i],t]);return D}function u(e,t){var i,n=e["[[Capabilities]]"],a=e["[[Handler]]"];try{if("Identity"===a)i=t;else{if("Thrower"===a)throw t;i=a.call(D,t)}}catch(i){return n["[[Reject]]"].call(D,i),void S()}S(n["[[Resolve]]"].call(D,i))}function _(e,t,n){var a=i(e);try{n.call(t,a["[[Resolve]]"],a["[[Reject]]"])}catch(e){return void S(a["[[Reject]]"].call(D,e))}S()}function m(e){var t={configurable:!1,enumerable:!1,writable:!0,value:D};Object.defineProperty(this,"[[PromiseState]]",t),Object.defineProperty(this,"[[PromiseConstructor]]",t),Object.defineProperty(this,"[[PromiseResult]]",t),Object.defineProperty(this,"[[PromiseFulfillReactions]]",t),Object.defineProperty(this,"[[PromiseRejectReactions]]",t);if("object"!==o(this))throw new TypeError;if(!("[[PromiseState]]"in this))throw TypeError();if(this["[[PromiseState]]"]!==D)throw TypeError();if(!p(e))throw TypeError();return a(this,"[[PromiseConstructor]]",m),function(e,t){a(e,"[[PromiseState]]","pending"),a(e,"[[PromiseFulfillReactions]]",[]),a(e,"[[PromiseRejectReactions]]",[]);var n=i(e);try{t.call(D,n["[[Resolve]]"],n["[[Reject]]"])}catch(e){n["[[Reject]]"].call(D,e)}return e}(this,e)}function f(){var e=function(t){var i=e["[[AlreadyCalled]]"];if(i.value)return D;i.value=!0;var n=e["[[Index]]"],a=e["[[Values]]"],r=e["[[Capabilities]]"],o=e["[[RemainingElements]]"];try{a[n]=t}catch(e){return r["[[Reject]]"].call(D,e),r["[[Promise]]"]}return o.value-=1,0===o.value?r["[[Resolve]]"].call(D,a):D};return e}n(m,"all",function(e){var i=t(this),n=s(i);try{var r=y(e)}catch(e){return n["[[Reject]]"].call(D,e),n["[[Promise]]"]}for(var o=[],h={value:1},l=0;;){try{var c=x(r)}catch(e){return n["[[Reject]]"].call(D,e),n["[[Promise]]"]}if(!c)return h.value-=1,0===h.value&&n["[[Resolve]]"].apply(D,o),n["[[Promise]]"];try{var p=v(c)}catch(e){return n["[[Reject]]"].call(D,e),n["[[Promise]]"]}try{var u=i.resolve(p)}catch(e){return n["[[Reject]]"].call(D,e),n["[[Promise]]"]}var d=f();a(d,"[[AlreadyCalled]]",{value:!1}),a(d,"[[Index]]",l),a(d,"[[Values]]",o),a(d,"[[Capabilities]]",n),a(d,"[[RemainingElements]]",h),h.value+=1;try{u.then(d,n["[[Reject]]"])}catch(e){return n["[[Reject]]"].call(D,e),n["[[Promise]]"]}l+=1}}),m.prototype={},n(m,"race",function(e){var i=t(this),n=s(i);try{var a=y(e)}catch(e){return n["[[Reject]]"].call(D,e),n["[[Promise]]"]}for(;;){try{var r=x(a)}catch(e){return n["[[Reject]]"].call(D,e),n["[[Promise]]"]}if(!r)return n["[[Promise]]"];try{var o=v(r)}catch(e){return n["[[Reject]]"].call(D,e),n["[[Promise]]"]}try{var h=i.resolve(o)}catch(e){return n["[[Reject]]"].call(D,e),n["[[Promise]]"]}try{h.then(n["[[Resolve]]"],n["[[Reject]]"])}catch(e){return n["[[Reject]]"].call(D,e),n["[[Promise]]"]}}}),n(m,"reject",function(e){var i=s(t(this));return i["[[Reject]]"].call(D,e),i["[[Promise]]"]}),n(m,"resolve",function(e){var i=t(this);if(h(e)&&d(e["[[PromiseConstructor]]"],i))return e;var n=s(i);return n["[[Resolve]]"].call(D,e),n["[[Promise]]"]}),n(m.prototype,"catch",function(e){return this.then(D,e)}),m.prototype.constructor=m,n(m.prototype,"then",function(e,t){if(!h(this))throw TypeError();p(e)||(e="Identity"),p(t)||(t="Thrower");var i=s(this.constructor),n={"[[Capabilities]]":i,"[[Handler]]":e},a={"[[Capabilities]]":i,"[[Handler]]":t};return"pending"===this["[[PromiseState]]"]?(this["[[PromiseFulfillReactions]]"].push(n),this["[[PromiseRejectReactions]]"].push(a)):"fulfilled"===this["[[PromiseState]]"]?w(0,u,[n,this["[[PromiseResult]]"]]):"rejected"===this["[[PromiseState]]"]&&w(0,u,[a,this["[[PromiseResult]]"]]),i["[[Promise]]"]}),"Promise"in e&&!L||(e.Promise=m),"cast"in e.Promise&&(e.Promise.resolve=e.Promise.cast)}(),n(Promise.prototype,oe,"Promise"),"Reflect"in e&&!L||(e.Reflect={}),n(Reflect,"apply",function(e,t,i){if(!p(e))throw TypeError();return Function.prototype.apply.call(e,t,i)}),n(Reflect,"construct",function(e,t){return __cons(e,t)}),n(Reflect,"defineProperty",function(e,t,i){try{return Object.defineProperty(e,t,i),!0}catch(e){return!1}}),n(Reflect,"deleteProperty",function(e,t){try{return delete e[t],!g(e,t)}catch(e){return!1}}),n(Reflect,"enumerate",function(e){return function(e){var t=[];if(Object(e)!==e)return t;for(var i=new Set;null!==e;)Object.getOwnPropertyNames(e).forEach(function(n){if(!i.has(n)){var a=Object.getOwnPropertyDescriptor(e,n);a&&(i.add(n),a.enumerable&&t.push(n))}}),e=Object.getPrototypeOf(e);return t[te]()}(e=l(e))}),n(Reflect,"get",function(e,t,n){e=l(e),t=String(t),n=n===D?e:l(n);var a=i(e,t);return a&&"get"in a?Function.prototype.call.call(a.get,n):e[t]}),n(Reflect,"getOwnPropertyDescriptor",Object.getOwnPropertyDescriptor),n(Reflect,"getPrototypeOf",Object.getPrototypeOf),n(Reflect,"has",function(e,t){return String(t)in l(e)}),n(Reflect,"isExtensible",Object.isExtensible),n(Reflect,"ownKeys",function(e){var t=l(e);return Object.getOwnPropertyNames(t)}),n(Reflect,"preventExtensions",function(e){try{return Object.preventExtensions(e),!0}catch(e){return!1}}),n(Reflect,"set",function(e,t,n,a){e=l(e),t=String(t),a=a===D?e:l(a);var r=i(e,t);try{return r&&"set"in r?Function.prototype.call.call(r.set,a,n):e[t]=n,!0}catch(e){return!1}}),n(Reflect,"setPrototypeOf",function(e,t){try{return e.__proto__=t,Reflect.getPrototypeOf(e)===t}catch(e){return!1}})}(self),function(e){"use strict";function t(e){return e=Number(e),a(e)?0:0===e||e===1/0||e===-1/0?e:(e<0?-1:1)*o(r(e))}function i(e,t){if(typeof e!=typeof t)return!1;switch(typeof e){case"undefined":return!0;case"number":return e!=e&&t!=t||e===t;case"boolean":case"string":case"object":default:return e===t}}var n=void 0,a=e.isNaN,r=Math.abs,o=Math.floor,s=(Math.max,Math.min);!function(e,t,i,n){"includes"in e&&!0||("function"==typeof i?Object.defineProperty(e,"includes",{value:i,configurable:!0,enumerable:!1,writable:!0}):Object.defineProperty(e,"includes",{value:i,configurable:!1,enumerable:!1,writable:!1}))}(Array.prototype,0,function(e){var a=arguments[1],r=function(e){if(null===e||e===n)throw TypeError();return Object(e)}(this),o=function(e){var i=t(e);return i<=0?0:s(i,9007199254740991)}(r.length);if(0===o)return!1;var h=t(a);if(h>=0)var l=h;else(l=o+h)<0&&(l=0);for(;l<o;){if(r[l],i(r[l],e))return!0;l+=1}return!1})}(this),function(e){"use strict";function t(e,t,i,n){t in e&&!n||("function"==typeof i?Object.defineProperty(e,t,{value:i,configurable:!0,enumerable:!1,writable:!0}):Object.defineProperty(e,t,{value:i,configurable:!1,enumerable:!1,writable:!1}))}function i(e){if(null===e||e===o)throw TypeError();return Object(e)}function n(e){var t=function(e){return e=Number(e),s(e)?0:0===e||e===1/0||e===-1/0?e:(e<0?-1:1)*l(h(e))}(e);return t<=0?0:c(t,9007199254740991)}function a(e,t,i){Object.defineProperty(e,t,{value:i,writable:!0,enumerable:!0,configurable:!0})}function r(e,t){var i=[];return Object.keys(e).forEach(function(n){var a=Object.getOwnPropertyDescriptor(e,n);if(a&&a.enumerable)if("key"===t)i.push(n);else{var r=e[n];"value"===t?i.push(r):i.push([n,r])}}),i}var o=void 0,s=e.isNaN,h=Math.abs,l=Math.floor,c=Math.min;t(Object,"entries",function(e){return r(i(e),"key+value")}),t(Object,"getOwnPropertyDescriptors",function(e){for(var t=i(e),n=Object.getOwnPropertyNames(t),r={},o=0;o<n.length;++o){var s=n[o];a(r,s,Object.getOwnPropertyDescriptor(t,s))}return r}),t(Object,"values",function(e){return r(i(e),"value")}),t(String.prototype,"padEnd",function(e){var t=arguments[1],i=String(this),a=i.length;if(t===o)var r="";else r=String(t);""===r&&(r=" ");var s=n(e);if(s<=a)return i;for(var h=s-a,l="";l.length<h;)l+=r;return i+l.substring(0,h)}),t(String.prototype,"padStart",function(e){var t=arguments[1],i=String(this),a=i.length;if(t===o)var r="";else r=String(t);""===r&&(r=" ");var s=n(e);if(s<=a)return i;for(var h=s-a,l="";l.length<h;)l+=r;return l.substring(0,h)+i})}(this),function(e){"use strict";"window"in e&&"document"in e&&("head"in document||(document.head=document.getElementsByTagName("head")[0]),["abbr","article","aside","audio","bdi","canvas","data","datalist","details","dialog","figcaption","figure","footer","header","hgroup","main","mark","meter","nav","output","picture","progress","section","summary","template","time","video"].forEach(function(e){document.createElement(e)}),!("dataset"in document.createElement("span"))&&"Element"in e&&Element.prototype&&Object.defineProperty&&Object.defineProperty(Element.prototype,"dataset",{get:function(){for(var e=Object.create(null),t=0;t<this.attributes.length;++t){var i=this.attributes[t];i.specified&&"data-"===i.name.substring(0,5)&&function(t,i){var n=i.replace(/-([a-z])/g,function(e,t){return t.toUpperCase()});e[n]=t.getAttribute("data-"+i),Object.defineProperty(e,n,{get:function(){return t.getAttribute("data-"+i)},set:function(e){t.setAttribute("data-"+i,e)}})}(this,i.name.substring(5))}return e}}),function(){if(!("atob"in e&&"btoa"in e)){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";e.atob=function(e){var i=0,n=[],a=0,r=0;if((e=(e=String(e)).replace(/\s/g,"")).length%4==0&&(e=e.replace(/=+$/,"")),e.length%4==1)throw Error("InvalidCharacterError");if(/[^+/0-9A-Za-z]/.test(e))throw Error("InvalidCharacterError");for(;i<e.length;)a=a<<6|t.indexOf(e.charAt(i)),24===(r+=6)&&(n.push(String.fromCharCode(a>>16&255)),n.push(String.fromCharCode(a>>8&255)),n.push(String.fromCharCode(255&a)),r=0,a=0),i+=1;return 12===r?(a>>=4,n.push(String.fromCharCode(255&a))):18===r&&(a>>=2,n.push(String.fromCharCode(a>>8&255)),n.push(String.fromCharCode(255&a))),n.join("")},e.btoa=function(e){e=String(e);var i,n,a,r,o,s,h,l=0,c=[];if(/[^\x00-\xFF]/.test(e))throw Error("InvalidCharacterError");for(;l<e.length;)r=(i=e.charCodeAt(l++))>>2,o=(3&i)<<4|(n=e.charCodeAt(l++))>>4,s=(15&n)<<2|(a=e.charCodeAt(l++))>>6,h=63&a,l===e.length+2?(s=64,h=64):l===e.length+1&&(h=64),c.push(t.charAt(r),t.charAt(o),t.charAt(s),t.charAt(h));return c.join("")}}}(),function(){function t(){var e=i;i=Object.create(null),a=-1,Object.keys(e).forEach(function(t){var i=e[t];i.element&&!function(e){return e.offsetWidth>0&&e.offsetHeight>0}(i.element)||i.callback(Date.now())})}if(!("requestAnimationFrame"in e)){var i=Object.create(null),n=0,a=-1;e.requestAnimationFrame=function(r,o){var s=++n;return i[s]={callback:r,element:o},-1===a&&(a=e.setTimeout(t,1e3/60)),s},e.cancelAnimationFrame=function(t){delete i[t],0===Object.keys(i).length&&(e.clearTimeout(a),a=-1)}}}())}(self),function(e){"use strict";function t(e,t){e&&Object.keys(t).forEach(function(i){if(!(i in e||i in e.prototype))try{Object.defineProperty(e.prototype,i,Object.getOwnPropertyDescriptor(t,i))}catch(n){e[i]=t[i]}})}function i(e){var t=null;return 1===(e=e.map(function(e){return e instanceof Node?e:document.createTextNode(e)})).length?t=e[0]:(t=document.createDocumentFragment(),e.forEach(function(e){t.appendChild(e)})),t}if("window"in e&&"document"in e){document.querySelectorAll||(document.querySelectorAll=function(e){var t,i=document.createElement("style"),n=[];for(document.documentElement.firstChild.appendChild(i),document._qsa=[],i.styleSheet.cssText=e+"{x-qsa:expression(document._qsa && document._qsa.push(this))}",window.scrollBy(0,0),i.parentNode.removeChild(i);document._qsa.length;)(t=document._qsa.shift()).style.removeAttribute("x-qsa"),n.push(t);return document._qsa=null,n}),document.querySelector||(document.querySelector=function(e){var t=document.querySelectorAll(e);return t.length?t[0]:null}),document.getElementsByClassName||(document.getElementsByClassName=function(e){return e=String(e).replace(/^|\s+/g,"."),document.querySelectorAll(e)}),e.Node=e.Node||function(){throw TypeError("Illegal constructor")},[["ELEMENT_NODE",1],["ATTRIBUTE_NODE",2],["TEXT_NODE",3],["CDATA_SECTION_NODE",4],["ENTITY_REFERENCE_NODE",5],["ENTITY_NODE",6],["PROCESSING_INSTRUCTION_NODE",7],["COMMENT_NODE",8],["DOCUMENT_NODE",9],["DOCUMENT_TYPE_NODE",10],["DOCUMENT_FRAGMENT_NODE",11],["NOTATION_NODE",12]].forEach(function(t){t[0]in e.Node||(e.Node[t[0]]=t[1])}),e.DOMException=e.DOMException||function(){throw TypeError("Illegal constructor")},[["INDEX_SIZE_ERR",1],["DOMSTRING_SIZE_ERR",2],["HIERARCHY_REQUEST_ERR",3],["WRONG_DOCUMENT_ERR",4],["INVALID_CHARACTER_ERR",5],["NO_DATA_ALLOWED_ERR",6],["NO_MODIFICATION_ALLOWED_ERR",7],["NOT_FOUND_ERR",8],["NOT_SUPPORTED_ERR",9],["INUSE_ATTRIBUTE_ERR",10],["INVALID_STATE_ERR",11],["SYNTAX_ERR",12],["INVALID_MODIFICATION_ERR",13],["NAMESPACE_ERR",14],["INVALID_ACCESS_ERR",15]].forEach(function(t){t[0]in e.DOMException||(e.DOMException[t[0]]=t[1])}),function(){function t(e,t,i){if("function"==typeof t){"DOMContentLoaded"===e&&(e="load");var n=this,a=function(e){e._timeStamp=Date.now(),e._currentTarget=n,t.call(this,e),e._currentTarget=null};this["_"+e+t]=a,this.attachEvent("on"+e,a)}}function i(e,t,i){if("function"==typeof t){"DOMContentLoaded"===e&&(e="load");var n=this["_"+e+t];n&&(this.detachEvent("on"+e,n),this["_"+e+t]=null)}}"Element"in e&&!Element.prototype.addEventListener&&Object.defineProperty&&(Event.CAPTURING_PHASE=1,Event.AT_TARGET=2,Event.BUBBLING_PHASE=3,Object.defineProperties(Event.prototype,{CAPTURING_PHASE:{get:function(){return 1}},AT_TARGET:{get:function(){return 2}},BUBBLING_PHASE:{get:function(){return 3}},target:{get:function(){return this.srcElement}},currentTarget:{get:function(){return this._currentTarget}},eventPhase:{get:function(){return this.srcElement===this.currentTarget?Event.AT_TARGET:Event.BUBBLING_PHASE}},bubbles:{get:function(){switch(this.type){case"click":case"dblclick":case"mousedown":case"mouseup":case"mouseover":case"mousemove":case"mouseout":case"mousewheel":case"keydown":case"keypress":case"keyup":case"resize":case"scroll":case"select":case"change":case"submit":case"reset":return!0}return!1}},cancelable:{get:function(){switch(this.type){case"click":case"dblclick":case"mousedown":case"mouseup":case"mouseover":case"mouseout":case"mousewheel":case"keydown":case"keypress":case"keyup":case"submit":return!0}return!1}},timeStamp:{get:function(){return this._timeStamp}},stopPropagation:{value:function(){this.cancelBubble=!0}},preventDefault:{value:function(){this.returnValue=!1}},defaultPrevented:{get:function(){return!1===this.returnValue}}}),[Window,HTMLDocument,Element].forEach(function(e){e.prototype.addEventListener=t,e.prototype.removeEventListener=i}))}(),function(){function t(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var i=document.createEvent("CustomEvent");return i.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),i}"CustomEvent"in e&&"function"==typeof e.CustomEvent||(t.prototype=e.Event.prototype,e.CustomEvent=t)}(),window.addEvent=function(e,t,i){e.addEventListener?e.addEventListener(t,i,!1):e.attachEvent&&(e["e"+t+i]=i,e[t+i]=function(){var n=window.event;n.currentTarget=e,n.preventDefault=function(){n.returnValue=!1},n.stopPropagation=function(){n.cancelBubble=!0},n.target=n.srcElement,n.timeStamp=Date.now(),e["e"+t+i].call(this,n)},e.attachEvent("on"+t,e[t+i]))},window.removeEvent=function(e,t,i){e.removeEventListener?e.removeEventListener(t,i,!1):e.detachEvent&&(e.detachEvent("on"+t,e[t+i]),e[t+i]=null,e["e"+t+i]=null)},function(){function t(e,t){function i(e){return e.length?e.split(/\s+/g):[]}function n(e,t){var n=i(t),a=n.indexOf(e);return-1!==a&&n.splice(a,1),n.join(" ")}if(Object.defineProperties(this,{length:{get:function(){return i(e[t]).length}},item:{value:function(n){var a=i(e[t]);return 0<=n&&n<a.length?a[n]:null}},contains:{value:function(n){if(0===(n=String(n)).length)throw SyntaxError();if(/\s/.test(n))throw Error("InvalidCharacterError");return-1!==i(e[t]).indexOf(n)}},add:{value:function(){var n=Array.prototype.slice.call(arguments).map(String);if(n.some(function(e){return 0===e.length}))throw SyntaxError();if(n.some(function(e){return/\s/.test(e)}))throw Error("InvalidCharacterError");try{var a=e[t],r=i(a);if(0===(n=n.filter(function(e){return-1===r.indexOf(e)})).length)return;0===a.length||/\s$/.test(a)||(a+=" "),a+=n.join(" "),e[t]=a}finally{var o=i(e[t]).length;this.length!==o&&(this.length=o)}}},remove:{value:function(){var a=Array.prototype.slice.call(arguments).map(String);if(a.some(function(e){return 0===e.length}))throw SyntaxError();if(a.some(function(e){return/\s/.test(e)}))throw Error("InvalidCharacterError");try{var r=e[t];a.forEach(function(e){r=n(e,r)}),e[t]=r}finally{var o=i(e[t]).length;this.length!==o&&(this.length=o)}}},toggle:{value:function(a){var r=arguments[1];try{if(0===(a=String(a)).length)throw SyntaxError();if(/\s/.test(a))throw Error("InvalidCharacterError");var o=i(e[t]).indexOf(a);if(-1!==o&&(!r||void 0===r))return e[t]=n(a,e[t]),!1;if(-1!==o&&r)return!0;var s=e[t];return 0===s.length||/\s$/.test(s)||(s+=" "),s+=a,e[t]=s,!0}finally{var h=i(e[t]).length;this.length!==h&&(this.length=h)}}},toString:{value:function(){return e[t]}}}),"length"in this)for(var a=0;a<100;++a)Object.defineProperty(this,String(a),{get:function(e){return function(){return this.item(e)}}(a)});else this.length=i(e[t]).length}function i(t,i){"Element"in e&&Element.prototype&&Object.defineProperty&&Object.defineProperty(Element.prototype,t,{get:i})}"classList"in document.createElement("span")?window.getClassList=function(e){return e.classList}:(window.getClassList=function(e){return new t(e,"className")},i("classList",function(){return new t(this,"className")})),"relList"in document.createElement("link")?window.getRelList=function(e){return e.relList}:(window.getRelList=function(e){return new t(e,"rel")},i("relList",function(){return new t(this,"rel")})),function(){if("DOMTokenList"in e){var t=document.createElement("span");"classList"in t&&(t.classList.toggle("x",!1),t.classList.contains("x")&&(e.DOMTokenList.prototype.toggle=function(e){var t=arguments[1];if(void 0===t){var i=!this.contains(e);return this[i?"add":"remove"](e),i}return t=!!t,this[t?"add":"remove"](e),t}))}}(),"previousElementSibling"in document.documentElement||i("previousElementSibling",function(){for(var e=this.previousSibling;e&&e.nodeType!==Node.ELEMENT_NODE;)e=e.previousSibling;return e}),"nextElementSibling"in document.documentElement||i("nextElementSibling",function(){for(var e=this.nextSibling;e&&e.nodeType!==Node.ELEMENT_NODE;)e=e.nextSibling;return e})}(),"Element"in e&&!Element.prototype.matches&&(Element.prototype.msMatchesSelector?Element.prototype.matches=Element.prototype.msMatchesSelector:Element.prototype.oMatchesSelector?Element.prototype.matches=Element.prototype.oMatchesSelector:Element.prototype.mozMatchesSelector?Element.prototype.matches=Element.prototype.mozMatchesSelector:Element.prototype.webkitMatchesSelector?Element.prototype.matches=Element.prototype.webkitMatchesSelector:document.querySelectorAll&&(Element.prototype.matches=function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),i=t.length;--i>=0&&t.item(i)!==this;);return i>-1})),window.Element&&!Element.prototype.closest&&(Element.prototype.closest=function(e){var t,i=(this.document||this.ownerDocument).querySelectorAll(e),n=this;do{for(t=i.length;--t>=0&&i.item(t)!==n;);}while(t<0&&(n=n.parentElement));return n});var n={prepend:function(){var e=[].slice.call(arguments);e=i(e),this.insertBefore(e,this.firstChild)},append:function(){var e=[].slice.call(arguments);e=i(e),this.appendChild(e)}};t(e.Document||e.HTMLDocument,n),t(e.DocumentFragment,n),t(e.Element,n);var a={before:function(){var e=[].slice.call(arguments),t=this.parentNode;if(t){for(var n=this.previousSibling;-1!==e.indexOf(n);)n=n.previousSibling;var a=i(e);t.insertBefore(a,n?n.nextSibling:t.firstChild)}},after:function(){var e=[].slice.call(arguments),t=this.parentNode;if(t){for(var n=this.nextSibling;-1!==e.indexOf(n);)n=n.nextSibling;var a=i(e);t.insertBefore(a,n)}},replaceWith:function(){var e=[].slice.call(arguments),t=this.parentNode;if(t){for(var n=this.nextSibling;-1!==e.indexOf(n);)n=n.nextSibling;var a=i(e);this.parentNode===t?t.replaceChild(a,this):t.insertBefore(a,n)}},remove:function(){this.parentNode&&this.parentNode.removeChild(this)}};t(e.DocumentType,a),t(e.Element,a),t(e.CharacterData,a)}}(self),function(e){"use strict";"window"in e&&"document"in e&&(e.XMLHttpRequest=e.XMLHttpRequest||function(){try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){}throw Error("This browser does not support XMLHttpRequest.")},[["UNSENT",0],["OPENED",1],["HEADERS_RECEIVED",2],["LOADING",3],["DONE",4]].forEach(function(t){t[0]in e.XMLHttpRequest||(e.XMLHttpRequest[t[0]]=t[1])}),function(){function t(e){if(this._data=[],e)for(var t=0;t<e.elements.length;++t){var i=e.elements[t];""!==i.name&&this.append(i.name,i.value)}}if(!("FormData"in e)){t.prototype={append:function(t,i){if("Blob"in e&&i instanceof e.Blob)throw TypeError("Blob not supported");t=String(t),this._data.push([t,i])},toString:function(){return this._data.map(function(e){return encodeURIComponent(e[0])+"="+encodeURIComponent(e[1])}).join("&")}},e.FormData=t;var i=e.XMLHttpRequest.prototype.send;e.XMLHttpRequest.prototype.send=function(e){return e instanceof t&&(this.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),arguments[0]=e.toString()),i.apply(this,arguments)}}}())}(self),function(e){"use strict";"window"in e&&"document"in e&&"TextRectangle"in e&&!("width"in e.TextRectangle.prototype)&&Object.defineProperties(e.TextRectangle.prototype,{width:{get:function(){return this.right-this.left}},height:{get:function(){return this.bottom-this.top}}})}(self),function(e){"use strict";function t(t){return!!t&&("Symbol"in e&&"iterator"in e.Symbol&&"function"==typeof t[Symbol.iterator]||!!Array.isArray(t))}function i(e){return"from"in Array?Array.from(e):Array.prototype.slice.call(e)}!function(){function n(e){var t="",i=!0;return e.forEach(function(e){var n=encodeURIComponent(e.name),a=encodeURIComponent(e.value);i||(t+="&"),t+=n+"="+a,i=!1}),t.replace(/%20/g,"+")}function a(e,t){var i=e.split("&");t&&-1===i[0].indexOf("=")&&(i[0]="="+i[0]);var n=[];i.forEach(function(e){if(0!==e.length){var t=e.indexOf("=");if(-1!==t)var i=e.substring(0,t),a=e.substring(t+1);else i=e,a="";i=i.replace(/\+/g," "),a=a.replace(/\+/g," "),n.push({name:i,value:a})}});var a=[];return n.forEach(function(e){a.push({name:decodeURIComponent(e.name),value:decodeURIComponent(e.value)})}),a}function r(e){var o=this;this._list=[],void 0===e||null===e||(e instanceof r?this._list=a(String(e)):"object"==typeof e&&t(e)?i(e).forEach(function(e){if(!t(e))throw TypeError();var n=i(e);if(2!==n.length)throw TypeError();o._list.push({name:String(n[0]),value:String(n[1])})}):"object"==typeof e&&e?Object.keys(e).forEach(function(t){o._list.push({name:String(t),value:String(e[t])})}):("?"===(e=String(e)).substring(0,1)&&(e=e.substring(1)),this._list=a(e))),this._url_object=null,this._setList=function(e){s||(o._list=e)};var s=!1;this._update_steps=function(){s||(s=!0,o._url_object&&("about:"===o._url_object.protocol&&-1!==o._url_object.pathname.indexOf("?")&&(o._url_object.pathname=o._url_object.pathname.split("?")[0]),o._url_object.search=n(o._list),s=!1))}}function o(e,t){var i=0;this.next=function(){if(i>=e.length)return{done:!0,value:void 0};var n=e[i++];return{done:!1,value:"key"===t?n.name:"value"===t?n.value:[n.name,n.value]}}}function s(t,i){function n(){var e=s.href.replace(/#$|\?$|\?(?=#)/g,"");s.href!==e&&(s.href=e)}function o(){p._setList(s.search?a(s.search.substring(1)):[]),p._update_steps()}if(!(this instanceof e.URL))throw new TypeError("Failed to construct 'URL': Please use the 'new' operator.");i&&(t=function(){if(h)return new l(t,i).href;var e;try{var n;if("[object OperaMini]"===Object.prototype.toString.call(window.operamini)?((e=document.createElement("iframe")).style.display="none",document.documentElement.appendChild(e),n=e.contentWindow.document):document.implementation&&document.implementation.createHTMLDocument?n=document.implementation.createHTMLDocument(""):document.implementation&&document.implementation.createDocument?((n=document.implementation.createDocument("http://www.w3.org/1999/xhtml","html",null)).documentElement.appendChild(n.createElement("head")),n.documentElement.appendChild(n.createElement("body"))):window.ActiveXObject&&((n=new window.ActiveXObject("htmlfile")).write("<head></head><body></body>"),n.close()),!n)throw Error("base not supported");var a=n.createElement("base");a.href=i,n.getElementsByTagName("head")[0].appendChild(a);var r=n.createElement("a");return r.href=t,r.href}finally{e&&e.parentNode.removeChild(e)}}());var s=function(e){if(h)return new l(e);var t=document.createElement("a");return t.href=e,t}(t||""),c=function(){if(!("defineProperties"in Object))return!1;try{var e={};return Object.defineProperties(e,{prop:{get:function(){return!0}}}),e.prop}catch(e){return!1}}()?this:document.createElement("a"),p=new r(s.search?s.search.substring(1):null);return p._url_object=c,Object.defineProperties(c,{href:{get:function(){return s.href},set:function(e){s.href=e,n(),o()},enumerable:!0,configurable:!0},origin:{get:function(){return"origin"in s?s.origin:this.protocol+"//"+this.host},enumerable:!0,configurable:!0},protocol:{get:function(){return s.protocol},set:function(e){s.protocol=e},enumerable:!0,configurable:!0},username:{get:function(){return s.username},set:function(e){s.username=e},enumerable:!0,configurable:!0},password:{get:function(){return s.password},set:function(e){s.password=e},enumerable:!0,configurable:!0},host:{get:function(){var e={"http:":/:80$/,"https:":/:443$/,"ftp:":/:21$/}[s.protocol];return e?s.host.replace(e,""):s.host},set:function(e){s.host=e},enumerable:!0,configurable:!0},hostname:{get:function(){return s.hostname},set:function(e){s.hostname=e},enumerable:!0,configurable:!0},port:{get:function(){return s.port},set:function(e){s.port=e},enumerable:!0,configurable:!0},pathname:{get:function(){return"/"!==s.pathname.charAt(0)?"/"+s.pathname:s.pathname},set:function(e){s.pathname=e},enumerable:!0,configurable:!0},search:{get:function(){return s.search},set:function(e){s.search!==e&&(s.search=e,n(),o())},enumerable:!0,configurable:!0},searchParams:{get:function(){return p},enumerable:!0,configurable:!0},hash:{get:function(){return s.hash},set:function(e){s.hash=e,n()},enumerable:!0,configurable:!0},toString:{value:function(){return s.toString()},enumerable:!1,configurable:!0},valueOf:{value:function(){return s.valueOf()},enumerable:!1,configurable:!0}}),c}var h,l=e.URL;try{if(l){if("searchParams"in(h=new e.URL("http://example.com")))return;"href"in h||(h=void 0)}}catch(e){}if(Object.defineProperties(r.prototype,{append:{value:function(e,t){this._list.push({name:e,value:t}),this._update_steps()},writable:!0,enumerable:!0,configurable:!0},delete:{value:function(e){for(var t=0;t<this._list.length;)this._list[t].name===e?this._list.splice(t,1):++t;this._update_steps()},writable:!0,enumerable:!0,configurable:!0},get:{value:function(e){for(var t=0;t<this._list.length;++t)if(this._list[t].name===e)return this._list[t].value;return null},writable:!0,enumerable:!0,configurable:!0},getAll:{value:function(e){for(var t=[],i=0;i<this._list.length;++i)this._list[i].name===e&&t.push(this._list[i].value);return t},writable:!0,enumerable:!0,configurable:!0},has:{value:function(e){for(var t=0;t<this._list.length;++t)if(this._list[t].name===e)return!0;return!1},writable:!0,enumerable:!0,configurable:!0},set:{value:function(e,t){for(var i=!1,n=0;n<this._list.length;)this._list[n].name===e?i?this._list.splice(n,1):(this._list[n].value=t,i=!0,++n):++n;i||this._list.push({name:e,value:t}),this._update_steps()},writable:!0,enumerable:!0,configurable:!0},entries:{value:function(){return new o(this._list,"key+value")},writable:!0,enumerable:!0,configurable:!0},keys:{value:function(){return new o(this._list,"key")},writable:!0,enumerable:!0,configurable:!0},values:{value:function(){return new o(this._list,"value")},writable:!0,enumerable:!0,configurable:!0},forEach:{value:function(e){var t=arguments.length>1?arguments[1]:void 0;this._list.forEach(function(i,n){e.call(t,i.value,i.name)})},writable:!0,enumerable:!0,configurable:!0},toString:{value:function(){return n(this._list)},writable:!0,enumerable:!1,configurable:!0}}),"Symbol"in e&&"iterator"in e.Symbol&&(Object.defineProperty(r.prototype,e.Symbol.iterator,{value:r.prototype.entries,writable:!0,enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,e.Symbol.iterator,{value:function(){return this},writable:!0,enumerable:!0,configurable:!0})),l)for(var c in l)l.hasOwnProperty(c)&&"function"==typeof l[c]&&(s[c]=l[c]);e.URL=s,e.URLSearchParams=r}(),function(){if("1"!==new e.URLSearchParams([["a",1]]).get("a")||"1"!==new e.URLSearchParams({a:1}).get("a")){var n=e.URLSearchParams;e.URLSearchParams=function(e){if(e&&"object"==typeof e&&t(e)){var a=new n;return i(e).forEach(function(e){if(!t(e))throw TypeError();var n=i(e);if(2!==n.length)throw TypeError();a.append(n[0],n[1])}),a}return e&&"object"==typeof e?(a=new n,Object.keys(e).forEach(function(t){a.set(t,e[t])}),a):new n(e)}}}()}(self),function(e){"use strict";function t(e){if((e=String(e)).match(/[^\x00-\xFF]/))throw TypeError("Not a valid ByteString");return e}function i(e){return(e=String(e)).replace(/([\u0000-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDFFF])/g,function(e){return/^[\uD800-\uDFFF]$/.test(e)?"�":e})}function n(e){return String(e).replace(/[a-z]/g,function(e){return e.toUpperCase()})}function a(e){return/^[!#$%&'*+\-.09A-Z^_`a-z|~]+$/.test(e)}function r(e){return{"accept-charset":!0,"accept-encoding":!0,"access-control-request-headers":!0,"access-control-request-method":!0,connection:!0,"content-length":!0,cookie:!0,cookie2:!0,date:!0,dnt:!0,expect:!0,host:!0,"keep-alive":!0,origin:!0,referer:!0,te:!0,trailer:!0,"transfer-encoding":!0,upgrade:!0,"user-agent":!0,via:!0}[e=String(e).toLowerCase()]||"proxy-"===e.substring(0,6)||"sec-"===e.substring(0,4)}function o(e){return{"set-cookie":!0,"set-cookie2":!0}[e=String(e).toLowerCase()]}function s(e,t){return"accept"===(e=String(e).toLowerCase())||"accept-language"===e||"content-language"===e||"content-type"===e&&-1!==["application/x-www-form-encoded","multipart/form-data","text/plain"].indexOf(t)}function h(e){this._guard="none",this._headerList=[],e&&l(this,e)}function l(e,t){t instanceof h?t._headerList.forEach(function(t){e.append(t[0],t[1])}):Array.isArray(t)?t.forEach(function(t){if(!Array.isArray(t)||2!==t.length)throw TypeError();e.append(t[0],t[1])}):(t=Object(t),Object.keys(t).forEach(function(i){e.append(i,t[i])}))}function c(e){this._headers=e,this._index=0}function p(e){this._stream=e,this.bodyUsed=!1}function u(e,a){if(arguments.length<1)throw TypeError("Not enough arguments");if(p.call(this,null),this.method="GET",this.url="",this.headers=new h,this.headers._guard="request",this.referrer=null,this.mode=null,this.credentials="omit",e instanceof u){if(e.bodyUsed)throw TypeError();e.bodyUsed=!0,this.method=e.method,this.url=e.url,this.headers=new h(e.headers),this.headers._guard=e.headers._guard,this.credentials=e.credentials,this._stream=e._stream}else e=i(e),this.url=String(new URL(e,self.location));if("method"in(a=Object(a))){var r=t(a.method);if(function(e){return"CONNECT"===(e=n(e))||"TRACE"===e||"TRACK"===e}(r))throw TypeError();this.method=function(e){var t=n(e);return"DELETE"===t||"GET"===t||"HEAD"===t||"OPTIONS"===t||"POST"===t||"PUT"===t?t:e}(r)}"headers"in a&&(this.headers=new h,l(this.headers,a.headers)),"body"in a&&(this._stream=a.body),"credentials"in a&&-1!==["omit","same-origin","include"].indexOf(a.credentials)&&(this.credentials=a.credentials)}function d(e,t){if(arguments.length<1&&(e=""),this.headers=new h,this.headers._guard="response",e instanceof XMLHttpRequest&&"_url"in e){var n=e;return this.type="basic",this.url=i(n._url),this.status=n.status,this.ok=200<=this.status&&this.status<=299,this.statusText=n.statusText,n.getAllResponseHeaders().split(/\r?\n/).filter(function(e){return e.length}).forEach(function(e){var t=e.indexOf(":");this.headers.append(e.substring(0,t),e.substring(t+2))},this),void p.call(this,n.responseText)}p.call(this,e),t=Object(t)||{},this.url="";var a="status"in t?function(e){return 65535&e}(t.status):200;if(a<200||a>599)throw RangeError();this.status=a,this.ok=200<=this.status&&this.status<=299;var r="statusText"in t?String(t.statusText):"OK";if(/[^\x00-\xFF]/.test(r))throw TypeError();this.statusText=r,"headers"in t&&l(this.headers,t),this.type="basic"}(h.prototype={append:function(e,i){if(e=t(e),!a(e))throw TypeError();if("immutable"===this._guard)throw TypeError();"request"===this._guard&&r(e)||("request-no-CORS"!==this._guard||s(e,i))&&("response"===this._guard&&o(e)||(e=e.toLowerCase(),this._headerList.push([e,i])))},delete:function(e){if(e=t(e),!a(e))throw TypeError();if("immutable"===this._guard)throw TypeError();if(("request"!==this._guard||!r(e))&&("request-no-CORS"!==this._guard||s(e,"invalid"))&&("response"!==this._guard||!o(e))){e=e.toLowerCase();for(var i=0;i<this._headerList.length;)this._headerList[i][0]===e?this._headerList.splice(i,1):++i}},get:function(e){if(e=t(e),!a(e))throw TypeError();e=e.toLowerCase();for(var i=0;i<this._headerList.length;++i)if(this._headerList[i][0]===e)return this._headerList[i][1];return null},getAll:function(e){if(e=t(e),!a(e))throw TypeError();e=e.toLowerCase();for(var i=[],n=0;n<this._headerList.length;++n)this._headerList[n][0]===e&&i.push(this._headerList[n][1]);return i},has:function(e){if(e=t(e),!a(e))throw TypeError();e=e.toLowerCase();for(var i=0;i<this._headerList.length;++i)if(this._headerList[i][0]===e)return!0;return!1},set:function(e,i){if(e=t(e),!a(e))throw TypeError();if("immutable"===this._guard)throw TypeError();if(("request"!==this._guard||!r(e))&&("request-no-CORS"!==this._guard||s(e,i))&&("response"!==this._guard||!o(e))){e=e.toLowerCase();for(var n=0;n<this._headerList.length;++n)if(this._headerList[n][0]===e){for(this._headerList[n++][1]=i;n<this._headerList.length;)this._headerList[n][0]===e?this._headerList.splice(n,1):++n;return}this._headerList.push([e,i])}}})[Symbol.iterator]=function(){return new c(this)},(c.prototype={}).next=function(){return this._index>=this._headers._headerList.length?{value:void 0,done:!0}:{value:this._headers._headerList[this._index++],done:!1}},c.prototype[Symbol.iterator]=function(){return this},u.prototype=p.prototype={arrayBuffer:function(){if(this.bodyUsed)return Promise.reject(TypeError());if(this.bodyUsed=!0,this._stream instanceof ArrayBuffer)return Promise.resolve(this._stream);var e=this._stream;return new Promise(function(t,i){var n=unescape(encodeURIComponent(e)).split("").map(function(e){return e.charCodeAt(0)});t(new Uint8Array(n).buffer)})},blob:function(){return this.bodyUsed?Promise.reject(TypeError()):(this.bodyUsed=!0,this._stream instanceof Blob?Promise.resolve(this._stream):Promise.resolve(new Blob([this._stream])))},formData:function(){return this.bodyUsed?Promise.reject(TypeError()):(this.bodyUsed=!0,this._stream instanceof FormData?Promise.resolve(this._stream):Promise.reject(Error("Not yet implemented")))},json:function(){if(this.bodyUsed)return Promise.reject(TypeError());this.bodyUsed=!0;var e=this;return new Promise(function(t,i){t(JSON.parse(e._stream))})},text:function(){return this.bodyUsed?Promise.reject(TypeError()):(this.bodyUsed=!0,Promise.resolve(String(this._stream)))}},d.prototype=p.prototype,d.redirect=function(){throw Error("Not supported")},"fetch"in e||(e.Headers=h,e.Request=u,e.Response=d,e.fetch=function(e,t){return new Promise(function(i,n){var a=new u(e,t),r=new XMLHttpRequest;r._url=a.url;try{r.open(a.method,a.url,!0)}catch(e){throw TypeError(e.message)}for(var o=a.headers[Symbol.iterator](),s=o.next();!s.done;s=o.next())r.setRequestHeader(s.value[0],s.value[1]);"include"===a.credentials&&(r.withCredentials=!0),r.onreadystatechange=function(){r.readyState===XMLHttpRequest.DONE&&(0===r.status?n(new TypeError("Network error")):i(new d(r)))},r.send(a._stream)})})}(self);var uiscript;!function(e){var t=function(){function e(e){this.change_id=0,this.skin_path="",this.loaded=!1,this.me=e,this.img=e}return Object.defineProperty(e.prototype,"id",{set:function(e){var t=this,i=cfg.item_definition.title.get(e),n="";if((n=i?i.icon:"extendRes/title/notitle.png")!=this.skin_path){this.skin_path=n,this.change_id++;var a=this.change_id,r=game.LoadMgr.getResImageSkin(n);""==r?(this.img.skin="",this.loaded=!1,game.LoadMgr.loadResImage([this.skin_path],Laya.Handler.create(this,function(){a==t.change_id&&(t.loaded=!0,t.img.skin=game.LoadMgr.getResImageSkin(t.skin_path))}))):(this.loaded=!0,this.img.skin=r)}},enumerable:!0,configurable:!0}),e.prototype.clear=function(){this.change_id++,this.loaded&&""!=this.skin_path&&(Laya.loader.clearTextureRes(this.skin_path),this.loaded=!1,this.skin_path="")},e}();e.UI_PlayerTitle=t}(uiscript||(uiscript={}));var uiscript;!function(e){var t=function(){function t(e,t){this._cell=null,this.id=t,this.loaded=!1,this.note=e}return t.prototype.bind=function(t,i){var n=this;i.cell||(i.cell={head:new e.UI_Head(t.getChildByName("head")),btn_check_info:t.getChildByName("btn_checkinfo"),date:t.getChildByName("date"),time:t.getChildByName("time"),btn_del:t.getChildByName("btn_del"),emo:new e.UI_Character_Emo(t.getChildByName("emo")),words:t.getChildByName("word"),name:t.getChildByName("name"),level:t.getChildByName("level"),noteitem:null}),i.cell.btn_check_info&&(i.cell.btn_check_info.clickHandler=Laya.Handler.create(this,function(){e.UI_OtherPlayerInfo.Inst.show(n.commenter.account_id)},null,!1)),i.cell.btn_del&&(i.cell.btn_del.clickHandler=Laya.Handler.create(this,function(){game.Tools.setGrayDisable(i.cell.btn_del,!0),e.UI_SecondConfirm.Inst.show(cfg.str.str.get(19).desc,Laya.Handler.create(n,function(){n.note.delItem(i.cell.noteitem.id)}),Laya.Handler.create(n,function(){game.Tools.setGrayDisable(i.cell.btn_del,!1)}))},null,!1)),this._cell!==i.cell&&(i.cell.noteitem&&i.cell.noteitem.disbind(),this._cell&&(this._cell.noteitem=null),this._cell=i.cell,this._cell.noteitem=this),this.render()},t.prototype.disbind=function(){this._cell=null},t.prototype.setInfo=function(e){this.timestamp=e.timestamp,this.commenter=e.commenter,this.content=e.content,this.loaded=!0,this.render()},t.prototype.render=function(){if(this._cell){if(this.loaded){this._cell.head.id=this.commenter.avatar_id,this._cell.date.text=game.Tools.time2YearMounthDate(this.timestamp),this._cell.time.text=game.Tools.time2HourMinute(this.timestamp);var e=JSON.parse(this.content);this._cell.emo.me.visible=!1,this._cell.words.visible=!1,"emo"==e.type?(this._cell.emo.me.visible=!0,this._cell.emo.setSkin(e.chara,e.index)):(this._cell.words.visible=!0,this._cell.words.text=game.Tools.strWithoutForbidden(e.text)),this._cell.name.text=this.commenter.nickname,this._cell.level.text="";var t=cfg.level_definition.level_definition.get(this.commenter.level.id);t&&(this._cell.level.text=t.full_name),this.note.target_id==GameMgr.Inst.account_id||this.commenter.account_id==GameMgr.Inst.account_id?this._cell.btn_del.visible=!0:this._cell.btn_del.visible=!1}else this._cell.head.id=400101,this._cell.date.text="",this._cell.time.text="",this._cell.emo.me.visible=!1,this._cell.words.visible=!1,this._cell.btn_del.visible=!1,this._cell.name.text="",this._cell.level.text="";this._cell.btn_del&&game.Tools.setGrayDisable(this._cell.btn_del,!1)}},t}(),i=function(){function t(t,i,n,r){var o=this;this.target_id=-1,this.comment_allow=-1,this.container_input=i,this.noinfo=n,this.blockemj=new a(r,Laya.Handler.create(this,function(i){app.NetAgent.sendReq2Lobby("Lobby","leaveComment",{target_id:o.target_id,content:JSON.stringify({type:"emo",chara:i.chara,index:i.index})},function(i,n){i||n.error?(e.UIMgr.Inst.showNetReqError("leaveComment",i,n),n&&n.error&&(2004==n.error.code?o.show(o.target_id,1):2005==n.error.code&&o.show(o.target_id,2))):t.refresh()})},null,!1)),this.img_input=this.container_input.getChildByName("input"),this.txt_input=this.img_input.getChildByName("txtinput"),this.container_input.getChildByName("emj").clickHandler=Laya.Handler.create(this,function(){o.blockemj.show()},null,!1);var s=0;this.btn_send=this.container_input.getChildByName("btn_send"),this.btn_send.clickHandler=Laya.Handler.create(this,function(){var i=o.txt_input.text;i&&""!=i&&(s>Laya.timer.currTimer||(s=Laya.timer.currTimer+3e3,game.Tools.setGrayDisable(o.btn_send,!0),i=game.Tools.strWithoutForbidden(i),app.NetAgent.sendReq2Lobby("Lobby","leaveComment",{target_id:o.target_id,content:JSON.stringify({type:"word",text:i})},function(i,n){s=0,game.Tools.setGrayDisable(o.btn_send,!1),i||n.error?(e.UIMgr.Inst.showNetReqError("leaveComment",i,n),n&&n.error&&(2004==n.error.code?o.show(o.target_id,1):2005==n.error.code&&o.show(o.target_id,2))):(o.txt_input.text="",t.refresh())})))},null,!1)}return t.prototype.show=function(e,t){if(this.target_id!=e||t!=this.comment_allow){this.target_id=e,this.comment_allow=t,this.blockemj.me.visible=!1,this.noinfo.visible=!1,this.container_input.visible=!1;if(game.Tools.setGrayDisable(this.btn_send,!1),e==GameMgr.Inst.account_id)this.noinfo.visible=!0,this.noinfo.text="我的信息";else{var i=!1,n=!1;game.Scene_MJ.Inst.active&&view.DesktopMgr.Inst.mode==view.EMJMode.play&&(n=!0),n?(this.noinfo.visible=!0,this.noinfo.text=cfg.str.str.get(20).desc):2==t?(this.noinfo.visible=!0,this.noinfo.text=cfg.str.str.get(17).desc):1==t?game.FriendMgr.find(e)?i=!0:(this.noinfo.visible=!0,this.noinfo.text=cfg.str.str.get(18).desc):i=!0,i&&(this.container_input.visible=!0,this.img_input.height=74,this.txt_input.height=95,this.txt_input.text="")}}},t.prototype.reset=function(){this.noinfo.visible=!1,this.container_input.visible=!1,this.blockemj.me.visible=!1,this.target_id=-1,this.comment_allow=-1},t}(),n=function(){function t(t){this.me=t,this.label_noinfo=t.getChildByName("noinfo"),this.label_content=t.getChildByName("content");var i=t.getChildByName("btn_change");i&&(i.clickHandler=Laya.Handler.create(this,function(){e.Sign_Input.Inst.show()},null,!1))}return t.prototype.reset=function(){this.label_noinfo.visible=!1,this.label_content.visible=!1},t.prototype.setSign=function(e){this.reset(),e&&""!=e?(this.label_content.visible=!0,this.label_content.text=game.Tools.strWithoutForbidden(e)):this.label_noinfo.visible=!0},t}(),a=function(){function t(e,t){var i=this;this._emjs=[],this.me=e,this._on_btn_emj=t,this.root=this.me.getChildByName("root"),this.scroll_view=this.root.scriptMap["capsui.CScrollView"],this.scroll_view.init_scrollview(Laya.Handler.create(this,this.render_item,null,!1)),this.me.getChildByName("close").clickHandler=Laya.Handler.create(this,function(){i._locking||i.close()},null,!1)}return t.prototype.show=function(){var t=this;this._emjs=[];for(var i=0;i<e.UI_Sushe.characters.length;i++){var n=cfg.item_definition.character.get(e.UI_Sushe.characters[i].charid);if(n)for(var a=0;a<9;a++)this._emjs.push({path:n.emo+"/"+a+".png",chara:e.UI_Sushe.characters[i].charid,index:a})}this.scroll_view.reset(),this.scroll_view.addItem(Math.ceil(this._emjs.length/3)),this._locking=!0,this.me.visible=!0,e.UIBase.anim_pop_out(this.root,Laya.Handler.create(this,function(){t._locking=!1}))},t.prototype.close=function(){var t=this;this._locking=!0,e.UIBase.anim_pop_hide(this.root,Laya.Handler.create(this,function(){t._locking=!1,t.me.visible=!1}))},t.prototype.render_item=function(t){for(var i=this,n=t.index,a=t.container,r=t.cache_data,o=function(t){var o=a.getChildAt(t),h=3*n+t;h>=s._emjs.length?o.visible=!1:(o.visible=!0,r["skin_"+t]||(r["skin_"+t]=new e.UI_Character_Emo(o)),r["skin_"+t].setSkin(s._emjs[h].chara,s._emjs[h].index),o.clickHandler=Laya.Handler.create(s,function(){i._locking||(i._on_btn_emj.runWith(i._emjs[h]),i.close())},null,!1))},s=this,h=0;h<3;h++)o(h)},t}(),r=function(){function a(e,t){this.comment_allow=0,this.comment_list=[],this.input=null,this.nonote=null,this.red_point=null,this.readed=!0,this.last_read_id=-1,this.red_point=t,this.me=e,this.content=this.me.scriptMap["capsui.CScrollView"],this.content.init_scrollview(Laya.Handler.create(this,this._render_item,null,!1)),this.page_controller=new capsui.PageController(this.me.getChildByName("page_controller"),Laya.Handler.create(this,this._render_page,null,!1)),this.me.getChildByName("input")&&(this.input=new i(this,this.me.getChildByName("input"),this.me.getChildByName("noinfo"),this.me.getChildByName("container_emj"))),this.nonote=this.me.getChildByName("nonote"),this.sign=new n(this.me.getChildByName("sign"))}return a.prototype.init_data=function(e){this.readed=!0,this.target_id=e,this.comment_list=[],this.nonote.visible=!1,this.red_point&&(this.red_point.visible=!1),this.page_controller.reset(),this.content.reset(),this.input&&this.input.reset(),this.refresh(),this.sign.reset()},a.prototype.show=function(){this.me.visible=!0,this.target_id==GameMgr.Inst.account_id&&(this.read(),this.red_point&&(this.red_point.visible=!1))},a.prototype.close=function(){this.me.visible=!1},a.prototype.refresh=function(){var i=this;app.NetAgent.sendReq2Lobby("Lobby","fetchCommentList",{target_id:this.target_id},function(n,a){if(n||a.error)e.UIMgr.Inst.showNetReqError("fetchCommentList",n,a);else{if(i.comment_list=[],i.page_controller.reset(),i.content.reset(),a.comment_id_list){for(var r=0;r<a.comment_id_list.length;r++)i.comment_list.push(new t(i,a.comment_id_list[r]));i.page_controller.set_total_page_count(Math.ceil(i.comment_list.length/10))}i.nonote.visible=0==i.comment_list.length,i.comment_allow=a.comment_allow,i.input&&i.input.show(i.target_id,i.comment_allow),i.last_read_id=a.last_read_id,i.target_id==GameMgr.Inst.account_id&&(i.me.visible?i.read():i.red_point&&(i.red_point.visible=i.comment_list.length>0&&i.comment_list[0].id!=i.last_read_id))}})},a.prototype.read=function(){-1!=this.last_read_id&&0!=this.comment_list.length&&this.target_id==GameMgr.Inst.account_id&&this.last_read_id!=this.comment_list[0].id&&app.NetAgent.sendReq2Lobby("Lobby","updateReadComment",{read_id:this.comment_list[0].id},function(e,t){})},a.prototype._render_page=function(e){if(10*e>=this.comment_list.length)this.content.reset();else{this.content.reset();var t=this.comment_list.length-10*e;t>10&&(t=10),this.content.addItem(t),this._fetch_current_page()}},a.prototype._fetch_current_page=function(){for(var t=this,i=[],n=0;n<10;n++){var a=10*this.page_controller.current_index+n;if(a>=this.comment_list.length)break;this.comment_list[a].loaded||i.push(this.comment_list[a].id)}i.length>0&&app.NetAgent.sendReq2Lobby("Lobby","fetchCommentContent",{target_id:this.target_id,comment_id_list:i},function(i,n){if(i||n.error)e.UIMgr.Inst.showNetReqError("fetchCommentContent",i,n);else for(var a=0;a<n.comments.length;a++)for(var r=n.comments[a],o=0;o<t.comment_list.length;o++)if(t.comment_list[o].id==r.comment_id){t.comment_list[o].setInfo(r);break}})},a.prototype._render_item=function(t){var i=t.index,n=t.container,a=t.cache_data,r=10*this.page_controller.current_index+i;r<this.comment_list.length?this.comment_list[r].bind(n,a):e.UIMgr.Inst.ShowErrorInfo("显示出错,超出范围")},a.prototype.delItem=function(t){for(var i=-1,n=0;n<this.comment_list.length;n++)if(this.comment_list[n].id===t){for(var a=n;a<this.comment_list.length-1;a++)this.comment_list[a]=this.comment_list[a+1];this.comment_list.pop(),i=n-10*this.page_controller.current_index;break}i>=0&&i<10&&(this.content.delItem(i),10*this.page_controller.current_index+10<=this.comment_list.length&&(this.content.addItem(1),this._fetch_current_page())),app.NetAgent.sendReq2Lobby("Lobby","deleteComment",{target_id:this.target_id,delete_list:[t]},function(t,i){(t||i.error)&&e.UIMgr.Inst.showNetReqError("deleteComment",t,i)}),this.page_controller.set_total_page_count(Math.ceil(this.comment_list.length/10)),this.nonote.visible=0==this.comment_list.length},a}();e.UI_PlayerNote=r}(uiscript||(uiscript={}));var uiscript;!function(e){var t=function(){function t(t,i,n){var a=this;this.me=t,this.label_gold=t.getChildByName("container_gold0").getChildByName("label_gold"),this.btn_gold=t.getChildByName("container_gold0"),this.label_diamond=t.getChildByName("container_gold1").getChildByName("label_gold"),this.btn_diamond=t.getChildByName("container_gold1"),this.label_diamond.text="0",this.label_gold.text="0",this.btn_gold.clickHandler=Laya.Handler.create(this,function(){n&&n.run()||i&&i.runWith(Laya.Handler.create(a,function(){e.UI_Recharge.Inst.show(!0)},null,!1))},null,!1),this.btn_diamond.clickHandler=Laya.Handler.create(this,function(){n&&n.run()||i&&i.runWith(Laya.Handler.create(a,function(){e.UI_Recharge.Inst.show(!1)},null,!1))},null,!1),app.NetAgent.AddListener2Lobby("NotifyAccountUpdate",Laya.Handler.create(this,function(t){var i=t.update;if(i&&i.numerical){for(var n=0;n<i.numerical.length;n++){var r=i.numerical[n].id,o=i.numerical[n].final;switch(r){case 100002:a.label_gold.text=a.money2Desc(o)}}Laya.timer.frameOnce(1,a,function(){a.label_diamond.text=a.money2Desc(e.UI_Bag.get_item_count(100001))})}},null,!1))}return t.prototype.onEnable=function(){this.label_diamond.text=this.money2Desc(e.UI_Bag.get_item_count(100001)),this.label_gold.text=this.money2Desc(GameMgr.Inst.account_data.gold)},t.prototype.money2Desc=function(e){if(e<1e6)return e.toString();if(e<1e8){for(var t=(e/1e4).toFixed(3),i=0,n=0;n<t.length;n++)if("."==t[n]){i=n;break}return(t=i>=4?t.substr(0,4):t.substr(0,5))+"万"}for(var t=(e/1e8).toFixed(3),i=0,n=0;n<t.length;n++)if("."==t[n]){i=n;break}return(t=i>=4?t.substr(0,4):t.substr(0,5))+"亿"},t}();e.UI_Money=t}(uiscript||(uiscript={}));var uiscript;!function(e){var t=function(){function t(i){this.items=[],this.select_index=-1,this.right_btn_cd=0,t.Inst=this,this.me=i,this.me.visible=!1,this.container_left=this.me.getChildByName("left"),this.container_right=this.me.getChildByName("right"),this.container_nomail=this.me.getChildByName("nomail"),this.left_sroll=this.me.getChildByName("left").scriptMap["capsui.CScrollView"],this.left_sroll.init_scrollview(Laya.Handler.create(this,this._renderLeft,null,!1));var n=this.me.getChildByName("right");this.title=n.getChildByName("title"),this.content=n.getChildByName("content"),this.btn_get=n.getChildByName("btn_get"),this.btn_del=n.getChildByName("btn_del"),this.container_item=n.getChildByName("container_item");for(var a=0;a<this.container_item.numChildren;a++){var r=this.container_item.getChildAt(a);this.items.push({me:r,icon:new e.UI_Item_Skin(r.getChildByName("btn").getChildByName("icon"))}),this.items[a].me.visible=!1}}return Object.defineProperty(t,"haveRedPoint",{get:function(){for(var e=0;e<this.mails.length;e++)if(0==this.mails[e].state)return!0;return!1},enumerable:!0,configurable:!0}),t.Init=function(){var i=this;app.NetAgent.sendReq2Lobby("Lobby","fetchMailInfo",{},function(t,n){if(t||n.error)e.UIMgr.Inst.showNetReqError("fetchMailInfo",t,n);else{if(i.mails=[],n.mails)for(var a=0;a<n.mails.length;a++)i.mails.push(n.mails[a]);i.mails=i.mails.sort(function(e,t){var i=e.create_time;i||(i=0);var n=t.create_time;return n||(n=0),n-i})}}),app.NetAgent.AddListener2Lobby("NotifyNewMail",Laya.Handler.create(this,function(e){i.mails.unshift(e.mail)},null,!1)),app.NetAgent.AddListener2Lobby("NotifyDeleteMail",Laya.Handler.create(this,function(e){for(var n=0;n<e.mail_id_list.length;n++)if(i.Inst)i.Inst.onDelMail(e.mail_id_list[n]);else{for(var a=-1,r=0;r<t.mails.length;r++)if(t.mails[r].mail_id==e.mail_id_list[r]){a=r;break}for(var o=a;o<t.mails.length-1;o++)t.mails[o]=t.mails[o+1];t.mails.pop()}},null,!1))},t.prototype.show=function(){this.left_sroll.reset(),this.right_btn_cd=0,t.mails.length>0?(this.select_index=0,this.left_sroll.addItem(t.mails.length),this._renderRight(0,!0),this.container_left.visible=!0,this.container_right.visible=!0,this.container_nomail.visible=!1):(this.select_index=0,this.container_left.visible=!1,this.container_right.visible=!1,this.container_nomail.visible=!0),this.me.visible=!0},t.prototype.onDelMail=function(i){for(var n=-1,a=0;a<t.mails.length;a++)if(t.mails[a].mail_id==i){n=a;break}for(var r=n;r<t.mails.length-1;r++)t.mails[r]=t.mails[r+1];if(t.mails.pop(),e.UI_Activity.Inst.enable){var o=this.select_index;o==t.mails.length&&o--,this.left_sroll.delItem(n),t.mails.length<=0?(this.container_left.visible=!1,this.container_right.visible=!1,this.container_nomail.visible=!0):(this.container_left.visible=!0,this.container_right.visible=!0,this.container_nomail.visible=!1,this._renderRight(o,!0),this.left_sroll.wantToRefreshItem(o))}},t.prototype.hide=function(){this.me.visible=!1,this.left_sroll.reset()},t.prototype._renderLeft=function(e){var i=this,n=e.index,a=e.container,r=t.mails[n],o=a.getChildByName("bg");o.skin=this.select_index==n?"myres/lobby/act_choosed.png":"myres/lobby/act_unchoosen.png";var s=a.getChildByName("state");s.skin=this.select_index!=n&&0==r.state?"myres/lobby/read_no.png":"myres/lobby/read_yes.png",a.clickHandler=Laya.Handler.create(this,function(){if(i.select_index!=n){var e=i.select_index;i._renderRight(n,!1),r.state=1,o.skin="myres/lobby/act_choosed.png",s.skin="myres/lobby/read_yes.png",e>=0&&i.left_sroll.wantToRefreshItem(e)}},null,!1),a.getChildByName("title").text=r.title},t.prototype._renderRight=function(i,n){var a=this;if(n||this.select_index!=i){var r=t.mails[i];this.select_index=i,this.title.text=r.title,this.content.text=r.content;for(var o=!1,s=[],h=0;h<r.attachments.length;h++)100099!=r.attachments[h].id&&100098!=r.attachments[h].id&&s.push(r.attachments[h]);if(r.attachments&&r.attachments.length>0){o=!r.take_attachment;for(var l=function(t){if(t<s.length){c.items[t].me.visible=!0;var i=s[t],n=i.id,a=i.count;c.items[t].me.getChildByName("btn").clickHandler=Laya.Handler.create(c,function(){e.UI_ItemDetail.Inst.show(n)},null,!1),c.items[t].icon.setSkin(game.GameUtility.get_item_view(n).icon);var r=c.items[t].me.getChildByName("count");a<=1?r.visible=!1:(r.visible=!0,r.text=a.toString());c.items[t].me.getChildByName("getted").visible=!o,c.items[t].me.x=12+120*t,c.items[t].me.y=c.items[0].me.y}else c.items[t].me.visible=!1},c=this,h=0;h<this.items.length;h++)l(h)}else for(h=0;h<this.items.length;h++)this.items[h].me.visible=!1;this.btn_get.visible=o,this.btn_del.visible=!o,0==r.state&&(this.onReadStateChange(),app.NetAgent.sendReq2Lobby("Lobby","readMail",{mail_id:r.mail_id},function(){}),r.state=1,this.onReadStateChange()),this.right_btn_cd=0,this.btn_get.clickHandler=Laya.Handler.create(this,function(){Laya.timer.currTimer<a.right_btn_cd||(a.right_btn_cd=Laya.timer.currTimer+1e3,app.NetAgent.sendReq2Lobby("Lobby","takeAttachmentFromMail",{mail_id:r.mail_id},function(t,i){if(a.right_btn_cd=0,t||i.error)e.UIMgr.Inst.showNetReqError("takeAttachmentFromMail",t,i);else{a.btn_get.visible=!o,a.btn_del.visible=o,r.take_attachment=!0;for(var n=0;n<a.items.length;n++)a.items[n].me.visible&&(a.items[n].me.getChildByName("getted").visible=!0)}}))},null,!1),this.btn_del.clickHandler=Laya.Handler.create(this,function(){Laya.timer.currTimer<a.right_btn_cd||(a.right_btn_cd=Laya.timer.currTimer+1e3,app.NetAgent.sendReq2Lobby("Lobby","deleteMail",{mail_id:r.mail_id},function(t,i){a.right_btn_cd=0,t||i.error?e.UIMgr.Inst.showNetReqError("deleteMail",t,i):a.onDelMail(r.mail_id)}))})}},t.prototype.onReadStateChange=function(){e.UI_Lobby.Inst.top.refreshRedpoint(),e.UI_Activity.Inst.refresh_redpoint()},t.Inst=null,t.mails=[],t}();e.UI_Mail=t}(uiscript||(uiscript={}));var uiscript;!function(e){var t=function(){function e(e){this.stars=[],this._id=0,this.level_v=null,this.level_vmax=null,this.level_bar=null,this.me=e,this.icon=e.getChildByName("icon");for(var t=1;t<=3;t++)this.stars.push(e.getChildByName("star"+t).getChildAt(0));var i=this.me.getChildByName("exp");i&&(this.level_v=i.getChildByName("value"),this.level_vmax=i.getChildByName("max"),this.level_bar=i.getChildByName("bar").getChildByName("v"))}return Object.defineProperty(e.prototype,"id",{set:function(e){var t=cfg.level_definition.level_definition.get(e);t||(t=cfg.level_definition.level_definition.find(10201)),this._id=t.id,this.icon.skin=game.LoadMgr.getResImageSkin(t.primary_icon);for(var i=0;i<this.stars.length;i++)this.stars[i].visible=i<t.secondary_level},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"exp",{set:function(e){var t=cfg.level_definition.level_definition.get(this._id);if(this.level_v&&(this.level_v.text=Math.floor(e).toString()),this.level_vmax&&(this.level_vmax.text=Math.floor(t.end_point).toString()),this.level_bar){var i=e/t.end_point;i=i<0?0:i>1?1:i,this.level_bar.x=145*i-153}},enumerable:!0,configurable:!0}),e}();e.UI_Level=t}(uiscript||(uiscript={}));var uiscript;!function(e){var t=function(){function e(e){this.change_id=0,this.skin_path="",this.loaded=!1,this.me=e,this.img=e,this.img.skin=""}return e.prototype.setSkin=function(e){var t=this;if(""!=e){var i=e;if(i!=this.skin_path){this.skin_path=i,this.change_id++;var n=this.change_id,a=game.LoadMgr.getResImageSkin(i);""==a?(this.img.skin=game.LoadMgr.getResImageSkin("extendRes/items/default.jpg"),this.loaded=!1,game.LoadMgr.loadResImage([this.skin_path],Laya.Handler.create(this,function(){n==t.change_id&&(t.loaded=!0,t.img.skin=game.LoadMgr.getResImageSkin(t.skin_path))}))):(this.loaded=!0,this.img.skin=a)}}else this.clear()},e.prototype.clear=function(){this.change_id++,this.loaded&&""!=this.skin_path&&(Laya.loader.clearTextureRes(this.skin_path),this.loaded=!1,this.skin_path="")},e}();e.UI_Item_Skin=t}(uiscript||(uiscript={}));var uiscript;!function(e){var t=function(){function t(t){this.me=t,this.img_head=new e.UI_Character_Skin(t.getChildAt(0)),this.img_emo=this.img_head.me.getChildAt(0)}return Object.defineProperty(t.prototype,"id",{get:function(){return this._id},set:function(e){this._id=e,this.img_head.setSkin(e,"smallhead")},enumerable:!0,configurable:!0}),t.prototype.setEmo=function(e,t){var i=this;void 0===t&&(t=-1),Laya.timer.clearAll(this),this.img_emo&&(e&&""!=e?(this.img_emo.visible=!0,t>0&&Laya.timer.once(t,this,function(){i.img_emo.visible=!1})):this.img_emo.visible=!1)},t}();e.UI_Head=t}(uiscript||(uiscript={}));var uiscript;!function(e){var t=function(){function t(t){this.change_id=0,this.skin_path="",this.loaded=!1,this.me=t,this.img=t,this.origin_rect=e.UIRect.CreateFromSprite(this.img),this.img.skin=""}return t.prototype.setSkin=function(e,t){var i=this,n=cfg.item_definition.skin.get(e);if(n){var a=n.path+"/"+t+".png";if(a!=this.skin_path){this.skin_path=a,this.change_id++;var r=this.change_id;""==game.LoadMgr.getResImageSkin(a)?(this._setLoadedTexture(4e5,t),this.loaded=!1,game.LoadMgr.loadResImage([this.skin_path],Laya.Handler.create(this,function(){r==i.change_id&&(i.loaded=!0,i._setLoadedTexture(e,t))}))):(this.loaded=!0,this._setLoadedTexture(e,t))}}else this.clear()},t.prototype.clear=function(){this.change_id++,this.loaded&&""!=this.skin_path&&(this.loaded=!1,this.skin_path="")},t.prototype._setLoadedTexture=function(e,t){var i=cfg.item_definition.skin.get(e);"full"==t||"half"==t?game.Tools.charaPart(e,this.img,t,this.origin_rect):this.img.skin=game.LoadMgr.getResImageSkin(i.path+"/"+t+".png")},t}();e.UI_Character_Skin=t}(uiscript||(uiscript={}));var uiscript;!function(e){var t=function(){function e(e){this.change_id=0,this.skin_path="",this.loaded=!1,this.me=e,this.me.skin=""}return e.prototype.setSkin=function(e,t){var i=this,n=cfg.item_definition.character.get(e);if(n){var a=n.emo+"/"+t.toString()+".png";if(a!=this.skin_path){this.skin_path=a,this.change_id++;var r=this.change_id,o=game.LoadMgr.getResImageSkin(a);""==o?(this.me.skin=game.LoadMgr.getResImageSkin("extendRes/emo/default.png"),this.loaded=!1,game.LoadMgr.loadResImage([this.skin_path],Laya.Handler.create(this,function(){r==i.change_id&&(i.loaded=!0,i.me.skin=game.LoadMgr.getResImageSkin(i.skin_path))}))):(this.loaded=!0,this.me.skin=o)}}else this.clear()},e.prototype.clear=function(){this.change_id++,this.loaded&&""!=this.skin_path&&(Laya.loader.clearTextureRes(this.skin_path),this.loaded=!1,this.skin_path="")},e}();e.UI_Character_Emo=t}(uiscript||(uiscript={}));var uiscript;!function(e){var t=function(){function e(e){this.me=null,this.info=null,this._info="",this._index=0,this._start_time=0,this._word_span=50,this.me=e,this.info=this.me.getChildByName("info")}return e.prototype.show=function(e){var t=this;Laya.timer.clearAll(this),this.info.text="",this._info=e,this._index=0,this.me.visible=!0,this.me.alpha=0,Laya.Tween.to(this.me,{alpha:1},200,null,null,0,!0),this._start_time=Laya.timer.currTimer,this._word_span=50,Laya.timer.once(200,this,function(){t._nextchar()})},e.prototype._nextchar=function(){if(!(this._info.length<=this._index))if("["==this._info[this._index]){for(var e=-1,t=this._index+1;t<this._info.length;t++)if("]"==this._info[t]){e=t;break}if(-1==e)return;n=parseInt(this._info.substring(this._index+1,e));this._index=e+1;var i=Laya.timer.currTimer-this._start_time;i>=n?this._nextchar():Laya.timer.once(n-i,this,this._nextchar)}else if("<"==this._info[this._index]){for(var e=-1,t=this._index+1;t<this._info.length;t++)if(">"==this._info[t]){e=t;break}if(-1==e)return;var n=parseInt(this._info.substring(this._index+1,e));this._index=e+1,this._word_span=n,this._nextchar()}else this.info.text+=this._info[this._index++],Laya.timer.once(this._word_span,this,this._nextchar)},e.prototype.close=function(e){var t=this;e?(this.me.visible=!1,Laya.timer.clearAll(this)):(Laya.Tween.to(this.me,{alpha:0},200,null,null,0,!0),Laya.timer.once(200,this,function(){t.me.visible=!1,Laya.timer.clearAll(t)}))},e}();e.UI_Character_Chat=t}(uiscript||(uiscript={}));var uiscript;!function(e){var t=function(){function e(e,t,i){var n=this;this._func_locking=null,this._func_hide=null,this._func_locking=t,this._func_hide=i,this.me=e;var a=this.me.getChildByName("unhit");this.me.getChildByName("btn").clickHandler=Laya.Handler.create(this,function(){n._func_locking&&n._func_locking.run()||(a.mouseX<0||a.mouseX>a.width||a.mouseY<0||a.mouseY>a.height)&&(n._func_hide&&n._func_hide.run(),n.hide())},null,!1)}return e.prototype.show=function(){Laya.timer.clearAll(this),this.me.visible=!0,this.me.alpha=0,Laya.Tween.to(this.me,{alpha:.3},150)},e.prototype.hide=function(){Laya.timer.clearAll(this),Laya.Tween.to(this.me,{alpha:0},150)},e}();e.UI_BlackMask=t}(uiscript||(uiscript={}));var uiscript;!function(e){var t=function(){function t(e){this.items=[],this.me=e,this.scrollview=e.scriptMap["capsui.CScrollView"],this.scrollview.init_scrollview(new Laya.Handler(this,this.render_item),-1,6,10),this.scrollview.reset()}return t.prototype.show=function(t){this.category=t,this.me.visible=!0,this.scrollview.reset(),this.items=e.UI_Bag.find_items_by_category(t),this.scrollview.addItem(this.items.length)},t.prototype.close=function(){this.me.visible=!1,this.items=[],this.scrollview.reset()},t.prototype.render_item=function(t){var i=t.index,n=t.container,a=t.cache_data;a.skin||(a.skin=new e.UI_Item_Skin(n.getChildByName("btn_detail").getChildByName("content").getChildByName("icon")));var r=this.items[i],o=cfg.item_definition.item.get(r.item_id),s=n.getChildByName("btn_detail");s.clickHandler=Laya.Handler.create(this,function(){e.UI_ItemDetail.Inst.show(r.item_id)},null,!1),s.getChildByName("count").visible=!1,s.getChildByName("btn_del").visible=!1,a.skin.setSkin(o.icon);var h=s.getChildByName("content").getChildByName("num");r.count<=1?h.visible=!1:(h.visible=!0,h.text=r.count.toString())},t.prototype.when_update_data=function(){this.scrollview.reset(),this.items=e.UI_Bag.find_items_by_category(this.category),this.scrollview.addItem(this.items.length)},t}();e.UI_Bag_PageItem=t}(uiscript||(uiscript={}));var uiscript;!function(e){var t=function(){function t(t){this.stardust_icon=null,this.stardust_count=0,this.stardust_detail=0,this.items=[],this.choose_count={},this.during_sell=!1,this.me=t,this.scrollview=t.scriptMap["capsui.CScrollView"],this.scrollview.init_scrollview(new Laya.Handler(this,this.render_item),-1,6,10),this.scrollview.reset(),this.stardust_icon=new e.UI_Item_Skin(this.me.getChildByName("stardust")),this.label_stardust_count=this.me.getChildByName("stardust").getChildByName("count"),this.label_stardust_delta=this.me.getChildByName("stardust").getChildByName("delta"),this.btn_sell=this.me.getChildByName("btn_sell"),this.btn_sell.clickHandler=new Laya.Handler(this,this.open_sell),this.label_huanqu=this.me.getChildByName("label_huanqu"),this.container_sell=this.me.getChildByName("container_sell"),this.container_sell.getChildByName("btn_clear").clickHandler=new Laya.Handler(this,this.clear_choose),this.container_sell.getChildByName("btn_back").clickHandler=new Laya.Handler(this,this.close_sell),this.container_sell.getChildByName("btn_sell").clickHandler=new Laya.Handler(this,this.on_btn_sell),this.btn_sell2=this.container_sell.getChildByName("btn_sell"),this.btn_clear_choose=this.container_sell.getChildByName("btn_clear")}return t.prototype.show=function(){this.me.visible=!0,this.during_sell=!1,this.btn_sell.visible=!0,this.label_huanqu.visible=!0,this.container_sell.visible=!1,this.label_stardust_delta.visible=!1,this.choose_count={},this.stardust_icon.setSkin(game.LoadMgr.getResImageSkin(cfg.item_definition.item.get(302004).icon)),this.stardust_count=e.UI_Bag.get_item_count(game.stardust_id),this.stardust_detail=0,this.refresh_stardust(),this.scrollview.reset(),this.items=e.UI_Bag.find_items_by_category(e.EItemCategory.gift),this.scrollview.addItem(this.items.length),0==this.items.length&&(this.btn_sell.visible=!1)},t.prototype.close=function(){this.me.visible=!1,this.items=[],this.scrollview.reset()},t.prototype.render_item=function(t){var i=this,n=t.index,a=t.container,r=t.cache_data,o=this.items[n],s=cfg.item_definition.item.get(o.item_id),h=a.getChildByName("btn_detail"),l=h.getChildByName("content").getChildByName("num"),c=function(){var e=o.count;if(i.during_sell){var t=i.choose_count[o.item_id];null==t||0==t?(a.getChildByName("count").visible=!1,a.getChildByName("btn_del").visible=!1):(a.getChildByName("count").visible=!0,a.getChildByName("count").getChildAt(0).text=t.toString(),a.getChildByName("btn_del").visible=!0,e-=t)}else a.getChildByName("count").visible=!1,a.getChildByName("btn_del").visible=!1;e<=1?l.visible=!1:(l.visible=!0,l.text=e.toString())};c(),h.clickHandler=Laya.Handler.create(this,function(){if(i.during_sell){var t=0;i.choose_count.hasOwnProperty(o.item_id.toString())?(t=i.choose_count[o.item_id],i.choose_count[o.item_id]++):(t=0,i.choose_count[o.item_id]=1),i.choose_count[o.item_id]>o.count&&(i.choose_count[o.item_id]=o.count),i.stardust_detail+=(i.choose_count[o.item_id]-t)*s.sell_reward_count,i.refresh_stardust(),c()}else e.UI_ItemDetail.Inst.show(o.item_id)},null,!1),a.getChildByName("btn_del").clickHandler=Laya.Handler.create(this,function(){i.during_sell&&i.choose_count[o.item_id]&&(i.choose_count[o.item_id]--,c(),i.stardust_detail-=s.sell_reward_count,i.refresh_stardust())},null,!1),r.skin||(r.skin=new e.UI_Item_Skin(h.getChildByName("content").getChildByName("icon"))),r.skin.setSkin(s.icon);var p=h.getChildByName("content");this.during_sell?p.scaleX=p.scaleY=.9:p.scaleX=p.scaleY=1.1},t.prototype.open_sell=function(){this.during_sell=!0,this.btn_sell.visible=!1,this.label_huanqu.visible=!1,this.container_sell.visible=!0,this.label_stardust_delta.visible=!0,this.label_stardust_delta.text="",this.choose_count={},this.stardust_detail=0,this.refresh_stardust(),this.scrollview.wantToRefreshAll()},t.prototype.close_sell=function(){this.during_sell=!1,this.btn_sell.visible=!0,this.label_huanqu.visible=!0,this.container_sell.visible=!1,this.label_stardust_delta.visible=!1,this.clear_choose(),this.scrollview.wantToRefreshAll()},t.prototype.on_btn_sell=function(){var t=[];for(var i in this.choose_count)this.choose_count[i]>0&&t.push({item_id:parseInt(i),count:this.choose_count[i]});e.UI_SecondConfirm.Inst.show("确定要奉纳这些礼物吗？",Laya.Handler.create(this,function(){app.NetAgent.sendReq2Lobby("Lobby","sellItem",{sells:t},function(t,i){t||i.error?e.UIMgr.Inst.showNetReqError("sellItem",t,i):e.UI_LightTips.Inst.show("奉纳成功")})}),Laya.Handler.create(this,function(){}))},t.prototype.clear_choose=function(){for(var e in this.choose_count){this.choose_count[e]=0;for(var t=0;t<this.items.length;t++)this.items[t].item_id.toString()==e&&this.scrollview.wantToRefreshItem(t)}this.stardust_detail=0,this.refresh_stardust()},t.prototype.refresh_stardust=function(){this.label_stardust_count.text="x"+this.stardust_count,this.stardust_detail>0?(this.label_stardust_delta.text="+"+this.stardust_detail.toString(),this.label_stardust_delta.x=this.label_stardust_count.textField.textWidth+55,this.label_stardust_delta.visible=!0,this.btn_sell2.visible=!0,this.btn_clear_choose.visible=!0):(this.label_stardust_delta.visible=!1,this.btn_sell2.visible=!1,this.btn_clear_choose.visible=!1)},t.prototype.when_update_data=function(){this.close_sell(),this.scrollview.reset(),this.items=e.UI_Bag.find_items_by_category(e.EItemCategory.gift),this.scrollview.addItem(this.items.length),0==this.items.length&&(this.btn_sell.visible=!1),this.stardust_count=e.UI_Bag.get_item_count(game.stardust_id),this.refresh_stardust()},t}();e.UI_Bag_PageGift=t}(uiscript||(uiscript={}));var uiscript;!function(e){var t=function(){function t(e){var t=this;this.desktop_default="myres2/tablecloth/tablecloth_default/preview.jpg",this.mjp_defalut="myres2/mjp/mjp_default/preview.png",this.tab_index=0,this.select_index=0,this.items=[],this.img_desktop=null,this.img_mjp=null,this.btn_save=null,this.me=e,this.scrollview=e.getChildByName("items").scriptMap["capsui.CScrollView"],this.scrollview.init_scrollview(new Laya.Handler(this,this.render_item),-1,3,10),this.scrollview.reset(),this.btn_tablecloth=e.getChildByName("items").getChildByName("btn_tablecloth"),this.btn_tablecloth.clickHandler=Laya.Handler.create(this,function(){1!=t.tab_index&&t.change_tab(1)},null,!1),this.btn_cardback=e.getChildByName("items").getChildByName("btn_cardback"),this.btn_cardback.clickHandler=Laya.Handler.create(this,function(){2!=t.tab_index&&t.change_tab(2)},null,!1);var i=this.me.getChildByName("preview");this.img_desktop=i.getChildByName("desktop"),this.img_mjp=i.getChildByName("mjp"),this.btn_save=i.getChildByName("btn_use"),this.btn_save.clickHandler=Laya.Handler.create(this,this.save_change,null,!1)}return t.prototype.show=function(){this.me.visible=!0,this.items=e.UI_Bag.find_items_by_category(e.EItemCategory.common_view),this.items=this.items.sort(function(e,t){return e.item_id-t.item_id}),this.scrollview.reset(),this.scrollview.addItem(this.items.length),this.btn_save.visible=!1,this.change_tab(1)},t.prototype.close=function(){this.me.visible=!1,this.items=[],this.scrollview.reset(),Laya.loader.clearTextureRes(this.img_desktop.skin),Laya.loader.clearTextureRes(this.img_mjp.skin),this.img_desktop.skin="",this.img_mjp.skin="",game.LoadMgr.clearImgSkin(this.img_desktop),game.LoadMgr.clearImgSkin(this.img_mjp)},t.prototype.change_tab=function(t){var i=e.UI_Bag.find_items_by_category(e.EItemCategory.common_view);i=i.sort(function(e,t){return e.item_id-t.item_id}),this.tab_index=t,this.items=[],this.scrollview.reset(),this.select_index=-1,this.btn_tablecloth.getChildByName("inchoose").visible=1==t,this.btn_cardback.getChildByName("inchoose").visible=2==t;for(var n=0;n<i.length;n++){cfg.item_definition.item.get(i[n].item_id).type==t&&(this.items.push(i[n]),i[n].item_id==game.GameUtility.get_common_view_id(t)&&(this.select_index=this.items.length-1))}this.scrollview.addItem(this.items.length),this._on_select_change(),1==t?this._refresh_mjp_view(game.GameUtility.get_common_view_id(game.ECommonView.mjp)):this._refresh_desktop_view(game.GameUtility.get_common_view_id(game.ECommonView.desktop))},t.prototype.render_item=function(t){var i=this,n=t.index,a=t.container,r=t.cache_data,o=this.items[n],s=cfg.item_definition.item.get(o.item_id),h=a.getChildByName("btn").getChildByName("inchoose");this.select_index==n?h.visible=!0:h.visible=!1;var l=a.getChildByName("btn");l.clickHandler=Laya.Handler.create(this,function(){if(i.select_index!=n){var t=i.select_index;i.select_index=n,h.visible=!0,t>=0&&t<i.items.length&&i.scrollview.wantToRefreshItem(t),i._on_select_change()}else e.UI_ItemDetail.Inst.show(o.item_id)},null,!1);var c=a.getChildByName("useing");GameMgr.Inst.commonview_slot[s.type]==o.item_id?c.visible=!0:c.visible=!1,r.skin||(r.skin=new e.UI_Item_Skin(l.getChildByName("icon"))),r.skin.setSkin(s.icon)},t.prototype._on_select_change=function(){if(this.select_index>=0&&this.select_index<this.items.length){var e=this.items[this.select_index];game.GameUtility.get_common_view_id(this.tab_index)==e.item_id?this.btn_save.getChildByName("info").text="取消使用":this.btn_save.getChildByName("info").text="使用",this.btn_save.visible=!0,1==this.tab_index?this._refresh_desktop_view(e.item_id):this._refresh_mjp_view(e.item_id)}else this.btn_save.visible=!1,1==this.tab_index?this._refresh_desktop_view(0):this._refresh_mjp_view(0)},t.prototype._refresh_desktop_view=function(e){var t=cfg.item_definition.view.get(e),i=this.desktop_default;t&&(i="myres2/tablecloth/"+t.res_name+"/preview.jpg"),game.LoadMgr.clearImgSkin(this.img_desktop),""!=this.img_desktop.skin&&(Laya.loader.clearTextureRes(this.img_desktop.skin),this.img_desktop.skin=""),game.LoadMgr.setImgSkin(this.img_desktop,i)},t.prototype._refresh_mjp_view=function(e){var t=cfg.item_definition.view.get(e),i=this.mjp_defalut;t&&(i="myres2/mjp/"+t.res_name+"/preview.png"),game.LoadMgr.clearImgSkin(this.img_mjp),""!=this.img_mjp.skin&&(Laya.loader.clearTextureRes(this.img_mjp.skin),this.img_mjp.skin=""),game.LoadMgr.setImgSkin(this.img_mjp,i)},t.prototype.save_change=function(){var e=this.items[this.select_index],t=0;game.GameUtility.get_common_view_id(this.tab_index)==e.item_id?(t=0,this.select_index=-1):t=e.item_id,GameMgr.Inst.commonview_slot[this.tab_index]=t,app.NetAgent.sendReq2Lobby("Lobby","changeCommonView",{slot:this.tab_index,value:t},function(e,t){}),2==this.tab_index&&GameMgr.Inst.load_mjp_view(t);for(var i=0;i<this.items.length;i++)this.scrollview.wantToRefreshItem(i);this._on_select_change()},t}();e.UI_Bag_PageDesktop=t}(uiscript||(uiscript={}));var uiscript;!function(e){var t=function(){function e(){}return e.CreateFromSprite=function(t){var i=new e;return i.x=t.x,i.y=t.y,i.width=t.width,i.height=t.height,i},e}();e.UIRect=t}(uiscript||(uiscript={}));var uiscript;!function(e){e.GRAY_FILTER=[.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0],e.DARK_FILTER=[.3,0,0,0,0,0,.3,0,0,0,0,0,.3,0,0,0,0,0,1,0];var t=function(){function t(){this._root=null,this._mj_root=null,this._lobby_root=null,this._both_root=null,this._common_root=null,this._error_root=null,this._mj_inited=!1,this._lobby_inited=!1,this._uis=new Array,this._lobby_uis=[],this._mj_uis=[],this._common_uis=[],this._both_uis=[],this._ui_chipenghu=null,this._ui_desktop=null,this._ui_liqizimo=null,this._ui_win=null,this._ui_gameend=null,this._ui_liuju=null,this._ui_lobby=null,this._ui_entrance=null,this._ui_waitingroom=null,this._ui_preventaddiction=null}return t.prototype.init=function(){t.Inst=this,this._root=new Laya.Sprite,GameMgr.Inst.addUI(this._root),this._root.addChild(this._lobby_root=new Laya.Sprite),this._root.addChild(this._mj_root=new Laya.Sprite),this._root.addChild(GameMgr.Inst.root_front_scene_effect=new Laya.Sprite),this._root.addChild(this._both_root=new Laya.Sprite),this._root.addChild(this._common_root=new Laya.Sprite),this._root.addChild(this._error_root=new Laya.Sprite),this.RefreshShow(),Laya.timer.frameLoop(1,this,this.RefreshShow)},t.prototype.openLobbyUI=function(t,i){var n=this;this._lobby_inited?(i&&i.runWith(1),t&&t.run()):game.Scene_Lobby.Inst.addLoadListenter(Laya.Handler.create(this,function(){n._lobby_inited=!0,n.AddLobbyUI(n._ui_lobby=new e.UI_Lobby),n.AddLobbyUI(n._ui_waitingroom=new e.UI_WaitingRoom),n.AddLobbyUI(new e.UI_PaiPu),n.AddLobbyUI(new e.UI_Sushe),n.AddLobbyUI(new e.UI_Ob),n.AddLobbyUI(new e.UI_Shop),n.AddLobbyUI(new e.UI_Friend),n.AddLobbyUI(new e.UI_Recharge),n.AddLobbyUI(new e.UI_Create_Room),n.AddLobbyUI(new e.UI_Bag),n.AddLobbyUI(new e.UI_Match_Lobby),n.AddLobbyUI(new e.UI_Match_Room),n.AddLobbyUI(new e.UI_Treasure),n.AddLobbyUI(new e.UI_TanfangRoot),n.AddLobbyUI(new e.UI_PlayerInfo),n.AddLobbyUI(new e.UI_Introduce),n.AddLobbyUI(new e.UI_TitleBook),n.AddLobbyUI(new e.UI_Activity),n.AddLobbyUI(new e.UI_Rank),n.AddLobbyUI(new e.UI_NumberInput),n.AddLobbyUI(new e.UI_PiPei),n.AddLobbyUI(new e.UI_WaitOb),n.AddLobbyUI(new e.UI_Change_Nickname),n.AddLobbyUI(new e.UI_Info),n.AddBothUI(new e.UI_Character_star_up),n.AddBothUI(new e.UI_Config),n.AddBothUI(new e.UI_Giftcode),n.AddBothUI(new e.UI_Rules),n.AddBothUI(new e.UI_Course),n.AddBothUI(new e.UI_OtherPlayerInfo),n.AddBothUI(new e.UI_Gettitle),n.AddBothUI(new e.UI_Getrewardextends),n.AddBothUI(new e.UI_ItemDetail),n.AddBothUI(new e.UI_InfoLite),n.AddBothUI(new e.UI_SecondConfirm),n.AddBothUI(new e.UI_Popout),n.AddBothUI(new e.UI_Invite),n.AddBothUI(new e.UI_LightTips),n.AddCommonUI(new e.UI_ShiMingRenZheng),n.AddCommonUI(new e.UI_Reconnect),n.AddCommonUI(new e.UI_Hanguplogout),n.AddCommonUI(new e.UI_AnotherLogin),n.AddCommonUI(new e.UI_Disconnect),n.AddCommonUI(new e.UI_RollNotice),n.AddCommonUI(new e.UI_CloseApp),e.UI_Loading.Inst.me.parent.setChildIndex(e.UI_Loading.Inst.me,e.UI_Loading.Inst.me.parent.numChildren-2),e.UI_CloseApp.Inst.me.parent.setChildIndex(e.UI_CloseApp.Inst.me,e.UI_CloseApp.Inst.me.parent.numChildren-1),Laya.timer.frameOnce(6,n,function(){t&&t.run()})}),i)},t.prototype.openMjDesktopUI=function(t,i){var n=this;this._mj_inited?(i&&i.runWith(1),t&&t.run()):game.LoadMgr.loadRes(game.E_LoadType.ui_mj,Laya.Handler.create(this,function(){n._mj_inited=!0,n.AddMJUI(new e.UI_Live_Broadcast),n.AddMJUI(new e.UI_ReplayWheel),n.AddMJUI(n._ui_desktop=new e.UI_DesktopInfo),n.AddMJUI(n._ui_chipenghu=new e.UI_ChiPengHu),n.AddMJUI(n._ui_liqizimo=new e.UI_LiQiZiMo),n.AddMJUI(new e.UI_TingPai),n.AddMJUI(n._ui_liuju=new e.UI_LiuJu),n.AddMJUI(new e.UI_Huleshow),n.AddMJUI(new e.UI_Replay),n.AddMJUI(new e.UI_Info_MD5),n.AddMJUI(n._ui_win=new e.UI_Win),n.AddMJUI(n._ui_gameend=new e.UI_GameEnd),n.AddMJUI(new e.UI_RankChange),n.AddMJUI(new e.UI_ScoreChange),n.AddMJUI(new e.UI_MJReward),n.AddMJUI(new e.UI_MJTask_Progress),n._mj_root.visible=!1,Laya.timer.frameOnce(6,n,function(){t&&t.run()})}),i)},t.prototype.disableMouse=function(){this._mj_root.mouseEnabled=!1,this._lobby_root.mouseEnabled=!1},t.prototype.enableMouse=function(){this._mj_root.mouseEnabled=!0,this._lobby_root.mouseEnabled=!0},t.prototype.closeUIWithTag_Lobby=function(){for(var e=0;e<this._lobby_uis.length;e++)this._lobby_uis[e]&&this._lobby_uis[e].enable&&(this._lobby_uis[e].enable=!1)},t.prototype.closeUIWithTag_Both=function(){for(var e=0;e<this._both_uis.length;e++)this._both_uis[e]&&this._both_uis[e].enable&&(this._both_uis[e].enable=!1)},t.prototype.showLobby=function(){this._lobby_root.visible=!0,e.UI_Ob.Inst.enable||e.UI_PaiPu.Inst.enable||(e.UI_Lobby.Inst.enable=!0)},t.prototype.intoMJDesktop=function(){this._lobby_root.visible=!1},t.prototype.onSceneMJ_Enable=function(){this._mj_root.visible=!0,this.CloseLiuJu(),this.CloseWin(),this.CloseChipenghu(),this.CloseLiqiZimo()},t.prototype.onSceneMJ_Disable=function(){this._mj_root.visible=!1,e.UI_Replay.Inst.enable=!1,e.UI_Live_Broadcast.Inst.enable=!1},t.prototype.onSceneLobby_Enable=function(){this._lobby_root.visible=!0},t.prototype.onSceneLobby_Disable=function(){this._lobby_root.visible=!1},t.prototype.showRemind=function(){null==e.UI_Remind.Inst?(this.AddLobbyUI(new e.UI_Remind),Laya.timer.frameOnce(5,this,function(){e.UI_Remind.Inst&&!e.UI_Remind.Inst.me.destroyed&&(e.UI_Remind.Inst.enable=!0)})):e.UI_Remind.Inst.enable=!0},t.prototype.showEntrance=function(){var t=this;null==this._ui_entrance?Laya.timer.frameOnce(1,this,function(){null==e.UI_User_Xieyi.Inst&&t.AddCommonUI(new e.UI_User_Xieyi),null==e.UI_Loading.Inst&&t.AddCommonUI(new e.UI_Loading),null==e.UI_Common.Inst&&(t.AddCommonUI(new e.UI_Common),Laya.timer.frameOnce(5,t,function(){GameMgr.inRelease||(e.UI_Common.Inst.enable=!0)})),e.UI_Remind.Inst&&e.UI_Remind.Inst.setprocess(10),t.AddLobbyUI(t._ui_entrance=new e.UI_Entrance),Laya.timer.frameOnce(5,t,function(){t._ui_entrance.show(),null!=e.UI_Remind.Inst&&e.UI_Remind.Inst.destroy()})}):this._ui_entrance.enable=!0},t.prototype.ShowChipenghu=function(e){this._ui_chipenghu&&this._ui_chipenghu.show(e)},t.prototype.CloseChipenghu=function(){this._ui_chipenghu&&(this._ui_chipenghu.enable=!1)},t.prototype.ShowLiqiZimo=function(e){this._ui_liqizimo.show(e)},t.prototype.CloseLiqiZimo=function(){this._ui_liqizimo.enable=!1},t.prototype.ShowWin=function(e,t){this._ui_win.show(e,t)},t.prototype.CloseWin=function(){this._ui_win.enable=!1},t.prototype.ShowPreventAddiction=function(){var t=this;null==this._ui_preventaddiction&&(this.AddCommonUI(this._ui_preventaddiction=new e.UI_PreventAddiction),Laya.timer.frameOnce(10,this,function(){t._ui_preventaddiction.enable=!0}))},t.prototype.ShowLiuJu=function(e){this._ui_liuju.Show(e)},t.prototype.CloseLiuJu=function(){this._ui_liuju.enable=!1},t.prototype.ShowGameEnd=function(){this._ui_gameend.show()},t.prototype.ShowWaitingRoom=function(){this._ui_waitingroom.show()},t.prototype.ShowErrorInfo=function(t){var i=new e.UI_ErrorInfo;this._error_root.addChild(i.me),Laya.timer.frameOnce(10,this,function(){i.showStr(t)})},t.prototype.showNetReqError=function(t,i,n){var a=new e.UI_ErrorInfo;this._error_root.addChild(a.me),Laya.timer.frameOnce(5,this,function(){a.showNetReqError(t,i,n)})},t.prototype.showFatalError=function(){var t=new e.UI_ErrorInfo;this._error_root.addChild(t.me),Laya.timer.frameOnce(5,this,function(){t.showFatalError()})},t.prototype.RefreshShow=function(){var e=Laya.stage.height/1080,t=.5*(Laya.stage.width-1920*e);this._root.scale(e,e),this._root.x=t},t.prototype.onUIDestory=function(e){var t=[];t.push(this._uis),t.push(this._lobby_uis),t.push(this._mj_uis),t.push(this._both_uis),t.push(this._common_uis);for(var i=0;i<t.length;i++)for(var n=0;n<t[i].length;n++){if(t[i][n]===e){t[i][n]=t[i][t[i].length-1],t.pop();break}}},t.prototype.AddLobbyUI=function(e){this._lobby_root.addChild(e.me),this._uis.push(e),this._lobby_uis.push(e)},t.prototype.AddMJUI=function(e){this._mj_root.addChild(e.me),this._uis.push(e),this._mj_uis.push(e)},t.prototype.AddBothUI=function(e){this._both_root.addChild(e.me),this._uis.push(e),this._both_uis.push(e)},t.prototype.AddCommonUI=function(e){this._common_root.addChild(e.me),this._uis.push(e),this._common_uis.push(e)},t.prototype.getWorldPosition=function(e,t){var i=new Laya.Point(e.x+t.x,e.y+t.y);if(e&&e!==this._root)for(e=e.parent;e&&e!==this._root;)i=e.toParentPoint(i),e=e.parent;return i.x/=1920,i.y/=1080,i},t.Inst=null,t}();e.UIMgr=t}(uiscript||(uiscript={}));var caps;!function(e){var t=function(){function e(){}return Object.defineProperty(e,"filename",{get:function(){return"shader_ranshao"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"attributeMap",{get:function(){return{a_BoneIndices:Laya.VertexElementUsage.BLENDINDICES0,a_BoneWeights:Laya.VertexElementUsage.BLENDWEIGHT0,a_Position:Laya.VertexElementUsage.POSITION0,a_Normal:Laya.VertexElementUsage.NORMAL0,a_Texcoord:Laya.VertexElementUsage.TEXTURECOORDINATE0}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"uniformMap",{get:function(){return{u_CameraPos:[Laya.BaseCamera.CAMERAPOS,Laya.Shader3D.PERIOD_CAMERA],u_MvpMatrix:[Laya.Sprite3D.MVPMATRIX,Laya.Shader3D.PERIOD_SPRITE],u_WorldMat:[Laya.Sprite3D.WORLDMATRIX,Laya.Shader3D.PERIOD_SPRITE],u_texture1:[this.TEXTURE1,Laya.Shader3D.PERIOD_MATERIAL],u_texture2:[this.TEXTURE2,Laya.Shader3D.PERIOD_MATERIAL],u_texture_mask:[this.TEXTURE_MASK,Laya.Shader3D.PERIOD_MATERIAL],u_alpha_clip:[this.ALPHA_CLIP,Laya.Shader3D.PERIOD_MATERIAL],"u_DirectionLight.Direction":[Laya.Scene.LIGHTDIRECTION,Laya.Shader3D.PERIOD_SCENE],"u_DirectionLight.Diffuse":[Laya.Scene.LIGHTDIRCOLOR,Laya.Shader3D.PERIOD_SCENE],u_bound:[this.BOUND,Laya.Shader3D.PERIOD_MATERIAL]}},enumerable:!0,configurable:!0}),e.TEXTURE1=1,e.TEXTURE2=2,e.TEXTURE_MASK=3,e.ALPHA_CLIP=4,e.BOUND=5,e}();e.Shader_RanShao=t}(caps||(caps={}));var caps;!function(e){var t=function(){function t(){this._init_state=0,this._items=[],this._loading_num=0}return t.filterString=function(e){for(var t="",i=0;i<e.length;){var n=e.indexOf("\r",i);if(-1==n){t+=e.substring(i,e.length);break}i<n&&(t+=e.substring(i,n)),i=n+1}return t},t.prototype.init=function(t){this._complete=t,2!=this._init_state?0==this._init_state&&(this._init_state=1,this._loading_num=0,this._init(e.Shader_RanShao.filename,e.Shader_RanShao.attributeMap,e.Shader_RanShao.uniformMap),this._init(e.Cartoon.filename,e.Cartoon.attributeMap,e.Cartoon.uniformMap),this._init(e.Outline.filename,e.Outline.attributeMap,e.Outline.uniformMap)):this._complete&&this._complete.run()},t.prototype._create_complete=function(e){this._loading_num--,0==this._loading_num&&(this._init_state=2,this._complete&&this._complete.run())},t.prototype._init=function(e,i,n){function a(){if(null!=s&&null!=h){var t=Laya.Shader3D.nameKey.add(e);Laya.ShaderCompile3D.add(t,h,s,i,n),o._create_complete(e)}}var r=this,o=this,s=null,h=null;this._loading_num++;var l="shader/"+e+"/"+e+".vs";Laya.loader.load(l,Laya.Handler.create(this,function(){Laya.timer.frameOnce(1,r,function(){h=t.filterString(Laya.loader.getRes(l)),a()})}));var c="shader/"+e+"/"+e+".ps";Laya.loader.load(c,Laya.Handler.create(this,function(){Laya.timer.frameOnce(1,r,function(){s=t.filterString(Laya.loader.getRes(c)),a()})}))},t}();e.ShaderInitor=t}(caps||(caps={}));var caps;!function(e){var t=function(){function e(){}return Object.defineProperty(e,"filename",{get:function(){return"outline"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"attributeMap",{get:function(){return{a_BoneIndices:Laya.VertexElementUsage.BLENDINDICES0,a_BoneWeights:Laya.VertexElementUsage.BLENDWEIGHT0,a_Position:Laya.VertexElementUsage.POSITION0,a_Normal:Laya.VertexElementUsage.NORMAL0,a_Texcoord:Laya.VertexElementUsage.TEXTURECOORDINATE0}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"uniformMap",{get:function(){return{u_Bones:[Laya.SkinnedMeshSprite3D.BONES,Laya.Shader3D.PERIOD_RENDERELEMENT],u_CameraPos:[Laya.BaseCamera.CAMERAPOS,Laya.Shader3D.PERIOD_CAMERA],u_MvpMatrix:[Laya.Sprite3D.MVPMATRIX,Laya.Shader3D.PERIOD_SPRITE],u_WorldMat:[Laya.Sprite3D.WORLDMATRIX,Laya.Shader3D.PERIOD_SPRITE],"u_SpotLight.Position":[Laya.Scene.SPOTLIGHTPOS,Laya.Shader3D.PERIOD_SCENE],"u_DirectionLight.Diffuse":[Laya.Scene.LIGHTDIRCOLOR,Laya.Shader3D.PERIOD_SCENE],u_outline:[this.OUTLINE,Laya.Shader3D.PERIOD_MATERIAL],u_outline_color:[this.OUTLINE_COLOR,Laya.Shader3D.PERIOD_MATERIAL]}},enumerable:!0,configurable:!0}),e.OUTLINE=1,e.OUTLINE_COLOR=2,e}();e.Outline=t}(caps||(caps={}));var caps;!function(e){var t=function(){function e(){}return Object.defineProperty(e,"filename",{get:function(){return"cartoon"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"attributeMap",{get:function(){return{a_BoneIndices:Laya.VertexElementUsage.BLENDINDICES0,a_BoneWeights:Laya.VertexElementUsage.BLENDWEIGHT0,a_Position:Laya.VertexElementUsage.POSITION0,a_Normal:Laya.VertexElementUsage.NORMAL0,a_Texcoord:Laya.VertexElementUsage.TEXTURECOORDINATE0}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"uniformMap",{get:function(){return{u_Bones:[Laya.SkinnedMeshSprite3D.BONES,Laya.Shader3D.PERIOD_RENDERELEMENT],u_CameraPos:[Laya.BaseCamera.CAMERAPOS,Laya.Shader3D.PERIOD_CAMERA],u_MvpMatrix:[Laya.Sprite3D.MVPMATRIX,Laya.Shader3D.PERIOD_SPRITE],u_WorldMat:[Laya.Sprite3D.WORLDMATRIX,Laya.Shader3D.PERIOD_SPRITE],u_texture:[this.TEXTURE,Laya.Shader3D.PERIOD_MATERIAL],"u_DirectionLight.Direction":[Laya.Scene.LIGHTDIRECTION,Laya.Shader3D.PERIOD_SCENE],"u_DirectionLight.Diffuse":[Laya.Scene.LIGHTDIRCOLOR,Laya.Shader3D.PERIOD_SCENE],u_split:[this.SPLIT,Laya.Shader3D.PERIOD_MATERIAL],u_color:[this.COLOR,Laya.Shader3D.PERIOD_MATERIAL],u_color_light:[this.COLOR_LIGHT,Laya.Shader3D.PERIOD_MATERIAL],u_color_unlight:[this.COLOR_UNLIGHT,Laya.Shader3D.PERIOD_MATERIAL]}},enumerable:!0,configurable:!0}),e.TEXTURE=1,e.COLOR=2,e.SPLIT=10,e.COLOR_LIGHT=30,e.COLOR_UNLIGHT=31,e}();e.Cartoon=t}(caps||(caps={}));var app;!function(e){var t=function(){function t(){}return Object.defineProperty(t,"lobby_ip",{get:function(){return this._lobby_ip},enumerable:!0,configurable:!0}),Object.defineProperty(t,"mj_ip",{get:function(){return this._mj_ip},enumerable:!0,configurable:!0}),Object.defineProperty(t,"lobby_network_delay",{get:function(){return this._socket_lobby?this._socket_lobby.getNetworkDelay():1e7},enumerable:!0,configurable:!0}),Object.defineProperty(t,"mj_network_delay",{get:function(){return this._socket_mj?this._socket_mj.getNetworkDelay():1e7},enumerable:!0,configurable:!0}),t.init=function(){this._socket_lobby=new net.Socket(["Lobby"],Laya.Handler.create(this,this.onReceiveMsgError,null,!1)),this._socket_mj=new net.Socket(["FastTest"],Laya.Handler.create(this,this.onReceiveMsgError,null,!1))},t.connect2Lobby=function(e,t){this._socket_lobby.addSocketLister(t),this._socket_lobby.connect((GameMgr.inHttps?"wss://":"ws://")+e),this._lobby_ip=e},t.sendMsg2Lobby=function(e,t){this._socket_lobby.sendMessage(".lq."+e,t)},t.isLobbyConnectOK=function(){return!!game.LobbyNetMgr.Inst&&game.LobbyNetMgr.Inst.connect_state==game.EConnectState.connecting},t.sendReq2Lobby=function(t,i,n,a){if(game.LobbyNetMgr.Inst){if(game.LobbyNetMgr.Inst.connect_state!=game.EConnectState.connecting){r="发送"+i+"时,";switch(game.LobbyNetMgr.Inst.connect_state){case game.EConnectState.none:r+="连接不存在";break;case game.EConnectState.tryconnect:r+="连接正在尝试";break;case game.EConnectState.reconnecting:r+="连接重试重连";break;case game.EConnectState.disconnect:r+="连接已断开"}return e.Log.log(r),uiscript.UIMgr.Inst&&(GameMgr.inRelease?uiscript.UIMgr.Inst.ShowErrorInfo("连接异常，请刷新重试"):uiscript.UIMgr.Inst.ShowErrorInfo(r)),!1}return this._socket_lobby.sendRequest(t,i,n,a),!0}var r="发送"+i+"时LobbyNetMgr不存在";return e.Log.log(r),uiscript.UIMgr.Inst&&!GameMgr.inRelease&&uiscript.UIMgr.Inst.ShowErrorInfo(r),!1},t.AddListener2Lobby=function(e,t){t.once=!1,this._socket_lobby.addMsgListener(".lq."+e,t)},t.RemoveListener2Lobby=function(e,t){this._socket_lobby.removeMsgListener(".lq."+e,t)},t.connect2MJ=function(e,t){this._socket_mj.addSocketLister(t),this._socket_mj.connect((GameMgr.inHttps?"wss://":"ws://")+e),this._mj_ip=e},t.sendMsg2MJ=function(e,t){this._socket_mj.sendMessage(".lq."+e,t)},t.isMJConnectOK=function(){return game.MJNetMgr.Inst&&game.MJNetMgr.Inst.connect_state==game.EConnectState.connecting},t.sendReq2MJ=function(t,i,n,a){if(game.MJNetMgr.Inst){if(game.MJNetMgr.Inst.connect_state!=game.EConnectState.connecting){r="发送"+i+"时,";switch(game.MJNetMgr.Inst.connect_state){case game.EConnectState.none:r+="连接不存在";break;case game.EConnectState.tryconnect:r+="连接正在尝试";break;case game.EConnectState.reconnecting:r+="连接重试重连";break;case game.EConnectState.disconnect:r+="连接已断开"}return e.Log.log(r),GameMgr.inRelease?"checkNetworkDelay"!=i&&uiscript.UIMgr.Inst.ShowErrorInfo("连接异常，请刷新重试"):uiscript.UIMgr.Inst.ShowErrorInfo(r),!1}return this._socket_mj.sendRequest(t,i,n,a),!0}var r="发送"+i+"时MJNetMgr不存在";return e.Log.log(r),uiscript.UIMgr.Inst&&!GameMgr.inRelease&&uiscript.UIMgr.Inst.ShowErrorInfo(r),!1},t.AddListener2MJ=function(e,t){t.once=!1,this._socket_mj.addMsgListener(".lq."+e,t)},t.Close2MJ=function(){this._socket_mj&&(this._socket_mj.close(),this._mj_ip="")},t.Close2Lobby=function(){e.Log.info_net("NetAgent Close2Lobby"),this._socket_lobby&&(this._socket_lobby.close(),this._lobby_ip="")},t.onReceiveMsgError=function(t){if(game.LobbyNetMgr.Inst.isOK){var i="";i+="acc:"+GameMgr.Inst.account_id,i+=",处理["+t.method+"]代码出错:{"+t.info+"}",i+=",deviceinfo:"+JSON.stringify(game.Tools.deviceInfo),e.NetAgent.sendReq2Lobby("Lobby","clientMessage",{timestamp:Math.floor(Date.now()/1e3),message:i},function(e,t){})}},t._lobby_ip="",t._mj_ip="",t._socket_lobby=null,t._socket_mj=null,t}();e.NetAgent=t}(app||(app={}));var net;!function(e){var t=function(){function t(t,i){var n=this;if(this.network_delay=0,this.byte_=new Laya.Byte,this.byte_.endian=Laya.Byte.LITTLE_ENDIAN,this.socket_=new Laya.Socket,this.socket_.endian=Laya.Byte.LITTLE_ENDIAN,this.messages_=[],this.workingMessage_=null,this.requestIndex_=0,this.requestClientHandle_=new e.RequestClientHandle(i,new Laya.Handler(this,function(e){n.network_delay=e})),this.handler_={},this.services_={},this.socket_.on(Laya.Event.OPEN,this,this._onOpen),this.socket_.on(Laya.Event.MESSAGE,this,this._onReceiveMsg),this.socket_.on(Laya.Event.CLOSE,this,this._onClose),this.socket_.on(Laya.Event.ERROR,this,this._onError),t)for(var a=0;a<t.length;a++)this._registerService(t[a])}return t.prototype.connect=function(e){this.socket_.connectByUrl(e)},Object.defineProperty(t.prototype,"connected",{get:function(){return this.socket_.connected},enumerable:!0,configurable:!0}),t.prototype._onOpen=function(e){void 0===e&&(e=null),app.Log.log("socket连接建立成功"),app.Log.info_net("socket open success"),this.when_socket_event&&this.when_socket_event.runWith(Laya.Event.OPEN)},t.prototype._onReceiveMsg=function(e){if(void 0===e&&(e=null),!e||0===e.length)return app.Log.Error("!data || data.length === 0"),void app.Log.info_net("error receive msg: !data || data.length === 0");app.Log.info_net("receive msg data.length:"+e.length),this.messages_.push(new Uint8Array(e)),this._checkMessage()},t.prototype._onClose=function(e){void 0===e&&(e=null),app.Log.log("socket关闭 e:"+e),app.Log.info_net("socket关闭 e:"+JSON.stringify(e)+", code:"+e.code+", reason:"+e.reason+", wasClean:"+e.wasClean),this.when_socket_event&&this.when_socket_event.runWith(Laya.Event.CLOSE)},t.prototype._onError=function(e){void 0===e&&(e=null),app.Log.log("socket错误 e:"+e),app.Log.info_net("socket错误 e:"+JSON.stringify(e)),this.when_socket_event&&this.when_socket_event.runWith(Laya.Event.ERROR)},t.prototype._checkMessage=function(){if(!this.workingMessage_&&0!==this.messages_.length)return this.workingMessage_=this.messages_.shift(),this._handleMsg(this.workingMessage_),this.workingMessage_=null,this._checkMessage()},t.prototype._handleMsg=function(t){var i={type:t[0]};switch(i.type){case e.HeaderType.REQUEST:case e.HeaderType.RESPONSE:if(t.length<3)throw new Error("ERR_INVALID_MESSAGE_LENGTH");i.reqIndex=t[1]+(t[2]<<8),t=t.slice(3);break;case e.HeaderType.NOTIFY:t=t.slice(1);break;default:return void console.error("net","unknown headerType: "+i.type)}switch(app.Log.info_net("socket _handleMsg0 header.type:"+i.type+", data.length:"+t.length),i.type){case e.HeaderType.REQUEST:throw new Error("ERR_CLIENT_UNABLE_TO_HANDLE_REQUEST");case e.HeaderType.RESPONSE:var n=e.MessageWrapper.decodeRpc(t);return this.requestClientHandle_.emitResponse(i.reqIndex,n.data);case e.HeaderType.NOTIFY:var a=e.MessageWrapper.decodeMessage(t),r=this.handler_[a.$type.fullName];if(app.Log.info_net("socket _handleMsg1 fullName:"+a.$type.fullName),!r)return void app.Log.Error("消息:"+a.$type.fullName+"未被监听");for(var o=0;o<r.length;o++)try{r[o].runWith(a)}catch(e){app.Log.Error("message "+a.$type.fullName+" handle error info:"+e),this.code_error_handler&&this.code_error_handler.runWith({method:a.$type.fullName,info:e})}return;default:return void console.error("net","unknown headerType: "+i.type)}},t.prototype._requestMessage=function(t,i,n){this.requestIndex_=(this.requestIndex_+1)%60007,app.Log.info_net("_requestMessage method:"+t+", index:"+this.requestIndex_),this._sendRpc(t,{header:{type:e.HeaderType.REQUEST,reqIndex:this.requestIndex_},packet:i}),this.requestClientHandle_.waitResponseCb(t,this.requestIndex_,n)},t.prototype._registerService=function(t){var i=this,n=e.ProtobufManager.lookupService("lq."+t);if(!n)throw new Error("ERR_SERVICE_NOT_FOUND, name="+t);var a=n.create(function(e,t,n){i._requestMessage(e.fullName,t,n)});this.services_[t]=a},t.prototype._sendMessage=function(t){if(!this.socket_)throw new Error("ERR_SOCKET_NOT_CONNECT");var i=e.MessageWrapper.encodeHeaderData(t.header),n=e.MessageWrapper.encodeMessage(t.packet),a=new Laya.Byte;a.writeArrayBuffer(i),a.writeArrayBuffer(n),this.socket_.send(a.buffer),app.Log.info_net("socket _sendMessage")},t.prototype._sendRpc=function(t,i){if(!this.socket_)throw new Error("ERR_SOCKET_NOT_CONNECT");var n=e.MessageWrapper.encodeHeaderData(i.header),a=e.MessageWrapper.encodeRpc(t,i.packet),r=new Laya.Byte;r.writeArrayBuffer(n),r.writeArrayBuffer(a),this.socket_.send(r.buffer),app.Log.info_net("socket _sendRpc")},t.prototype.sendMessage=function(t,i){app.Log.info_net("socket sendMessage msg_type:"+t);var n=e.ProtobufManager.lookupType(t);n?this._sendMessage({header:{type:e.HeaderType.NOTIFY},packet:n.create(i)}):app.Log.Error("sendMessage msg_type:"+t+"未找到")},t.prototype.sendRequest=function(e,t,i,n){app.Log.info_net("socket sendRequest service_name:"+e+", rpc_name:"+t);var a=this.services_[e];if(!a)throw new Error("ERR_SERVICE_NOT_FOUND, name=FastTest");a[t](i,n)},t.prototype.addMsgListener=function(e,t){this.handler_[e]||(this.handler_[e]=[]),this.handler_[e].push(t)},t.prototype.removeMsgListener=function(e,t){if(this.handler_[e]){for(var i=this.handler_[e],n=[],a=0;a<i.length;a++)i[a]!==t&&n.push(t);this.handler_[e]=n}},t.prototype.addSocketLister=function(e){this.when_socket_event=e},t.prototype.close=function(){app.Log.info_net("socket close"),this.socket_&&this.socket_.close()},t.prototype.getNetworkDelay=function(){return this.network_delay},t}();e.Socket=t}(net||(net={}));var net;!function(e){var t=function(){return function(){}}();e.WaitingEvent=t;var i=function(){function e(e,t){this._delay=0,this.waitingData={},this.checkArray=[],this.delayLst=[],this._responseErrorHandler=e,this._networkDelayHandler=t,Laya.timer.loop(500,this,this.loop)}return e.prototype.emitResponse=function(e,t){var i=this.waitingData[e];if(app.Log.info_net("emitResponse index:"+e+", waitingEvent:"+(null==i)),i){var n=Date.now();this.delayLst.push({timestamp:n,delay:n-i.requestTime}),this.waitingData[e]=null;try{i.cb(null,t)}catch(e){app.Log.Error("net request handle error:"+e),this._responseErrorHandler&&this._responseErrorHandler.runWith({method:i.method,info:e})}}},e.prototype.waitResponseCb=function(e,t,i){var n={method:e,index:t,requestTime:Date.now(),cb:i};this.waitingData[t]=n,this.checkArray.push({timeout:n.requestTime+25e4,index:n.index})},e.prototype.loop=function(){var e=this.calcu_preresponse_delay(),t=this.check_waiting_response(),i=0,n=0;e>=0&&(i+=.3*e,n+=.3),t>=0&&(i+=t,n+=1),n>0&&(i/=n,this._delay=i),this._networkDelayHandler&&this._networkDelayHandler.runWith(this._delay)},e.prototype.calcu_preresponse_delay=function(){for(var e=Date.now(),t=0,i=0,n=0,a=0;a<this.delayLst.length;a++)this.delayLst[a].timestamp+2e3<e?n++:(t+=this.delayLst[a].delay,i++);return n>0&&(n==this.delayLst.length?this.delayLst=[]:this.delayLst.slice(n)),i>0?t/i:-1},e.prototype.check_waiting_response=function(){for(var e=Date.now(),t=0,i=-1,n=0;n<this.checkArray.length;n++){var a=this.checkArray[n];if(this.waitingData[a.index]){if(e<a.timeout){i<0&&(i=e-this.waitingData[a.index].requestTime);break}t+=1;var r=this.waitingData[a.index];this.waitingData[a.index]=null,i=5e3,this.delayLst.push({delay:1e4,timestamp:e}),r.cb(new Error("TIMEOUT"))}else t+=1}return t>0&&(t==this.checkArray.length?this.checkArray=[]:this.checkArray=this.checkArray.slice(t)),i},e}();e.RequestClientHandle=i}(net||(net={}));var net;!function(e){var t=function(){function e(){}return e.loadProto=function(e){this.root=protobuf.Root.fromJSON(e),this.root.resolveAll(),console.log("loadProto finished")},e.lookup=function(e,t){return this.root.lookup(e,t)},e.lookupType=function(e){return this.root.lookupType(e)},e.lookupEnum=function(e){return this.root.lookupEnum(e)},e.lookupTypeOrEnum=function(e){return this.root.lookupTypeOrEnum(e)},e.lookupService=function(e){return this.root.lookupService(e)},e.lookupMethod=function(e){if("string"==typeof e&&(e=e.split(".")),0===e.length)return null;var t=this.lookupService(e.slice(0,-1));if(!t)return null;var i=e[e.length-1];return t.methods[i]},e}();e.ProtobufManager=t}(net||(net={}));var net;!function(e){var t;!function(e){e[e.NULL=0]="NULL",e[e.NOTIFY=1]="NOTIFY",e[e.REQUEST=2]="REQUEST",e[e.RESPONSE=3]="RESPONSE"}(t=e.HeaderType||(e.HeaderType={}));var i=function(){return function(){}}();e.HeaderData=i;var n=function(){function i(){}return i.initWrapper=function(){this.WrapperCtor=e.ProtobufManager.lookupType("lq.Wrapper"),console.log("Wrapper is "+JSON.stringify(this.WrapperCtor))},i.encodeHeaderData=function(e){switch(e.type){case t.REQUEST:case t.RESPONSE:return Uint8Array.from([e.type,255&e.reqIndex,e.reqIndex>>8]);case t.NOTIFY:return Uint8Array.from([e.type])}return Uint8Array.from([])},i.encodeMessage=function(e){var t=e.$type;return this.wrap(t.fullName,t.encode(e).finish())},i.decodeMessage=function(e){var t=this.unwrap(e);return this.decode(t.name,t.data)},i.encodeRpc=function(e,t){return this.wrap(e,t)},i.decodeRpc=function(e){return this.unwrap(e)},i.wrap=function(e,t){var i=this.WrapperCtor,n=i.create({name:e,data:t});return i.encode(n).finish()},i.unwrap=function(e){return i.WrapperCtor.decode(e)},i.decode=function(t,i){var n=e.ProtobufManager.lookupType(t);if(!n)throw new Error("ERR_CANNOT_FIND_MESSAGE_TYPE, "+t);return n.decode(i)},i}();e.MessageWrapper=n}(net||(net={}));var app;!function(e){var t=function(){function e(){}return e._getDate=function(){var e=new Date;return e.getFullYear()+"/"+(e.getMonth()+1)+"/"+e.getDate()+" "+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()+"."+e.getMilliseconds()},e._insertCacheLog=function(e){this._cache_logs.length<30?this._cache_logs.push(e):this._cache_logs[this._ceche_index++]=e},e.log=function(e){var t="["+this._getDate()+" f:"+Laya.timer.currFrame+"]log: "+e;GameMgr.inRelease||console.log(t),this._insertCacheLog(t)},e.info=function(e){var t="["+this._getDate()+" f:"+Laya.timer.currFrame+"]info: "+e;GameMgr.inRelease||console.info(t),this._insertCacheLog(t)},e.Error=function(e){var t="["+this._getDate()+" f:"+Laya.timer.currFrame+"]error: "+e;GameMgr.inRelease||console.error(t),this._insertCacheLog(t)},e.info_net=function(e){var t="["+this._getDate()+" f:"+Laya.timer.currFrame+"]info_net: "+e;GameMgr.inRelease||console.info(t)},e.getCacheLog=function(){if(0==this._cache_logs.length)return"nolog";for(var e="",t=0;t<this._cache_logs.length;t++){var i=(this._ceche_index+t)%this._cache_logs.length;0!=t&&(e+="\n"),e+=this._cache_logs[i]}return e},e.getFunctionName=function(e){if("function"==typeof e||"object"==typeof e)var t=(""+e).match(/function\s*([\w\$]*)\s*\(/);return t&&t[1]},e.trace=function(){for(var e="",t=arguments.callee.caller,i=10;t&&i>0;)""!=e&&(e+="\n"),e+=t.toString(),t=t.caller,i--;return e},e._cache_logs=[],e._ceche_index=0,e}();e.Log=t}(app||(app={}));var view;!function(e){var t=function(){function t(e,t){this.val=null,this.model=null,this.ismoqie=!1,this.ispaopai=!1,this.isDora=!1,this.val=e,this.model=t,this.isDora=!1,this.RefreshDora()}return t.prototype.ShowUp=function(){this.model.transform.localRotation=new Laya.Quaternion(.7,0,0,.7)},t.prototype.ShowBack=function(){this.model.transform.localRotation=new Laya.Quaternion(0,-.7,-.7,0)},t.prototype.ShowRot=function(){this.model.transform.localRotation=new Laya.Quaternion(.5,-.5,.5,.5)},t.prototype.RefreshDora=function(){if(e.DesktopMgr.bianjietishi&&!this.isDora){if(this.val.dora&&(this.isDora=!0),!this.isDora)for(var t=0;t<e.DesktopMgr.Inst.dora.length;t++)if(mjcore.MJPai.DoraMet(this.val,e.DesktopMgr.Inst.dora[t])){this.isDora=!0;break}if(this.isDora){var i=e.DesktopMgr.Inst.effect_dora3D.clone();this.model.addChild(i),i.transform.localPosition=new Laya.Vector3(0,0,0),i.transform.localScale=new Laya.Vector3(1,1,1),i.transform.localRotationEuler=new Laya.Vector3(0,0,0),i.active=!0;i.getChildAt(0).addComponent(anim.RunUV)}}},t.prototype.OnChoosedPai=function(){if(e.DesktopMgr.bianjietishi){var t=e.DesktopMgr.Inst.choosed_pai;null==t||0!=mjcore.MJPai.Distance(this.val,t)?this.ispaopai?this.model.meshRender.sharedMaterial.setColor(caps.Cartoon.COLOR,new Laya.Vector4(1,.78,.78,1)):this.ismoqie?this.model.meshRender.sharedMaterial.setColor(caps.Cartoon.COLOR,new Laya.Vector4(.8,.8,.8,1)):this.model.meshRender.sharedMaterial.setColor(caps.Cartoon.COLOR,new Laya.Vector4(1,1,1,1)):this.model.meshRender.sharedMaterial.setColor(caps.Cartoon.COLOR,new Laya.Vector4(.615,.827,.976,1))}else this.model.meshRender.sharedMaterial.setColor(caps.Cartoon.COLOR,new Laya.Vector4(1,1,1,1))},t}();e.ViewPai=t}(view||(view={}));var view;!function(e){var t=function(){function t(t){this.val=null,this.model=null,this.contianer_pai=null,this.pai3D=null,this.shadow=null,this._starttime=0,this._lifetime=150,this._index=0,this._isnew=!1,this.model=new Laya.Sprite3D,t.addChild(this.model),this.model.transform.localPosition=new Laya.Vector3(0,.5*-e.PAIMODEL_HEIGHT,0),this.model.transform.localRotationEuler=new Laya.Vector3(0,0,0),this.model.transform.localScale=new Laya.Vector3(1,1,1),this.model.active=!0,this.contianer_pai=new Laya.Sprite3D,this.model.addChild(this.contianer_pai),this.contianer_pai.transform.localPosition=new Laya.Vector3(0,0,0),this.contianer_pai.transform.localRotationEuler=new Laya.Vector3(0,0,0),this.contianer_pai.transform.localScale=new Laya.Vector3(1,1,1),this.contianer_pai.active=!0,this.shadow=e.DesktopMgr.Inst.effect_shadow.clone(),this.model.addChild(this.shadow),this.shadow.transform.localPosition=new Laya.Vector3(0,0,0),this.shadow.transform.localScale=new Laya.Vector3(1,1,1),this.shadow.transform.localRotationEuler=new Laya.Vector3(0,0,0),this.shadow.active=!0}return t.prototype.SetVal=function(t){try{null!=this.pai3D&&(this.pai3D.model.destroy(),this.pai3D=null),this.val=t,this.pai3D=new e.ViewPai(t,e.DesktopMgr.Inst.CreatePai3D(t)),this.contianer_pai.addChild(this.pai3D.model),this.pai3D.model.transform.localPosition=new Laya.Vector3(0,0,0),this.pai3D.model.transform.localScale=new Laya.Vector3(1,1,1),this.pai3D.model.transform.localRotationEuler=new Laya.Vector3(0,180,0),this.pai3D.model.active=!0}catch(e){var i={};i.error=e.message,i.stack=e.stack,i.method="HandPai3D",i.name="SetVal";var n="";this.pai3D&&(n+="pai3D",this.pai3D.model&&(n+=" model",this.pai3D.model.transform&&(n+=" transform"))),this.contianer_pai&&(n+=" contianer_pai"),i.iinfo=n,GameMgr.Inst.onFatalError(i)}},t.prototype.SetIndex=function(t,i){this.model?this.model.destroyed?app.Log.Error("SetIndex index:"+t+" model已经被删除"):this.model.transform||app.Log.Error("SetIndex index:"+t+" model.transform不存在"):app.Log.Error("SetIndex index:"+t+" model不存在"),this._isnew=i,this._index=t,this.model.transform.localPosition=new Laya.Vector3(-e.PAIMODEL_WIDTH*(t+(i?.5:0))*1.01,.5*-e.PAIMODEL_HEIGHT,0)},t.prototype.Stand=function(){this.contianer_pai.transform.localPosition=new Laya.Vector3(0,0,0),this.contianer_pai.transform.localRotationEuler=new Laya.Vector3(0,0,0),this.pai3D.model.transform.localPosition=new Laya.Vector3(0,.5*e.PAIMODEL_HEIGHT,0),this.shadow.transform.localScale=new Laya.Vector3(.53*e.PAIMODEL_WIDTH,1,.53*e.PAIMODEL_THICKNESS),this.shadow.transform.localPosition=new Laya.Vector3(0,0,0),this.shadow.active=!0},t.prototype.FullDown=function(){this.contianer_pai.transform.localPosition=new Laya.Vector3(0,0,.5*e.PAIMODEL_THICKNESS),this.contianer_pai.transform.localRotationEuler=new Laya.Vector3(90,0,0),this.pai3D.model.transform.localPosition=new Laya.Vector3(0,.5*e.PAIMODEL_HEIGHT,.5*-e.PAIMODEL_THICKNESS),this.shadow.transform.localScale=new Laya.Vector3(.53*e.PAIMODEL_WIDTH,1,.53*e.PAIMODEL_HEIGHT),this.shadow.transform.localPosition=new Laya.Vector3(0,0,.5*(e.PAIMODEL_HEIGHT+e.PAIMODEL_THICKNESS)),this.shadow.active=!0},t.prototype.Cover=function(){this.contianer_pai.transform.localPosition=new Laya.Vector3(0,0,.5*-e.PAIMODEL_THICKNESS),this.contianer_pai.transform.localRotationEuler=new Laya.Vector3(-90,0,0),this.pai3D.model.transform.localPosition=new Laya.Vector3(0,.5*e.PAIMODEL_HEIGHT,.5*e.PAIMODEL_THICKNESS),this.shadow.transform.localScale=new Laya.Vector3(.53*e.PAIMODEL_WIDTH,1,.53*e.PAIMODEL_HEIGHT),this.shadow.transform.localPosition=new Laya.Vector3(0,0,.5*-(e.PAIMODEL_HEIGHT+e.PAIMODEL_THICKNESS)),this.shadow.active=!0},t.prototype.DoAnim_FullDown=function(){var e=this;this.FullDown(),this._lifetime=120,this._starttime=Laya.timer.currTimer,this.contianer_pai.transform.localRotationEuler=new Laya.Vector3(0,0,0),this.shadow.active=!1,Laya.timer.clearAll(this),Laya.timer.frameLoop(1,this,function(){var t=Laya.timer.currTimer-e._starttime;if(t>=e._lifetime)e.FullDown(),Laya.timer.clearAll(e);else{var i=t/e._lifetime;e.contianer_pai.transform.localRotationEuler=new Laya.Vector3(90*i*i,0,0)}})},t.prototype.DoAnim_Cover=function(){var e=this;this.Cover(),this._lifetime=120,this._starttime=Laya.timer.currTimer,this.contianer_pai.transform.localRotationEuler=new Laya.Vector3(0,0,0),this.shadow.active=!1,Laya.timer.clearAll(this),Laya.timer.frameLoop(1,this,function(){var t=Laya.timer.currTimer-e._starttime;if(t>=e._lifetime)e.Cover(),Laya.timer.clearAll(e);else{var i=t/e._lifetime;e.contianer_pai.transform.localRotationEuler=new Laya.Vector3(-90*i*i,0,0)}})},t.prototype.DoAnim_Stand=function(){var e=this;this.Cover(),this._lifetime=150,this._starttime=Laya.timer.currTimer,this.shadow.active=!1,Laya.timer.clearAll(this),Laya.timer.frameLoop(1,this,function(){var t=Laya.timer.currTimer-e._starttime-300;if(t>=e._lifetime)e.Stand(),Laya.timer.clearAll(e);else if(t>=0){var i=t/e._lifetime;e.contianer_pai.transform.localRotationEuler=new Laya.Vector3(90*i-90,0,0)}})},t.prototype.Destory=function(){null!=this.contianer_pai&&(Laya.timer.clearAll(this),this.contianer_pai.destroy(!0),this.pai3D.model.destroy(!0),this.shadow.destroy(!0),this.model.destroy(!0),this.contianer_pai=null,this.pai3D=null)},t}();e.HandPai3D=t}(view||(view={}));var view;!function(e){var t=function(){function t(t,i){this.player=null,this.origin=null,this.pais=null,this.cx=0,this.cy=0,this.x_count=0,this.last_pai=null,this.last_is_liqi=!1,this.after_liqi=!1,this.waiting_offset=new Laya.Vector2(.4*e.PAIMODEL_WIDTH,.4*e.PAIMODEL_HEIGHT),this.xwidth=0,this.origin=t,this.pais=new Array,this.player=i}return t.prototype.AddQiPai=function(t,i,n,a){var r=this;void 0===a&&(a=!0),this.QiPaiPass();var o=new e.ViewPai(t,e.DesktopMgr.Inst.CreatePai3D(t));e.DesktopMgr.Inst.showingPaopai&&(o.ismoqie=n,o.ispaopai=e.DesktopMgr.Inst.isPaoPai(o.val)),o.OnChoosedPai(),this.origin.parent.addChild(o.model),this.last_is_liqi&&!i&&(i=!0);var s=Math.atan(e.PAIMODEL_HEIGHT/e.PAIMODEL_WIDTH),h=2*(Math.random()-.5)*2,l=0,c=0;i?(o.model.transform.localRotationEuler=new Laya.Vector3(90,90+h,0),c=((l=Math.sqrt(e.PAIMODEL_HEIGHT*e.PAIMODEL_HEIGHT+e.PAIMODEL_WIDTH*e.PAIMODEL_WIDTH)/2*Math.cos(1.5707963-s-3.1415926*Math.abs(h)/180)*2+.01*e.PAIMODEL_WIDTH)-e.PAIMODEL_WIDTH)/2):(o.model.transform.localRotationEuler=new Laya.Vector3(90,h,0),c=((l=Math.sqrt(e.PAIMODEL_HEIGHT*e.PAIMODEL_HEIGHT+e.PAIMODEL_WIDTH*e.PAIMODEL_WIDTH)/2*Math.cos(s-3.1415926*Math.abs(h)/180)*2+.01*e.PAIMODEL_WIDTH)-e.PAIMODEL_WIDTH)/2);var p=0,u=0,d=this.cx+c,_=this.cy;if(Math.random()<.2&&(l+=p=Math.random()*e.PAIMODEL_WIDTH*.025,d+=p),this.xwidth=l,u=2*(Math.random()-.5)*e.PAIMODEL_HEIGHT*.025,_+=u,o.model.transform.localPosition=this.origin.transform.localPosition.clone(),o.model.active=!0,o.model.transform.localPosition.x+=d,o.model.transform.localPosition.z-=_,a){var m=o.model.transform.position.clone();this.player.hand3d.transform.position=m.clone();this.player.hand3d.getChildByName("Dum_Majiang").getChildByName("node").addChild(o.model),o.model.transform.localPosition=new Laya.Vector3(0,0,0),o.model.transform.localRotationEuler=new Laya.Vector3(0,-180,-((i?90:0)+h)),o.model.transform.localPosition.x+=0,o.model.transform.localPosition.z-=0;var f="",g=0,y=0,v=0,x=0;if(i){var b=e.DesktopMgr.Inst.player_effects[this.player.seat].effect_liqi;if(b&&""!=b){f="LiQiPai";v=1700/(g=2)*.77,x=1700/g*.95;var w=y=1700/g*.325;Laya.timer.once(w,this,function(){var e=game.EffectMgr.create_d3_effect(b);r.origin.parent.addChild(e),Laya.timer.frameLoop(1,e,function(){o&&o.model&&!o.model.destroyed?(e.transform.position=o.model.transform.position.clone(),e.transform.rotation=o.model.transform.rotation.clone(),e.transform.scale=o.model.transform.scale.clone()):e.active=!1}),Laya.timer.once(1200,r,function(){Laya.timer.clearAll(e),e.destroy(!0)})})}else f="Dapai",g=.94,v=y=319,x=496}else f="Dapai",g=.94,v=y=319,x=496;this.player.playHandAnimtion(f,g,x),Laya.timer.once(y,this,function(){e.AudioMgr.PlayAudio(207)}),Laya.timer.once(v,this,function(){o&&o.model&&!o.model.destroyed&&(r.origin.parent.addChild(o.model),o.model.transform.localRotationEuler=i?new Laya.Vector3(90,90+h,0):new Laya.Vector3(90,h,0),r.last_pai.model.transform.localPosition=r.origin.transform.localPosition.clone(),r.last_pai.model.transform.localPosition.x+=d,r.last_pai.model.transform.localPosition.z-=_)})}this.last_pai=o,this.last_is_liqi=i,e.DesktopMgr.Inst.SetLastQiPai(this.player.seat,o);var S=e.DesktopMgr.Inst.effect_shadow.clone();o.model.addChild(S),S.transform.localPosition=new Laya.Vector3(0,0,.5*-e.PAIMODEL_THICKNESS),S.transform.localScale=new Laya.Vector3(.53*e.PAIMODEL_WIDTH,1,.53*e.PAIMODEL_HEIGHT),S.transform.localRotationEuler=new Laya.Vector3(90,0,0),S.active=!0},t.prototype.QiPaiPass=function(){null!=this.last_pai&&(this.pais.push(this.last_pai),this.x_count++,6==this.x_count&&this.pais.length<=12?(this.cx=0,this.cy+=1.05*e.PAIMODEL_HEIGHT,this.x_count=0):this.cx+=this.xwidth,this.last_pai=null,this.last_is_liqi=!1)},t.prototype.QiPaiNoPass=function(){this.last_pai&&this.last_pai.model.destroy(),this.last_pai=null},t.prototype.Reset=function(){if(this.pais.length>0){for(var e=0;e<this.pais.length;e++)this.pais[e].model.destroy();this.pais=new Array}this.cx=this.cy=0,this.x_count=0,null!=this.last_pai&&this.last_pai.model.destroy(),this.last_pai=null,this.last_is_liqi=!1,this.after_liqi=!1,Laya.timer.clearAll(this)},t.prototype.OnDoraRefresh=function(){if(null!=this.last_pai&&this.last_pai.RefreshDora(),null!=this.pais)for(var e=0;e<this.pais.length;e++)this.pais[e].RefreshDora()},t.prototype.OnChoosedPai=function(){if(null!=this.last_pai&&this.last_pai.OnChoosedPai(),null!=this.pais)for(var e=0;e<this.pais.length;e++)this.pais[e].OnChoosedPai()},t}();e.Block_QiPai=t}(view||(view={}));var view;!function(e){var t=function(){function t(e,t){this.origin=null,this.player=null,this.xOffset=0,this.mings=new Array,this.pais=new Array,this.hengs=new Array,this.origin=e,this.xOffset=0,this.player=t}return Object.defineProperty(t.prototype,"seat",{get:function(){return this.player.seat},enumerable:!0,configurable:!0}),t.prototype.Reset=function(){if(Laya.timer.clearAll(this),this.pais.length>0){for(var e=0;e<this.pais.length;e++)this.pais[e].model.destroy();this.pais=[]}this.mings=[],this.hengs=[],this.xOffset=0},t.prototype.Snapshot=function(e){this.Reset();for(var t=0;t<e.length;t++)this.AddMing(e[t],!1)},t.prototype.AddMing=function(t,i){var n=this;void 0===i&&(i=!0);try{this.mings.push(t);for(var a=0,r=new Array,o=0;o<t.pais.length;o++){r.push(new e.ViewPai(t.pais[o],e.DesktopMgr.Inst.CreatePai3D(t.pais[o]))),this.pais.push(r[o]),e.DesktopMgr.Inst.showingPaopai&&(r[o].ispaopai=e.DesktopMgr.Inst.isPaoPai(r[o].val)),r[o].OnChoosedPai();var s=e.DesktopMgr.Inst.effect_shadow.clone();r[o].model.addChild(s),s.transform.localPosition=new Laya.Vector3(0,0,.5*-e.PAIMODEL_THICKNESS),s.transform.localScale=new Laya.Vector3(.53*e.PAIMODEL_WIDTH,1,.53*e.PAIMODEL_HEIGHT),s.transform.localRotationEuler=new Laya.Vector3(90,0,0),s.active=!0}var h=0;if(t.type==mjcore.E_Ming.shunzi){for(var l=new Array,c=-1,o=0;o<3;o++)t.from[o]!=this.seat?c=o:l.push(o);l=l.sort(function(e,i){return-mjcore.MJPai.Distance(t.pais[e],t.pais[i])}),-1!=c&&l.push(c),h=l[0];for(o=0;o<3;o++)p=l[o];for(o=0;o<3;o++){var p=l[o],u=r[p];this.origin.parent.addChild(u.model),u.model.transform.localPosition=this.origin.transform.localPosition.clone(),t.from[p]!=this.seat?(this.xOffset+=.5*e.PAIMODEL_HEIGHT*1.02,u.ShowRot(),u.model.transform.localPosition.x-=this.xOffset,u.model.transform.localPosition.z-=.5*(e.PAIMODEL_HEIGHT-e.PAIMODEL_WIDTH),a=this.xOffset,this.xOffset+=.5*e.PAIMODEL_HEIGHT*1.02):(this.xOffset+=.5*e.PAIMODEL_WIDTH*1.02,u.ShowUp(),u.model.transform.localPosition.x-=this.xOffset,this.xOffset+=.5*e.PAIMODEL_WIDTH*1.02)}}else if(t.type==mjcore.E_Ming.kezi||t.type==mjcore.E_Ming.gang_ming){for(var l=new Array,o=0;o<t.pais.length;o++)l.push(o);for(o=0;o<t.pais.length;o++)if(t.from[o]!=this.seat){var d=0;switch((t.from[o]-this.seat+4)%4){case 1:d=0;break;case 2:d=t.pais.length-2;break;case 3:d=t.pais.length-1}var _=l[o];l[o]=l[d],l[d]=_;break}h=l[0];for(o=0;o<t.pais.length;o++){var p=l[o],u=r[p];this.origin.parent.addChild(u.model),u.model.transform.localPosition=this.origin.transform.localPosition.clone(),t.from[p]!=this.seat?(this.xOffset+=.5*e.PAIMODEL_HEIGHT*1.02,u.ShowRot(),u.model.transform.localPosition.x-=this.xOffset,u.model.transform.localPosition.z-=.5*(e.PAIMODEL_HEIGHT-e.PAIMODEL_WIDTH)*1.02,a=this.xOffset,this.xOffset+=.5*e.PAIMODEL_HEIGHT*1.02):(this.xOffset+=.5*e.PAIMODEL_WIDTH*1.02,u.model.transform.localPosition.x-=this.xOffset,u.ShowUp(),this.xOffset+=.5*e.PAIMODEL_WIDTH*1.02)}}else{h=0;for(o=0;o<4;o++){u=r[p=o];1==o&&e.DesktopMgr.Inst.SetLastQiPai(this.player.seat,u),this.origin.parent.addChild(u.model),u.model.transform.localPosition=this.origin.transform.localPosition.clone(),1==o||2==o?(this.xOffset+=.5*e.PAIMODEL_WIDTH*1.02,u.ShowUp(),u.model.transform.localPosition.x-=this.xOffset,a=this.xOffset,this.xOffset+=.5*e.PAIMODEL_WIDTH*1.02):(this.xOffset+=.5*e.PAIMODEL_WIDTH*1.02,u.model.transform.localPosition.x-=this.xOffset,u.ShowBack(),this.xOffset+=.5*e.PAIMODEL_WIDTH*1.02)}}if(this.hengs.push(a),i){e.AudioMgr.PlayAudio(209);var m=new Laya.Sprite3D;this.origin.parent.addChild(m),m.transform.localPosition=r[h].model.transform.localPosition.clone(),m.transform.localRotation=new Laya.Quaternion(0,0,0,0),m.transform.localScale=new Laya.Vector3(1,1,1);for(var f=[],g=r[h].model.transform.localPosition.clone(),o=0;o<r.length;o++){var y=r[o].model.transform.localPosition.clone();f.push(new Laya.Vector3(y.x-g.x,y.y-g.y,y.z-g.z))}for(o=0;o<r.length;o++)m.addChild(r[o].model),r[o].model.transform.localPosition=f[o].clone();var v=m.transform.position.clone();this.player.hand3d.transform.position=v.clone();this.player.hand3d.getChildByName("Dum_Majiang").getChildByName("node2").addChild(m),m.transform.localPosition=new Laya.Vector3(0,0,0),m.transform.localRotation=new Laya.Quaternion(0,0,0,0),this.player.playHandAnimtion("Fulu",2,450),Laya.timer.once(366.5,this,function(){try{n.origin.parent.addChild(m),m.transform.position=v;for(var e=0;e<r.length;e++){n.origin.parent.addChild(r[e].model);var i=r[e].model.transform.localPosition.clone();i.x+=g.x,i.y+=g.y,i.z+=g.z,r[e].model.transform.localPosition=i}m.destroy()}catch(e){var a={};a.error=e.message,a.stack=e.stack,a.method="AddMing2",a.ming=t.toString(),a.class="Block_Ming",GameMgr.Inst.onFatalError(a)}}),m.active=!1,Laya.timer.once(75,this,function(){m.active=!0}),Laya.timer.once(33,this,function(){try{if(null==m||m.destroyed)return;var i=game.EffectMgr.create_d3_effect("scene/effect_chipeng.lh");e.DesktopMgr.Inst.trans_container_effect.parent.addChild(i);var a=m.transform.position.clone();a.x-=.04,i.transform.position=a,i.active=!0,Laya.timer.once(1e3,n,function(){i&&i.destroy()})}catch(e){var r={};r.error=e.message,r.stack=e.stack,r.method="AddMing4",r.ming=t.toString(),r.class="Block_Ming",GameMgr.Inst.onFatalError(r)}})}}catch(e){var x={};x.error=e.message,x.stack=e.stack,x.method="AddMing",x.ming=t.toString(),x.class="Block_Ming",GameMgr.Inst.onFatalError(x)}},t.prototype.AddGang=function(t,i){var n=this;void 0===i&&(i=!0);for(var a=function(a){if(r.mings[a].type==mjcore.E_Ming.kezi&&0==mjcore.MJPai.Distance(r.mings[a].pais[0],t)){r.mings[a].type=mjcore.E_Ming.gang_ming,r.mings[a].pais.push(t.Clone()),r.mings[a].from.push(r.player.seat);var o=new e.ViewPai(t,e.DesktopMgr.Inst.CreatePai3D(t));r.origin.parent.addChild(o.model),o.model.transform.localPosition=r.origin.transform.localPosition.clone(),o.ShowRot(),o.model.transform.localPosition.x-=r.hengs[a],o.model.transform.localPosition.z=o.model.transform.localPosition.z-.5*(e.PAIMODEL_HEIGHT-e.PAIMODEL_WIDTH)*1.02+1.02*e.PAIMODEL_WIDTH,e.DesktopMgr.Inst.SetLastQiPai(r.player.seat,o),r.pais.push(o),e.DesktopMgr.Inst.showingPaopai&&(o.ispaopai=e.DesktopMgr.Inst.isPaoPai(o.val)),o.OnChoosedPai();var s=e.DesktopMgr.Inst.effect_shadow.clone();if(o.model.addChild(s),s.transform.localPosition=new Laya.Vector3(0,0,.5*-e.PAIMODEL_THICKNESS),s.transform.localScale=new Laya.Vector3(.53*e.PAIMODEL_WIDTH,1,.53*e.PAIMODEL_HEIGHT),s.transform.localRotationEuler=new Laya.Vector3(90,0,0),s.active=!0,i){e.AudioMgr.PlayAudio(209);var h=new Laya.Sprite3D;r.origin.parent.addChild(h),h.transform.localPosition=o.model.transform.localPosition.clone(),h.transform.localRotation=new Laya.Quaternion(0,0,0,0),h.transform.localScale=new Laya.Vector3(1,1,1);var l=o.model.transform.localPosition.clone();h.addChild(o.model),o.model.transform.localPosition=new Laya.Vector3(0,0,0);var c=h.transform.position.clone();r.player.hand3d.transform.position=c.clone();r.player.hand3d.getChildByName("Dum_Majiang").getChildByName("node2").addChild(h),h.transform.localPosition=new Laya.Vector3(0,0,0),h.transform.localRotation=new Laya.Quaternion(0,0,0,0),r.player.playHandAnimtion("Fulu",2,450),Laya.timer.once(366.5,r,function(){n.origin.parent.addChild(h),h.transform.position=c,n.origin.parent.addChild(o.model),o.model.transform.localPosition=l,e.DesktopMgr.Inst.lastqipai===o&&e.DesktopMgr.Inst.effect_pai_canchi.active&&e.DesktopMgr.Inst.ShowChiPengEffect(),h.destroy()}),h.active=!1,Laya.timer.once(75,r,function(){h.active=!0}),Laya.timer.once(33,r,function(){if(null!=h&&!h.destroyed){var t=game.EffectMgr.create_d3_effect("scene/effect_chipeng.lh");e.DesktopMgr.Inst.trans_container_effect.parent.addChild(t);var i=h.transform.position.clone();i.x-=.04,t.transform.position=i,t.active=!0,Laya.timer.once(1e3,n,function(){t.destroy()})}})}return"break"}},r=this,o=0;o<this.mings.length;o++){if("break"===a(o))break}},t.prototype.OnDoraRefresh=function(){if(null!=this.pais)for(var e=0;e<this.pais.length;e++)this.pais[e].RefreshDora()},t.prototype.OnChoosedPai=function(){if(null!=this.pais)for(var e=0;e<this.pais.length;e++)this.pais[e].OnChoosedPai()},t}();e.Block_Ming=t}(view||(view={}));var view;!function(e){var t;!function(e){e[e.none=0]="none",e[e.start=1]="start",e[e.during=2]="during",e[e.end=3]="end"}(t||(t={}));var i=function(){function e(){}return Object.defineProperty(e,"suffix",{get:function(){return Laya.Browser.window.conch?".ogg":".mp3"},enumerable:!0,configurable:!0}),e.init=function(){GameMgr.iniOSWebview?Laya.SoundManager.autoStopMusic=!0:Laya.SoundManager.autoStopMusic=!1,Laya.SoundManager.autoReleaseSound=!1;var e=Laya.LocalStorage.getItem("soundVolume");if(e&&""!=e){(n=parseFloat(e))<0?n=0:n>1&&(n=1),this._soundVolume=n}else this._soundVolume=1;var t=Laya.LocalStorage.getItem("audioVolume");if(t&&""!=t){(n=parseFloat(t))<0?n=0:n>1&&(n=1),this._audioVolume=n}else this._audioVolume=1;var i=Laya.LocalStorage.getItem("musicVolume");if(i&&""!=i){var n=parseFloat(i);n<0?n=0:n>1&&(n=1),this._music_volume=n}else this._music_volume=1;Laya.SoundManager.musicVolume=this._music_volume;var a=Laya.LocalStorage.getItem("soundMute");this._soundMuted=!(!a||""==a)&&"true"==a;var r=Laya.LocalStorage.getItem("audioMute");this._audioMuted=!(!r||""==r)&&"true"==r;var o=Laya.LocalStorage.getItem("musicMute");Laya.SoundManager.musicMuted=!(!o||""==o)&&"true"==o,Laya.timer.frameLoop(1,this,this._update)},e.PlayCharactorSound=function(e,t,i){var n=e.charid,a=cfg.item_definition.character.get(n);if(!a)return null;for(var r=e.level,o=cfg.voice.sound.findGroup(a.sound),s=[],h=0;h<o.length;h++)o[h].type==t&&o[h].level_limit<=r&&s.push(h);if(0==s.length)return null;var l=s[Math.floor(Math.random()*s.length)];return{words:o[l].words,sound:this.PlaySound(o[l].path,a.sound_volume,i)}},e.PlaySound=function(e,t,i){this._audio_id;this._audio_id++;var n=this.suffix,a=Laya.SoundManager.playSound(e+n,1,Laya.Handler.create(this,function(){i&&i.run(),Laya.SoundManager.removeChannel(a)}));return a.volume=this._soundVolume*t,this._soundMuted&&(a.volume=0),a},e.PlayAudio=function(e,t,i){var n=this;if(void 0===t&&(t=1),void 0===i&&(i=1),this._audioMuted||0==this._audioVolume)return-1;var a=cfg.audio.audio.get(e);if(!a)return-1;var r=this._audio_id;this._audio_id++;var o=this.suffix,s=Laya.SoundManager.playSound(a.path+o,t,new Laya.Handler(this,function(){n._RemoveAudio(r)}));return s.volume=this._audioVolume*i,this._audio_list.push({id:r,audio:s}),r},e._RemoveAudio=function(e){for(var t=0;t<this._audio_list.length;t++)if(this._audio_list[t].id==e){var i=this._audio_list[t];this._audio_list[t]=this._audio_list[this._audio_list.length-1],this._audio_list[this._audio_list.length-1]=i,i.audio.stop(),Laya.SoundManager.removeChannel(i.audio),this._audio_list.pop()}},e.StopAudio=function(e){this._RemoveAudio(e)},e.PlayMusic=function(e,i){void 0===i&&(i=1e3),this._current_music!=e&&(this._current_music=e,Laya.SoundManager.musicMuted||(this._music=Laya.SoundManager.playMusic("audio/"+e,0),this._music&&(this._music.volume=0,this._music_state=t.start,this._music_state_starttime=Laya.timer.currTimer,this._music_state_lifetime=i)))},e.StopMusic=function(e){void 0===e&&(e=1e3),this._current_music="",this._music&&(this._music_state=t.end,this._music_state_starttime=Laya.timer.currTimer,this._music_state_lifetime=e)},Object.defineProperty(e,"soundVolume",{get:function(){return this._soundVolume},set:function(e){e=e<0?0:e>1?1:e,this._soundVolume=e,Laya.LocalStorage.setItem("soundVolume",e.toString())},enumerable:!0,configurable:!0}),Object.defineProperty(e,"audioVolume",{get:function(){return this._audioVolume},set:function(e){e=e<0?0:e>1?1:e,this._audioVolume=e,Laya.LocalStorage.setItem("audioVolume",e.toString())},enumerable:!0,configurable:!0}),Object.defineProperty(e,"musicVolume",{get:function(){return this._music_volume},set:function(e){this._music_volume=e,Laya.SoundManager.musicVolume=e,Laya.LocalStorage.setItem("musicVolume",e.toString()),this._music&&this._music_state==t.during&&(this._music.volume=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"musicMuted",{get:function(){return Laya.SoundManager.musicMuted},set:function(e){if(Laya.SoundManager.musicMuted=e,Laya.LocalStorage.setItem("musicMute",e?"true":"false"),e)null!=this._music&&(this._music.stop(),this._music=null);else if(null==this._music&&""!=this._current_music){var t=this._current_music;this._current_music="",this.PlayMusic(t)}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"soundMuted",{get:function(){return this._soundMuted},set:function(e){this._soundMuted=e,Laya.LocalStorage.setItem("soundMute",e?"true":"false")},enumerable:!0,configurable:!0}),Object.defineProperty(e,"audioMuted",{get:function(){return this._audioMuted},set:function(e){this._audioMuted=e,Laya.LocalStorage.setItem("audioMute",e?"true":"false")},enumerable:!0,configurable:!0}),e.refresh_music_volume=function(e){this._music&&this._music_state==t.during&&(this._music.volume=e?.1*this.musicVolume:this.musicVolume)},e._update=function(){if(this._music&&!this.musicMuted&&this._music_state!=t.none){var e=Laya.timer.currTimer-this._music_state_starttime;if(this._music_state==t.start)if(e>=this._music_state_lifetime)this._music_state=t.during,this._music.volume=this._music_volume;else{i=e/this._music_state_lifetime;this._music.volume=this._music_volume*i}else if(this._music_state==t.end)if(e>=this._music_state_lifetime)this._music_state=t.none,Laya.SoundManager.stopMusic(),this._music=null;else{var i=e/this._music_state_lifetime;this._music.volume=this._music_volume*(1-i)}}},e._audio_id=0,e._audio_list=[],e._soundVolume=0,e._soundMuted=!1,e._audioVolume=0,e._audioMuted=!1,e._music=null,e._music_volume=1,e._music_state=t.none,e._music_state_starttime=0,e._music_state_lifetime=0,e._current_music="",e}();e.AudioMgr=i}(view||(view={}));var game;!function(e){var t=function(){function t(){}return Object.defineProperty(t,"currentTime",{get:function(){return Math.floor(Date.now()/1e3)},enumerable:!0,configurable:!0}),t.time2YearMounthDate=function(e){var t=new Date(1e3*e),i="";return i+=t.getFullYear()+"/",i+=(t.getMonth()<9?"0":"")+(t.getMonth()+1).toString()+"/",i+=(t.getDate()<10?"0":"")+t.getDate()},t.time2HourMinute=function(e,t){void 0===t&&(t=!1);var i=new Date(1e3*e),n="";return n+=(i.getHours()<10?"0":"")+i.getHours()+":",n+=(i.getMinutes()<10?"0":"")+i.getMinutes(),t&&(n+=":",n+=(i.getSeconds()<10?"0":"")+i.getSeconds()),n},t.time2Desc=function(e){var t=Math.floor(Date.now()/1e3)-e;if(t<600)return"刚刚";if(t<3600){return(i=Math.floor(t/10/60)).toString()+"0分钟前"}if(t<86400){return(i=Math.floor(t/60/60)).toString()+"小时前"}if(t<604800){return(i=Math.floor(t/24/60/60)).toString()+"天前"}if(t<18144e3){var i=Math.floor(t/7/24/60/60);return i.toString()+"星期前"}return"1个月前"},t.timelength2Desc=function(e){var t="",i=e;return i%60>0&&(t=i%60+"秒"),(i=Math.floor(i/60))%60>0&&(t=i%60+"分"+t),(i=Math.floor(i/60))%24>0&&(t=i%24+"小时"+t),(i=Math.floor(i/24))>0&&(t=i+"天"+t),""==t&&(t="0秒"),t},t.playState2Desc=function(e){if(!e)return"";if(!e.game_uuid||""==e.game_uuid)return"";if(1==e.category)return"友人场";if(2==e.category&&e.meta){var t=cfg.desktop.matchmode.get(e.meta.mode_id);if(t)return t.room_name}return""},t.setGrayDisable=function(e,t){t?(e.mouseEnabled=!1,e.filters=[new Laya.ColorFilter(uiscript.GRAY_FILTER)]):(e.mouseEnabled=!0,e.filters=[])},t.generateUUID=function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var i=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?i:3&i|8).toString(16)})},Object.defineProperty(t,"deviceInfo",{get:function(){var t={};t["client-version"]=e.ResourceVersion.version;var i=[];if(Laya.Browser.onIOS&&i.push("onIOS"),Laya.Browser.onMac&&i.push("onMac"),Laya.Browser.onIPad&&i.push("onIPad"),(Laya.Browser.onAndriod||Laya.Browser.onAndroid)&&i.push("onAndroid"),Laya.Browser.onSafari&&i.push("onSafari"),Laya.Browser.onFirefox&&i.push("onFirefox"),Laya.Browser.onEdge&&i.push("onEdge"),Laya.Browser.onWeiXin&&i.push("onWeiXin"),Laya.Browser.onMiniGame&&i.push("onMiniGame"),Laya.Browser.onMQQBrowser&&i.push("onMQQBrowser"),Laya.Render.isConchApp?i.push("onApp"):Laya.Browser.onPC&&i.push("onPC"),i.length>0){for(var n="",a=0;a<i.length;a++)0!=a&&(n+="|"),n+=i[a];t.device=n}else t.device="unknown";return t},enumerable:!0,configurable:!0}),t.strWithoutForbidden=function(e){var t=e;return cfg.info.forbidden.forEach(function(e,i){if(""!=e.word)for(;;){if(!(t.indexOf(e.word)>=0))break;for(var n="",a=0;a<e.word.length;a++)n+="*";t=t.replace(e.word,n)}}),t},t.faceOn=function(t,i,n,a,r){a.visible=!1;var o=cfg.item_definition.skin.get(t);if(o){a.skin=e.LoadMgr.getResImageSkin(o.path+"/"+i+".png");var s=r.width/o[n+"_width"],h=r.height/o[n+"_height"];a.anchorX=0,a.anchorY=0,a.width=o.face_width*s,a.height=o.face_height*h,a.x=(o.face_x-o[n+"_x"])*s,a.y=(o.face_y-o[n+"_y"])*h,a.visible=!0}},t.charaPart=function(t,i,n,a){var r=cfg.item_definition.skin.get(400101);if(r){var o=cfg.item_definition.skin.get(t);o&&(i.skin=e.LoadMgr.getResImageSkin(o.path+"/"+n+".png"),i.width=a.width*o[n+"_width"]/r[n+"_width"],i.height=a.height*o[n+"_height"]/r[n+"_height"],i.x=a.x+(o[n+"_x"]-r[n+"_x"])*a.width/r[n+"_width"]*i.scaleX,i.y=a.y+(o[n+"_y"]-r[n+"_y"])*a.height/r[n+"_height"]*i.scaleY)}},t.showRewards=function(e,t){for(var i=this,n=[],a=[],r=0;r<e.rewards.length;r++)100099!=e.rewards[r].id&&(100098!=e.rewards[r].id?6==Math.floor(e.rewards[r].id/1e5)?a.push(e.rewards[r].id):n.push(e.rewards[r]):uiscript.UI_LightTips.Inst.show("使用成功"));var o=!1,s=0,h=function(){if(!o&&n.length>0)return uiscript.UI_Getrewardextends.Inst.show(n,Laya.Handler.create(i,function(){h()})),void(o=!0);s<a.length?uiscript.UI_Gettitle.Inst.show(a[s++],Laya.Handler.create(i,function(){h()})):t&&t.run()};h()},t.debugFetchMultiAccountBrief=function(e,t,i,n){if(!(Laya.timer.currTimer<this.debugfetchcd)){this.debugfetchcd=Laya.timer.currTimer+3e5;var a={};a.type="debugFetchMultiAccountBrief",a.pos=e,a.index=t,a.total=i,a.value_count=n;(new Laya.HttpRequest).send(GameMgr.error_url,"data="+JSON.stringify(a),"post")}},t.get_room_desc=function(e){if(!e)return{text:"",isSimhei:!1};var t="";if(e.meta&&e.meta.tournament_id){var i=cfg.tournament.tournaments.get(e.meta.tournament_id);return i&&(t=i.name),{text:t,isSimhei:!0}}if(1==e.category)t+="友人场·";else if(4==e.category)t+="比赛场·";else if(2==e.category){var n=e.meta;if(n){var a=cfg.desktop.matchmode.get(n.mode_id);a&&(t+=a.room_name+"·")}}switch(e.mode.mode){case 0:t+="一局胜负";break;case 1:t+="四人东";break;case 2:t+="四人南";break;case 3:t="人机模式"}return{text:t,isSimhei:!1}},t.get_chara_audio=function(e,t){if(t&&""!=t){var i=e.charid,n=cfg.item_definition.character.get(i);if(!n)return null;for(var a=e.level,r=cfg.voice.sound.findGroup(n.sound),o=[],s=0;s<r.length;s++)r[s].type==t&&r[s].level_limit<=a&&o.push(s);if(0==o.length)return null;var h=o[Math.floor(Math.random()*o.length)];return{path:r[h].path,volume:n.sound_volume,time_length:r[h].time_length}}},t.encode_account_id=function(e){return 1358437+(7*e+1117113^86216345)},t.decode_account_id=function(e){return((e-1358437^86216345)-1117113)/7},t.child_align_center=function(e,t){for(var i=[],n=0;n<e.numChildren;n++){if((s=e.getChildAt(n)).visible){var a=s.width;s instanceof Laya.Text?a=s.textWidth:s instanceof Laya.Label&&(a=s.textField.textWidth),i.push(a*s.scaleX)}}for(var r=0,n=0;n<i.length;n++)r+=i[n],t&&n<t.length&&(r+=t[n]);for(var o=e.width/2-r/2,n=0;n<e.numChildren;n++){var s=e.getChildAt(n);s.visible&&(s.x=o+s.pivotX*s.scaleX,o+=i[n],t&&n<t.length&&(o+=t[n]))}},t.build_char_map=function(){if(!this.char_map){for(var e=[],t="a".charCodeAt(0),i=0;i<26;i++)e.push(String.fromCharCode(t+i));for(var n="A".charCodeAt(0),i=0;i<26;i++)e.push(String.fromCharCode(n+i));for(i=0;i<10;i++)e.push(i.toString());e.push("-"),this.char_lst=e,this.char_map={};for(i=0;i<e.length;i++)this.char_map[e[i]]=i}},t.encode_str=function(e){this.build_char_map();for(var t="",i=0;i<e.length;i++){var n=2+3*i^11,a=e[i];null!=this.char_map[a]?t+=this.char_lst[(this.char_map[a]+n)%this.char_lst.length]:t+=a}return t},t.decode_str=function(e){this.build_char_map();for(var t="",i=0;i<e.length;i++){var n=2+3*i^11,a=e[i];null!=this.char_map[a]?t+=this.char_lst[(this.char_map[a]-n+this.char_lst.length)%this.char_lst.length]:t+=a}return t},t.open_new_window=function(e){var t=document.createElement("a");t.href=e,t.target="_blank",t.click(),t.remove()},t.base64ToBlob=function(e,t){for(var i=e.split(","),n=i[0].match(/:(.*?);/)[1]||t,a=window.atob(i[1]),r=new ArrayBuffer(a.length),o=new Uint8Array(r),s=0;s<a.length;s++)o[s]=a.charCodeAt(s);return new Blob([r],{type:n})},t.stringContainerSub=function(e,t){if(!t||""==t)return!0;if(!e||""==e)return!1;for(var i=0,n=0;n<e.length;n++)if(e.charAt(n)==t.charAt(i)&&++i>=t.length)return!0;return!1},t.debugfetchcd=0,t.char_lst=null,t.char_map=null,t}();e.Tools=t}(game||(game={}));var game;!function(e){var t;!function(e){e[e.none=0]="none",e[e.loading=1]="loading",e[e.loaded=2]="loaded"}(t=e.E_LoadState||(e.E_LoadState={}));var i=function(){function e(){this._active=!1,this._load_state=t.none}return Object.defineProperty(e.prototype,"active",{get:function(){return this._active},set:function(e){this._active=e,this._active?this.onEnable():this.onDisable()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"load_state",{get:function(){return this._load_state},enumerable:!0,configurable:!0}),e}();e.SceneBase=i}(game||(game={}));var game;!function(e){var t=function(){function t(){}return Object.defineProperty(t,"version",{get:function(){return this._version},enumerable:!0,configurable:!0}),t.init=function(t){this._manifest={},e.LoadMgr.httpload("version.json","json",!0,Laya.Handler.create(this,this.onManifestLoaded,[t])),Laya.URL.customFormat=this.formatURL},t.onManifestLoaded=function(t,i){if(i.success){app.Log.log("version.json加载成功");var n=i.data;this._version=n.version,e.LoadMgr.httpload("resversion"+this._version+".json","json",!0,Laya.Handler.create(this,this.onResVersionLoaded,[t]))}else app.Log.log("version.json加载失败"),t.run()},t.onResVersionLoaded=function(e,t){if(t.success){app.Log.log("Resversion.json加载成功");var i=t.data;for(var n in i.res)this._manifest[n]=i.res[n].prefix}else app.Log.log("Resversion.json加载失败");e.run()},t.formatURL=function(e){return t._manifest.hasOwnProperty(e)?t._manifest[e]+"/"+e:e},t._manifest={},t._version="0.0.0",t}();e.ResourceVersion=t}(game||(game={}));var game;!function(e){var t=function(){function t(){var t=this;this.connect_state=e.EConnectState.none,this.open_func=null,this.reconnect_count=0,this.reconnect_span=[500,1e3,3e3,6e3,1e4,15e3],this.playerreconnect=!1,this.lasterrortime=0,this.load_over=!1,this.loaded_player_count=0,this.real_player_count=0,app.NetAgent.AddListener2MJ("NotifyPlayerLoadGameReady",Laya.Handler.create(this,function(e){app.Log.log("NotifyPlayerLoadGameReady: "+JSON.stringify(e)),t.loaded_player_count=e.ready_id_list.length,t.load_over&&uiscript.UI_Loading.Inst.enable&&uiscript.UI_Loading.Inst.showLoadCount(t.loaded_player_count,t.real_player_count)}))}return Object.defineProperty(t,"Inst",{get:function(){return null==this._Inst?this._Inst=new t:this._Inst},enumerable:!0,configurable:!0}),t.prototype.OpenConnect=function(t,i,n,a,r){app.Log.log("MJNetMgr OpenConnect"),uiscript.UI_Loading.Inst.show("enter_mj"),this.Close(),this.url=t,this.token=i,this.game_uuid=n,GameMgr.Inst.ingame=!0,GameMgr.Inst.mj_server_url=t,GameMgr.Inst.mj_game_token=i,GameMgr.Inst.mj_game_uuid=n,this.playerreconnect=a,this._setState(e.EConnectState.tryconnect),this.load_over=!1,this.loaded_player_count=0,this.real_player_count=0,app.NetAgent.connect2MJ(this.url,Laya.Handler.create(this,this._OnConnent,null,!1)),view.AudioMgr.StopMusic()},t.prototype.Close=function(){this.load_over=!1,app.Log.log("MJNetMgr close"),this._setState(e.EConnectState.none),app.NetAgent.Close2MJ()},t.prototype._OnConnent=function(t){app.Log.log("MJNetMgr _OnConnent event:"+t),t==Laya.Event.CLOSE||t==Laya.Event.ERROR?this.connect_state==e.EConnectState.tryconnect?(this._setState(e.EConnectState.none),this.open_func&&this.open_func.runWith(!1),this.open_func=null,uiscript.UIMgr.Inst.ShowErrorInfo("连接麻将桌发生错误")):this.connect_state==e.EConnectState.connecting?view.DesktopMgr.Inst.active?(view.DesktopMgr.Inst.duringReconnect=!0,this._setState(e.EConnectState.reconnecting),this.reconnect_count=0,this._Reconnect()):Laya.timer.currTimer>this.lasterrortime&&(this.lasterrortime=Laya.timer.currTimer,this._setState(e.EConnectState.disconnect),uiscript.UIMgr.Inst.ShowErrorInfo("连接麻将桌发生错误"),e.Scene_MJ.Inst.ForceOut()):this.connect_state==e.EConnectState.reconnecting&&Laya.timer.currTimer>this.lasterrortime&&(this.lasterrortime=Laya.timer.currTimer,this._Reconnect()):t==Laya.Event.OPEN&&(this.connect_state==e.EConnectState.tryconnect?(this._setState(e.EConnectState.connecting),this._ConnectSuccess()):this.connect_state==e.EConnectState.reconnecting&&(this._setState(e.EConnectState.connecting),this._ConnectSuccess()))},t.prototype._Reconnect=function(){var t=this;e.LobbyNetMgr.Inst.connect_state==e.EConnectState.none||e.LobbyNetMgr.Inst.connect_state==e.EConnectState.disconnect?this._setState(e.EConnectState.disconnect):e.LobbyNetMgr.Inst.connect_state==e.EConnectState.connecting&&GameMgr.Inst.logined?this.reconnect_count>=this.reconnect_span.length?this._setState(e.EConnectState.disconnect):(Laya.timer.once(this.reconnect_span[this.reconnect_count],this,function(){t.connect_state==e.EConnectState.reconnecting&&(app.Log.log("MJNetMgr reconnect count:"+t.reconnect_count),app.NetAgent.connect2MJ(t.url,Laya.Handler.create(t,t._OnConnent,null,!1)))}),this.reconnect_count++):Laya.timer.once(1e3,this,this._Reconnect)},t.prototype._setState=function(t){this.connect_state=t,GameMgr.inRelease||null!=uiscript.UI_Common.Inst&&(t==e.EConnectState.none?uiscript.UI_Common.Inst.label_net_mj.text="":t==e.EConnectState.tryconnect?(uiscript.UI_Common.Inst.label_net_mj.text="尝试连接麻将服务器",uiscript.UI_Common.Inst.label_net_mj.color="#000000"):t==e.EConnectState.connecting?(uiscript.UI_Common.Inst.label_net_mj.text="麻将服务器：正常",uiscript.UI_Common.Inst.label_net_mj.color="#00ff00"):t==e.EConnectState.disconnect?(uiscript.UI_Common.Inst.label_net_mj.text="麻将服务器：断开连接",uiscript.UI_Common.Inst.label_net_mj.color="#ff0000",uiscript.UI_Disconnect.Inst&&uiscript.UI_Disconnect.Inst.show()):t==e.EConnectState.reconnecting&&(uiscript.UI_Common.Inst.label_net_mj.text="麻将服务器：正在重连",uiscript.UI_Common.Inst.label_net_mj.color="#ff0000",uiscript.UI_Disconnect.Inst&&uiscript.UI_Disconnect.Inst.show()))},t.prototype._ConnectSuccess=function(){var t=this;app.Log.log("MJNetMgr _ConnectSuccess "),this.load_over=!1,app.NetAgent.sendReq2MJ("FastTest","authGame",{token:this.token,game_uuid:this.game_uuid},function(i,n){if(i||n.error)uiscript.UIMgr.Inst.showNetReqError("authGame",i,n),e.Scene_MJ.Inst.GameEnd(),view.AudioMgr.PlayMusic("music/lobby.mp3");else{app.Log.log("麻将桌验证通过："+JSON.stringify(n)),uiscript.UI_Loading.Inst.setProgressVal(.1);var a=[null,null,null,null];view.DesktopMgr.player_link_state=n.state_list;var r="电脑(简单)",o=n.game_config.mode;o.extendinfo&&(r="电脑(普通)"),o.detail_rule&&o.detail_rule.ai_level&&(1===o.detail_rule.ai_level&&(r="电脑(简单)"),2===o.detail_rule.ai_level&&(r="电脑(普通)"));for(l=0;l<n.seat_list.length;l++){var s=n.seat_list[l];if(0==s)a[l]={nickname:r,avatar_id:400101,level:{id:10101},character:{charid:200001,level:0,exp:0,views:[],skin:400101,is_upgraded:!1}};else{0;for(var h=0;h<n.players.length;h++)if(n.players[h].account_id==s){a[l]=n.players[h];break}}}for(var l=0;l<4;l++)null==a[l]&&(a[l]={account:0,nickname:"未知",avatar_id:400101,level:{id:10101},character:{charid:200001,level:0,exp:0,views:[],skin:400101,is_upgraded:!1}});t.real_player_count=4,t.loaded_player_count=n.ready_id_list.length,t._AuthSuccess(a,n.is_game_start,n.game_config)}})},t.prototype._AuthSuccess=function(t,i,n){var a=this;view.DesktopMgr.Inst&&view.DesktopMgr.Inst.active?(this.load_over=!0,Laya.timer.once(500,this,function(){app.Log.log("重连信息1 round_id:"+view.DesktopMgr.Inst.round_id+" step:"+view.DesktopMgr.Inst.current_step),view.DesktopMgr.Inst.Reset(),view.DesktopMgr.Inst.duringReconnect=!0,uiscript.UI_Loading.Inst.setProgressVal(.2),app.NetAgent.sendReq2MJ("FastTest","syncGame",{round_id:view.DesktopMgr.Inst.round_id,step:view.DesktopMgr.Inst.current_step},function(t,i){t||i.error?(uiscript.UIMgr.Inst.showNetReqError("syncGame",t,i),e.Scene_MJ.Inst.ForceOut()):(app.Log.log("[syncGame] "+JSON.stringify(i)),i.isEnd?(uiscript.UIMgr.Inst.ShowErrorInfo("游戏已经结束"),e.Scene_MJ.Inst.GameEnd()):(uiscript.UI_Loading.Inst.setProgressVal(.3),view.DesktopMgr.Inst.fetchLinks(),i.game_restore&&(view.DesktopMgr.Inst.Reset(),view.DesktopMgr.Inst.duringReconnect=!0,view.DesktopMgr.Inst.syncGameByStep(i.game_restore))))})})):e.Scene_MJ.Inst.openMJRoom(t,Laya.Handler.create(this,function(){view.DesktopMgr.Inst.initRoom(n,t,GameMgr.Inst.account_id,view.EMJMode.play),i?Laya.timer.frameOnce(10,a,function(){app.Log.log("重连信息2 round_id:-1 step:"+1e6),view.DesktopMgr.Inst.Reset(),view.DesktopMgr.Inst.duringReconnect=!0,app.NetAgent.sendReq2MJ("FastTest","syncGame",{round_id:"-1",step:1e6},function(t,i){app.Log.log("syncGame "+JSON.stringify(i)),t||i.error?(uiscript.UIMgr.Inst.showNetReqError("syncGame",t,i),e.Scene_MJ.Inst.ForceOut()):(uiscript.UI_Loading.Inst.setProgressVal(1),view.DesktopMgr.Inst.fetchLinks(),a._PlayerReconnectSuccess(i))})}):Laya.timer.frameOnce(10,a,function(){view.DesktopMgr.Inst.Reset(),view.DesktopMgr.Inst.duringReconnect=!0,app.NetAgent.sendReq2MJ("FastTest","enterGame",{},function(t,i){t||i.error?(uiscript.UIMgr.Inst.showNetReqError("enterGame",t,i),e.Scene_MJ.Inst.ForceOut()):(uiscript.UI_Loading.Inst.setProgressVal(1),app.Log.log("enterGame"),a._EnterGame(i),view.DesktopMgr.Inst.fetchLinks())})})}),Laya.Handler.create(this,function(e){return uiscript.UI_Loading.Inst.setProgressVal(.1+.8*e)},null,!1))},t.prototype._EnterGame=function(t){app.Log.log("正常进入游戏: "+JSON.stringify(t)),t.is_end?(uiscript.UIMgr.Inst.ShowErrorInfo("游戏已经结束"),e.Scene_MJ.Inst.GameEnd()):t.game_restore?view.DesktopMgr.Inst.syncGameByStep(t.game_restore):(console.log("正常进入游戏："+Laya.Stat.currentMemorySize/1024/1024+" MB"),this.load_over=!0,this.load_over&&uiscript.UI_Loading.Inst.enable&&uiscript.UI_Loading.Inst.showLoadCount(this.loaded_player_count,this.real_player_count),view.DesktopMgr.Inst.duringReconnect=!1,view.DesktopMgr.Inst.DoChainAction(0))},t.prototype._PlayerReconnectSuccess=function(t){app.Log.log("_PlayerReconnectSuccess data:"+JSON.stringify(t)),t.isEnd?(uiscript.UIMgr.Inst.ShowErrorInfo("游戏已经结束"),e.Scene_MJ.Inst.GameEnd()):t.game_restore?view.DesktopMgr.Inst.syncGameByStep(t.game_restore):(uiscript.UIMgr.Inst.ShowErrorInfo("提取内容出错"),e.Scene_MJ.Inst.ForceOut())},t._Inst=null,t}();e.MJNetMgr=t}(game||(game={}));var game;!function(e){var t;!function(e){e[e.none=0]="none",e[e.tryconnect=1]="tryconnect",e[e.connecting=2]="connecting",e[e.reconnecting=3]="reconnecting",e[e.disconnect=4]="disconnect"}(t=e.EConnectState||(e.EConnectState={}));var i=function(){function i(){this.urls=[],this.link_index=-1,this.servername="",this.connect_state=t.none,this.open_func=null,this.reconnect_count=0,this.reconnect_span=[500,1e3,3e3,6e3,1e4,15e3],this.lasterrortime=0,this.inMaintenance=!1,this.maintenanceInfo="",this._connect_listeners=[]}return Object.defineProperty(i,"Inst",{get:function(){return null==this._Inst?this._Inst=new i:this._Inst},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isOK",{get:function(){return this.connect_state==t.connecting},enumerable:!0,configurable:!0}),i.prototype.OpenConnect=function(e){app.Log.log("LobbyNetMgr OpenConnect "),this.inMaintenance?e&&e.runWith({open:!1,maintenance:this.maintenanceInfo}):this.connect_state==t.connecting?e&&e.runWith({open:!0}):(this.open_func=null,app.Log.info_net("LobbyNetMgr OpenConnect 2 close: "+this.connect_state),this.Close(),this.connect_state=t.none,this.open_func=e,this._setState(t.tryconnect),this._fetch_gateway())},i.prototype.Close=function(){app.Log.log("LobbyNetMgr close "),app.Log.info_net("LobbyNetMgr Close connect_state:"+this.connect_state),GameMgr.Inst.logined=!1,this.open_func=null,this._setState(t.none),app.NetAgent.Close2Lobby()},i.prototype._OnConnent=function(e){app.Log.log("LobbyNetMgr _OnConnent event:"+e),e==Laya.Event.CLOSE||e==Laya.Event.ERROR?this.connect_state==t.tryconnect?this._try_to_linknext():this.connect_state==t.connecting?Laya.timer.currTimer-this.lasterrortime>100&&(GameMgr.Inst.logined?(this.lasterrortime=Laya.timer.currTimer,GameMgr.Inst.logined=!1,this._setState(t.reconnecting),this.reconnect_count=0,this._fetch_gateway(),this._trigger_connect_msg("reconnect")):(this._setState(t.none),GameMgr.Inst.logined=!1,this.open_func&&this.open_func.runWith({open:!1,info:cfg.str.str.get(11).desc+" 4"}),this.open_func=null)):this.connect_state==t.reconnecting&&Laya.timer.currTimer-this.lasterrortime>100&&(GameMgr.Inst.logined=!1,this.lasterrortime=Laya.timer.currTimer,this._try_to_linknext()):e==Laya.Event.OPEN&&(this.connect_state==t.tryconnect?(this._setState(t.connecting),this.open_func&&this.open_func.runWith({open:!0}),this.open_func=null):this.connect_state==t.reconnecting&&(this._setState(t.connecting),this._ReconnectSuccess()))},i.prototype._Reconnect=function(){var e=this;this.reconnect_count>=this.reconnect_span.length?this._setState(t.disconnect):(Laya.timer.once(this.reconnect_span[this.reconnect_count],this,function(){e.connect_state==t.reconnecting&&(app.Log.log("LobbyNetMgr _Reconnect  count:"+e.reconnect_count),e._fetch_gateway())}),this.reconnect_count++)},i.prototype._ReconnectSuccess=function(){var t=this,i={};Laya.Browser.window.conch?i.device_type="app":(Laya.Browser.onPC&&(i.device_type="pc"),Laya.Browser.onIPad&&(i.device_type="ipad"),Laya.Browser.onMobile&&(i.device_type="mobile")),Laya.Browser.onMac&&(i.os="mac"),Laya.Browser.onIOS&&(i.os="ios"),(Laya.Browser.onAndriod||Laya.Browser.onAndroid)&&(i.os="android"),Laya.Browser.onWeiXin&&(i.browser="weixin"),Laya.Browser.onSafari&&(i.browser="safari"),Laya.Browser.onFirefox&&(i.browser="firefox"),Laya.Browser.onEdge&&(i.browser="edge"),Laya.Browser.onMiniGame&&(i.browser="minigame");var n=[];GameMgr.inGooglePlay&&n.push(1),GameMgr.inChina&&n.push(2),-1==GameMgr.Inst.sociotype?app.NetAgent.sendReq2Lobby("Lobby","login",{account:GameMgr.Inst.account,password:GameMgr.encodeP(GameMgr.Inst.password),reconnect:!0,device:i,random_key:GameMgr.device_id,client_version:e.ResourceVersion.version,currency_platforms:n},function(e,t){e||t.error?uiscript.UIMgr.Inst.ShowErrorInfo("自动重连登录失败"):(app.Log.log("LobbyNetMgr 重连成功"),GameMgr.Inst.logined=!0)}):app.NetAgent.sendReq2Lobby("Lobby","oauth2Login",{type:GameMgr.Inst.sociotype,access_token:GameMgr.Inst.access_token,reconnect:!0,device:i,random_key:GameMgr.device_id,client_version:e.ResourceVersion.version,currency_platforms:n},function(e,i){e||i.error?uiscript.UIMgr.Inst.ShowErrorInfo("自动重连登录失败"):(app.Log.log("LobbyNetMgr 重连成功"),GameMgr.Inst.logined=!0,t._trigger_connect_msg("reconnect_success"))})},i.prototype._setState=function(e){this.connect_state=e,e==t.disconnect?uiscript.UI_Disconnect.Inst&&uiscript.UI_Disconnect.Inst.show():e==t.reconnecting&&uiscript.UI_Disconnect.Inst&&uiscript.UI_Disconnect.Inst.show(),this.refreshCommonShow()},i.prototype.refreshCommonShow=function(){GameMgr.inRelease||null!=uiscript.UI_Common.Inst&&(this.connect_state==t.none?(uiscript.UI_Common.Inst.label_net_lobby.text="未连接:"+this.servername,uiscript.UI_Common.Inst.label_net_lobby.color="#ffffff"):this.connect_state==t.tryconnect?(uiscript.UI_Common.Inst.label_net_lobby.text="尝试连接:"+this.servername,uiscript.UI_Common.Inst.label_net_lobby.color="#ffffff"):this.connect_state==t.connecting?(uiscript.UI_Common.Inst.label_net_lobby.text="大厅服务器:"+this.servername,uiscript.UI_Common.Inst.label_net_lobby.color="#00ff00"):this.connect_state==t.disconnect?(uiscript.UI_Common.Inst.label_net_lobby.text="大厅服务器:"+this.servername+" 断开连接",uiscript.UI_Common.Inst.label_net_lobby.color="#ff0000"):this.connect_state==t.reconnecting&&(uiscript.UI_Common.Inst.label_net_lobby.text="大厅服务器:"+this.servername+" 正在重连",uiscript.UI_Common.Inst.label_net_lobby.color="#ff0000"))},i.prototype._fetch_gateway=function(){var e=this;this.urls=[],this.link_index=-1;var n=new Laya.HttpRequest;n.once(Laya.Event.COMPLETE,this,function(n){var a=JSON.parse(n);if(a.maintenance)e.connect_state==t.tryconnect?(e.inMaintenance=!0,e.maintenanceInfo=a.maintenance.message,e.open_func&&e.open_func.runWith({open:!1,maintenance:e.maintenanceInfo}),e.open_func=null,e._setState(t.none)):e.connect_state==t.reconnecting&&e._setState(t.disconnect);else if(a.servers&&a.servers.length>0){for(var r=a.servers,o=[],s=0;s<r.length;s++){var h=Math.floor(Math.random()*(s+1));o.push(s),o[s]=o[h],o[h]=s}for(s=0;s<o.length;s++)e.urls.push({name:i.gateway_name+"_"+o[s],url:r[o[s]]});e.link_index=-1,e._try_to_linknext()}else e.open_func&&e.open_func.runWith({open:!1,info:cfg.str.str.get(11).desc+" 2"}),e.open_func=null}),n.once(Laya.Event.ERROR,this,function(i){e.connect_state==t.tryconnect?(e.open_func&&e.open_func.runWith({open:!1,info:cfg.str.str.get(11).desc+" 1"}),e.open_func=null,e._setState(t.none)):e.connect_state==t.reconnecting&&e._Reconnect()});var a=[];a.push("If-Modified-Since"),a.push("0"),n.send(i.gateway_url,"","get","text",a)},i.prototype._try_to_linknext=function(){this.link_index++,this.link_index<0||this.link_index>=this.urls.length?this.connect_state==t.tryconnect?(this._setState(t.none),this.open_func&&this.open_func.runWith({open:!1,info:cfg.str.str.get(11).desc+" 3"}),this.open_func=null):this.connect_state==t.reconnecting&&this._Reconnect():(this.servername=i.gateway_name,app.NetAgent.connect2Lobby(this.urls[this.link_index].url,Laya.Handler.create(this,this._OnConnent,null,!1)))},i.prototype.add_connect_listener=function(e){this._connect_listeners.push(e)},i.prototype._trigger_connect_msg=function(e){app.Log.info_net("触发重连");for(var t=0;t<this._connect_listeners.length;t++)this._connect_listeners[t].runWith(e)},i.gateway_name="",i.gateway_url="",i._Inst=null,i}();e.LobbyNetMgr=i}(game||(game={}));var game;!function(e){var t;!function(e){e[e.common=0]="common",e[e.scene_mj=1]="scene_mj",e[e.lobby=2]="lobby",e[e.ui_mj=3]="ui_mj",e[e.entrance=4]="entrance"}(t=e.E_LoadType||(e.E_LoadType={}));var i=function(){function i(){}return i.loadConfig=function(){var e=this;Laya.loader.load("resconfig.json",Laya.Handler.create(this,function(){e._res_config=Laya.loader.getRes("resconfig.json")}))},i.getUrls=function(i){var n=[];return i==t.entrance?n=["res/atlas/myres/entrance.atlas","res/atlas/myres/necessary.atlas","scene/entrance.ls"]:i==t.common?n=["res/atlas/myres.atlas","res/atlas/myres/bothui.atlas"]:i==t.scene_mj?(n.push("scene/mjdesktop.ls"),n.push("scene/mjhandpai.ls")):i==t.lobby?((n=["res/atlas/myres/room.atlas","res/atlas/myres/shop.atlas","res/atlas/myres/sushe.atlas","res/atlas/myres/lobby.atlas","res/atlas/myres/match_lobby.atlas","res/atlas/myres/treasure.atlas"]).push(e.FrontEffect.scene_path),n.push(e.FrontEffect.scene2_path)):i==t.ui_mj&&(n=["res/atlas/myres/mjdesktop.atlas","res/atlas/myres/mjdesktop/shengduan.atlas"]),n},i._createItem=function(e){function t(e){if(l-=e,h>=s.length){if(l<=0){r.loaded=!0,r.precent=1;for(var t=0;t<r.complete.length;t++)r.complete[t]&&r.complete[t].run()}}else n()}function i(t){r.precent=(t*s.length+o.length)/e.length;for(var i=0;i<r.progress.length;i++)r.progress[i]&&r.progress[i].runWith(r.precent)}function n(){if(s.length>0){for(var e=[];l<1e3&&h<s.length;)e.push(s[h++]),l++;Laya.loader.create(e,Laya.Handler.create(this,t,[e.length],!1),Laya.Handler.create(this,i,null,!1))}else t(1e5)}function a(){r.precent=o.length/e.length,n()}for(var r={loaded:!1,precent:0,urls:e,complete:[],progress:[]},o=[],s=[],h=0,l=0,c=0;c<e.length;c++){var p=e[c];".ls"==p.substr(p.length-3)?o.push(p):s.push(p)}return o.length>0?Laya.loader.create(o,Laya.Handler.create(this,a),Laya.Handler.create(this,function(t){r.precent=(t*s.length+o.length)/e.length;for(var i=0;i<r.progress.length;i++)r.progress[i]&&r.progress[i].runWith(r.precent)})):a(),r},i.loadRes=function(e,t,i){for(var n=e;this._items.length<=n;)this._items.push(null);null==this._items[n]&&(this._items[n]=this._createItem(this.getUrls(e))),this._items[n].loaded?t&&t.run():(t&&this._items[n].complete.push(t),i&&(i.once=!1,this._items[n].progress.push(i)))},i.createResImage_web=function(t){var i=this;if(!this._resimage.hasOwnProperty(t)){var n="",a=t.substr(t.length-3);n=a.toLocaleLowerCase();var r={loaded:!1,origin_url:t,blob_url:null,complete:[],success:!1};this._resimage[t]=r;var o=new Laya.HttpRequest;o.once(Laya.Event.COMPLETE,this,function(e){for(var t=new Laya.Byte(e),a=new Laya.Byte,o=0;o<t.length;o++)GameMgr.inRelease?a.writeByte(73^t.readByte()):a.writeByte(t.readByte());var s=new Laya.Browser.window.Blob([a.buffer],{type:"image/"+n}),h=Laya.Browser.window.URL.createObjectURL(s);Laya.loader.load(h,Laya.Handler.create(i,function(e){r.blob_url=e,r.loaded=!0,r.success=!0;for(var t=0;t<r.complete.length;t++)r.complete&&r.complete[t].run();r.complete=[]},[h]),null,Laya.Loader.IMAGE)}),o.once(Laya.Event.ERROR,this,function(e){console.log("加载"+t+"失败"),r.loaded=!0,r.success=!1;for(var i=0;i<r.complete.length;i++)r.complete[i]&&r.complete[i].run();r.complete=[]}),o.send(e.ResourceVersion.formatURL(t),"","get","arraybuffer")}},i.createResImage_conch=function(e){if(!this._resimage.hasOwnProperty(e)){var t={loaded:!1,origin_url:e,blob_url:null,complete:[],success:!1};this._resimage[e]=t,Laya.loader.load(e,Laya.Handler.create(this,function(){t.blob_url=e,t.loaded=!0,t.success=!0;for(var i=0;i<t.complete.length;i++)t.complete&&t.complete[i].run();t.complete=[]}),null,Laya.Loader.IMAGE)}},i.loadResImage=function(e,t,i){var n=this;if(!e&&0==e.length)return i&&i.runWith(1),void(t&&t.run());var a=0,r=0,o=0,s=function(){for(o=0;o<5&&r<e.length;){var t=e[r++];n._resimage.hasOwnProperty(t)||(GameMgr.inConch?n.createResImage_conch(t):n.createResImage_web(t));var i=n._resimage[t];i.loaded?h(!1):(o++,i.complete.push(Laya.Handler.create(n,h,[!0])))}},h=function(n){n&&0==--o&&r<e.length&&s(),++a==e.length?(i&&i.runWith(1),t&&t.run()):i&&i.runWith(a/e.length)};s()},i.getResImage=function(e){if(!this._resimage.hasOwnProperty(e))return null;var t=this._resimage[e];return t.loaded&&t.success?Laya.loader.getRes(t.blob_url):null},i.getResImageSkin=function(e){if(!this._resimage.hasOwnProperty(e))return"";if(!this._resimage[e].loaded)return"";return this._resimage[e].blob_url},i.getItemSkin=function(t){var i=e.GameUtility.get_item_view(t);return this.getResImageSkin(i.icon)},i.disposeSceneRes=function(e){if(null!=this._res_config)if(this._res_config.hasOwnProperty(e)){var t=this._res_config[e];if(t.hasOwnProperty("atlas"))for(var i=0;i<t.atlas.length;i++)Laya.Loader.clearTextureRes(t.atlas[i])}else app.Log.Error("disposeSceneRes错误，场景不存在");else app.Log.Error("disposeSceneRes错误，未找到配置")},i.httpload=function(t,i,n,a){var r=new Laya.HttpRequest;r.once(Laya.Event.COMPLETE,this,function(e){a&&("json"==i?a.runWith({success:!0,data:JSON.parse(e)}):a.runWith({success:!0,data:e}))}),r.once(Laya.Event.ERROR,this,function(e){console.log("httpload加载"+t+"失败"),a&&a.runWith({success:!1})});var o=e.ResourceVersion.formatURL(t),s=[];n&&(s.push("If-Modified-Since"),s.push("0"),o+="?randv="+Math.floor(1e8*Math.random()).toString()+Math.floor(1e8*Math.random()).toString());var h="text";switch(i){case"json":h="text";break;case"arraybuffer":h="arraybuffer"}r.send(o,"","get",h,s)},i.setImgSkin=function(e,t){var i=this;if(t.indexOf("extendRes")>=0){""!=(n=this.getResImageSkin(t))&&null!=n?(e.skin=n,this.clearImgSkin(e)):(e.skin="",this.clearImgSkin(e),this._waiting_load_img_skins.push({img:e,src:t}),this.loadResImage([t],Laya.Handler.create(this,function(){for(var n=0;n<i._waiting_load_img_skins.length;n++)if(i._waiting_load_img_skins[n].img===e&&i._waiting_load_img_skins[n].src==t){e.skin=i.getResImageSkin(t),i._waiting_load_img_skins[n]=i._waiting_load_img_skins[i._waiting_load_img_skins.length-1],i._waiting_load_img_skins.pop();break}})))}else{var n=Laya.loader.getRes(t);n?(e.skin=t,this.clearImgSkin(e)):(e.skin="",this.clearImgSkin(e),this._waiting_load_img_skins.push({img:e,src:t}),Laya.loader.load(t,Laya.Handler.create(this,function(){for(var n=0;n<i._waiting_load_img_skins.length;n++)if(i._waiting_load_img_skins[n].img===e&&i._waiting_load_img_skins[n].src==t){e.skin=t,i._waiting_load_img_skins[n]=i._waiting_load_img_skins[i._waiting_load_img_skins.length-1],i._waiting_load_img_skins.pop();break}})))}},i.clearImgSkin=function(e){for(var t=0;t<this._waiting_load_img_skins.length;t++)if(this._waiting_load_img_skins[t].img===e){this._waiting_load_img_skins[t]=this._waiting_load_img_skins[this._waiting_load_img_skins.length-1],this._waiting_load_img_skins.pop();break}},i._items=[],i._resimage={},i._res_config=null,i._waiting_load_img_skins=[],i}();e.LoadMgr=i}(game||(game={}));var game;!function(e){e.stardust_id=302004;var t;!function(e){e[e.desktop=1]="desktop",e[e.mjp=2]="mjp"}(t=e.ECommonView||(e.ECommonView={}));!function(e){e[e.liqibang=1]="liqibang",e[e.hupai_effect=2]="hupai_effect",e[e.liqi_effect=3]="liqi_effect"}(e.EPlayerView||(e.EPlayerView={}));var i;!function(e){e[e.none=0]="none",e[e.currency=1]="currency",e[e.character=2]="character",e[e.item=3]="item",e[e.skin=4]="skin",e[e.title=5]="title"}(i=e.EIDType||(e.EIDType={}));!function(e){e[e.user_xieyi=1]="user_xieyi"}(e.EAccountSetKey||(e.EAccountSetKey={}));var n=function(){function e(){}return e.get_common_view_id=function(e){var t=e.toString();return GameMgr.Inst.commonview_slot.hasOwnProperty(t)?GameMgr.Inst.commonview_slot[t]:0},e.get_common_view_res_name=function(e){var i=cfg.item_definition.view.get(this.get_common_view_id(e));if(i)return i.res_name;switch(e){case t.desktop:return"tablecloth_default";case t.mjp:return"mjp_default"}return"default"},e.get_id_type=function(e){var t=Math.floor(e/1e4);return 10==t?i.currency:20==t?i.character:30==t?i.item:40==t?i.skin:60==t?i.title:i.none},e.get_item_view=function(e){var t="",n="",a="";switch(this.get_id_type(e)){case i.currency:var r=cfg.item_definition.currency.get(e);r&&(t=r.name,n=r.icon,a="");break;case i.character:var o=cfg.item_definition.character.get(e);o&&(t=o.name,n=cfg.item_definition.skin.get(o.init_skin).path+"/bighead.png",a="");break;case i.item:var s=cfg.item_definition.item.get(e);s&&(t=s.name,n=s.icon,a=s.desc);break;case i.skin:var h=cfg.item_definition.skin.get(e);h&&(t=h.name,n=h.path+"/bighead.png",a=h.desc);break;case i.title:var l=cfg.item_definition.title.get(e);l&&(t=l.name,n=l.icon,a=l.desc)}return{name:t,icon:n,desc:a}},e.item_owned=function(e){var t=this.get_id_type(e);if(t==i.character){if(a=uiscript.UI_Sushe.characters)for(r=0;r<a.length;r++)if(a[r]&&a[r].charid==e)return!0}else if(t==i.item){var n=cfg.item_definition.item.get(e);if(n&&(4==n.category||5==n.category)){if(uiscript.UI_Bag.get_item_count(e)>0)return!0}}else{if(t==i.skin)return uiscript.UI_Sushe.skin_owned(e);if(t==i.title){var a=uiscript.UI_TitleBook.owned_title;if(a)for(var r=0;r<a.length;r++)if(a[r]==e)return!0}}return!1},e}();e.GameUtility=n}(game||(game={}));var game;!function(e){var t=function(){function t(i,n,a,r,o){void 0===o&&(o=!1),this.destoryed=!1,this.target=i,this.destoryed=!1,this.pos_offset=a,this.scale=r,this.effect=new e.EffectBase(n,o),t.effects.push(this),this._update()}return t.regist=function(e){t.effects.push(e)},t.update=function(){for(var e=0,t=0;t<this.effects.length;t++)this.effects[t].destoryed||(this.effects[t]._update(),this.effects[e++]=this.effects[t]);for(t=this.effects.length-e;t>=0;t--)this.effects.pop()},t.prototype._update=function(){if(!this.destoryed&&this.target){var e=uiscript.UIMgr.Inst.getWorldPosition(this.target,new Laya.Point(0,0));e.x=e.x-.5,e.y=.5-e.y,this.effect&&this.effect.root&&(this.effect.root.transform.localPosition=new Laya.Vector3(e.x*i.scene_width,e.y*i.scene_height,0),0!=this.scale?this.effect.root.transform.localScale=new Laya.Vector3(this.target.scaleX*this.scale,this.target.scaleY*this.scale,1):this.effect.root.transform.localScale=new Laya.Vector3(1,1,1))}},t.prototype.destory=function(){this.destoryed||(this.destoryed=!0,this.effect.destory())},t.effects=[],t}();e.UIEffect=t;var i=function(){function i(){this._scene=null,this._root=null,this._scene2=null,this._root2=null,this._container_effect=null,this._effect_click=null,this._effects={}}return Object.defineProperty(i.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"root2",{get:function(){return this._root2},enumerable:!0,configurable:!0}),i.init=function(){(i.Inst=new i)._scene=Laya.loader.getRes(i.scene_path),GameMgr.Inst.root_front_effect.addChild(i.Inst._scene),i.Inst._root=i.Inst._scene.getChildByName("root"),i.Inst._container_effect=i.Inst._scene.getChildByName("container_effect"),i.Inst._effect_click=i.Inst._container_effect.getChildByName("effect_click"),i.Inst._scene.visible=!0,Laya.stage.on(Laya.Event.MOUSE_DOWN,i.Inst,i.Inst.bangClickEffect),this.Inst._scene2=Laya.loader.getRes(i.scene2_path),this.Inst._root2=this.Inst._scene2.getChildByName("root"),GameMgr.Inst.root_front_scene_effect.addChild(this.Inst._scene2),this.Inst._scene2.visible=!0,Laya.timer.frameLoop(1,this,function(){t.update()})},i.prototype.bangClickEffect=function(){var t=Laya.MouseManager.instance.mouseX,n=Laya.MouseManager.instance.mouseY;(!e.Scene_MJ.Inst.active||uiscript.UI_GameEnd.Inst&&uiscript.UI_GameEnd.Inst.enable)&&view.AudioMgr.PlayAudio(103);var a=0,r=0;Laya.Browser.width/1920<Laya.Browser.height/1080?r=(Laya.Browser.height-Laya.Browser.width/1920*1080)/2:a=(Laya.Browser.width-Laya.Browser.height/1080*1920)/2;var o=t/(Laya.Browser.width-2*a)*i.scene_width-i.scene_width/2,s=i.scene_height-n/(Laya.Browser.height-2*r)*i.scene_height-i.scene_height/2,h=this._effect_click.clone();this._root.addChild(h),h.active=!1,h.active=!0,h.transform.localPosition=new Laya.Vector3(o,s,1),Laya.timer.once(1500,this,function(){h.destroy(!0)})},i.prototype.create_ui_effect=function(e,i,n,a,r){void 0===r&&(r=!1);var o=new t(e,i,n,a,r);return this._root2.addChild(o.effect.root),o},i.Inst=null,i.scene_path="scene/front_effect.ls",i.scene2_path="scene/front_scene_effect.ls",i.scene_width=32,i.scene_height=18,i}();e.FrontEffect=i}(game||(game={}));var game;!function(e){!function(e){e[e.none=0]="none",e[e.room_invite=1]="room_invite"}(e.EFriendMsgType||(e.EFriendMsgType={}));var t=function(){function e(){}return e.init=function(){var e=this;this._friend_list=[],app.NetAgent.sendReq2Lobby("Lobby","fetchFriendList",{},function(t,i){if(t)app.Log.log("获取好友列表时发生错误:"+t);else if(i.error)app.Log.log("获取好友列表时发生错误，错误码："+i.error.code);else{if(app.Log.log(JSON.stringify(i)),i.friends)for(var n=0;n<i.friends.length;n++){var a=i.friends[n];e._friend_list.push(a)}e.friend_max_count=i.friend_max_count}}),this._friendapply_list=[],app.NetAgent.sendReq2Lobby("Lobby","fetchFriendApplyList",{},function(t,i){if(t||i.error)app.Log.log("获取好友申请列表发生错误");else if(app.Log.log(JSON.stringify(i)),i.applies)for(var n=0;n<i.applies.length;n++)e._friendapply_list.push(i.applies[n])}),app.NetAgent.AddListener2Lobby("NotifyFriendViewChange",Laya.Handler.create(this,this._onFriendViewChange,null,!1)),app.NetAgent.AddListener2Lobby("NotifyFriendStateChange",Laya.Handler.create(this,this._onFriendStateChange,null,!1)),app.NetAgent.AddListener2Lobby("NotifyFriendChange",Laya.Handler.create(this,this._onFriendChange,null,!1)),app.NetAgent.AddListener2Lobby("NotifyNewFriendApply",Laya.Handler.create(this,this._onFriendApplyChange,null,!1))},Object.defineProperty(e,"friend_list",{get:function(){return this._friend_list},enumerable:!0,configurable:!0}),Object.defineProperty(e,"friendapply_list",{get:function(){return this._friendapply_list},enumerable:!0,configurable:!0}),e.find=function(e){for(var t=0;t<this._friend_list.length;t++)if(this._friend_list[t].base.account_id==e)return this._friend_list[t];return null},e._onFriendStateChange=function(e){app.Log.log(JSON.stringify(e));var t=this.find(e.target_id);null!=t?(e=e.active_state)&&(null!=e.login_time&&void 0!=e.login_time&&(t.state.login_time=e.login_time),null!=e.logout_time&&void 0!=e.logout_time&&(t.state.logout_time=e.logout_time),t.state.playing=e.playing,null!=e.is_online&&void 0!=e.is_online&&(t.state.is_online=e.is_online),this.triggerMsg({type:"singlechange",account_id:t.base.account_id})):app.Log.Error("收到并非好友的人的信息:"+JSON.stringify(e))},e._onFriendViewChange=function(e){var t=this.find(e.target_id);null!=t?(null!=e.base.avatar_id&&void 0!=e.base.avatar_id&&(t.base.avatar_id=e.base.avatar_id),null!=e.base.title&&void 0!=e.base.title&&(t.base.title=e.base.title),null!=e.base.nickname&&void 0!=e.base.nickname&&(t.base.nickname=e.base.nickname),null!=e.base.level&&void 0!=e.base.level&&(t.base.level=e.base.level),this.triggerMsg({type:"singlechange",account_id:t.base.account_id})):app.Log.Error("收到并非好友的人的信息:"+JSON.stringify(e))},e.addListener=function(e){this.removeListener(e),this._listener.push(e)},e.removeListener=function(e){for(var t=0;t<this._listener.length;t++)if(this._listener[t]===e){this._listener[t]=this._listener[this._listener.length-1],this._listener.pop();break}},e.triggerMsg=function(e){for(var t=0;t<this._listener.length;t++)this._listener[t]&&this._listener[t].runWith(e)},e.removeFriend=function(e){for(var t=0;t<this._friend_list.length;t++)if(this._friend_list[t].base.account_id==e){for(var i=t;i<this._friend_list.length-1;i++)this._friend_list[i]=this._friend_list[i+1];this._friend_list.pop();break}},e._onFriendChange=function(e){var t=e.account_id;1==e.type?this.friend_list.push(e.friend):2==e.type&&this.removeFriend(t),this.triggerMsg({type:"listchange"})},e._onFriendApplyChange=function(e){for(t=0;t<this._friendapply_list.length;t++)if(this._friendapply_list[t].account_id==e.account_id)return void(this._friendapply_list[t].apply_time=e.apply_time);if(this._friendapply_list.push({account_id:e.account_id,apply_time:e.apply_time}),e.removed_id)for(var t=0;t<this._friendapply_list.length;t++)if(this._friendapply_list[t].account_id==e.removed_id){for(var i=0;i<this._friendapply_list.length-1;i++)this._friendapply_list[i]=this._friendapply_list[i+1];this._friendapply_list.pop();break}},e.delFriendApply=function(e){for(var t=0;t<this._friendapply_list.length;t++)if(this._friendapply_list[t].account_id==e){for(var i=t;i<this._friendapply_list.length-1;i++)this._friendapply_list[i]=this._friendapply_list[i+1];this._friendapply_list.pop();break}},e._friend_list=[],e._listener=[],e._friendapply_list=[],e.friend_max_count=0,e}();e.FriendMgr=t}(game||(game={}));var game;!function(e){var t=function(){function e(t,n){var a=this;this.id=0,this._loaded=!1,this._destoryed=!1,this._root=null,this.id=e.IDcount++,this.url=t,this._loaded=!1,this._destoryed=!1,this._root=new Laya.Sprite3D,this._root.active=!0,this._root.on("undisplay",this,function(){a._root.destroyed&&(a._destoryed||a.destory())});Laya.timer.currTimer;i.try2get_effect(t,Laya.Handler.create(this,function(){if(null==a._root||a._root.destroyed||a._destoryed);else{a._loaded=!0;var e=Laya.loader.getRes(t);e&&e instanceof Laya.Sprite3D&&(n&&(e=e.clone()),a._root.addChild(e),e.transform.localPosition=new Laya.Vector3(0,0,0),e.active=!0)}}))}return Object.defineProperty(e.prototype,"loaded",{get:function(){return this._loaded},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"destoryed",{get:function(){return this._destoryed},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),e.prototype.destory=function(){this._destoryed||(this._destoryed=!0,this._root&&!this._root.destroyed&&this._root.destroy(!0),this._loaded&&(this._destoryed=!0),i.on_effectbase_destory(this.url))},e.IDcount=0,e}();e.EffectBase=t;var i=function(){function e(){}return e.init=function(e){var t=this;Laya.loader.load("d3_prefab.json",Laya.Handler.create(this,function(){t.d3res_map=Laya.loader.getRes("d3_prefab.json"),e&&e.run()}))},e.try2get_effect=function(e,t){var i=this;this._preload_effects_count.hasOwnProperty(e)&&this._preload_effects_count[e]>0?(this._effect_status.hasOwnProperty(e)||(this._effect_status[e]={status:0,count:0,listeners:[]}),this._effect_status[e].count++,0==this._effect_status[e].status?(this._effect_status[e].listeners.push(t),this._effect_status[e].status=1,Laya.loader.create(e,Laya.Handler.create(this,function(){i._effect_status[e].status=2;for(var t=0;t<i._effect_status[e].listeners.length;t++)i._effect_status[e].listeners[t].run();i._effect_status[e].listeners=[]}),null,null,[],0)):1==this._effect_status[e].status?this._effect_status[e].listeners.push(t):t.run()):app.Log.Error("EffectMgr "+e+"使用前并未预热")},e.on_effectbase_destory=function(e){if(this._effect_status.hasOwnProperty(e)&&(this._effect_status[e].count--,this._effect_status[e].count<=0)){var t=Laya.loader.getRes(e);t&&t.destroy(!0),this._effect_status[e].count=0,this._effect_status[e].status=0}},e.force_dispose_3d_res=function(e){for(var t=this.d3res_map[e],i=0;i<t.length;i++){var n=Laya.loader.getRes(t[i]);n&&n.dispose()}},e.preheat_3d_effect=function(e,t,i,n,a){for(var r=[],o=0;o<e.length;o++){var s=e[o];if(this._preload_effects_count.hasOwnProperty(s)||(this._preload_effects_count[s]=0),0==this._preload_effects_count[s]&&(r.push(s),this.d3res_map.hasOwnProperty(s)))for(var h=this.d3res_map[s],l=0;l<h.length;l++){var c=h[l];this._res_count.hasOwnProperty(c)?this._res_count[c]++:this._res_count[c]=1}this._preload_effects_count[s]++}this._prehead_3d_effect(r,t,i,n,a)},e._prehead_3d_effect=function(e,t,i,n,a){var r=this;if(0==e.length)return a.runWith(1),void n.run();var o=0,s=i?5:2;a.runWith(0);var h=function(){if(o>=e.length)return a.runWith(1),void n.run();a.runWith(o/e.length);for(var l=[],c=0;c<s&&o<e.length;c++)l.push(e[o++]);for(var p="",c=0;c<l.length;c++)0!=c&&(p+=","),p+=l[c];app.Log.log("preheart_list:"+p),Laya.loader.create(l,Laya.Handler.create(r,function(){Laya.timer.frameOnce(1,r,function(){for(var e=function(e){var n=l[e].url,a=Laya.loader.getRes(n);if(a)t.addChild(a),a.transform.position=i?new Laya.Vector3(1e4,1e4,1e4):new Laya.Vector3(0,0,0),a.active=!0,Laya.timer.frameOnce(6,r,function(){var e=Laya.loader.getRes(n);e&&e.destroy(!0)});else{var o={};o.error="preheart effect url:"+n+" 为null",o.stack="",o.method="_prehead_3d_effect",o.name="_prehead_3d_effect",GameMgr.Inst.onFatalError(o,!1)}},n=0;n<l.length;n++)e(n);Laya.timer.frameOnce(10,r,function(){h()})})}))};h()},e.dispose_3d_effect=function(e){for(var t=0;t<e.length;t++){var i=e[t];if(app.Log.log("dispose_3d_effect:"+i),this._preload_effects_count.hasOwnProperty(i)&&this._preload_effects_count[i]>0){if(this._preload_effects_count[i]--,0==this._preload_effects_count[i]){if(this.d3res_map.hasOwnProperty(i))for(var n=this.d3res_map[i],a=0;a<n.length;a++){var r=n[a];if(this._res_count.hasOwnProperty(r)&&this._res_count[r]>0){if(this._res_count[r]--,0==this._res_count[r]){var o=Laya.loader.getRes(r);o&&(o.clearTexture?o.clearTexture():o.dispose())}}else app.Log.Error("资源释放过多次1："+i)}var s=Laya.loader.getRes(i);s&&s.destroy(!0)}}else app.Log.Error("资源释放过多次0："+i)}},e.create_d3_effect=function(e,i){void 0===i&&(i=!1);return new t(e,i).root},e.d3res_map=null,e._ui_effects=[],e._preload_effects_count={},e._res_count={},e._effect_status={},e}();e.EffectMgr=i}(game||(game={}));var mjcore;!function(e){var t;!function(e){e[e.p=0]="p",e[e.m=1]="m",e[e.s=2]="s",e[e.z=3]="z"}(t=e.E_MJPai||(e.E_MJPai={}));var i=function(){function e(){}return e.prototype.IsZ=function(){return this.type==t.z},e.prototype.IsLaoTou=function(){return this.type!=t.z&&(1==this.index||9==this.index)},e.prototype.IsYao=function(){return this.IsZ()||this.IsLaoTou()},e.prototype.IsSiXi=function(){return this.IsZ()&&this.index>=1&&this.index<=4},e.prototype.IsSanYan=function(){return this.IsZ()&&this.index>=5&&this.index<=7},e.prototype.Clone=function(){var t=new e;return t.type=this.type,t.index=this.index,t.dora=this.dora,t},e.prototype.numValue=function(){var e=0;switch(this.type){case t.m:e=this.index;break;case t.p:e=1e4+this.index;break;case t.s:e=2e4+this.index;break;case t.z:e=3e4+10*this.index}return e},e.Create=function(i){var n=new e;switch("0"==i.charAt(0)?(n.dora=!0,n.index=5):(n.dora=!1,n.index=+i.charAt(0)),i.charAt(1)){case"z":n.type=t.z;break;case"m":n.type=t.m;break;case"s":n.type=t.s;break;case"p":n.type=t.p}return n},e.RandomCreate=function(){var i=new e,n=Math.random();return n<.22?(i.type=t.z,i.index=Math.floor(7*Math.random())+1):(i.type=n<.48?t.p:n<.74?t.s:t.m,i.index=Math.floor(9*Math.random())+1),i},e.isSame=function(e,t){return e.type==t.type&&e.index==t.index&&e.dora==t.dora},e.Distance=function(e,t){return e.numValue()-t.numValue()},e.DoraMet=function(e,i){if(e.type!=i.type)return!1;var n=i.index+1;return i.type==t.z?i.index<=4?5==n&&(n=1):8==n&&(n=5):10==n&&(n=1),n==e.index},e.prototype.toString=function(){var e=this.dora?"0":this.index.toString();switch(this.type){case t.m:e+="m";break;case t.p:e+="p";break;case t.s:e+="s";break;default:e+="z"}return e},e}();e.MJPai=i;var n=function(){return function(){}}();e.MJQiPai=n;var a;!function(e){e[e.shunzi=0]="shunzi",e[e.kezi=1]="kezi",e[e.gang_ming=2]="gang_ming",e[e.gang_an=3]="gang_an"}(a=e.E_Ming||(e.E_Ming={}));var r=function(){function e(){this.pais=[],this.from=[]}return e.prototype.Clone=function(){var t=new e;t.type=this.type,t.pais=[];for(i=0;i<this.pais.length;i++)t.pais.push(this.pais[i].Clone());t.from=[];for(var i=0;i<this.from.length;i++)t.from.push(this.from[i]);return t},e.prototype.toString=function(){var e="";switch(this.type){case a.shunzi:e+="shunzi(";break;case a.kezi:e+="kezi(";break;case a.gang_ming:e+="minggang(";break;case a.gang_an:e+="angang("}for(var t=0;t<this.pais.length;t++)0!=t&&(e+=","),e+=this.pais[t].toString();return e+=")"},e}();e.MJMing=r;!function(e){e[e.none=0]="none",e[e.dapai=1]="dapai",e[e.eat=2]="eat",e[e.peng=3]="peng",e[e.an_gang=4]="an_gang",e[e.ming_gang=5]="ming_gang",e[e.add_gang=6]="add_gang",e[e.liqi=7]="liqi",e[e.zimo=8]="zimo",e[e.rong=9]="rong",e[e.jiuzhongjiupai=10]="jiuzhongjiupai"}(e.E_PlayOperation||(e.E_PlayOperation={}));!function(e){e[e.none=0]="none",e[e.jiuzhongjiupai=1]="jiuzhongjiupai",e[e.sifenglianda=2]="sifenglianda",e[e.sigangsanle=3]="sigangsanle",e[e.sijializhi=4]="sijializhi",e[e.sanjiahule=5]="sanjiahule"}(e.E_LiuJu||(e.E_LiuJu={}));!function(e){e[e.liuju=0]="liuju",e[e.shaoji=1]="shaoji",e[e.zimo=2]="zimo",e[e.rong=3]="rong",e[e.fangchong=4]="fangchong",e[e.beizimo=5]="beizimo"}(e.E_Round_Result||(e.E_Round_Result={}))}(mjcore||(mjcore={}));var game;!function(e){var t=function(){function e(){}return e.prototype.recover_pre_order=function(e){return!1},e.prototype.getGoodsInfo=function(e){return null},e.prototype.onGameStart=function(){},e.prototype.want2BuyItem=function(e,t){},e}();e.AppShop=t}(game||(game={}));var app;!function(e){var t=function(){function e(){}return e._init=function(){if(null==this._tmpCookie){this._tmpCookie={};for(var e=document.cookie.split(";"),t=0;t<e.length;t++){var i=e[t].split("=");if(i&&i.length>=2){for(var n=i[0];" "==n.charAt(0);)n=n.substring(1);this._tmpCookie[n]=i[1]}}}},e.setCookie=function(e,t){this._init();new Date;document.cookie=e+"="+t+";max-age="+2592e3.toString(),this._tmpCookie[e]=t},e.getCookie=function(e){return this._init(),this._tmpCookie.hasOwnProperty(e)?this._tmpCookie[e]:""},e._tmpCookie=null,e}();e.CookieMgr=t}(app||(app={}));var lqc;!function(e){var t=function(){function e(e,t,i,n){var a=this;this.table_=e,this.sheet_=t,this.rows_=i||[],this.map_={},this.minKey_=null,this.maxKey_=null,i.sort(function(e,t){return e[n]-t[n]}),i.length>0&&(this.minKey_=i[0][n],this.maxKey_=i[i.length-1][n]),i.forEach(function(e){var t=e[n];a.map_[t]=e})}return e.prototype.get=function(e){return this.map_[e]},e.prototype.find=function(e){if(!this.map_[e])throw new Error("ERR_CONFIG_ROW_NOT_FIND");return this.map_[e]},e.prototype.forEach=function(e){this.rows_.forEach(e)},Object.defineProperty(e.prototype,"table",{get:function(){return this.table_},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sheet",{get:function(){return this.sheet_},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"count",{get:function(){return this.rows_.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minKey",{get:function(){return this.minKey_},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxKey",{get:function(){return this.maxKey_},enumerable:!0,configurable:!0}),e}();e.UniqueSheet=t;var i=function(){function e(e,t,i){this.table_=e,this.sheet_=t,this.rows_=i||[]}return e.prototype.forEach=function(e){this.rows_.forEach(e)},Object.defineProperty(e.prototype,"table",{get:function(){return this.table_},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sheet",{get:function(){return this.sheet_},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"count",{get:function(){return this.rows_.length},enumerable:!0,configurable:!0}),e}();e.NoKeySheet=i;var n=function(){function e(e,t,i,n){var a=this;this.table_=e,this.sheet_=t,this.rows_=i||[],this.groups_={},this.rows_.forEach(function(e){var t=e[n];a.groups_[t]||(a.groups_[t]=[]);a.groups_[t].push(e)})}return e.prototype.getGroup=function(e){return this.groups_[e]},e.prototype.findGroup=function(e){if(!this.groups_[e])throw new Error("ERR_CONFIG_ROW_NOT_FIND");return this.groups_[e]},e.prototype.forEach=function(e){this.rows_.forEach(e)},e.prototype.forEachGroup=function(e){var t=this;Object.keys(this.groups_).forEach(function(i){e(t.groups_[i],i)})},Object.defineProperty(e.prototype,"table",{get:function(){return this.table_},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sheet",{get:function(){return this.sheet_},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"count",{get:function(){return this.rows_.length},enumerable:!0,configurable:!0}),e}();e.GroupSheet=n;var a=function(){function e(e){this.value_=e,this.ref_=null}return e.prototype.resolve=function(e){this.ref_=e},Object.defineProperty(e.prototype,"value",{get:function(){return this.value_},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ref",{get:function(){return this.ref_},enumerable:!0,configurable:!0}),e}();e.ReferenceField=a}(lqc||(lqc={}));var cfg=function(){function e(){}return e.load=function(e){var t=this,i={};e.forEach(function(e){i[e.table]||(i[e.table]={});var t=[];e.rows.forEach(function(i){var n={};e.header.forEach(function(e){n[e.field_name]=i[e.field_name]}),t.push(n)});var n=null;switch(e.meta.category){case"unique":n=new lqc.UniqueSheet(e.table,e.sheet,t,e.meta.key);break;case"nokey":n=new lqc.NoKeySheet(e.table,e.sheet,t);break;case"group":n=new lqc.GroupSheet(e.table,e.sheet,t,e.meta.key);break;case"kv":n={},t.forEach(function(t){var i=t[e.meta.key];n[i]=t})}n&&(i[e.table][e.sheet]=n)}),Object.keys(i).forEach(function(e){t[e]=i[e]})},e}(),bin;!function(e){var t=function(){function e(){}return e.prototype.mini_info=function(){return{table:this.table,sheet:this.sheet,meta:this.meta,fields:this.fields.map(function(e){return{field_name:e.field_name,pb_type:e.pb_type,array_length:e.array_length}}),kvs:this.kvs}},e}(),i=function(){return function(e){this.name=e,this.sheets=[]}}(),n=function(){return function(e){this.name=e,this.sheets={}}}(),a=function(){function e(){this.root=new protobuf.Root,this.schemas=[],this.datas=[]}return e.pb_classname=function(e,t){return e+"_"+t},e.prototype.parseSync=function(a,r){this.root=protobuf.parse(a,{keepCase:!0}).root;for(var o=this.root.lookupType("lq.config.ConfigTables").decode(r),s=o.schemas,h={},l=0,c=s;l<c.length;l++)for(var p=(O=c[l]).name,u=0,d=O.sheets;u<d.length;u++){I=(F=d[u]).name;h[M=e.pb_classname(p,I)]=F;for(var _=new protobuf.Type(M),m=0,f=F.fields;m<f.length;m++){var g=f[m],y=g.array_length>0?"repeated":"optional",v=new protobuf.Field(g.field_name,g.pb_index,g.pb_type,y);_.add(v)}this.root.add(_)}for(var x={},b=0,w=o.datas;b<w.length;b++){var S=w[b],p=S.table,I=S.sheet,M=e.pb_classname(p,I);if(_=this.root.lookupType(M)){if(h[M]){x[M]||(x[M]=[]);for(var C=0,k=S.data;C<k.length;C++){var E=k[C];x[M].push(_.decode(E))}}}}for(var T=0,L=s;T<L.length;T++){var p=(O=L[T]).name,D=new i(p);this.schemas.push(D);for(var N=function(i){var n=i.name,a=e.pb_classname(p,n),r=new t;if(r.table=p,r.sheet=n,r.meta=i.meta,r.fields=i.fields.map(function(e){return{field_name:e.field_name,array_length:e.array_length,pb_type:e.pb_type,comment:null}}),"kv"===r.meta.category){var o=x[a];o&&(r.kvs=o.map(function(e){return e[r.meta.key]}))}D.sheets.push(r)},A=0,R=O.sheets;A<R.length;A++){N(F=R[A])}}for(var B=0,P=s;B<P.length;B++){var O=P[B],p=O.name,D=new n(p);this.datas.push(D);for(var V=0,U=O.sheets;V<U.length;V++){var F=U[V],I=F.name,M=e.pb_classname(p,I);D[I]=x[M]}}},e.prototype.exportSchema=function(){return this.schemas},e.prototype.exportData=function(){return this.datas},e}();e.BinParser=a;var r=function(){function e(e,t){var i=this;this.schema={},this.data={},e.forEach(function(e){i.schema[e.name]=e}),t.forEach(function(e){i.data[e.name]=e})}return e.prototype.toFormat=function(){var e=this,t=[];return Object.keys(this.schema).forEach(function(i){var n=e.schema[i],a=e.data[i];a&&n.sheets.forEach(function(e){var i={};i.table=e.table,i.sheet=e.sheet,i.meta=e.meta,i.header=e.fields.map(function(e){return{field_name:e.field_name,array_length:e.array_length,pb_type:e.pb_type}}),i.rows=a[e.sheet],t.push(i)})}),t},e}();e.TSDataFormat=r}(bin||(bin={}));var capsui;!function(e){var t=function(){function e(){this._data=null,this._me=null,this.active=!1}return Object.defineProperty(e.prototype,"me",{get:function(){return this._me},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"owner",{set:function(e){this._me=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"copydata",{set:function(e){this._data=e},enumerable:!0,configurable:!0}),e.prototype.getNodeClone=function(){var e=Laya.View.createComp(this._data);return this.me.parent.addChild(e),e},e}();e.UICopy=t}(capsui||(capsui={}));var capsui;!function(e){var t=function(){function e(){}return e._dfs_idmap=function(e,t,i){if(t.compId&&(i[t.compId]=e),t.child)for(var n=0;n<t.child.length;n++){var a=t.child[n];if(a.props&&a.props.name){var r=e.getChildByName(a.props.name);r&&this._dfs_idmap(r,a,i)}}},e.createFrameAnimation=function(e,t,i,n){var a=t;if(!a.animations||0==a.animations.length)return null;var r=null;if(""==n)r=a.animations[0];else for(c=0;c<a.animations.length;c++)if(a.animations[c].name==n){r=a.animations[c];break}if(null==r)return null;var o={},s=t;if(""!=i)for(var h=i.split("/"),l=0;l<h.length;l++){if(!s.child)return null;for(var c=0;c<s.child.length;c++){var p=s.child[c];p.props&&p.props.name&&p.props.name==h[l]&&(s=p)}}this._dfs_idmap(e,s,o);var u=new Laya.FrameAnimation;return u._setUp(o,r),u.stop(),u},e}();e.UIAnim=t}(capsui||(capsui={}));var capsui;!function(e){var t=function(){function e(e,t){var i=this;this.me=e,this.render_page=t,this.btn_left=this.me.getChildByName("btn_left");this.btn_left.clickHandler=Laya.Handler.create(this,function(){i.change_page(i.current_index-1,!1)},null,!1),this.btn_right=this.me.getChildByName("btn_right"),this.btn_right.clickHandler=Laya.Handler.create(this,function(){i.change_page(i.current_index+1,!1)},null,!1),this.label_current_page=this.me.getChildByName("curr_page"),this.btn_page=this.me.getChildByName("btn_page"),this.btn_page.clickHandler=Laya.Handler.create(this,function(){i.page_show_locking||i._show_page_choose()},null,!1),this.container_pages=this.me.getChildByName("container_pages"),this.container_pages.getChildByName("close").clickHandler=Laya.Handler.create(this,function(){i.page_show_locking||i._close_page_choose()},null,!1),this.scroll_pages=this.container_pages.getChildByName("bg").scriptMap["capsui.CScrollView"],this.scroll_pages.init_scrollview(Laya.Handler.create(this,this._render_page_choose_item,null,!1))}return e.prototype.reset=function(){this.me.visible=!1,this.container_pages.visible=!1,this.scroll_pages.reset(),this.btn_left.visible=!1,this.btn_right.visible=!1,this.btn_page.visible=!1,this.page_show_locking=!1,this.current_index=-1,this.label_current_page.text=""},e.prototype.set_total_page_count=function(e){this.total_count=e,this.me.visible=this.total_count>0,this.btn_page.visible=this.total_count>1,this.btn_left.visible=this.current_index>0,this.btn_right.visible=this.current_index+1<this.total_count,this.change_page(this.current_index,!1)},e.prototype.change_page=function(e,t){e>=this.total_count&&(e=this.total_count-1),e<0&&(e=0),(t||this.current_index!=e)&&(this.current_index=e,this.btn_left.visible=this.current_index>0,this.btn_right.visible=this.current_index+1<this.total_count,this.label_current_page.text=(this.current_index+1).toString(),this.render_page&&this.render_page.runWith(e))},e.prototype._show_page_choose=function(){var e=this;if(this.total_count<=1)this.page_show_locking=!1;else{this.container_pages.visible=!0,this.scroll_pages.reset(),this.scroll_pages.addItem(this.total_count);var t=this.container_pages.getChildByName("bg"),i=t.getChildByName("content");this.total_count<=3?(i.height=54*this.total_count,t.height=i.height,t.y=this.container_pages.height-t.height):(i.height=this.container_pages.height,t.height=i.height,t.y=0),t.alpha=0,Laya.Tween.to(t,{alpha:1},150),Laya.timer.once(150,this,function(){e.page_show_locking=!1})}},e.prototype._close_page_choose=function(){var e=this,t=this.container_pages.getChildByName("bg");Laya.Tween.to(t,{alpha:0},150),this.page_show_locking=!0,Laya.timer.once(150,this,function(){e.page_show_locking=!1,e.container_pages.visible=!1})},e.prototype._render_page_choose_item=function(e){var t=this,i=e.index,n=e.container;n.getChildByName("btn").clickHandler=Laya.Handler.create(this,function(){t.page_show_locking||(t.change_page(i,!1),t._close_page_choose())},null,!1),n.getChildByName("page").text=(i+1).toString()},e}();e.PageController=t}(capsui||(capsui={}));var capsui;!function(e){var t=function(){function e(){this._data=null,this._me=null,this.items=[],this.lines=[]}return Object.defineProperty(e.prototype,"locking",{get:function(){return this._locking},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"me",{get:function(){return this._me},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"owner",{set:function(e){this._me=e,Laya.timer.frameOnce(3,this,this.onCreate)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"choosed_index",{get:function(){return this._choosed_index},enumerable:!0,configurable:!0}),e.prototype.onCreate=function(){var e=this;this.out=this.me.getChildByName("out"),this.bg=this.me.getChildByName("bg"),this.line=this.me.getChildByName("line"),this.item_templete=this.me.getChildByName("templete"),this.content=this.me.getChildByName("content"),this.content.vScrollBarSkin="myres/vscroll.png",this.content.vScrollBar.visible=!1,this.item_templete.visible=!1;for(var t=this.item_templete.scriptMap["capsui.UICopy"],i=0;i<10;i++){var n=t.getNodeClone();this.content.addChild(n),this.items.push(n)}for(i=0;i<12;i++){var a=this.line.scriptMap["capsui.UICopy"].getNodeClone();this.content.addChild(a),this.lines.push(a)}this.item_templete.visible=!0,this.item_templete.clickHandler=Laya.Handler.create(this,function(){e._locking||(e.out.visible?e.up():e.down())},null,!1),this.out.clickHandler=Laya.Handler.create(this,function(){e._locking||e.up()},null,!1)},e.prototype.init=function(e,t){this._render=e,this._onChange=t},e.prototype.reset_show=function(e,t){this.out.visible=!1,this.line.visible=!1,this.content.visible=!1,this.bg.height=this.item_templete.height,this._value_count=t,this._choosed_index=e,this._render.runWith({index:e,container:this.item_templete}),this._locking=!1},e.prototype.down=function(){var e=this;this._locking=!0,this.out.visible=!0;for(n=0;n<this.items.length;n++)this.items[n].visible=!1;this.content.visible=!1,this.line.visible=!0,this.line.y=this.item_templete.height,this.content.y=this.item_templete.height+this.line.height;for(var t=function(t){t<i._value_count?(0!=t&&(i.lines[t-1].visible=!0,i.lines[t-1].y=i.item_templete.height*t+i.line.height*(t-1)),i._render.runWith({index:t,container:i.items[t]}),i.items[t].visible=!0,i.items[t].y=(i.item_templete.height+i.line.height)*t,i.items[t].clickHandler=Laya.Handler.create(i,function(){e._locking||(e.up(),e._choosed_index!=t&&(e._choosed_index=t,e._render.runWith({index:t,container:e.item_templete}),e._onChange.runWith(e._choosed_index)))},null,!1)):i.items[t].visible=!1},i=this,n=0;n<this.items.length;n++)t(n);if(this.content.visible=!0,this.content.alpha=0,this._value_count<=3){a=(this.item_templete.height+this.line.height)*(this._value_count+1);this.content.height=(this.item_templete.height+this.line.height)*this._value_count,Laya.Tween.to(this.bg,{height:a},150,Laya.Ease.strongOut),Laya.Tween.to(this.content,{alpha:1},150)}else{var a=4.5*(this.item_templete.height+this.line.height);this.content.height=3.4*(this.item_templete.height+this.line.height),Laya.Tween.to(this.bg,{height:a},150,Laya.Ease.strongOut),Laya.Tween.to(this.content,{alpha:1},150)}this.line.alpha=0,Laya.Tween.to(this.line,{alpha:1},150),Laya.timer.once(150,this,function(){e._locking=!1})},e.prototype.up=function(){var e=this;this._locking=!0;var t=this.item_templete.height;Laya.Tween.to(this.bg,{height:t},150,Laya.Ease.strongOut),Laya.Tween.to(this.content,{alpha:0},150),Laya.Tween.to(this.line,{alpha:0},150),Laya.timer.once(150,this,function(){e.out.visible=!1,e.line.visible=!1,e.content.visible=!1,e._locking=!1})},e}();e.CDropdown=t}(capsui||(capsui={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),basic;!function(e){var t=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.Clone=function(){for(var e=new t,i=0;i<this.length;i++)e.push(this[i]);return e},t.prototype.RemoveAt=function(e){if(!(e<0||e>=this.length)){var t=this[e];return this[e]=this[this.length-1],this[this.length-1]=t,this.pop()}},t.prototype.RemoveX=function(e){for(var t=0;t<this.length;t++)if(this[t]===e){this.RemoveAt(t);break}return this},t}(Array);e.Seq=t}(basic||(basic={}));var basic;!function(e){var t=function(){return function(){this.key=null,this.val=null}}();e.Pair=t}(basic||(basic={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),anim;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.mat=null,t.tick=2e3,t.lasttime=0,t}return __extends(t,e),t.prototype._load=function(e){this.mat=e.meshRender.material,this.lasttime=0,Laya.timer.frameLoop(1,this,this.update)},t.prototype.update=function(){if(this.destroyed)Laya.timer.clearAll(this);else if(this.enable){var e=Laya.timer.currTimer-this.lasttime;e>=this.tick&&(e=0,this.lasttime=Laya.timer.currTimer);var t=0;t=e<this.tick/2?2*e/this.tick:1-(e-this.tick/2)/(this.tick/2);var i=this.mat.albedoColor.clone();i.w=1-t,this.mat.albedoColor=i}else this.lasttime=0},t}(Laya.Script);e.Bling=t}(anim||(anim={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),anim;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.mat=null,t}return __extends(t,e),t.prototype._load=function(e){this.mat=e.meshRender.material,Laya.timer.frameLoop(1,this,this.update)},t.prototype.update=function(){if(this.destroyed)Laya.timer.clearAll(this);else if(this.enable){if(t.lastupdateframe<Laya.timer.currFrame)if(t.lastupdateframe<Laya.timer.currFrame-10)t.lastupdateframe=Laya.timer.currFrame,t.lastupdatetime=Laya.timer.currTimer;else{t.lastupdateframe=Laya.timer.currFrame;var e=(Laya.timer.currTimer-t.lastupdatetime)/1e3;t.tilingOffset.w>=-.35?t.v+=2.2*e:t.tilingOffset.w>=-.65?(t.v-=1.6*e)<.1&&(t.v=.1):t.v=.3,t.tilingOffset.w-=t.v*e,t.tilingOffset.w<-1&&(t.tilingOffset.w=-.1,t.v=0),t.lastupdatetime=Laya.timer.currTimer}this.mat.tilingOffset=t.tilingOffset.clone()}},t.tilingOffset=new Laya.Vector4(.8,.2,0,0),t.lastupdateframe=0,t.lastupdatetime=0,t.v=0,t}(Laya.Script);e.RunUV=t}(anim||(anim={}));var capsui;!function(e){var t=function(){function e(){this._me=null,this._root_view=null}return Object.defineProperty(e.prototype,"me",{get:function(){return this._me},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"root_view",{get:function(){return this._root_view},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"owner",{set:function(e){var t=this;this._me=e,this._me.frameOnce(2,this,function(){for(var e=t._me;e&&!(e instanceof Laya.View);)e=e.parent;t._root_view=e,t._root_view&&(t._root_view.on("onenable",t,t._onEnable),t._root_view.on("ondisable",t,t._onDisable)),t.onCreate()})},enumerable:!0,configurable:!0}),e.prototype._onEnable=function(){!this.me||this.me.destroyed?this.onDestroy():this.onEnable()},e.prototype._onDisable=function(){!this.me||this.me.destroyed?this.onDestroy():this.onDisable()},e.prototype.onCreate=function(){},e.prototype.onEnable=function(){},e.prototype.onDisable=function(){},e.prototype.onDestroy=function(){this._root_view&&(this._root_view.off("onenable",this,this._onEnable),this._root_view.off("ondisable",this,this._onDisable))},e}();e.UIComponent=t}(capsui||(capsui={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),capsui;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.mousedowned=!1,t.origin_scale_x=1,t.origin_scale_y=1,t.starttime=0,t.origin_x=0,t}return __extends(t,e),t.prototype.onCreate=function(){this.origin_scale_x=this.me.scaleX,this.origin_scale_y=this.me.scaleY,this.me.on("mousedown",this,this.OnMouseDown),this.me.on("mouseup",this,this.OnMouseUp),this.me.on("mouseout",this,this.OnMouseUp),this.me.filters=[new Laya.ColorFilter([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0])]},t.prototype.onEnable=function(){this.me.scaleX=this.me.scaleY=1,this.origin_scale_x=this.me.scaleX,this.origin_scale_y=this.me.scaleY},t.prototype.onDisable=function(){this.mousedowned=!1,Laya.Tween.clearAll(this.me),this.me.destroyed||(this.me.scaleX=this.origin_scale_x,this.me.scaleY=this.origin_scale_y)},t.prototype.OnMouseDown=function(){this.mousedowned||(this.mousedowned=!0,this.origin_x=this.me.scaleX,this.starttime=Laya.timer.currTimer,Laya.timer.clear(this,this.DoAnim),Laya.timer.frameLoop(1,this,this.DoAnim))},t.prototype.OnMouseUp=function(){this.mousedowned&&(this.mousedowned=!1,this.origin_x=this.me.scaleX,this.starttime=Laya.timer.currTimer,Laya.timer.clear(this,this.DoAnim),Laya.timer.frameLoop(1,this,this.DoAnim))},t.prototype.DoAnim=function(){if(this.me&&!this.me.destroyed){var e=Laya.timer.currTimer-this.starttime,t=this.mousedowned?1.1:1;if(e>=50)this.me.scaleX=this.me.scaleY=t,Laya.timer.clear(this,this.DoAnim);else{var i=e/50;this.me.scaleX=this.me.scaleY=this.origin_x*(1-i)+t*i}}},t}(e.UIComponent);e.CButton=t}(capsui||(capsui={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),capsui;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.starttime=0,t}return __extends(t,e),t.prototype.onCreate=function(){this.img_round=this.me.getChildByName("flower").getChildByName("round"),this.img_shine=this.me.getChildByName("flower").getChildByName("shine")},t.prototype.onEnable=function(){this.starttime=Laya.timer.currTimer,this.refreshShow(),Laya.timer.frameLoop(1,this,this.refreshShow)},t.prototype.onDisable=function(){Laya.timer.clearAll(this)},t.prototype.refreshShow=function(){var e=Laya.timer.currTimer-this.starttime;e>2e3&&(e=0,this.starttime=Laya.timer.currTimer);var t=e/2e3;if(this.img_round.rotation=360*t,t<.5){i=2*t;this.img_shine.alpha=i*i}else{var i=2-2*t;this.img_shine.alpha=i*i}},t}(e.UIComponent);e.CLoading=t}(capsui||(capsui={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),capsui;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t._scrollbar=null,t._scrollpoint=null,t._drag_scroll=!1,t._container_items=null,t._content=null,t._templete=null,t._items=[],t._item_heights=[],t._total_height=0,t._rate=0,t._repeat_x=1,t._span_x=0,t._value_count=0,t._render_func=null,t}return __extends(t,e),Object.defineProperty(t.prototype,"rate",{get:function(){return this._rate},set:function(e){this._total_height<=this._content.height?this._content.vScrollBar.value=0:this._content.vScrollBar.value=(this._total_height-this._content.height)*e/1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value_count",{get:function(){return this._value_count},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"need_scroll",{get:function(){return this._total_height>this._content.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"total_height",{get:function(){return this._total_height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"view_height",{get:function(){return this._content.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"near_bottom",{get:function(){return this.total_height<=this.view_height||(1-this.rate)*this.value_count<.5},enumerable:!0,configurable:!0}),t.prototype.addItem=function(e,t){void 0===t&&(t=-1);var i=this._value_count;t<=0&&(t=this._templete.height);for(n=0;n<e;n++)this._item_heights.push(t);if(this._value_count+=e,this._repeat_x<=1?this._total_height+=t*e:this._total_height=t*Math.ceil(this._value_count/this._repeat_x),i>0)for(var n=0;n<this._items.length;n++)if(this._items[n].value_index==i-1){var a=this._items[n];this._render_func&&this._render_func.runWith({index:a.value_index,container:a.container,cache_data:a.cache_data})}this._onChange()},t.prototype.addItems=function(e){for(var t=this._value_count,i=0,n=0;n<e.length;n++)this._item_heights.push(e[n]),i+=e[n];if(this._value_count+=e.length,this._repeat_x<=1&&(this._total_height+=i),t>0)for(n=0;n<this._items.length;n++)if(this._items[n].value_index==t-1){var a=this._items[n];this._render_func&&this._render_func.runWith({index:a.value_index,container:a.container,cache_data:a.cache_data})}this._onChange()},t.prototype.delItem=function(e){for(var t=0;t<this._items.length;t++)this._items[t].value_index>=e&&(this._items[t].value_index==this.value_count-1||this._render_func.runWith({index:this._items[t].value_index,container:this._items[t].container,cache_data:this._items[t].cache_data}));this.popItem()},t.prototype.popItem=function(){if(0!=this._value_count){var e=this._item_heights[this._item_heights.length-1];this._total_height,this._rate;this._total_height-=e,this._value_count--,this._item_heights.pop(),this._onChange()}},t.prototype.onCreate=function(){var e=this,t=this.me.getChildByName("scrollbar");t&&(this._scrollbar=t,this._scrollpoint=t.getChildByName("scrollpoint")),this._content=this.me.getChildByName("content"),this._content.vScrollBarSkin="myres/vscroll.png",this._container_items=new Laya.Sprite,this._content.addChild(this._container_items),this._container_items.x=this._container_items.y=0,this._container_items.height=1e7,Laya.timer.frameOnce(2,this,function(){e._content.vScrollBar.visible=!1,e._content.vScrollBar.on("change",e,e._onChange)}),this._templete=this._content.getChildByName("templete"),this._templete.visible=!1,this._scrollbar&&(this._scrollbar.on("mousedown",this,function(){e._drag_scroll=!0,e.rate=e._scrollbar.mouseY/e._scrollbar.height}),this._scrollbar.on("mousemove",this,function(){e._drag_scroll&&(e.rate=e._scrollbar.mouseY/e._scrollbar.height)}),this._scrollbar.on("mouseup",this,function(){e._drag_scroll=!1}))},t.prototype.init_scrollview=function(e,t,i,n){if(void 0===t&&(t=-1),void 0===i&&(i=1),void 0===n&&(n=0),this._repeat_x=i,this._span_x=n,this._render_func=e,this._items.length>0){for(r=0;r<this._items.length;r++)this._container_items.removeChild(this._items[r].container),this._items[r].container.destroy();this._items=[]}t<=0&&(t=this._templete.height);var a=Math.ceil(this._content.height/t)+2;a*=this._repeat_x;for(var r=0;r<a;r++)this._items.push({container:this._templete.scriptMap["capsui.UICopy"].getNodeClone(),value_index:-1,cache_data:{}}),this._content.removeChild(this._items[r].container),this._container_items.addChild(this._items[r].container)},t.prototype.reset=function(){this._content.vScrollBar.stopScroll(),this._drag_scroll=!1,this._total_height=0,this._value_count=0,this._item_heights=[],this.rate=0,this._onRateChange(0)},t.prototype.change_render_handler=function(e){this.reset(),this._render_func=e},t.prototype._onChange=function(){var e=this._content.vScrollBar,t=1*e.value;if(this._total_height<=this._content.height)t>0?e.value=0:this._onRateChange(0);else if(t>this._total_height-this._content.height)e.value=(this._total_height-this._content.height)/1;else{var i=t/(this._total_height-this._content.height);this._onRateChange(i)}},t.prototype.scrollDelta=function(e){this.need_scroll&&(this._content.vScrollBar.value+=e)},t.prototype._onRateChange=function(e){var t=0;this._total_height<=this._content.height?(this._rate=0,this._scrollpoint&&(this._scrollpoint.y=0),this._scrollbar&&(this._scrollbar.visible=!1)):(this._rate=e,this._rate<0?this._rate=0:this._rate>1&&(this._rate=1),this._scrollbar&&(this._scrollbar.visible=!0),this._scrollpoint&&this._scrollbar&&(this._scrollpoint.y=this._scrollbar.height*this._rate),t=(this._total_height-this._content.height)*this._rate);for(var i=0,n=0,a=0;a<this._item_heights.length;a+=this._repeat_x){if(n+this._item_heights[a]>=t){i=a;break}n+=this._item_heights[a]}for(var r=i%this._items.length,a=0;a<this._items.length;a+=this._repeat_x){var o=i+a;if(o>=this._value_count||n-t>this._content.height)for(s=0;s<this._repeat_x;s++){(h=this._items[(r+a+s)%this._items.length]).container.visible=!1,h.value_index=-1}else{for(var s=0;s<this._repeat_x;s++){var h=this._items[(r+a+s)%this._items.length],l=o+s;l>=this.value_count?(h.container.visible=!1,h.value_index=-1):h.value_index!=l&&(h.container.visible=!0,h.value_index=l,h.container.y=n,h.container.x=(this._templete.width+this._span_x)*s,this._container_items.removeChild(h.container),this._container_items.addChild(h.container),this._render_func&&this._render_func.runWith({index:l,container:h.container,cache_data:h.cache_data}))}n+=this._item_heights[o]}}this.me.event("ratechange")},t.prototype.wantToRefreshItem=function(e){for(var t=0;t<this._items.length;t++)this._items[t].value_index==e&&this._render_func.runWith({index:e,container:this._items[t].container,cache_data:this._items[t].cache_data})},t.prototype.wantToRefreshAll=function(){for(var e=0;e<this._items.length;e++)this._items[e].value_index>=0&&this._render_func.runWith({index:this._items[e].value_index,container:this._items[e].container,cache_data:this._items[e].cache_data})},t}(e.UIComponent);e.CScrollView=t}(capsui||(capsui={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),capsui;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t._total_count=0,t._func_load=null,t._loading=null,t._duringLoading=!1,t._load_id=0,t}return __extends(t,e),Object.defineProperty(t.prototype,"total_count",{get:function(){return this._total_count},set:function(e){this._total_count=e,this._pendingLoad()},enumerable:!0,configurable:!0}),t.prototype.reset=function(){this._load_id=0,this._total_count=0,this._duringLoading=!1,this._loading.visible=!1,e.prototype.reset.call(this)},t.prototype.onCreate=function(){this._loading=this.me.getChildByName("loading"),this._loading.visible=!1,e.prototype.onCreate.call(this)},t.prototype.init_nolimitlist=function(e,t){this._func_load=e,this.init_scrollview(t)},t.prototype._onRateChange=function(t){e.prototype._onRateChange.call(this,t),this._pendingLoad()},t.prototype._pendingLoad=function(){var e=this;if(!this._duringLoading&&this._total_count>this.value_count&&(1-this.rate)*this.value_count<=3&&this._func_load){this._duringLoading=!0,this._load_id++;var t=this._load_id;this._func_load.runWith(this.value_count),Laya.timer.once(700,this,function(){e._duringLoading&&t==e._load_id&&(e._loading.visible=!0)})}},t.prototype.loadOver=function(e,t){this._duringLoading&&(this._duringLoading=!1,this._loading&&(this._loading.visible=!1),e?this.addItem(t):this._total_count=this.value_count)},t.prototype.popItem=function(){this._total_count--,e.prototype.popItem.call(this)},t}(e.CScrollView);e.NoLimitList=t}(capsui||(capsui={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),game;!function(e){var t=function(e){function t(){var i=e.call(this)||this;return i.inited=!1,t.Inst=i,i}return __extends(t,e),t.on_getSkuDetails=function(e){if(this.goods_info={},e){for(var t=0;t<e.length;t++){var i=e[t],n=i.productId;this.goods_info[n]=i}Laya.PlatformClass.createClass("layaair.majsoul.mjmgr").call("getGPOwnedItems")}},t.on_gp_get_owneditems=function(e){if(this.orders=[],e){for(a=0;a<e.length;a++){var t=e[a];this.orders.push({sku:t.sku,data:t.data,sign:t.sign})}for(var i=function(e){var t=n.orders[e];app.NetAgent.sendReq2Lobby("Lobby","solveGooglePlayOrder",{inapp_purchase_data:JSON.stringify(t.data),inapp_data_signature:t.sign},function(e,i){if(e);else if(i.error){var n=i.error.code;if(1901==n||1902==n){(a=Laya.PlatformClass.createClass("layaair.majsoul.mjmgr")).call("consumeGPItem",t.data.purchaseToken)}}else{var a=Laya.PlatformClass.createClass("layaair.majsoul.mjmgr");a.call("consumeGPItem",t.data.purchaseToken)}})},n=this,a=0;a<this.orders.length;a++)i(a)}},t.on_gp_buy_result=function(e,t){var i=e.productId;this.orders.push({sku:i,data:e,sign:t}),app.NetAgent.sendReq2Lobby("Lobby","solveGooglePlayOrder",{inapp_purchase_data:JSON.stringify(e),inapp_data_signature:t},function(t,i){if(t||i.error)uiscript.UIMgr.Inst.showNetReqError("solveGooglePlayOrder",t,i);else{Laya.PlatformClass.createClass("layaair.majsoul.mjmgr").call("consumeGPItem",e.purchaseToken)}})},t.on_consume_success=function(e){for(var t=0;t<this.orders.length;t++)if(this.orders[t].data.purchaseToken==e){this.orders[t]=this.orders[this.orders.length-1],this.orders.pop();break}},t.on_failed_info=function(e){uiscript.UIMgr.Inst&&uiscript.UIMgr.Inst.ShowErrorInfo(e)},t.on_gp_pay_cancel=function(){this.current_order_id&&""!=this.current_order_id&&(app.NetAgent.sendReq2Lobby("Lobby","cancelGooglePlayOrder",{order_id:this.current_order_id},function(e,t){(e||t.error)&&uiscript.UIMgr.Inst.showNetReqError("cancelGooglePlayOrder",e,t)}),this.current_order_id="")},t.on_gp_buy_error=function(e,t){if(1==t)app.NetAgent.sendReq2Lobby("Lobby","cancelGooglePlayOrder",{order_id:e},function(e,t){(e||t.error)&&uiscript.UIMgr.Inst.showNetReqError("cancelGooglePlayOrder",e,t)});else{var i="";switch(t){case 2:i="支付网络连接断开";break;case 3:i="所请求的类型不支持 Billing API 版本";break;case 4:i="该商品暂停出售";break;case 5:case 6:i="操作期间出现错误";break;case 7:i="未能购买，因为已经拥有此商品"}""!=i&&uiscript.UIMgr.Inst.ShowErrorInfo(i)}},t.prototype.recover_pre_order=function(e){for(var i="",n=cfg.mall.product.getGroup(10),a=0;a<n.length;a++)if(n[a].goods_id==e){i=n[a].product_id;break}if(""==i)return!1;for(var r=function(e){if(t.orders[e].sku==i){var n=t.orders[e];return app.NetAgent.sendReq2Lobby("Lobby","solveGooglePlayOrder",{inapp_purchase_data:JSON.stringify(n.data),inapp_data_signature:n.sign},function(e,t){if(e||t.error)if(t&&1902==t.error.code){(i=Laya.PlatformClass.createClass("layaair.majsoul.mjmgr")).call("consumeGPItem",n.data.purchaseToken)}else uiscript.UIMgr.Inst.showNetReqError("solveGooglePlayOrder",e,t);else{var i=Laya.PlatformClass.createClass("layaair.majsoul.mjmgr");i.call("consumeGPItem",n.data.purchaseToken)}}),{value:!0}}},a=0;a<t.orders.length;a++){var o=r(a);if("object"==typeof o)return o.value}return!1},t.prototype.getGoodsInfo=function(e){for(var i=cfg.mall.product.getGroup(10),n="",a=0;a<i.length;a++)if(i[a].goods_id==e){n=i[a].product_id;break}if(""==n)return null;if(t.goods_info[n]){var r=t.goods_info[n];return{currency_code:r.price_currency_code,price:r.price}}return null},t.prototype.onGameStart=function(){var e=cfg.mall.product.getGroup(10),t="";if(e){for(var i=0;i<e.length;i++)0!=i&&(t+=","),t+=e[i].product_id;Laya.PlatformClass.createClass("layaair.majsoul.mjmgr").call("gp_getSkuDetail",t)}},t.prototype.want2BuyItem=function(e,i){for(var n="",a=cfg.mall.product.getGroup(10),r=0;r<a.length;r++)if(a[r].goods_id==e){n=a[r].product_id;break}""!=n?app.NetAgent.sendReq2Lobby("Lobby","createBillingOrder",{goods_id:e,payment_platform:10,client_type:1,account_id:GameMgr.Inst.account_id},function(e,a){if(e||a.error)uiscript.UIMgr.Inst.showNetReqError("createBillingOrder",e,a),i.runWith(0);else{var r=a.order_id;t.current_order_id=r;Laya.PlatformClass.createClass("layaair.majsoul.mjmgr").call("gp_buySku",n,r),i.runWith(0)}}):i.runWith(1)},t.goods_info={},t.current_order_id="",t.orders=[],t}(e.AppShop);e.GooglePlayShop=t}(game||(game={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),game;!function(e){var t=function(){function e(){}return e.Create=function(e){var t=null;switch(e.t){case"s":(t=new i).init(e)}return t},e}();e.ChatInfoBase=t;var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.init=function(e){this.val=e.v;var t=uiscript.UI_LobbyChat.Inst.render_text;t.text=this.val,this._height=t.textWidth,this._height=t.textHeight},Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),t.prototype.render=function(e){var t=e.getChildByName("word");t.text=this.val,t.visible=!0},t}(t);e.ChatInfo_Str=i;var n=function(){function e(e){this.infos=[],this.lastTimeStamp=0,this.account_id=e,this.infos=[],this.lastTimeStamp=0}return e.prototype.addInfo=function(e,i,n){var a=t.Create(JSON.parse(i));return null==a?(app.Log.Error("未找到合适的聊天类型 data:"+i),!1):(a.timeStamp=e,this.infos.push({info:a,isme:n}),this.lastTimeStamp=e,!0)},e}();e.PersonChat=n;var a=function(){function e(){this.infos=[]}return e.prototype.addInfo=function(e){return null!=t.Create(e.content)&&(this.infos.push(e),!0)},e}();e.ChannelChat=a;var r=function(){function e(){this.chat_world=null,this.friend_chat=[]}return e.init=function(){this.Inst=new e,this.Inst._init()},e.prototype._init=function(){this.chat_world=new a,this.friend_chat=[],app.NetAgent.AddListener2Lobby("NotifyChatMessage",Laya.Handler.create(this,this._onReceiveChat,null,!1))},e.prototype._onReceiveChat=function(e){if(1==e.type)e.world_chat&&this.chat_world.addInfo(e.world_chat);else if(e.private_chat){var t=e.private_chat,i=0,n=!1;t.sender_id==GameMgr.Inst.account_id?(n=!0,i=t.target_id):(n=!1,i=t.sender_id);this.findFriend(i).addInfo(t.timestamp,t.content,n)}},e.prototype.findFriend=function(e){for(var t=null,i=0;i<this.friend_chat.length;i++)if(this.friend_chat[i].account_id==e){t=this.friend_chat[i];break}return null==t&&(t=new n(e),this.friend_chat.push(t)),t},e}();e.ChatMgr=r}(game||(game={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),game;!function(e){var t=function(t){function i(){var e=t.call(this)||this;return e.scene_path="scene/lobby.ls",e.bglst=["scene/Assets/Resource/lobby/yard.jpg","scene/Assets/Resource/lobby/indoor.jpg"],e.ui_effect_list=["scene/effect_get_character.lh","scene/effect_get_zhuangban.lh","scene/effect_heartup.lh","scene/effect_heartup_favor.lh","scene/effect_heartlevelup.lh","scene/effect_item_shine.lh","scene/effect_item_shine_big.lh"],e.scene_container=null,e.scene=null,e.bg_front_plane=null,e.bg_front_mat=null,e.bg_back_plane=null,e.bg_back_mat=null,e._current_bg="",e._change_start_time=0,e._during_change_bg=!1,e._check_idcard=!1,e._load_listener=[],e._progress_listener=[],i.Inst=e,e}return __extends(i,t),i.prototype.init=function(t){var i=this;this._load_state=e.E_LoadState.loading;var n=[];n.push("extendRes/charactor/default/full.png"),n.push("extendRes/charactor/default/half.png"),n.push("extendRes/charactor/default/smallhead.png"),n.push("extendRes/charactor/default/bighead.png"),n.push("extendRes/charactor/default/waitingroom.png"),n.push("extendRes/emo/default.png");for(var a=[302001,302002,302003,302004],r=0;r<a.length;r++){var o=cfg.item_definition.item.get(a[r]);n.push(o.icon),o.icon_transparent&&""!=o.icon_transparent&&n.push(o.icon_transparent)}n.push("extendRes/items/default.jpg"),cfg.level_definition.level_definition.forEach(function(e,t){n.push(e.primary_icon)}),this._loadaudio(),n.push("extendRes/items/gold0.png"),n.push("extendRes/items/gold1.png"),e.LoadMgr.loadResImage(n,Laya.Handler.create(this,function(){e.LoadMgr.loadRes(e.E_LoadType.common,Laya.Handler.create(i,function(){e.LoadMgr.loadRes(e.E_LoadType.lobby,Laya.Handler.create(i,function(){return Laya.timer.frameOnce(1,i,function(){e.EffectMgr.init(Laya.Handler.create(i,function(){i.onProgressUpdate(1),Laya.timer.frameOnce(5,i,function(){GameMgr.Inst.addScene(i.scene_container=new Laya.Sprite),i.scene_container.visible=!0,i._load_state=e.E_LoadState.loaded;for(var t=0;t<i._load_listener.length;t++)i._load_listener[t]&&i._load_listener[t].run();i._load_listener=[],i._progress_listener=[]})}))})}),Laya.Handler.create(i,function(e){return i.onProgressUpdate(.7+.3*e)},null,!1))}),Laya.Handler.create(i,function(e){return i.onProgressUpdate(.5+.2*e)},null,!1))}),Laya.Handler.create(this,function(e){return i.onProgressUpdate(.5*e)},null,!1))},i.prototype._loadaudio=function(){cfg.audio.audio.forEach(function(e){"lobby"==e.type&&Laya.loader.load(e.path+view.AudioMgr.suffix)}),Laya.loader.load("audio/music/lobby.mp3"),Laya.loader.load("audio/music/game.mp3")},i.prototype.buildScene=function(e,t){var i=this;if(this.scene)return t.runWith(1),void e.run();t.runWith(0),Laya.loader.create(this.scene_path,Laya.Handler.create(this,function(){t.runWith(.3);for(var n=[],a=0;a<i.bglst.length;a++)n.push(i.bglst[a]);Laya.loader.create(n,Laya.Handler.create(i,function(){i.scene=Laya.loader.getRes(i.scene_path),i.scene_container.addChild(i.scene),i.bg_front_plane=i.scene.getChildByName("root").getChildByName("bg_front"),i.bg_front_mat=i.bg_front_plane.meshRender.sharedMaterial,i.bg_back_plane=i.scene.getChildByName("root").getChildByName("bg_back"),i.bg_back_mat=i.bg_back_plane.meshRender.sharedMaterial,i.bg_front_plane.active=!1,t.runWith(.6);for(var a=function(e){Laya.timer.frameOnce(5*e,i,function(){i.bg_back_mat.albedoTexture=Laya.loader.getRes(n[e].url),t.runWith(.6+.2*(e+1)/n.length)})},r=0;r<n.length;r++)a(r);Laya.timer.frameOnce(5*n.length,i,function(){i.scene.visible=!0,t.runWith(.8),i.preheart_effect(e,Laya.Handler.create(i,function(e){t.runWith(.8+.2*e)},null,!1))})}),Laya.Handler.create(i,function(e){return t.runWith(.3+.3*e)},null,!1))}),Laya.Handler.create(this,function(e){return t.runWith(.3*e)},null,!1))},i.prototype.preheart_effect=function(t,i){var n=this;app.Log.log("scene_lobby preheart_effect"),e.EffectMgr.preheat_3d_effect(this.ui_effect_list,e.FrontEffect.Inst.root2,!0,Laya.Handler.create(this,function(){Laya.timer.frameOnce(5,n,function(){i.runWith(1),t.run()})}),i)},i.prototype.onEnable=function(){this._during_change_bg=!1,uiscript.UIMgr.Inst.onSceneLobby_Enable(),this.scene&&(this.scene.visible=!0),view.AudioMgr.PlayMusic("music/lobby.mp3"),this.pending_enter_event(),uiscript.UI_Invite.Inst.enable=!0,Laya.timer.frameLoop(1,this,this._update,null,!0)},i.prototype.pending_enter_event=function(){var t="yard";if(GameMgr.Inst.account_data.nickname&&""!=GameMgr.Inst.account_data.nickname)if(GameMgr.Inst.ingame)t="indoor",e.MJNetMgr.Inst.OpenConnect(GameMgr.Inst.mj_server_url,GameMgr.Inst.mj_game_token,GameMgr.Inst.mj_game_uuid,!0,null);else if(uiscript.UI_WaitingRoom.Inst.inRoom)t="indoor",uiscript.UIMgr.Inst.ShowWaitingRoom();else if(-1!=GameMgr.Inst.beinvited_roomid){var i=GameMgr.Inst.beinvited_roomid;GameMgr.Inst.beinvited_roomid=-1,app.NetAgent.sendReq2Lobby("Lobby","joinRoom",{room_id:i},function(e,t){e||t.error?(uiscript.UIMgr.Inst.showNetReqError("joinRoom",e,t),uiscript.UIMgr.Inst.showLobby()):(uiscript.UI_WaitingRoom.Inst.updateData(t.room),uiscript.UIMgr.Inst.ShowWaitingRoom())})}else if(""!=GameMgr.Inst.outsee_paipuid){var n=GameMgr.Inst.outsee_paipuid;GameMgr.Inst.outsee_paipuid="";var a=n.split("_"),r=0,o=0;if(a.length>1&&(r="a"==a[1].charAt(0)?e.Tools.decode_account_id(parseInt(a[1].substr(1))):parseInt(a[1])),a.length>2){var s=parseInt(a[2]);s&&(o=s)}GameMgr.Inst.checkPaiPu(a[0],r,o)}else if(GameMgr.Inst.custom_match_id>0)t="indoor",uiscript.UI_Match_Room.Inst.enable||uiscript.UI_Match_Room.Inst.show(GameMgr.Inst.custom_match_id);else{var h=!0;if((uiscript.UI_Ob.Inst.enable||uiscript.UI_PaiPu.Inst.enable||uiscript.UI_Match_Room.Inst.enable)&&(h=!1,t="indoor"),h){uiscript.UI_Lobby.Inst.enable=!0;var l=!1;if(!this._check_idcard){this._check_idcard=!0;var c=!0,p=Laya.LocalStorage.getItem("shiming_time_"+e.Tools.encode_account_id(GameMgr.Inst.account_id));if(p&&""!=p){var u=parseInt(p);Date.now()<u+864e5&&(c=!1)}c&&!uiscript.UI_ShiMingRenZheng.renzhenged&&(l=!0,Laya.LocalStorage.setItem("shiming_time_"+e.Tools.encode_account_id(GameMgr.Inst.account_id),Date.now().toString()))}if(l)uiscript.UI_ShiMingRenZheng.Inst.show();else if(uiscript.UI_User_Xieyi.Inst){GameMgr.Inst.account_setting[e.EAccountSetKey.user_xieyi.toString()]?(uiscript.UI_Info.lobbyPopout(),uiscript.UI_User_Xieyi.Inst.destroy(),uiscript.UI_User_Xieyi.Inst=null):uiscript.UI_User_Xieyi.Inst.show(Laya.Handler.create(this,function(){app.NetAgent.sendReq2Lobby("Lobby","updateAccountSettings",{setting:{key:e.EAccountSetKey.user_xieyi,value:1}},function(e,t){}),GameMgr.Inst.account_setting[e.EAccountSetKey.user_xieyi.toString()]=1,uiscript.UI_Info.lobbyPopout(),uiscript.UI_User_Xieyi.Inst.destroy(),uiscript.UI_User_Xieyi.Inst=null}))}else uiscript.UI_Info.lobbyPopout()}}else uiscript.UI_Nickname.show();this.change_bg(t,!0)},i.prototype.onDisable=function(){uiscript.UIMgr.Inst.onSceneLobby_Disable(),this.scene.visible=!1,e.LoadMgr.disposeSceneRes("lobby"),this._current_bg="",this.bg_back_mat=null,this.bg_back_plane=null,this.bg_front_mat=null,this.bg_front_plane=null,this.scene.destroy(!0),this.scene=null,e.EffectMgr.dispose_3d_effect(this.ui_effect_list),e.EffectMgr.force_dispose_3d_res(this.scene_path),this._during_change_bg=!1,Laya.timer.clearAll(this)},i.prototype.addLoadListenter=function(t,i){this._load_state==e.E_LoadState.loaded?Laya.timer.once(500,this,function(){i&&i.runWith(1),t&&t.run()}):(i&&this._progress_listener.push(i),t&&this._load_listener.push(t))},i.prototype.change_bg=function(e,t){if(e!=this._current_bg||this._during_change_bg&&t){var i="scene/Assets/Resource/lobby/"+e+".jpg";""==this._current_bg&&(t=!0),t?(this.bg_front_plane.active=!1,this._during_change_bg=!1):(this.bg_front_plane.active=!0,this.bg_front_mat.albedoTexture=this.bg_back_mat.albedoTexture,this.bg_front_mat.albedoColor=new Laya.Vector4(1,1,1,1),this._during_change_bg=!0,this._change_start_time=Laya.timer.currTimer),this.bg_back_mat.albedoTexture=Laya.loader.getRes(i),this._current_bg=e}},i.prototype._update=function(){if(this._during_change_bg){var e=Laya.timer.currTimer-this._change_start_time;if(e>=200)this._during_change_bg=!1,this.bg_front_plane.active=!1;else{var t=1-e/200;this.bg_front_mat.albedoColor=new Laya.Vector4(1,1,1,t)}}},i.prototype.onProgressUpdate=function(e){for(var t=0;t<this._progress_listener.length;t++)this._progress_listener[t].runWith(e)},i.Inst=null,i}(e.SceneBase);e.Scene_Lobby=t}(game||(game={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),game;!function(e){var t=function(t){function i(){var e=t.call(this)||this;return e.desktop=null,e.camera_main=null,e.scene_path="scene/mjdesktop.ls",e.scene_path2="scene/mjhandpai.ls",e.ui_effect_list=["scene/effect_winlose.lh","scene/effect_getstar.lh","scene/effect_losestar.lh","scene/effect_queshi_bang.lh","scene/effect_juanzhou.lh","scene/effect_yiman.lh","scene/effect_yiman2.lh"],e.scene_hand=null,e.root2=null,e.camera_hand=null,e._common_texture2d_loaded=!1,e._desktop_model_path="",e._mjp_path="",e._effect_list=[],e._mjp_textures=[],e._liqibang_list=[],i.Inst=e,e}return __extends(i,t),i.prototype.init=function(e){},i.prototype.onEnable=function(){uiscript.UIMgr.Inst.onSceneMJ_Enable()},i.prototype.onDisable=function(){uiscript.UIMgr.Inst.onSceneMJ_Disable(),view.DesktopMgr.Inst.Reset(),view.DesktopMgr.Inst.active=!1,this.desktop.visible=!1,e.MJNetMgr.Inst.Close(),e.LoadMgr.disposeSceneRes("mjdesktop")},i.prototype.openMJRoom=function(e,t,i){var n=this;this.load_common_texture2d(Laya.Handler.create(this,function(){n.load_mainscene(Laya.Handler.create(n,function(){n.active_common_texture2d(Laya.Handler.create(n,function(){app.Log.log("active_common_texture2d over"),n._load_my_desktop_view(Laya.Handler.create(n,function(){app.Log.log("_load_my_desktop_view over"),n._load_my_mjp_view(Laya.Handler.create(n,function(){app.Log.log("_load_my_mjp_view over"),n._load_player_views(e,Laya.Handler.create(n,function(){app.Log.log("_load_player_effects over"),view.DesktopMgr.Inst.active=!0,n.desktop.visible=!0,view.DesktopMgr.Inst.Reset(),i.runWith(1),t.run()}),Laya.Handler.create(n,function(e){return i.runWith(.75+.25*e)},null,!1))}),Laya.Handler.create(n,function(e){return i.runWith(.65+.1*e)},null,!1))}),Laya.Handler.create(n,function(e){return i.runWith(.6+.05*e)},null,!1))}),Laya.Handler.create(n,function(e){return i.runWith(.55+.05*e)},null,!1))}),Laya.Handler.create(n,function(e){return i.runWith(.1+.45*e)},null,!1))}),Laya.Handler.create(this,function(e){return i.runWith(.1*e)},null,!1))},i.prototype.load_mainscene=function(t,i){var n=this;uiscript.UIMgr.Inst.openMjDesktopUI(Laya.Handler.create(this,function(){n.desktop?(i.runWith(1),t.run()):(cfg.audio.audio.forEach(function(e){"mj"==e.type&&Laya.loader.load(e.path+view.AudioMgr.suffix)}),e.LoadMgr.loadRes(e.E_LoadType.scene_mj,Laya.Handler.create(n,function(){return Laya.timer.frameOnce(1,n,function(){n.desktop=Laya.loader.getRes(n.scene_path),n.desktop.ambientColor=new Laya.Vector3(.4,.4,.4);var e=n.desktop.getChildByName("main_camera");GameMgr.Inst.addScene(n.desktop);var a=n.desktop.addChild(new Laya.DirectionLight);a.transform.translate(new Laya.Vector3(0,1,1.7)),a.color=new Laya.Vector3(.5,.5,.5),a.direction=new Laya.Vector3(0,-.933,-.36);var r=Laya.loader.getRes(n.scene_path2);GameMgr.Inst.addScene(r),n.scene_hand=r,n.root2=r.getChildByName("root"),n.camera_hand=r.getChildByName("camera"),n.camera_hand.useOcclusionCulling=!1;n.desktop.getChildByName("room").addComponent(view.DesktopMgr).mainCamera=e,e.useOcclusionCulling=!1,i.runWith(1),t.run()})}),Laya.Handler.create(n,function(e){return i.runWith(.2+.8*e)},null,!1)))},null,!1),Laya.Handler.create(this,function(e){return i.runWith(.2*e)},null,!1))},i.prototype.load_common_texture2d=function(t,i){var n=this;if(this._common_texture2d_loaded)i&&i.runWith(1),t&&t.run();else{for(var a=[],r=0;r<e.EffectMgr.d3res_map.mj_common_texture2d.length;r++)a.push(e.EffectMgr.d3res_map.mj_common_texture2d[r]);Laya.loader.create(a,Laya.Handler.create(this,function(){n._common_texture2d_loaded=!0,t&&t.run()}),i,laya.d3.resource.Texture2D_caps)}},i.prototype.active_common_texture2d=function(t,i){i.runWith(0);for(var n=[],a=0;a<e.EffectMgr.d3res_map.mj_common_texture2d.length;a++)n.push(e.EffectMgr.d3res_map.mj_common_texture2d[a]);var r=0,o=function(){if(r>=n.length)return i.runWith(1),void t.run();i.runWith(r/n.length);var e=Laya.loader.getRes(n[r]);e&&e.recreateResource(),r++,o()};o()},i.prototype.clearTexture_commont_texture2d=function(){for(var t=e.EffectMgr.d3res_map.mj_common_texture2d,i=0;i<t.length;i++){var n=Laya.loader.getRes(t[i]);n&&n.clearTexture()}},i.prototype._load_my_mjp_view=function(t,i){var n=[];n.push("scene/Assets/Resource/tablecloth/"+e.GameUtility.get_common_view_res_name(e.ECommonView.desktop)+"/Table_Dif.jpg");for(var a="scene/Assets/Resource/mjpai/"+e.GameUtility.get_common_view_res_name(e.ECommonView.mjp)+"/",r=0;r<10;r++)n.push(a+r+"m.png"),n.push(a+r+"p.png"),n.push(a+r+"s.png"),r>=1&&r<8&&n.push(a+r+"z.png");n.push(a+"hand.png"),this._mjp_textures=n,Laya.loader.create(n,t,i)},i.prototype._load_my_desktop_view=function(t,i){var n=this,a=e.GameUtility.get_common_view_res_name(e.ECommonView.desktop);this._desktop_model_path="scene/"+a+".lh",Laya.loader.create(this._desktop_model_path,Laya.Handler.create(this,function(){n._desktop_model=Laya.loader.getRes(n._desktop_model_path),n.desktop.getChildByName("room").getChildByName("container_desktop").addChild(n._desktop_model),n._desktop_model.transform.localPosition=new Laya.Vector3(0,0,0),n._desktop_model.transform.localScale=new Laya.Vector3(1,1,1),n._desktop_model.transform.localRotationEuler=new Laya.Vector3(0,0,0),n._desktop_model.active=!0,n._desktop_model.isStatic=!0,i.runWith(1),t.run()}),i)},i.prototype._load_player_views=function(t,i,n){var a=this,r={};r["scene/effect_chipeng.lh"]=1;for(var o={},s={},h=0;h<t.length;h++){var l=t[h];if(l&&l.character){var c=l.character,p="scene/effect_hupai_default.lh",u="",d="scene/liqi_default.lh";if(c.views)for(var _=0;_<c.views.length;_++){var m=c.views[_].slot,f=c.views[_].item_id,g=cfg.item_definition.view.get(f);g&&(m==e.EPlayerView.hupai_effect?p="scene/"+g.res_name+".lh":m==e.EPlayerView.liqi_effect?u="scene/"+g.res_name+".lh":m==e.EPlayerView.liqibang&&(d="scene/"+g.res_name+".lh"))}r[p]=1,""!=u&&(r[u]=1),o[d]=1;var y=c.skin,v=cfg.item_definition.skin.get(y);s[v.path+"/full.png"]=1,s[v.path+"/half.png"]=1}}this._effect_list=[];for(var x in r)this._effect_list.push(x);this._liqibang_list=[];for(var x in o)this._liqibang_list.push(x);var b=[];for(var x in s)b.push(x);n.runWith(0),e.LoadMgr.loadResImage(b,Laya.Handler.create(this,function(){Laya.loader.create(a._liqibang_list,Laya.Handler.create(a,function(){e.EffectMgr.preheat_3d_effect(a._effect_list,view.DesktopMgr.Inst.trans_container_effect,!1,Laya.Handler.create(a,function(){e.EffectMgr.preheat_3d_effect(a.ui_effect_list,e.FrontEffect.Inst.root2,!0,Laya.Handler.create(a,function(){Laya.timer.frameOnce(5,a,function(){i.run()})}),Laya.Handler.create(a,function(e){return n.runWith(.65+.35*e)},null,!1))}),Laya.Handler.create(a,function(e){return n.runWith(.4+.25*e)},null,!1))}),Laya.Handler.create(a,function(e){return n.runWith(.3+.1*e)},null,!1))}),Laya.Handler.create(this,function(e){return n.runWith(.3*e)},null,!1))},i.prototype._on_quit=function(){if(uiscript.UI_DesktopInfo.Inst&&uiscript.UI_DesktopInfo.Inst.onCloseRoom(),uiscript.UI_Win.Inst&&(uiscript.UI_Win.Inst.enable=!1),uiscript.UI_ScoreChange.Inst&&(uiscript.UI_ScoreChange.Inst.enable=!1),view.DesktopMgr.Inst&&view.DesktopMgr.Inst.active){if(this._desktop_model&&(this._desktop_model.destroy(!0),this._desktop_model=null),e.EffectMgr.force_dispose_3d_res(this._desktop_model_path),this._desktop_model_path){(n=Laya.loader.getRes(this._desktop_model_path))&&n.destroy(!0),this._desktop_model_path=""}for(i=0;i<this._liqibang_list.length;i++){var t=this._liqibang_list[i].url;e.EffectMgr.force_dispose_3d_res(t);(n=Laya.loader.getRes(t))&&n.destroy(!0)}this.clearTexture_commont_texture2d(),e.EffectMgr.dispose_3d_effect(this._effect_list),e.EffectMgr.dispose_3d_effect(this.ui_effect_list);for(var i=0;i<this._mjp_textures.length;i++){var n=Laya.loader.getRes(this._mjp_textures[i].url);n&&n.dispose()}}},i.prototype.GameEnd=function(){app.Log.log("Scene_MJ GameEnd"),this._on_quit(),e.MJNetMgr.Inst.Close(),GameMgr.Inst.ingame=!1,GameMgr.Inst.EnterLobby()},i.prototype.ForceOut=function(){app.Log.log("Scene_MJ ForceOut"),this._on_quit(),e.MJNetMgr.Inst.Close(),GameMgr.Inst.EnterLobby()},i.Inst=null,i}(e.SceneBase);e.Scene_MJ=t}(game||(game={}));var view;!function(e){var t=function(){function e(){}return e.play=function(e){},e.fastplay=function(e,t){},e.record=function(e,t){return void 0===t&&(t=0),0},e.fastrecord=function(e,t){void 0===t&&(t=-1)},e}();e.ActionBase=t}(view||(view={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),view;!function(e){var t=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return __extends(i,t),i.play=function(t){app.Log.log("ActionAnGangAddGang play data:"+JSON.stringify(t));var i=t.seat;if(t.doras&&e.DesktopMgr.Inst.WhenDoras(t.doras,!1),t.type==mjcore.E_Ming.gang_ming)e.DesktopMgr.Inst.players[(i-e.DesktopMgr.Inst.seat+4)%4].PlaySound("act_kan"),Laya.timer.once(500,this,function(){e.DesktopMgr.Inst.players[(i-e.DesktopMgr.Inst.seat+4)%4].AddGang(mjcore.MJPai.Create(t.tiles)),e.DesktopMgr.Inst.waiting_gang_deal_tile=!0});else{var n=new mjcore.MJMing;n.type=mjcore.E_Ming.gang_an,n.from=[i,i,i,i],n.pais=this.getAngangTile(t.tiles),Laya.timer.once(500,this,function(){e.DesktopMgr.Inst.players[(i-e.DesktopMgr.Inst.seat+4)%4].AddMing(n),e.DesktopMgr.Inst.waiting_gang_deal_tile=!0}),e.DesktopMgr.Inst.players[(i-e.DesktopMgr.Inst.seat+4)%4].PlaySound("act_kan")}t.operation&&Laya.timer.once(600,this,function(){e.ActionOperation.play(t.operation)}),void 0!=t.zhenting&&uiscript.UI_TingPai.Inst.setZhengting(t.zhenting),i==e.DesktopMgr.Inst.seat&&uiscript.UI_TingPai.Inst.setData1(t),uiscript.UI_DesktopInfo.Inst.changeHeadEmo(i,"emoji_5",2e3)},i.fastplay=function(t,i){app.Log.log("ActionAnGangAddGang fastplay data:"+JSON.stringify(t)+" usetime:"+i);var n=t.seat;if(t.doras&&e.DesktopMgr.Inst.WhenDoras(t.doras,!0),t.type==mjcore.E_Ming.gang_ming)e.DesktopMgr.Inst.players[(n-e.DesktopMgr.Inst.seat+4)%4].AddGang(mjcore.MJPai.Create(t.tiles),!1);else{var a=new mjcore.MJMing;a.type=mjcore.E_Ming.gang_an,a.from=[n,n,n,n],a.pais=this.getAngangTile(t.tiles),e.DesktopMgr.Inst.players[(n-e.DesktopMgr.Inst.seat+4)%4].AddMing(a,!1)}t.operation&&-1!=i&&Laya.timer.once(500,this,function(){e.ActionOperation.play(t.operation,i)}),void 0!=t.zhenting&&uiscript.UI_TingPai.Inst.setZhengting(t.zhenting),n==e.DesktopMgr.Inst.seat&&uiscript.UI_TingPai.Inst.setData1(t),e.DesktopMgr.Inst.waiting_gang_deal_tile=!0},i.record=function(t,i){void 0===i&&(i=0),app.Log.log("ActionAnGangAddGang record data:"+JSON.stringify(t)),t.doras&&e.DesktopMgr.Inst.WhenDoras(t.doras,!0);var n=t.seat;if(t.type==mjcore.E_Ming.gang_ming)e.DesktopMgr.Inst.players[(n-e.DesktopMgr.Inst.seat+4)%4].PlaySound("act_kan"),Laya.timer.once(500,this,function(){e.DesktopMgr.Inst.players[(n-e.DesktopMgr.Inst.seat+4)%4].AddGang(mjcore.MJPai.Create(t.tiles)),e.DesktopMgr.Inst.waiting_gang_deal_tile=!0});else{var a=new mjcore.MJMing;a.type=mjcore.E_Ming.gang_an,a.from=[n,n,n,n],a.pais=this.getAngangTile(t.tiles),Laya.timer.once(500,this,function(){e.DesktopMgr.Inst.players[(n-e.DesktopMgr.Inst.seat+4)%4].AddMing(a),e.DesktopMgr.Inst.waiting_gang_deal_tile=!0}),e.DesktopMgr.Inst.players[(n-e.DesktopMgr.Inst.seat+4)%4].PlaySound("act_kan")}if(uiscript.UI_DesktopInfo.Inst.changeHeadEmo(n,"emoji_5",2e3),e.DesktopMgr.Inst.mode==e.EMJMode.live_broadcast&&t.operations)for(var r=0;r<t.operations.length;r++)e.ActionOperation.ob(t.operations[r],i,450);return 1700},i.fastrecord=function(t,i){void 0===i&&(i=-1),app.Log.log("ActionAnGangAddGang fastrecord data:"+JSON.stringify(t)),t.doras&&e.DesktopMgr.Inst.WhenDoras(t.doras,!0);var n=t.seat;if(t.type==mjcore.E_Ming.gang_ming)e.DesktopMgr.Inst.players[(n-e.DesktopMgr.Inst.seat+4)%4].AddGang(mjcore.MJPai.Create(t.tiles),!1);else{var a=new mjcore.MJMing;a.type=mjcore.E_Ming.gang_an,a.from=[n,n,n,n],a.pais=this.getAngangTile(t.tiles),e.DesktopMgr.Inst.players[(n-e.DesktopMgr.Inst.seat+4)%4].AddMing(a,!1)}if(e.DesktopMgr.Inst.mode==e.EMJMode.live_broadcast&&i>=0&&t.operations)for(var r=0;r<t.operations.length;r++)e.ActionOperation.ob(t.operations[r],i,450);e.DesktopMgr.Inst.waiting_gang_deal_tile=!0},i.getAngangTile=function(t){var i=[];if("0"!=t.charAt(0)&&"5"!=t.charAt(0)||"z"==t.charAt(1))for(o=0;o<4;o++)i.push(mjcore.MJPai.Create(t));else{var n=1;if(e.DesktopMgr.Inst.game_config){var a=e.DesktopMgr.Inst.game_config.mode;if(a&&a.extendinfo){var r=JSON.parse(a.extendinfo);if(r&&null!=r.dora_count)switch(r.dora_count){case 0:n=0;break;case 3:n=1;break;case 4:n="p"==t.charAt(1)?2:1}}if(a&&a.detail_rule&&a.detail_rule&&null!=a.detail_rule.dora_count)switch(a.detail_rule.dora_count){case 0:n=0;break;case 3:n=1;break;case 4:n="p"==t.charAt(1)?2:1}}for(var o=0;o<4;o++){var s=mjcore.MJPai.Create(t);s.dora=0!=o&&o<=n,i.push(s)}}return e.DesktopMgr.Inst.waiting_gang_deal_tile=!0,i},i}(e.ActionBase);e.ActionAnGangAddGang=t}(view||(view={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),view;!function(e){var t=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return __extends(i,t),i.play=function(t){app.Log.log("ActionChiPengGang play data:"+JSON.stringify(t));var i=t.seat,n=new mjcore.MJMing;n.type=t.type,n.from=t.froms,n.pais=[];for(var a=0;a<t.tiles.length;a++)n.pais.push(mjcore.MJPai.Create(t.tiles[a]));Laya.timer.once(600,this,function(){try{e.DesktopMgr.Inst.players[(e.DesktopMgr.Inst.lastpai_seat-e.DesktopMgr.Inst.seat+4)%4].QiPaiNoPass(),e.DesktopMgr.Inst.players[(i-e.DesktopMgr.Inst.seat+4)%4].AddMing(n),n.type==mjcore.E_Ming.gang_ming&&(e.DesktopMgr.Inst.waiting_gang_deal_tile=!0)}catch(e){var t={};t.error=e.message,t.stack=e.stack,t.method="addming600",t.name="ActionChiPengGang",GameMgr.Inst.onFatalError(t)}}),i!=e.DesktopMgr.Inst.seat||n.type!=mjcore.E_Ming.gang_an&&n.type!=mjcore.E_Ming.gang_ming||(e.DesktopMgr.Inst.last_gang=Laya.timer.currTimer);var r="",o="";switch(n.type){case mjcore.E_Ming.kezi:r="emoji_4",o="emoji_3";break;case mjcore.E_Ming.shunzi:r="emoji_2",o="emoji_1";break;case mjcore.E_Ming.gang_ming:r="emoji_6",o="emoji_5"}uiscript.UI_DesktopInfo.Inst.changeHeadEmo(e.DesktopMgr.Inst.index_player,r,2e3),e.DesktopMgr.Inst.index_player=i,uiscript.UI_DesktopInfo.Inst.changeHeadEmo(e.DesktopMgr.Inst.index_player,o,2e3),e.DesktopMgr.Inst.RefreshPlayerIndicator(),t.liqi&&e.ActionLiqi.play(t.liqi),t.operation&&Laya.timer.once(600,this,function(){e.ActionOperation.play(t.operation)}),void 0!=t.zhenting&&void 0==t.operation&&(uiscript.UI_DesktopInfo.Inst.setZhenting(t.zhenting),uiscript.UI_TingPai.Inst.setZhengting(t.zhenting));var s="";switch(n.type){case mjcore.E_Ming.shunzi:s="act_chi";break;case mjcore.E_Ming.gang_ming:case mjcore.E_Ming.gang_an:s="act_kan";break;case mjcore.E_Ming.kezi:s="act_pon"}e.DesktopMgr.Inst.players[(i-e.DesktopMgr.Inst.seat+4)%4].PlaySound(s),i==e.DesktopMgr.Inst.seat&&uiscript.UI_TingPai.Inst.setData0(t)},i.fastplay=function(t,i){app.Log.log("ActionChiPengGang fastplay data:"+JSON.stringify(t)+" usetime:"+i);var n=t.seat,a=new mjcore.MJMing;a.type=t.type,a.from=t.froms,a.pais=[];for(var r=0;r<t.tiles.length;r++)a.pais.push(mjcore.MJPai.Create(t.tiles[r]));e.DesktopMgr.Inst.players[(e.DesktopMgr.Inst.lastpai_seat-e.DesktopMgr.Inst.seat+4)%4].QiPaiNoPass(),e.DesktopMgr.Inst.players[(n-e.DesktopMgr.Inst.seat+4)%4].AddMing(a,!1),a.type==mjcore.E_Ming.gang_ming&&(e.DesktopMgr.Inst.waiting_gang_deal_tile=!0),n!=e.DesktopMgr.Inst.seat||a.type!=mjcore.E_Ming.gang_an&&a.type!=mjcore.E_Ming.gang_ming||(e.DesktopMgr.Inst.last_gang=Laya.timer.currTimer),e.DesktopMgr.Inst.index_player=n,e.DesktopMgr.Inst.RefreshPlayerIndicator(),t.liqi&&e.ActionLiqi.fastplay(t.liqi,0),t.operation&&-1!=i&&Laya.timer.once(600,this,function(){e.ActionOperation.play(t.operation,i)}),void 0!=t.zhenting&&void 0==t.operation&&(uiscript.UI_DesktopInfo.Inst.setZhenting(t.zhenting),uiscript.UI_TingPai.Inst.setZhengting(t.zhenting)),n==e.DesktopMgr.Inst.seat&&uiscript.UI_TingPai.Inst.setData0(t)},i.record=function(t,i){void 0===i&&(i=0),app.Log.log("ActionChiPengGang record data:"+JSON.stringify(t));var n=t.seat,a=new mjcore.MJMing;a.type=t.type,a.from=t.froms,a.pais=[];for(var r=0;r<t.tiles.length;r++)a.pais.push(mjcore.MJPai.Create(t.tiles[r]));Laya.timer.once(600,this,function(){e.DesktopMgr.Inst.players[(e.DesktopMgr.Inst.lastpai_seat-e.DesktopMgr.Inst.seat+4)%4].QiPaiNoPass(),e.DesktopMgr.Inst.players[(n-e.DesktopMgr.Inst.seat+4)%4].AddMing(a),a.type==mjcore.E_Ming.gang_ming&&(e.DesktopMgr.Inst.waiting_gang_deal_tile=!0)}),n!=e.DesktopMgr.Inst.seat||a.type!=mjcore.E_Ming.gang_an&&a.type!=mjcore.E_Ming.gang_ming||(e.DesktopMgr.Inst.last_gang=Laya.timer.currTimer);var o="",s="";switch(a.type){case mjcore.E_Ming.kezi:o="emoji_4",s="emoji_3";break;case mjcore.E_Ming.shunzi:o="emoji_2",s="emoji_1";break;case mjcore.E_Ming.gang_ming:o="emoji_6",s="emoji_5"}uiscript.UI_DesktopInfo.Inst.changeHeadEmo(e.DesktopMgr.Inst.index_player,o,2e3),e.DesktopMgr.Inst.index_player=n,uiscript.UI_DesktopInfo.Inst.changeHeadEmo(e.DesktopMgr.Inst.index_player,s,2e3),e.DesktopMgr.Inst.RefreshPlayerIndicator(),t.liqi&&e.ActionLiqi.record(t.liqi);var h="";switch(a.type){case mjcore.E_Ming.shunzi:h="act_chi";break;case mjcore.E_Ming.gang_ming:case mjcore.E_Ming.gang_an:h="act_kan";break;case mjcore.E_Ming.kezi:h="act_pon"}return e.DesktopMgr.Inst.players[(n-e.DesktopMgr.Inst.seat+4)%4].PlaySound(h),e.DesktopMgr.Inst.mode==e.EMJMode.live_broadcast&&t.operation&&e.ActionOperation.ob(t.operation,i,500),1700},i.fastrecord=function(t,i){void 0===i&&(i=-1),app.Log.log("ActionChiPengGang fastrecord data:"+JSON.stringify(t));var n=t.seat,a=new mjcore.MJMing;a.type=t.type,a.from=t.froms,a.pais=[];for(var r=0;r<t.tiles.length;r++)a.pais.push(mjcore.MJPai.Create(t.tiles[r]));e.DesktopMgr.Inst.players[(e.DesktopMgr.Inst.lastpai_seat-e.DesktopMgr.Inst.seat+4)%4].QiPaiNoPass(),e.DesktopMgr.Inst.players[(n-e.DesktopMgr.Inst.seat+4)%4].AddMing(a,!1),a.type==mjcore.E_Ming.gang_ming&&(e.DesktopMgr.Inst.waiting_gang_deal_tile=!0),e.DesktopMgr.Inst.index_player=n,e.DesktopMgr.Inst.RefreshPlayerIndicator(),t.liqi&&e.ActionLiqi.fastrecord(t.liqi),e.DesktopMgr.Inst.mode==e.EMJMode.live_broadcast&&i>=0&&t.operation&&e.ActionOperation.ob(t.operation,i,500)},i}(e.ActionBase);e.ActionChiPengGang=t}(view||(view={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),view;!function(e){var t=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return __extends(i,t),i.play=function(t){app.Log.log("ActionDealTile play data:"+JSON.stringify(t));var i=t.seat,n=t.tile;if(e.DesktopMgr.Inst.left_tile_count=t.left_tile_count,i==e.DesktopMgr.Inst.seat){var a=Laya.timer.currTimer-e.DesktopMgr.Inst.last_gang,r=0;a<650&&(r=650-a),Laya.timer.once(r,this,function(){e.DesktopMgr.Inst.mainrole.TakePai(mjcore.MJPai.Create(n))})}else e.DesktopMgr.Inst.players[(i-e.DesktopMgr.Inst.seat+4)%4].TakePai(mjcore.MJPai.Create("5z"));e.DesktopMgr.Inst.index_player=i,e.DesktopMgr.Inst.RefreshPaiLeft(),e.DesktopMgr.Inst.RefreshPlayerIndicator(),t.liqi&&e.ActionLiqi.play(t.liqi),t.operation&&e.ActionOperation.play(t.operation),t.doras&&t.doras.length>0&&e.DesktopMgr.Inst.WhenDoras(t.doras,!1),void 0!=t.zhenting&&void 0==t.operation&&(uiscript.UI_DesktopInfo.Inst.setZhenting(t.zhenting),uiscript.UI_TingPai.Inst.setZhengting(t.zhenting)),i==e.DesktopMgr.Inst.seat&&uiscript.UI_TingPai.Inst.setData0(t),e.DesktopMgr.Inst.waiting_gang_deal_tile=!1},i.fastplay=function(t,i){app.Log.log("ActionDealTile fastplay data:"+JSON.stringify(t)+" usetime:"+i);var n=t.seat,a=t.tile;e.DesktopMgr.Inst.left_tile_count=t.left_tile_count,n==e.DesktopMgr.Inst.seat?e.DesktopMgr.Inst.mainrole.TakePai(mjcore.MJPai.Create(a),!1):e.DesktopMgr.Inst.players[(n-e.DesktopMgr.Inst.seat+4)%4].TakePai(mjcore.MJPai.Create("5z")),e.DesktopMgr.Inst.index_player=n,e.DesktopMgr.Inst.RefreshPaiLeft(),e.DesktopMgr.Inst.RefreshPlayerIndicator(),t.liqi&&e.ActionLiqi.fastplay(t.liqi,0),t.operation&&-1!=i&&e.ActionOperation.play(t.operation,i),t.doras&&t.doras.length>0&&e.DesktopMgr.Inst.WhenDoras(t.doras,!0),void 0!=t.zhenting&&void 0==t.operation&&(uiscript.UI_DesktopInfo.Inst.setZhenting(t.zhenting),uiscript.UI_TingPai.Inst.setZhengting(t.zhenting)),n==e.DesktopMgr.Inst.seat&&uiscript.UI_TingPai.Inst.setData0(t),e.DesktopMgr.Inst.waiting_gang_deal_tile=!1},i.record=function(t,i){void 0===i&&(i=0),app.Log.log("ActionDealTile record data:"+JSON.stringify(t));var n=t.seat,a=t.tile;return e.DesktopMgr.Inst.left_tile_count=t.left_tile_count,n==e.DesktopMgr.Inst.seat?e.DesktopMgr.Inst.mainrole.TakePai(mjcore.MJPai.Create(a)):e.DesktopMgr.Inst.players[(n-e.DesktopMgr.Inst.seat+4)%4].recordTakePai(mjcore.MJPai.Create(a)),e.DesktopMgr.Inst.index_player=n,e.DesktopMgr.Inst.RefreshPaiLeft(),e.DesktopMgr.Inst.RefreshPlayerIndicator(),t.liqi&&e.ActionLiqi.record(t.liqi),t.doras&&t.doras.length>0&&e.DesktopMgr.Inst.WhenDoras(t.doras,!0),e.DesktopMgr.Inst.mode==e.EMJMode.live_broadcast&&t.operation&&e.ActionOperation.ob(t.operation,i),e.DesktopMgr.Inst.waiting_gang_deal_tile=!1,300},i.fastrecord=function(t,i){void 0===i&&(i=-1),app.Log.log("ActionDealTile fastrecord data:"+JSON.stringify(t));var n=t.seat,a=t.tile;e.DesktopMgr.Inst.left_tile_count=t.left_tile_count,n==e.DesktopMgr.Inst.seat?e.DesktopMgr.Inst.mainrole.TakePai(mjcore.MJPai.Create(a),!1):e.DesktopMgr.Inst.players[(n-e.DesktopMgr.Inst.seat+4)%4].recordTakePai(mjcore.MJPai.Create(a)),e.DesktopMgr.Inst.index_player=n,e.DesktopMgr.Inst.RefreshPaiLeft(),e.DesktopMgr.Inst.RefreshPlayerIndicator(),t.liqi&&e.ActionLiqi.fastrecord(t.liqi),t.doras&&t.doras.length>0&&e.DesktopMgr.Inst.WhenDoras(t.doras,!0),e.DesktopMgr.Inst.mode==e.EMJMode.live_broadcast&&i>=0&&t.operation&&e.ActionOperation.ob(t.operation,i),e.DesktopMgr.Inst.waiting_gang_deal_tile=!1},i}(e.ActionBase);e.ActionDealTile=t}(view||(view={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),view;!function(e){var t=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return __extends(i,t),i.play=function(t){app.Log.log("ActionDiscardTile play data:"+JSON.stringify(t)),t.doras&&e.DesktopMgr.Inst.WhenDoras(t.doras,!1);var i=t.seat,n=mjcore.MJPai.Create(t.tile),a=!(null==t.is_liqi||void 0==t.is_liqi||!t.is_liqi);e.DesktopMgr.Inst.players[(i-e.DesktopMgr.Inst.seat+4)%4].AddQiPai(n,a,t.moqie),a&&(t.is_wliqi?e.DesktopMgr.Inst.players[(i-e.DesktopMgr.Inst.seat+4)%4].PlaySound("act_drich"):e.DesktopMgr.Inst.players[(i-e.DesktopMgr.Inst.seat+4)%4].PlaySound("act_rich")),i==e.DesktopMgr.Inst.seat?e.DesktopMgr.Inst.mainrole.OnDiscardTile(n,!1):e.DesktopMgr.Inst.players[(i-e.DesktopMgr.Inst.seat+4)%4].onDiscardTile(t.moqie,!1),t.operation&&Laya.timer.once(500,this,function(){e.ActionOperation.play(t.operation)}),void 0!=t.zhenting&&void 0==t.operation&&(uiscript.UI_DesktopInfo.Inst.setZhenting(t.zhenting),uiscript.UI_TingPai.Inst.setZhengting(t.zhenting)),i==e.DesktopMgr.Inst.seat&&uiscript.UI_TingPai.Inst.setData1(t)},i.fastplay=function(t,i){app.Log.log("ActionDiscardTile fastplay data:"+JSON.stringify(t)+" usetime:"+i),t.doras&&e.DesktopMgr.Inst.WhenDoras(t.doras,!0);var n=t.seat,a=mjcore.MJPai.Create(t.tile),r=!(null==t.is_liqi||void 0==t.is_liqi||!t.is_liqi);e.DesktopMgr.Inst.players[(n-e.DesktopMgr.Inst.seat+4)%4].AddQiPai(a,r,t.moqie,!1),n==e.DesktopMgr.Inst.seat?e.DesktopMgr.Inst.mainrole.OnDiscardTile(a,!0):e.DesktopMgr.Inst.players[(n-e.DesktopMgr.Inst.seat+4)%4].onDiscardTile(t.moqie,!0),t.operation&&-1!=i&&Laya.timer.once(500,this,function(){e.ActionOperation.play(t.operation,i)}),void 0!=t.zhenting&&void 0==t.operation&&(uiscript.UI_DesktopInfo.Inst.setZhenting(t.zhenting),uiscript.UI_TingPai.Inst.setZhengting(t.zhenting)),n==e.DesktopMgr.Inst.seat&&uiscript.UI_TingPai.Inst.setData1(t)},i.record=function(t,i){void 0===i&&(i=0),app.Log.log("ActionDiscardTile record data:"+JSON.stringify(t)),t.doras&&e.DesktopMgr.Inst.WhenDoras(t.doras,!0);var n=t.seat,a=mjcore.MJPai.Create(t.tile),r=!(null==t.is_liqi||void 0==t.is_liqi||!t.is_liqi);if(e.DesktopMgr.Inst.players[(n-e.DesktopMgr.Inst.seat+4)%4].AddQiPai(a,r,t.moqie),r&&(t.is_wliqi?e.DesktopMgr.Inst.players[(n-e.DesktopMgr.Inst.seat+4)%4].PlaySound("act_drich"):e.DesktopMgr.Inst.players[(n-e.DesktopMgr.Inst.seat+4)%4].PlaySound("act_rich"),uiscript.UI_DesktopInfo.Inst.changeHeadEmo(n,"emoji_9",2e3)),n==e.DesktopMgr.Inst.seat?e.DesktopMgr.Inst.mainrole.OnDiscardTile(a,!1):e.DesktopMgr.Inst.players[(n-e.DesktopMgr.Inst.seat+4)%4].recordDiscardTile(a,t.moqie,!1),t.tingpais&&e.DesktopMgr.Inst.setTingpai(t.seat,t.tingpais),e.DesktopMgr.Inst.mode==e.EMJMode.live_broadcast&&t.operations)for(var o=0;o<t.operations.length;o++)e.ActionOperation.ob(t.operations[o],i,450);return 500},i.fastrecord=function(t,i){void 0===i&&(i=-1),app.Log.log("ActionDiscardTile fastrecord data:"+JSON.stringify(t)),t.doras&&e.DesktopMgr.Inst.WhenDoras(t.doras,!0);var n=t.seat,a=mjcore.MJPai.Create(t.tile),r=!(null==t.is_liqi||void 0==t.is_liqi||!t.is_liqi);if(e.DesktopMgr.Inst.players[(n-e.DesktopMgr.Inst.seat+4)%4].AddQiPai(a,r,t.moqie,!1),n==e.DesktopMgr.Inst.seat?e.DesktopMgr.Inst.mainrole.OnDiscardTile(a,!0):e.DesktopMgr.Inst.players[(n-e.DesktopMgr.Inst.seat+4)%4].recordDiscardTile(a,t.moqie,!0),t.tingpais&&e.DesktopMgr.Inst.setTingpai(t.seat,t.tingpais),e.DesktopMgr.Inst.mode==e.EMJMode.live_broadcast&&i>=0&&t.operations)for(var o=0;o<t.operations.length;o++)e.ActionOperation.ob(t.operations[o],i,450)},i}(e.ActionBase);e.ActionDiscardTile=t}(view||(view={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),view;!function(e){var t=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return __extends(i,t),i.play=function(t){var i=this;app.Log.log("ActionHule play data:"+JSON.stringify(t)),t.doras&&e.DesktopMgr.Inst.WhenDoras(t.doras,!1),e.DesktopMgr.Inst.gameing=!1,uiscript.UI_OtherPlayerInfo.Inst.close(),e.AudioMgr.StopMusic();var n=!1;Laya.timer.once(100,this,function(){var a=t.hules,r=0;if(a[0].zimo){for(var o=a[0].seat,s=[],h=0;h<a[0].hand.length;h++)s.push(mjcore.MJPai.Create(a[0].hand[h]));uiscript.UI_Huleshow.Inst.showZimo([(o-e.DesktopMgr.Inst.seat+4)%4]),r+=1400,a[0].title&&""!=a[0].title&&(Laya.timer.once(r,i,function(){uiscript.UI_HuCutIn.show(e.DesktopMgr.Inst.player_datas[o].avatar_id),n=!0}),r+=2e3),Laya.timer.once(r,i,function(){o==e.DesktopMgr.Inst.seat&&e.DesktopMgr.Inst.mainrole.HulePrepare(s,a[0].hu_tile,a[0].zimo),e.DesktopMgr.Inst.players[(o-e.DesktopMgr.Inst.seat+4)%4].Hule(s,a[0].hu_tile,a[0].zimo,n)}),r+=2800,o==e.DesktopMgr.Inst.seat&&(uiscript.UI_TingPai.Inst.reset(),uiscript.UI_TingPai.Inst.setZhengting(!1))}else{Laya.timer.once(r,i,function(){for(var t=[],i=0;i<a.length;i++)t.push((a[i].seat-e.DesktopMgr.Inst.seat+4)%4);uiscript.UI_Huleshow.Inst.showRong(t)}),r+=1500;for(var l=function(t){var o=a[t].seat;a[t].title&&""!=a[t].title&&(Laya.timer.once(r,i,function(){uiscript.UI_HuCutIn.show(e.DesktopMgr.Inst.player_datas[o].avatar_id),n=!0}),r+=2e3)},h=0;h<a.length;h++)l(h);for(h=0;h<a.length;h++){if(a[h].seat==e.DesktopMgr.Inst.seat){for(var c=[],p=0;p<a[h].hand.length;p++)c.push(mjcore.MJPai.Create(a[h].hand[p]));e.DesktopMgr.Inst.mainrole.HulePrepare(c,a[h].hu_tile,a[h].zimo)}}Laya.timer.once(r,i,function(){for(var t="scene/effect_hupai_default.lh",i=-1,r=0;r<a.length;r++){var o=a[r].seat;if(-1==i)i=o;else{(i-e.DesktopMgr.Inst.index_player+4)%4>(o-e.DesktopMgr.Inst.index_player+4)%4&&(i=o)}}i>=0&&(t=e.DesktopMgr.Inst.player_effects[i].effect_hupai),e.DesktopMgr.Inst.ShowHuleEffect(e.DesktopMgr.Inst.lastqipai.model.transform.position,t);for(r=0;r<a.length;r++){for(var s=[],h=0;h<a[r].hand.length;h++)s.push(mjcore.MJPai.Create(a[r].hand[h]));e.DesktopMgr.Inst.players[(a[r].seat-e.DesktopMgr.Inst.seat+4)%4].Hule(s,a[r].hu_tile,a[r].zimo,n),a[r].seat==e.DesktopMgr.Inst.seat&&(uiscript.UI_TingPai.Inst.reset(),uiscript.UI_TingPai.Inst.setZhengting(!1))}}),r+=2e3}for(h=0;h<t.delta_scores.length;h++)t.delta_scores[h]>0?uiscript.UI_DesktopInfo.Inst.changeHeadEmo(h,"emoji_7",-1):t.delta_scores[h]<0&&uiscript.UI_DesktopInfo.Inst.changeHeadEmo(h,"emoji_8",-1);Laya.timer.once(r,i,function(){uiscript.UIMgr.Inst.ShowWin(t,!1)})})},i.fastplay=function(t,i){app.Log.log("ActionHule fastplay data:"+JSON.stringify(t)),e.AudioMgr.StopMusic(),t.doras&&e.DesktopMgr.Inst.WhenDoras(t.doras,!1),e.DesktopMgr.Inst.gameing=!1,uiscript.UIMgr.Inst.ShowWin(t,!1)},i.record=function(e){return this.play(e),1e5},i.fastrecord=function(e){this.play(e)},i}(e.ActionBase);e.ActionHule=t}(view||(view={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),view;!function(e){var t=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return __extends(i,t),i.play=function(t){app.Log.log("ActionLiqi play data:"+JSON.stringify(t)),Laya.timer.once(300,this,function(){var i=t.seat,n=t.score;e.DesktopMgr.Inst.players[(i-e.DesktopMgr.Inst.seat+4)%4].ShowLiqi(),e.DesktopMgr.Inst.players[(i-e.DesktopMgr.Inst.seat+4)%4].SetScore(n,e.DesktopMgr.Inst.mainrole.score),uiscript.UI_DesktopInfo.Inst.setLiqibang(t.liqibang)})},i.fastplay=function(t,i){app.Log.log("ActionLiqi fastplay data:"+JSON.stringify(t));var n=t.seat,a=t.score;e.DesktopMgr.Inst.players[(n-e.DesktopMgr.Inst.seat+4)%4].ShowLiqi(!1),e.DesktopMgr.Inst.players[(n-e.DesktopMgr.Inst.seat+4)%4].SetScore(a,e.DesktopMgr.Inst.mainrole.score),uiscript.UI_DesktopInfo.Inst.setLiqibang(t.liqibang)},i.record=function(e){return app.Log.log("ActionLiqi record data:"+JSON.stringify(e)),this.play(e),0},i.fastrecord=function(t){app.Log.log("ActionLiqi fastrecord data:"+JSON.stringify(t));var i=t.seat,n=t.score;e.DesktopMgr.Inst.players[(i-e.DesktopMgr.Inst.seat+4)%4].ShowLiqi(!1),e.DesktopMgr.Inst.players[(i-e.DesktopMgr.Inst.seat+4)%4].SetScore(n,e.DesktopMgr.Inst.mainrole.score),uiscript.UI_DesktopInfo.Inst.setLiqibang(t.liqibang)},i}(e.ActionBase);e.ActionLiqi=t}(view||(view={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),view;!function(e){var t=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return __extends(i,t),i.play=function(t){var i=this;app.Log.log("ActionLiuJu play data:"+JSON.stringify(t)),e.DesktopMgr.Inst.gameing=!1,uiscript.UI_OtherPlayerInfo.Inst.close();var n=0;if(t.liqi?(n=1e3,e.ActionLiqi.play(t.liqi)):n=500,t.type==mjcore.E_LiuJu.sanjiahule){e.AudioMgr.StopMusic();var a=t.seat;Laya.timer.once(n,this,function(){for(var t=[],i=0;i<4;i++)(e.DesktopMgr.Inst.seat+i)%4!=a&&t.push(i);uiscript.UI_Huleshow.Inst.showRong(t)}),n+=1500,Laya.timer.once(n,this,function(){for(var i=0;i<4;i++)if((i-e.DesktopMgr.Inst.seat+4)%4!=a){for(var n=t.allplayertiles[i].split("|"),r=[],o=0;o<n.length;o++)r.push(mjcore.MJPai.Create(n[o]));e.DesktopMgr.Inst.players[(i-e.DesktopMgr.Inst.seat+4)%4].Huangpai(!0,r,!1)}}),n+=1e3,Laya.timer.once(n,this,function(){uiscript.UIMgr.Inst.ShowLiuJu(t)})}else Laya.timer.once(n,this,function(){e.AudioMgr.StopMusic();var n=500;if(t.type==mjcore.E_LiuJu.jiuzhongjiupai){for(var a=t.seat,r=t.tiles,o=[],s=0;s<r.length;s++)o.push(mjcore.MJPai.Create(r[s]));e.DesktopMgr.Inst.players[(a-e.DesktopMgr.Inst.seat+4)%4].Huangpai(!0,o,!1)}if(t.type==mjcore.E_LiuJu.sijializhi&&t.allplayertiles&&t.allplayertiles.length>0){for(var h=0;h<4;h++){for(var l=t.allplayertiles[h].split("|"),o=[],s=0;s<l.length;s++)o.push(mjcore.MJPai.Create(l[s]));e.DesktopMgr.Inst.players[(h-e.DesktopMgr.Inst.seat+4)%4].Huangpai(!0,o,!1)}n=1e3}Laya.timer.once(n,i,function(){uiscript.UIMgr.Inst.ShowLiuJu(t)})})},i.fastplay=function(t,i){app.Log.log("ActionLiuJu fastplay data:"+JSON.stringify(t)),e.AudioMgr.StopMusic(),e.DesktopMgr.Inst.gameing=!1,uiscript.UI_OtherPlayerInfo.Inst.close();if(t.liqi&&e.ActionLiqi.fastplay(t.liqi,0),t.type==mjcore.E_LiuJu.jiuzhongjiupai){for(var n=t.seat,a=t.tiles,r=[],o=0;o<a.length;o++)r.push(mjcore.MJPai.Create(a[o]));e.DesktopMgr.Inst.players[(n-e.DesktopMgr.Inst.seat+4)%4].Huangpai(!0,r,!0)}if(t.type==mjcore.E_LiuJu.sanjiahule)for(var n=t.seat,s=0;s<4;s++)if((s-e.DesktopMgr.Inst.seat+4)%4!=n){for(var h=t.allplayertiles[s].split("|"),r=[],o=0;o<h.length;o++)r.push(mjcore.MJPai.Create(h[o]));e.DesktopMgr.Inst.players[(s-e.DesktopMgr.Inst.seat+4)%4].Huangpai(!0,r,!1)}uiscript.UIMgr.Inst.ShowLiuJu(t)},i.record=function(e){return app.Log.log("ActionLiuJu record data:"+JSON.stringify(e)),this.play(e),4e3},i.fastrecord=function(e){this.play(e)},i}(e.ActionBase);e.ActionLiuJu=t}(view||(view={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),view;!function(e){var t=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return __extends(i,t),i.play=function(t){var i=this;app.Log.log("ActionNewRound play data:"+JSON.stringify(t)),e.AudioMgr.PlayMusic("music/game.mp3"),e.DesktopMgr.Inst.index_change=t.chang,e.DesktopMgr.Inst.index_ju=t.ju,e.DesktopMgr.Inst.index_ben=t.ben,e.DesktopMgr.Inst.index_player=t.ju,e.DesktopMgr.Inst.gameing=!0,e.DesktopMgr.Inst.left_tile_count=69,e.DesktopMgr.Inst.waiting_gang_deal_tile=!1,e.DesktopMgr.Inst.setAutoHule(!1),e.DesktopMgr.Inst.setAutoMoQie(!1),e.DesktopMgr.Inst.setAutoNoFulu(!1),uiscript.UI_DesktopInfo.Inst.resetFunc(),uiscript.UI_TingPai.Inst.reset(),e.DesktopMgr.Inst.SetChangJuShow(e.DesktopMgr.Inst.index_change,e.DesktopMgr.Inst.index_ju),uiscript.UI_DesktopInfo.Inst.setBen(e.DesktopMgr.Inst.index_ben),uiscript.UI_DesktopInfo.Inst.setZhenting(!1),uiscript.UI_DesktopInfo.Inst.reset_rounds(),uiscript.UI_DesktopInfo.Inst.setLiqibang(t.liqibang);for(var n=0;n<4;n++)e.DesktopMgr.Inst.players[n].Reset(),e.DesktopMgr.Inst.players[n].setSeat((e.DesktopMgr.Inst.seat+n)%4);e.DesktopMgr.Inst.RefreshPlayerIndicator(),e.DesktopMgr.Inst.RefreshPaiLeft(),e.DesktopMgr.Inst.setScores(t.scores),e.DesktopMgr.Inst.md5=t.md5,e.DesktopMgr.Inst.choosed_pai=null,e.DesktopMgr.Inst.dora=[];var a=!1;void 0!=t.al&&null!=t.al&&(a=t.al),a&&uiscript.UI_AL.Show(),Laya.timer.once(a?1300:0,this,function(){for(var n=[],a=0;a<t.tiles.length;a++)n.push(mjcore.MJPai.Create(t.tiles[a]));e.DesktopMgr.Inst.mainrole.NewGame(n,!1);for(a=1;a<4;a++)e.DesktopMgr.Inst.players[a].NewGame(13+((a+e.DesktopMgr.Inst.seat)%4==e.DesktopMgr.Inst.index_ju?1:0),!1);Laya.timer.once(1200,i,function(){t.dora&&""!=t.dora&&(e.DesktopMgr.Inst.dora.push(mjcore.MJPai.Create(t.dora)),uiscript.UI_DesktopInfo.Inst.setDora(0,e.DesktopMgr.Inst.dora[0]));for(var i=0;i<4;i++)e.DesktopMgr.Inst.players[i].OnDoraRefresh();if(e.DesktopMgr.Inst.index_ju==e.DesktopMgr.Inst.seat){n={tingpais:t.tingpais0};uiscript.UI_TingPai.Inst.setData0(n)}else{var n={tingpais:t.tingpais1};uiscript.UI_TingPai.Inst.setData1(n)}}),void 0!=t.operation&&Laya.timer.once(1e3,i,function(){e.ActionOperation.play(t.operation)})}),e.DesktopMgr.Inst.fetchLinks()},i.fastplay=function(t,i){app.Log.log("ActionNewRound fastplay data:"+JSON.stringify(t)+" usetime:"+i),e.DesktopMgr.Inst.index_change=t.chang,e.DesktopMgr.Inst.index_ju=t.ju,e.DesktopMgr.Inst.index_ben=t.ben,e.DesktopMgr.Inst.index_player=t.ju,e.DesktopMgr.Inst.gameing=!0,e.DesktopMgr.Inst.left_tile_count=69,e.DesktopMgr.Inst.waiting_gang_deal_tile=!1,e.DesktopMgr.Inst.setAutoHule(!1),e.DesktopMgr.Inst.setAutoMoQie(!1),e.DesktopMgr.Inst.setAutoNoFulu(!1),uiscript.UI_DesktopInfo.Inst.resetFunc(),uiscript.UI_TingPai.Inst.reset(),e.DesktopMgr.Inst.SetChangJuShow(e.DesktopMgr.Inst.index_change,e.DesktopMgr.Inst.index_ju),uiscript.UI_DesktopInfo.Inst.setBen(e.DesktopMgr.Inst.index_ben),uiscript.UI_DesktopInfo.Inst.setZhenting(!1),uiscript.UI_DesktopInfo.Inst.reset_rounds(),uiscript.UI_DesktopInfo.Inst.setLiqibang(t.liqibang);for(a=0;a<4;a++)e.DesktopMgr.Inst.players[a].Reset(),e.DesktopMgr.Inst.players[a].setSeat((e.DesktopMgr.Inst.seat+a)%4);e.DesktopMgr.Inst.RefreshPlayerIndicator(),e.DesktopMgr.Inst.RefreshPaiLeft(),e.DesktopMgr.Inst.setScores(t.scores),e.DesktopMgr.Inst.md5=t.md5,e.DesktopMgr.Inst.choosed_pai=null,e.DesktopMgr.Inst.dora=[];for(var n=[],a=0;a<t.tiles.length;a++)n.push(mjcore.MJPai.Create(t.tiles[a]));e.DesktopMgr.Inst.mainrole.NewGame(n,!0);for(a=1;a<4;a++)e.DesktopMgr.Inst.players[a].NewGame(13+((a+e.DesktopMgr.Inst.seat)%4==e.DesktopMgr.Inst.index_ju?1:0),!0);t.dora&&""!=t.dora&&(e.DesktopMgr.Inst.dora.push(mjcore.MJPai.Create(t.dora)),uiscript.UI_DesktopInfo.Inst.setDora(0,e.DesktopMgr.Inst.dora[0]));for(a=0;a<4;a++)e.DesktopMgr.Inst.players[a].OnDoraRefresh();if(e.DesktopMgr.Inst.index_ju==e.DesktopMgr.Inst.seat){r={tingpais:t.tingpais0};uiscript.UI_TingPai.Inst.setData0(r)}else{var r={tingpais:t.tingpais1};uiscript.UI_TingPai.Inst.setData1(r)}t.operation&&-1!=i&&Laya.timer.once(100,this,function(){e.ActionOperation.play(t.operation,i+100)})},i.record=function(t,i){void 0===i&&(i=0),app.Log.log("ActionNewRound record data:"+JSON.stringify(t)),e.DesktopMgr.Inst.WhenOperationEnd(),e.AudioMgr.PlayMusic("music/game.mp3"),e.DesktopMgr.Inst.index_change=t.chang,e.DesktopMgr.Inst.index_ju=t.ju,e.DesktopMgr.Inst.index_ben=t.ben,e.DesktopMgr.Inst.index_player=t.ju,e.DesktopMgr.Inst.gameing=!0,e.DesktopMgr.Inst.left_tile_count=69,e.DesktopMgr.Inst.waiting_gang_deal_tile=!1,e.DesktopMgr.Inst.tingpais=[[],[],[],[]],uiscript.UI_TingPai.Inst.reset(),uiscript.UI_Replay.Inst.reset(),e.DesktopMgr.Inst.SetChangJuShow(e.DesktopMgr.Inst.index_change,e.DesktopMgr.Inst.index_ju),uiscript.UI_DesktopInfo.Inst.setBen(e.DesktopMgr.Inst.index_ben),uiscript.UI_DesktopInfo.Inst.setZhenting(!1),uiscript.UI_DesktopInfo.Inst.setLiqibang(t.liqibang);for(o=0;o<4;o++)e.DesktopMgr.Inst.players[o].setSeat((e.DesktopMgr.Inst.seat+o)%4);e.DesktopMgr.Inst.RefreshPlayerIndicator(),e.DesktopMgr.Inst.RefreshPaiLeft(),e.DesktopMgr.Inst.choosed_pai=null,e.DesktopMgr.Inst.dora=[],e.AudioMgr.PlayAudio(216);for(o=0;o<4;o++){for(var n=[],a="tiles"+o.toString(),r=0;r<t[a].length;r++)n.push(mjcore.MJPai.Create(t[a][r]));o==e.DesktopMgr.Inst.seat?e.DesktopMgr.Inst.mainrole.RecordNewGame(n):e.DesktopMgr.Inst.players[(o-e.DesktopMgr.Inst.seat+4)%4].RecordNewGame(n)}e.DesktopMgr.Inst.setScores(t.scores),e.DesktopMgr.Inst.md5=t.md5,uiscript.UI_DesktopInfo.Inst.reset_rounds(),t.dora&&""!=t.dora&&(e.DesktopMgr.Inst.dora.push(mjcore.MJPai.Create(t.dora)),uiscript.UI_DesktopInfo.Inst.setDora(0,e.DesktopMgr.Inst.dora[0]));for(o=0;o<4;o++)e.DesktopMgr.Inst.players[o].OnDoraRefresh();if(t.tingpai)for(var o=0;o<t.tingpai.length;o++)e.DesktopMgr.Inst.setTingpai(t.tingpai[o].seat,t.tingpai[o].tingpais1);return e.DesktopMgr.Inst.mode==e.EMJMode.paipu&&(t.paishan?(uiscript.UI_Replay.Inst.page_paishan.setTiles(t.paishan),uiscript.UI_Replay.Inst.page_paishan.refresh()):uiscript.UI_Replay.Inst.page_paishan.setNoInfo()),e.DesktopMgr.Inst.mode==e.EMJMode.live_broadcast&&t.operation&&e.ActionOperation.ob(t.operation,i,1e3),300},i.fastrecord=function(t,i){void 0===i&&(i=-1),app.Log.log("ActionNewRound fastrecord data:"+JSON.stringify(t)),e.AudioMgr.PlayMusic("music/game.mp3"),e.DesktopMgr.Inst.WhenOperationEnd(),e.DesktopMgr.Inst.index_change=t.chang,e.DesktopMgr.Inst.index_ju=t.ju,e.DesktopMgr.Inst.index_ben=t.ben,e.DesktopMgr.Inst.index_player=t.ju,e.DesktopMgr.Inst.gameing=!0,e.DesktopMgr.Inst.left_tile_count=69,e.DesktopMgr.Inst.waiting_gang_deal_tile=!1,e.DesktopMgr.Inst.tingpais=[[],[],[],[]],uiscript.UI_TingPai.Inst.reset(),uiscript.UI_Replay.Inst.reset(),e.DesktopMgr.Inst.SetChangJuShow(e.DesktopMgr.Inst.index_change,e.DesktopMgr.Inst.index_ju),uiscript.UI_DesktopInfo.Inst.setBen(e.DesktopMgr.Inst.index_ben),uiscript.UI_DesktopInfo.Inst.setZhenting(!1),uiscript.UI_DesktopInfo.Inst.setLiqibang(t.liqibang);for(o=0;o<4;o++)e.DesktopMgr.Inst.players[o].setSeat((e.DesktopMgr.Inst.seat+o)%4);e.DesktopMgr.Inst.RefreshPlayerIndicator(),e.DesktopMgr.Inst.RefreshPaiLeft(),e.DesktopMgr.Inst.choosed_pai=null,e.DesktopMgr.Inst.dora=[];for(o=0;o<4;o++){for(var n=[],a="tiles"+o.toString(),r=0;r<t[a].length;r++)n.push(mjcore.MJPai.Create(t[a][r]));o==e.DesktopMgr.Inst.seat?e.DesktopMgr.Inst.mainrole.RecordNewGame(n):e.DesktopMgr.Inst.players[(o-e.DesktopMgr.Inst.seat+4)%4].RecordNewGame(n)}e.DesktopMgr.Inst.setScores(t.scores),e.DesktopMgr.Inst.md5=t.md5,uiscript.UI_DesktopInfo.Inst.reset_rounds(),t.dora&&""!=t.dora&&(e.DesktopMgr.Inst.dora.push(mjcore.MJPai.Create(t.dora)),uiscript.UI_DesktopInfo.Inst.setDora(0,e.DesktopMgr.Inst.dora[0]));for(o=0;o<4;o++)e.DesktopMgr.Inst.players[o].OnDoraRefresh();if(t.tingpai)for(var o=0;o<t.tingpai.length;o++)e.DesktopMgr.Inst.setTingpai(t.tingpai[o].seat,t.tingpai[o].tingpais1);e.DesktopMgr.Inst.mode==e.EMJMode.paipu&&(t.paishan?(uiscript.UI_Replay.Inst.page_paishan.setTiles(t.paishan),uiscript.UI_Replay.Inst.page_paishan.refresh()):uiscript.UI_Replay.Inst.page_paishan.setNoInfo()),e.DesktopMgr.Inst.mode==e.EMJMode.live_broadcast&&i>=0&&t.operation&&e.ActionOperation.ob(t.operation,i,1e3)},i}(e.ActionBase);e.ActionNewRound=t}(view||(view={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),view;!function(e){var t=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return __extends(i,t),i.play=function(t){var i=this;app.Log.log("ActionNewRound play data:"+JSON.stringify(t));for(var n=0,a=1;a<4;a++){var r=e.DesktopMgr.Inst.players[a].discardcd-Laya.timer.currTimer;r>n&&(n=r)}Laya.timer.once(n,this,function(){e.AudioMgr.StopMusic();var n=t.players;e.DesktopMgr.Inst.gameing=!1,uiscript.UI_OtherPlayerInfo.Inst.close(),uiscript.UI_TingPai.Inst.reset(),uiscript.UI_TingPai.Inst.setZhengting(!1);for(s=0;s<4;s++){for(var a=[],r=0;r<n[s].hand.length;r++)a.push(mjcore.MJPai.Create(n[s].hand[r]));e.DesktopMgr.Inst.players[(s-e.DesktopMgr.Inst.seat+4)%4].Huangpai(n[s].tingpai,a,!1)}Laya.timer.once(1e3,i,function(){uiscript.UI_Huleshow.Inst.showLiuJu(n)}),Laya.timer.once(6e3,i,function(){if(t.liujumanguan)uiscript.UIMgr.Inst.ShowWin(t.scores,!0);else{var i=[];if(t.scores&&t.scores.length>0){for(a=0;a<4;a++)i.push({old_score:t.scores[0].old_scores[a],delta:0});for(a=0;a<t.scores.length;a++)if(t.scores[a].hasOwnProperty("delta_scores"))for(var n=0;n<4&&n<t.scores[a].delta_scores.length;n++)i[n].delta+=t.scores[a].delta_scores[n]}else for(var a=0;a<4;a++)i.push({old_score:e.DesktopMgr.Inst.players[(a-e.DesktopMgr.Inst.seat+4)%4].score,delta:0});uiscript.UI_ScoreChange.Inst.show(i)}});for(var o=[0,0,0,0],s=0;s<t.scores.length;s++)if(t.scores[s].delta_scores)for(r=0;r<t.scores[s].delta_scores.length;r++)o[r]+=t.scores[s].delta_scores[r]})},i.fastplay=function(t,i){app.Log.log("ActionNewRound fastplay data:"+JSON.stringify(t));e.AudioMgr.StopMusic();var n=t.players;e.DesktopMgr.Inst.gameing=!1,uiscript.UI_OtherPlayerInfo.Inst.close();var a=[!1,!1,!1,!1];uiscript.UI_TingPai.Inst.reset(),uiscript.UI_TingPai.Inst.setZhengting(!1);for(h=0;h<4;h++){for(var r=[],o=0;o<n[h].hand.length;o++)r.push(mjcore.MJPai.Create(n[h].hand[o]));e.DesktopMgr.Inst.players[(h-e.DesktopMgr.Inst.seat+4)%4].Huangpai(n[h].tingpai,r,!0),a[(h-e.DesktopMgr.Inst.seat+4)%4]=n[h].tingpai}if(t.liujumanguan)uiscript.UIMgr.Inst.ShowWin(t.scores,!0);else{var s=[];if(t.scores&&t.scores.length>0){for(h=0;h<4;h++)s.push({old_score:t.scores[0].old_scores[h],delta:0});for(h=0;h<t.scores.length;h++)if(t.scores[h].hasOwnProperty("delta_scores"))for(o=0;o<4&&o<t.scores[h].delta_scores.length;o++)s[o].delta+=t.scores[h].delta_scores[o]}else for(var h=0;h<4;h++)s.push({old_score:e.DesktopMgr.Inst.players[(h-e.DesktopMgr.Inst.seat+4)%4].score,delta:0});uiscript.UI_ScoreChange.Inst.show(s)}},i.record=function(e){return app.Log.log("ActionNewRound record data:"+JSON.stringify(e)),this.play(e),8e3},i.fastrecord=function(e){this.play(e)},i}(e.ActionBase);e.ActionNoTile=t}(view||(view={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),view;!function(e){var t=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return __extends(i,t),i.play=function(t,i){void 0===i&&(i=0),app.Log.log("ActionOperation play data:"+JSON.stringify(t)+" usetime:"+i);try{if(t){e.DesktopMgr.Inst.mainrole.can_discard=!1;var n=t.operation_list;if(null==n||0==n.length)return;e.DesktopMgr.Inst.oplist=n;var a=t.time_fixed,r=t.time_add;(a-=i)<0&&(r+=a,a=0,r<0&&(r=0)),app.Log.log("ActionOperation time_fixed:"+a+" time_add:"+r),a+r>=2e3&&e.DesktopMgr.Inst._PendingAuto()&&uiscript.UI_DesktopInfo.Inst.showCountDown(a,r)}}catch(e){var o={};o.error=e.message,o.stack=e.stack,o.method="play",o.name="ActionOperation",GameMgr.Inst.onFatalError(o)}},i.ob=function(t,i,n){void 0===i&&(i=0),void 0===n&&(n=0),app.Log.log("ActionOperation ob data:"+JSON.stringify(t)+" usetime:"+i);t.seat==e.DesktopMgr.Inst.seat&&Laya.timer.once(n,this,function(){var e=t.time_fixed,n=t.time_add;if((i-=300)<0&&(i=0),(e-=i)<0&&(n+=e,e=0,n<0&&(n=0)),e+n>=2e3){for(var a=!1,r=!1,o=!1,s=t.operation_list,h=0;h<s.length;h++){switch(s[h].type){case mjcore.E_PlayOperation.eat:case mjcore.E_PlayOperation.peng:case mjcore.E_PlayOperation.ming_gang:case mjcore.E_PlayOperation.rong:a=!0;break;case mjcore.E_PlayOperation.an_gang:case mjcore.E_PlayOperation.add_gang:case mjcore.E_PlayOperation.liqi:case mjcore.E_PlayOperation.zimo:r=!0;case mjcore.E_PlayOperation.jiuzhongjiupai:r=!0}s[h].type!=mjcore.E_PlayOperation.dapai&&s[h].type!=mjcore.E_PlayOperation.liqi||(o=!0)}r&&uiscript.UIMgr.Inst.ShowLiqiZimo(s),a&&uiscript.UIMgr.Inst.ShowChipenghu(s),(a||r||o)&&uiscript.UI_DesktopInfo.Inst.showCountDown(e,n)}})},i}(e.ActionBase);e.ActionOperation=t}(view||(view={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),view;!function(e){e.PAIMODEL_HEIGHT=.043225*.94,e.PAIMODEL_WIDTH=.032775*.94,e.PAIMODEL_THICKNESS=.0235*.95*.94,e.PAI_COUNT=136;var t;!function(e){e[e.NULL=0]="NULL",e[e.AUTH=1]="AUTH",e[e.SYNCING=2]="SYNCING",e[e.READY=3]="READY"}(t=e.ELink_State||(e.ELink_State={}));var i;!function(e){e[e.play=0]="play",e[e.paipu=1]="paipu",e[e.live_broadcast=2]="live_broadcast"}(i=e.EMJMode||(e.EMJMode={}));var n=function(n){function a(){var t=n.call(this)||this;return t.mode=i.play,t.active=!1,t.game_config=null,t.seat=0,t.dora=[],t.players=null,t.mainrole=null,t.num_left_show=new Array,t.plane_chang=null,t.plane_ju=null,t.trans_container_effect=null,t.effect_pai_canchi=null,t.effect_dora3D=null,t.effect_doraPlane=null,t.effect_shadow=null,t.auto_hule=!1,t.auto_nofulu=!1,t.auto_moqie=!1,t.auto_liqi=!0,t.duringReconnect=!1,t.gameing=!1,t.lastpai_seat=0,t.lastqipai=null,t.oplist=[],t.liqi_select=[],t.operation_showing=!1,t.myaccountid=0,t.player_datas=[],t.player_effects=[],t.mjp_res_name="",t.last_gang=0,t.gameEndResult=null,t.levelchangeinfo=null,t.rewardinfo=null,t.choosed_pai=null,t.actionList=[],t.action_index=0,t.current_step=0,t.actionMap=null,t.doactioncd=0,t.tingpais=[],t.record_show_hand=!1,t.record_show_paopai=!1,t.ptchange=0,t.waiting_gang_deal_tile=!1,t.md5="",t.dochain_fast=!1,t.paipu_config=0,t.ai_level=1,a.Inst=t,t.actionMap={},t.actionMap.ActionMJStart=new Laya.Handler(t,function(e){e.msg;return app.Log.log("ActionMJStart begin"),t.WhenOperationEnd(),GameMgr.Inst.EnterMJ(),uiscript.UI_FightBegin.show(Laya.Handler.create(t,function(){uiscript.UI_Loading.Inst.close()})),2e3},null,!1),t.actionMap.ActionNewRound=new Laya.Handler(t,function(i){app.Log.log("ActionNewRound begin");var n=i.msg,a=i.fast;if(t.WhenOperationEnd(),uiscript.UI_Loading.Inst.close(),GameMgr.Inst.EnterMJ(),a)return uiscript.UI_FightBegin.hide(),e.ActionNewRound.fastplay(n,-1),0;var r=uiscript.UI_FightBegin.hide();return Laya.timer.once(r+200,t,function(){e.ActionNewRound.play(n)}),n.al&&(r+=1300),r+200+1200+400},null,!1),t.actionMap.ActionDiscardTile=new Laya.Handler(t,function(i){t.WhenOperationEnd();var n=i.msg;return i.fast?(e.ActionDiscardTile.fastplay(n,-1),0):(e.ActionDiscardTile.play(n),500)},null,!1),t.actionMap.ActionDealTile=new Laya.Handler(t,function(i){t.WhenOperationEnd();var n=i.msg;return i.fast?(e.ActionDealTile.fastplay(n,-1),0):(e.ActionDealTile.play(n),500)},null,!1),t.actionMap.ActionChiPengGang=new Laya.Handler(t,function(i){t.WhenOperationEnd();var n=i.msg;return i.fast?(e.ActionChiPengGang.fastplay(n,-1),0):(e.ActionChiPengGang.play(n),1100)},null,!1),t.actionMap.ActionAnGangAddGang=new Laya.Handler(t,function(i){t.WhenOperationEnd();var n=i.msg;return i.fast?(e.ActionAnGangAddGang.fastplay(n,-1),0):(e.ActionAnGangAddGang.play(n),1100)},null,!1),t.actionMap.ActionHule=new Laya.Handler(t,function(i){t.WhenOperationEnd();var n=i.msg;return e.ActionHule.play(n),5e3},null,!1),t.actionMap.ActionNoTile=new Laya.Handler(t,function(i){t.WhenOperationEnd();var n=i.msg;return e.ActionNoTile.play(n),5e3},null,!1),t.actionMap.ActionLiuJu=new Laya.Handler(t,function(i){t.WhenOperationEnd();var n=i.msg;return e.ActionLiuJu.play(n),5e3},null,!1),app.NetAgent.AddListener2MJ("NotifyGameEndResult",Laya.Handler.create(t,function(e){t.gameEndResult=e.result,uiscript.UI_MJTask_Progress.record()})),app.NetAgent.AddListener2MJ("ActionPrototype",Laya.Handler.create(t,function(e){if(app.Log.log("Receive Action: "+JSON.stringify(e)),t.duringReconnect)t.actionList.push(e);else if(t.actionList.length>0)t.actionList.push(e);else{t.actionList.push(e);var i=t.doactioncd-Laya.timer.currTimer;i<0&&(i=0),t.DoChainAction(i)}})),app.NetAgent.AddListener2MJ("NotifyGameFinishReward",Laya.Handler.create(t,function(e){app.Log.log("NotifyGameFinishReward: "+JSON.stringify(e)),t.levelchangeinfo=e.level_change,t.rewardinfo=e})),app.NetAgent.AddListener2MJ("NotifyGameTerminate",Laya.Handler.create(t,function(e){"user-manual-terminate"!=e.reason&&uiscript.UI_SecondConfirm.Inst.show_only_confirm("游戏已经关闭，返回大厅",Laya.Handler.create(t,function(){t.Reset(),game.Scene_MJ.Inst.GameEnd()}))})),t}return __extends(a,n),Object.defineProperty(a.prototype,"round_id",{get:function(){return this.index_change+"-"+this.index_ju+"-"+this.index_ben},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"main_role_character_info",{get:function(){return this.player_datas[this.seat].character},enumerable:!0,configurable:!0}),a.prototype.getPlayerName=function(e){return this.player_datas[e].nickname},Object.defineProperty(a.prototype,"showingPaopai",{get:function(){return this.mode!=i.play},enumerable:!0,configurable:!0}),a.prototype.DoChainAction=function(e){var t=this;this.action_index>=this.actionList.length?(this.action_index=0,this.actionList=[],this.dochain_fast=!1,this.doactioncd=Laya.timer.currTimer+e,this.duringReconnect&&(app.Log.log("finishSyncGame0"),app.NetAgent.sendReq2MJ("FastTest","finishSyncGame",{},function(e,t){}),this.duringReconnect=!1)):Laya.timer.once(e,this,function(){t.action_index==t.actionList.length-1&&t.duringReconnect&&(t.duringReconnect=!1,app.Log.log("finishSyncGame1"),app.NetAgent.sendReq2MJ("FastTest","finishSyncGame",{},function(e,t){})),t.dochain_fast?t.action_index+2<t.actionList.length?t.DoMJAction(t.actionList[t.action_index++],!0):(t.dochain_fast=!1,t.DoMJAction(t.actionList[t.action_index++],!1)):(t.dochain_fast=!1,t.action_index+4<t.actionList.length&&(t.dochain_fast=!0),t.dochain_fast?Laya.timer.once(500,t,function(){for(var e=t.actionList.length-1;e>=t.action_index;e--)if("ActionNewRound"==t.actionList[e].name){t.action_index=e;break}t.DoMJAction(t.actionList[t.action_index++],!0)}):t.DoMJAction(t.actionList[t.action_index++],!1))})},a.prototype.DoMJAction=function(e,t){var i=this;if(this.active){var n=net.ProtobufManager.lookupType("lq."+e.name);if(!n)throw new Error("ERR_CANNOT_FIND_MESSAGE_TYPE, lq."+e.name);var a=e.step,r=n.decode(e.data);app.Log.log("DoMJAction ["+e.name+"]:  "+JSON.stringify(r)+" fast:"+t);var o=0;if(this.actionMap.hasOwnProperty(e.name))try{o=this.actionMap[e.name].runWith({msg:r,fast:t})}catch(t){var s={};return s.error=t.message,s.stack=t.stack,s.method="DoMJAction",s.name=e.name,s.data=e,s.step=a,void GameMgr.Inst.onFatalError(s)}else app.Log.Error("没有监听操作："+e.name);Laya.timer.frameOnce(1,this,function(){i.DoChainAction(o)})}},a.prototype._load=function(t){this.desktop3D=t,this.desktop3D.getChildByName("all").active=!1;var i=this.desktop3D.getChildByName("poss");this.players=new Array,this.mainrole=i.getChildByName("man_1").addComponent(e.ViewPlayer_Me),this.mainrole.Init(this,this.seat,game.Scene_MJ.Inst.root2.getChildByName("hands"),i.getChildByName("ming_1").getChildAt(0),i.getChildByName("hai_1").getChildAt(0),i.getChildByName("man_1")),this.mainrole.trans_hand3D=i.getChildByName("pai_1"),this.mainrole.trans_hand3D.getChildAt(0).active=!1,this.mainrole.trans_hand3D.active=!1,this.mainrole.trans_hand3DCover=i.getChildByName("pai_1_cover"),this.mainrole.trans_hand3DCover.getChildAt(0).active=!1,this.mainrole.trans_hand3DCover.active=!1,this.players.push(this.mainrole);for(var n=2;n<=4;n++){var a=i.getChildByName("man_"+n).addComponent(e.ViewPlayer_Other);a.Init(this,(this.seat+n-1)%4,i.getChildByName("pai_"+n).getChildAt(0),i.getChildByName("ming_"+n).getChildAt(0),i.getChildByName("hai_"+n).getChildAt(0),i.getChildByName("man_"+n)),this.players.push(a)}var r=this.desktop3D.getChildByName("other"),o=r.getChildByName("left");this.num_left_show.push(o.getChildByName("0")),this.num_left_show.push(o.getChildByName("1")),this.SetLeftPaiShow(0);var s=r.getChildByName("chang");this.plane_chang=s.getChildByName("chang"),this.plane_ju=s.getChildByName("ju"),this.SetChangJuShow(0,0),this.trans_container_effect=this.desktop3D.getChildByName("effect"),this.effect_pai_canchi=this.trans_container_effect.getChildByName("effect_pai_canchi"),this.effect_dora3D=this.trans_container_effect.getChildByName("effect_dora"),this.effect_shadow=this.trans_container_effect.getChildByName("effect_shadow"),this.effect_pai_canchi.active=!0,this.effect_dora3D.active=!0,this.effect_shadow.active=!0,this.effect_doraPlane=game.Scene_MJ.Inst.root2.getChildByName("hands").getChildByName("effect_dora"),this.effect_doraPlane.active=!1},a.prototype.initRoom=function(t,n,r,o){uiscript.UI_WaitingRoom.Inst.resetData(),this.game_config=t,this.mode=o,this.seat=-1,this.player_datas=n,this.gameEndResult=null,this.levelchangeinfo=null,this.rewardinfo=null,this.active=!0,this.ptchange=0,this.paipu_config=0,this.mode==i.paipu?this.record_show_hand=this.record_show_paopai=!0:this.record_show_hand=this.record_show_paopai=!1,this.mode==i.play?(uiscript.UI_Invite.Inst.enable=!1,4==t.category&&(GameMgr.Inst.custom_match_id=t.meta.customized_contest_uid)):uiscript.UI_Invite.Inst.enable=!0,this.myaccountid=r;for(var s={},h=0;h<n.length;h++)for(var l=cfg.item_definition.skin.get(n[h].avatar_id),c=cfg.item_definition.character.get(l.character_id),p=cfg.voice.sound.getGroup(c.sound),u=0;u<p.length;u++)if(n[h].character&&2==p[u].category&&p[u].level_limit<=n[h].character.level){var d=p[u].path+e.AudioMgr.suffix;s.hasOwnProperty(d)||(s[d]=1)}for(var _ in s)Laya.loader.load(_,null,null,null,3);for(h=0;h<this.player_datas.length;h++)this.player_datas[h].account_id==r&&(this.seat=h);if(-1==this.seat){if(this.mode==i.play)return uiscript.UIMgr.Inst.ShowErrorInfo("未找到我的位置"),void app.Log.Error(JSON.stringify(n));this.seat=0}if(uiscript.UI_Replay.Inst.enable=this.mode==i.paipu,a.bianjietishi=!0,o==i.play&&t.mode&&t.mode.detail_rule){var m=t.mode.detail_rule;null!=m.bianjietishi&&(a.bianjietishi=m.bianjietishi)}this.mjp_res_name=game.GameUtility.get_common_view_res_name(game.ECommonView.mjp),this.player_effects=[];for(h=0;h<this.player_datas.length;h++){var f=this.player_datas[h].character;if(f){for(var g=f.views,y="scene/effect_hupai_default.lh",v="",x="scene/liqi_default.lh",u=0;u<g.length;u++){var b=g[u].slot,w=g[u].item_id,S=cfg.item_definition.view.get(w);S&&(b==game.EPlayerView.hupai_effect?y="scene/"+S.res_name+".lh":b==game.EPlayerView.liqi_effect?v="scene/"+S.res_name+".lh":b==game.EPlayerView.liqibang&&(x="scene/"+S.res_name+".lh"))}this.player_effects.push({effect_hupai:y,effect_liqi:v,liqibang:x})}else this.player_datas[h].character={charid:200001,level:0,exp:0,views:[],skin:400101,is_upgraded:!1},this.player_effects.push({effect_hupai:"scene/effect_hupai_default.lh",effect_liqi:"",liqibang:"scene/liqi_default.lh"})}uiscript.UI_DesktopInfo.Inst.initRoom(),uiscript.UI_DesktopInfo.Inst.refreshSeat(),uiscript.UI_TingPai.Inst.enable=!0,this.index_change=0,this.index_ju=0,this.index_ben=0,this.index_player=0,this.gameing=!0,this.left_tile_count=69,this.duringReconnect=!1,this.current_step=0,this.action_index=0,this.dochain_fast=!1,this.actionList=[],this.setAutoHule(!1),this.setAutoMoQie(!1),this.setAutoNoFulu(!1),uiscript.UI_DesktopInfo.Inst.resetFunc(),this.SetChangJuShow(this.index_change,this.index_ju),uiscript.UI_DesktopInfo.Inst.setBen(this.index_ben),uiscript.UI_DesktopInfo.Inst.setZhenting(!1);for(h=0;h<4;h++)this.players[h].SetScore(0,0),this.players[h].onInitRoom((this.seat+h)%4),this.players[h].trans_ind.active=!1,this.players[h].RefreshDir();this.RefreshPaiLeft(),this.Reset(),uiscript.UI_GameEnd.Inst.forceclose(),app.Log.log("场景init结束："+Laya.Stat.currentMemorySize/1024/1024+" MB")},a.prototype.changeMainbody=function(e){if(this.mode!=i.play){this.seat=e,uiscript.UI_DesktopInfo.Inst.refreshSeat(!0);for(var t=0;t<4;t++)this.players[t].onInitRoom((this.seat+t)%4),this.players[t].trans_ind.active=!1,this.players[t].RefreshDir();this.Reset(),this.mode==i.paipu&&uiscript.UI_Replay.Inst.onChangeMainBody(),this.mode==i.live_broadcast&&uiscript.UI_Live_Broadcast.Inst.onChangeMainbody()}},a.prototype.syncGameByStep=function(t){var i=this,n=!1;if(GameMgr.Inst.EnterMJ(),t.actions&&t.actions.length>0){var r=-1;null!=t.passed_waiting_time&&void 0!=t.passed_waiting_time&&(r=1e3*t.passed_waiting_time);for(var o=0;o<t.actions.length;o++){var s=t.actions[o],h=o==t.actions.length-1?r:-1,l=net.ProtobufManager.lookupType("lq."+s.name);if(!l)throw new Error("ERR_CANNOT_FIND_MESSAGE_TYPE, lq."+s.name);var c=l.decode(s.data);try{switch(s.name){case"ActionNewRound":e.ActionNewRound.fastplay(c,h);break;case"ActionDiscardTile":e.ActionDiscardTile.fastplay(c,h);break;case"ActionDealTile":e.ActionDealTile.fastplay(c,h);break;case"ActionChiPengGang":e.ActionChiPengGang.fastplay(c,h);break;case"ActionAnGangAddGang":e.ActionAnGangAddGang.fastplay(c,h);break;case"ActionHule":e.ActionHule.fastplay(c,h),n=!0;break;case"ActionLiuJu":e.ActionLiuJu.fastplay(c,h),n=!0;break;case"ActionNoTile":e.ActionNoTile.fastplay(c,h),n=!0}}catch(e){var p={};p.error=e.message,p.stack=e.stack,p.method="syncGameByStep",p.name=s.name,p.data=s,p.step=o,GameMgr.Inst.onFatalError(p);break}}Laya.timer.once(1e3,this,function(){i.duringReconnect=!1,uiscript.UI_Loading.Inst.close(),n||e.AudioMgr.PlayMusic("music/game.mp3"),i.DoChainAction(0)})}else this.duringReconnect=!1,app.NetAgent.sendReq2MJ("FastTest","confirmNewRound",{},function(e,t){});app.Log.log("finishSyncGame11"),app.NetAgent.sendReq2MJ("FastTest","finishSyncGame",{},function(e,t){}),a.Inst.fetchLinks()},a.prototype.CreatePai3D=function(e){var t=this.desktop3D.getChildByName("all").getChildByName("maque").clone(),i=this.desktop3D.getChildByName("all").getChildByName("maque_outline").clone(),n=t,a=new caps.BaseMaterial(caps.Cartoon.filename);a.setTexture(caps.Cartoon.TEXTURE,Laya.loader.getRes("scene/Assets/Resource/mjpai/"+this.mjp_res_name+"/"+e.toString()+".png")),a.setNumber(caps.Cartoon.SPLIT,.4),a.setColor(caps.Cartoon.COLOR_LIGHT,new Laya.Vector3(1,1,1)),a.setColor(caps.Cartoon.COLOR_UNLIGHT,new Laya.Vector3(.788,.788,.8235)),a.setColor(caps.Cartoon.COLOR,new Laya.Vector3(1,1,1)),n.meshRender.sharedMaterial=a;var r=i;t.addChild(r),r.transform.localPosition=new Laya.Vector3(0,0,0),r.transform.localScale=new Laya.Vector3(1,1,1),r.transform.localRotation=new Laya.Quaternion(0,0,0,0);var o=r,s=new caps.Material_Outline(caps.Outline.filename);return s.setColor(caps.Outline.OUTLINE_COLOR,new Laya.Vector3(.165,.192,.204)),s.setNumber(caps.Outline.OUTLINE,.0012),o.meshRender.sharedMaterial=s,t},a.prototype.RefreshPlayerIndicator=function(){for(var e=0;e<4;e++)this.players[e].trans_ind.active=e==(this.index_player-this.seat+4)%4,this.players[e].RefreshScore(this.mainrole.score)},a.prototype.setAutoHule=function(e){this.auto_hule=e,this._PendingAuto()},a.prototype.setAutoNoFulu=function(e){this.auto_nofulu=e,this._PendingAuto()},a.prototype.setAutoMoQie=function(e){this.auto_moqie=e,this._PendingAuto()},a.prototype.setAutoLiPai=function(e){this.auto_liqi=e,e&&this.gameing&&this.mainrole&&this.mainrole.LiPai()},a.prototype.setScoreDelta=function(e){for(var t=1;t<4;t++)this.players[t].duringShowDetla=e,this.players[t].RefreshScore(this.mainrole.score)},a.prototype.SetChangJuShow=function(e,t){var i=new Laya.Vector4(.2,1,e%4*.2,0);this.plane_chang.meshRender.material.tilingOffset=i;var n=new Laya.Vector4(.25,1,.25*t,0);this.plane_ju.meshRender.material.tilingOffset=n},a.prototype.SetLeftPaiShow=function(e){e>=100?e=99:e<0&&(e=0);for(var t=[e%10,Math.floor(e/10)],i=0;i<t.length;i++){var n=new Laya.Vector4(.1,1,.1*t[i],0);this.num_left_show[i].meshRender.material.tilingOffset=n}},a.prototype.RefreshPaiLeft=function(){this.SetLeftPaiShow(this.left_tile_count)},a.prototype.Reset=function(){this.operation_showing=!1,this.oplist=[],Laya.timer.clearAll(e.ActionAnGangAddGang),Laya.timer.clearAll(e.ActionChiPengGang),Laya.timer.clearAll(e.ActionDealTile),Laya.timer.clearAll(e.ActionDiscardTile),Laya.timer.clearAll(e.ActionHule),Laya.timer.clearAll(e.ActionLiqi),Laya.timer.clearAll(e.ActionLiuJu),Laya.timer.clearAll(e.ActionNewRound),Laya.timer.clearAll(e.ActionNoTile),Laya.timer.clearAll(e.ActionOperation),Laya.timer.clearAll(this),uiscript.UI_DesktopInfo.Inst.reset_rounds(),uiscript.UI_Replay.Inst.reset(),this.effect_pai_canchi.active=!1;for(var t=0;t<4;t++)this.players[t].Reset();this.tingpais=[[],[],[],[]],this.md5=""},a.prototype.setScores=function(e){for(var t=0;t<4;t++)this.players[(t+4-this.seat)%4].SetScore(e[t],e[this.seat])},a.prototype._PendingAuto=function(){if(null==this.oplist||0==this.oplist.length)return!1;app.Log.log("_PendingAuto");try{var e=!1,t=!1,i=!1,n=!1,a=!1,r=this.operation_showing;this.operation_showing=!0;var o=null;this.liqi_select=[];for(u=0;u<this.oplist.length;u++){switch(this.oplist[u].type){case mjcore.E_PlayOperation.eat:case mjcore.E_PlayOperation.peng:case mjcore.E_PlayOperation.ming_gang:case mjcore.E_PlayOperation.rong:e=!0;break;case mjcore.E_PlayOperation.an_gang:case mjcore.E_PlayOperation.add_gang:case mjcore.E_PlayOperation.liqi:case mjcore.E_PlayOperation.zimo:t=!0;case mjcore.E_PlayOperation.jiuzhongjiupai:t=!0}if(this.oplist[u].type==mjcore.E_PlayOperation.dapai&&(a=!0,o=this.oplist[u].combination),this.oplist[u].type==mjcore.E_PlayOperation.liqi){a=!0,this.liqi_select=[];for(var s=0;s<this.oplist[u].combination.length;s++)this.liqi_select.push(mjcore.MJPai.Create(this.oplist[u].combination[s]))}this.oplist[u].type==mjcore.E_PlayOperation.rong&&(i=!0),this.oplist[u].type==mjcore.E_PlayOperation.zimo&&(n=!0)}var h=this.auto_hule,l=this.auto_nofulu,c=this.auto_moqie;if(GameMgr.Inst.getHangUpTime()>21e4&&(l=!0,c=!0),h&&(i||n))return Laya.timer.once(800,this,function(){i?app.NetAgent.sendReq2MJ("FastTest","inputChiPengGang",{type:mjcore.E_PlayOperation.rong,index:0},function(e,t){}):n&&app.NetAgent.sendReq2MJ("FastTest","inputOperation",{type:mjcore.E_PlayOperation.zimo,index:0},function(e,t){})}),this.WhenOperationEnd(),!1;if(e){if(l&&!i&&!n)return app.NetAgent.sendReq2MJ("FastTest","inputChiPengGang",{cancel_operation:!0},function(e,t){}),this.WhenOperationEnd(),!1;r||uiscript.UIMgr.Inst.ShowChipenghu(this.oplist)}else if(t&&(r||uiscript.UIMgr.Inst.ShowLiqiZimo(this.oplist)),a){if(c&&!uiscript.UI_LiQiZiMo.Inst.enable&&null!=this.mainrole.last_tile)return this.Action_QiPai(this.mainrole.last_tile.val,!0),!1;if(!r&&(this.mainrole.can_discard=!0,o&&o.length>0)){for(var p=[],u=0;u<o.length;u++)p.push(mjcore.MJPai.Create(o[u]));this.mainrole.ChiTiSelect(p)}}else this.mainrole.can_discard=!1}catch(e){var d={};d.error=e.message,d.stack=e.stack,d.method="_PendingAuto",d.name="DesktopMgr",GameMgr.Inst.onFatalError(d)}return!0},a.prototype.OperationTimeOut=function(){if(null!=this.oplist&&0!=this.oplist.length){var t=!1,i=!1,n=!1,a=!1,r=!1;this.operation_showing;this.operation_showing=!0;for(h=0;h<this.oplist.length;h++){switch(this.oplist[h].type){case mjcore.E_PlayOperation.eat:case mjcore.E_PlayOperation.peng:case mjcore.E_PlayOperation.ming_gang:case mjcore.E_PlayOperation.rong:t=!0;break;case mjcore.E_PlayOperation.an_gang:case mjcore.E_PlayOperation.add_gang:case mjcore.E_PlayOperation.liqi:case mjcore.E_PlayOperation.zimo:i=!0}this.oplist[h].type!=mjcore.E_PlayOperation.dapai&&this.oplist[h].type!=mjcore.E_PlayOperation.liqi||(r=!0,this.oplist[h].type==mjcore.E_PlayOperation.dapai&&this.oplist[h].combination),this.oplist[h].type==mjcore.E_PlayOperation.rong&&(n=!0),this.oplist[h].type==mjcore.E_PlayOperation.zimo&&(a=!0)}if(t)n?app.NetAgent.sendReq2MJ("FastTest","inputChiPengGang",{type:mjcore.E_PlayOperation.rong,index:0,timeuse:1e6},function(e,t){}):app.NetAgent.sendReq2MJ("FastTest","inputChiPengGang",{cancel_operation:!0,timeuse:1e6},function(e,t){}),this.WhenOperationEnd();else if(r)if(this.mainrole.during_liqi){for(var o=null,s=!1,h=0;h<this.mainrole.hand.length;h++)this.mainrole.hand[h].valid&&(o=this.mainrole.hand[h].val,s=this.mainrole.hand[h]===this.mainrole.last_tile);this.Action_LiQi(o,s)}else{var l=null,s=!1;if(null==l&&this.mainrole.last_tile&&this.mainrole.last_tile.valid&&(l=this.mainrole.last_tile.val,s=!0),null==l)for(h=this.mainrole.hand.length-1;h>=0;h--)if(this.mainrole.hand[h].valid){l=this.mainrole.hand[h].val,s=!1;break}this.Action_QiPai(l,s)}else i&&(a?app.NetAgent.sendReq2MJ("FastTest","inputOperation",{type:mjcore.E_PlayOperation.zimo,index:0,timeuse:1e6},function(e,t){}):app.NetAgent.sendReq2MJ("FastTest","inputOperation",{cancel_operation:!0,timeuse:1e6},function(e,t){}),e.DesktopMgr.Inst.WhenOperationEnd())}},a.prototype.WhenOperationEnd=function(){this.operation_showing=!1,this.oplist=[],uiscript.UIMgr.Inst.CloseLiuJu(),uiscript.UIMgr.Inst.CloseWin(),uiscript.UIMgr.Inst.CloseChipenghu(),uiscript.UIMgr.Inst.CloseLiqiZimo(),Laya.timer.clearAll(e.ActionOperation),uiscript.UI_ScoreChange.Inst.enable=!1,this.mainrole.can_discard=!1,uiscript.UI_DesktopInfo.Inst.closeCountDown()},a.prototype.WhenLiqiInfo=function(e){var t=this;e&&Laya.timer.once(300,this,function(){var i=e.seat,n=e.score;t.players[(i-t.seat+4)%4].ShowLiqi(),t.players[(i-t.seat+4)%4].SetScore(n,t.mainrole.score),uiscript.UI_DesktopInfo.Inst.setLiqibang(e.liqibang)})},a.prototype.WhenDoras=function(t,i){var n=this;if(!(null==t||void 0==t||0==t.length||t.length<=this.dora.length)&&t){for(var a=0;a<t.length;a++)this.dora.length>a?this.dora[a]=mjcore.MJPai.Create(t[a]):this.dora.push(mjcore.MJPai.Create(t[a])),uiscript.UI_DesktopInfo.Inst.setDora(a,this.dora[a]);Laya.timer.frameOnce(1,this,function(){for(var e=0;e<4;e++)n.players[e].OnDoraRefresh()}),i||e.AudioMgr.PlayAudio(215)}},a.prototype.Action_QiPai=function(e,t){app.NetAgent.sendReq2MJ("FastTest","inputOperation",{type:mjcore.E_PlayOperation.dapai,tile:e.toString(),moqie:t,timeuse:uiscript.UI_DesktopInfo.Inst._timecd.timeuse},function(e,t){e?app.Log.Error("Action_QiPai 失败"):app.Log.info("Action_QiPai 成功")}),this.WhenOperationEnd()},a.prototype.Action_LiQi=function(e,t){if(!this.liqi_select||0==this.liqi_select.length)return!1;for(var i=!1,n=0;n<this.liqi_select.length;n++)if(0==mjcore.MJPai.Distance(this.liqi_select[n],e)){i=!0;break}return!!i&&(app.NetAgent.sendReq2MJ("FastTest","inputOperation",{type:mjcore.E_PlayOperation.liqi,tile:e.toString(),moqie:t,timeuse:uiscript.UI_DesktopInfo.Inst._timecd.timeuse},function(e,t){e?app.Log.Error("Action_LiQi 失败"):app.Log.info("Action_LiQi 成功")}),this.WhenOperationEnd(),!0)},a.prototype.SetLastQiPai=function(e,t){this.lastqipai=t,this.lastpai_seat=e,this.effect_pai_canchi.active=!1},a.prototype.ShowHuleEffect=function(t,i){if(null!=t){t=t.clone();var n=game.EffectMgr.create_d3_effect(i);this.trans_container_effect.addChild(n),n.transform.position=t,n.active=!0;var a=213;switch(i){case"scene/effect_hupai_default.lh":a=213;break;case"scene/effect_hupai_fire.lh":a=230;break;case"scene/effect_hupai_feng.lh":a=231;break;case"scene/effect_hupai_sakura.lh":a=232}e.AudioMgr.PlayAudio(a),Laya.timer.once(2e3,this,function(){n.destroy(!0)})}},a.prototype.ShowChiPengEffect=function(){this.lastqipai.model&&this.lastqipai.model.transform&&(this.lastqipai.model.parent.addChild(this.effect_pai_canchi),this.effect_pai_canchi.transform.localPosition=this.lastqipai.model.transform.localPosition.clone(),this.effect_pai_canchi.transform.localRotation=this.lastqipai.model.transform.localRotation.clone(),this.effect_pai_canchi.active=!0)},a.prototype.CloseChiPngEffect=function(){this.effect_pai_canchi.active=!1,this.trans_container_effect.addChild(this.effect_pai_canchi)},a.prototype.setChoosedPai=function(e){var t=!1;if(t||!e||this.choosed_pai||(t=!0),t||e||!this.choosed_pai||(t=!0),!t&&e&&this.choosed_pai&&0!=mjcore.MJPai.Distance(this.choosed_pai,e)&&(t=!0),t&&(this.choosed_pai=e?e.Clone():null,a.bianjietishi)){for(var i=0;i<4;i++)this.players[i].OnChoosePai();uiscript.UI_TingPai.Inst.onChooseTile(e)}},a.prototype.setTingpai=function(t,i){for(var n=!1,a=[],r=0;r<i.length;r++)a.push(mjcore.MJPai.Create(i[r].tile));this.tingpais[t].length!=a.length&&(n=!0);for(r=0;r<a.length&&!n;r++)0!=mjcore.MJPai.Distance(a[r],this.tingpais[t][r])&&(n=!0);if(n){this.tingpais[t]=a;for(r=0;r<e.DesktopMgr.Inst.players.length;r++){for(s=0;s<e.DesktopMgr.Inst.players[r].container_qipai.pais.length;s++){(h=e.DesktopMgr.Inst.players[r].container_qipai.pais[s]).ispaopai=this.isPaoPai(h.val),h.OnChoosedPai()}for(s=0;s<e.DesktopMgr.Inst.players[r].container_ming.pais.length;s++){(h=e.DesktopMgr.Inst.players[r].container_ming.pais[s]).ispaopai=this.isPaoPai(h.val),h.OnChoosedPai()}if((h=e.DesktopMgr.Inst.players[r].container_qipai.last_pai)&&(h.ispaopai=this.isPaoPai(h.val),h.OnChoosedPai()),0==r)for(var o=e.DesktopMgr.Inst.players[r],s=0;s<o.hand.length;s++){(h=o.hand[s]).ispaopai=this.isPaoPai(h.val),h.RefreshPaoPai()}else for(var o=e.DesktopMgr.Inst.players[r],s=0;s<o.hand.length;s++){var h=o.hand[s].pai3D;this.record_show_hand?h.ispaopai=this.isPaoPai(h.val):h.ispaopai=!1,h.OnChoosedPai()}}}},a.prototype.isPaoPai=function(e){if(!this.record_show_paopai)return!1;for(var t=0;t<this.tingpais.length;t++)for(var i=0;i<this.tingpais[t].length;i++)if(0==mjcore.MJPai.Distance(this.tingpais[t][i],e))return!0;return!1},a.prototype.getPaiLeft=function(e){for(var t=0,i=0;i<4;i++){for(var n=this.players[i],a=0;a<n.container_ming.pais.length;a++)0==mjcore.MJPai.Distance(n.container_ming.pais[a].val,e)&&t++;for(a=0;a<n.container_qipai.pais.length;a++)0==mjcore.MJPai.Distance(n.container_qipai.pais[a].val,e)&&t++;n.container_qipai.last_pai&&0==mjcore.MJPai.Distance(n.container_qipai.last_pai.val,e)&&t++}for(i=0;i<this.mainrole.hand.length;i++)0==mjcore.MJPai.Distance(this.mainrole.hand[i].val,e)&&t++;for(i=0;i<this.dora.length;i++)this.dora[i]&&0==mjcore.MJPai.Distance(this.dora[i],e)&&t++;return 4-t},a.prototype.get_gang_count=function(){for(var e=0,t=0;t<this.players.length;t++)for(var i=this.players[t].container_ming.mings,n=0;n<i.length;n++)i[n].type!=mjcore.E_Ming.gang_an&&i[n].type!=mjcore.E_Ming.gang_ming||e++;return e},a.prototype.fetchLinks=function(){app.NetAgent.sendReq2MJ("FastTest","fetchGamePlayerState",{},function(e,t){if(e||t.error)uiscript.UIMgr.Inst.showNetReqError("fetchGamePlayerState",e,t);else{app.Log.log(JSON.stringify(t)),a.player_link_state=[];for(var i=0;i<t.state_list.length;i++)a.player_link_state.push(t.state_list[i]);uiscript.UI_DesktopInfo.Inst.refreshLinks()}})},a.prototype.onShowHandChange=function(e){if(this.gameing){this.record_show_hand=e;for(var t=1;t<4;t++)this.players[t].onShowHandChange(e)}},a.prototype.onShowPaopaiChange=function(t){if(this.gameing){this.record_show_paopai=t,this.mainrole.onShowPaopaiChange();for(i=1;i<4;i++)this.players[i].onShowPaopaiChange();for(var i=0;i<e.DesktopMgr.Inst.players.length;i++){for(n=0;n<e.DesktopMgr.Inst.players[i].container_qipai.pais.length;n++){(a=e.DesktopMgr.Inst.players[i].container_qipai.pais[n]).ispaopai=this.isPaoPai(a.val),a.OnChoosedPai()}for(var n=0;n<e.DesktopMgr.Inst.players[i].container_ming.pais.length;n++){(a=e.DesktopMgr.Inst.players[i].container_ming.pais[n]).ispaopai=this.isPaoPai(a.val),a.OnChoosedPai()}var a=e.DesktopMgr.Inst.players[i].container_qipai.last_pai;a&&(a.ispaopai=this.isPaoPai(a.val),a.OnChoosedPai())}}},a.Inst=null,a.player_link_state=[t.NULL,t.NULL,t.NULL,t.NULL],a.click_prefer=0,a.double_click_pass=0,a.bianjietishi=!0,a}(Laya.Script);e.DesktopMgr=n}(view||(view={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),view;!function(e){var t=new Laya.Vector4(1,1,1,1),i=new Laya.Vector4(.6,.6,.6,1),n=function(n){function a(){var e=n.call(this)||this;return e.mySelf=null,e.acitve=!1,e.val=null,e.valid=!0,e._clickeffect=null,e.during_newgame=!1,e.newgame_start=0,e.newgame_lifetime=200,e.during_hule=!1,e.hule_start=0,e.hule_lifetime=100,e.isDora=!1,e.ispaopai=!1,e.index=-1,e.pos_x=0,e.z=0,e.bedraged=!1,e}return __extends(a,n),a.prototype._load=function(e){this.mySelf=e,this.mySelf.active=!1,this.isDora=!1,Laya.timer.frameLoop(1,this,this.Update)},a.prototype.Reset=function(){this.val=null,this.valid=!0,this.index=-1,this._SetColor(t),this.mySelf.active=!1,this.during_newgame=!1,this.during_hule=!1,this.bedraged=!1,this.mySelf.transform.localPosition=new Laya.Vector3(0,0,0),null!=this._clickeffect&&(this._clickeffect.destroy(),this._clickeffect=null),this.acitve=!1,this.isDora=!1,this.mySelf.numChildren>0&&(this.mySelf.getChildAt(0).active=!1)},a.prototype.SetVal=function(n,a){this.val=n,this.valid=a,this._SetColor(a?t:i);var r=n.dora?.9:.1*(n.index-1),o=0;switch(n.type){case mjcore.E_MJPai.s:o=-.75;break;case mjcore.E_MJPai.m:o=-.5;break;case mjcore.E_MJPai.p:o=-.25;break;default:o=0}var s=this.mySelf.meshRender.material;s.albedoTexture=Laya.loader.getRes("scene/Assets/Resource/mjpai/"+e.DesktopMgr.Inst.mjp_res_name+"/hand.png"),s.tilingOffset=new Laya.Vector4(.1,.25,r,o),this.mySelf.active=!0,this.acitve=!0,this.RefreshDora()},a.prototype.LiqiSelect=function(e){if(!this.mySelf.destroyed){for(var n=!1,a=0;a<e.length;a++)if(0==mjcore.MJPai.Distance(this.val,e[a])){n=!0;break}n?(this._SetColor(t),this.valid=!0):(this._SetColor(i),this.valid=!1)}},a.prototype.ChiTiSelect=function(e){if(!this.mySelf.destroyed){for(var n=!1,a=0;a<e.length;a++)if(0==mjcore.MJPai.Distance(this.val,e[a])){n=!0;break}n?(this._SetColor(i),this.valid=!1):(this._SetColor(t),this.valid=!0)}},a.prototype.RefreshPaoPai=function(){this.ispaopai?this._SetColor(new Laya.Vector4(1,.78,.78,1)):this._SetColor(t)},a.prototype.SelectEnd=function(){this.mySelf.destroyed||(this._SetColor(t),this.valid=!0)},a.prototype._SetColor=function(e){if(!this.mySelf.destroyed){this.mySelf.meshRender.material.albedoColor=e}},a.prototype.SetIndex=function(e,t,i){this.index=e,this.pos_x=2.55*e+(t?.8:0),i||(this.mySelf.transform.localPosition=new Laya.Vector3(this.pos_x,this.mySelf.transform.localPosition.y,this.z))},a.prototype.AddClickEffect=function(e){null!=this._clickeffect&&(this._clickeffect.destroy(),this._clickeffect=null),this.mySelf.addChild(e),this._clickeffect=e,e.transform.localPosition=new Laya.Vector3(0,0,2),e.active=!0,Laya.timer.once(300,this,this.RemoveClickEffect)},a.prototype.RemoveClickEffect=function(){null!=this._clickeffect&&(this._clickeffect.destroy(),this._clickeffect=null)},a.prototype.AnimNewTile=function(){var e=this.mySelf.meshRender.material,t=e.albedoColor.clone();t.w=0,e.albedoColor=t,this.during_newgame=!0,this.newgame_start=Laya.timer.currTimer},a.prototype.Hule=function(){this.during_hule=!0,this.hule_start=Laya.timer.currTimer,this.acitve=!1,this.mySelf.numChildren>0&&(this.mySelf.getChildAt(0).active=!1)},a.prototype.Update=function(){if(this.during_newgame){var e=Laya.timer.currTimer-this.newgame_start,t=this.mySelf.transform.localPosition.clone(),i=(n=this.mySelf.meshRender.material).albedoColor.clone();if(e>=this.newgame_lifetime)t.y=0,this.mySelf.transform.localPosition=t,i.w=1,n.albedoColor=i,this.during_newgame=!1;else{a=e/this.newgame_lifetime;t.y=.5*(1-a),this.mySelf.transform.localPosition=t,i.w=a,n.albedoColor=i}}if(this.during_hule){var e=Laya.timer.currTimer-this.hule_start,n=this.mySelf.meshRender.material,i=n.albedoColor.clone();if(e>=this.hule_lifetime)i.w=0,n.albedoColor=i;else{var a=e/this.hule_lifetime;i.w=1-a,n.albedoColor=i}}if(!this.bedraged){var r=this.mySelf.transform.localPosition,o=Math.abs(r.x-this.pos_x);if(o>1e-5){var s=2.55*25*Laya.timer.delta/1e3;s>=o?this.mySelf.transform.localPosition=new Laya.Vector3(this.pos_x,this.mySelf.transform.localPosition.y,this.z):(this.pos_x<r.x&&(s=-s),this.mySelf.transform.localPosition=new Laya.Vector3(r.x+s,this.mySelf.transform.localPosition.y,this.z))}}},a.prototype.RefreshDora=function(){if(e.DesktopMgr.bianjietishi&&!this.isDora){if(this.val.dora&&(this.isDora=!0),!this.isDora)for(var t=0;t<e.DesktopMgr.Inst.dora.length;t++)if(mjcore.MJPai.DoraMet(this.val,e.DesktopMgr.Inst.dora[t])){this.isDora=!0;break}if(this.isDora)if(0==this.mySelf.numChildren){var i=e.DesktopMgr.Inst.effect_doraPlane.clone();this.mySelf.addChild(i),i.transform.localPosition=new Laya.Vector3(0,0,0),i.transform.localScale=new Laya.Vector3(1,1,1),i.transform.localRotationEuler=new Laya.Vector3(0,0,0),i.active=!0;i.getChildAt(0).addComponent(anim.RunUV)}else this.mySelf.getChildAt(0).active=!0}},a.Cmp=function(e,t){var i=mjcore.MJPai.Distance(e.val,t.val);return 0!=i?i:e.index-t.index},a}(Laya.Script);e.HandPaiPlane=n}(view||(view={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),view;!function(e){var t=function(t){function i(){var e=t.call(this)||this;return e.desktop=null,e.seat=0,e.trans_hand=null,e.trans_paihai=null,e.trans_ming=null,e.trans_liqi=null,e.trans_ind=null,e.trans_dir=null,e.trans_man=null,e.container_score=null,e.trans_scores=null,e.hand3d=null,e._anim_hands=[],e.container_qipai=null,e.container_ming=null,e.score=0,e.duringShowDetla=!1,e.anim_id=0,e.trans_liqi_position=null,e.trans_liqi_scale=null,e.liqibang=null,e}return __extends(i,t),i.prototype.Init=function(t,i,n,a,r,o){this.desktop=t,this.seat=i,this.trans_hand=n,this.trans_paihai=r,this.trans_ming=a,this.trans_man=o;for(h=0;h<this.trans_hand.parent.numChildren;h++)this.trans_hand.parent.getChildAt(h).active=!1;for(h=0;h<this.trans_ming.parent.numChildren;h++)this.trans_ming.parent.getChildAt(h).active=!1;for(h=0;h<this.trans_paihai.parent.numChildren;h++)this.trans_paihai.parent.getChildAt(h).active=!1;this.container_qipai=new e.Block_QiPai(r,this),this.container_ming=new e.Block_Ming(a,this),this.trans_liqi=o.getChildByName("liqi"),this.trans_liqi.active=!1,this.trans_liqi_position=this.trans_liqi.transform.localPosition,this.trans_liqi_scale=this.trans_liqi.transform.localScale,this.trans_dir=o.getChildByName("dir"),this.trans_ind=o.getChildByName("ind");var s=o.getChildByName("score");this.container_score=s,this.trans_scores=new Array;for(var h=0;h<10;h++)this.trans_scores.push(s.getChildByName(h.toString()));this.hand3d=o.parent.getChildByName("hand_"+(i+1).toString()),this.hand3d.getChildByName("Dum_Lizhi").getChildByName("p").active=!1,this.hand3d.getChildByName("Dum_Majiang").getChildByName("p").active=!1;var l=this.hand3d.getChildByName("Dum_Majiang").addChild(new Laya.Sprite3D("node"));l.active=!0,l.transform.localPosition=new Laya.Vector3(0,0,0),l.transform.localRotation=new Laya.Quaternion(.707,.707,0,0);var c=this.hand3d.getChildByName("Dum_Majiang").addChild(new Laya.Sprite3D("node2"));c.active=!0,c.transform.localPosition=new Laya.Vector3(0,0,0),c.transform.localRotation=new Laya.Quaternion(-.5,.5,-.5,.5),this._anim_hands=[this.hand3d.getComponentByType(Laya.Animator)];var p=this.hand3d.getChildByName("hand"),u=new caps.BaseMaterial(caps.Cartoon.filename);u.setTexture(caps.Cartoon.TEXTURE,p.skinnedMeshRender.sharedMaterials[0].albedoTexture),u.setColor(caps.Cartoon.COLOR_LIGHT,new Laya.Vector3(1,1,1)),u.setColor(caps.Cartoon.COLOR_UNLIGHT,new Laya.Vector3(.9725,.9137,.937)),u.setColor(caps.Cartoon.COLOR,new Laya.Vector3(1,1,1)),u.setNumber(caps.Cartoon.SPLIT,.4);var d=new caps.BaseMaterial(caps.Cartoon.filename);d.setTexture(caps.Cartoon.TEXTURE,p.skinnedMeshRender.sharedMaterials[1].albedoTexture),d.setColor(caps.Cartoon.COLOR_LIGHT,new Laya.Vector3(1,1,1)),d.setColor(caps.Cartoon.COLOR_UNLIGHT,new Laya.Vector3(.9725,.9137,.937)),d.setColor(caps.Cartoon.COLOR,new Laya.Vector3(1,1,1)),d.setNumber(caps.Cartoon.SPLIT,.4),p.skinnedMeshRender.sharedMaterials=[u,d];var _=this.hand3d.clone();_.getChildByName("Dum_Lizhi").destroy(!0),_.getChildByName("Dum_Majiang").destroy(!0),_.getChildByName("Dum_Shadow").destroy(!0),this.hand3d.addChild(_),_.transform.localPosition=new Laya.Vector3(0,0,0),_.transform.localScale=new Laya.Vector3(1,1,1),_.transform.localRotation=new Laya.Quaternion(0,0,0,0);var m=_.getChildByName("hand"),f=new caps.Material_Outline(caps.Outline.filename);f.setColor(caps.Outline.OUTLINE_COLOR,new Laya.Vector3(.6823,.447,.408)),f.setNumber(caps.Outline.OUTLINE,.001);var g=new caps.Material_Outline(caps.Outline.filename);g.setColor(caps.Outline.OUTLINE_COLOR,new Laya.Vector3(.6823,.447,.408)),g.setNumber(caps.Outline.OUTLINE,.001),m.skinnedMeshRender.sharedMaterials=[f,g],this._anim_hands.push(_.getComponentByType(Laya.Animator)),this.SetScore(25e3,25e3),this.RefreshDir()},i.prototype.onInitRoom=function(e){this.seat=e,this.create_liqibang()},i.prototype.create_liqibang=function(){this.liqibang&&(this.liqibang.destroy(!0),this.liqibang=null),this.liqibang=Laya.loader.getRes(e.DesktopMgr.Inst.player_effects[this.seat].liqibang).clone(),this.trans_liqi.addChild(this.liqibang),this.liqibang.transform.localPosition=new Laya.Vector3(0,0,0),this.liqibang.transform.localScale=new Laya.Vector3(1,1,1),this.liqibang.transform.localRotationEuler=new Laya.Vector3(0,0,0),this.liqibang.active=!0;var t=this.liqibang.getChildAt(0),i=new caps.BaseMaterial(caps.Cartoon.filename);i.setTexture(caps.Cartoon.TEXTURE,t.meshRender.material.albedoTexture),i.setNumber(caps.Cartoon.SPLIT,.4),i.setColor(caps.Cartoon.COLOR_LIGHT,new Laya.Vector3(1,1,1)),i.setColor(caps.Cartoon.COLOR_UNLIGHT,new Laya.Vector3(1,1,1)),i.setColor(caps.Cartoon.COLOR,new Laya.Vector3(1,1,1)),t.meshRender.sharedMaterial=i},i.prototype.playHandAnimtion=function(e,t,i){var n=this;this.hand3d.active=!0;for(var a=0;a<this._anim_hands.length;a++)this._anim_hands[a].play(e,t);this.hand3d.transform.localScale=new Laya.Vector3(1e-4,1e-4,1),Laya.timer.frameOnce(1,this,function(){n.hand3d.transform.localScale=new Laya.Vector3(1,1,1)}),this.anim_id++;var r=this.anim_id;Laya.timer.once(i,this,function(){r==n.anim_id&&(n.hand3d.active=!1)})},i.prototype.setSeat=function(e){this.seat=e},i.prototype.Reset=function(){this.duringShowDetla=!1,this.container_ming.Reset(),this.container_qipai.Reset(),this.trans_liqi.active=!1,this.hand3d&&(this.hand3d.active=!1),Laya.timer.clearAll(this),this.anim_id=0},i.prototype.AddQiPai=function(e,t,i,n){void 0===n&&(n=!0),this.container_qipai.AddQiPai(e,t,i,n)},i.prototype.QiPaiPass=function(){this.container_qipai.QiPaiPass()},i.prototype.QiPaiNoPass=function(){this.container_qipai.QiPaiNoPass()},i.prototype.AddMing=function(e,t){void 0===t&&(t=!0),this.container_ming.AddMing(e,t)},i.prototype.AddGang=function(e,t){void 0===t&&(t=!0),this.container_ming.AddGang(e,t)},i.prototype.ShowLiqi=function(e){var t=this;void 0===e&&(e=!0),this.trans_liqi.transform.localPosition=this.trans_liqi_position,this.trans_liqi.transform.localScale=this.trans_liqi_scale,this.trans_liqi.active=!0,e&&(this.hand3d.transform.position=this.trans_liqi.transform.position.clone(),this.hand3d.getChildByName("Dum_Lizhi").addChild(this.trans_liqi),this.trans_liqi.transform.localScale=new Laya.Vector3(.01,.01,.01),this.trans_liqi.transform.localPosition=new Laya.Vector3(0,0,0),this.trans_liqi.transform.localRotation=new Laya.Quaternion(0,0,-.7,-.7),this.hand3d.active=!0,this.playHandAnimtion("LiZhi",1,800),Laya.timer.once(500,this,function(){t.trans_man.addChild(t.trans_liqi),t.trans_liqi.transform.localPosition=t.trans_liqi_position,t.trans_liqi.transform.localScale=t.trans_liqi_scale,t.trans_liqi.transform.localRotation=new Laya.Quaternion(0,0,0,1)}))},i.prototype.SetScore=function(e,t){this.score=e,this.RefreshScore(t)},i.prototype.RefreshDir=function(){var t=new Laya.Vector4;t.z=(this.seat-e.DesktopMgr.Inst.index_ju+4)%4*.25,t.w=0,t.x=.25,t.y=1,this.trans_dir.meshRender.material.tilingOffset=t},i.prototype.RefreshScore=function(e){var t="",i=0;if(this.duringShowDetla){var n=this.score-e;n>0?(t="+"+n.toString(),i=-.33333):(t=n.toString(),i=-.66667)}else t=this.score.toString(),i=0;for(o=0;o<t.length&&o<this.trans_scores.length;o++){var a=0;switch(t[t.length-o-1]){case"-":a=0;break;case"+":a=1;break;case"0":a=2;break;case"1":a=3;break;case"2":a=4;break;case"3":a=5;break;case"4":a=6;break;case"5":a=7;break;case"6":a=8;break;case"7":a=9;break;case"8":a=10;break;case"9":a=11}a/=12;var r=new Laya.Vector4;r.z=a,r.w=i,r.x=1/12,r.y=1/3,this.trans_scores[o].meshRender.material.tilingOffset=r,this.trans_scores[o].active=!0}for(var o=t.length;o<this.trans_scores.length;o++)this.trans_scores[o].active=!1;if(t.length<=6){(s=this.container_score.transform.localPosition.clone()).x=.165*(t.length-1)/2-.5325,this.container_score.transform.localPosition=s,this.container_score.transform.localScale=new Laya.Vector3(1,1,1)}else{var s=this.container_score.transform.localPosition.clone();s.x=-.12,this.container_score.transform.localPosition=s;var h=.56+(10-t.length)/4*(1-.56),l=.9+(10-t.length)/4*(1-.9);this.container_score.transform.localScale=new Laya.Vector3(h,l,1)}},i.prototype.Hule=function(e,t,i,n){},i.prototype.Huangpai=function(e,t,i){},i.prototype.OnDoraRefresh=function(){this.container_qipai.OnDoraRefresh(),this.container_ming.OnDoraRefresh()},i.prototype.OnChoosePai=function(){this.container_qipai.OnChoosedPai(),this.container_ming.OnChoosedPai()},i.prototype.PlaySound=function(t){var i="";switch(t){case"act_chi":i="chi";break;case"act_drich":case"act_rich":i="lizhi";break;case"act_kan":i="gang";break;case"act_pon":i="peng"}""!=i&&uiscript.UI_DesktopInfo.Inst.shout((this.seat-this.desktop.seat+4)%4,i,this.desktop.player_datas[this.seat]),e.AudioMgr.PlayCharactorSound(this.desktop.player_datas[this.seat].character,t)},i}(Laya.Script);e.ViewPlayer=t}(view||(view={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),view;!function(e){var t=function(t){function i(){var e=t.call(this)||this;return e._choose_pai=null,e._mouse_in_pai=null,e._mouse_in_start_time=-1,e.handpool=[],e.hand=[],e.during_liqi=!1,e.effect_click=null,e.trans_hand3D=null,e.trans_hand3DCover=null,e._hand3d=[],e.can_discard=!1,e.last_tile=null,e._prediscard_index=-1,e.mouse_downx=0,e.mouse_downy=0,e.mouse_downed=!1,e.during_drag=!1,e.click_on_choosed=!1,e.zd=0,e.screen_left=-7.2,e.screen_right=44.4,e.screen_top=16.6,e.screen_bottom=-1.4,e.handrange_top=2.5,e.handorigin_x=0,e.handwidth=2.55,i.Inst=e,e}return __extends(i,t),i.prototype.Init=function(i,n,a,r,o,s){t.prototype.Init.call(this,i,n,a,r,o,s);var h=a.getChildByName("pai");this.effect_click=a.getChildByName("effect_dianji"),a.active=!0,h.active=!1;for(var l=0;l<16;l++){var c=h.clone();this.trans_hand.addChild(c),c.transform.localPosition=new Laya.Vector3(0,0,0),c.transform.localRotation=new Laya.Quaternion(0,0,0,1),c.transform.localScale=new Laya.Vector3(1,1,1),c.active=!1;var p=c.addComponent(e.HandPaiPlane);this.handpool.push(p)}this.ray=new Laya.Ray(new Laya.Vector3,new Laya.Vector3),this.phasorSprite3D=new Laya.PhasorSpriter3D,this.rayCastHit=new Laya.RaycastHit,Laya.stage.on(Laya.Event.MOUSE_DOWN,this,this.onMouseDown),Laya.stage.on(Laya.Event.MOUSE_UP,this,this.onMouseUp),Laya.stage.on(Laya.Event.MOUSE_MOVE,this,this.onMouseMove),Laya.stage.on(Laya.Event.MOUSE_OUT,this,this.onMouseOut)},i.prototype._AddHandPai=function(t){var i=this.handpool.pop();return i.Reset(),i.SetVal(t,!0),i.z=this.zd,this.zd-=.02,e.DesktopMgr.Inst.mode!=e.EMJMode.play&&(i.ispaopai=e.DesktopMgr.Inst.isPaoPai(i.val),i.RefreshPaoPai()),this.hand.push(i),i},i.prototype._OnRemovePai=function(e){e===this._choose_pai&&(this._choose_pai=null,this.resetMouseState())},i.prototype._RemovePai=function(e){for(var t=0;t<this.hand.length;t++)if(this.hand[t]===e){for(var i=this.hand[t],n=t;n<this.hand.length-1;n++)this.hand[n]=this.hand[n+1],this.hand[n].SetIndex(n,!1,!0);this.hand.pop(),this._OnRemovePai(i),i.Reset(),this.handpool.push(i);break}},i.prototype._RemoveHandPai=function(e){for(var t=this.hand.length-1;t>=0;t--)if(mjcore.MJPai.isSame(e,this.hand[t].val)){for(var i=this.hand[t],n=t;n<this.hand.length-1;n++)this.hand[n]=this.hand[n+1],this.hand[n].SetIndex(n,!1,!0);this.hand.pop(),this._OnRemovePai(i),i.Reset(),this.handpool.push(i);break}},i.prototype.Reset=function(){t.prototype.Reset.call(this);for(e=0;e<this.hand.length;e++)this.hand[e].Reset(),this.handpool.push(this.hand[e]);this.hand=[];for(var e=0;e<this._hand3d.length;e++)this._hand3d[e].Destory();this._hand3d=[],this.zd=0,this.during_liqi=!1,this.trans_hand3D.active=!1,this.trans_hand3DCover.active=!1,this.last_tile=null,this.can_discard=!1,this._choose_pai=null,this._mouse_in_pai=null,this.resetMouseState(),Laya.timer.clearAll(this)},i.prototype.ForceSet=function(e){this.RefreshDir();for(var t=0;t<e.length;t++){this._AddHandPai(e[t]).SetIndex(t,!1,!1)}this.LiPai(),this.last_tile=null,Laya.timer.frameLoop(1,this,this.update)},i.prototype.NewGame=function(t,i){var n=this;if(this.Reset(),this.RefreshDir(),i)for(r=0;r<t.length;r++){this._AddHandPai(t[r]).SetIndex(r,14==r,!1)}else{for(var a=[],r=0;r<t.length;r++){var o=Math.floor(Math.random()*r);a.push(a[o]),a[o]=t[r]}for(var s=0,r=0;r<4;r++)Laya.timer.once(300*r,this,function(){for(var t=0;t<4&&s!=a.length;t++){s++;var i=n._AddHandPai(a[s-1]);i.SetIndex(s-1,!1,!1),i.AnimNewTile()}e.AudioMgr.PlayAudio(216)});Laya.timer.once(1200,this,function(){n.LiPai(),n.last_tile=n.hand[n.hand.length-1],14==n.hand.length&&n.hand[n.hand.length-1].SetIndex(n.hand.length-1,!0,!1)})}Laya.timer.frameLoop(1,this,this.update)},i.prototype.RecordNewGame=function(e){this.Reset(),this.RefreshDir();for(var t=0;t<e.length;t++){this._AddHandPai(e[t]).SetIndex(t,14==t,!1)}Laya.timer.frameLoop(1,this,this.update)},i.prototype.TakePai=function(e,t){void 0===t&&(t=!0),app.Log.log("ViewPlayer_Me TakePai "+e.toString()+" doanim:"+t);try{var i=this._AddHandPai(e);i.SetIndex(this.hand.length-1,!0,!1),t&&i.AnimNewTile(),this.last_tile=i}catch(e){var n={};n.error=e.message,n.stack=e.stack,n.method="TakePai",n.name="ViewPlayer_Me",GameMgr.Inst.onFatalError(n)}app.Log.log("ViewPlayer_Me TakePai end")},i.prototype.OnDiscardTile=function(e,t){app.Log.log("ViewPlayer_Me OnDiscardTile "+e.toString()+" fast:"+t);try{if(this._prediscard_index>=0&&this._prediscard_index<this.hand.length){this.hand[this._prediscard_index].val;mjcore.MJPai.isSame(this.hand[this._prediscard_index].val,e)?this._RemovePai(this.hand[this._prediscard_index]):(this.hand[this._prediscard_index].mySelf.active=!0,this._RemoveHandPai(e))}else this._RemoveHandPai(e);this.LiPai(t),this.last_tile=null,this._prediscard_index=-1}catch(e){var i={};i.error=e.message,i.stack=e.stack,i.method="OnDiscardTile",i.name="ViewPlayer_Me OnDiscardTile",GameMgr.Inst.onFatalError(i)}},i.prototype.AddGang=function(e,i){void 0===i&&(i=!0),app.Log.log("ViewPlayer_Me AddGang "+e.toString()+" doanim:"+i);try{t.prototype.AddGang.call(this,e,i),this._RemoveHandPai(e),this.LiPai(),this.last_tile=null}catch(e){var n={};n.error=e.message,n.stack=e.stack,n.method="AddGang",n.class="ViewPlayer_Me",GameMgr.Inst.onFatalError(n)}},i.prototype.LiPai=function(t){void 0===t&&(t=!1);for(i=0;i<this.hand.length;i++)this.hand[i].SelectEnd();if(e.DesktopMgr.Inst.auto_liqi||e.DesktopMgr.Inst.mode!=e.EMJMode.play){this.hand.sort(e.HandPaiPlane.Cmp);for(var i=0;i<this.hand.length;i++)this.hand[i].SetIndex(i,!1,!t),e.DesktopMgr.Inst.mode!=e.EMJMode.play&&this.hand[i].RefreshPaoPai()}},i.prototype.AddMing=function(e,t){void 0===t&&(t=!0),app.Log.log("ViewPlayer_Me AddMing "+e.toString()+" doanim:"+t);try{for(var i=0;i<e.pais.length;i++)e.from[i]==this.seat&&this._RemoveHandPai(e.pais[i]);this.container_ming.AddMing(e,t),this.LiPai(),this.last_tile=null}catch(e){var n={};n.error=e.message,n.stack=e.stack,n.method="AddMing",n.class="ViewPlayer_Me",GameMgr.Inst.onFatalError(n)}},i.prototype.ChiTiSelect=function(e){for(var t=0;t<this.hand.length;t++)this.hand[t].ChiTiSelect(e)},i.prototype.LiQiSelect=function(e,t){this.during_liqi=t;for(var i=0;i<this.hand.length;i++)t?this.hand[i].LiqiSelect(e):this.hand[i].SelectEnd()},i.prototype.HulePrepare=function(t,i,n){app.Log.log("ViewPlayer_Me HulePrepare "+i.toString()+" zimo:"+n);try{uiscript.UI_DesktopInfo.Inst.setZhenting(!1);for(r=0;r<this.hand.length;r++)this.hand[r].Hule();for(var a=[],r=0;r<t.length;r++){var o=new e.HandPai3D(this.trans_hand3D);o.SetVal(t[r]),o.SetIndex(r,!1),o.Stand(),a.push(o)}this._hand3d=a,this.trans_hand3D.active=!0}catch(e){var s={};s.error=e.message,s.stack=e.stack,s.method="HulePrepare",s.class="ViewPlayer_Me",GameMgr.Inst.onFatalError(s)}},i.prototype.Hule=function(t,i,n,a){var r=this;if(app.Log.log("ViewPlayer_Me Hule "+i.toString()+" zimo:"+n),n){var o=new e.HandPai3D(this.trans_hand3D);o.SetVal(i),o.SetIndex(this._hand3d.length,!0),this._hand3d.push(o),o.FullDown(),o.shadow.active=!1,o.model.transform.localPosition.z+=.2*e.PAIMODEL_HEIGHT;var s=o.pai3D.model.transform.position.clone();this.hand3d.transform.position=s.clone(),this.hand3d.getChildByName("Dum_Majiang").getChildByName("node").addChild(o.pai3D.model),o.pai3D.model.transform.localPosition=new Laya.Vector3(0,0,0),o.pai3D.model.transform.localRotation=new Laya.Quaternion(0,1,0,0),this.playHandAnimtion("Zimo",1,900),Laya.timer.once(450,this,function(){e.AudioMgr.PlayAudio(227)}),Laya.timer.once(900,this,function(){o.contianer_pai.addChild(o.pai3D.model),o.FullDown(),Laya.timer.once(100,r,function(){return e.DesktopMgr.Inst.ShowHuleEffect(o.pai3D.model.transform.position,e.DesktopMgr.Inst.player_effects[r.seat].effect_hupai)})})}var h=this._hand3d.length-(n?1:0),l=n?1100:200;Laya.timer.once(l,this,function(){if(0!=r._hand3d.length){e.AudioMgr.PlayAudio(223);for(var t=0;t<h;t++)r._hand3d[t].DoAnim_FullDown()}}),this.trans_hand3D.active=!0},i.prototype.Huangpai=function(t,i,n){var a=this;app.Log.log("ViewPlayer_Me Huangpai  tingpai:"+t+" fast:"+n),uiscript.UI_DesktopInfo.Inst.setZhenting(!1);for(s=0;s<this.hand.length;s++)this.hand[s].Hule();for(var r=[],o=t?this.trans_hand3D:this.trans_hand3DCover,s=0;s<this.hand.length;s++){var h=new e.HandPai3D(o);h.SetVal(this.hand[s].val),h.SetIndex(s,!1),h.Stand(),r.push(h)}var l=r.length;if(n)for(s=0;s<l;s++)t?this._hand3d[s].FullDown():this._hand3d[s].Cover();else Laya.timer.once(500,this,function(){for(var i=0;i<l;i++)t?a._hand3d[i].DoAnim_FullDown():a._hand3d[i].DoAnim_Cover();e.AudioMgr.PlayAudio(223)});this._hand3d=r,o.active=!0},i.prototype.OnDoraRefresh=function(){t.prototype.OnDoraRefresh.call(this);for(var e=0;e<this.hand.length;e++)this.hand[e].RefreshDora()},i.prototype.DoDiscardTile=function(){if(app.Log.log("ViewPlayer_Me DoDiscardTile"),this.during_liqi){if(!this.desktop.Action_LiQi(this._choose_pai.val,this._choose_pai===this.last_tile))return;this.during_liqi=!1}else this.desktop.Action_QiPai(this._choose_pai.val,this._choose_pai===this.last_tile);this._prediscard_index=this._choose_pai.index,this._choose_pai.mySelf.active=!1,this._choose_pai=null,this.can_discard=!1},i.prototype.onShowPaopaiChange=function(){if(e.DesktopMgr.Inst.gameing)for(var t=0;t<this.hand.length;t++)this.hand[t].ispaopai=e.DesktopMgr.Inst.isPaoPai(this.hand[t].val),this.hand[t].RefreshPaoPai()},i.prototype.onDoubleClick=function(){this.can_discard&&(this.during_liqi||this.last_tile&&(this.desktop.Action_QiPai(this.last_tile.val,!0),this._prediscard_index=this.hand.length-1,this.last_tile.mySelf.active=!1,this._choose_pai=null,this.can_discard=!1))},i.prototype.setChoosePai=function(t,i){if(this._choose_pai!==t){if(this._choose_pai&&this._choose_pai!=t){var n=this._choose_pai.mySelf.transform.localPosition.clone();n.y=0,this._choose_pai.mySelf.transform.localPosition=n,this._choose_pai=null}this._choose_pai=t;var a=this._choose_pai.mySelf.transform.localPosition.clone();a.y=.8,this._choose_pai.mySelf.transform.localPosition=a,i&&t.AddClickEffect(this.effect_click.clone()),e.DesktopMgr.Inst.setChoosedPai(this._choose_pai.val),e.AudioMgr.PlayAudio(204)}},i.prototype.resetMouseState=function(){if(this._mouse_in_pai=null,this.during_drag=!1,this.mouse_downed=!1,this.click_on_choosed=!1,this._choose_pai){var t=this._choose_pai.mySelf.transform.localPosition.clone();t.y=0,this._choose_pai.mySelf.transform.localPosition=t,this._choose_pai=null}e.DesktopMgr.Inst.setChoosedPai(null)},i.prototype.onMouseDown=function(){if(e.DesktopMgr.Inst.gameing){var t=this.getMouseInfo();t.pai?(this._choose_pai===t.pai?this.click_on_choosed=!0:(this.setChoosePai(t.pai,!0),this.click_on_choosed=!1),this.mouse_downx=Laya.MouseManager.instance.mouseX,this.mouse_downy=Laya.MouseManager.instance.mouseY,this.mouse_downed=!0):this.resetMouseState()}},i.prototype.onMouseMove=function(){if(e.DesktopMgr.Inst.mode==e.EMJMode.play&&this._choose_pai&&this.mouse_downed){var t=Laya.MouseManager.instance.mouseX,i=Laya.MouseManager.instance.mouseY;(t-this.mouse_downx)*(t-this.mouse_downx)+(i-this.mouse_downy)*(i-this.mouse_downy)>400&&(this.during_drag=!0)}},i.prototype.onMouseUp=function(){if(e.DesktopMgr.Inst.gameing){var t=this.getMouseInfo();this.mouse_downed=!1,this.during_drag?(this.during_drag=!1,null==this._choose_pai?this.resetMouseState():this.can_discard&&!t.inHandRange&&this._choose_pai.valid?(this.DoDiscardTile(),this.resetMouseState()):this.resetMouseState()):this.click_on_choosed&&this.can_discard&&this._choose_pai.valid&&(this.DoDiscardTile(),this.resetMouseState())}},i.prototype.onMouseOut=function(){this.mouse_downed=!1,this.click_on_choosed=!1,this.during_drag&&(this.during_drag=!1,this.resetMouseState())},i.prototype.getMouseInfo=function(){var t=Laya.MouseManager.instance.mouseX,i=Laya.MouseManager.instance.mouseY,n=0,a=0;Laya.Browser.width/1920<Laya.Browser.height/1080?a=(Laya.Browser.height-Laya.Browser.width/1920*1080)/2:n=(Laya.Browser.width-Laya.Browser.height/1080*1920)/2;var r=t/(Laya.Browser.width-2*n)*(this.screen_right-this.screen_left)+this.screen_left,o=i/(Laya.Browser.height-2*a)*(this.screen_bottom-this.screen_top)+this.screen_top,s=Math.floor((r-this.handorigin_x)/this.handwidth);s<0&&(s=0),s>=this.hand.length&&(s=this.hand.length-1);var h=null;return game.Scene_MJ.Inst.camera_hand.viewportPointToRay(new Laya.Vector2(t,i),this.ray),Laya.Physics.rayCast(this.ray,this.rayCastHit,300),this.rayCastHit.sprite3D&&(h=this.rayCastHit.sprite3D.getComponentByType(e.HandPaiPlane)),{inHandRange:o<this.handrange_top,index:s,x:r,y:o,pai:h}},i.prototype.update=function(){var t=this.getMouseInfo();if(this.during_drag)if(e.DesktopMgr.Inst.gameing)if(null==this._choose_pai)this.resetMouseState();else{if(!e.DesktopMgr.Inst.auto_liqi&&t.inHandRange&&t.index!=this._choose_pai.index){if(t.index<this._choose_pai.index){for(i=t.index;i<this._choose_pai.index;i++)this.hand[i].SetIndex(i+1,!1,!0);for(i=this._choose_pai.index;i>t.index;i--)this.hand[i]=this.hand[i-1],this.hand[i].SetIndex(i,!1,!0)}else for(var i=this._choose_pai.index;i<t.index;i++)this.hand[i]=this.hand[i+1],this.hand[i].SetIndex(i,!1,!0);this.hand[t.index]=this._choose_pai,this._choose_pai.SetIndex(t.index,!1,!0)}this._choose_pai.mySelf.parent.setChildIndex(this._choose_pai.mySelf,this._choose_pai.mySelf.parent.numChildren-1),this._choose_pai.mySelf.transform.localPosition=new Laya.Vector3(t.x,t.y,.5)}else this.resetMouseState();else if(!this.mouse_downed&&Laya.Browser.onPC&&!GameMgr.inConch&&0==e.DesktopMgr.click_prefer&&e.DesktopMgr.Inst.gameing)if(null==t.pai)this.resetMouseState();else if(this._mouse_in_pai&&this._mouse_in_pai===t.pai){Laya.timer.currTimer-this._mouse_in_start_time>10&&(this.setChoosePai(this._mouse_in_pai,!1),this._mouse_in_pai=null)}else this._mouse_in_pai=t.pai,this._mouse_in_start_time=Laya.timer.currTimer},i.Inst=null,i}(e.ViewPlayer);e.ViewPlayer_Me=t}(view||(view={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),view;!function(e){var t=function(t){function i(){var e=t.call(this)||this;return e.handnum=0,e.hand=null,e.discardcd=0,e}return __extends(i,t),i.prototype.Reset=function(){if(t.prototype.Reset.call(this),null!=this.hand){for(var e=0;e<this.hand.length;e++)this.hand[e].Destory();this.hand=null}Laya.timer.clearAll(this),this.discardcd=0},i.prototype.ForceSet=function(e){this.Reset(),this.RefreshDir(),this.hand=[],this.SetNum(e)},i.prototype.NewGame=function(t,i){var n=this;if(this.Reset(),this.RefreshDir(),this.handnum=t,this.hand=[],i)for(o=0;o<t;o++){var a=new e.HandPai3D(this.trans_hand.parent);a.SetVal(mjcore.MJPai.Create("5z")),a.SetIndex(o,14==o),a.Stand(),this.hand.push(a)}else{for(var r=0,o=0;o<4;o++)Laya.timer.once(300*o,this,function(){for(var i=0;i<4&&r!=t;i++){r++;var a=new e.HandPai3D(n.trans_hand.parent);a.SetVal(mjcore.MJPai.Create("5z")),a.SetIndex(r-1,!1),n.hand.push(a),a.DoAnim_Stand()}});14==t&&Laya.timer.once(900,this,function(){n.hand[13].SetIndex(13,!0)})}},i.prototype.RecordNewGame=function(t){this.Reset(),this.RefreshDir(),this.handnum=t.length,this.hand=new Array;for(var i=0;i<t.length;i++){var n=new e.HandPai3D(this.trans_hand.parent);n.SetVal(t[i]),n.SetIndex(i,14==i),e.DesktopMgr.Inst.record_show_hand?n.FullDown():n.Stand(),this.hand.push(n)}},i.prototype.LiPai=function(){this.hand[this.hand.length-1].SetIndex(this.hand.length-1,!1),this.hand[this.hand.length-1].Stand()},i.prototype.onDiscardTile=function(e,t){var i=this;if(app.Log.log("ViewPlayer_Other onDiscardTile  moqie:"+e+" fast:"+t),t)this.hand[this.hand.length-1].Destory(),this.hand.pop();else if(e)this.hand[this.hand.length-1].Destory(),this.hand.pop();else{var n=Math.floor(Math.random()*(this.hand.length-1));this.hand[n].Destory(),this.discardcd=1200+Laya.timer.currTimer,Laya.timer.once(1e3,this,function(){i.hand[n]=i.hand[i.hand.length-1],i.hand.pop(),i.hand[n].SetIndex(n,!1),i.hand[n].Stand()})}},i.prototype._RemoveHandPai=function(e,t){if(void 0===t&&(t=!0),t){for(i=0;i<this.hand.length;i++)if(mjcore.MJPai.isSame(e,this.hand[i].val)){n=this.hand[i];this.hand[i]=this.hand[this.hand.length-1],this.hand[this.hand.length-1]=n,this.hand.pop(),n.Destory();break}}else for(var i=this.hand.length-1;i>=0;i--)if(mjcore.MJPai.isSame(e,this.hand[i].val)){var n=this.hand[i];this.hand[i]=this.hand[this.hand.length-1],this.hand[this.hand.length-1]=n,this.hand.pop(),n.Destory();break}},i.prototype._LiPai=function(){this.hand.sort(function(e,t){return mjcore.MJPai.Distance(e.val,t.val)});for(var e=0;e<this.hand.length;e++)this.hand[e].SetIndex(e,!1)},i.prototype.recordDiscardTile=function(e,t,i){var n=this;this._RemoveHandPai(e,!t),i?this._LiPai():Laya.timer.once(1e3,this,function(){n._LiPai()})},i.prototype.SetNum=function(t){for(app.Log.log("ViewPlayer_Other SetNum  _num:"+t+" _oldnum:"+this.hand.length);this.hand.length<t;){var i=new e.HandPai3D(this.trans_hand.parent);i.SetVal(mjcore.MJPai.Create("5z")),i.SetIndex(this.hand.length,!1),i.Stand(),this.hand.push(i)}for(;this.hand.length>t;)this.hand[this.hand.length-1].Destory(),this.hand.pop();app.Log.log("ViewPlayer_Other SetNum _chandlength:"+this.hand.length),this.LiPai()},i.prototype.AddMing=function(i,n){void 0===n&&(n=!0),app.Log.log("ViewPlayer_Other AddMing  ming:"+i.toString()+" doanim:"+n);try{if(e.DesktopMgr.Inst.mode==e.EMJMode.play){for(var a=0,r=0;r<i.pais.length;r++)i.from[r]==this.seat&&a++;this.SetNum(this.hand.length-a)}else{for(r=0;r<i.pais.length;r++)i.from[r]==this.seat&&this._RemoveHandPai(i.pais[r]);this._LiPai()}t.prototype.AddMing.call(this,i,n)}catch(e){var o={};o.error=e.message,o.stack=e.stack,o.method="AddMing",o.class="ViewPlayer_Other",GameMgr.Inst.onFatalError(o)}},i.prototype.AddGang=function(i,n){void 0===n&&(n=!0),app.Log.log("ViewPlayer_Other AddGang "+i.toString()+" doanim:"+n);try{t.prototype.AddGang.call(this,i,n),e.DesktopMgr.Inst.mode==e.EMJMode.play?this.SetNum(this.hand.length-1):(this._RemoveHandPai(i),this._LiPai())}catch(e){var a={};a.error=e.message,a.stack=e.stack,a.method="TakePai",a.class="ViewPlayer_Other",GameMgr.Inst.onFatalError(a)}},i.prototype.OnDoraRefresh=function(){if(t.prototype.OnDoraRefresh.call(this),e.DesktopMgr.Inst.mode!=e.EMJMode.play)for(var i=0;i<this.hand.length;i++)this.hand[i].pai3D.RefreshDora()},i.prototype.TakePai=function(t){app.Log.log("ViewPlayer_Other TakePai "+t.toString());try{var i=new e.HandPai3D(this.trans_hand.parent);i.SetVal(t),i.SetIndex(this.hand.length,!0),i.Stand(),this.hand.push(i)}catch(e){var n={};n.error=e.message,n.stack=e.stack,n.method="TakePai",n.class="ViewPlayer_Other",GameMgr.Inst.onFatalError(n)}},i.prototype.recordTakePai=function(t){var i=new e.HandPai3D(this.trans_hand.parent);i.SetVal(t),i.SetIndex(this.hand.length,!0),e.DesktopMgr.Inst.record_show_hand?(i.FullDown(),i.pai3D.ispaopai=e.DesktopMgr.Inst.isPaoPai(i.pai3D.val)):i.Stand(),i.pai3D.OnChoosedPai(),this.hand.push(i)},i.prototype.Hule=function(t,i,n,a){var r=this;if(app.Log.log("ViewPlayer_Other Hule "+i.toString()+" zimo:"+n),e.DesktopMgr.Inst.mode==e.EMJMode.play){if(this.SetNum(t.length+(n?1:0)),n){var o=this.hand[this.hand.length-1];o.SetVal(i),o.SetIndex(this.hand.length-1,!0),o.FullDown(),o.model.transform.localPosition.z+=.2*e.PAIMODEL_HEIGHT,o.shadow.active=!1;c=o.pai3D.model.transform.position.clone();this.hand3d.transform.position=c.clone(),this.hand3d.getChildByName("Dum_Majiang").getChildByName("node").addChild(o.pai3D.model),o.pai3D.model.transform.localPosition=new Laya.Vector3(0,0,0),o.pai3D.model.transform.localRotation=new Laya.Quaternion(0,1,0,0),this.playHandAnimtion("Zimo",1,900),Laya.timer.once(450,this,function(){e.AudioMgr.PlayAudio(227)}),Laya.timer.once(900,this,function(){o.contianer_pai.addChild(o.pai3D.model),o.FullDown(),Laya.timer.once(100,r,function(){return e.DesktopMgr.Inst.ShowHuleEffect(o.pai3D.model.transform.position,e.DesktopMgr.Inst.player_effects[r.seat].effect_hupai)})})}var s=t.length,h=n?1100:200;Laya.timer.once(h,this,function(){e.AudioMgr.PlayAudio(223);for(var i=0;i<s;i++)r.hand[i].SetVal(t[i]),r.hand[i].DoAnim_FullDown()})}else{if(n){var l=this.hand[this.hand.length-1];l.SetVal(i),l.SetIndex(this.hand.length-1,!0),l.FullDown(),l.model.transform.localPosition.z+=.2*e.PAIMODEL_HEIGHT,l.shadow.active=!1;var c=l.pai3D.model.transform.position.clone();this.hand3d.transform.position=c.clone(),this.hand3d.getChildByName("Dum_Majiang").getChildByName("node").addChild(l.pai3D.model),l.pai3D.model.transform.localPosition=new Laya.Vector3(0,0,0),l.pai3D.model.transform.localRotation=new Laya.Quaternion(0,1,0,0),this.playHandAnimtion("Zimo",1,900),Laya.timer.once(450,this,function(){e.AudioMgr.PlayAudio(227)}),Laya.timer.once(900,this,function(){l.contianer_pai.addChild(l.pai3D.model),l.FullDown(),Laya.timer.once(100,r,function(){return e.DesktopMgr.Inst.ShowHuleEffect(l.pai3D.model.transform.position,e.DesktopMgr.Inst.player_effects[r.seat].effect_hupai)})})}if(e.DesktopMgr.Inst.record_show_hand);else{var p=t.length,h=n?1100:200;Laya.timer.once(h,this,function(){e.AudioMgr.PlayAudio(223);for(var t=0;t<p;t++)r.hand[t].DoAnim_FullDown()})}}},i.prototype.Huangpai=function(t,i,n){var a=this;if(app.Log.log("ViewPlayer_Other Huangpai  tingpai:"+t+" fast:"+n),e.DesktopMgr.Inst.mode==e.EMJMode.play)if(n)if(t){this.SetNum(i.length);for(r=0;r<i.length;r++)this.hand[r].SetVal(i[r]),this.hand[r].FullDown()}else for(var r=0;r<this.hand.length;r++)this.hand[r].Cover();else Laya.timer.once(300,this,function(){if(e.AudioMgr.PlayAudio(223),t){a.SetNum(i.length);for(n=0;n<i.length;n++)a.hand[n].SetVal(i[n]),a.hand[n].DoAnim_FullDown()}else for(var n=0;n<a.hand.length;n++)a.hand[n].DoAnim_Cover()});else e.DesktopMgr.Inst.record_show_hand||Laya.timer.once(300,this,function(){if(e.AudioMgr.PlayAudio(223),t)for(n=0;n<i.length;n++)a.hand[n].DoAnim_FullDown();else for(var n=0;n<a.hand.length;n++)a.hand[n].DoAnim_Cover()})},i.prototype.onShowHandChange=function(t){if(e.DesktopMgr.Inst.gameing)for(var i=0;i<this.hand.length;i++)t?(this.hand[i].FullDown(),this.hand[i].pai3D.ispaopai=e.DesktopMgr.Inst.isPaoPai(this.hand[i].pai3D.val)):(this.hand[i].Stand(),this.hand[i].pai3D.ispaopai=!1),this.hand[i].pai3D.OnChoosedPai()},i.prototype.onShowPaopaiChange=function(){if(e.DesktopMgr.Inst.gameing&&e.DesktopMgr.Inst.record_show_hand)for(var t=0;t<this.hand.length;t++)this.hand[t].pai3D.ispaopai=e.DesktopMgr.Inst.isPaoPai(this.hand[t].pai3D.val),this.hand[t].pai3D.OnChoosedPai()},i.prototype.OnChoosePai=function(){if(t.prototype.OnChoosePai.call(this),(e.DesktopMgr.Inst.mode==e.EMJMode.paipu||e.DesktopMgr.Inst.mode==e.EMJMode.live_broadcast)&&e.DesktopMgr.Inst.record_show_hand)for(var i=0;i<this.hand.length;i++)this.hand[i].pai3D.OnChoosedPai()},i}(e.ViewPlayer);e.ViewPlayer_Other=t}(view||(view={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),caps;!function(e){var t=function(e){function t(t){var i=e.call(this)||this;return""!=t&&i.setShaderName(t),i}return __extends(t,e),t.prototype.setInt=function(e,t){this._setInt(e,t)},t.prototype.getInt=function(e){return this._getInt(e)},t.prototype.setNumber=function(e,t){this._setNumber(e,t)},t.prototype.getNumber=function(e){return this._getNumber(e)},t.prototype.setBool=function(e,t){this._setBool(e,t)},t.prototype.getBool=function(e){return this._getBool(e)},t.prototype.setVector2=function(e,t){this._setVector2(e,t)},t.prototype.getVector2=function(e){return this._getVector2(e)},t.prototype.setColor=function(e,t){this._setColor(e,t)},t.prototype.getColor=function(e){return this._getColor(e)},t.prototype.setTexture=function(e,t){this._setTexture(e,t)},t.prototype.getTexture=function(e){return this._getTexture(e)},t}(Laya.BaseMaterial);e.BaseMaterial=t}(caps||(caps={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),caps;!function(e){var t=function(e){function t(t){var i=e.call(this,t)||this;return i.cull=2,i.blend=1,i.srcBlend=770,i.dstBlend=771,i.alphaTest=!0,i.depthWrite=!0,i.renderQueue=2,i}return __extends(t,e),t}(e.BaseMaterial);e.Material_Clip=t}(caps||(caps={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),caps;!function(e){var t=function(t){function i(i){var n=t.call(this,i)||this;return n.cull=e.BaseMaterial.CULL_FRONT,n.blend=1,n.srcBlend=770,n.dstBlend=771,n.alphaTest=!0,n.depthWrite=!0,n.renderQueue=2,n}return __extends(i,t),i}(e.BaseMaterial);e.Material_Outline=t}(caps||(caps={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),View=laya.ui.View,Dialog=laya.ui.Dialog,EffectAnimation=laya.display.EffectAnimation,ui;!function(e){!function(t){var i=function(t){function i(){var i=t.call(this)||this;return i.effectData=e.anim.alpha_inUI.uiView,i}return __extends(i,t),i.uiView={type:"View",props:{},child:[{type:"Image",props:{y:-4,x:4,skin:"myres/0p.png",anchorY:.5,anchorX:.5},compId:2}],animations:[{nodes:[{target:2,keyframes:{y:[{value:-1,tweenMethod:"linearNone",tween:!0,target:2,key:"y",index:0},{value:167,tweenMethod:"linearNone",tween:!0,target:2,key:"y",index:14},{value:0,tweenMethod:"backIn",tween:!0,target:2,key:"y",index:20}],x:[{value:-1,tweenMethod:"backIn",tween:!0,target:2,key:"x",index:0},{value:-360,tweenMethod:"linearNone",tween:!0,target:2,key:"x",index:14},{value:0,tweenMethod:"backIn",tween:!0,target:2,key:"x",index:20}],scaleY:[{value:1,tweenMethod:"linearNone",tween:!0,target:2,key:"scaleY",index:0},{value:.58,tweenMethod:"linearNone",tween:!0,target:2,key:"scaleY",index:7},{value:2,tweenMethod:"linearNone",tween:!0,target:2,key:"scaleY",index:20}],scaleX:[{value:1,tweenMethod:"linearNone",tween:!0,target:2,key:"scaleX",index:0},{value:.5,tweenMethod:"linearNone",tween:!0,target:2,key:"scaleX",index:7},{value:2,tweenMethod:"linearNone",tween:!0,target:2,key:"scaleX",index:20},{value:1,tweenMethod:"linearNone",tween:!0,target:2,key:"scaleX",index:31}],rotation:[{value:0,tweenMethod:"linearNone",tween:!0,target:2,key:"rotation",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:2,key:"rotation",index:14}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:2,key:"alpha",index:0},{value:1,tweenMethod:"backIn",tween:!0,target:2,key:"alpha",index:20}]}}],name:"in",id:1,frameRate:60,action:0},{nodes:[{target:2,keyframes:{y:[{value:0,tweenMethod:"linearNone",tween:!0,target:2,key:"y",index:0}],x:[{value:0,tweenMethod:"backIn",tween:!0,target:2,key:"x",index:0},{value:100,tweenMethod:"linearNone",tween:!0,target:2,key:"x",index:10}]}}],name:"out",id:2,frameRate:24,action:0}]},i}(EffectAnimation);t.alpha_inUI=i}(e.anim||(e.anim={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.createView(e.anim.animtestUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Sprite",props:{y:332,x:370,width:200,name:"anim1",height:200},child:[{type:"Image",props:{y:79,x:136,skin:"myres/0m.png",name:"a0"},compId:3,child:[{type:"Image",props:{y:10,x:110,skin:"myres/0p.png",name:"a1"},compId:5}]},{type:"Image",props:{y:2,x:-39,skin:"myres/1m.png",name:"a2"},compId:6}]}],animations:[{nodes:[{target:3,keyframes:{x:[{value:136,tweenMethod:"linearNone",tween:!0,target:3,key:"x",index:0}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:3,key:"alpha",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:3,key:"alpha",index:13}]}},{target:5,keyframes:{y:[{value:10,tweenMethod:"linearNone",tween:!0,target:5,key:"y",index:0},{value:256,tweenMethod:"linearNone",tween:!0,target:5,key:"y",index:22}],x:[{value:110,tweenMethod:"linearNone",tween:!0,target:5,key:"x",index:0},{value:12,tweenMethod:"linearNone",tween:!0,target:5,key:"x",index:22}]}},{target:6,keyframes:{y:[{value:2,tweenMethod:"linearNone",tween:!0,target:6,key:"y",index:0},{value:-87,tweenMethod:"linearNone",tween:!0,target:6,key:"y",index:17}],x:[{value:-39,tweenMethod:"backIn",tween:!0,target:6,key:"x",index:0},{value:319,tweenMethod:"linearNone",tween:!0,target:6,key:"x",index:17}],rotation:[{value:0,tweenMethod:"linearNone",tween:!0,target:6,key:"rotation",index:0},{value:-61,tweenMethod:"linearNone",tween:!0,target:6,key:"rotation",index:22}]}}],name:"ani1",id:1,frameRate:30,action:0},{nodes:[{target:3,keyframes:{y:[{value:79,tweenMethod:"linearNone",tween:!0,target:3,key:"y",index:0},{value:174,tweenMethod:"linearNone",tween:!0,target:3,key:"y",index:22}],x:[{value:136,tweenMethod:"linearNone",tween:!0,target:3,key:"x",index:0},{value:-53,tweenMethod:"linearNone",tween:!0,target:3,key:"x",index:22}]}},{target:5,keyframes:{y:[{value:10,tweenMethod:"linearNone",tween:!0,target:5,key:"y",index:0},{value:205,tweenMethod:"linearNone",tween:!0,target:5,key:"y",index:22}],x:[{value:110,tweenMethod:"linearNone",tween:!0,target:5,key:"x",index:0},{value:266,tweenMethod:"linearNone",tween:!0,target:5,key:"x",index:22}]}},{target:6,keyframes:{scaleY:[{value:1,tweenMethod:"linearNone",tween:!0,target:6,key:"scaleY",index:0},{value:2,tweenMethod:"linearNone",tween:!0,target:6,key:"scaleY",index:22}],scaleX:[{value:1,tweenMethod:"linearNone",tween:!0,target:6,key:"scaleX",index:0},{value:3,tweenMethod:"linearNone",tween:!0,target:6,key:"scaleX",index:22}]}}],name:"ani2",id:2,frameRate:60,action:0}]},i}(View);t.animtestUI=i}(e.anim||(e.anim={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.CButton",capsui.CButton),t.prototype.createChildren.call(this),this.createView(e.both_ui.character_star_upUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Button",props:{y:0,x:0,width:1920,name:"bigclose",label:"label",height:1080}},{type:"Sprite",props:{visible:!0,name:"root",alpha:1},child:[{type:"Image",props:{y:0,x:0,width:1920,visible:!0,skin:"myres/star_up/bg.jpg",name:"bg",height:1080},compId:2},{type:"Sprite",props:{y:0,x:0,width:100,visible:!0,name:"container_avatar",height:100,alpha:1},compId:11,child:[{type:"Image",props:{y:34,x:460,width:971,skin:"extendRes/charactor/yiji/full.png",name:"avatar0",height:1461}},{type:"Image",props:{y:34,x:460,width:971,skin:"extendRes/charactor/yiji/full.png",name:"avatar1",height:1461}}]},{type:"Sprite",props:{y:939,x:643,width:628,pivotY:59,pivotX:317,name:"container_hearts",height:109,alpha:0},compId:51,child:[{type:"Image",props:{y:-62,x:83,width:472,visible:!0,skin:"myres/star_up/levelup.png",name:"img_word",height:62,alpha:1}},{type:"Image",props:{y:59,x:87,width:77,skin:"myres/bothui/bf_heart_bg.png",scaleY:1.4,scaleX:1.4,name:"heart0",height:67,anchorY:.5,anchorX:.5},child:[{type:"Sprite",props:{name:"v"},child:[{type:"Image",props:{y:0,x:0,width:77,skin:"myres/bothui/bf_heart.png",name:"full",height:67}},{type:"Image",props:{y:67,width:77,skin:"myres/bbg.png",scaleY:.5,renderType:"mask",height:67,anchorY:1,sizeGrid:"1,1,1,1"}}]}]},{type:"Image",props:{y:59,x:202,width:77,skin:"myres/bothui/bf_heart_bg.png",scaleY:1.4,scaleX:1.4,name:"heart1",height:67,anchorY:.5,anchorX:.5},child:[{type:"Sprite",props:{name:"v"},child:[{type:"Image",props:{y:0,x:0,width:77,skin:"myres/bothui/bf_heart.png",name:"full",height:67}},{type:"Image",props:{y:67,width:77,skin:"myres/bbg.png",scaleY:.5,renderType:"mask",height:67,anchorY:1,sizeGrid:"1,1,1,1"}}]}]},{type:"Image",props:{y:59,x:317,width:77,skin:"myres/bothui/bf_heart_bg.png",scaleY:1.4,scaleX:1.4,name:"heart2",height:67,anchorY:.5,anchorX:.5},child:[{type:"Sprite",props:{name:"v"},child:[{type:"Image",props:{y:0,x:0,width:77,skin:"myres/bothui/bf_heart.png",name:"full",height:67}},{type:"Image",props:{y:67,width:77,skin:"myres/bbg.png",scaleY:.5,renderType:"mask",height:67,anchorY:1,sizeGrid:"1,1,1,1"}}]}]},{type:"Image",props:{y:59,x:432,width:77,skin:"myres/bothui/bf_heart_bg.png",scaleY:1.4,scaleX:1.4,name:"heart3",height:67,anchorY:.5,anchorX:.5},child:[{type:"Sprite",props:{name:"v"},child:[{type:"Image",props:{y:0,x:0,width:77,skin:"myres/bothui/bf_heart.png",name:"full",height:67}},{type:"Image",props:{y:67,width:77,skin:"myres/bbg.png",scaleY:.5,renderType:"mask",height:67,anchorY:1,sizeGrid:"1,1,1,1"}}]}]},{type:"Image",props:{y:59,x:547,width:77,skin:"myres/bothui/bf_heart_bg.png",scaleY:1.4,scaleX:1.4,name:"heart4",height:67,anchorY:.5,anchorX:.5},child:[{type:"Sprite",props:{name:"v"},child:[{type:"Image",props:{y:0,x:0,width:77,skin:"myres/bothui/bf_heart.png",name:"full",height:67}},{type:"Image",props:{y:67,width:77,skin:"myres/bbg.png",scaleY:.5,renderType:"mask",height:67,anchorY:1,sizeGrid:"1,1,1,1"}}]}]},{type:"Sprite",props:{y:55,x:315,width:628,scaleY:1,scaleX:1,pivotY:55,pivotX:315,name:"bang",height:109,alpha:1},compId:53,child:[{type:"Image",props:{y:59,x:88,width:183,skin:"myres/star_up/bang_heart.png",name:"b0",height:167,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:59,x:203,width:183,skin:"myres/star_up/bang_heart.png",name:"b0",height:167,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:59,x:318,width:183,skin:"myres/star_up/bang_heart.png",name:"b0",height:167,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:59,x:433,width:183,skin:"myres/star_up/bang_heart.png",name:"b0",height:167,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:59,x:548,width:183,skin:"myres/star_up/bang_heart.png",name:"b0",height:167,anchorY:.5,anchorX:.5}}]}]},{type:"Button",props:{y:80,x:1758,width:268,pivotY:67,pivotX:143,name:"btn_close",labelSize:50,labelFont:"SimHei",height:132,alpha:0},compId:46,child:[{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Image",props:{y:19,x:45,width:185,skin:"myres/bothui/jump.png",height:87}}]}]},{type:"Sprite",props:{y:0,x:0,name:"container_effect"}},{type:"Sprite",props:{y:784,x:617,width:674,name:"chat",height:226},child:[{type:"Image",props:{y:15,x:25,width:633,skin:"myres/bothui/bf_chat.png",name:"bg",height:190,sizeGrid:"14,14,13,14"}},{type:"Label",props:{y:42,x:55,wordWrap:!0,width:578,text:"喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵",name:"info",leading:8,height:138,fontSize:29,font:"SimHei",color:"#cecece"}}]},{type:"Image",props:{y:0,x:0,width:1920,skin:"myres/wbg.png",name:"blackbg",height:1080,alpha:0,sizeGrid:"1,1,1,1"},compId:48}],animations:[{nodes:[{target:53,keyframes:{scaleY:[{value:1,tweenMethod:"linearNone",tween:!0,target:53,key:"scaleY",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:53,label:null,key:"scaleY",index:7},{value:1,tweenMethod:"backOut",tween:!0,target:53,label:null,key:"scaleY",index:8},{value:1.6,tweenMethod:"strongIn",tween:!0,target:53,label:null,key:"scaleY",index:13},{value:2,tweenMethod:"strongIn",tween:!0,target:53,label:null,key:"scaleY",index:19}],scaleX:[{value:1,tweenMethod:"linearNone",tween:!0,target:53,key:"scaleX",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:53,label:null,key:"scaleX",index:7},{value:1,tweenMethod:"backOut",tween:!0,target:53,label:null,key:"scaleX",index:8},{value:1.6,tweenMethod:"strongIn",tween:!0,target:53,label:null,key:"scaleX",index:13},{value:2,tweenMethod:"strongIn",tween:!0,target:53,label:null,key:"scaleX",index:19}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:53,label:null,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:53,label:null,key:"alpha",index:7},{value:1,tweenMethod:"linearNone",tween:!0,target:53,label:null,key:"alpha",index:8},{value:.9,tweenMethod:"linearNone",tween:!0,target:53,label:null,key:"alpha",index:13},{value:0,tweenMethod:"linearNone",tween:!0,target:53,label:null,key:"alpha",index:19}]}},{target:51,keyframes:{x:[{value:959,tweenMethod:"linearNone",tween:!0,target:51,key:"x",index:0},{value:959,tweenMethod:"linearNone",tween:!0,target:51,label:null,key:"x",index:3},{value:959,tweenMethod:"linearNone",tween:!0,target:51,label:null,key:"x",index:4},{value:959,tweenMethod:"linearNone",tween:!0,target:51,label:null,key:"x",index:8}],scaleY:[{value:1,tweenMethod:"strongOut",tween:!0,target:51,key:"scaleY",index:0},{value:1.4,tweenMethod:"strongIn",tween:!0,target:51,key:"scaleY",index:3},{value:1.4,tweenMethod:"strongIn",tween:!0,target:51,label:null,key:"scaleY",index:4},{value:1,tweenMethod:"linearNone",tween:!0,target:51,key:"scaleY",index:8}],scaleX:[{value:1,tweenMethod:"strongOut",tween:!0,target:51,key:"scaleX",index:0},{value:1.4,tweenMethod:"strongIn",tween:!0,target:51,key:"scaleX",index:3},{value:1.4,tweenMethod:"strongIn",tween:!0,target:51,label:null,key:"scaleX",index:4},{value:1,tweenMethod:"linearNone",tween:!0,target:51,key:"scaleX",index:8}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:51,key:"alpha",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:51,key:"alpha",index:3},{value:1,tweenMethod:"linearNone",tween:!0,target:51,label:null,key:"alpha",index:4}]}}],name:"bang",id:1,frameRate:15,action:0},{nodes:[{target:2,keyframes:{x:[{value:0,tweenMethod:"linearNone",tween:!0,target:2,key:"x",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:2,label:null,key:"x",index:6},{value:0,tweenMethod:"linearNone",tween:!0,target:2,label:null,key:"x",index:7}],visible:[{value:!1,tweenMethod:"linearNone",tween:!1,target:2,key:"visible",index:0},{value:!0,tweenMethod:"linearNone",tween:!1,target:2,key:"visible",index:7}]}},{target:11,keyframes:{x:[{value:0,tweenMethod:"linearNone",tween:!0,target:11,key:"x",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:11,label:null,key:"x",index:6},{value:0,tweenMethod:"linearNone",tween:!0,target:11,label:null,key:"x",index:7}],visible:[{value:!1,tweenMethod:"linearNone",tween:!1,target:11,key:"visible",index:0},{value:!0,tweenMethod:"linearNone",tween:!1,target:11,key:"visible",index:7}]}},{target:48,keyframes:{x:[{value:0,tweenMethod:"linearNone",tween:!0,target:48,key:"x",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:48,label:null,key:"x",index:5},{value:0,tweenMethod:"linearNone",tween:!0,target:48,label:null,key:"x",index:11},{value:0,tweenMethod:"linearNone",tween:!0,target:48,label:null,key:"x",index:16}],alpha:[{value:0,tweenMethod:"strongIn",tween:!0,target:48,key:"alpha",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:48,label:null,key:"alpha",index:5},{value:1,tweenMethod:"linearNone",tween:!0,target:48,label:null,key:"alpha",index:11},{value:0,tweenMethod:"linearNone",tween:!0,target:48,label:null,key:"alpha",index:16}]}},{target:46,keyframes:{x:[{value:1758,tweenMethod:"linearNone",tween:!0,target:46,key:"x",index:0},{value:1758,tweenMethod:"linearNone",tween:!0,target:46,label:null,key:"x",index:6},{value:1758,tweenMethod:"linearNone",tween:!0,target:46,label:null,key:"x",index:7},{value:1758,tweenMethod:"linearNone",tween:!0,target:46,key:"x",index:16}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:46,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:46,key:"alpha",index:6},{value:1,tweenMethod:"linearNone",tween:!0,target:46,key:"alpha",index:7},{value:1,tweenMethod:"linearNone",tween:!0,target:46,key:"alpha",index:16}]}},{target:51,keyframes:{x:[{value:643,tweenMethod:"linearNone",tween:!0,target:51,key:"x",index:0},{value:643,tweenMethod:"linearNone",tween:!0,target:51,key:"x",index:16}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:51,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:51,key:"alpha",index:16}]}}],name:"in",id:2,frameRate:15,action:0}]},i}(View);t.character_star_upUI=i}(e.both_ui||(e.both_ui={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.CButton",capsui.CButton),View.regComponent("Script",laya.display.Sprite),t.prototype.createChildren.call(this),this.createView(e.both_ui.configUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Sprite",props:{y:570,x:967,width:899,pivotY:377,pivotX:477,name:"root",height:739},child:[{type:"Image",props:{y:331,x:455,width:860,skin:"myres/pop_bg.png",name:"bg0",height:900,anchorY:.5,anchorX:.5,sizeGrid:"100,100,100,100"},child:[{type:"Image",props:{y:28,x:35,width:135,skin:"myres/pop_texturecut.png",name:"left",height:844,sizeGrid:"0,0,24,26"}},{type:"Image",props:{y:29,x:829,width:135,skin:"myres/pop_texturecut.png",scaleX:-1,name:"right",height:843,sizeGrid:"0,0,24,26"}},{type:"Image",props:{y:50,x:31,width:800,skin:"myres/pop_black.png",name:"bar",height:76}},{type:"Image",props:{y:138,x:32,width:800,skin:"myres/pop_black.png",name:"bar",height:713}}]},{type:"Image",props:{y:331,x:455,width:860,skin:"myres/pop_bound.png",name:"bound",height:900,anchorY:.5,anchorX:.5,sizeGrid:"131,102,97,106"}},{type:"Label",props:{y:-65,x:379,width:165,valign:"middle",text:"设置",name:"title",height:76,fontSize:41,font:"fengyu",color:"#e8af71",align:"center"}},{type:"Button",props:{y:-90,x:854,width:123,name:"btn_close",height:123,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Image",props:{y:22,x:22,width:80,skin:"myres/btn_close.png",height:80}}]},{type:"Panel",props:{y:34,x:98,width:727,vScrollBarSkin:"myres/vscroll.png",name:"panel",height:614},child:[{type:"Sprite",props:{y:-3,x:7,width:701,name:"audio",height:282},child:[{type:"Sprite",props:{y:55,x:-5,width:726,name:"music",height:67},child:[{type:"Label",props:{y:14,x:43,width:79,text:"音乐",height:49,fontSize:38,font:"SimHei",color:"#f4f3f3"}},{type:"Sprite",props:{y:12,x:530,width:144,name:"checkbox",height:47},child:[{type:"Button",props:{y:-3,x:0,width:144,name:"btn",height:50}},{type:"Image",props:{y:1,x:11,width:44,skin:"myres/bothui/checkbox.png",name:"check",height:43}},{type:"Image",props:{y:1,x:11,width:44,skin:"myres/bothui/check.png",name:"checkbox",height:43}},{type:"Label",props:{y:1,x:59,text:"静音",fontSize:38,font:"SimHei",color:"#f1eeee"}}]},{type:"Sprite",props:{y:4,x:165,width:350,name:"slider",height:60},child:[{type:"Image",props:{y:25,x:0,width:350,skin:"myres/bothui/volumebg.png",name:"bg",height:11}},{type:"Image",props:{y:25,x:0,width:200,skin:"myres/bothui/volumebar.png",name:"val",height:11}},{type:"Image",props:{y:29,x:200,width:26,skin:"myres/bothui/volumebtn.png",name:"point",height:47,anchorY:.5,anchorX:.5}}]}]},{type:"Sprite",props:{y:126,x:-5,width:726,name:"audio",height:67},child:[{type:"Label",props:{y:14,x:43,width:79,text:"音效",height:49,fontSize:38,font:"SimHei",color:"#f4f3f3"}},{type:"Sprite",props:{y:12,x:530,width:144,name:"checkbox",height:47},child:[{type:"Button",props:{y:-3,x:0,width:144,name:"btn",height:50}},{type:"Image",props:{y:1,x:11,width:44,skin:"myres/bothui/checkbox.png",name:"check",height:43}},{type:"Image",props:{y:1,x:11,width:44,skin:"myres/bothui/check.png",name:"checkbox",height:43}},{type:"Label",props:{y:1,x:59,text:"静音",fontSize:38,font:"SimHei",color:"#f1eeee"}}]},{type:"Sprite",props:{y:4,x:165,width:350,name:"slider",height:60},child:[{type:"Image",props:{y:25,x:0,width:350,skin:"myres/bothui/volumebg.png",name:"bg",height:11}},{type:"Image",props:{y:25,x:0,width:200,skin:"myres/bothui/volumebar.png",name:"val",height:11}},{type:"Image",props:{y:29,x:200,width:26,skin:"myres/bothui/volumebtn.png",name:"point",height:47,anchorY:.5,anchorX:.5}}]}]},{type:"Sprite",props:{y:197,x:-5,width:726,name:"sound",height:67},child:[{type:"Label",props:{y:14,x:43,width:79,text:"语音",height:49,fontSize:38,font:"SimHei",color:"#f4f3f3"}},{type:"Sprite",props:{y:12,x:530,width:144,name:"checkbox",height:47},child:[{type:"Button",props:{y:-3,x:0,width:144,name:"btn",height:50}},{type:"Image",props:{y:1,x:11,width:44,skin:"myres/bothui/checkbox.png",name:"check",height:43}},{type:"Image",props:{y:1,x:11,width:44,skin:"myres/bothui/check.png",name:"checkbox",height:43}},{type:"Label",props:{y:1,x:59,text:"静音",fontSize:38,font:"SimHei",color:"#f1eeee"}}]},{type:"Sprite",props:{y:4,x:165,width:350,name:"slider",height:60},child:[{type:"Image",props:{y:25,x:0,width:350,skin:"myres/bothui/volumebg.png",name:"bg",height:11}},{type:"Image",props:{y:25,x:0,width:200,skin:"myres/bothui/volumebar.png",name:"val",height:11}},{type:"Image",props:{y:29,x:200,width:26,skin:"myres/bothui/volumebtn.png",name:"point",height:47,anchorY:.5,anchorX:.5}}]}]},{type:"Label",props:{y:7,x:7,width:95,text:"声音",name:"tag",height:59,fontSize:40,font:"SimHei",color:"#e8af71"}}]},{type:"Sprite",props:{y:278,x:7,width:701,name:"prefer",height:210},child:[{type:"Label",props:{y:7,x:7,width:95,text:"偏好",name:"tag",height:59,fontSize:40,font:"SimHei",color:"#e8af71"}},{type:"Sprite",props:{y:58,x:-5,width:258,name:"click1",height:67},child:[{type:"Sprite",props:{y:12,x:45,width:144,name:"checkbox",height:47},child:[{type:"Button",props:{y:-3,x:0,width:283,name:"btn",height:50}},{type:"Image",props:{y:1,x:11,width:44,skin:"myres/bothui/checkbox.png",name:"check",height:43}},{type:"Image",props:{y:1,x:11,width:44,skin:"myres/bothui/check.png",name:"checkbox",height:43}},{type:"Label",props:{y:3,x:65,width:127,text:"单击出牌",height:38,fontSize:35,font:"SimHei",color:"#f1eeee"}}]}]},{type:"Sprite",props:{y:58,x:311,width:258,name:"click2",height:67},child:[{type:"Sprite",props:{y:12,x:45,width:144,name:"checkbox",height:47},child:[{type:"Button",props:{y:-3,x:0,width:310,name:"btn",height:50}},{type:"Image",props:{y:1,x:11,width:44,skin:"myres/bothui/checkbox.png",name:"check",height:43}},{type:"Image",props:{y:1,x:11,width:44,skin:"myres/bothui/check.png",name:"checkbox",height:43}},{type:"Label",props:{y:3,x:65,width:127,text:"双击出牌",height:38,fontSize:35,font:"SimHei",color:"#f1eeee"}}]}]},{type:"Sprite",props:{y:127,x:-5,width:258,name:"click3",height:67},child:[{type:"Sprite",props:{y:12,x:45,width:144,name:"checkbox",height:47},child:[{type:"Button",props:{y:-3,x:0,width:283,name:"btn",height:50}},{type:"Image",props:{y:1,x:11,width:44,skin:"myres/bothui/checkbox.png",name:"check",height:43}},{type:"Image",props:{y:1,x:11,width:44,skin:"myres/bothui/check.png",name:"checkbox",height:43}},{type:"Label",props:{y:3,x:65,width:127,text:"双击过牌&摸切",height:38,fontSize:35,font:"SimHei",color:"#f1eeee"}}]}]}]},{type:"Sprite",props:{y:485,x:7,width:701,name:"comment",height:210},child:[{type:"Label",props:{y:7,x:7,width:99,text:"留言",name:"tag",height:59,fontSize:40,font:"SimHei",color:"#e8af71"}},{type:"Sprite",props:{y:58,x:-5,width:258,name:"click1",height:67},child:[{type:"Sprite",props:{y:12,x:45,width:144,name:"checkbox",height:47},child:[{type:"Button",props:{y:-3,x:0,width:283,name:"btn",height:50}},{type:"Image",props:{y:1,x:11,width:44,skin:"myres/bothui/checkbox.png",name:"check",height:43}},{type:"Image",props:{y:1,x:11,width:44,skin:"myres/bothui/check.png",name:"checkbox",height:43}},{type:"Label",props:{y:3,x:65,width:189,text:"允许所有人",height:38,fontSize:35,font:"SimHei",color:"#f1eeee"}}]}]},{type:"Sprite",props:{y:58,x:311,width:258,name:"click2",height:67},child:[{type:"Sprite",props:{y:12,x:45,width:144,name:"checkbox",height:47},child:[{type:"Button",props:{y:-3,x:0,width:310,name:"btn",height:50}},{type:"Image",props:{y:1,x:11,width:44,skin:"myres/bothui/checkbox.png",name:"check",height:43}},{type:"Image",props:{y:1,x:11,width:44,skin:"myres/bothui/check.png",name:"checkbox",height:43}},{type:"Label",props:{y:3,x:65,width:127,text:"仅好友",height:38,fontSize:35,font:"SimHei",color:"#f1eeee"}}]}]},{type:"Sprite",props:{y:127,x:-5,width:258,name:"click3",height:67},child:[{type:"Sprite",props:{y:12,x:45,width:144,name:"checkbox",height:47},child:[{type:"Button",props:{y:-3,x:0,width:283,name:"btn",height:50}},{type:"Image",props:{y:1,x:11,width:44,skin:"myres/bothui/checkbox.png",name:"check",height:43}},{type:"Image",props:{y:1,x:11,width:44,skin:"myres/bothui/check.png",name:"checkbox",height:43}},{type:"Label",props:{y:3,x:65,width:221,text:"禁止所有留言",height:38,fontSize:35,font:"SimHei",color:"#f1eeee"}}]}]}]},{type:"Sprite",props:{y:695,x:7,width:701,name:"other",height:210},child:[{type:"Label",props:{y:15,x:7,width:95,text:"其他",name:"tag",height:59,fontSize:40,font:"SimHei",color:"#e8af71"}},{type:"Sprite",props:{y:69,x:-5,width:258,name:"fps",height:67},child:[{type:"Sprite",props:{y:12,x:45,width:144,name:"checkbox",height:47},child:[{type:"Button",props:{y:-3,x:0,width:442,name:"btn",height:50}},{type:"Image",props:{y:1,x:11,width:44,skin:"myres/bothui/checkbox.png",name:"check",height:43}},{type:"Image",props:{y:1,x:11,width:44,skin:"myres/bothui/check.png",name:"checkbox",height:43}},{type:"Label",props:{y:3,x:65,width:127,text:"高帧率(重启游戏生效)",height:38,fontSize:35,font:"SimHei",color:"#f1eeee"}}]}]}]},{type:"Button",props:{y:794,x:602,width:158,stateNum:1,skin:"myres/btn_small.png",scaleY:1.2,scaleX:1.2,name:"btn_restart",height:61,anchorY:.5,anchorX:.5,sizeGrid:"30,30,30,30"},child:[{type:"Script",props:{}},{type:"Label",props:{y:0,x:0,width:153,valign:"middle",text:"立即重启",height:64,fontSize:26,font:"SimHei",color:"#f63c39",align:"center"}}]},{type:"Sprite",props:{y:860,x:5,width:693,name:"renzheng",height:83},child:[{type:"Label",props:{y:1,x:109,width:305,valign:"middle",text:"实名认证：尚未认证",name:"info",height:64,fontSize:35,font:"SimHei",color:"#ff5757",align:"left"}},{type:"Image",props:{y:18,x:64,skin:"myres/bothui/renzheng.png",name:"icon"}},{type:"Button",props:{y:33,x:602,width:158,stateNum:1,skin:"myres/btn_small.png",scaleY:1.2,scaleX:1.2,name:"btn",height:61,anchorY:.5,anchorX:.5,sizeGrid:"30,30,30,30"},child:[{type:"Label",props:{y:0,x:0,width:153,valign:"middle",text:"认证",height:64,fontSize:26,font:"SimHei",color:"#d9b175",align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]},{type:"Button",props:{y:982,x:146,width:182,stateNum:1,skin:"myres/btn_small.png",scaleY:1.2,scaleX:1.2,name:"btn_gift",height:63,anchorY:.5,anchorX:.5,sizeGrid:"30,30,30,30"},child:[{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Label",props:{y:-3,x:0,width:177,valign:"middle",text:"礼品码",height:64,fontSize:30,font:"SimHei",color:"#ffffff",align:"center"}}]},{type:"Button",props:{y:982,x:377,width:182,stateNum:1,skin:"myres/btn_small.png",scaleY:1.2,scaleX:1.2,name:"btn_course",height:63,anchorY:.5,anchorX:.5,sizeGrid:"30,30,30,30"},child:[{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Label",props:{y:-3,x:0,width:177,valign:"middle",text:"新手教程",height:64,fontSize:30,font:"SimHei",color:"#ffffff",align:"center"}}]},{type:"Button",props:{y:982,x:612,width:182,stateNum:1,skin:"myres/btn_small.png",scaleY:1.2,scaleX:1.2,name:"btn_rule",height:63,anchorY:.5,anchorX:.5,sizeGrid:"30,30,30,30"},child:[{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Label",props:{y:-3,x:0,width:177,valign:"middle",text:"查看役种",height:64,fontSize:30,font:"SimHei",color:"#ffffff",align:"center"}}]}]},{type:"Label",props:{y:693,x:133,width:282,text:"当前版本：0.1.11",name:"version",height:34,fontSize:25,font:"SimHei",color:"#adacac",align:"left"}},{type:"Sprite",props:{y:35,x:806,width:50,name:"scrollbar",mouseThrough:!1,mouseEnabled:!0,height:608},child:[{type:"Image",props:{y:0,x:25,skin:"myres/scrollbar.png",name:"scrollbar",height:608,anchorX:.5}},{type:"Image",props:{y:96,x:25,width:45,skin:"myres/scrollpoint.png",name:"scrollpoint",height:45,anchorY:.5,anchorX:.5}}]},{type:"Button",props:{y:695,x:716,width:182,stateNum:1,skin:"myres/btn_small.png",scaleY:1.2,scaleX:1.2,name:"btn_logout",height:63,anchorY:.5,anchorX:.5,sizeGrid:"30,30,30,30"},child:[{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Label",props:{y:-3,x:0,width:177,valign:"middle",text:"登出",height:64,fontSize:30,font:"SimHei",color:"#f63c39",align:"center"}}]}]}]},i}(View);t.configUI=i}(e.both_ui||(e.both_ui={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.CButton",capsui.CButton),View.regComponent("capsui.CLoading",capsui.CLoading),t.prototype.createChildren.call(this),this.createView(e.both_ui.courseUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Sprite",props:{name:"root"},child:[{type:"Image",props:{y:0,x:0,width:1920,skin:"myres/bbg.png",name:"blackbg",height:1080,alpha:.8,sizeGrid:"1,1,1,1"}},{type:"Image",props:{y:61,x:201,width:1521,skin:"course/course3.png",name:"page",height:961}},{type:"Button",props:{y:494,x:1762,width:160,name:"right",height:360,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:110,x:55,width:72,skin:"myres/course_arrow.png",height:136}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:495,x:160,width:170,pivotY:182,pivotX:101,name:"left",height:360},child:[{type:"Image",props:{y:111,x:84,width:72,skin:"myres/course_arrow.png",scaleX:-1,height:136,anchorX:.5}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:65,x:1861,width:175,name:"btn_close",height:156,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:34,x:46,width:82,skin:"myres/course_close.png",height:93}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Sprite",props:{y:456,x:939,width:127,name:"loading",mouseThrough:!0,height:133},child:[{type:"Image",props:{y:67,x:26,skin:"myres/necessary/flower_nei.png",scaleY:1.2,scaleX:1.2,rotation:0,name:"flower",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:0,x:0,skin:"myres/necessary/flower_shine.png",name:"shine",alpha:1}},{type:"Image",props:{y:56,x:56,skin:"myres/necessary/round.png",name:"round",anchorY:.5,anchorX:.5}},{type:"Image",props:{y:142,x:0,skin:"myres/necessary/word.png"}}]},{type:"Script",props:{runtime:"capsui.CLoading"}}]}]}]},i}(View);t.courseUI=i}(e.both_ui||(e.both_ui={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.createView(e.both_ui.getcharacterUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Sprite",props:{y:188,x:607,width:719,height:779},child:[{type:"Image",props:{y:585,x:-18,width:793,height:247}},{type:"Image",props:{y:643,x:394,width:1563,scaleX:-1,name:"illust",height:1563,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:127,x:1266,width:113,scaleX:-1,name:"container_name",height:345},child:[{type:"Label",props:{y:13,x:18,wordWrap:!0,width:80,valign:"middle",text:"一之濑琴",name:"label_name",height:301,fontSize:60,font:"hanyi",color:"#efab4e",align:"center"}}]}]}]},{type:"Image",props:{y:733,x:492,width:1055,height:348}}]},i}(View);t.getcharacterUI=i}(e.both_ui||(e.both_ui={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.createView(e.both_ui.getrewardUI.uiView)},i.uiView={type:"View",props:{y:0,width:1920,height:1080},child:[{type:"Sprite",props:{y:506,x:-1,width:1925,pivotY:335,name:"root",height:679},compId:3,child:[{type:"Image",props:{y:358,x:1,width:1920,skin:"myres/bothui/bg_getreward.png",scaleY:1,name:"bg",height:401,anchorY:.5,alpha:1},compId:5,child:[{type:"Image",props:{y:281,x:135,width:1654,skin:"myres/bothui/slashline.png",name:"slashline",height:2}},{type:"Image",props:{y:-7,x:0,width:1920,skin:"myres/bothui/getreward_frame.png",name:"frame",height:8},child:[{type:"Image",props:{y:403,x:0,width:1920,skin:"myres/bothui/getreward_frame.png",height:8}}]}]},{type:"Sprite",props:{y:214,x:131,width:1639,name:"items",height:212,alpha:1},child:[{type:"Image",props:{y:72,x:788,width:144,name:"item",height:144,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:72,x:72,width:138,skin:"myres/kuangbg.png",height:138,anchorY:.5,anchorX:.5,sizeGrid:"7,7,8,7"}},{type:"Image",props:{y:72,x:72,width:138,name:"icon",height:138,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:0,x:0,width:144,skin:"myres/kuangbound.png",name:"bound",height:144,sizeGrid:"18,20,12,12"}},{type:"Label",props:{y:162,x:-4,width:155,text:"99999",name:"count",height:41,fontSize:52,font:"SimHei",color:"#fffbd6",bold:!1,align:"center"}},{type:"Label",props:{y:246,x:-27,wordWrap:!0,width:207,valign:"top",text:"救赎立直棒救赎立直棒",name:"name",height:64,fontSize:30,font:"SimHei",color:"#e8e5c3",align:"center"}}]},{type:"Image",props:{y:82,x:798,width:144,name:"item",height:144,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:72,x:72,width:138,skin:"myres/kuangbg.png",height:138,anchorY:.5,anchorX:.5,sizeGrid:"7,7,8,7"}},{type:"Image",props:{y:72,x:72,width:138,name:"icon",height:138,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:0,x:0,width:144,skin:"myres/kuangbound.png",name:"bound",height:144,sizeGrid:"18,20,12,12"}},{type:"Label",props:{y:162,x:-4,width:155,text:"99999",name:"count",height:41,fontSize:52,font:"SimHei",color:"#fffbd6",bold:!1,align:"center"}},{type:"Label",props:{y:246,x:-27,wordWrap:!0,width:207,valign:"top",text:"救赎立直棒救赎立直棒",name:"name",height:64,fontSize:30,font:"SimHei",color:"#e8e5c3",align:"center"}}]},{type:"Image",props:{y:92,x:808,width:144,name:"item",height:144,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:72,x:72,width:138,skin:"myres/kuangbg.png",height:138,anchorY:.5,anchorX:.5,sizeGrid:"7,7,8,7"}},{type:"Image",props:{y:72,x:72,width:138,name:"icon",height:138,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:0,x:0,width:144,skin:"myres/kuangbound.png",name:"bound",height:144,sizeGrid:"18,20,12,12"}},{type:"Label",props:{y:162,x:-4,width:155,text:"99999",name:"count",height:41,fontSize:52,font:"SimHei",color:"#fffbd6",bold:!1,align:"center"}},{type:"Label",props:{y:246,x:-27,wordWrap:!0,width:207,valign:"top",text:"救赎立直棒救赎立直棒",name:"name",height:64,fontSize:30,font:"SimHei",color:"#e8e5c3",align:"center"}}]},{type:"Image",props:{y:102,x:818,width:144,name:"item",height:144,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:72,x:72,width:138,skin:"myres/kuangbg.png",height:138,anchorY:.5,anchorX:.5,sizeGrid:"7,7,8,7"}},{type:"Image",props:{y:72,x:72,width:138,name:"icon",height:138,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:0,x:0,width:144,skin:"myres/kuangbound.png",name:"bound",height:144,sizeGrid:"18,20,12,12"}},{type:"Label",props:{y:162,x:-4,width:155,text:"99999",name:"count",height:41,fontSize:52,font:"SimHei",color:"#fffbd6",bold:!1,align:"center"}},{type:"Label",props:{y:246,x:-27,wordWrap:!0,width:207,valign:"top",text:"救赎立直棒救赎立直棒",name:"name",height:64,fontSize:30,font:"SimHei",color:"#e8e5c3",align:"center"}}]},{type:"Image",props:{y:112,x:828,width:144,name:"item",height:144,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:72,x:72,width:138,skin:"myres/kuangbg.png",height:138,anchorY:.5,anchorX:.5,sizeGrid:"7,7,8,7"}},{type:"Image",props:{y:72,x:72,width:138,name:"icon",height:138,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:0,x:0,width:144,skin:"myres/kuangbound.png",name:"bound",height:144,sizeGrid:"18,20,12,12"}},{type:"Label",props:{y:162,x:-4,width:155,text:"99999",name:"count",height:41,fontSize:52,font:"SimHei",color:"#fffbd6",bold:!1,align:"center"}},{type:"Label",props:{y:246,x:-27,wordWrap:!0,width:207,valign:"top",text:"救赎立直棒救赎立直棒",name:"name",height:64,fontSize:30,font:"SimHei",color:"#e8e5c3",align:"center"}}]},{type:"Image",props:{y:122,x:838,width:144,name:"item",height:144,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:72,x:72,width:138,skin:"myres/kuangbg.png",height:138,anchorY:.5,anchorX:.5,sizeGrid:"7,7,8,7"}},{type:"Image",props:{y:72,x:72,width:138,name:"icon",height:138,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:0,x:0,width:144,skin:"myres/kuangbound.png",name:"bound",height:144,sizeGrid:"18,20,12,12"}},{type:"Label",props:{y:162,x:-4,width:155,text:"99999",name:"count",height:41,fontSize:52,font:"SimHei",color:"#fffbd6",bold:!1,align:"center"}},{type:"Label",props:{y:246,x:-27,wordWrap:!0,width:207,valign:"top",text:"救赎立直棒救赎立直棒",name:"name",height:64,fontSize:30,font:"SimHei",color:"#e8e5c3",align:"center"}}]},{type:"Image",props:{y:132,x:848,width:144,name:"item",height:144,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:72,x:72,width:138,skin:"myres/kuangbg.png",height:138,anchorY:.5,anchorX:.5,sizeGrid:"7,7,8,7"}},{type:"Image",props:{y:72,x:72,width:138,name:"icon",height:138,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:0,x:0,width:144,skin:"myres/kuangbound.png",name:"bound",height:144,sizeGrid:"18,20,12,12"}},{type:"Label",props:{y:162,x:-4,width:155,text:"99999",name:"count",height:41,fontSize:52,font:"SimHei",color:"#fffbd6",bold:!1,align:"center"}},{type:"Label",props:{y:246,x:-27,wordWrap:!0,width:207,valign:"top",text:"救赎立直棒救赎立直棒",name:"name",height:64,fontSize:30,font:"SimHei",color:"#e8e5c3",align:"center"}}]},{type:"Image",props:{y:142,x:858,width:144,name:"item",height:144,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:72,x:72,width:138,skin:"myres/kuangbg.png",height:138,anchorY:.5,anchorX:.5,sizeGrid:"7,7,8,7"}},{type:"Image",props:{y:72,x:72,width:138,name:"icon",height:138,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:0,x:0,width:144,skin:"myres/kuangbound.png",name:"bound",height:144,sizeGrid:"18,20,12,12"}},{type:"Label",props:{y:162,x:-4,width:155,text:"99999",name:"count",height:41,fontSize:52,font:"SimHei",color:"#fffbd6",bold:!1,align:"center"}},{type:"Label",props:{y:246,x:-27,wordWrap:!0,width:207,valign:"top",text:"救赎立直棒救赎立直棒",name:"name",height:64,fontSize:30,font:"SimHei",color:"#e8e5c3",align:"center"}}]},{type:"Image",props:{y:152,x:868,width:144,name:"item",height:144,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:72,x:72,width:138,skin:"myres/kuangbg.png",height:138,anchorY:.5,anchorX:.5,sizeGrid:"7,7,8,7"}},{type:"Image",props:{y:72,x:72,width:138,name:"icon",height:138,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:0,x:0,width:144,skin:"myres/kuangbound.png",name:"bound",height:144,sizeGrid:"18,20,12,12"}},{type:"Label",props:{y:162,x:-4,width:155,text:"99999",name:"count",height:41,fontSize:52,font:"SimHei",color:"#fffbd6",bold:!1,align:"center"}},{type:"Label",props:{y:246,x:-27,wordWrap:!0,width:207,valign:"top",text:"救赎立直棒救赎立直棒",name:"name",height:64,fontSize:30,font:"SimHei",color:"#e8e5c3",align:"center"}}]},{type:"Image",props:{y:162,x:878,width:144,name:"item",height:144,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:72,x:72,width:138,skin:"myres/kuangbg.png",height:138,anchorY:.5,anchorX:.5,sizeGrid:"7,7,8,7"}},{type:"Image",props:{y:72,x:72,width:138,name:"icon",height:138,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:0,x:0,width:144,skin:"myres/kuangbound.png",name:"bound",height:144,sizeGrid:"18,20,12,12"}},{type:"Label",props:{y:162,x:-4,width:155,text:"99999",name:"count",height:41,fontSize:52,font:"SimHei",color:"#fffbd6",bold:!1,align:"center"}},{type:"Label",props:{y:246,x:-27,wordWrap:!0,width:207,valign:"top",text:"救赎立直棒救赎立直棒",name:"name",height:64,fontSize:30,font:"SimHei",color:"#e8e5c3",align:"center"}}]}]},{type:"Image",props:{y:74,x:984,width:876,skin:"myres/bothui/getreward.png",scaleY:1,scaleX:1,name:"title",height:160,anchorY:.5,anchorX:.5,alpha:1},compId:10},{type:"Label",props:{y:619,x:856,visible:!1,underline:!0,text:"点击关闭画面",name:"info",fontSize:36,font:"youyuan",color:"#f9f8ea",alpha:0}}]},{type:"Button",props:{width:1920,name:"btn_close",height:1080}}],animations:[{nodes:[{target:10,keyframes:{scaleY:[{value:.3,tweenMethod:"backOut",tween:!0,target:10,key:"scaleY",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:10,key:"scaleY",index:6}],scaleX:[{value:.3,tweenMethod:"backOut",tween:!0,target:10,key:"scaleX",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:10,key:"scaleX",index:6}],alpha:[{value:.4,tweenMethod:"linearNone",tween:!0,target:10,key:"alpha",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:10,key:"alpha",index:6}]}},{target:5,keyframes:{scaleY:[{value:0,tweenMethod:"linearNone",tween:!0,target:5,key:"scaleY",index:0},{value:0,tweenMethod:"backOut",tween:!0,target:5,key:"scaleY",index:5},{value:1,tweenMethod:"linearNone",tween:!0,target:5,key:"scaleY",index:10}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:5,key:"alpha",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:5,key:"alpha",index:5},{value:1,tweenMethod:"linearNone",tween:!0,target:5,key:"alpha",index:10}]}}],name:"in",id:1,frameRate:30,action:0},{nodes:[{target:3,keyframes:{scaleY:[{value:1,tweenMethod:"linearNone",tween:!0,target:3,key:"scaleY",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:3,key:"scaleY",index:4}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:3,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:3,key:"alpha",index:4}]}}],name:"out",id:2,frameRate:24,action:0}]},i}(View);t.getrewardUI=i}(e.both_ui||(e.both_ui={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.createView(e.both_ui.gettitleUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Sprite",props:{y:402,x:304,width:1254,name:"root",height:291},compId:3,child:[{type:"Image",props:{y:0,x:-104,width:1438,skin:"myres/title_get_bg.png",height:287}},{type:"Image",props:{y:49,x:660,width:265,skin:"myres/bothui/title_get.png",height:69,anchorY:.5,anchorX:.5},compId:5},{type:"Label",props:{y:224,x:538,width:228,text:"已放入称号簿",height:36,fontSize:36,font:"SimHei",color:"#7be296"},compId:6},{type:"Image",props:{y:150,x:641,width:594,skin:"extendRes/title/notitle.png",name:"icon",height:114,anchorY:.5,anchorX:.5},compId:8}]},{type:"Button",props:{width:1920,name:"btn_close",height:1080}}],animations:[{nodes:[{target:3,keyframes:{x:[{value:304,tweenMethod:"linearNone",tween:!0,target:3,key:"x",index:0}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:3,key:"alpha",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:3,key:"alpha",index:3}]}},{target:5,keyframes:{scaleY:[{value:1,tweenMethod:"linearNone",tween:!0,target:5,key:"scaleY",index:0},{value:2,tweenMethod:"strongIn",tween:!0,target:5,key:"scaleY",index:6},{value:1,tweenMethod:"linearNone",tween:!0,target:5,key:"scaleY",index:10}],scaleX:[{value:1,tweenMethod:"linearNone",tween:!0,target:5,key:"scaleX",index:0},{value:2,tweenMethod:"strongIn",tween:!0,target:5,key:"scaleX",index:6},{value:1,tweenMethod:"linearNone",tween:!0,target:5,key:"scaleX",index:10}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:5,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:5,key:"alpha",index:6},{value:1,tweenMethod:"linearNone",tween:!0,target:5,key:"alpha",index:10}]}},{target:8,keyframes:{scaleY:[{value:1,tweenMethod:"linearNone",tween:!0,target:8,key:"scaleY",index:0},{value:2,tweenMethod:"strongIn",tween:!0,target:8,key:"scaleY",index:14},{value:1,tweenMethod:"linearNone",tween:!0,target:8,key:"scaleY",index:18}],scaleX:[{value:1,tweenMethod:"linearNone",tween:!0,target:8,key:"scaleX",index:0},{value:2,tweenMethod:"strongIn",tween:!0,target:8,key:"scaleX",index:14},{value:1,tweenMethod:"linearNone",tween:!0,target:8,key:"scaleX",index:18}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:8,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:8,key:"alpha",index:14},{value:1,tweenMethod:"linearNone",tween:!0,target:8,key:"alpha",index:18}]}},{target:6,keyframes:{alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:6,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:6,key:"alpha",index:21},{value:1,tweenMethod:"linearNone",tween:!0,target:6,key:"alpha",index:26}]}}],name:"in",id:1,frameRate:30,action:0},{nodes:[{target:3,keyframes:{alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:3,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:3,key:"alpha",index:5}]}}],name:"out",id:2,frameRate:30,action:0}]},i}(View);t.gettitleUI=i}(e.both_ui||(e.both_ui={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.CButton",capsui.CButton),t.prototype.createChildren.call(this),this.createView(e.both_ui.gitfcodeUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Sprite",props:{y:531,x:948,width:568,pivotY:184,pivotX:288,name:"root",height:364},child:[{type:"Image",props:{y:0,x:0,width:569,skin:"myres/pop2_bg.png",name:"bg",height:361,sizeGrid:"2,2,2,2"}},{type:"Image",props:{y:0,x:0,width:569,skin:"myres/pop2_bound.png",name:"bound",height:361,sizeGrid:"24,27,11,21"}},{type:"Label",props:{y:12,x:223,width:117,text:"礼品码",name:"title",height:41,fontSize:38,font:"fengyu",color:"#e8af71"}},{type:"Label",props:{y:84,x:123,width:444,text:"输入礼品码即可领取奖励",scaleY:.8,scaleX:.8,height:44,fontSize:30,font:"youyuan",color:"#a1a6b5"}},{type:"Image",props:{y:154,x:152,width:271,skin:"myres/inputbox.png",height:63,sizeGrid:"7,12,10,9"}},{type:"Button",props:{y:284,x:285,width:145,stateNum:1,skin:"myres/bothui/btn_confirm.png",name:"btn_confirm",height:61,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:-3,width:147,valign:"middle",text:"确认",height:62,fontSize:40,font:"fengyu",color:"#e7b97a",align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"TextInput",props:{y:150,x:155,width:262,valign:"middle",restrict:"a-zA-Z0-9",promptColor:"#ffffff",name:"input",maxChars:12,height:75,fontSize:40,font:"SimHei",color:"#ffffff",align:"center"}},{type:"Button",props:{y:28,x:541,width:70,name:"btn_close",height:70,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:20,x:19,width:32,skin:"myres/pop2_close.png",name:"close",height:31}}]}]}]},i}(View);t.gitfcodeUI=i}(e.both_ui||(e.both_ui={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.CButton",capsui.CButton),t.prototype.createChildren.call(this),this.createView(e.both_ui.infoliteUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Sprite",props:{y:560,x:960,width:500,pivotY:250,pivotX:250,name:"root",height:500},child:[{type:"Image",props:{y:250,x:250,width:1200,skin:"myres/pop2_bg.png",name:"bg0",height:700,anchorY:.5,anchorX:.5,sizeGrid:"2,2,2,2"},child:[{type:"Image",props:{y:40,x:0,width:1200,skin:"myres/pop_black.png",name:"bar",height:542}}]},{type:"Image",props:{y:250,x:250,width:1200,skin:"myres/pop2_bound.png",name:"bound",height:700,anchorY:.5,anchorX:.5,sizeGrid:"24,27,11,21"}},{type:"Button",props:{y:534,x:250,width:158,stateNum:1,skin:"myres/bothui/btn_confirm.png",name:"btn_confirm",height:67,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:0,x:0,width:161,valign:"middle",text:"确认",height:62,fontSize:40,font:"fengyu",color:"#e7b97a",align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Panel",props:{y:-46,x:-294,width:1097,vScrollBarSkin:"myres/vscroll.png",name:"content",height:510},child:[{type:"Label",props:{y:10,x:12,wordWrap:!0,width:1078,text:"确定用99金币购买一之濑琴的琴吗？确定用99金币购买一之濑琴的琴吗？确定用99金币购买一之濑琴的琴吗？确定用99金币购买一之濑琴的琴吗？确定用99金币购买一之濑琴的琴吗？确定用99金币购买一之濑琴的琴吗？确定用99金币购买一之濑琴的琴吗？确定用99金币购买一之濑琴的琴吗？确定用99金币购买一之濑琴的琴吗？确定用99金币购买一之濑琴的琴吗？3确定用99金币购买一之濑琴的琴吗？确定用99金币购买一之濑琴的琴吗？确定用99金币购买一之濑琴的琴吗？确定用99金币购买一之濑琴的琴吗？确定用99金币购买一之濑琴的琴吗？确定用99金币购买一之濑琴的琴吗？确定用99金币购买一之濑琴的琴吗？确定用99金币购买一之濑琴的琴吗？确定用99金币购买一之濑琴的琴吗？确定用99金币购买一之濑琴的琴吗？3确定用99金币购买一之濑琴的琴吗？确定用99金币购买一之濑琴的琴吗？确定用99金币购买一之濑琴的琴吗？确定用99金币购买一之濑琴的琴吗？确定用99金币购买一之濑琴的琴吗？确定用99金币购买一之濑琴的琴吗？确定用99金币购买一之濑琴的琴吗？确定用99金币购买一之濑琴的琴吗？确定用99金币购买一之濑琴的琴吗？确定用99金币购买一之濑琴的琴吗？3确定用99金币购买一之濑琴的琴吗？确定用99金币购买一之濑琴的琴吗？确定用99金币购买一之濑琴的琴吗？确定用99金币购买一之濑琴的琴吗？确定用99金币购买一之濑琴的琴吗？确定用99金币购买一之濑琴的琴吗？确定用99金币购买一之濑琴的琴吗？确定用99金币购买一之濑琴的琴吗？确定用99金币购买一之濑琴的琴吗？确定用99金币购买一之濑琴的琴吗？3",name:"desc",height:0,fontSize:40,font:"SimHei",color:"#d6d1d1"}}]}]}]},i}(View);t.infoliteUI=i}(e.both_ui||(e.both_ui={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.CButton",capsui.CButton),View.regComponent("capsui.UICopy",capsui.UICopy),t.prototype.createChildren.call(this),this.createView(e.both_ui.inviteUI.uiView)},i.uiView={type:"View",props:{width:1920,mouseThrough:!0,height:1080},child:[{type:"Sprite",props:{y:-44,x:543,width:807,name:"templete",mouseThrough:!1,height:252},child:[{type:"Image",props:{y:44,x:1,width:808,skin:"myres/bothui/invite_bg.png",name:"bg",height:201,sizeGrid:"18,25,30,24"}},{type:"Button",props:{y:144,x:226,width:383,name:"banned",height:67,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:0,x:0,width:383,skin:"myres/bothui/invite_btn1.png",name:"ignore",height:67,sizeGrid:"4,5,5,5"},child:[{type:"Label",props:{y:5,x:21,width:350,valign:"middle",text:"5分钟内不提示此人",height:59,fontSize:35,font:"fengyu",color:"#fe6959",align:"center"}}]},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:144,x:512,width:161,name:"cancel",height:67,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:0,x:0,width:161,skin:"myres/bothui/invite_btn1.png",name:"cancel",height:67,sizeGrid:"4,5,5,5"},child:[{type:"Label",props:{y:7,x:39,width:80,valign:"middle",text:"取消",height:58,fontSize:35,font:"fengyu",color:"#b8b5b6",align:"center"}}]},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:144,x:689,width:161,name:"join",height:67,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:0,x:0,width:161,skin:"myres/bothui/invite_btn1.png",name:"join",height:67,sizeGrid:"4,5,5,5"},child:[{type:"Label",props:{y:3,x:41,width:80,valign:"middle",text:"加入",height:63,fontSize:35,font:"fengyu",color:"#e8af71",align:"center"}}]},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Label",props:{y:71,x:306,width:228,text:"邀请你加入友人房",height:30,fontSize:28,font:"SimHei",color:"#b1b2b4"}},{type:"Label",props:{y:69,x:44,width:246,text:"蹦蹦跳",name:"name",height:30,fontSize:30,font:"SimHei",color:"#54a46b",align:"center"}},{type:"Label",props:{y:69,x:540,width:233,text:"四人东：123456",name:"room",height:30,fontSize:30,font:"SimHei",color:"#6cbad0"}},{type:"Image",props:{y:195,x:243,width:358,skin:"myres/bothui/invite_mask.png",height:31}},{type:"Label",props:{y:198,x:326,width:194,text:"3分钟后自动取消",height:28,fontSize:24,font:"SimHei",color:"#b1b2b4"}},{type:"Script",props:{runtime:"capsui.UICopy"}}]}]},i}(View);t.inviteUI=i}(e.both_ui||(e.both_ui={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.CButton",capsui.CButton),t.prototype.createChildren.call(this),this.createView(e.both_ui.itemdetailUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Sprite",props:{y:540,x:960,width:1e3,pivotY:391,pivotX:565,name:"root",height:800},child:[{type:"Image",props:{y:101,x:129,width:800,skin:"myres/pop_bg.png",pivotY:0,pivotX:0,name:"bg0",height:550,sizeGrid:"100,100,100,100"},child:[{type:"Image",props:{y:26,x:32,width:71,skin:"myres/pop_texturecut.png",height:497,sizeGrid:"0,0,24,26"}},{type:"Image",props:{y:59,x:33,width:740,skin:"myres/pop_black.png",name:"bar",height:72}},{type:"Image",props:{y:158,x:33,width:740,skin:"myres/pop_black.png",name:"bar",height:258}},{type:"Image",props:{y:27,x:773,width:71,skin:"myres/pop_texturecut.png",scaleX:-1,height:497,sizeGrid:"0,0,24,26"}}]},{type:"Image",props:{y:101,x:129,width:800,skin:"myres/pop_bound.png",name:"bound",height:550,sizeGrid:"131,102,97,106"}},{type:"Label",props:{y:153,x:163,width:740,valign:"middle",text:"一之濑的琴",name:"label_name",height:82,fontSize:45,font:"SimHei",color:"#e8af71",align:"center"}},{type:"Label",props:{y:273,x:466,wordWrap:!0,width:416,text:"我擦咧搞毛啊啊啊啊啊啊啊啊啊啊啊啊啊",name:"desc",leading:5,height:217,fontSize:30,font:"SimHei",color:"#c9c9c9"}},{type:"Button",props:{y:128,x:901,width:100,name:"btn_close",height:100,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Image",props:{y:10,x:10,width:80,skin:"myres/btn_close.png",height:80}}]},{type:"Sprite",props:{y:194,x:172,width:316,name:"item",height:375},child:[{type:"Image",props:{y:195,x:151,width:234,skin:"myres/kuangbg.png",name:"bg",height:234,anchorY:.5,anchorX:.5,sizeGrid:"7,7,8,7"}},{type:"Image",props:{y:195,x:151,width:234,skin:"myres/2s.png",name:"icon",height:234,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:195,x:151,width:242,skin:"myres/kuangbound.png",name:"bound",height:242,anchorY:.5,anchorX:.5,sizeGrid:"18,20,12,12"}}]}]}]},i}(View);t.itemdetailUI=i}(e.both_ui||(e.both_ui={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.createView(e.both_ui.light_tipsUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Button",props:{width:1920,name:"btn_close",height:1080}},{type:"Image",props:{y:514,width:1920,skin:"myres/light_tips_bg.png",name:"root",height:339,anchorY:.5,sizeGrid:"6,11,8,12"},child:[{type:"Label",props:{y:59,x:744,width:422,valign:"top",text:"获得新的装扮！",name:"info",height:229,fontSize:32,font:"SimHei",color:"#7ade91",align:"center"}}]}]},i}(View);t.light_tipsUI=i}(e.both_ui||(e.both_ui={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.CButton",capsui.CButton),View.regComponent("capsui.UICopy",capsui.UICopy),View.regComponent("capsui.CScrollView",capsui.CScrollView),t.prototype.createChildren.call(this),this.createView(e.both_ui.otherplayerinfoUI.uiView)},i.uiView={type:"View",props:{width:1920,mouseThrough:!1,height:1080},child:[{type:"Sprite",props:{y:560,x:1108,width:1479,pivotY:454,pivotX:760,name:"root",height:950},child:[{type:"Sprite",props:{y:192,x:32,width:1587,height:558},child:[{type:"Image",props:{y:293,x:-32,width:1549,skin:"myres/pop_bg.png",name:"bg0",height:951,anchorY:.5,sizeGrid:"100,100,100,100"}},{type:"Image",props:{y:293,x:-32,width:1549,skin:"myres/pop_bound.png",name:"bound",height:951,anchorY:.5,sizeGrid:"131,102,97,106"}}]},{type:"Sprite",props:{y:62,x:52,width:400,name:"illust",height:848},child:[{type:"Image",props:{y:-9,x:-6,width:414,skin:"myres/bothui/character_bg.png",name:"bg",height:861}},{type:"Image",props:{y:27,x:9,width:380,skin:"extendRes/charactor/yiji/waitingroom.png",name:"illust",height:809}},{type:"Image",props:{y:-9,x:-6,width:414,skin:"myres/bothui/frame_blue.png",name:"frame",height:861}}]},{type:"Image",props:{y:46,x:524,width:3,skin:"myres/bothui/dot_line.png",name:"shuxian",height:882,sizeGrid:"1,1,1,1"}},{type:"Sprite",props:{y:70,x:572,width:927,name:"container_info",height:847},child:[{type:"Image",props:{y:11,x:22,width:291,skin:"extendRes/title/notitle.png",name:"title",height:56}},{type:"Button",props:{y:107,x:430,width:191,stateNum:1,skin:"myres/bothui/info_btn.png",name:"btn_add",height:78,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Label",props:{y:7,x:8,width:201,valign:"middle",text:"加为好友",scaleY:.85,scaleX:.85,height:70,fontSize:35,font:"fengyu",color:"#88b0d1",align:"center"}}]},{type:"Label",props:{y:84,x:43,width:256,text:"蹦蹦跳跳的仙太郎",name:"ID",height:31,fontSize:32,font:"SimHei",color:"#f9f6f6",align:"center"},child:[{type:"Image",props:{y:-23,x:-31,width:315,skin:"myres/bothui/bg_nickname.png",height:84}}]},{type:"Image",props:{y:73,x:826,width:255,scaleY:.75,scaleX:.75,pivotY:114,pivotX:128,name:"rank",height:253},child:[{type:"Image",props:{y:15,x:0,skin:"extendRes/level/queshi.png",name:"icon"}},{type:"Image",props:{y:159,x:-84,skin:"myres/starbg.png",scaleY:1,scaleX:1,name:"star2",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]},{type:"Image",props:{y:159,x:-150,skin:"myres/starbg.png",scaleY:1,scaleX:1,name:"star3",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]},{type:"Image",props:{y:159,x:-15,skin:"myres/starbg.png",scaleY:1,scaleX:1,name:"star1",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]},{type:"Sprite",props:{y:92,x:-176,width:149,scaleY:1.3,scaleX:1.3,name:"exp",height:23},child:[{type:"Label",props:{y:-32,x:-2,width:65,text:"6666",name:"value",height:32,fontSize:32,font:"SimHei",color:"#6a97b0",align:"right"}},{type:"Label",props:{y:-32,x:80,text:"9999",name:"max",fontSize:32,font:"SimHei",color:"#6a97b0",align:"left"}},{type:"Label",props:{y:-32,x:64,text:"/",fontSize:32,font:"SimHei",color:"#6a97b0"}},{type:"Sprite",props:{y:0,x:0,width:146,name:"bar",height:22},child:[{type:"Image",props:{y:0,x:0,width:146,skin:"myres/bothui/bg-exp.png",renderType:"mask",name:"mask",height:18}},{type:"Image",props:{y:0,x:-8,width:300,skin:"myres/bothui/rankexp.png",name:"v",height:18}}]}]}]},{type:"Sprite",props:{y:181,x:-39,width:962,name:"data",height:658},child:[{type:"Panel",props:{y:0,x:0,width:956,vScrollBarSkin:"myres/vscroll.png",name:"content",height:667},child:[{type:"Sprite",props:{y:0,x:0,width:950,name:"dahe",height:150},child:[{type:"Image",props:{y:31,x:53,width:195,skin:"myres/underline.png",height:22},child:[{type:"Label",props:{y:-30,x:4,width:169,valign:"middle",text:"最近大和",scaleY:.9,scaleX:.9,height:46,fontSize:38,font:"fengyu",color:"#e8af71",align:"center"}}]},{type:"Sprite",props:{y:152,x:59,width:1623,scaleY:.65,scaleX:.65,pivotY:133,name:"container_hand",height:133},child:[{type:"Image",props:{y:0,x:0,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:80,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:160,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:240,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:320,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:400,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:480,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:560,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:640,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:720,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:800,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:880,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:960,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:1040,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:1120,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:1200,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:1280,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:1360,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:1440,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:1520,width:80,skin:"myres/8p.png",height:120}}]},{type:"Sprite",props:{y:32,x:827,width:650,scaleY:.4,scaleX:.4,pivotY:85,pivotX:430,name:"container_title",height:150},child:[{type:"Image",props:{width:160,name:"0",height:155}},{type:"Image",props:{y:0,x:160,width:160,name:"1",height:155}},{type:"Image",props:{y:0,x:320,width:160,name:"2",height:155}},{type:"Image",props:{y:0,x:480,width:160,name:"3",height:155}}]},{type:"Label",props:{y:65,x:77,width:293,valign:"middle",text:"暂无记录，请加油",name:"label_noinfo",height:81,fontSize:30,font:"SimHei",color:"#e8af71"}}]},{type:"Sprite",props:{y:150,x:0,width:950,name:"fengge",height:280},child:[{type:"Label",props:{y:86,x:64,width:38,valign:"middle",text:"攻",scaleY:.9,scaleX:.9,height:38,fontSize:34,font:"fengyu",color:"#ff637d",align:"center"}},{type:"Label",props:{y:92,x:117,width:39,valign:"middle",text:"99",scaleY:.75,scaleX:.75,name:"gong",height:34,fontSize:34,font:"haolong",color:"#d1f2f2",align:"center"}},{type:"Label",props:{y:128,x:64,width:38,valign:"middle",text:"防",scaleY:.9,scaleX:.9,height:38,fontSize:34,font:"fengyu",color:"#46d277",align:"center"}},{type:"Label",props:{y:133,x:117,width:39,valign:"middle",text:"99",scaleY:.75,scaleX:.75,name:"fang",height:34,fontSize:34,font:"haolong",color:"#d1f2f2",align:"center"}},{type:"Label",props:{y:172,x:64,width:38,valign:"middle",text:"速",scaleY:.9,scaleX:.9,height:38,fontSize:34,font:"fengyu",color:"#39b9be",align:"center"}},{type:"Label",props:{y:178,x:117,width:39,valign:"middle",text:"99",scaleY:.75,scaleX:.75,name:"su",height:34,fontSize:34,font:"haolong",color:"#d1f2f2",align:"center"}},{type:"Label",props:{y:214,x:64,width:38,valign:"middle",text:"运",scaleY:.9,scaleX:.9,height:38,fontSize:34,font:"fengyu",color:"#be7b39",align:"center"}},{type:"Label",props:{y:221,x:117,width:39,valign:"middle",text:"99",scaleY:.75,scaleX:.75,name:"yun",height:34,fontSize:34,font:"haolong",color:"#d1f2f2",align:"center"}},{type:"Image",props:{y:150,x:587,width:237,skin:"myres/radar.png",name:"radar",height:237,anchorY:.5,anchorX:.5,size:100},child:[{type:"Label",props:{y:-34,x:101,width:38,valign:"middle",text:"攻",scaleY:.9,scaleX:.9,name:"gong",height:38,fontSize:34,font:"fengyu",color:"#ff637d",align:"center"}},{type:"Label",props:{y:229,x:100,width:38,valign:"middle",text:"防",scaleY:.9,scaleX:.9,name:"fang",height:38,fontSize:34,font:"fengyu",color:"#46d277",align:"center"}},{type:"Label",props:{y:95,x:-32,width:38,valign:"middle",text:"速",scaleY:.9,scaleX:.9,name:"su",height:38,fontSize:34,font:"fengyu",color:"#39b9be",align:"center"}},{type:"Label",props:{y:98,x:232,width:38,valign:"middle",text:"运",scaleY:.9,scaleX:.9,name:"yun",height:38,fontSize:34,font:"fengyu",color:"#be7b39",align:"center"}},{type:"Sprite",props:{y:119,x:119,width:108,rotation:-90,pivotY:108,pivotX:0,name:"sanjiao0",height:108},child:[{type:"Image",props:{y:85,x:33,width:108,skin:"myres/line_orange.png",rotation:45,name:"wai",height:108,anchorY:0,anchorX:.5}},{type:"Image",props:{y:84,x:30,width:108,skin:"myres/radar_yellow.png",rotation:45,name:"nei",height:108,anchorY:0,anchorX:.5,size:100}},{type:"Image",props:{y:108.5,x:-.5,width:120,skin:"myres/line_orange.png",rotation:0,renderType:"mask",name:"mask",height:120,anchorY:1,anchorX:0}}]},{type:"Sprite",props:{y:119,x:119,width:108,rotation:-180,pivotY:108,pivotX:0,name:"sanjiao1",height:108},child:[{type:"Image",props:{y:85,x:33,width:108,skin:"myres/line_orange.png",rotation:45,name:"wai",height:108,anchorY:0,anchorX:.5}},{type:"Image",props:{y:84,x:30,width:108,skin:"myres/radar_yellow.png",rotation:45,name:"nei",height:108,anchorY:0,anchorX:.5,size:100}},{type:"Image",props:{y:108.5,x:-.5,width:120,skin:"myres/line_orange.png",rotation:0,renderType:"mask",name:"mask",height:120,anchorY:1,anchorX:0}}]},{type:"Sprite",props:{y:119,x:119,width:108,rotation:-270,pivotY:108,pivotX:0,name:"sanjiao2",height:108},child:[{type:"Image",props:{y:85,x:33,width:108,skin:"myres/line_orange.png",rotation:45,name:"wai",height:108,anchorY:0,anchorX:.5}},{type:"Image",props:{y:58,x:62,width:200,skin:"myres/radar_yellow.png",rotation:45,name:"nei",height:200,anchorY:0,anchorX:.5,size:100}},{type:"Image",props:{y:108.5,x:-.5,width:120,skin:"myres/line_orange.png",rotation:0,renderType:"mask",name:"mask",height:120,anchorY:1,anchorX:0}}]},{type:"Sprite",props:{y:119,x:119,width:108,pivotY:108,pivotX:0,name:"sanjiao3",height:108},child:[{type:"Image",props:{y:104,x:34,width:108,skin:"myres/line_orange.png",rotation:18,name:"wai",height:108,anchorY:0,anchorX:.5}},{type:"Image",props:{y:84,x:30,width:108,skin:"myres/radar_yellow.png",rotation:45,name:"nei",height:108,anchorY:0,anchorX:.5,size:100}},{type:"Image",props:{y:108.5,x:-.5,width:120,skin:"myres/line_orange.png",rotation:0,renderType:"mask",name:"mask",height:120,anchorY:1,anchorX:0}}]}]},{type:"Image",props:{y:56,x:53,width:195,skin:"myres/underline.png",height:22},child:[{type:"Label",props:{y:-30,x:4,width:159,valign:"middle",text:"风格属性",scaleY:.9,scaleX:.9,height:38,fontSize:38,font:"fengyu",color:"#e8af71",align:"center"}}]},{type:"Button",props:{y:45,x:246,width:70,name:"what",height:70,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:15,x:15,skin:"myres/bothui/what.png",scaleY:1.2,scaleX:1.2,name:"what"}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]},{type:"Sprite",props:{y:430,x:0,width:950,name:"zoushi",height:270},child:[{type:"Image",props:{y:76,x:130,width:760,skin:"myres/line_blue.png",name:"line1",height:3}},{type:"Image",props:{y:119,x:130,width:760,skin:"myres/line_blue.png",name:"line2",height:3}},{type:"Image",props:{y:163,x:130,width:760,skin:"myres/line_blue.png",name:"line3",height:3}},{type:"Image",props:{y:206,x:130,width:760,skin:"myres/line_blue.png",name:"line4",height:3}},{type:"Sprite",props:{y:-783,x:-890,name:"lines"},child:[{type:"Image",props:{y:965,x:1274,width:159,skin:"myres/line_orange.png",rotation:57,height:5,anchorY:.5}},{type:"Image",props:{y:975,x:1284,width:159,skin:"myres/line_orange.png",rotation:0,height:5,anchorY:.5}},{type:"Image",props:{y:985,x:1294,width:159,skin:"myres/line_orange.png",rotation:0,height:5,anchorY:.5}},{type:"Image",props:{y:995,x:1304,width:159,skin:"myres/line_orange.png",rotation:0,height:5,anchorY:.5}},{type:"Image",props:{y:1005,x:1314,width:159,skin:"myres/line_orange.png",rotation:0,height:5,anchorY:.5}},{type:"Image",props:{y:1015,x:1324,width:159,skin:"myres/line_orange.png",rotation:0,height:5,anchorY:.5}},{type:"Image",props:{y:1025,x:1334,width:159,skin:"myres/line_orange.png",rotation:0,height:5,anchorY:.5}},{type:"Image",props:{y:1035,x:1344,width:159,skin:"myres/line_orange.png",rotation:0,height:5,anchorY:.5}},{type:"Image",props:{y:1045,x:1354,width:159,skin:"myres/line_orange.png",rotation:0,height:5,anchorY:.5}},{type:"Image",props:{y:1055,x:1364,width:159,skin:"myres/line_orange.png",rotation:0,height:5,anchorY:.5}},{type:"Image",props:{y:1065,x:1374,width:159,skin:"myres/line_orange.png",rotation:0,height:5,anchorY:.5}}]},{type:"Sprite",props:{y:-783,x:-890,name:"points"},child:[{type:"Image",props:{y:991,x:1744,skin:"myres/point.png",anchorY:.5,anchorX:.5}},{type:"Image",props:{y:870,x:1323,skin:"myres/point.png",anchorY:.5,anchorX:.5}},{type:"Image",props:{y:880,x:1323,skin:"myres/point.png",anchorY:.5,anchorX:.5}},{type:"Image",props:{y:890,x:1323,skin:"myres/point.png",anchorY:.5,anchorX:.5}},{type:"Image",props:{y:900,x:1323,skin:"myres/point.png",anchorY:.5,anchorX:.5}},{type:"Image",props:{y:910,x:1323,skin:"myres/point.png",anchorY:.5,anchorX:.5}},{type:"Image",props:{y:920,x:1323,skin:"myres/point.png",anchorY:.5,anchorX:.5}},{type:"Image",props:{y:930,x:1323,skin:"myres/point.png",anchorY:.5,anchorX:.5}},{type:"Image",props:{y:940,x:1323,skin:"myres/point.png",anchorY:.5,anchorX:.5}},{type:"Image",props:{y:950,x:1323,skin:"myres/point.png",anchorY:.5,anchorX:.5}},{type:"Image",props:{y:960,x:1323,skin:"myres/point.png",anchorY:.5,anchorX:.5}},{type:"Image",props:{y:970,x:1323,skin:"myres/point.png",anchorY:.5,anchorX:.5}}]},{type:"Label",props:{y:182,x:65,width:26,valign:"middle",text:"4",scaleY:.75,scaleX:.75,height:37,fontSize:35,font:"haolong",color:"#d1f2f2",align:"center"},child:[{type:"Label",props:{y:0,x:34,width:26,valign:"middle",text:"位",height:37,fontSize:34,font:"fengyu",color:"#d1f2f2",align:"center"}}]},{type:"Label",props:{y:140,x:65,width:26,valign:"middle",text:"3",scaleY:.75,scaleX:.75,height:37,fontSize:35,font:"haolong",color:"#d1f2f2",align:"center"},child:[{type:"Label",props:{y:0,x:34,width:26,valign:"middle",text:"位",height:37,fontSize:34,font:"fengyu",color:"#d1f2f2",align:"center"}}]},{type:"Label",props:{y:94,x:65,width:26,valign:"middle",text:"2",scaleY:.75,scaleX:.75,height:37,fontSize:35,font:"haolong",color:"#d1f2f2",align:"center"},child:[{type:"Label",props:{y:0,x:34,width:26,valign:"middle",text:"位",height:37,fontSize:34,font:"fengyu",color:"#d1f2f2",align:"center"}}]},{type:"Label",props:{y:54,x:62,width:26,valign:"middle",text:"1",scaleY:.75,scaleX:.75,height:37,fontSize:35,font:"haolong",color:"#d1f2f2",align:"center"},child:[{type:"Label",props:{y:0,x:34,width:26,valign:"middle",text:"位",height:37,fontSize:34,font:"fengyu",color:"#d1f2f2",align:"center"}}]},{type:"Image",props:{y:28,x:53,width:195,skin:"myres/underline.png",height:22},child:[{type:"Label",props:{y:-30,x:4,width:159,valign:"middle",text:"最近走势",scaleY:.9,scaleX:.9,height:38,fontSize:38,font:"fengyu",color:"#e8af71",align:"center"}}]}]},{type:"Sprite",props:{y:700,x:0,width:950,name:"tabs",height:87},child:[{type:"Image",props:{y:59,x:46,width:899,skin:"myres/bothui/bg.png",name:"bg",height:1121,sizeGrid:"18,18,17,17"}},{type:"Button",props:{y:-3,x:54,width:202,stateNum:1,skin:"myres/bothui/pi_choosed.png",name:"btn_pipei",height:72},child:[{type:"Label",props:{y:11,x:29,width:145,text:"匹配场",height:50,fontSize:40,font:"fengyu",color:"#e8af71",align:"center"}}]},{type:"Button",props:{y:-3,x:256,width:202,stateNum:1,skin:"myres/bothui/pi_unchosen.png",name:"btn_friend",height:72},child:[{type:"Label",props:{y:11,x:29,width:145,text:"友人房",height:50,fontSize:40,font:"fengyu",color:"#e8af71",align:"center"}}]}]},{type:"Sprite",props:{y:787,x:15,width:950,name:"mode0",height:77},child:[{type:"Button",props:{y:0,x:25,width:900,name:"btn",height:77},child:[{type:"Image",props:{y:10,x:26,width:854,skin:"myres/bar.png",height:57}},{type:"Image",props:{y:37,x:838,width:46,skin:"myres/arrow.png",name:"arrow",height:19,anchorY:.2,anchorX:.5}},{type:"Label",props:{y:13,x:45,width:159,valign:"middle",text:"一场胜负",scaleY:.9,scaleX:.9,name:"mode",height:57,fontSize:38,font:"fengyu",color:"#e8af71",align:"left"}}]},{type:"Sprite",props:{y:77,x:25,width:900,name:"detail",height:233},child:[{type:"Label",props:{y:11,x:44,text:"一位率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:11,x:170,width:110,text:"99.99%",scaleY:1,scaleX:1,name:"pos1",height:33,fontSize:33,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:54,x:44,text:"二位率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:54,x:170,width:110,text:"99.99%",scaleY:1,scaleX:1,name:"pos2",height:33,fontSize:33,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:97,x:44,text:"三位率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:97,x:170,width:110,text:"99.99%",scaleY:1,scaleX:1,name:"pos3",height:33,fontSize:33,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:140,x:44,text:"四位率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:140,x:170,width:110,text:"99.99%",scaleY:1,scaleX:1,name:"pos4",height:33,fontSize:33,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:183,x:44,text:"被飞率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:183,x:170,width:110,text:"99.99%",scaleY:1,scaleX:1,name:"knockout",height:35,fontSize:33,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:11,x:340,text:"总对局数",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:11,x:484,width:110,text:"99999",scaleY:.8,scaleX:.8,name:"changci",height:40,fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:54,x:340,text:"平均打点",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:54,x:484,width:110,text:"99999",scaleY:.8,scaleX:.8,name:"dadian",fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:97,x:340,text:"平均顺位",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:97,x:484,width:110,text:"99999",scaleY:.8,scaleX:.8,name:"shunwei",fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:140,x:340,text:"最大连庄",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:140,x:484,width:110,text:"99999",scaleY:.8,scaleX:.8,name:"lianzhuang",fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:183,x:340,text:"和了巡数",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:183,x:484,width:110,text:"99999",scaleY:.8,scaleX:.8,name:"hule",fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:11,x:635,text:"和牌率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:11,x:755,width:145,text:"99.99%",scaleY:.8,scaleX:.8,name:"hupai",height:33,fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:54,x:635,text:"自摸率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:54,x:755,width:145,text:"99.99%",scaleY:.8,scaleX:.8,name:"zimo",height:33,fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:97,x:635,text:"放铳率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:97,x:755,width:145,text:"99.99%",scaleY:.8,scaleX:.8,name:"fangchong",height:33,fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:140,x:635,text:"副露率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:140,x:755,width:145,text:"99.99%",scaleY:.8,scaleX:.8,name:"fulu",height:33,fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:183,x:635,text:"立直率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:183,x:755,width:145,text:"99.99%",scaleY:.8,scaleX:.8,name:"liqi",height:33,fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}}]}]},{type:"Sprite",props:{y:1097,x:15,width:950,name:"mode1",height:77},child:[{type:"Button",props:{y:0,x:25,width:900,name:"btn",height:77},child:[{type:"Image",props:{y:10,x:26,width:854,skin:"myres/bar.png",height:57}},{type:"Image",props:{y:37,x:838,width:46,skin:"myres/arrow.png",name:"arrow",height:19,anchorY:.2,anchorX:.5}},{type:"Label",props:{y:12,x:45,width:159,valign:"middle",text:"四人东风",scaleY:.9,scaleX:.9,name:"mode",height:59,fontSize:38,font:"fengyu",color:"#e8af71",align:"left"}}]},{type:"Sprite",props:{y:77,x:25,width:900,name:"detail",height:233},child:[{type:"Label",props:{y:11,x:44,text:"一位率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:11,x:170,width:110,text:"99.99%",scaleY:1,scaleX:1,name:"pos1",height:33,fontSize:33,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:54,x:44,text:"二位率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:54,x:170,width:110,text:"99.99%",scaleY:1,scaleX:1,name:"pos2",height:33,fontSize:33,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:97,x:44,text:"三位率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:97,x:170,width:110,text:"99.99%",scaleY:1,scaleX:1,name:"pos3",height:33,fontSize:33,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:140,x:44,text:"四位率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:140,x:170,width:110,text:"99.99%",scaleY:1,scaleX:1,name:"pos4",height:33,fontSize:33,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:183,x:44,text:"被飞率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:183,x:170,width:110,text:"99.99%",scaleY:1,scaleX:1,name:"knockout",height:35,fontSize:33,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:11,x:340,text:"总对局数",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:11,x:484,width:110,text:"99999",scaleY:.8,scaleX:.8,name:"changci",height:40,fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:54,x:340,text:"平均打点",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:54,x:484,width:110,text:"99999",scaleY:.8,scaleX:.8,name:"dadian",fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:97,x:340,text:"平均顺位",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:97,x:484,width:110,text:"99999",scaleY:.8,scaleX:.8,name:"shunwei",fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:140,x:340,text:"最大连庄",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:140,x:484,width:110,text:"99999",scaleY:.8,scaleX:.8,name:"lianzhuang",fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:183,x:340,text:"和了巡数",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:183,x:484,width:110,text:"99999",scaleY:.8,scaleX:.8,name:"hule",fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:11,x:635,text:"和牌率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:11,x:755,width:145,text:"99.99%",scaleY:.8,scaleX:.8,name:"hupai",height:33,fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:54,x:635,text:"自摸率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:54,x:755,width:145,text:"99.99%",scaleY:.8,scaleX:.8,name:"zimo",height:33,fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:97,x:635,text:"放铳率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:97,x:755,width:145,text:"99.99%",scaleY:.8,scaleX:.8,name:"fangchong",height:33,fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:140,x:635,text:"副露率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:140,x:755,width:145,text:"99.99%",scaleY:.8,scaleX:.8,name:"fulu",height:33,fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:183,x:635,text:"立直率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:183,x:755,width:145,text:"99.99%",scaleY:.8,scaleX:.8,name:"liqi",height:33,fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}}]}]},{type:"Sprite",props:{y:1407,x:15,width:950,name:"mode2",height:77},child:[{type:"Button",props:{y:0,x:25,width:900,name:"btn",height:77},child:[{type:"Image",props:{y:10,x:26,width:854,skin:"myres/bar.png",height:57}},{type:"Image",props:{y:37,x:838,width:46,skin:"myres/arrow.png",name:"arrow",height:19,anchorY:.2,anchorX:.5}},{type:"Label",props:{y:14,x:45,width:159,valign:"middle",text:"四人南风",scaleY:.9,scaleX:.9,name:"mode",height:56,fontSize:38,font:"fengyu",color:"#e8af71",align:"left"}}]},{type:"Sprite",props:{y:77,x:25,width:900,name:"detail",height:233},child:[{type:"Label",props:{y:11,x:44,text:"一位率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:11,x:170,width:110,text:"99.99%",scaleY:1,scaleX:1,name:"pos1",height:33,fontSize:33,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:54,x:44,text:"二位率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:54,x:170,width:110,text:"99.99%",scaleY:1,scaleX:1,name:"pos2",height:33,fontSize:33,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:97,x:44,text:"三位率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:97,x:170,width:110,text:"99.99%",scaleY:1,scaleX:1,name:"pos3",height:33,fontSize:33,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:140,x:44,text:"四位率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:140,x:170,width:110,text:"99.99%",scaleY:1,scaleX:1,name:"pos4",height:33,fontSize:33,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:183,x:44,text:"被飞率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:183,x:170,width:110,text:"99.99%",scaleY:1,scaleX:1,name:"knockout",height:35,fontSize:33,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:11,x:340,text:"总对局数",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:11,x:484,width:110,text:"99999",scaleY:.8,scaleX:.8,name:"changci",height:40,fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:54,x:340,text:"平均打点",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:54,x:484,width:110,text:"99999",scaleY:.8,scaleX:.8,name:"dadian",fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:97,x:340,text:"平均顺位",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:97,x:484,width:110,text:"99999",scaleY:.8,scaleX:.8,name:"shunwei",fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:140,x:340,text:"最大连庄",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:140,x:484,width:110,text:"99999",scaleY:.8,scaleX:.8,name:"lianzhuang",fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:183,x:340,text:"和了巡数",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:183,x:484,width:110,text:"99999",scaleY:.8,scaleX:.8,name:"hule",fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:11,x:635,text:"和牌率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:11,x:755,width:145,text:"99.99%",scaleY:.8,scaleX:.8,name:"hupai",height:33,fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:54,x:635,text:"自摸率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:54,x:755,width:145,text:"99.99%",scaleY:.8,scaleX:.8,name:"zimo",height:33,fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:97,x:635,text:"放铳率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:97,x:755,width:145,text:"99.99%",scaleY:.8,scaleX:.8,name:"fangchong",height:33,fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:140,x:635,text:"副露率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:140,x:755,width:145,text:"99.99%",scaleY:.8,scaleX:.8,name:"fulu",height:33,fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:183,x:635,text:"立直率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:183,x:755,width:145,text:"99.99%",scaleY:.8,scaleX:.8,name:"liqi",height:33,fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}}]}]},{type:"Sprite",props:{y:1717,x:15,width:950,name:"fan",height:77},child:[{type:"Button",props:{y:0,x:25,width:900,name:"btn",height:77},child:[{type:"Image",props:{y:10,x:26,width:854,skin:"myres/bar.png",height:57}},{type:"Image",props:{y:37,x:838,width:46,skin:"myres/arrow.png",name:"arrow",height:19,anchorY:.2,anchorX:.5}},{type:"Label",props:{y:12,x:45,width:249,valign:"middle",text:"番数达成次数",scaleY:.9,scaleX:.9,name:"mode",height:58,fontSize:38,font:"fengyu",color:"#e8af71",align:"center"}}]},{type:"Sprite",props:{y:77,x:25,width:900,name:"detail",height:233},child:[{type:"Sprite",props:{y:3,x:-25,width:950,name:"templete",height:50},child:[{type:"Label",props:{y:14,x:87,text:"国士无双十三面",scaleY:.8,scaleX:.8,name:"fan",fontSize:33,font:"youyuan",color:"#eee1e1"}},{type:"Label",props:{y:16,x:717,width:169,text:"0",scaleY:.8,scaleX:.8,name:"count",height:33,fontSize:33,font:"youyuan",color:"#ffc751",bold:!0,align:"right"}},{type:"Label",props:{y:16,x:352,width:486,text:"—————————————",scaleY:.8,scaleX:.8,height:33,fontSize:33,font:"youyuan",color:"#ffc751",align:"center"}},{type:"Script",props:{runtime:"capsui.UICopy"}}]}]}]},{type:"Sprite",props:{y:1727,x:15,width:950,name:"blank",height:300}}]},{type:"Sprite",props:{y:0,x:930,width:50,name:"scrollbar",mouseThrough:!1,mouseEnabled:!0,height:658},child:[{type:"Image",props:{y:0,x:25,skin:"myres/scrollbar.png",name:"scrollbar",height:658,anchorX:.5,alpha:.5}},{type:"Image",props:{y:96,x:25,width:45,skin:"myres/scrollpoint.png",name:"scrollpoint",height:45,anchorY:.5,anchorX:.5}}]}]}]},{type:"Button",props:{y:167,x:526,width:83,stateNum:1,skin:"myres/bothui/info_tab_dark.png",name:"tab_info",height:152,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:25,x:20,wordWrap:!0,width:45,text:"信",height:86,fontSize:40,font:"fengyu",color:"#e8af71"}},{type:"Label",props:{y:75,x:20,wordWrap:!0,width:45,text:"息",height:86,fontSize:40,font:"fengyu",color:"#e8af71"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:321,x:526,width:83,stateNum:1,skin:"myres/bothui/info_tab_dark.png",name:"tab_note",height:152,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:25,x:20,wordWrap:!0,width:45,text:"留",height:86,fontSize:40,font:"fengyu",color:"#e8af71"}},{type:"Label",props:{y:75,x:20,wordWrap:!0,width:45,text:"言",height:86,fontSize:40,font:"fengyu",color:"#e8af71"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Sprite",props:{y:186,x:560,width:938,visible:!1,name:"container_note",height:886},child:[{type:"Image",props:{y:19,x:17,width:908,skin:"myres/bothui/bg.png",name:"bg",height:707,sizeGrid:"18,18,17,17"}},{type:"Label",props:{y:179,x:212,width:508,valign:"middle",text:"没有留言",name:"nonote",height:67,fontSize:40,font:"SimHei",color:"#e8af71",align:"center"}},{type:"Panel",props:{y:145,x:37,width:868,name:"content",height:487},child:[{type:"Sprite",props:{y:0,x:4,width:857,name:"templete",height:244},child:[{type:"Image",props:{y:9,x:116,width:725,skin:"myres/bothui/sms_bg.png",height:225,sizeGrid:"70,72,55,67"}},{type:"Image",props:{y:8,x:118,width:434,skin:"myres/bothui/sms_name.png",height:56,sizeGrid:"9,12,9,4"}},{type:"Button",props:{y:34,x:816,width:60,name:"btn_del",height:60,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:7,x:7,width:46,skin:"myres/bothui/sms_×.png",name:"close",height:46}}]},{type:"Image",props:{y:-11,x:-7,skin:"myres/bg_head1.png",scaleY:.65,scaleX:.65,name:"head"},child:[{type:"Image",props:{y:35,x:23,width:154,skin:"extendRes/charactor/yiji/smallhead.png",height:154}}]},{type:"Label",props:{y:25,x:566,width:130,text:"2018/99/99",name:"date",height:25,fontSize:25,font:"SimHei",color:"#58638d"}},{type:"Label",props:{y:25,x:714,text:"23:59",name:"time",fontSize:25,font:"SimHei",color:"#58638d"}},{type:"Image",props:{y:74,x:142,width:135,skin:"extendRes/emo/e200001/0.png",name:"emo",height:135}},{type:"Label",props:{y:91,x:155,wordWrap:!0,width:664,text:"言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言",name:"word",height:134,fontSize:28,font:"SimHei",color:"#9199ad"}},{type:"Script",props:{runtime:"capsui.UICopy"}},{type:"Label",props:{y:18,x:127,wordWrap:!0,width:274,text:"名字名字名字名字",name:"name",height:35,fontSize:30,font:"SimHei",color:"#9199ad"}},{type:"Label",props:{y:9,x:378,width:185,valign:"middle",text:"段位级别",scaleY:.8,scaleX:.8,name:"level",height:60,fontSize:30,font:"fengyu",color:"#e8af71",align:"right"}}]}]},{type:"Sprite",props:{y:146,x:877,width:50,name:"scrollbar",mouseThrough:!1,mouseEnabled:!0,height:553},child:[{type:"Image",props:{y:0,x:25,skin:"myres/scrollbar.png",name:"scrollbar",height:553,anchorX:.5,alpha:.5}},{type:"Image",props:{y:96,x:25,width:45,skin:"myres/scrollpoint.png",name:"scrollpoint",height:45,anchorY:.5,anchorX:.5}}]},{type:"Sprite",props:{y:46,x:52,width:842,name:"input",height:102},child:[{type:"Button",props:{y:47,x:766,width:136,stateNum:1,skin:"myres/bothui/sms_btn.png",name:"btn_send",height:74,anchorY:.5,anchorX:.5,sizeGrid:"4,13,11,10"},child:[{type:"Label",props:{y:13,x:28,text:"发送",name:"send",fontSize:40,font:"fengyu",color:"#9b9fa4"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Image",props:{y:11,x:112,width:557,skin:"myres/bothui/sms_input.png",name:"input",height:74,sizeGrid:"11,7,6,6"},child:[{type:"TextInput",props:{y:-7,x:-12,wordWrap:!0,width:579,text:"留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言",promptColor:"#d0cdcd",padding:"25,25,35,25",name:"txtinput",maxChars:90,height:95,fontSize:35,font:"SimHei",color:"#d0cdcd",align:"left"}}]},{type:"Button",props:{y:52,x:47,width:94,name:"emj",height:98,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Image",props:{y:20,x:20,width:54,skin:"myres/bothui/sms_emo.png",name:"emo",height:56}}]}]},{type:"Label",props:{y:68,x:70,width:823,text:"该玩家仅允许好友留言",name:"noinfo",height:56,fontSize:40,font:"SimHei",color:"#909090",align:"center"}},{type:"Sprite",props:{y:-3,x:-538,width:1501,name:"container_emj",height:894},child:[{type:"Button",props:{y:0,x:0,width:1497,name:"close",height:892}},{type:"Image",props:{y:143,x:782,width:450,skin:"myres/pop2_bg.png",name:"root",mouseThrough:!1,height:400,anchorX:.5,sizeGrid:"2,2,2,2"},child:[{type:"Image",props:{y:0,x:0,width:450,skin:"myres/pop2_bound.png",name:"bound",height:400,sizeGrid:"24,27,11,21"}},{type:"Panel",props:{y:10,x:10,width:430,name:"content",height:380},child:[{type:"Sprite",props:{y:0,x:0,width:430,name:"templete",height:140},child:[{type:"Button",props:{y:70,x:75,width:130,stateNum:1,skin:"extendRes/emo/e200001/0.png",height:130,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:70,x:215,width:130,stateNum:1,skin:"extendRes/emo/e200001/0.png",height:130,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:70,x:355,width:130,stateNum:1,skin:"extendRes/emo/e200001/0.png",height:130,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Script",props:{runtime:"capsui.UICopy"}}]}]},{type:"Script",props:{runtime:"capsui.CScrollView"}}]}]},{type:"Script",props:{runtime:"capsui.CScrollView"}},{type:"Sprite",props:{y:631,x:283,width:386,name:"page_controller",height:96},child:[{type:"Image",props:{y:18,x:120,width:144,skin:"myres/bothui/sms_btn.png",height:56,sizeGrid:"4,13,11,10"}},{type:"Label",props:{y:18,x:120,width:144,valign:"middle",text:"1",name:"curr_page",height:55,fontSize:35,font:"SimHei",color:"#9b9da6",align:"center"}},{type:"Button",props:{y:5,x:92,width:198,name:"btn_page",height:83}},{type:"Button",props:{y:46,x:326,width:90,name:"btn_right",height:90,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Image",props:{y:15,x:28,width:46,skin:"myres/bothui/sms_arrow.png",name:"next",height:57}}]},{type:"Button",props:{y:45,x:58,width:90,name:"btn_left",height:90,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Image",props:{y:16,x:61,width:46,skin:"myres/bothui/sms_arrow.png",scaleX:-1,name:"left",height:57}}]},{type:"Image",props:{y:-180,x:120,width:144,name:"container_pages",height:201},child:[{type:"Button",props:{y:-562,x:-386,width:945,name:"close",height:865}},{type:"Image",props:{x:0,width:144,skin:"myres/bothui/page_bg.png",name:"bg",height:200,sizeGrid:"8,10,6,10"},child:[{type:"Panel",props:{y:3,x:3,width:138,name:"content",height:196},child:[{type:"Sprite",props:{width:138,name:"templete",height:54},child:[{type:"Button",props:{y:0,x:0,width:138,stateNum:1,skin:"myres/bothui/dot_line.png",name:"btn",height:51,sizeGrid:"1,1,1,1"}},{type:"Label",props:{y:0,x:0,width:138,valign:"middle",text:"1",name:"page",height:51,fontSize:35,font:"SimHei",color:"#9b9da6",align:"center"}},{type:"Script",props:{y:0,x:0,runtime:"capsui.UICopy"}}]}]},{type:"Script",props:{y:0,x:0,runtime:"capsui.CScrollView"}}]}]}]},{type:"Sprite",props:{y:-131,x:7,width:924,name:"sign",height:154},child:[{type:"Image",props:{y:15,x:9,width:903,skin:"myres/bothui/bg.png",name:"bg",height:134,alpha:.5,sizeGrid:"18,18,17,17"}},{type:"Image",props:{y:15,x:132,width:780,skin:"myres/bothui/bg.png",name:"2",height:134,alpha:.5,sizeGrid:"18,18,17,17"}},{type:"Label",props:{y:69,x:420,wordWrap:!0,width:123,text:"暂无签名",name:"noinfo",height:35,fontSize:30,font:"SimHei",color:"#5c678b"}},{type:"Label",props:{y:61,x:20,width:126,text:"签名",scaleY:.9,scaleX:.9,height:57,fontSize:30,font:"fengyu",color:"#9b9fa4",align:"center"}},{type:"Label",props:{y:49,x:171,wordWrap:!0,width:677,valign:"middle",text:"签名签名签名签名签名签名签名签名签名签名签名签名签名签名签名签名签名签名签名签名签名签名签名签名签名签名",overflow:"scroll",name:"content",leading:5,height:68,fontSize:30,font:"SimHei",color:"#5c678b"}}]}]},{type:"Button",props:{y:47,x:1512,width:92,pivotY:54,pivotX:43,name:"btn_close",height:94},child:[{type:"Image",props:{y:12,x:4,width:80,skin:"myres/btn_close.png",height:80}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]}]},i}(View);t.otherplayerinfoUI=i}(e.both_ui||(e.both_ui={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.CButton",capsui.CButton),t.prototype.createChildren.call(this),this.createView(e.both_ui.popwindowUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Sprite",props:{y:489,x:940,width:500,pivotY:255,pivotX:255,name:"title",height:500},child:[{type:"Image",props:{y:255,x:255,width:500,skin:"myres/pop_bg.png",name:"bg0",height:360,anchorY:.5,anchorX:.5,sizeGrid:"100,100,100,100"},child:[{type:"Image",props:{y:27,x:33,width:57,skin:"myres/pop_texturecut.png",height:304,sizeGrid:"0,0,24,26"}},{type:"Image",props:{y:27,x:473,width:57,skin:"myres/pop_texturecut.png",scaleX:-1,height:304,sizeGrid:"0,0,24,26"}},{type:"Image",props:{y:54,x:33,width:441,skin:"myres/pop_black.png",name:"bar",height:63}},{type:"Image",props:{y:125,x:33,width:441,skin:"myres/pop_black.png",name:"bar",height:127}}]},{type:"Image",props:{y:255,x:255,width:500,skin:"myres/pop_bound.png",name:"bound",height:360,anchorY:.5,anchorX:.5,sizeGrid:"131,102,97,106"}},{type:"Label",props:{y:118,x:94,width:335,valign:"middle",text:"加入房间",name:"ttt",height:76,fontSize:41,font:"fengyu",color:"#e8af71",align:"center"}},{type:"Label",props:{y:214,x:75,wordWrap:!0,width:365,valign:"middle",text:"金钱不足",name:"text",height:95,fontSize:30,font:"SimHei",color:"#c9c9c9",align:"center"}},{type:"Button",props:{y:365,x:262,width:153,stateNum:1,skin:"myres/btn_small.png",name:"btn",height:65,anchorY:.5,anchorX:.5,sizeGrid:"30,30,30,30"},child:[{type:"Label",props:{y:6,x:12,width:143,valign:"middle",text:"确定",scaleY:.9,scaleX:.9,height:58,fontSize:38,font:"fengyu",color:"#e8af71",align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:105,x:476,width:120,name:"btn_cancel",height:120,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Image",props:{y:24,x:24,width:70,skin:"myres/btn_close.png",height:70}}]}]},{type:"Sprite",props:{y:488,x:942,width:500,pivotY:250,pivotX:250,name:"notitle",height:500},child:[{type:"Image",props:{y:250,x:250,width:500,skin:"myres/pop_bg.png",name:"bg0",height:360,anchorY:.5,anchorX:.5,sizeGrid:"100,100,100,100"},child:[{type:"Image",props:{y:28,x:35,width:57,skin:"myres/pop_texturecut.png",height:304,sizeGrid:"0,0,24,26"}},{type:"Image",props:{y:27,x:472,width:57,skin:"myres/pop_texturecut.png",scaleX:-1,height:304,sizeGrid:"0,0,24,26"}},{type:"Image",props:{y:69,x:33,width:438,skin:"myres/pop_black.png",name:"bar",height:181}}]},{type:"Image",props:{y:250,x:250,width:500,skin:"myres/pop_bound.png",name:"bound",height:360,anchorY:.5,anchorX:.5,sizeGrid:"131,102,97,106"}},{type:"Button",props:{y:360,x:260,width:153,stateNum:1,skin:"myres/btn_small.png",name:"btn",height:65,anchorY:.5,anchorX:.5,sizeGrid:"30,30,30,30"},child:[{type:"Label",props:{y:5,x:12,width:144,valign:"middle",text:"确定",scaleY:.9,scaleX:.9,height:59,fontSize:38,font:"fengyu",color:"#e8af71",align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:103,x:468,width:120,name:"btn_cancel",height:120,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Image",props:{y:24,x:24,width:70,skin:"myres/btn_close.png",height:70}}]},{type:"Label",props:{y:162,x:69,wordWrap:!0,width:368,valign:"middle",text:"用户不存在",name:"text",height:129,fontSize:30,font:"SimHei",color:"#c9c9c9",align:"center"}}]}]},i}(View);t.popwindowUI=i}(e.both_ui||(e.both_ui={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.UICopy",capsui.UICopy),View.regComponent("capsui.CScrollView",capsui.CScrollView),t.prototype.createChildren.call(this),this.createView(e.both_ui.rulesUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Image",props:{y:-30,x:-30,width:2020,skin:"myres/bbg.png",name:"bmask",height:1180,alpha:.3,sizeGrid:"1,1,1,1"},child:[{type:"Button",props:{width:2020,name:"btn",height:1180}},{type:"Sprite",props:{y:48,x:234,width:1498,name:"unhit",height:1044}}]},{type:"Sprite",props:{y:550,x:964,width:1554,pivotY:538,pivotX:789,name:"root",height:1056},child:[{type:"Image",props:{y:6,x:32,width:1498,skin:"myres/pop2_bg.png",name:"bg0",height:1040,sizeGrid:"2,2,2,2"},child:[{type:"Image",props:{y:0,x:0,width:1498,skin:"myres/pop2_bound.png",name:"bound",height:1040,sizeGrid:"24,27,11,21"}}]},{type:"Sprite",props:{y:88,x:56,width:1457,name:"tabs",height:91},child:[{type:"Button",props:{y:7,x:4,width:173,name:"tab_1",height:77},child:[{type:"Image",props:{y:0,x:0,width:173,skin:"myres/bothui/tab_choosed.png",name:"unchoose",height:77}},{type:"Image",props:{y:0,x:0,width:173,skin:"myres/bothui/tab_unchoose.png",name:"choosed",height:77}},{type:"Label",props:{y:10,x:40,width:101,text:"一番",height:43,fontSize:45,font:"fengyu",color:"#e0ab67"}}]},{type:"Button",props:{y:7,x:176,width:173,name:"tab_2",height:77},child:[{type:"Image",props:{y:0,x:0,width:173,skin:"myres/bothui/tab_choosed.png",name:"unchoose",height:77}},{type:"Image",props:{y:0,x:0,width:173,skin:"myres/bothui/tab_unchoose.png",name:"choosed",height:77}},{type:"Label",props:{y:10,x:40,width:101,text:"二番",height:43,fontSize:45,font:"fengyu",color:"#e0ab67"}}]},{type:"Button",props:{y:7,x:348,width:173,name:"tab_3",height:77},child:[{type:"Image",props:{y:0,x:0,width:173,skin:"myres/bothui/tab_choosed.png",name:"unchoose",height:77}},{type:"Image",props:{y:0,x:0,width:173,skin:"myres/bothui/tab_unchoose.png",name:"choosed",height:77}},{type:"Label",props:{y:10,x:40,width:101,text:"三番",height:43,fontSize:45,font:"fengyu",color:"#e0ab67"}}]},{type:"Button",props:{y:7,x:521,width:173,name:"tab_4",height:77},child:[{type:"Image",props:{y:0,x:0,width:173,skin:"myres/bothui/tab_choosed.png",name:"unchoose",height:77}},{type:"Image",props:{y:0,x:0,width:173,skin:"myres/bothui/tab_unchoose.png",name:"choosed",height:77}},{type:"Label",props:{y:10,x:40,width:101,text:"六番",height:43,fontSize:45,font:"fengyu",color:"#e0ab67"}}]},{type:"Button",props:{y:7,x:694,width:173,name:"tab_5",height:77},child:[{type:"Image",props:{y:0,x:0,width:173,skin:"myres/bothui/tab_choosed.png",name:"unchoose",height:77}},{type:"Image",props:{y:0,x:0,width:173,skin:"myres/bothui/tab_unchoose.png",name:"choosed",height:77}},{type:"Label",props:{y:10,x:40,width:101,text:"满贯",height:43,fontSize:45,font:"fengyu",color:"#e0ab67"}}]},{type:"Button",props:{y:7,x:867,width:173,name:"tab_6",height:77},child:[{type:"Image",props:{y:0,x:0,width:173,skin:"myres/bothui/tab_choosed.png",name:"unchoose",height:77}},{type:"Image",props:{y:0,x:0,width:173,skin:"myres/bothui/tab_unchoose.png",name:"choosed",height:77}},{type:"Label",props:{y:10,x:40,width:101,text:"役满",height:43,fontSize:45,font:"fengyu",color:"#e0ab67"}}]},{type:"Button",props:{y:7,x:1039,width:237,name:"tab_7",height:77},child:[{type:"Image",props:{y:0,x:0,width:237,skin:"myres/bothui/tab_choosed.png",name:"unchoose",height:77}},{type:"Image",props:{y:0,x:0,width:237,skin:"myres/bothui/tab_unchoose.png",name:"choosed",height:77}},{type:"Label",props:{y:10,x:31,width:101,text:"双倍役满",height:43,fontSize:45,font:"fengyu",color:"#e0ab67"}}]},{type:"Button",props:{y:7,x:1275,width:173,name:"tab_8",height:77},child:[{type:"Image",props:{y:0,x:0,width:173,skin:"myres/bothui/tab_choosed.png",name:"unchoose",height:77}},{type:"Image",props:{y:0,x:0,width:173,skin:"myres/bothui/tab_unchoose.png",name:"choosed",height:77}},{type:"Label",props:{y:10,x:40,width:89,text:"流局",height:48,fontSize:45,font:"fengyu",color:"#e0ab67"}}]}]},{type:"Sprite",props:{y:196,x:60,width:1445,name:"fans",height:815},child:[{type:"Panel",props:{width:1445,name:"content",height:815},child:[{type:"Image",props:{y:0,x:0,width:1445,skin:"myres/bg_fan_rules.png",name:"templete",height:228},child:[{type:"Label",props:{y:13,x:23,width:291,text:"番名番名番名番",name:"name",height:52,fontSize:38,font:"fengyu",color:"#e0ab67"}},{type:"Label",props:{y:25,x:332,width:905,text:"注释注释注释注释注释注释注释注释注释注释注释注释",name:"decs",height:38,fontSize:32,font:"SimHei",color:"#8995a8",bold:!1}},{type:"Label",props:{y:22,x:1104,width:316,text:"门清限定",name:"limit",height:45,fontSize:38,font:"SimHei",color:"#51f372",align:"right"}},{type:"Sprite",props:{y:89,x:44,width:1278,name:"tiles",height:123},child:[{type:"Image",props:{y:0,x:0,width:68,skin:"myres/0m.png",height:110}},{type:"Image",props:{y:10,x:10,width:68,skin:"myres/0m.png",height:110}},{type:"Image",props:{y:20,x:20,width:68,skin:"myres/0m.png",height:110}},{type:"Image",props:{y:30,x:30,width:68,skin:"myres/0m.png",height:110}},{type:"Image",props:{y:40,x:40,width:68,skin:"myres/0m.png",height:110}},{type:"Image",props:{y:50,x:50,width:68,skin:"myres/0m.png",height:110}},{type:"Image",props:{y:60,x:60,width:68,skin:"myres/0m.png",height:110}},{type:"Image",props:{y:70,x:70,width:68,skin:"myres/0m.png",height:110}},{type:"Image",props:{y:80,x:80,width:68,skin:"myres/0m.png",height:110}},{type:"Image",props:{y:90,x:90,width:68,skin:"myres/0m.png",height:110}},{type:"Image",props:{y:100,x:100,width:68,skin:"myres/0m.png",height:110}},{type:"Image",props:{y:110,x:110,width:68,skin:"myres/0m.png",height:110}},{type:"Image",props:{y:120,x:120,width:68,skin:"myres/0m.png",height:110}},{type:"Image",props:{y:130,x:130,width:68,skin:"myres/0m.png",height:110}},{type:"Image",props:{y:140,x:140,width:68,skin:"myres/0m.png",height:110}},{type:"Image",props:{y:150,x:150,width:68,skin:"myres/0m.png",height:110}},{type:"Image",props:{y:160,x:1068,width:68,skin:"myres/0m.png",height:110}},{type:"Image",props:{y:170,x:1156,width:68,skin:"myres/0m.png",height:110}}]},{type:"Script",props:{runtime:"capsui.UICopy"}}]}]},{type:"Script",props:{runtime:"capsui.CScrollView"}}]}]}]},i}(View);t.rulesUI=i}(e.both_ui||(e.both_ui={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.CButton",capsui.CButton),t.prototype.createChildren.call(this),this.createView(e.both_ui.secondconfirmUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Sprite",props:{y:560,x:960,width:500,pivotY:250,pivotX:250,name:"root",height:500},child:[{type:"Image",props:{y:250,x:250,width:550,skin:"myres/pop2_bg.png",name:"bg0",height:350,anchorY:.5,anchorX:.5,sizeGrid:"2,2,2,2"},child:[{type:"Image",props:{y:0,x:0,width:550,skin:"myres/pop2_bg.png",renderType:"mask",name:"mk",height:350,sizeGrid:"2,2,2,2"}},{type:"Image",props:{y:44,x:-160,width:935,skin:"myres/pop_black.png",name:"bar",height:258}}]},{type:"Image",props:{y:250,x:250,width:550,skin:"myres/pop2_bound.png",name:"bound",height:350,anchorY:.5,anchorX:.5,sizeGrid:"24,27,11,21"}},{type:"Label",props:{y:166,x:65,wordWrap:!0,width:368,text:"确定用99金币购买一之濑琴的琴吗？",name:"desc",height:166,fontSize:40,font:"SimHei",color:"#d6d1d1"}},{type:"Button",props:{y:329,x:144,width:158,stateNum:1,skin:"myres/bothui/btn_confirm.png",name:"btn_confirm",height:67,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:0,x:0,width:161,valign:"middle",text:"确认",height:62,fontSize:40,font:"fengyu",color:"#e7b97a",align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:329,x:339,width:158,stateNum:1,skin:"myres/bothui/btn_confirm.png",name:"btn_cancel",height:67,gray:!0,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:0,x:0,width:161,valign:"middle",text:"取消",height:62,fontSize:40,font:"fengyu",color:"#e7b97a",align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]}]},i}(View);t.secondconfirmUI=i}(e.both_ui||(e.both_ui={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.CButton",capsui.CButton),t.prototype.createChildren.call(this),this.createView(e.common.anotherloginUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Sprite",props:{y:498,x:952,width:500,pivotY:250,pivotX:250,name:"root",height:500},child:[{type:"Image",props:{y:250,x:250,width:500,skin:"myres/pop_bg.png",name:"bg0",height:360,anchorY:.5,anchorX:.5,sizeGrid:"100,100,100,100"},child:[{type:"Image",props:{y:28,x:35,width:57,skin:"myres/pop_texturecut.png",height:304,sizeGrid:"0,0,24,26"}},{type:"Image",props:{y:27,x:472,width:57,skin:"myres/pop_texturecut.png",scaleX:-1,height:304,sizeGrid:"0,0,24,26"}},{type:"Image",props:{y:69,x:33,width:438,skin:"myres/pop_black.png",name:"bar",height:181}}]},{type:"Image",props:{y:250,x:250,width:500,skin:"myres/pop_bound.png",name:"bound",height:360,anchorY:.5,anchorX:.5,sizeGrid:"131,102,97,106"}},{type:"Button",props:{y:360,x:260,width:153,stateNum:1,skin:"myres/btn_small.png",name:"btn",height:65,anchorY:.5,anchorX:.5,sizeGrid:"30,30,30,30"},child:[{type:"Label",props:{y:10,x:18,width:139,valign:"middle",text:"确定",scaleY:.85,scaleX:.85,height:54,fontSize:38,font:"fengyu",color:"#e8af71",align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Label",props:{y:182,x:78,wordWrap:!0,width:369,valign:"middle",text:"您的账号已在另一处登录",name:"text",height:109,fontSize:30,font:"SimHei",color:"#c9c9c9",align:"center"}}]}]},i}(View);t.anotherloginUI=i}(e.common||(e.common={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.CButton",capsui.CButton),t.prototype.createChildren.call(this),this.createView(e.common.closeappUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Sprite",props:{y:560,x:960,width:500,pivotY:250,pivotX:250,name:"root",height:500},child:[{type:"Image",props:{y:250,x:250,width:550,skin:"myres/pop2_bg.png",name:"bg0",height:350,anchorY:.5,anchorX:.5,sizeGrid:"2,2,2,2"},child:[{type:"Image",props:{y:0,x:0,width:550,skin:"myres/pop2_bg.png",renderType:"mask",name:"mk",height:350,sizeGrid:"2,2,2,2"}},{type:"Image",props:{y:44,x:-160,width:935,skin:"myres/pop_black.png",name:"bar",height:258}}]},{type:"Image",props:{y:250,x:250,width:550,skin:"myres/pop2_bound.png",name:"bound",height:350,anchorY:.5,anchorX:.5,sizeGrid:"24,27,11,21"}},{type:"Label",props:{y:166,x:39,wordWrap:!0,width:415,text:"要关闭游戏吗",name:"desc",height:113,fontSize:40,font:"SimHei",color:"#d6d1d1",align:"center"}},{type:"Button",props:{y:329,x:144,width:158,stateNum:1,skin:"myres/bothui/btn_confirm.png",name:"btn_confirm",height:67,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:0,x:0,width:161,valign:"middle",text:"确认",height:62,fontSize:40,font:"fengyu",color:"#e7b97a",align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:329,x:339,width:158,stateNum:1,skin:"myres/bothui/btn_confirm.png",name:"btn_cancel",height:67,gray:!0,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:0,x:0,width:161,valign:"middle",text:"取消",height:62,fontSize:40,font:"fengyu",color:"#e7b97a",align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]}]},i}(View);t.closeappUI=i}(e.common||(e.common={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.createView(e.common.commonUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Sprite",props:{y:1011,x:1,width:250,name:"container_net",height:70},child:[{type:"Label",props:{y:-12,x:10,width:250,text:"麻将服务器：正常",strokeColor:"#000000",stroke:5,name:"mj",height:35,fontSize:20,font:"SimHei",color:"#ffffff"}},{type:"Label",props:{y:14,x:10,width:250,text:"大厅服务器：正常",strokeColor:"#000000",stroke:5,name:"lobby",height:35,fontSize:20,font:"SimHei",color:"#ffffff"}},{type:"Label",props:{y:41,x:10,width:250,text:"fps:30",strokeColor:"#000000",stroke:5,name:"fps",height:35,fontSize:20,font:"SimHei",color:"#ffffff"}}]}]},i}(View);t.commonUI=i}(e.common||(e.common={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.createView(e.common.disconnectUI.uiView)},i.uiView={type:"View",props:{width:1920,mouseThrough:!1,mouseEnabled:!1,height:1080},child:[{type:"Sprite",props:{y:-87,x:-115,width:2136,mouseThrough:!1,mouseEnabled:!0,height:1280}},{type:"Sprite",props:{y:498,x:952,width:500,pivotY:250,pivotX:250,name:"root",height:500},child:[{type:"Image",props:{y:250,x:250,width:500,skin:"myres/pop_bg.png",name:"bg0",height:360,anchorY:.5,anchorX:.5,sizeGrid:"100,100,100,100"},child:[{type:"Image",props:{y:69,x:32,width:443,skin:"myres/pop_black.png",name:"bar",height:181}}]},{type:"Image",props:{y:250,x:250,width:500,skin:"myres/pop_bound.png",name:"bound",height:360,anchorY:.5,anchorX:.5,sizeGrid:"131,102,97,106"}},{type:"Label",props:{y:172,x:92,wordWrap:!0,width:315,valign:"middle",text:"断线了，正在尝试重连",name:"text",height:119,fontSize:30,font:"SimHei",color:"#c9c9c9",align:"center"}},{type:"Label",props:{y:203,x:93,wordWrap:!0,width:315,valign:"middle",text:"...",name:"text_dot",height:119,fontSize:60,font:"SimHei",color:"#c9c9c9",align:"center"}}]}]},i}(View);t.disconnectUI=i}(e.common||(e.common={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.CButton",capsui.CButton),View.regComponent("Script",laya.display.Sprite),t.prototype.createChildren.call(this),this.createView(e.common.errorinfoUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Image",props:{y:-50,x:-48,width:2e3,skin:"myres/bbg.png",name:"blackbg",mouseThrough:!1,height:1200,sizeGrid:"1,1,1,1"}},{type:"Sprite",props:{y:498,x:952,width:500,pivotY:250,pivotX:250,name:"root",height:500},child:[{type:"Image",props:{y:250,x:250,width:500,skin:"myres/pop_bg.png",name:"bg0",height:360,anchorY:.5,anchorX:.5,sizeGrid:"100,100,100,100"},child:[{type:"Image",props:{y:28,x:35,width:57,skin:"myres/pop_texturecut.png",height:304,sizeGrid:"0,0,24,26"}},{type:"Image",props:{y:27,x:472,width:57,skin:"myres/pop_texturecut.png",scaleX:-1,height:304,sizeGrid:"0,0,24,26"}},{type:"Image",props:{y:84,x:33,width:438,skin:"myres/pop_black.png",name:"bar",height:181}}]},{type:"Image",props:{y:250,x:250,width:500,skin:"myres/pop_bound.png",name:"bound",height:360,anchorY:.5,anchorX:.5,sizeGrid:"131,102,97,106"}},{type:"Button",props:{y:105,x:463,stateNum:1,skin:"myres/btn_close.png",name:"btn_cancel",anchorY:.5,anchorX:.5},child:[{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Label",props:{y:160,x:55,wordWrap:!0,width:398,valign:"middle",text:"咦，程序发生了一些错误，请刷新重进游戏",name:"text",height:169,fontSize:30,font:"SimHei",color:"#c9c9c9",align:"center"}},{type:"Button",props:{y:343,x:256,width:158,stateNum:1,skin:"myres/btn_small.png",scaleY:1.2,scaleX:1.2,name:"btn_restart",height:69,anchorY:.5,anchorX:.5,sizeGrid:"30,30,30,30"},child:[{type:"Script",props:{}},{type:"Label",props:{y:0,x:0,width:153,valign:"middle",text:"立即重启",height:64,fontSize:30,font:"SimHei",color:"#f63c39",align:"center"}}]}]}]},i}(View);t.errorinfoUI=i}(e.common||(e.common={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.CButton",capsui.CButton),t.prototype.createChildren.call(this),this.createView(e.common.hangup_logoutUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Sprite",props:{y:500,x:950,width:500,pivotY:250,pivotX:250,name:"root",height:500},child:[{type:"Image",props:{y:250,x:250,width:500,skin:"myres/pop_bg.png",name:"bg0",height:360,anchorY:.5,anchorX:.5,sizeGrid:"100,100,100,100"},child:[{type:"Image",props:{y:28,x:35,width:57,skin:"myres/pop_texturecut.png",height:304,sizeGrid:"0,0,24,26"}},{type:"Image",props:{y:27,x:472,width:57,skin:"myres/pop_texturecut.png",scaleX:-1,height:304,sizeGrid:"0,0,24,26"}},{type:"Image",props:{y:69,x:33,width:438,skin:"myres/pop_black.png",name:"bar",height:181}}]},{type:"Image",props:{y:250,x:250,width:500,skin:"myres/pop_bound.png",name:"bound",height:360,anchorY:.5,anchorX:.5,sizeGrid:"131,102,97,106"}},{type:"Button",props:{y:360,x:260,width:153,stateNum:1,skin:"myres/btn_small.png",name:"btn",height:65,anchorY:.5,anchorX:.5,sizeGrid:"30,30,30,30"},child:[{type:"Label",props:{y:2,x:12,width:132,valign:"middle",text:"确定",height:54,fontSize:38,font:"fengyu",color:"#e8af71",align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Label",props:{y:176,x:78,wordWrap:!0,width:369,valign:"middle",text:"由于您长时间未操作，系统已强制您下线，哼唧｀Д´",name:"text",height:109,fontSize:30,font:"SimHei",color:"#c9c9c9",align:"center"}}]}]},i}(View);t.hangup_logoutUI=i}(e.common||(e.common={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.createView(e.common.loadingUI.uiView)},i.uiView={type:"View",props:{width:1920,mouseThrough:!1,mouseEnabled:!0,height:1080},child:[{type:"Image",props:{y:-438,x:-786,width:3622,skin:"myres/necessary/bbg.png",name:"black",height:2134,sizeGrid:"1,1,1,1"}},{type:"Image",props:{y:450,x:960,skin:"myres/necessary/flower_nei.png",scaleY:1.2,scaleX:1.2,rotation:0,name:"flower",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:0,x:0,skin:"myres/necessary/flower_shine.png",name:"shine",alpha:1}},{type:"Image",props:{y:56,x:56,skin:"myres/necessary/round.png",name:"round",anchorY:.5,anchorX:.5}},{type:"Image",props:{y:156,x:61,skin:"myres/necessary/load_lobby.png",name:"loading",anchorY:.5,anchorX:.5}},{type:"Image",props:{y:143,x:-69,skin:"myres/necessary/waitforother.png",name:"waitother"},child:[{type:"Label",props:{y:0,x:203,width:55,text:"3",name:"count0",height:28,fontSize:27,font:"SimHei",color:"#00ea00"}},{type:"Label",props:{y:0,x:217,width:55,text:"/",height:28,fontSize:27,font:"SimHei",color:"#ffffff"}},{type:"Label",props:{y:0,x:231,width:55,text:"4",name:"count1",height:28,fontSize:27,font:"SimHei",color:"#ffffff"}}]}]},{type:"Label",props:{y:739,x:960,wordWrap:!0,width:1461,text:"缩卵毁一生",name:"tips",height:155,fontSize:30,font:"SimHei",color:"#b3d7dd",anchorX:.5,align:"center"}},{type:"Image",props:{y:700,x:960,width:30,skin:"myres/necessary/linesplit_flower.png",height:30,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:15,x:-5,width:600,skin:"myres/necessary/linesplit.png",height:30,anchorY:.5,anchorX:1}},{type:"Image",props:{y:15,x:35,width:600,skin:"myres/necessary/linesplit.png",scaleX:-1,height:30,anchorY:.5,anchorX:1}}]},{type:"Image",props:{y:640,x:960,width:867,skin:"myres/necessary/loading_bg.png",scaleY:1.2,scaleX:1.2,name:"progress",height:23,anchorY:.5,anchorX:.5},child:[{type:"Sprite",props:{width:867,name:"bar",height:23},child:[{type:"Image",props:{y:0,x:0,width:867,skin:"myres/necessary/loading.png",height:23}},{type:"Image",props:{y:0,x:0,width:300,skin:"myres/necessary/bbg.png",renderType:"mask",name:"mask",height:23,sizeGrid:"1,1,1,1"}},{type:"Image",props:{y:0,x:300,skin:"myres/necessary/loading_status.png",name:"head",anchorX:1},child:[{type:"Label",props:{y:0,x:-89,width:135,valign:"middle",text:"60%",name:"v",height:24,fontSize:23,font:"SimHei",color:"#191931",bold:!0,align:"right"}}]}]}]}]},i}(View);t.loadingUI=i}(e.common||(e.common={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.createView(e.common.preventaddictionUI.uiView)},i.uiView={type:"View",props:{width:1920,mouseThrough:!0,height:1080},child:[{type:"Image",props:{y:310,x:719,width:522,skin:"myres/wbg.png",name:"container_tips",height:373,sizeGrid:"1,1,1,1"},child:[{type:"Label",props:{y:57,x:65,wordWrap:!0,width:407,text:"您已经进入疲劳游戏时间，您的游戏收益将降为正常值的50%，为了您的健康，请尽快下线休息，做适当身体活动，合理安排学习生活。",name:"l2",height:220,fontSize:30,font:"SimHei",color:"#555353"}},{type:"Label",props:{y:57,x:65,wordWrap:!0,width:407,text:"您已进入不健康游戏时间，为了您的健康，请您立即下线休息。如不下线，您的身体将受到损害，您的收益已降为零，直到您的累计下线时间满5小时后，才能恢复正常",name:"l1",height:220,fontSize:30,font:"SimHei",color:"#555353"}},{type:"Label",props:{y:103,x:65,wordWrap:!0,width:407,text:"您累计在线时间已满N小时",name:"l0",height:174,fontSize:30,font:"SimHei",color:"#555353",align:"center"}},{type:"Button",props:{y:281,x:172,width:180,skin:"myres/btn.png",name:"btn",height:50},child:[{type:"Label",props:{y:9,x:0,width:178,text:"好的，谢谢你",height:40,fontSize:25,color:"#ffffff",align:"center"}}]}]},{type:"Image",props:{y:256,x:4,width:158,skin:"myres/wbg.png",name:"container_time",height:67,sizeGrid:"1,1,1,1"},child:[{type:"Label",props:{y:5,x:1,wordWrap:!0,width:153,text:"累计在线时间",name:"l2",height:36,fontSize:25,font:"SimHei",color:"#555353"}},{type:"Label",props:{y:33,x:2,wordWrap:!0,width:153,text:"03:21",name:"time",height:36,fontSize:25,font:"SimHei",color:"#555353",align:"center"}}]}]},i}(View);t.preventaddictionUI=i}(e.common||(e.common={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.CButton",capsui.CButton),t.prototype.createChildren.call(this),this.createView(e.common.reconnectUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Image",props:{y:520,x:900,width:600,skin:"myres/pop_bg.png",name:"bg0",height:440,anchorY:.5,anchorX:.5,sizeGrid:"100,100,100,100"},child:[{type:"Image",props:{y:28,x:31,width:57,skin:"myres/pop_texturecut.png",height:384,sizeGrid:"0,0,24,26"}},{type:"Image",props:{y:30,x:573,width:57,skin:"myres/pop_texturecut.png",scaleX:-1,height:384,sizeGrid:"0,0,24,26"}},{type:"Image",props:{y:110,x:33,width:541,skin:"myres/pop_black.png",name:"bar",height:207}}]},{type:"Image",props:{y:520,x:900,width:600,skin:"myres/pop_bound.png",name:"bound",height:440,anchorY:.5,anchorX:.5,sizeGrid:"131,102,97,106"}},{type:"Label",props:{y:432,x:669,wordWrap:!0,width:466,valign:"middle",text:"您有一场正在进行的比赛",name:"title",height:164,fontSize:41,font:"SimHei",color:"#e8af71",align:"center"}},{type:"Button",props:{y:663,x:900,width:153,stateNum:1,skin:"myres/btn_small.png",name:"btn_ok",height:65,anchorY:.5,anchorX:.5,sizeGrid:"30,30,30,30"},child:[{type:"Label",props:{y:5,x:12,width:143,valign:"middle",text:"重连",scaleY:.9,scaleX:.9,height:60,fontSize:38,font:"fengyu",color:"#e8af71",align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]},i}(View);t.reconnectUI=i}(e.common||(e.common={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.createView(e.common.rollnoticeUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Sprite",props:{y:73,x:556,width:777,name:"root",height:62},child:[{type:"Image",props:{y:3,x:13,width:765,skin:"myres/bg_inform.png",name:"bg",height:54}},{type:"Panel",props:{y:3,x:13,width:660,name:"content",height:54},child:[{type:"Label",props:{y:12,x:772,width:1141,text:"服务器即将维护，请做好下线准备，服务器即将",name:"label",height:33,fontSize:30,font:"SimHei",color:"#ffcc30"}}]}]}]},i}(View);t.rollnoticeUI=i}(e.common||(e.common={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.CButton",capsui.CButton),t.prototype.createChildren.call(this),this.createView(e.common.shimingrenzhengUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Sprite",props:{y:556,x:982,width:1200,pivotY:450,pivotX:600,name:"root",height:900},child:[{type:"Sprite",props:{y:6,x:8,width:1184,name:"bg",height:888},child:[{type:"Image",props:{y:413,x:590,width:1064,skin:"myres/necessary/pop2_bg.png",height:580,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:124,x:60,width:1060,skin:"myres/necessary/pop2_bound.png",name:"bound",height:578,sizeGrid:"7,8,7,7"}},{type:"Label",props:{y:153,x:152,width:827,text:"实名认证",height:41,fontSize:45,font:"SimHei",color:"#e7b070",align:"center"}}]},{type:"Button",props:{y:637,x:585,width:261,stateNum:1,skin:"myres/necessary/btn_small.png",name:"btn",height:91,anchorY:.5,anchorX:.5,sizeGrid:"15,20,15,20"},child:[{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Label",props:{y:24,x:9,width:243,text:"认证",height:41,fontSize:40,font:"SimHei",color:"#e7b070",align:"center"}}]},{type:"Label",props:{y:242,x:111,wordWrap:!0,width:995,text:"亲爱的用户，根据《网络游戏管理暂行办法》的相关要求，游戏前请先进行实名认证。",height:343,fontSize:26,font:"SimHei",color:"#aaaaaa"}},{type:"Label",props:{y:289,x:111,wordWrap:!0,width:995,text:"1.身份证信息只能提交一次，不能随意修改，请慎重填写。",height:343,fontSize:26,font:"SimHei",color:"#aaaaaa"}},{type:"Label",props:{y:336,x:111,wordWrap:!0,width:995,text:"2.该信息仅用于实名注册，不会泄露于任何第三方。",height:343,fontSize:26,font:"SimHei",color:"#aaaaaa"}},{type:"Image",props:{y:390,x:268,width:678,skin:"myres/inputbox.png",name:"input_name",height:65,sizeGrid:"7,12,10,9"},child:[{type:"TextInput",props:{y:-5,x:-5,width:689,valign:"middle",promptColor:"#888787",prompt:"输入真实姓名",padding:"10,20,10,20",name:"txtinput",maxChars:20,height:74,fontSize:33,font:"SimHei",color:"#d0cdcd",align:"left"}}]},{type:"Image",props:{y:486,x:268,width:678,skin:"myres/inputbox.png",name:"input_id",height:65,sizeGrid:"7,12,10,9"},child:[{type:"TextInput",props:{y:-5,x:-5,width:689,valign:"middle",promptColor:"#888787",prompt:"输入身份证号",padding:"10,20,10,20",name:"txtinput",maxChars:20,height:74,fontSize:33,font:"SimHei",color:"#d0cdcd",align:"left"}}]},{type:"Button",props:{y:170,x:1084,width:80,name:"btn_close",height:80,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:19,x:18,skin:"myres/pop2_close.png"}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]}]},i}(View);t.shimingrenzhengUI=i}(e.common||(e.common={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.CButton",capsui.CButton),t.prototype.createChildren.call(this),this.createView(e.common.user_xieyiUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Sprite",props:{y:540,x:960,width:1200,pivotY:450,pivotX:600,name:"root",height:900},child:[{type:"Sprite",props:{y:6,x:8,width:1184,name:"bg",height:888},child:[{type:"Image",props:{y:444,x:592,width:1400,skin:"myres/necessary/pop2_bg.png",height:950,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:444,x:594,width:1400,skin:"myres/necessary/pop2_bound.png",name:"bound",height:950,anchorY:.5,anchorX:.5,sizeGrid:"7,8,7,7"}},{type:"Label",props:{y:3,x:182,width:827,text:"用户协议",height:41,fontSize:45,font:"SimHei",color:"#e7b070",align:"center"}}]},{type:"Button",props:{y:851,x:620,width:261,stateNum:1,skin:"myres/necessary/btn_small.png",name:"btn",height:91,anchorY:.5,anchorX:.5,sizeGrid:"15,20,15,20"},child:[{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Label",props:{y:24,x:9,width:243,text:"接受条款",height:41,fontSize:40,font:"SimHei",color:"#e7b070",align:"center"}}]},{type:"Label",props:{y:87,x:-33,wordWrap:!0,width:1283,text:"12312313",name:"info",height:695,fontSize:28,font:"SimHei",color:"#ffffff"}},{type:"Button",props:{y:859,x:310,width:261,pivotY:39,pivotX:131,name:"left",height:91},child:[{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Label",props:{y:24,x:9,width:243,text:"上一页",height:41,fontSize:25,font:"SimHei",color:"#ffffff",align:"center"}}]},{type:"Button",props:{y:859,x:918,width:261,pivotY:39,pivotX:131,name:"right",height:91},child:[{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Label",props:{y:24,x:9,width:243,text:"下一页",height:41,fontSize:25,font:"SimHei",color:"#ffffff",align:"center"}}]}]}]},i}(View);t.user_xieyiUI=i}(e.common||(e.common={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.CButton",capsui.CButton),t.prototype.createChildren.call(this),this.createView(e.entrance.apptestinfoUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Sprite",props:{y:540,x:960,width:600,pivotY:215,pivotX:300,name:"root",height:430},child:[{type:"Sprite",props:{y:0,x:0,width:600,name:"bg",height:430},child:[{type:"Image",props:{width:600,skin:"myres/necessary/pop2_bg.png",height:430}},{type:"Image",props:{width:600,skin:"myres/necessary/pop2_bound.png",name:"bound",height:430,sizeGrid:"7,8,7,7"}}]},{type:"Button",props:{y:371,x:305,width:223,stateNum:1,skin:"myres/necessary/btn_small.png",name:"btn",height:65,anchorY:.5,anchorX:.5,sizeGrid:"15,20,15,20"},child:[{type:"Label",props:{y:8,x:14,width:216,valign:"middle",text:"赞美昆西",scaleY:.9,scaleX:.9,height:54,fontSize:38,font:"fengyu",color:"#e8af71",align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Label",props:{y:57,x:68,wordWrap:!0,width:488,valign:"middle",text:"欢迎成为“雀魂”App测试尝鲜版首批测试小天使",name:"text",height:59,fontSize:26,font:"SimHei",color:"#c9c9c9",align:"left"}},{type:"Label",props:{y:111,x:68,wordWrap:!0,width:477,valign:"middle",text:"反馈问题请加Q群：819145775",name:"text",height:59,fontSize:26,font:"SimHei",color:"#c9c9c9",align:"left"}},{type:"Label",props:{y:149,x:68,wordWrap:!0,width:488,valign:"middle",text:"测试版本暂不支持微信、QQ登录，请知悉",name:"text",height:68,fontSize:26,font:"SimHei",color:"#c9c9c9",align:"left"}},{type:"Label",props:{y:245,x:68,wordWrap:!0,width:488,valign:"middle",text:"特别鸣谢昆西哲在雀魂没有APP的日子里用自制APK给许多玩家提供了帮助",name:"text",height:68,fontSize:26,font:"SimHei",color:"#c9c9c9",align:"left"}}]}]},i}(View);t.apptestinfoUI=i}(e.entrance||(e.entrance={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.UICopy",capsui.UICopy),View.regComponent("capsui.CScrollView",capsui.CScrollView),t.prototype.createChildren.call(this),this.createView(e.entrance.chooseserverUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Sprite",props:{y:555,x:905,width:500,scaleY:1.5,scaleX:1.5,pivotY:250,pivotX:250,name:"root",height:500},child:[{type:"Image",props:{y:0,x:0,width:500,skin:"myres/entrance/pop2_bg.png",height:500}},{type:"Image",props:{y:0,x:0,width:500,skin:"myres/entrance/pop2_bound.png",name:"bound",height:500}},{type:"Label",props:{y:21,x:0,width:500,text:"选择服务器",height:55,fontSize:45,font:"fengyu",color:"#e7b070",align:"center"}},{type:"Image",props:{y:97,x:46,width:400,skin:"myres/singlecolor_0.png",name:"lst",height:372},child:[{type:"Panel",props:{y:5,x:24,width:350,name:"content",height:362},child:[{type:"Button",props:{y:0,x:0,width:350,name:"templete",labelSize:35,labelFont:"SimHei",labelAlign:"center",label:"21",height:50},child:[{type:"Script",props:{y:0,x:0,runtime:"capsui.UICopy"}}]}]},{type:"Script",props:{runtime:"capsui.CScrollView"}}]}]}]},i}(View);t.chooseserverUI=i}(e.entrance||(e.entrance={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.CButton",capsui.CButton),t.prototype.createChildren.call(this),this.createView(e.entrance.entranceUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Sprite",props:{y:0,x:0,width:1920,name:"scene",height:1080}},{type:"Sprite",props:{y:465,x:226,width:1556,name:"root",height:472},child:[{type:"Image",props:{y:360,x:313,width:294,skin:"myres/entrance/bg_room.png",name:"extendinfo",height:64},child:[{type:"Label",props:{y:0,x:0,width:296,valign:"middle",text:"好友房：332221",name:"info",height:63,fontSize:40,font:"youyuan",color:"#cdad7e",align:"center"}}]},{type:"Label",props:{y:576,x:1568,width:115,name:"version",height:41,fontSize:24,color:"#8f8f8f",align:"right"}},{type:"Sprite",props:{y:89,x:1262,width:621,rotation:0,pivotY:286,pivotX:302,name:"container_login",height:597},child:[{type:"Button",props:{y:301,x:240,width:399,stateNum:1,skin:"myres/entrance/login.png",name:"btn_enter",height:95,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Sprite",props:{y:24,x:41,width:396,name:"container_account",height:86},child:[{type:"Image",props:{y:0,x:0,width:395,skin:"myres/entrance/bg_textinput.png",height:85}},{type:"TextInput",props:{y:10,x:8,width:376,restrict:"a-zA-Z0-9_",promptColor:"#ffffff",name:"txtinput",maxChars:16,height:72,fontSize:40,font:"SimHei",color:"#ffffff"}},{type:"Label",props:{y:24,x:16,width:181,text:"账号(字母、数字)",scaleY:.85,scaleX:.85,name:"lb",height:51,fontSize:40,font:"youyuan",color:"#ffffff",bold:!1}}]},{type:"Sprite",props:{y:139,x:41,width:407,name:"container_mima",height:89},child:[{type:"Image",props:{y:0,x:0,width:395,skin:"myres/entrance/bg_textinput.png",height:87}},{type:"TextInput",props:{y:12,x:8,width:378,type:"password",promptColor:"#ffffff",name:"txtinput",maxChars:20,height:72,fontSize:40,font:"SimHei",color:"#ffffff"}},{type:"Label",props:{y:24,x:16,width:137,text:"密码",scaleY:.85,scaleX:.85,name:"lb",height:65,fontSize:40,font:"youyuan",color:"#ffffff",bold:!1}}]},{type:"Sprite",props:{y:388,x:30,width:439,name:"social",height:174},child:[{type:"Label",props:{y:10,x:114,width:187,text:"社交账号登录",scaleY:.85,scaleX:.85,height:41,fontSize:29,font:"youyuan",color:"#fafafa"}},{type:"Button",props:{y:108,x:55,width:100,name:"btn_weibo",height:100,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:12,x:9,width:78,skin:"myres/entrance/weibo.png",height:78}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:108,x:209,width:100,name:"btn_qq",height:100,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:12,x:10,width:78,skin:"myres/entrance/QQ.png",height:78}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:108,x:367,width:100,name:"btn_weixin",height:100,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:12,x:11,width:78,skin:"myres/entrance/weixin.png",height:78}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]},{type:"Button",props:{y:70,x:525,width:186,pivotY:41,pivotX:77,name:"btn_regist",height:78},child:[{type:"Label",props:{y:20,x:15,width:143,underline:!0,text:"立即注册",scaleY:.85,scaleX:.85,name:"signup",height:44,fontSize:32,font:"youyuan",color:"#7294f2",bold:!1}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:182,x:528,width:186,visible:!1,pivotY:41,pivotX:77,name:"btn_forgetpassword",height:78},child:[{type:"Label",props:{y:22,x:15,width:143,text:"忘记密码",scaleY:.85,scaleX:.85,name:"foget",height:44,fontSize:32,font:"youyuan",color:"#d12e31"}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]},{type:"Label",props:{y:576,x:-226,width:1920,visible:!1,text:"推荐使用Chrome浏览器",name:"healthy",height:41,fontSize:27,color:"#8f8f8f",align:"center"}},{type:"Sprite",props:{y:-143,x:1091,width:254,name:"loading_login",height:267},child:[{type:"Image",props:{y:148,x:117,width:219,skin:"myres/necessary/round.png",scaleY:1.2,scaleX:1.2,name:"round",height:219,anchorY:.5,anchorX:.5}},{type:"Label",props:{y:165,x:28,width:186,text:"登入中",name:"word",height:73,fontSize:50,font:"SimHei",color:"#a6f69f",align:"center"}},{type:"Image",props:{y:74,x:76,width:78,skin:"myres/entrance/weibo.png",name:"icon",height:78}}]}]},{type:"Sprite",props:{width:1920,name:"page_regist",mouseThrough:!1,height:1080},child:[{type:"Sprite",props:{y:542,x:902,width:589,pivotY:412,pivotX:303,name:"content",height:801},child:[{type:"Sprite",props:{y:6,x:8,width:582,name:"bg",height:807},child:[{type:"Image",props:{y:5,x:2,width:566,skin:"myres/necessary/pop2_bg.png",height:783}},{type:"Image",props:{y:5,x:2,width:566,skin:"myres/necessary/pop2_bound.png",name:"bound",height:783,sizeGrid:"7,8,7,7"}},{type:"Label",props:{y:31,x:193,width:207,text:"注册账号",height:41,fontSize:45,font:"fengyu",color:"#e7b070"}}]},{type:"Sprite",props:{y:476,x:89,width:439,name:"social",height:174},child:[{type:"Label",props:{y:10,x:110,width:242,text:"社交账号注册",scaleY:.8,scaleX:.8,height:41,fontSize:29,font:"youyuan",color:"#fafafa"}},{type:"Button",props:{y:109,x:52,width:100,name:"btn_weibo",height:100,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:11,x:12,width:78,skin:"myres/entrance/weibo.png",height:78}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:109,x:208,width:100,name:"btn_qq",height:100,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:11,x:11,width:78,skin:"myres/entrance/QQ.png",height:78}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:109,x:367,width:100,name:"btn_weixin",height:100,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:11,x:11,width:78,skin:"myres/entrance/weixin.png",height:78}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]},{type:"Button",props:{y:47,x:51,width:70,pivotY:31,pivotX:34,name:"btn_close",height:74},child:[{type:"Image",props:{y:7,x:3,width:62,skin:"myres/entrance/return.png",height:49}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:710,x:295,width:356,stateNum:1,skin:"myres/entrance/regis.png",name:"btn_regist",height:91,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Sprite",props:{y:125,x:64,width:467,name:"container_account",height:89},child:[{type:"Image",props:{width:459,skin:"myres/entrance/bg_textinput.png",height:87}},{type:"TextInput",props:{y:12,x:8,width:439,restrict:"a-zA-Z0-9_",promptColor:"#ffffff",name:"txtinput",maxChars:16,height:72,fontSize:40,font:"SimHei",color:"#ffffff"}},{type:"Label",props:{y:24,x:15,width:236,text:"账号(字母、数字)",scaleY:.85,scaleX:.85,name:"lb",height:65,fontSize:33,font:"youyuan",color:"#ffffff",bold:!1,align:"left"}},{type:"Label",props:{y:26,x:350,width:115,text:"不可用",scaleY:.85,scaleX:.85,name:"no",height:35,fontSize:31,font:"youyuan",color:"#d12e30",bold:!1}},{type:"Label",props:{y:26,x:350,width:115,text:"可使用",scaleY:.85,scaleX:.85,name:"yes",height:35,fontSize:31,font:"youyuan",color:"#509859",bold:!1}}]},{type:"Sprite",props:{y:222,x:64,width:458,name:"container_mima",height:89},child:[{type:"Image",props:{width:459,skin:"myres/entrance/bg_textinput.png",height:87}},{type:"TextInput",props:{y:12,x:8,width:440,type:"password",text:"1213123123",promptColor:"#ffffff",name:"txtinput",maxChars:20,height:72,fontSize:40,font:"SimHei",color:"#ffffff",align:"left"}},{type:"Label",props:{y:24,x:15,width:338,text:"密码(6-20字符)",scaleY:.85,scaleX:.85,name:"lb",height:52,fontSize:33,font:"youyuan",color:"#ffffff",bold:!1,align:"left"}},{type:"Image",props:{y:30,x:409,skin:"myres/entrance/×.png",name:"no"}},{type:"Image",props:{y:30,x:409,skin:"myres/entrance/√.png",scaleY:1.2,scaleX:1.2,name:"yes"}}]},{type:"Sprite",props:{y:319,x:64,width:462,name:"container_mima2",height:89},child:[{type:"Image",props:{width:459,skin:"myres/entrance/bg_textinput.png",height:87}},{type:"Label",props:{y:24,x:15,width:289,text:"请再次输入密码",scaleY:.85,scaleX:.85,name:"lb",height:65,fontSize:33,font:"youyuan",color:"#ffffff",bold:!1,align:"left"}},{type:"TextInput",props:{y:12,x:8,width:440,type:"password",promptColor:"#ffffff",name:"txtinput",maxChars:20,height:72,fontSize:40,font:"SimHei",color:"#ffffff"}},{type:"Image",props:{y:27,x:411,skin:"myres/entrance/×.png",name:"no"}},{type:"Image",props:{y:27,x:411,skin:"myres/entrance/√.png",scaleY:1.2,scaleX:1.2,name:"yes"}}]},{type:"Sprite",props:{y:421,x:65,width:144,scaleY:.7,scaleX:.7,name:"checkbox",height:47},child:[{type:"Button",props:{y:-17,x:76,width:425,name:"btn_lock",height:78}},{type:"Image",props:{y:1,x:11,width:44,skin:"myres/entrance/checkbox.png",name:"check",height:43}},{type:"Image",props:{y:1,x:11,width:44,skin:"myres/entrance/check.png",name:"checkbox",height:43}},{type:"Label",props:{y:6,x:61,width:527,underline:!0,text:"《雀魂麻将许可及服务协议》",scaleY:.8,scaleX:.8,height:41,fontSize:42,font:"SimHei",color:"#88bcc6"}},{type:"Button",props:{y:24,x:33,width:82,name:"btn_check",height:82,anchorY:.5,anchorX:.5}}]}]}]},{type:"Sprite",props:{y:0,x:0,width:1920,name:"regist_connecting",height:1080},child:[{type:"Sprite",props:{y:284,x:765,width:254,name:"loading",height:267},child:[{type:"Image",props:{y:148,x:117,width:219,skin:"myres/necessary/round.png",scaleY:1.2,scaleX:1.2,name:"round",height:219,anchorY:.5,anchorX:.5}},{type:"Label",props:{y:102,x:13,wordWrap:!0,width:206,text:"正在连接服务器",name:"word",height:112,fontSize:45,font:"SimHei",color:"#a6f69f",align:"center"}}]}]},{type:"Sprite",props:{y:0,x:0,width:1920,name:"maintenance",mouseThrough:!1,height:1080},child:[{type:"Sprite",props:{y:497,x:889,width:500,pivotY:250,pivotX:250,name:"container",height:500},child:[{type:"Image",props:{y:250,x:250,width:500,skin:"myres/necessary/pop2_bg.png",name:"bg0",height:400,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:250,x:250,width:500,skin:"myres/necessary/pop2_bound.png",name:"bound",height:400,anchorY:.5,anchorX:.5,sizeGrid:"7,8,7,7"}},{type:"Button",props:{y:405,x:249,width:153,stateNum:1,skin:"myres/necessary/btn_small.png",name:"btn",height:65,anchorY:.5,anchorX:.5,sizeGrid:"15,20,15,20"},child:[{type:"Label",props:{y:2,x:12,width:132,valign:"middle",text:"好的",height:54,fontSize:38,font:"fengyu",color:"#e8af71",align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Label",props:{y:86,x:69,wordWrap:!0,width:372,valign:"middle",text:"雀魂正在维护中\\n请大家稍等\\n休息一下",name:"text",height:277,fontSize:30,font:"SimHei",color:"#c9c9c9",align:"left"}}]}]},{type:"Sprite",props:{y:0,x:0,width:1920,name:"error",mouseThrough:!1,height:1080},child:[{type:"Sprite",props:{y:544,x:889,width:500,pivotY:250,pivotX:250,name:"container",height:500},child:[{type:"Image",props:{y:250,x:250,width:400,skin:"myres/necessary/pop2_bg.png",name:"bg0",height:280,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:250,x:250,width:400,skin:"myres/necessary/pop2_bound.png",name:"bound",height:280,anchorY:.5,anchorX:.5,sizeGrid:"7,8,7,7"}},{type:"Button",props:{y:341,x:249,width:153,stateNum:1,skin:"myres/necessary/btn_small.png",name:"btn",height:65,anchorY:.5,anchorX:.5,sizeGrid:"15,20,15,20"},child:[{type:"Label",props:{y:2,x:12,width:132,valign:"middle",text:"确定",height:54,fontSize:38,font:"fengyu",color:"#e8af71",align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Label",props:{y:174,x:99,wordWrap:!0,width:297,valign:"middle",text:"用户不存在",name:"text",height:129,fontSize:30,font:"SimHei",color:"#c9c9c9",align:"center"}}]}]},{type:"Sprite",props:{y:0,x:0,width:1920,name:"Prohibition",mouseThrough:!1,height:1080},child:[{type:"Sprite",props:{y:544,x:892,width:500,pivotY:250,pivotX:250,name:"container",height:500},child:[{type:"Image",props:{y:250,x:250,width:570,skin:"myres/necessary/pop2_bg.png",name:"bg0",height:420,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:250,x:250,width:570,skin:"myres/necessary/pop2_bound.png",name:"bound",height:420,anchorY:.5,anchorX:.5,sizeGrid:"7,8,7,7"}},{type:"Button",props:{y:404,x:253,width:153,stateNum:1,skin:"myres/necessary/btn_small.png",name:"btn",height:65,anchorY:.5,anchorX:.5,sizeGrid:"15,20,15,20"},child:[{type:"Label",props:{y:2,x:12,width:132,valign:"middle",text:"确定",height:54,fontSize:38,font:"fengyu",color:"#e8af71",align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Label",props:{y:219,x:251,wordWrap:!0,width:512,valign:"middle",text:"你的账号因为违反相关游戏规定被封禁",name:"text",leading:10,height:283,fontSize:30,font:"SimHei",color:"#c9c9c9",anchorY:.5,anchorX:.5,align:"left"}}]}]},{type:"Sprite",props:{name:"infos"},child:[{type:"Label",props:{y:996,x:280,width:1392,text:"健康游戏公告：抵制不良游戏，拒绝盗版游戏，注意自我保护，谨防上当受骗，适度游戏益脑，沉迷游戏伤身，合理安排时间，享受健康生活。",height:34,fontSize:20,font:"SimHei",color:"#909090",align:"center"}},{type:"Label",props:{y:1050,x:247,width:545,text:"网络文化经营许可证：苏网文【2016】4138-100号",height:34,fontSize:20,font:"SimHei",color:"#909090",align:"left"}},{type:"Label",props:{y:1050,x:755,width:507,text:"增值电信业务经营许可证：苏B2-20160442",height:34,fontSize:20,font:"SimHei",color:"#909090",align:"left"}},{type:"Label",props:{y:1050,x:1149,width:507,text:"网络游戏出版物号（ISBN）:ISBN978-7-498-04890-5",height:34,fontSize:20,font:"SimHei",color:"#909090",align:"left"}},{type:"Image",props:{y:1046,x:694,skin:"myres/entrance/wen.jpg",scaleY:.25,scaleX:.25}},{type:"Button",props:{y:1035,x:687,width:50,name:"btn",height:50}},{type:"Label",props:{y:1023,x:600,width:507,text:"本网络游戏适合17+岁的用户使用；为了您的健康，请合理控制游戏时间。",height:34,fontSize:20,font:"SimHei",color:"#909090",align:"left"}}]}]},i}(View);t.entranceUI=i}(e.entrance||(e.entrance={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.createView(e.entrance.ios_webview_updateUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Sprite",props:{y:540,x:960,width:600,pivotY:215,pivotX:300,name:"root",height:430},child:[{type:"Sprite",props:{y:0,x:0,width:600,name:"bg",height:430},child:[{type:"Image",props:{width:600,skin:"myres/necessary/pop2_bg.png",height:430}},{type:"Image",props:{width:600,skin:"myres/necessary/pop2_bound.png",name:"bound",height:430,sizeGrid:"7,8,7,7"}}]},{type:"Label",props:{y:57,x:68,wordWrap:!0,width:488,valign:"middle",text:"iOS版本有新的更新，请前去官网下载。",name:"text",leading:10,height:301,fontSize:26,font:"SimHei",color:"#c9c9c9",align:"left"}}]}]},i}(View);t.ios_webview_updateUI=i}(e.entrance||(e.entrance={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.createView(e.entrance.remindUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Label",props:{y:403,x:831,width:175,visible:!1,text:"健康游戏公告",name:"healthy",height:41,fontSize:38,font:"SimHei",color:"#e5e5e5",bold:!0},child:[{type:"Label",props:{y:87,x:-81,width:175,text:"抵制不良游戏，拒绝盗版游戏",name:"healthy",height:41,fontSize:30,font:"SimHei",color:"#e5e5e5",bold:!1}},{type:"Label",props:{y:137,x:-81,width:175,text:"注意自我保护，谨防上当受骗",name:"healthy",height:41,fontSize:30,font:"SimHei",color:"#e5e5e5",bold:!1}},{type:"Label",props:{y:187,x:-81,width:175,text:"适度游戏益脑，沉迷游戏伤身",name:"healthy",height:41,fontSize:30,font:"SimHei",color:"#e5e5e5",bold:!1}},{type:"Label",props:{y:237,x:-81,width:175,text:"合理安排时间，享受健康生活",name:"healthy",height:41,fontSize:30,font:"SimHei",color:"#e5e5e5",bold:!1}}]},{type:"Label",props:{y:482,x:801,width:333,visible:!0,text:"区区 立直棒 就送给你了",name:"healthy",height:41,fontSize:38,font:"SimHei",color:"#e5e5e5",bold:!0},compId:7},{type:"Label",props:{y:482,x:901,width:120,visible:!0,text:"——--",name:"line",height:41,fontSize:38,font:"SimHei",color:"#c11422",bold:!0},compId:13},{type:"Label",props:{y:441,x:871,width:112,visible:!0,text:"满贯",rotation:-9,name:"info",height:41,fontSize:38,font:"SimHei",color:"#56aeea",bold:!0},compId:15},{type:"Label",props:{y:527,x:974,width:112,visible:!1,text:"跳满",rotation:8,name:"info",height:41,fontSize:38,font:"SimHei",color:"#de56ea",bold:!0},compId:14},{type:"Label",props:{y:410,x:980,width:112,visible:!0,text:"倍满",rotation:6,name:"info",height:41,fontSize:38,font:"SimHei",color:"#eaa256",bold:!0},compId:16},{type:"Label",props:{y:539,x:915,wordWrap:!0,width:96,visible:!0,text:"役满",name:"info",height:84,fontSize:38,font:"SimHei",color:"#e23a7d",bold:!0},compId:17},{type:"Label",props:{y:1048,x:1796,width:113,text:"2/10",name:"process",height:29,fontSize:20,font:"SimHei",color:"#787474",align:"right"}}],animations:[{nodes:[{target:7,keyframes:{alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:7,key:"alpha",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:7,key:"alpha",index:1}]}},{target:13,keyframes:{scaleX:[{value:1,tweenMethod:"linearNone",tween:!0,target:13,key:"scaleX",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:13,key:"scaleX",index:12},{value:1,tweenMethod:"linearNone",tween:!0,target:13,key:"scaleX",index:18}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:13,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:13,key:"alpha",index:11},{value:1,tweenMethod:"linearNone",tween:!0,target:13,key:"alpha",index:12}]}},{target:15,keyframes:{alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:15,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:15,key:"alpha",index:26},{value:1,tweenMethod:"linearNone",tween:!0,target:15,key:"alpha",index:27}]}},{target:14,keyframes:{alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:14,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:14,key:"alpha",index:37},{value:1,tweenMethod:"linearNone",tween:!0,target:14,key:"alpha",index:41}]}},{target:16,keyframes:{alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:16,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:16,key:"alpha",index:34},{value:1,tweenMethod:"linearNone",tween:!0,target:16,key:"alpha",index:35}]}},{target:17,keyframes:{alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:17,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:17,key:"alpha",index:46},{value:1,tweenMethod:"linearNone",tween:!0,target:17,key:"alpha",index:47}]}}],name:"ani1",id:1,frameRate:24,action:1}]},i}(View);t.remindUI=i}(e.entrance||(e.entrance={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.CButton",capsui.CButton),View.regComponent("capsui.UICopy",capsui.UICopy),View.regComponent("capsui.CScrollView",capsui.CScrollView),t.prototype.createChildren.call(this),this.createView(e.lobby.activityUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Sprite",props:{y:544,x:965,width:1703,pivotY:540,pivotX:850,name:"root",height:1080},child:[{type:"Image",props:{y:15,x:12,width:1682,skin:"myres/lobby/act_bg.png",name:"bg",height:1028}},{type:"Sprite",props:{y:60,x:531,width:646,name:"tabs",height:91},child:[{type:"Button",props:{y:50,x:225,width:216,pivotY:48,pivotX:113,name:"tab0",height:93},child:[{type:"Image",props:{y:6,x:50,skin:"myres/lobby/act_bright.png",scaleY:1.2,scaleX:1.2,name:"img"}}]},{type:"Button",props:{y:50,x:446,width:216,pivotY:48,pivotX:113,name:"tab1",height:93},child:[{type:"Image",props:{y:8,x:48,skin:"myres/lobby/mail_bright.png",scaleY:1.2,scaleX:1.2,name:"img"}},{type:"Image",props:{y:25,x:156,width:50,skin:"myres/lobby/redpoint.png",name:"redpoint",height:50}}]}]},{type:"Button",props:{y:178,x:1646,width:125,name:"btn_close",height:125,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:16,x:19,skin:"myres/lobby/act_close.png",scaleY:1.2,scaleX:1.2,name:"close"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Sprite",props:{y:0,x:0,width:1710,name:"page_mail",mouseThrough:!0,height:1057},child:[{type:"Sprite",props:{y:196,x:136,width:331,name:"left",height:766},child:[{type:"Panel",props:{y:0,x:0,width:331,name:"content",height:766},child:[{type:"Button",props:{y:0,x:0,width:333,name:"templete",height:128},child:[{type:"Image",props:{y:0,x:0,width:336,skin:"myres/lobby/act_choosed.png",name:"bg",height:128}},{type:"Label",props:{y:67,x:90,wordWrap:!0,width:222,valign:"middle",text:"公告标题公告公告标题公告",name:"title",leading:5,height:90,fontSize:34,font:"SimHei",color:"#f0d29b",bold:!1,anchorY:.5}},{type:"Image",props:{y:28,x:29,skin:"myres/lobby/read_yes.png",scaleY:1.2,scaleX:1.2,name:"state"}},{type:"Script",props:{runtime:"capsui.UICopy"}}]}]},{type:"Script",props:{runtime:"capsui.CScrollView"}}]},{type:"Sprite",props:{y:189,x:510,width:1048,name:"right",height:789},child:[{type:"Label",props:{y:42,x:517,wordWrap:!0,width:685,valign:"middle",text:"显示不下就显示两行雀魂麻将更新公告此处有很多个字",name:"title",height:101,fontSize:38,font:"SimHei",color:"#eac18b",bold:!0,anchorX:.5,align:"center"}},{type:"Label",props:{y:175,x:516,wordWrap:!0,width:822,text:"正文正文正文正正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文文正文正文正文",name:"content",leading:5,height:346,fontSize:28,font:"SimHei",color:"#c0ccec",anchorX:.5}},{type:"Button",props:{y:754,x:487,width:196,name:"btn_get",height:92,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:6,x:10,skin:"myres/lobby/act_btn0.png",scaleY:1.2,scaleX:1.2,name:"btn0",sizeGrid:"23,27,28,29"},child:[{type:"Label",props:{y:10,x:37,width:104,text:"领取",height:43,fontSize:35,font:"fengyu",color:"#1c0522"}}]},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:754,x:487,width:196,name:"btn_del",height:92,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:6,x:10,skin:"myres/lobby/act_btn1.png",scaleY:1.2,scaleX:1.2,name:"btn1",sizeGrid:"17,27,24,29"},child:[{type:"Label",props:{y:10,x:37,width:83,text:"删除",height:43,fontSize:35,font:"fengyu",color:"#1c0522"}}]},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Panel",props:{y:527,x:99,width:900,name:"container_item",height:168},child:[{type:"Sprite",props:{y:10,x:12,width:114,name:"item",height:114},child:[{type:"Button",props:{y:57,x:57,width:120,name:"btn",height:120,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:7,x:7,width:106,skin:"extendRes/items/coin0.jpg",name:"icon",height:106}},{type:"Image",props:{y:3,x:3,width:114,skin:"myres/kuangbound.png",name:"bound",height:114,sizeGrid:"18,20,12,12"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Label",props:{y:117,x:5,width:115,text:"999999",name:"count",height:36,fontSize:36,font:"SimHei",color:"#e5ba78",align:"center"}},{type:"Image",props:{y:39,x:14,skin:"myres/lobby/collected.png",name:"getted"}}]},{type:"Sprite",props:{y:20,x:22,width:114,name:"item",height:114},child:[{type:"Button",props:{y:57,x:57,width:120,name:"btn",height:120,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:7,x:7,width:106,skin:"extendRes/items/coin0.jpg",name:"icon",height:106}},{type:"Image",props:{y:3,x:3,width:114,skin:"myres/kuangbound.png",name:"bound",height:114,sizeGrid:"18,20,12,12"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Label",props:{y:117,x:5,width:115,text:"999999",name:"count",height:36,fontSize:36,font:"SimHei",color:"#e5ba78",align:"center"}},{type:"Image",props:{y:39,x:14,skin:"myres/lobby/collected.png",name:"getted"}}]},{type:"Sprite",props:{y:30,x:32,width:114,name:"item",height:114},child:[{type:"Button",props:{y:57,x:57,width:120,name:"btn",height:120,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:7,x:7,width:106,skin:"extendRes/items/coin0.jpg",name:"icon",height:106}},{type:"Image",props:{y:3,x:3,width:114,skin:"myres/kuangbound.png",name:"bound",height:114,sizeGrid:"18,20,12,12"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Label",props:{y:117,x:5,width:115,text:"999999",name:"count",height:36,fontSize:36,font:"SimHei",color:"#e5ba78",align:"center"}},{type:"Image",props:{y:39,x:14,skin:"myres/lobby/collected.png",name:"getted"}}]},{type:"Sprite",props:{y:40,x:42,width:114,name:"item",height:114},child:[{type:"Button",props:{y:57,x:57,width:120,name:"btn",height:120,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:7,x:7,width:106,skin:"extendRes/items/coin0.jpg",name:"icon",height:106}},{type:"Image",props:{y:3,x:3,width:114,skin:"myres/kuangbound.png",name:"bound",height:114,sizeGrid:"18,20,12,12"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Label",props:{y:117,x:5,width:115,text:"999999",name:"count",height:36,fontSize:36,font:"SimHei",color:"#e5ba78",align:"center"}},{type:"Image",props:{y:39,x:14,skin:"myres/lobby/collected.png",name:"getted"}}]},{type:"Sprite",props:{y:50,x:52,width:114,name:"item",height:114},child:[{type:"Button",props:{y:57,x:57,width:120,name:"btn",height:120,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:7,x:7,width:106,skin:"extendRes/items/coin0.jpg",name:"icon",height:106}},{type:"Image",props:{y:3,x:3,width:114,skin:"myres/kuangbound.png",name:"bound",height:114,sizeGrid:"18,20,12,12"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Label",props:{y:117,x:5,width:115,text:"999999",name:"count",height:36,fontSize:36,font:"SimHei",color:"#e5ba78",align:"center"}},{type:"Image",props:{y:39,x:14,skin:"myres/lobby/collected.png",name:"getted"}}]},{type:"Sprite",props:{y:60,x:62,width:114,name:"item",height:114},child:[{type:"Button",props:{y:57,x:57,width:120,name:"btn",height:120,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:7,x:7,width:106,skin:"extendRes/items/coin0.jpg",name:"icon",height:106}},{type:"Image",props:{y:3,x:3,width:114,skin:"myres/kuangbound.png",name:"bound",height:114,sizeGrid:"18,20,12,12"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Label",props:{y:117,x:5,width:115,text:"999999",name:"count",height:36,fontSize:36,font:"SimHei",color:"#e5ba78",align:"center"}},{type:"Image",props:{y:39,x:14,skin:"myres/lobby/collected.png",name:"getted"}}]},{type:"Sprite",props:{y:70,x:72,width:114,name:"item",height:114},child:[{type:"Button",props:{y:57,x:57,width:120,name:"btn",height:120,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:7,x:7,width:106,skin:"extendRes/items/coin0.jpg",name:"icon",height:106}},{type:"Image",props:{y:3,x:3,width:114,skin:"myres/kuangbound.png",name:"bound",height:114,sizeGrid:"18,20,12,12"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Label",props:{y:117,x:5,width:115,text:"999999",name:"count",height:36,fontSize:36,font:"SimHei",color:"#e5ba78",align:"center"}},{type:"Image",props:{y:39,x:14,skin:"myres/lobby/collected.png",name:"getted"}}]},{type:"Sprite",props:{y:80,x:82,width:114,name:"item",height:114},child:[{type:"Button",props:{y:57,x:57,width:120,name:"btn",height:120,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:7,x:7,width:106,skin:"extendRes/items/coin0.jpg",name:"icon",height:106}},{type:"Image",props:{y:3,x:3,width:114,skin:"myres/kuangbound.png",name:"bound",height:114,sizeGrid:"18,20,12,12"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Label",props:{y:117,x:5,width:115,text:"999999",name:"count",height:36,fontSize:36,font:"SimHei",color:"#e5ba78",align:"center"}},{type:"Image",props:{y:39,x:14,skin:"myres/lobby/collected.png",name:"getted"}}]}]}]},{type:"Label",props:{y:216,x:224,wordWrap:!0,width:167,text:"暂无邮件",name:"nomail",height:66,fontSize:36,font:"YouYuan",color:"#eac18b"}}]},{type:"Sprite",props:{width:1710,name:"page_huodong",mouseThrough:!0,height:1057},child:[{type:"Panel",props:{y:196,x:532,width:981,name:"right",height:760}},{type:"Sprite",props:{y:196,x:136,name:"left"},child:[{type:"Panel",props:{y:0,x:0,width:331,name:"content",height:766},child:[{type:"Button",props:{y:0,x:0,width:333,name:"templete",height:128},child:[{type:"Image",props:{y:0,x:0,width:336,skin:"myres/lobby/act_unchoosen.png",name:"bg",height:128}},{type:"Label",props:{y:26,x:16,wordWrap:!0,width:294,valign:"middle",text:"悬赏任务",name:"title",height:79,fontSize:35,font:"SimHei",color:"#f0d29b",bold:!1,align:"center"}},{type:"Script",props:{runtime:"capsui.UICopy"}}]}]},{type:"Script",props:{y:-196,x:-136,runtime:"capsui.CScrollView"}}]},{type:"Label",props:{y:236,x:209,wordWrap:!0,width:167,text:"暂无活动",name:"notask",height:66,fontSize:36,font:"YouYuan",color:"#eac18b",bold:!0}}]}]}]},i}(View);t.activityUI=i}(e.lobby||(e.lobby={}))}(ui||(ui={})),function(e){!function(t){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.createView(e.lobby.activitys.activitybaseUI.uiView)},i.uiView={type:"View",props:{width:981,height:760},child:[{type:"Sprite",props:{width:981,name:"root",height:760},child:[{type:"Image",props:{y:2,x:3,width:975,skin:"myres/lobby/invitepic.jpg",height:325}},{type:"Label",props:{y:365,x:12,width:380,text:"复制链接发给您的好友！",height:53,fontSize:35,font:"SimHei",color:"#ffb84e"}},{type:"Label",props:{y:435,x:12,width:380,text:"您的邀请链接：",height:53,fontSize:35,font:"SimHei",color:"#ffb84e"}},{type:"Image",props:{y:420,x:250,width:706,skin:"myres/inputbox.png",name:"input",height:63,sizeGrid:"7,12,10,9"},child:[{type:"TextInput",props:{y:7,x:3,width:459,valign:"middle",promptColor:"#d0cdcd",name:"txtinput",height:70,fontSize:50,font:"haolong",color:"#d0cdcd",align:"center"}}]},{type:"Sprite",props:{y:505,x:11},child:[{type:"Image",props:{y:9,x:3,width:948,skin:"myres/lobby/bottom.png",height:139}},{type:"Image",props:{y:20,x:22,width:114,skin:"myres/kuangbound.png",name:"item_0",height:114,sizeGrid:"18,20,12,12"},child:[{type:"Label",props:{y:40,x:124,width:115,text:"×999999",height:36,fontSize:36,font:"SimHei",color:"#e5ba78"}}]},{type:"Label",props:{y:31,x:323,wordWrap:!0,width:424,valign:"middle",text:"邀请你的好基友加入游戏将获得丰厚的奖励",name:"dec",height:95,fontSize:32,font:"SimHei",color:"#c0cbeb",align:"left"}},{type:"Label",props:{y:59,x:795,width:121,text:"已领取",name:"collect",height:40,fontSize:35,font:"SimHei",color:"#0eee24"},child:[{type:"Image",props:{y:-15,x:-13,skin:"myres/lobby/collect.png",scaleY:1.2,scaleX:1.2}}]},{type:"Label",props:{y:53,x:826,width:121,text:"2",name:"progress",height:40,fontSize:45,font:"SimHei",color:"#0eee24",bold:!0},child:[{type:"Label",props:{y:8,x:26,text:"/3",fontSize:35,font:"SimHei",color:"#c0cbeb",bold:!0}}]}]}]}]},i}(View);t.activitybaseUI=i}(t.activitys||(t.activitys={}))}(e.lobby||(e.lobby={}))}(ui||(ui={})),function(e){!function(t){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.CButton",capsui.CButton),t.prototype.createChildren.call(this),this.createView(e.lobby.activitys.activity_jiujiUI.uiView)},i.uiView={type:"View",props:{width:981,height:760},child:[{type:"Sprite",props:{width:981,name:"root",height:760},child:[{type:"Label",props:{y:54,x:373,width:217,text:"复活币",name:"title",fontSize:36,font:"SimHei",color:"#ebc18d",align:"center"}},{type:"Sprite",props:{y:498,x:13,width:952,name:"task",height:182},child:[{type:"Image",props:{y:0,x:2,width:946,skin:"myres/lobby/bg_rules.png",name:"bg",height:171}},{type:"Sprite",props:{y:0,x:0,width:946,name:"info",height:171},child:[{type:"Image",props:{y:9,x:11,width:150,skin:"myres/kuangbg.png",height:150,sizeGrid:"7,7,8,7"}},{type:"Image",props:{y:9,x:11,width:149,skin:"extendRes/items/coin0.jpg",name:"item",height:150}},{type:"Image",props:{y:9,x:11,width:149,skin:"myres/kuangbound.png",height:150,sizeGrid:"18,20,12,12"}},{type:"Label",props:{y:76,x:186,text:"铜钱",name:"item_name",fontSize:32,font:"SimHei",color:"#e7b879"}},{type:"Label",props:{y:17,x:184,width:638,text:"复活币",name:"requirement",height:30,fontSize:30,font:"SimHei",color:"#bcc9e7"}},{type:"Label",props:{y:76,x:261,width:113,text:"120",name:"item_count",height:35,fontSize:35,font:"SimHei",color:"#e7b879",align:"right"}},{type:"Label",props:{y:79,x:382,text:"枚",fontSize:28,font:"SimHei",color:"#e7b879"}},{type:"Image",props:{y:60,x:169,width:756,skin:"myres/line.png",name:"line",height:4}},{type:"Image",props:{y:81,x:786,width:143,skin:"myres/lobby/collect_no.png",name:"noget",height:72}},{type:"Button",props:{y:117,x:855,width:154,name:"btn_get",height:90,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:9,x:9,width:138,skin:"myres/lobby/collect.png",height:67}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Label",props:{y:98,x:800,width:121,text:"已领取",name:"alreadyget",height:40,fontSize:35,font:"SimHei",color:"#0eee24"}}]}]},{type:"Label",props:{y:147,x:26,wordWrap:!0,width:929,text:"内容内容内容内容",name:"desc",height:325,fontSize:34,font:"SimHei",color:"#bcc9e7"}}]}]},i}(View);t.activity_jiujiUI=i}(t.activitys||(t.activitys={}))}(e.lobby||(e.lobby={}))}(ui||(ui={})),function(e){!function(t){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.CButton",capsui.CButton),t.prototype.createChildren.call(this),this.createView(e.lobby.activitys.activity_xuanshangUI.uiView)},i.uiView={type:"View",props:{width:981,height:760},child:[{type:"Sprite",props:{y:0,x:0,width:980,name:"root",height:760},child:[{type:"Label",props:{y:66,x:24,text:"悬赏任务每天更新一个",fontSize:34,font:"SimHei",color:"#bcc9e7"}},{type:"Label",props:{y:66,x:705,text:"每日凌晨5点更新",fontSize:34,font:"SimHei",color:"#bcc9e7"}},{type:"Sprite",props:{y:134,x:20,width:952,name:"task0",height:182},child:[{type:"Image",props:{y:0,x:2,width:946,skin:"myres/lobby/bg_rules.png",name:"bg",height:171}},{type:"Sprite",props:{name:"info"},child:[{type:"Image",props:{y:84,x:86,width:142,skin:"myres/kuangbg.png",height:142,anchorY:.5,anchorX:.5,sizeGrid:"7,7,8,7"}},{type:"Image",props:{y:84,x:86,width:142,skin:"extendRes/items/coin0.jpg",name:"item",height:142,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:9,x:11,width:149,skin:"myres/kuangbound.png",height:150,sizeGrid:"18,20,12,12"}},{type:"Label",props:{y:76,x:186,text:"铜钱",name:"item_name",fontSize:32,font:"SimHei",color:"#e7b879"}},{type:"Label",props:{y:17,x:184,width:638,text:"在一般场进行2次对局",name:"requirement",height:30,fontSize:30,font:"SimHei",color:"#bcc9e7"}},{type:"Label",props:{y:76,x:261,width:113,text:"120",name:"item_count",height:35,fontSize:35,font:"SimHei",color:"#e7b879",align:"right"}},{type:"Label",props:{y:79,x:382,text:"枚",fontSize:28,font:"SimHei",color:"#e7b879"}},{type:"Image",props:{y:127,x:187,width:277,skin:"myres/progress_bg.png",name:"bar",height:26},child:[{type:"Image",props:{y:0,x:0,width:277,skin:"myres/progress.png",scaleX:.2,name:"val",height:26}}]},{type:"Label",props:{y:125,x:475,width:133,text:"0/2",name:"progress",height:28,fontSize:28,font:"SimHei",color:"#bcc9e7"}},{type:"Image",props:{y:60,x:169,width:756,skin:"myres/line.png",name:"line",height:4}},{type:"Button",props:{y:121,x:853,width:154,name:"btn_change",height:77,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:4,x:9,skin:"myres/lobby/change.png",scaleY:1.2,scaleX:1.2}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]}]},{type:"Sprite",props:{y:334,x:20,width:952,name:"task1",height:182},child:[{type:"Image",props:{y:0,x:2,width:946,skin:"myres/lobby/bg_rules.png",name:"bg",height:171}},{type:"Sprite",props:{name:"info"},child:[{type:"Image",props:{y:84,x:86,width:142,skin:"myres/kuangbg.png",height:142,anchorY:.5,anchorX:.5,sizeGrid:"7,7,8,7"}},{type:"Image",props:{y:84,x:86,width:142,skin:"extendRes/items/coin0.jpg",name:"item",height:142,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:9,x:11,width:149,skin:"myres/kuangbound.png",height:150,sizeGrid:"18,20,12,12"}},{type:"Label",props:{y:76,x:186,text:"铜钱",name:"item_name",fontSize:32,font:"SimHei",color:"#e7b879"}},{type:"Label",props:{y:17,x:184,width:638,text:"在一般场进行2次对局",name:"requirement",height:30,fontSize:30,font:"SimHei",color:"#bcc9e7"}},{type:"Label",props:{y:76,x:261,width:113,text:"120",name:"item_count",height:35,fontSize:35,font:"SimHei",color:"#e7b879",align:"right"}},{type:"Label",props:{y:79,x:382,text:"枚",fontSize:28,font:"SimHei",color:"#e7b879"}},{type:"Image",props:{y:127,x:187,width:277,skin:"myres/progress_bg.png",name:"bar",height:26},child:[{type:"Image",props:{y:0,x:0,width:277,skin:"myres/progress.png",scaleX:.2,name:"val",height:26}}]},{type:"Label",props:{y:125,x:475,width:133,text:"0/2",name:"progress",height:28,fontSize:28,font:"SimHei",color:"#bcc9e7"}},{type:"Image",props:{y:60,x:169,width:756,skin:"myres/line.png",name:"line",height:4}},{type:"Button",props:{y:121,x:853,width:154,name:"btn_change",height:77,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:4,x:9,skin:"myres/lobby/change.png",scaleY:1.2,scaleX:1.2}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]}]},{type:"Sprite",props:{y:534,x:20,width:952,name:"task2",height:182},child:[{type:"Image",props:{y:0,x:2,width:946,skin:"myres/lobby/bg_rules.png",name:"bg",height:171}},{type:"Sprite",props:{name:"info"},child:[{type:"Image",props:{y:84,x:86,width:142,skin:"myres/kuangbg.png",height:142,anchorY:.5,anchorX:.5,sizeGrid:"7,7,8,7"}},{type:"Image",props:{y:84,x:86,width:142,skin:"extendRes/items/coin0.jpg",name:"item",height:142,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:9,x:11,width:149,skin:"myres/kuangbound.png",height:150,sizeGrid:"18,20,12,12"}},{type:"Label",props:{y:76,x:186,text:"铜钱",name:"item_name",fontSize:32,font:"SimHei",color:"#e7b879"}},{type:"Label",props:{y:17,x:184,width:638,text:"在一般场进行2次对局",name:"requirement",height:30,fontSize:30,font:"SimHei",color:"#bcc9e7"}},{type:"Label",props:{y:76,x:261,width:113,text:"120",name:"item_count",height:35,fontSize:35,font:"SimHei",color:"#e7b879",align:"right"}},{type:"Label",props:{y:79,x:382,text:"枚",fontSize:28,font:"SimHei",color:"#e7b879"}},{type:"Image",props:{y:127,x:187,width:277,skin:"myres/progress_bg.png",name:"bar",height:26},child:[{type:"Image",props:{y:0,x:0,width:277,skin:"myres/progress.png",scaleX:.2,name:"val",height:26}}]},{type:"Label",props:{y:125,x:475,width:133,text:"0/2",name:"progress",height:28,fontSize:28,font:"SimHei",color:"#bcc9e7"}},{type:"Image",props:{y:60,x:169,width:756,skin:"myres/line.png",name:"line",height:4}},{type:"Button",props:{y:121,x:853,width:154,name:"btn_change",height:77,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:4,x:9,skin:"myres/lobby/change.png",scaleY:1.2,scaleX:1.2}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]}]}]}]},i}(View);t.activity_xuanshangUI=i}(t.activitys||(t.activitys={}))}(e.lobby||(e.lobby={}))}(ui||(ui={})),function(e){!function(t){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.createView(e.lobby.activitys.signUI.uiView)},i.uiView={type:"View",props:{width:981,height:760},child:[{type:"Image",props:{y:-224,x:-656,width:1920,skin:"设计稿/【主界面签到的内容直接搬过来，显示进度】.jpg",height:1080}},{type:"Image",props:{width:981,skin:"myres/bbg.png",height:761,sizeGrid:"1,1,1,1"}},{type:"Sprite",props:{y:0,x:0,width:981,name:"root",height:760}},{type:"Button",props:{y:61,x:20,width:288,stateNum:1,skin:"myres/lobby/sign_bg1.png",name:"day1",height:216},child:[{type:"Image",props:{y:43,x:73,width:144,skin:"myres/lobby/collected.png",height:113}},{type:"Image",props:{y:1,x:1,width:109,skin:"myres/lobby/sign_day.png",height:66}},{type:"Image",props:{y:24,x:73,width:138,skin:"myres/kuangbound.png",name:"item_0",height:138,sizeGrid:"18,20,12,12"},child:[{type:"Label",props:{y:106,x:53,width:79,text:"999999",height:24,fontSize:25,font:"SimHei",color:"#e2dcd3",align:"right"}},{type:"Label",props:{y:142,x:-44,width:360,text:"超级巧克力",scaleY:.65,scaleX:.65,name:"name",height:50,font:"fengyu",color:"#f6ecec",align:"center"}}]},{type:"Label",props:{y:34,x:-2,text:"第一天",scaleY:.58,scaleX:.58,rotation:-30,font:"fengyu",color:"#e6ba7a",align:"center"}}]},{type:"Button",props:{y:61,x:330,width:288,stateNum:1,skin:"myres/lobby/sign_bg1.png",name:"day2",height:216},child:[{type:"Image",props:{y:43,x:73,width:144,skin:"myres/lobby/collected.png",height:113}},{type:"Image",props:{y:1,x:1,width:109,skin:"myres/lobby/sign_day.png",height:66}},{type:"Image",props:{y:24,x:73,width:138,skin:"myres/kuangbound.png",name:"item_0",height:138,sizeGrid:"18,20,12,12"},child:[{type:"Label",props:{y:106,x:53,width:79,text:"999999",height:24,fontSize:25,font:"SimHei",color:"#e2dcd3",align:"right"}},{type:"Label",props:{y:142,x:-44,width:360,text:"超级巧克力",scaleY:.65,scaleX:.65,name:"name",height:50,font:"fengyu",color:"#f6ecec",align:"center"}}]},{type:"Label",props:{y:34,x:-2,text:"第二天",scaleY:.58,scaleX:.58,rotation:-30,font:"fengyu",color:"#e6ba7a",align:"center"}}]},{type:"Button",props:{y:61,x:642,width:288,stateNum:1,skin:"myres/lobby/sign_bg1.png",name:"day3",height:216},child:[{type:"Image",props:{y:43,x:73,width:144,skin:"myres/lobby/collected.png",height:113}},{type:"Image",props:{y:1,x:1,width:109,skin:"myres/lobby/sign_day.png",height:66}},{type:"Image",props:{y:24,x:73,width:138,skin:"myres/kuangbound.png",name:"item_0",height:138,sizeGrid:"18,20,12,12"},child:[{type:"Label",props:{y:106,x:53,width:79,text:"999999",height:24,fontSize:25,font:"SimHei",color:"#e2dcd3",align:"right"}},{type:"Label",props:{y:142,x:-44,width:360,text:"超级巧克力",scaleY:.65,scaleX:.65,name:"name",height:50,font:"fengyu",color:"#f6ecec",align:"center"}}]},{type:"Label",props:{y:34,x:-2,text:"第三天",scaleY:.58,scaleX:.58,rotation:-30,font:"fengyu",color:"#e6ba7a",align:"center"}}]},{type:"Button",props:{y:295,x:20,width:288,stateNum:1,skin:"myres/lobby/sign_bg1.png",name:"day4",height:216},child:[{type:"Image",props:{y:43,x:73,width:144,skin:"myres/lobby/collected.png",height:113}},{type:"Image",props:{y:1,x:1,width:109,skin:"myres/lobby/sign_day.png",height:66}},{type:"Image",props:{y:24,x:73,width:138,skin:"myres/kuangbound.png",name:"item_0",height:138,sizeGrid:"18,20,12,12"},child:[{type:"Label",props:{y:106,x:53,width:79,text:"999999",height:24,fontSize:25,font:"SimHei",color:"#e2dcd3",align:"right"}},{type:"Label",props:{y:142,x:-44,width:360,text:"超级巧克力",scaleY:.65,scaleX:.65,name:"name",height:50,font:"fengyu",color:"#f6ecec",align:"center"}}]},{type:"Label",props:{y:34,x:-2,text:"第四天",scaleY:.58,scaleX:.58,rotation:-30,font:"fengyu",color:"#e6ba7a",align:"center"}}]},{type:"Button",props:{y:295,x:330,width:288,stateNum:1,skin:"myres/lobby/sign_bg1.png",name:"day5",height:216},child:[{type:"Image",props:{y:43,x:73,width:144,skin:"myres/lobby/collected.png",height:113}},{type:"Image",props:{y:1,x:1,width:109,skin:"myres/lobby/sign_day.png",height:66}},{type:"Image",props:{y:24,x:73,width:138,skin:"myres/kuangbound.png",name:"item_0",height:138,sizeGrid:"18,20,12,12"},child:[{type:"Label",props:{y:106,x:53,width:79,text:"999999",height:24,fontSize:25,font:"SimHei",color:"#e2dcd3",align:"right"}},{type:"Label",props:{y:142,x:-44,width:360,text:"超级巧克力",scaleY:.65,scaleX:.65,name:"name",height:50,font:"fengyu",color:"#f6ecec",align:"center"}}]},{type:"Label",props:{y:34,x:-2,text:"第五天",scaleY:.58,scaleX:.58,rotation:-30,font:"fengyu",color:"#e6ba7a",align:"center"}}]},{type:"Button",props:{y:295,x:642,width:288,stateNum:1,skin:"myres/lobby/sign_bg1.png",name:"day6",height:216},child:[{type:"Image",props:{y:43,x:73,width:144,skin:"myres/lobby/collected.png",height:113}},{type:"Image",props:{y:1,x:1,width:109,skin:"myres/lobby/sign_day.png",height:66}},{type:"Image",props:{y:24,x:73,width:138,skin:"myres/kuangbound.png",name:"item_0",height:138,sizeGrid:"18,20,12,12"},child:[{type:"Label",props:{y:106,x:53,width:79,text:"999999",height:24,fontSize:25,font:"SimHei",color:"#e2dcd3",align:"right"}},{type:"Label",props:{y:142,x:-44,width:360,text:"超级巧克力",scaleY:.65,scaleX:.65,name:"name",height:50,font:"fengyu",color:"#f6ecec",align:"center"}}]},{type:"Label",props:{y:34,x:-2,text:"第六天",scaleY:.58,scaleX:.58,rotation:-30,font:"fengyu",color:"#e6ba7a",align:"center"}}]},{type:"Button",props:{y:532,x:330,width:288,stateNum:1,skin:"myres/lobby/sign_bg2.png",name:"day7",height:216},child:[{type:"Image",props:{y:43,x:73,width:144,skin:"myres/lobby/collected.png",height:113}},{type:"Image",props:{y:1,x:1,width:109,skin:"myres/lobby/sign_day.png",height:66}},{type:"Image",props:{y:24,x:73,width:138,skin:"myres/kuangbound.png",name:"item_0",height:138,sizeGrid:"18,20,12,12"},child:[{type:"Label",props:{y:106,x:53,width:79,text:"999999",height:24,fontSize:25,font:"SimHei",color:"#e2dcd3",align:"right"}},{type:"Label",props:{y:142,x:-44,width:360,text:"超级巧克力",scaleY:.65,scaleX:.65,name:"name",height:50,font:"fengyu",color:"#f6ecec",align:"center"}}]},{type:"Label",props:{y:34,x:-2,text:"第七天",scaleY:.58,scaleX:.58,rotation:-30,font:"fengyu",color:"#e6ba7a",align:"center"}}]},{type:"Label",props:{y:14,x:409,width:172,text:"每日祈福",scaleY:.8,scaleX:.8,name:"title",height:45,font:"youyuan_bold",color:"#e9c18a"}}]},i}(View);t.signUI=i}(t.activitys||(t.activitys={}))}(e.lobby||(e.lobby={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.CButton",capsui.CButton),t.prototype.createChildren.call(this),this.createView(e.lobby.add_roomUI.uiView)},i.uiView={type:"View",props:{x:0,width:1920,height:1080,anchorX:0},child:[{type:"Sprite",props:{y:548,x:864,width:813,pivotY:300,pivotX:400,name:"root",height:687},child:[{type:"Image",props:{y:318,x:407,width:788,skin:"myres/pop_bg.png",name:"bg0",height:767,anchorY:.5,anchorX:.5,sizeGrid:"100,100,100,100"},child:[{type:"Image",props:{y:28,x:32,width:98,skin:"myres/pop_texturecut.png",name:"left",height:714,sizeGrid:"0,0,24,26"}},{type:"Image",props:{y:27,x:762,width:110,skin:"myres/pop_texturecut.png",scaleX:-1,name:"right",height:715,sizeGrid:"0,0,24,26"}},{type:"Image",props:{y:38,x:34,width:730,skin:"myres/pop_black.png",name:"bar",height:73}},{type:"Image",props:{y:118,x:35,width:726,skin:"myres/pop_black.png",name:"bar",height:602}}]},{type:"Image",props:{y:318,x:407,width:788,skin:"myres/pop_bound.png",name:"bound",height:767,anchorY:.5,anchorX:.5,sizeGrid:"131,102,97,106"}},{type:"Label",props:{y:-31,x:319,width:165,valign:"middle",text:"加入房间",name:"title",height:76,fontSize:45,font:"fengyu",color:"#e8af71",align:"center"}},{type:"Button",props:{y:606,x:407,width:181,stateNum:1,skin:"myres/btn_small.png",name:"btn_confirm",height:77,anchorY:.5,anchorX:.5,sizeGrid:"30,30,30,30"},child:[{type:"Label",props:{y:5,x:9,width:163,valign:"middle",text:"确定",height:66,fontSize:48,font:"fengyu",color:"#e8af71",align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Image",props:{y:75,x:173,width:456,skin:"myres/inputbox.png",name:"input",height:80,sizeGrid:"7,12,10,9"},child:[{type:"TextInput",props:{y:7,x:3,width:459,valign:"middle",promptColor:"#d0cdcd",name:"txtinput",maxChars:10,height:70,fontSize:50,font:"haolong",color:"#d0cdcd",align:"center"}}]},{type:"Button",props:{y:-30,x:758,width:113,pivotY:50,pivotX:53,name:"btn_cancel",height:111},child:[{type:"Image",props:{y:-1,x:3,width:96,skin:"myres/btn_close.png",height:96}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Sprite",props:{y:147,x:102,width:577,name:"numpad",height:388},child:[{type:"Image",props:{y:32,x:53,width:162,skin:"myres/lobby/num.png",name:"n1",height:84,sizeGrid:"19,22,21,20"},child:[{type:"Image",props:{y:0,x:0,width:162,skin:"myres/lobby/num_pressed.png",name:"s",height:84}},{type:"Label",props:{y:14,x:68,width:36,text:"1",height:52,fontSize:55,font:"SimHei",color:"#a0a2aa",bold:!0}}]},{type:"Image",props:{y:32,x:220,width:162,skin:"myres/lobby/num.png",name:"n2",height:84,sizeGrid:"19,22,21,20"},child:[{type:"Image",props:{y:0,x:0,width:162,skin:"myres/lobby/num_pressed.png",name:"s",height:84}},{type:"Label",props:{y:14,x:68,width:36,text:"2",height:52,fontSize:55,font:"SimHei",color:"#a0a2aa",bold:!0}}]},{type:"Image",props:{y:32,x:386,width:162,skin:"myres/lobby/num.png",name:"n3",height:84,sizeGrid:"19,22,21,20"},child:[{type:"Image",props:{y:0,x:0,width:162,skin:"myres/lobby/num_pressed.png",name:"s",height:84}},{type:"Label",props:{y:14,x:68,width:36,text:"3",height:52,fontSize:55,font:"SimHei",color:"#a0a2aa",bold:!0}}]},{type:"Image",props:{y:121,x:53,width:162,skin:"myres/lobby/num.png",name:"n4",height:84,sizeGrid:"19,22,21,20"},child:[{type:"Image",props:{y:0,x:0,width:162,skin:"myres/lobby/num_pressed.png",name:"s",height:84}},{type:"Label",props:{y:14,x:68,width:36,text:"4",height:52,fontSize:55,font:"SimHei",color:"#a0a2aa",bold:!0}}]},{type:"Image",props:{y:121,x:220,width:162,skin:"myres/lobby/num.png",name:"n5",height:84,sizeGrid:"19,22,21,20"},child:[{type:"Image",props:{y:0,x:0,width:162,skin:"myres/lobby/num_pressed.png",name:"s",height:84}},{type:"Label",props:{y:14,x:68,width:36,text:"5",height:52,fontSize:55,font:"SimHei",color:"#a0a2aa",bold:!0}}]},{type:"Image",props:{y:121,x:386,width:162,skin:"myres/lobby/num.png",name:"n6",height:84,sizeGrid:"19,22,21,20"},child:[{type:"Image",props:{y:0,x:0,width:162,skin:"myres/lobby/num_pressed.png",name:"s",height:84}},{type:"Label",props:{y:14,x:68,width:36,text:"6",height:52,fontSize:55,font:"SimHei",color:"#a0a2aa",bold:!0}}]},{type:"Image",props:{y:210,x:53,width:162,skin:"myres/lobby/num.png",name:"n7",height:84,sizeGrid:"19,22,21,20"},child:[{type:"Image",props:{y:0,x:0,width:162,skin:"myres/lobby/num_pressed.png",name:"s",height:84}},{type:"Label",props:{y:14,x:68,width:36,text:"7",height:52,fontSize:55,font:"SimHei",color:"#a0a2aa",bold:!0}}]},{type:"Image",props:{y:210,x:220,width:162,skin:"myres/lobby/num.png",name:"n8",height:84,sizeGrid:"19,22,21,20"},child:[{type:"Image",props:{y:0,x:0,width:162,skin:"myres/lobby/num_pressed.png",name:"s",height:84}},{type:"Label",props:{y:14,x:68,width:36,text:"8",height:52,fontSize:55,font:"SimHei",color:"#a0a2aa",bold:!0}}]},{type:"Image",props:{y:210,x:386,width:162,skin:"myres/lobby/num.png",name:"n9",height:84,sizeGrid:"19,22,21,20"},child:[{type:"Image",props:{y:0,x:0,width:162,skin:"myres/lobby/num_pressed.png",name:"s",height:84}},{type:"Label",props:{y:14,x:68,width:36,text:"9",height:52,fontSize:55,font:"SimHei",color:"#a0a2aa",bold:!0}}]},{type:"Image",props:{y:299,x:53,width:162,skin:"myres/lobby/num.png",name:"clear",height:84,sizeGrid:"19,22,21,20"},child:[{type:"Image",props:{y:0,x:0,width:162,skin:"myres/lobby/num_pressed.png",name:"s",height:84}},{type:"Label",props:{y:16,x:24,width:111,text:"清空",height:52,fontSize:45,font:"SimHei",color:"#a0a2aa",bold:!1,align:"center"}}]},{type:"Image",props:{y:299,x:220,width:162,skin:"myres/lobby/num.png",name:"n0",height:84,sizeGrid:"19,22,21,20"},child:[{type:"Image",props:{y:0,x:0,width:162,skin:"myres/lobby/num_pressed.png",name:"s",height:84}},{type:"Label",props:{y:14,x:68,width:36,text:"0",height:52,fontSize:55,font:"SimHei",color:"#a0a2aa",bold:!0}}]},{type:"Image",props:{y:299,x:386,width:162,skin:"myres/lobby/num.png",name:"del",height:84,sizeGrid:"19,22,21,20"},child:[{type:"Image",props:{y:0,x:0,width:162,skin:"myres/lobby/num_pressed.png",name:"s",height:84}},{type:"Image",props:{y:5,x:13,skin:"myres/lobby/back.png"}}]}]}]}]},i}(View);t.add_roomUI=i}(e.lobby||(e.lobby={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.UICopy",capsui.UICopy),View.regComponent("capsui.CButton",capsui.CButton),View.regComponent("capsui.CScrollView",capsui.CScrollView),t.prototype.createChildren.call(this),this.createView(e.lobby.bagUI.uiView)},i.uiView={type:"View",props:{x:0,width:1920,height:1080},child:[{type:"Image",props:{y:155,x:331,width:1491,skin:"myres/shop/bg_container.png",name:"content",height:864,sizeGrid:"58,59,63,59"},child:[{type:"Sprite",props:{y:-1,x:-291,width:338,name:"tabs",height:816},child:[{type:"Button",props:{y:118,x:178,width:336,stateNum:1,skin:"myres/shop/tab_choose.png",name:"templete",height:141,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{runtime:"capsui.UICopy"}},{type:"Label",props:{y:24,x:24,width:184,valign:"middle",text:"道具",scaleY:1.5,scaleX:1.5,name:"label_name",height:66,fontSize:60,font:"fengyu",color:"#d9b263",align:"center"}}]},{type:"Button",props:{y:243,x:178,width:336,stateNum:1,skin:"myres/shop/tab_choose.png",name:"gift",height:141,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{runtime:"capsui.UICopy"}},{type:"Label",props:{y:24,x:24,width:184,valign:"middle",text:"礼物",scaleY:1.5,scaleX:1.5,name:"label_name",height:66,fontSize:60,font:"fengyu",color:"#ebb661",align:"center"}}]},{type:"Button",props:{y:367,x:178,width:336,stateNum:1,skin:"myres/shop/tab_choose.png",name:"deco",height:141,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{runtime:"capsui.UICopy"}},{type:"Label",props:{y:24,x:24,width:184,valign:"middle",text:"装扮",scaleY:1.5,scaleX:1.5,name:"label_name",height:66,fontSize:60,font:"fengyu",color:"#ebb661",align:"center"}}]},{type:"Button",props:{y:490,x:178,width:336,stateNum:1,skin:"myres/shop/tab_choose.png",name:"deco",height:141,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{runtime:"capsui.UICopy"}},{type:"Label",props:{y:24,x:24,width:184,valign:"middle",text:"牌背桌布",scaleY:1.5,scaleX:1.5,name:"label_name",height:66,fontSize:60,font:"fengyu",color:"#ebb661",align:"center"}}]}]},{type:"Sprite",props:{y:39,x:44,width:1379,name:"page_gift",height:769},child:[{type:"Panel",props:{y:118,x:80,width:1309,name:"content",height:660},child:[{type:"Sprite",props:{y:0,x:0,width:200,name:"templete",height:210},child:[{type:"Button",props:{y:94,x:100,width:200,name:"btn_detail",height:188,anchorY:.5,anchorX:.5},child:[{type:"Sprite",props:{y:96,x:100,width:160,scaleY:1.1,scaleX:1.1,pivotY:80,pivotX:80,name:"content",height:160},child:[{type:"Image",props:{y:0,x:0,width:160,skin:"myres/kuangbg.png",name:"bg",height:160,sizeGrid:"7,7,8,7"}},{type:"Image",props:{y:1,x:0,width:160,name:"icon",height:160}},{type:"Image",props:{y:-2,x:-3,width:166,skin:"myres/kuangbound.png",name:"bound",height:166,sizeGrid:"18,20,12,12"}},{type:"Label",props:{y:126,x:62,width:91,text:999,strokeColor:"#000000",stroke:2,name:"num",height:31,fontSize:30,font:"SimHei",color:"#ffffff",align:"right"}}]},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Script",props:{y:0,x:0,runtime:"capsui.UICopy"}},{type:"Image",props:{y:3,x:5,skin:"myres/lobby/sell_count.png",name:"count"},child:[{type:"Label",props:{y:11,x:4,width:42,text:2,height:25,fontSize:28,font:"SimHei",color:"#0d0c0c",align:"center"}}]},{type:"Button",props:{y:29,x:169,width:75,pivotY:30,pivotX:40,name:"btn_del",mouseThrough:!1,mouseEnabled:!0,hitTestPrior:!0,height:70},child:[{type:"Image",props:{y:4,x:14,skin:"myres/lobby/sell_chose.png"}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]}]},{type:"Image",props:{y:82,x:76,width:1294,skin:"myres/lobby/sell_line.png",name:"line",height:4}},{type:"Image",props:{y:9,x:50,width:46,skin:"myres/2s.png",name:"stardust",height:46},child:[{type:"Label",props:{y:7,x:49,width:134,text:"×999999",name:"count",height:32,fontSize:32,font:"SimHei",color:"#e4b777",align:"left"}},{type:"Label",props:{y:14,x:186,width:126,text:"+999999",name:"delta",height:25,fontSize:25,font:"SimHei",color:"#5acf6c",align:"left"}}]},{type:"Button",props:{y:33,x:1280,width:181,stateNum:1,skin:"myres/bothui/invite_btn1.png",name:"btn_sell",height:68,anchorY:.5,anchorX:.5,sizeGrid:"4,5,5,5"},child:[{type:"Label",props:{y:13,x:18,width:185,text:"礼品奉纳",scaleY:.8,scaleX:.8,height:45,font:"fengyu",color:"#fcba72",align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Sprite",props:{y:101,x:1381,width:50,name:"scrollbar",mouseThrough:!1,mouseEnabled:!0,height:671},child:[{type:"Image",props:{y:0,x:25,skin:"myres/sushe/ss_slidebar.png",name:"scrollbar",height:671,anchorX:.5}},{type:"Image",props:{y:96,x:25,width:45,skin:"myres/sushe/ss_slidebtn.png",name:"scrollpoint",height:45,anchorY:.5,anchorX:.5}}]},{type:"Script",props:{runtime:"capsui.CScrollView"}},{type:"Sprite",props:{y:-2,x:688,width:689,name:"container_sell",height:75},child:[{type:"Button",props:{y:35,x:212,width:181,stateNum:1,skin:"myres/bothui/invite_btn1.png",name:"btn_clear",height:68,anchorY:.5,anchorX:.5,sizeGrid:"4,5,5,5"},child:[{type:"Label",props:{y:13,x:18,width:185,text:"清除选择",scaleY:.8,scaleX:.8,height:45,font:"fengyu",color:"#fcba72",align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:35,x:592,width:181,stateNum:1,skin:"myres/bothui/invite_btn1.png",name:"btn_back",height:68,anchorY:.5,anchorX:.5,sizeGrid:"4,5,5,5"},child:[{type:"Label",props:{y:13,x:18,width:185,text:"返回",scaleY:.8,scaleX:.8,height:45,font:"fengyu",color:"#fcba72",align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:35,x:402,width:181,stateNum:1,skin:"myres/bothui/invite_btn1.png",name:"btn_sell",height:68,anchorY:.5,anchorX:.5,sizeGrid:"4,5,5,5"},child:[{type:"Label",props:{y:13,x:18,width:185,text:"礼品奉纳",scaleY:.8,scaleX:.8,height:45,font:"fengyu",color:"#fcba72",align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Label",props:{y:25,x:-146,text:"选择你希望奉纳的礼物",fontSize:25,font:"SimHei",color:"#81b3c2"}}]},{type:"Label",props:{y:23,x:512,text:"奉纳可以将你不需要的礼物分解为星之粉尘",name:"label_huanqu",fontSize:25,font:"SimHei",color:"#81b3c2"}}]},{type:"Sprite",props:{y:-24,x:-33,width:1561,visible:!1,name:"page_desktop",height:919},child:[{type:"Sprite",props:{y:59,x:730,width:747,name:"items",height:812},child:[{type:"Image",props:{y:74,x:-7,width:756,skin:"myres/lobby/contract_info.png",name:"container_infos",height:710,sizeGrid:"9,6,10,9"}},{type:"Panel",props:{y:98,x:26,width:701,name:"content",height:671},child:[{type:"Sprite",props:{y:90,x:-21,width:230,name:"templete",height:224},child:[{type:"Button",props:{y:110,x:115,width:184,name:"btn",height:184,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:-1,x:0,width:184,skin:"myres/kuangbg.png",name:"bg",height:184,sizeGrid:"7,7,8,7"}},{type:"Image",props:{y:-9,x:-9,width:202,skin:"myres/lobby/item_chose.png",name:"inchoose",height:202,sizeGrid:"26,26,30,25"}},{type:"Image",props:{y:0,x:0,width:184,skin:"myres/2s.png",name:"icon",height:184}},{type:"Image",props:{y:-3,x:-3,width:190,skin:"myres/kuangbound.png",name:"bound",height:190,sizeGrid:"18,20,12,12"}}]},{type:"Script",props:{runtime:"capsui.UICopy"}},{type:"Image",props:{y:102,x:72,width:141,skin:"myres/lobby/using.png",name:"useing",height:107}}]}]},{type:"Sprite",props:{y:37,x:732,width:50,name:"scrollbar",mouseThrough:!1,mouseEnabled:!0,height:759},child:[{type:"Image",props:{y:0,x:25,skin:"myres/sushe/ss_slidebar.png",name:"scrollbar",height:759,anchorX:.5}},{type:"Image",props:{y:96,x:25,width:45,skin:"myres/sushe/ss_slidebtn.png",name:"scrollpoint",height:45,anchorY:.5,anchorX:.5}}]},{type:"Script",props:{y:10,x:10,runtime:"capsui.CScrollView"}},{type:"Button",props:{y:38,x:79,width:181,stateNum:1,skin:"myres/bothui/invite_btn1.png",name:"btn_tablecloth",height:68,anchorY:.5,anchorX:.5,sizeGrid:"4,5,5,5"},child:[{type:"Label",props:{y:13,x:18,width:185,text:"桌布",scaleY:.8,scaleX:.8,name:"info",height:45,font:"fengyu",color:"#fcba72",align:"center"}},{type:"Image",props:{y:66,x:2,skin:"myres/lobby/table_tag.png",name:"inchoose"}}]},{type:"Button",props:{y:38,x:268,width:181,stateNum:1,skin:"myres/bothui/invite_btn1.png",name:"btn_cardback",height:68,anchorY:.5,anchorX:.5,sizeGrid:"4,5,5,5"},child:[{type:"Label",props:{y:13,x:18,width:185,text:"牌背",scaleY:.8,scaleX:.8,name:"info",height:45,font:"fengyu",color:"#fcba72",align:"center"}},{type:"Image",props:{y:66,x:2,skin:"myres/lobby/table_tag.png",name:"inchoose"}}]}]},{type:"Sprite",props:{y:76,x:121,width:586,name:"preview",height:755},child:[{type:"Label",props:{y:49,x:198,width:198,text:"效果预览",scaleY:.9,scaleX:.9,height:45,font:"fengyu",color:"#e4ba86",align:"center"}},{type:"Button",props:{y:706,x:285,width:198,stateNum:1,skin:"myres/use_btn.png",name:"btn_use",height:71,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:14,x:3,width:211,text:"使用",scaleY:.9,scaleX:.9,name:"info",height:46,font:"fengyu",color:"#fcba72",align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Image",props:{y:134,x:35,width:486,skin:"extendRes/desktop/defalut/preview.jpg",name:"desktop",height:484}},{type:"Image",props:{y:163,x:61,skin:"extendRes/mjp/default/preview.png",name:"mjp"}},{type:"Image",props:{y:129,x:31,width:493,skin:"myres/kuangbound.png",name:"bound",height:493,sizeGrid:"18,20,12,12"}}]}]},{type:"Sprite",props:{y:39,x:44,width:1379,name:"page_items",height:769},child:[{type:"Panel",props:{y:-1,x:50,width:1339,name:"content",height:779},child:[{type:"Sprite",props:{width:200,name:"templete",height:188},child:[{type:"Button",props:{y:94,x:100,width:200,name:"btn_detail",height:188,anchorY:.5,anchorX:.5},child:[{type:"Sprite",props:{y:96,x:100,width:160,pivotY:80,pivotX:80,name:"content",height:160},child:[{type:"Image",props:{y:0,x:0,width:160,skin:"myres/kuangbg.png",name:"bg",height:160,sizeGrid:"7,7,8,7"}},{type:"Image",props:{y:1,x:0,width:160,skin:"myres/2s.png",name:"icon",height:160}},{type:"Image",props:{y:-2,x:-3,width:166,skin:"myres/kuangbound.png",name:"bound",height:166,sizeGrid:"18,20,12,12"}},{type:"Label",props:{y:126,x:62,width:91,text:999,strokeColor:"#000000",stroke:2,name:"num",height:31,fontSize:30,font:"SimHei",color:"#ffffff",align:"right"}}]},{type:"Image",props:{y:3,x:5,skin:"myres/lobby/sell_count.png",name:"count"},child:[{type:"Label",props:{y:11,x:4,width:42,text:2,height:25,fontSize:28,font:"SimHei",color:"#0d0c0c",align:"center"}}]},{type:"Button",props:{y:29,x:169,width:75,pivotY:30,pivotX:40,name:"btn_del",height:70},child:[{type:"Image",props:{y:4,x:14,skin:"myres/lobby/sell_chose.png"}}]},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Script",props:{y:0,x:0,runtime:"capsui.UICopy"}}]}]},{type:"Sprite",props:{y:13,x:1381,width:50,name:"scrollbar",mouseThrough:!1,mouseEnabled:!0,height:759},child:[{type:"Image",props:{y:0,x:25,skin:"myres/sushe/ss_slidebar.png",name:"scrollbar",height:759,anchorX:.5}},{type:"Image",props:{y:96,x:25,width:45,skin:"myres/sushe/ss_slidebtn.png",name:"scrollpoint",height:45,anchorY:.5,anchorX:.5}}]},{type:"Script",props:{runtime:"capsui.CScrollView"}}]}]},{type:"Image",props:{y:48,x:119,width:401,skin:"myres/img_return1_bg.png",name:"top",height:81},child:[{type:"Label",props:{y:3,x:105,width:95,text:"仓库",scaleY:1.4,scaleX:1.4,height:45,font:"fengyu",color:"#e4ba86",align:"center"}},{type:"Button",props:{y:46,x:-42,width:182,pivotY:80,pivotX:74,name:"btn_back",height:142},child:[{type:"Image",props:{y:6,x:7,width:135,skin:"myres/img_return1.png",height:134}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]}]},i}(View);t.bagUI=i}(e.lobby||(e.lobby={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.CButton",capsui.CButton),t.prototype.createChildren.call(this),this.createView(e.lobby.chang_nicknameUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Sprite",props:{y:550,x:960,width:834,pivotY:278,pivotX:417,name:"root",height:536},child:[{type:"Image",props:{y:9,x:14,width:804,skin:"myres/pop2_bg.png",name:"bg",height:518,sizeGrid:"2,2,2,2"},child:[{type:"Image",props:{y:9,x:-1,width:805,skin:"myres/pop_black.png",name:"bar",height:94}},{type:"Image",props:{y:123,x:-1,width:805,skin:"myres/pop_black.png",name:"bar",height:379}}]},{type:"Image",props:{y:9,x:11,width:807,skin:"myres/pop2_bound.png",name:"bound",height:518,sizeGrid:"24,27,11,21"}},{type:"Label",props:{y:39,x:305,width:234,text:"更改昵称",height:53,fontSize:45,font:"fengyu",color:"#e6af73",align:"center"}},{type:"Sprite",props:{y:160,x:55,width:717,name:"container_input",height:340},child:[{type:"Image",props:{y:34,x:47,width:622,skin:"myres/inputbox.png",height:111,sizeGrid:"7,12,10,9"}},{type:"Label",props:{y:67,x:72,width:287,text:"昵称(1-7字)",name:"lb",height:65,fontSize:45,font:"youyuan",color:"#ffffff",bold:!1,align:"left"}},{type:"TextInput",props:{y:36,x:64,width:585,restrict:"a-zA-Z0-9\\u2E80-\\u9FFF~@!#$%^&()-_+=|{}:;<>.?",promptColor:"#ffffff",name:"txtinput",height:111,fontSize:45,font:"SimHei",color:"#ffffff"}},{type:"Label",props:{y:70,x:523,width:115,text:"不可用",name:"no",height:35,fontSize:40,font:"youyuan",color:"#d12e30"}},{type:"Button",props:{y:282,x:356,width:404,name:"btn_confirm",height:96,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:1,x:0,width:401,skin:"myres/lobby/pickname.png",height:94}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Image",props:{y:191,x:187,width:338,skin:"myres/shop/price_bg.png",name:"price",height:34},child:[{type:"Label",props:{y:6,x:78,width:53,text:"需要",name:"label0",height:27,fontSize:25,font:"SimHei",color:"#dbd8d8"}},{type:"Image",props:{y:-5,x:137,width:43,skin:"extendRes/items/gold1.png",name:"icon",height:43}},{type:"Label",props:{y:-1,x:185,width:122,text:"x1",name:"count",height:35,fontSize:35,font:"SimHei",color:"#dbd8d8",align:"left"}}]}]},{type:"Sprite",props:{y:152,x:55,width:722,name:"container_no",height:336},child:[{type:"Label",props:{y:29,x:93,width:545,text:"30天内不可重复改名",height:52,fontSize:30,font:"SimHei",color:"#dbd8d8",align:"center"}},{type:"Label",props:{y:78,x:96,width:545,text:"当前剩余：",height:52,fontSize:40,font:"SimHei",color:"#dbd8d8",align:"center"}},{type:"Label",props:{y:173,x:241,width:176,text:"30",name:"count",height:110,fontSize:60,font:"SimHei",color:"#dbd8d8",align:"center"}},{type:"Label",props:{y:186,x:377,width:137,text:"天",height:52,fontSize:40,font:"SimHei",color:"#dbd8d8",align:"left"}}]},{type:"Button",props:{y:50,x:777,width:91,name:"btn_close",height:84,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:19,x:24,skin:"myres/pop2_close.png"}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]}]},i}(View);t.chang_nicknameUI=i}(e.lobby||(e.lobby={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.CButton",capsui.CButton),t.prototype.createChildren.call(this),this.createView(e.lobby.create_roomUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Sprite",props:{y:0,x:0,name:"container_create_room"},child:[{type:"Image",props:{y:145,x:-39,width:2e3,skin:"myres/room/bg_black.png",name:"content",height:777},child:[{type:"Button",props:{y:845,x:1004,width:218,stateNum:1,skin:"myres/room/btn_create.png",name:"btn_create",height:93,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Panel",props:{y:42,x:211,width:1700,vScrollBarSkin:"myres/vscroll.png",name:"panel",height:686},child:[{type:"Sprite",props:{y:0,x:180,width:1621,name:"moshi",height:112},child:[{type:"Image",props:{y:31,x:110,width:95,skin:"myres/room/txt_mode.png",scaleY:1.2,scaleX:1.2,height:42,anchorX:1}},{type:"Button",props:{y:49,x:252,width:247,stateNum:1,skin:"myres/room/btn_choosen_no.png",name:"toggle_0",height:88,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:43,x:121,width:172,text:"一局胜负",height:45,fontSize:40,font:"SimHei",color:"#c1ac8b",anchorY:.5,anchorX:.5,align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:49,x:516,width:247,stateNum:1,skin:"myres/room/btn_choosen.png",name:"toggle_1",height:88,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:43,x:121,width:172,text:"四人东风",height:45,fontSize:40,font:"SimHei",color:"#894b4b",anchorY:.5,anchorX:.5,align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:49,x:780,width:247,stateNum:1,skin:"myres/room/btn_choosen_no.png",name:"toggle_2",height:88,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:43,x:121,width:172,text:"四人半庄",height:45,fontSize:40,font:"SimHei",color:"#fdfdfd",anchorY:.5,anchorX:.5,align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:49,x:1044,width:247,stateNum:1,skin:"myres/room/btn_choosen_no.png",name:"toggle_3",height:88,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:43,x:121,width:172,text:"人机模式",height:45,fontSize:40,font:"SimHei",color:"#fdfdfd",anchorY:.5,anchorX:.5,align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]},{type:"Sprite",props:{y:112,x:180,width:1621,name:"time",height:112},child:[{type:"Image",props:{y:31,x:110,width:155,skin:"myres/room/timeset.png",scaleY:1.2,scaleX:1.2,height:40,anchorX:1}},{type:"Button",props:{y:49,x:252,width:247,stateNum:1,skin:"myres/room/btn_choosen_no.png",name:"toggle_0",height:88,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:43,x:121,width:172,text:"3+5秒",height:45,fontSize:40,font:"SimHei",color:"#c1ac8b",anchorY:.5,anchorX:.5,align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:49,x:516,width:247,stateNum:1,skin:"myres/room/btn_choosen.png",name:"toggle_1",height:88,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:43,x:121,width:172,text:"5+10秒",height:45,fontSize:40,font:"SimHei",color:"#894b4b",anchorY:.5,anchorX:.5,align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:49,x:780,width:247,stateNum:1,skin:"myres/room/btn_choosen_no.png",name:"toggle_2",height:88,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:43,x:121,width:172,text:"5+20秒",height:45,fontSize:40,font:"SimHei",color:"#fdfdfd",anchorY:.5,anchorX:.5,align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:49,x:1044,width:247,stateNum:1,skin:"myres/room/btn_choosen_no.png",name:"toggle_3",height:88,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:43,x:121,width:172,text:"60+0秒",height:45,fontSize:40,font:"SimHei",color:"#fdfdfd",anchorY:.5,anchorX:.5,align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]},{type:"Sprite",props:{y:227,x:180,width:1621,visible:!0,name:"bisai",height:112},child:[{type:"Image",props:{y:31,x:110,width:95,skin:"myres/room/txt_match.png",scaleY:1.2,scaleX:1.2,height:42,anchorX:1}},{type:"Button",props:{y:49,x:252,width:247,stateNum:1,skin:"myres/room/btn_choosen_no.png",name:"toggle_0",height:88,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:43,x:121,width:172,text:"普通房间",height:45,fontSize:40,font:"SimHei",color:"#fdfdfd",anchorY:.5,anchorX:.5,align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:49,x:516,width:247,stateNum:1,skin:"myres/room/btn_choosen_no.png",name:"toggle_1",height:88,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:43,x:121,width:265,valign:"middle",text:"允许允许允许允许允",height:45,fontSize:25,font:"SimHei",color:"#fdfdfd",anchorY:.5,anchorX:.5,align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]},{type:"Sprite",props:{y:346,x:180,width:1621,visible:!1,name:"test_paipu",height:112},child:[{type:"Image",props:{y:31,x:110,width:95,skin:"myres/room/txt_eatornot.png",scaleY:1.2,scaleX:1.2,height:42,anchorX:1}},{type:"Button",props:{y:49,x:252,width:247,stateNum:1,skin:"myres/room/btn_choosen_no.png",name:"toggle_0",height:88,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:43,x:121,width:172,text:"正常",height:45,fontSize:40,font:"SimHei",color:"#fdfdfd",anchorY:.5,anchorX:.5,align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:49,x:516,width:247,stateNum:1,skin:"myres/room/btn_choosen_no.png",name:"toggle_1",height:88,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:43,x:121,width:172,text:"国士无双",height:45,fontSize:40,font:"SimHei",color:"#fdfdfd",anchorY:.5,anchorX:.5,align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:49,x:780,width:247,stateNum:1,skin:"myres/room/btn_choosen_no.png",name:"toggle_2",height:88,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:43,x:121,width:172,text:"顺子",height:45,fontSize:40,font:"SimHei",color:"#fdfdfd",anchorY:.5,anchorX:.5,align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:49,x:1044,width:247,stateNum:1,skin:"myres/room/btn_choosen_no.png",name:"toggle_3",height:88,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:43,x:121,width:172,text:"四暗刻",height:45,fontSize:40,font:"SimHei",color:"#fdfdfd",anchorY:.5,anchorX:.5,align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:49,x:1308,width:247,stateNum:1,skin:"myres/room/btn_choosen_no.png",name:"toggle_4",height:88,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:43,x:121,width:172,text:"三暗杠",height:45,fontSize:40,font:"SimHei",color:"#fdfdfd",anchorY:.5,anchorX:.5,align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]},{type:"Sprite",props:{y:470,x:180,width:1621,visible:!1,name:"test_paicount",height:112},child:[{type:"Image",props:{y:31,x:110,width:95,skin:"myres/room/txt_bet.png",scaleY:1.2,scaleX:1.2,height:42,anchorX:1}},{type:"Button",props:{y:49,x:252,width:247,stateNum:1,skin:"myres/room/btn_choosen_no.png",name:"toggle_0",height:88,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:43,x:121,width:172,text:"正常",height:45,fontSize:40,font:"SimHei",color:"#fdfdfd",anchorY:.5,anchorX:.5,align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:49,x:516,width:247,stateNum:1,skin:"myres/room/btn_choosen_no.png",name:"toggle_1",height:88,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:43,x:121,width:172,text:"5张",height:45,fontSize:40,font:"SimHei",color:"#fdfdfd",anchorY:.5,anchorX:.5,align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:49,x:780,width:247,stateNum:1,skin:"myres/room/btn_choosen_no.png",name:"toggle_2",height:88,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:43,x:121,width:172,text:"12张",height:45,fontSize:40,font:"SimHei",color:"#fdfdfd",anchorY:.5,anchorX:.5,align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]},{type:"Sprite",props:{y:582,x:180,width:1621,visible:!0,name:"gaojishezhi",height:112},child:[{type:"Image",props:{y:31,x:110,width:153,skin:"myres/room/gaojishezhi.png",scaleY:1.2,scaleX:1.2,height:40,anchorX:1}},{type:"Button",props:{y:49,x:252,width:247,stateNum:1,skin:"myres/room/btn_choosen_no.png",name:"toggle_0",height:88,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:43,x:121,width:172,text:"不启用",height:45,fontSize:40,font:"SimHei",color:"#fdfdfd",anchorY:.5,anchorX:.5,align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:49,x:516,width:247,stateNum:1,skin:"myres/room/btn_choosen_no.png",name:"toggle_1",height:88,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:43,x:121,width:172,text:"启用",height:45,fontSize:40,font:"SimHei",color:"#fdfdfd",anchorY:.5,anchorX:.5,align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]},{type:"Sprite",props:{y:694,x:180,width:1621,visible:!1,name:"split_line",height:50},child:[{type:"Image",props:{y:-4,x:483,skin:"myres/room/open_arrow.png",scaleY:1.2,scaleX:1.2}},{type:"Image",props:{y:17,x:-121,width:1600,skin:"myres/room/open_line.png",height:8}}]},{type:"Sprite",props:{y:754,x:180,width:1621,visible:!1,name:"qishidianshu",height:112},child:[{type:"Image",props:{y:31,x:110,width:155,skin:"myres/room/qishidianshu.png",scaleY:1.2,scaleX:1.2,height:40,anchorX:1}},{type:"Button",props:{y:49,x:252,width:247,name:"btn",height:88,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:11,x:3,width:248,skin:"myres/inputbox.png",height:68,sizeGrid:"7,12,10,9"}},{type:"Label",props:{y:47,x:121,width:213,text:"25000",height:45,fontSize:40,font:"haolong",color:"#fdfdfd",anchorY:.5,anchorX:.5,align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Label",props:{y:56,x:398,width:507,text:"最小单位100，最大值200000",height:35,fontSize:25,font:"SimHei",color:"#bcbab6"}}]},{type:"Sprite",props:{y:866,x:180,width:1621,visible:!1,name:"fandian",height:112},child:[{type:"Image",props:{y:31,x:110,width:208,skin:"myres/room/fandian.png",scaleY:1.2,scaleX:1.2,height:40,anchorX:1}},{type:"Button",props:{y:49,x:252,width:247,name:"btn",height:88,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:11,x:3,width:248,skin:"myres/inputbox.png",height:68,sizeGrid:"7,12,10,9"}},{type:"Label",props:{y:47,x:121,width:213,text:"30000",height:45,fontSize:40,font:"haolong",color:"#fdfdfd",anchorY:.5,anchorX:.5,align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Label",props:{y:25,x:398,width:691,text:"最小单位100，最大值200000，必须大于等于起始点数",height:34,fontSize:25,font:"SimHei",color:"#bcbab6"}},{type:"Label",props:{y:58,x:398,width:691,text:"All LAST时1位不足该点数将南入/西入",height:32,fontSize:25,font:"SimHei",color:"#bcbab6"}}]},{type:"Sprite",props:{y:1166,x:180,width:1621,visible:!1,name:"chibaopai",height:112},child:[{type:"Image",props:{y:31,x:110,width:120,skin:"myres/room/chibaopai.png",scaleY:1.2,scaleX:1.2,height:40,anchorX:1}},{type:"Button",props:{y:49,x:252,width:247,stateNum:1,skin:"myres/room/btn_choosen_no.png",name:"toggle_0",height:88,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:43,x:121,width:172,text:"无赤",height:45,fontSize:40,font:"SimHei",color:"#fdfdfd",anchorY:.5,anchorX:.5,align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:49,x:516,width:247,stateNum:1,skin:"myres/room/btn_choosen_no.png",name:"toggle_1",height:88,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:43,x:121,width:172,text:"3赤",height:45,fontSize:40,font:"SimHei",color:"#fdfdfd",anchorY:.5,anchorX:.5,align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:49,x:780,width:247,stateNum:1,skin:"myres/room/btn_choosen_no.png",name:"toggle_2",height:88,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:43,x:121,width:172,text:"4赤",height:45,fontSize:40,font:"SimHei",color:"#fdfdfd",anchorY:.5,anchorX:.5,align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]},{type:"Sprite",props:{y:1278,x:180,width:1621,visible:!1,name:"shiduan",height:112},child:[{type:"Image",props:{y:31,x:110,width:86,skin:"myres/room/txt_eatornot.png",scaleY:1.2,scaleX:1.2,height:40,anchorX:1}},{type:"Button",props:{y:49,x:252,width:247,stateNum:1,skin:"myres/room/btn_choosen_no.png",name:"toggle_0",height:88,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:43,x:121,width:172,text:"有",height:45,fontSize:40,font:"SimHei",color:"#fdfdfd",anchorY:.5,anchorX:.5,align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:49,x:516,width:247,stateNum:1,skin:"myres/room/btn_choosen_no.png",name:"toggle_1",height:88,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:43,x:121,width:172,text:"无",height:45,fontSize:40,font:"SimHei",color:"#fdfdfd",anchorY:.5,anchorX:.5,align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:55,x:-27,width:70,name:"what",height:70,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:15,x:15,skin:"myres/bothui/what.png",scaleY:1.2,scaleX:1.2,name:"what"}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]},{type:"Sprite",props:{y:1390,x:180,width:1621,visible:!1,name:"bianjietishi",height:112},child:[{type:"Image",props:{y:31,x:110,width:156,skin:"myres/room/bianjietishi.png",scaleY:1.2,scaleX:1.2,height:40,anchorX:1}},{type:"Button",props:{y:49,x:252,width:247,stateNum:1,skin:"myres/room/btn_choosen_no.png",name:"toggle_0",height:88,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:43,x:121,width:172,text:"有",height:45,fontSize:40,font:"SimHei",color:"#fdfdfd",anchorY:.5,anchorX:.5,align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:49,x:516,width:247,stateNum:1,skin:"myres/room/btn_choosen_no.png",name:"toggle_1",height:88,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:43,x:121,width:172,text:"无",height:45,fontSize:40,font:"SimHei",color:"#fdfdfd",anchorY:.5,anchorX:.5,align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:55,x:-115,width:70,name:"what",height:70,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:15,x:15,skin:"myres/bothui/what.png",scaleY:1.2,scaleX:1.2,name:"what"}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]},{type:"Sprite",props:{y:1502,x:180,width:1621,visible:!1,name:"guanzhan",height:112},child:[{type:"Image",props:{y:31,x:4,width:95,skin:"myres/room/ob.png",scaleY:1.2,scaleX:1.2,height:42}},{type:"Button",props:{y:49,x:252,width:247,stateNum:1,skin:"myres/room/btn_choosen_no.png",name:"toggle_0",height:88,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:43,x:121,width:172,text:"不允许",height:45,fontSize:40,font:"SimHei",color:"#fdfdfd",anchorY:.5,anchorX:.5,align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:49,x:516,width:247,stateNum:1,skin:"myres/room/btn_choosen_no.png",name:"toggle_1",height:88,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:43,x:121,width:172,text:"允许",height:45,fontSize:40,font:"SimHei",color:"#fdfdfd",anchorY:.5,anchorX:.5,align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]},{type:"Sprite",props:{y:1612,x:180,width:1621,visible:!1,name:"ailevel",height:112},child:[{type:"Image",props:{y:31,x:4,width:95,skin:"myres/room/ai.png",scaleY:1.2,scaleX:1.2,height:42}},{type:"Button",props:{y:49,x:252,width:247,stateNum:1,skin:"myres/room/btn_choosen_no.png",name:"toggle_0",height:88,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:43,x:121,width:172,text:"简单",height:45,fontSize:40,font:"SimHei",color:"#fdfdfd",anchorY:.5,anchorX:.5,align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:49,x:516,width:247,stateNum:1,skin:"myres/room/btn_choosen_no.png",name:"toggle_1",height:88,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:43,x:121,width:172,text:"普通",height:45,fontSize:40,font:"SimHei",color:"#fdfdfd",anchorY:.5,anchorX:.5,align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]}]},{type:"Sprite",props:{y:39,x:1892,width:50,name:"scrollbar",mouseThrough:!1,mouseEnabled:!0,height:686},child:[{type:"Image",props:{y:0,x:25,skin:"myres/scrollbar.png",name:"scrollbar",height:686,anchorX:.5,alpha:1}},{type:"Image",props:{y:96,x:25,width:45,skin:"myres/scrollpoint.png",name:"scrollpoint",height:45,anchorY:.5,anchorX:.5}}]}]},{type:"Sprite",props:{name:"top"},child:[{type:"Image",props:{y:38,x:116,width:401,skin:"myres/img_return1_bg.png",height:81}},{type:"Button",props:{y:78,x:74,width:166,pivotY:91,pivotX:86,name:"btn_cancel",height:155},child:[{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Image",props:{y:24,x:19,width:135,skin:"myres/img_return1.png",height:134}}]},{type:"Label",props:{y:40,x:188,width:153,text:"创建房间",scaleY:1.4,scaleX:1.4,height:57,fontSize:70,font:"fengyu",color:"#e4ba86",align:"center"}}]}]}]},i}(View);t.create_roomUI=i}(e.lobby||(e.lobby={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.CButton",capsui.CButton),View.regComponent("capsui.UICopy",capsui.UICopy),View.regComponent("capsui.CLoading",capsui.CLoading),View.regComponent("capsui.NoLimitList",capsui.NoLimitList),t.prototype.createChildren.call(this),this.createView(e.lobby.friendUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Sprite",props:{y:0,x:0,width:1924,name:"top",height:90},child:[{type:"Image",props:{y:-4,x:0,width:1922,skin:"myres/lobby/bg_1.png",name:"black",height:163}},{type:"Image",props:{y:48,x:119,width:401,skin:"myres/img_return1_bg.png",name:"top",height:81},child:[{type:"Label",props:{y:3,x:65,width:153,text:"好友",scaleY:1.4,scaleX:1.4,height:57,fontSize:70,font:"fengyu",color:"#e4ba86",align:"center"}}]},{type:"Button",props:{y:89,x:73,width:211,pivotY:88,pivotX:82,name:"btn_back",height:169},child:[{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Image",props:{y:19,x:19,skin:"myres/img_return1.png",scaleY:1.2,scaleX:1.2}}]}]},{type:"Sprite",props:{y:546,x:954,width:1848,pivotY:405,pivotX:919,name:"root",height:906},child:[{type:"Image",props:{y:11,x:296,width:1531,skin:"myres/shop/bg_container.png",name:"bg",height:866,sizeGrid:"58,59,63,59"}},{type:"Sprite",props:{y:42,x:15,width:290,name:"tabs",height:843},child:[{type:"Button",props:{y:89,x:295,width:336,stateNum:1,skin:"myres/shop/tab_unchoose.png",pivotY:69,pivotX:296,name:"btn_friendlist",height:141},child:[{type:"Label",props:{y:15,x:24,width:209,valign:"middle",text:"好友列表",scaleY:1.3,scaleX:1.3,name:"label_name",height:85,fontSize:60,font:"fengyu",color:"#eab65e",align:"center"}}]},{type:"Button",props:{y:230,x:296,width:336,stateNum:1,skin:"myres/shop/tab_unchoose.png",pivotX:296,name:"btn_applylist",height:141,anchorY:.5},child:[{type:"Label",props:{y:17,x:24,width:207,valign:"middle",text:"好友申请",scaleY:1.3,scaleX:1.3,name:"label_name",height:85,fontSize:60,font:"fengyu",color:"#eab65e",align:"center"}},{type:"Image",props:{y:86,x:0,skin:"myres/lobby/redpoint.png",name:"redpoint"}}]},{type:"Button",props:{y:370,x:296,width:336,stateNum:1,skin:"myres/shop/tab_unchoose.png",pivotX:296,name:"btn_find",height:141,anchorY:.5},child:[{type:"Label",props:{y:18,x:24,width:207,valign:"middle",text:"查找好友",scaleY:1.3,scaleX:1.3,name:"label_name",height:85,fontSize:60,font:"fengyu",color:"#eab65e",align:"center"}}]}]},{type:"Sprite",props:{y:11,x:296,width:200,name:"page_find",height:200},child:[{type:"Image",props:{y:59,x:129,width:1035,skin:"myres/inputbox.png",name:"input",height:83,sizeGrid:"7,12,10,9"},child:[{type:"TextInput",props:{y:7,x:11,width:1017,valign:"middle",promptColor:"#d0cdcd",name:"txtinput",height:70,fontSize:50,font:"SimHei",color:"#d0cdcd",align:"center"}}]},{type:"Button",props:{y:101,x:1291,width:202,stateNum:1,skin:"myres/btn_small.png",name:"search",height:91,anchorY:.5,anchorX:.5,sizeGrid:"30,30,30,30"},child:[{type:"Label",props:{y:6,x:11,width:138,valign:"middle",text:"查找",scaleY:1.3,scaleX:1.3,height:60,fontSize:50,font:"fengyu",color:"#e6ba78",align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Sprite",props:{y:165,x:36,width:200,name:"scrollview",height:200},child:[{type:"Panel",props:{y:0,x:0,width:1462,name:"content",height:659},child:[{type:"Sprite",props:{y:0,x:0,width:1454,name:"templete",height:193},child:[{type:"Sprite",props:{width:728,name:"p0",height:186},child:[{type:"Image",props:{y:12,x:5,width:716,skin:"myres/lobby/frame_short.png",height:169,sizeGrid:"0,0,0,0"}},{type:"Button",props:{y:99,x:615,width:156,stateNum:1,skin:"myres/btn_small.png",name:"add",height:70,anchorY:.5,anchorX:.5,sizeGrid:"30,30,30,30"},child:[{type:"Label",props:{y:9,x:39,width:82,text:"添加",height:39,fontSize:40,font:"fengyu",color:"#e6ba78"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Image",props:{y:9,x:19,skin:"myres/bg_head1.png",scaleY:.75,scaleX:.75,name:"head"},child:[{type:"Image",props:{y:36,x:23,width:153,skin:"extendRes/charactor/yiji/smallhead.png",height:153}}]},{type:"Image",props:{y:42,x:163,width:292,skin:"extendRes/title/yuanchuzhihuo.png",name:"title",height:56}},{type:"Label",props:{y:110,x:178,text:"蹦蹦跳跳的仙太郎",name:"name",fontSize:35,font:"SimHei",color:"#eae6df",align:"center"}},{type:"Label",props:{y:73,x:558,width:123,text:"已添加",name:"add_1",height:35,fontSize:38,font:"SimHei",color:"#55de50"}}]},{type:"Sprite",props:{x:728,width:728,name:"p1",height:186},child:[{type:"Image",props:{y:12,x:5,width:716,skin:"myres/lobby/frame_short.png",height:169,sizeGrid:"0,0,0,0"}},{type:"Button",props:{y:99,x:615,width:156,stateNum:1,skin:"myres/btn_small.png",name:"add",height:70,anchorY:.5,anchorX:.5,sizeGrid:"30,30,30,30"},child:[{type:"Label",props:{y:9,x:39,width:82,text:"添加",height:39,fontSize:40,font:"fengyu",color:"#e6ba78"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Image",props:{y:9,x:19,skin:"myres/bg_head1.png",scaleY:.75,scaleX:.75,name:"head"},child:[{type:"Image",props:{y:36,x:23,width:153,skin:"extendRes/charactor/yiji/smallhead.png",height:153}}]},{type:"Label",props:{y:73,x:558,width:123,text:"已添加",name:"add_1",height:35,fontSize:38,font:"SimHei",color:"#55de50"}},{type:"Label",props:{y:110,x:178,text:"蹦蹦跳跳的仙太郎",name:"name",fontSize:35,font:"SimHei",color:"#eae6df",align:"center"}},{type:"Image",props:{y:42,x:163,width:292,skin:"extendRes/title/yuanchuzhihuo.png",name:"title",height:56}}]},{type:"Script",props:{y:0,x:0,runtime:"capsui.UICopy"}}]}]},{type:"Sprite",props:{y:207,x:709,width:127,name:"loading",mouseThrough:!0,height:133},child:[{type:"Image",props:{y:67,x:26,skin:"myres/necessary/flower_nei.png",scaleY:1.2,scaleX:1.2,rotation:0,name:"flower",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:0,x:0,skin:"myres/necessary/flower_shine.png",name:"shine",alpha:1}},{type:"Image",props:{y:56,x:56,skin:"myres/necessary/round.png",name:"round",anchorY:.5,anchorX:.5}},{type:"Image",props:{y:142,x:0,skin:"myres/necessary/word.png"}}]},{type:"Script",props:{runtime:"capsui.CLoading"}}]},{type:"Script",props:{y:10,x:10,runtime:"capsui.NoLimitList"}}]}]},{type:"Sprite",props:{y:11,x:296,width:200,name:"page_friend",height:200},child:[{type:"Sprite",props:{width:200,name:"scrollview",height:200},child:[{type:"Panel",props:{y:96,x:42,width:1436,name:"content",height:731},child:[{type:"Sprite",props:{y:52,width:1439,name:"templete",height:186},child:[{type:"Image",props:{y:4,x:7,width:1426,skin:"myres/lobby/frame_long.png",height:175,sizeGrid:"3,0,3,0"}},{type:"Button",props:{y:95,x:1017,width:156,stateNum:1,skin:"myres/btn_small.png",name:"check",height:70,anchorY:.5,anchorX:.5,sizeGrid:"30,30,30,30"},child:[{type:"Label",props:{y:9,x:39,width:82,text:"查看",height:39,fontSize:40,font:"fengyu",color:"#e6ba78"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:95,x:1331,width:156,stateNum:1,skin:"myres/btn_small.png",name:"delete",height:70,anchorY:.5,anchorX:.5,sizeGrid:"30,30,30,30"},child:[{type:"Label",props:{y:9,x:39,width:82,text:"删除",height:39,fontSize:40,font:"fengyu",color:"#e6ba78"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Image",props:{y:7,x:282,skin:"myres/bg_head1.png",scaleY:.75,scaleX:.75,name:"head"},child:[{type:"Image",props:{y:35,x:22,width:154,skin:"extendRes/charactor/yiji/smallhead.png",height:154}}]},{type:"Image",props:{y:86,x:822,width:255,scaleY:.6,scaleX:.6,pivotY:114,pivotX:128,name:"rank",height:253},child:[{type:"Image",props:{y:0,x:0,skin:"myres/rank_bg.png",name:"bg"}},{type:"Image",props:{y:15,x:0,skin:"extendRes/level/queshi.png",name:"icon"}},{type:"Image",props:{y:191,x:58,skin:"myres/starbg.png",scaleY:1,scaleX:1,name:"star2",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]},{type:"Image",props:{y:142,x:29,skin:"myres/starbg.png",scaleY:.7,scaleX:.7,name:"star3",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]},{type:"Image",props:{y:214,x:110,skin:"myres/starbg.png",scaleY:.7,scaleX:.7,name:"star1",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]}]},{type:"Label",props:{y:77,x:20,width:235,text:"当前在线",name:"state",height:35,fontSize:28,font:"SimHei",color:"#55de50",align:"center"}},{type:"Script",props:{runtime:"capsui.UICopy"}},{type:"Image",props:{y:35,x:424,width:292,skin:"extendRes/title/yuanchuzhihuo.png",name:"title",height:56}},{type:"Label",props:{y:108,x:441,text:"蹦蹦跳跳的仙太郎",name:"name",fontSize:35,font:"SimHei",color:"#eae6df",align:"center"}},{type:"Button",props:{y:95,x:1176,width:156,stateNum:1,skin:"myres/btn_small.png",name:"ob",height:70,anchorY:.5,anchorX:.5,sizeGrid:"30,30,30,30"},child:[{type:"Label",props:{y:9,x:39,width:82,text:"观战",height:39,fontSize:40,font:"fengyu",color:"#e6ba78"}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]}]},{type:"Sprite",props:{y:55,x:1473,width:50,name:"scrollbar",mouseThrough:!1,mouseEnabled:!0,height:750},child:[{type:"Image",props:{y:0,x:25,skin:"myres/scrollbar.png",name:"scrollbar",height:750,anchorX:.5}},{type:"Image",props:{y:96,x:25,width:45,skin:"myres/scrollpoint.png",name:"scrollpoint",height:45,anchorY:.5,anchorX:.5}}]},{type:"Sprite",props:{y:310,x:720,width:127,name:"loading",mouseThrough:!0,height:133},child:[{type:"Image",props:{y:67,x:26,skin:"myres/necessary/flower_nei.png",scaleY:1.2,scaleX:1.2,rotation:0,name:"flower",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:0,x:0,skin:"myres/necessary/flower_shine.png",name:"shine",alpha:1}},{type:"Image",props:{y:56,x:56,skin:"myres/necessary/round.png",name:"round",anchorY:.5,anchorX:.5}},{type:"Image",props:{y:142,x:0,skin:"myres/necessary/word.png"}}]},{type:"Script",props:{runtime:"capsui.CLoading"}}]},{type:"Script",props:{runtime:"capsui.NoLimitList"}}]},{type:"Label",props:{y:331,x:61,width:1418,text:"你还没有好友，快去认识新朋友吧~",name:"noinfo",height:171,fontSize:50,font:"SimHei",color:"#e6ba78",align:"center"}},{type:"Image",props:{y:35,x:1103,width:363,skin:"myres/bothui/invite_mask.png",height:55}},{type:"Label",props:{y:36,x:1130,width:176,text:"好友上限：",height:48,fontSize:40,font:"fengyu",color:"#e6ba78"}},{type:"Label",props:{y:43,x:1325,width:201,text:"99/99",scaleY:.8,scaleX:.8,name:"count_limit",height:48,fontSize:45,font:"haolong",color:"#e6ba78",align:"left"}}]},{type:"Sprite",props:{y:11,x:296,width:200,name:"page_apply",height:200},child:[{type:"Sprite",props:{width:200,name:"scrollview",height:200},child:[{type:"Panel",props:{y:46,x:42,width:1436,name:"content",height:781},child:[{type:"Sprite",props:{width:1439,name:"templete",height:186},child:[{type:"Image",props:{y:4,x:7,width:1426,skin:"myres/lobby/frame_long.png",height:175,sizeGrid:"3,0,3,0"}},{type:"Button",props:{y:95,x:1019,width:156,stateNum:1,skin:"myres/btn_small.png",name:"check",height:70,anchorY:.5,anchorX:.5,sizeGrid:"30,30,30,30"},child:[{type:"Label",props:{y:9,x:39,width:82,text:"查看",height:39,fontSize:40,font:"fengyu",color:"#e6ba78"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:95,x:1175,width:156,stateNum:1,skin:"myres/btn_small.png",name:"agree",height:70,anchorY:.5,anchorX:.5,sizeGrid:"30,30,30,30"},child:[{type:"Label",props:{y:9,x:39,width:82,text:"同意",height:39,fontSize:40,font:"fengyu",color:"#e6ba78"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:95,x:1329,width:156,stateNum:1,skin:"myres/btn_small.png",name:"reject",height:70,anchorY:.5,anchorX:.5,sizeGrid:"30,30,30,30"},child:[{type:"Label",props:{y:9,x:39,width:82,text:"拒绝",height:39,fontSize:40,font:"fengyu",color:"#e6ba78"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Image",props:{y:86,x:822,width:255,scaleY:.6,scaleX:.6,pivotY:114,pivotX:128,name:"rank",height:253},child:[{type:"Image",props:{y:0,x:0,skin:"myres/rank_bg.png",name:"bg"}},{type:"Image",props:{y:15,x:0,skin:"extendRes/level/queshi.png",name:"icon"}},{type:"Image",props:{y:191,x:58,skin:"myres/starbg.png",scaleY:1,scaleX:1,name:"star2",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]},{type:"Image",props:{y:142,x:29,skin:"myres/starbg.png",scaleY:.7,scaleX:.7,name:"star3",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]},{type:"Image",props:{y:214,x:110,skin:"myres/starbg.png",scaleY:.7,scaleX:.7,name:"star1",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]}]},{type:"Script",props:{runtime:"capsui.UICopy"}},{type:"Image",props:{y:7,x:282,skin:"myres/bg_head1.png",scaleY:.75,scaleX:.75,name:"head"},child:[{type:"Image",props:{y:35,x:22,width:154,skin:"extendRes/charactor/yiji/smallhead.png",height:154}}]},{type:"Image",props:{y:35,x:424,width:292,skin:"extendRes/title/yuanchuzhihuo.png",name:"title",height:56}},{type:"Label",props:{y:108,x:441,text:"蹦蹦跳跳的仙太郎",name:"name",fontSize:35,font:"SimHei",color:"#eae6df",align:"center"}},{type:"Label",props:{y:77,x:20,width:235,text:"刚刚",name:"state",height:35,fontSize:28,font:"SimHei",color:"#dede54",align:"center"}}]}]},{type:"Sprite",props:{y:55,x:1473,width:50,name:"scrollbar",mouseThrough:!1,mouseEnabled:!0,height:750},child:[{type:"Image",props:{y:0,x:25,skin:"myres/scrollbar.png",name:"scrollbar",height:750,anchorX:.5}},{type:"Image",props:{y:96,x:25,width:45,skin:"myres/scrollpoint.png",name:"scrollpoint",height:45,anchorY:.5,anchorX:.5}}]},{type:"Sprite",props:{y:310,x:720,width:127,name:"loading",mouseThrough:!0,height:133},child:[{type:"Image",props:{y:67,x:26,skin:"myres/necessary/flower_nei.png",scaleY:1.2,scaleX:1.2,rotation:0,name:"flower",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:0,x:0,skin:"myres/necessary/flower_shine.png",name:"shine",alpha:1}},{type:"Image",props:{y:56,x:56,skin:"myres/necessary/round.png",name:"round",anchorY:.5,anchorX:.5}},{type:"Image",props:{y:142,x:0,skin:"myres/necessary/word.png"}}]},{type:"Script",props:{runtime:"capsui.CLoading"}}]},{type:"Script",props:{runtime:"capsui.NoLimitList"}}]},{type:"Label",props:{y:331,x:61,width:1418,text:"当前无好友申请",name:"noinfo",height:171,fontSize:50,font:"SimHei",color:"#e6ba78",align:"center"}}]}]}]},i}(View);t.friendUI=i}(e.lobby||(e.lobby={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.createView(e.lobby.guideUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Image",props:{width:1920,skin:"设计稿/7.jpg",height:1080}},{type:"Sprite",props:{y:28,x:205,width:1622,height:1e3},child:[{type:"Label",props:{y:27,x:474,text:"简单易懂的日麻教室·牌种一览",name:"title1",fontSize:45,font:"fengyu",color:"#e9af72"}},{type:"Sprite",props:{y:152,x:79,width:861,name:"1",height:268},child:[{type:"Image",props:{y:76,x:12,width:834,skin:"myres/lobby/guide_bg.png",name:"bg",height:179,sizeGrid:"8,6,10,4"}},{type:"Image",props:{y:17,x:13,width:190,skin:"myres/lobby/guide_tab.png",name:"tab",height:62,sizeGrid:"8,8,9,6"}},{type:"Label",props:{y:27,x:70,text:"万子",name:"title",fontSize:35,font:"fengyu",color:"#e9af72"}}]},{type:"Sprite",props:{y:152,x:1024,width:507,name:"2",height:268},child:[{type:"Image",props:{y:76,x:12,width:403,skin:"myres/lobby/guide_bg.png",name:"bg",height:179,sizeGrid:"8,6,10,4"}},{type:"Image",props:{y:17,x:13,width:190,skin:"myres/lobby/guide_tab.png",name:"tab",height:62,sizeGrid:"8,8,9,6"}},{type:"Label",props:{y:27,x:70,text:"风牌",name:"title",fontSize:35,font:"fengyu",color:"#e9af72"}}]},{type:"Sprite",props:{y:418,x:79,width:884,name:"3",height:268},child:[{type:"Image",props:{y:76,x:12,width:834,skin:"myres/lobby/guide_bg.png",name:"bg",height:179,sizeGrid:"8,6,10,4"}},{type:"Image",props:{y:17,x:13,width:190,skin:"myres/lobby/guide_tab.png",name:"tab",height:62,sizeGrid:"8,8,9,6"}},{type:"Label",props:{y:27,x:33,text:"筒子/饼子",name:"title",fontSize:35,font:"fengyu",color:"#e9af72"}}]},{type:"Sprite",props:{y:418,x:1024,width:507,name:"4",height:268},child:[{type:"Image",props:{y:76,x:12,width:403,skin:"myres/lobby/guide_bg.png",name:"bg",height:179,sizeGrid:"8,6,10,4"}},{type:"Image",props:{y:17,x:13,width:190,skin:"myres/lobby/guide_tab.png",name:"tab",height:62,sizeGrid:"8,8,9,6"}},{type:"Label",props:{y:27,x:61,text:"三元牌",name:"title",fontSize:35,font:"fengyu",color:"#e9af72"}}]},{type:"Sprite",props:{y:690,x:79,width:884,name:"5",height:268},child:[{type:"Image",props:{y:76,x:12,width:834,skin:"myres/lobby/guide_bg.png",name:"bg",height:179,sizeGrid:"8,6,10,4"}},{type:"Image",props:{y:17,x:13,width:190,skin:"myres/lobby/guide_tab.png",name:"tab",height:62,sizeGrid:"8,8,9,6"}},{type:"Label",props:{y:27,x:34,text:"条子/索子",name:"title",fontSize:35,font:"fengyu",color:"#e9af72"}}]},{type:"Label",props:{y:27,x:474,text:"简单易懂的日麻教室·怎么和牌",name:"title2",fontSize:45,font:"fengyu",color:"#e9af72"}},{type:"Sprite",props:{y:106,x:63,width:1395,name:"6",height:312},child:[{type:"Image",props:{y:76,x:12,width:1375,skin:"myres/lobby/guide_bg.png",name:"bg",height:225,sizeGrid:"8,6,10,4"}},{type:"Image",props:{y:17,x:13,width:190,skin:"myres/lobby/guide_tab.png",name:"tab",height:62,sizeGrid:"8,8,9,6"}},{type:"Label",props:{y:27,x:70,text:"手牌",name:"title",fontSize:35,font:"fengyu",color:"#e9af72"}},{type:"Label",props:{y:103,x:38,width:248,text:"手牌由13张牌构成",height:40,fontSize:30,font:"SimHei",color:"#dbd5d5"}}]},{type:"Sprite",props:{y:408,x:63,width:431,name:"7",height:312},child:[{type:"Image",props:{y:76,x:12,width:405,skin:"myres/lobby/guide_bg.png",name:"bg",height:225,sizeGrid:"8,6,10,4"}},{type:"Image",props:{y:17,x:13,width:190,skin:"myres/lobby/guide_tab.png",name:"tab",height:62,sizeGrid:"8,8,9,6"}},{type:"Label",props:{y:27,x:70,text:"顺子",name:"title",fontSize:35,font:"fengyu",color:"#e9af72"}},{type:"Label",props:{y:103,x:38,width:248,text:"3张同花色组成顺序数字的牌",height:40,fontSize:28,font:"SimHei",color:"#dbd5d5"}}]},{type:"Sprite",props:{y:408,x:549,width:431,name:"8",height:312},child:[{type:"Image",props:{y:76,x:12,width:405,skin:"myres/lobby/guide_bg.png",name:"bg",height:225,sizeGrid:"8,6,10,4"}},{type:"Image",props:{y:17,x:13,width:190,skin:"myres/lobby/guide_tab.png",name:"tab",height:62,sizeGrid:"8,8,9,6"}},{type:"Label",props:{y:27,x:70,text:"刻子",name:"title",fontSize:35,font:"fengyu",color:"#e9af72"}},{type:"Label",props:{y:103,x:38,width:248,text:"3张或4张相同的牌",height:40,fontSize:28,font:"SimHei",color:"#dbd5d5"}}]},{type:"Sprite",props:{y:408,x:1032,width:431,name:"9",height:312},child:[{type:"Image",props:{y:76,x:12,width:405,skin:"myres/lobby/guide_bg.png",name:"bg",height:225,sizeGrid:"8,6,10,4"}},{type:"Image",props:{y:17,x:13,width:190,skin:"myres/lobby/guide_tab.png",name:"tab",height:62,sizeGrid:"8,8,9,6"}},{type:"Label",props:{y:27,x:70,text:"雀头",name:"title",fontSize:35,font:"fengyu",color:"#e9af72"}},{type:"Label",props:{y:103,x:38,width:248,text:"2张相同的牌",height:40,fontSize:30,font:"SimHei",color:"#dbd5d5"}}]},{type:"Sprite",props:{y:705,x:63,width:1395,name:"10",height:312},child:[{type:"Image",props:{y:76,x:12,width:1375,skin:"myres/lobby/guide_bg.png",name:"bg",height:225,sizeGrid:"8,6,10,4"}},{type:"Image",props:{y:17,x:13,width:190,skin:"myres/lobby/guide_tab.png",name:"tab",height:62,sizeGrid:"8,8,9,6"}},{type:"Label",props:{y:27,x:70,text:"和牌",name:"title",fontSize:35,font:"fengyu",color:"#e9af72"}},{type:"Label",props:{y:103,x:38,width:248,text:"通常，手中的牌+自己摸到或别人打出的1张牌组成4组面子（顺子或刻子）+1副雀头即可和牌",height:40,fontSize:30,font:"SimHei",color:"#dbd5d5"}}]},{type:"Label",props:{y:27,x:474,text:"简单易懂的日麻教室·怎么和牌",name:"title3",fontSize:45,font:"fengyu",color:"#e9af72"}},{type:"Sprite",props:{y:125,x:-32,width:1570,name:"11",height:344},child:[{type:"Image",props:{y:76,x:12,width:1554,skin:"myres/lobby/guide_bg.png",name:"bg",height:261,sizeGrid:"8,6,10,4"}},{type:"Image",props:{y:17,x:13,width:190,skin:"myres/lobby/guide_tab.png",name:"tab",height:62,sizeGrid:"8,8,9,6"}},{type:"Label",props:{y:27,x:39,text:"日麻和牌",name:"title",fontSize:35,font:"fengyu",color:"#e9af72"}},{type:"Label",props:{y:103,x:38,width:922,text:"在日本麻将的规则里，无番是不能和牌的，可以用来和牌的番型就是“役”",height:40,fontSize:30,font:"SimHei",color:"#dbd5d5"}},{type:"Label",props:{y:158,x:38,width:922,text:"在雀魂中，一共采用了42种番（役）",height:40,fontSize:30,font:"SimHei",color:"#dbd5d5"}},{type:"Label",props:{y:216,x:38,width:922,text:"太多了记不住？不要慌",height:40,fontSize:30,font:"SimHei",color:"#dbd5d5"}},{type:"Label",props:{y:270,x:38,width:922,text:"你只需要先记住三种就可以了：断幺九、立直和役牌",height:40,fontSize:30,font:"SimHei",color:"#dbd5d5"}}]},{type:"Label",props:{y:27,x:474,text:"简单易懂的日麻教室·幺九牌",name:"title4",fontSize:45,font:"fengyu",color:"#e9af72"}},{type:"Sprite",props:{y:108,x:90,width:1395,name:"12",height:312},child:[{type:"Image",props:{y:76,x:12,width:1375,skin:"myres/lobby/guide_bg.png",name:"bg",height:225,sizeGrid:"8,6,10,4"}},{type:"Image",props:{y:17,x:13,width:190,skin:"myres/lobby/guide_tab.png",name:"tab",height:62,sizeGrid:"8,8,9,6"}},{type:"Label",props:{y:27,x:55,text:"幺九牌",name:"title",fontSize:35,font:"fengyu",color:"#e9af72"}},{type:"Label",props:{y:103,x:38,width:248,text:"所有1和9的数字牌，风牌（东南西北），三元牌（中发白）统称幺九牌",height:40,fontSize:30,font:"SimHei",color:"#dbd5d5"}}]},{type:"Sprite",props:{y:409,x:90,width:1395,name:"13",height:312},child:[{type:"Image",props:{y:76,x:12,width:1375,skin:"myres/lobby/guide_bg.png",name:"bg",height:225,sizeGrid:"8,6,10,4"}},{type:"Image",props:{y:17,x:13,width:190,skin:"myres/lobby/guide_tab.png",name:"tab",height:62,sizeGrid:"8,8,9,6"}},{type:"Label",props:{y:27,x:55,text:"断幺九",name:"title",fontSize:35,font:"fengyu",color:"#e9af72"}},{type:"Label",props:{y:103,x:38,width:248,text:"简单易懂的新手常用番，当手中所有的面子和雀头都不包含幺九牌时即为断幺九，可以和牌，计一番",height:40,fontSize:30,font:"SimHei",color:"#dbd5d5"}}]},{type:"Label",props:{y:27,x:474,text:"简单易懂的日麻教室·立直",name:"title5",fontSize:45,font:"fengyu",color:"#e9af72"}},{type:"Sprite",props:{y:106,x:23,width:1395,name:"14",height:312},child:[{type:"Image",props:{y:76,x:12,width:1443,skin:"myres/lobby/guide_bg.png",name:"bg",height:225,sizeGrid:"8,6,10,4"}},{type:"Image",props:{y:17,x:13,width:190,skin:"myres/lobby/guide_tab.png",name:"tab",height:62,sizeGrid:"8,8,9,6"}},{type:"Label",props:{y:27,x:73,text:"听牌",name:"title",fontSize:35,font:"fengyu",color:"#e9af72"}},{type:"Label",props:{y:103,x:38,width:248,text:"还差1张合适的牌就可以和牌的状态被称为听牌状态",height:40,fontSize:30,font:"SimHei",color:"#dbd5d5"}}]},{type:"Sprite",props:{y:408,x:23,width:1395,name:"15",height:312},child:[{type:"Image",props:{y:76,x:12,width:378,skin:"myres/lobby/guide_bg.png",name:"bg",height:225,sizeGrid:"8,6,10,4"}},{type:"Image",props:{y:17,x:13,width:190,skin:"myres/lobby/guide_tab.png",name:"tab",height:62,sizeGrid:"8,8,9,6"}},{type:"Label",props:{y:27,x:16,width:181,text:"吃",name:"title",height:35,fontSize:35,font:"fengyu",color:"#e9af72",align:"center"}},{type:"Label",props:{y:105,x:29,width:355,text:"上家（左边）打出的牌可",height:43,fontSize:30,font:"SimHei",color:"#dbd5d5"}},{type:"Label",props:{y:148,x:29,width:355,text:"以和你手中的2张牌组成",height:43,fontSize:30,font:"SimHei",color:"#dbd5d5"}},{type:"Label",props:{y:193,x:29,width:355,text:"顺子，就可以吃过来，并",height:43,fontSize:30,font:"SimHei",color:"#dbd5d5"}},{type:"Label",props:{y:237,x:29,width:355,text:"将该组顺子摊开放在一边",height:43,fontSize:30,font:"SimHei",color:"#dbd5d5"}}]},{type:"Sprite",props:{y:408,x:477,width:713,name:"16",height:312},child:[{type:"Image",props:{y:76,x:12,width:378,skin:"myres/lobby/guide_bg.png",name:"bg",height:225,sizeGrid:"8,6,10,4"}},{type:"Image",props:{y:17,x:13,width:190,skin:"myres/lobby/guide_tab.png",name:"tab",height:62,sizeGrid:"8,8,9,6"}},{type:"Label",props:{y:27,x:19,width:177,text:"碰",name:"title",height:35,fontSize:35,font:"fengyu",color:"#e9af72",align:"center"}},{type:"Label",props:{y:105,x:29,width:355,text:"别家打出的牌可以和你",height:43,fontSize:30,font:"SimHei",color:"#dbd5d5"}},{type:"Label",props:{y:148,x:29,width:355,text:"手中的2张牌组成刻子，",height:43,fontSize:30,font:"SimHei",color:"#dbd5d5"}},{type:"Label",props:{y:193,x:29,width:355,text:"就可以碰过来，并将该",height:43,fontSize:30,font:"SimHei",color:"#dbd5d5"}},{type:"Label",props:{y:237,x:29,width:355,text:"组刻子摊开放在一边",height:43,fontSize:30,font:"SimHei",color:"#dbd5d5"}}]},{type:"Sprite",props:{y:408,x:895,width:713,name:"17",height:312},child:[{type:"Image",props:{y:76,x:12,width:378,skin:"myres/lobby/guide_bg.png",name:"bg",height:225,sizeGrid:"8,6,10,4"}},{type:"Image",props:{y:17,x:13,width:190,skin:"myres/lobby/guide_tab.png",name:"tab",height:62,sizeGrid:"8,8,9,6"}},{type:"Label",props:{y:27,x:19,width:177,text:"杠",name:"title",height:35,fontSize:35,font:"fengyu",color:"#e9af72",align:"center"}},{type:"Label",props:{y:105,x:29,width:502,text:"杠子：4张相同的牌，杠算作一个刻子",height:43,fontSize:30,font:"SimHei",color:"#dbd5d5"}},{type:"Label",props:{y:145,x:29,width:355,text:"大明杠：和别家打出的牌组成一个杠子",height:43,fontSize:30,font:"SimHei",color:"#dbd5d5"}},{type:"Label",props:{y:180,x:29,width:355,text:"暗杠：自己手中的牌组成一个杠子",height:43,fontSize:30,font:"SimHei",color:"#dbd5d5"}},{type:"Label",props:{y:215,x:29,width:355,text:"加杠：碰出3张牌后，用自己摸到的第4",height:43,fontSize:30,font:"SimHei",color:"#dbd5d5"}},{type:"Label",props:{y:252,x:29,width:355,text:"张牌组成杠子",height:43,fontSize:30,font:"SimHei",color:"#dbd5d5"}}]},{type:"Sprite",props:{y:706,x:23,width:1395,name:"18",height:312},child:[{type:"Image",props:{y:76,x:12,width:1443,skin:"myres/lobby/guide_bg.png",name:"bg",height:225,sizeGrid:"8,6,10,4"}},{type:"Image",props:{y:17,x:13,width:190,skin:"myres/lobby/guide_tab.png",name:"tab",height:62,sizeGrid:"8,8,9,6"}},{type:"Label",props:{y:27,x:73,text:"立直",name:"title",fontSize:35,font:"fengyu",color:"#e9af72"}},{type:"Label",props:{y:103,x:38,width:248,text:"没有吃、碰、大明杠的前提下（门前清）进入听牌状态即可宣告立直，立直后只能挂机等和牌，计一番",height:40,fontSize:30,font:"SimHei",color:"#dbd5d5"}},{type:"Label",props:{y:177,x:1172,width:93,text:"门前",height:40,fontSize:30,font:"SimHei",color:"#41acde"}},{type:"Label",props:{y:232,x:1172,width:93,text:"立直",height:40,fontSize:30,font:"SimHei",color:"#41acde"}}]},{type:"Label",props:{y:27,x:474,text:"简单易懂的日麻教室·役牌",name:"title6",fontSize:45,font:"fengyu",color:"#e9af72"}},{type:"Sprite",props:{y:125,x:2,width:1532,name:"19",height:231},child:[{type:"Image",props:{y:76,x:12,width:1517,skin:"myres/lobby/guide_bg.png",name:"bg",height:145,sizeGrid:"8,6,10,4"}},{type:"Image",props:{y:17,x:13,width:190,skin:"myres/lobby/guide_tab.png",name:"tab",height:62,sizeGrid:"8,8,9,6"}},{type:"Label",props:{y:27,x:73,text:"役牌",name:"title",fontSize:35,font:"fengyu",color:"#e9af72"}},{type:"Label",props:{y:103,x:38,width:248,text:"役牌指的是三类特定的牌组成的刻子：场风牌，门风牌，三元牌",height:40,fontSize:30,font:"SimHei",color:"#dbd5d5"}},{type:"Label",props:{y:146,x:38,width:248,text:"当持有这三类牌的刻子（碰也可以）的时候就可以算一番，即满足了和牌必须有役的条件",height:40,fontSize:30,font:"SimHei",color:"#dbd5d5"}}]},{type:"Sprite",props:{y:342,x:3,width:749,name:"20",height:312},child:[{type:"Image",props:{y:76,x:12,width:717,skin:"myres/lobby/guide_bg.png",name:"bg",height:225,sizeGrid:"8,6,10,4"}},{type:"Image",props:{y:17,x:13,width:190,skin:"myres/lobby/guide_tab.png",name:"tab",height:62,sizeGrid:"8,8,9,6"}},{type:"Label",props:{y:27,x:16,width:181,text:"场风牌",name:"title",height:35,fontSize:35,font:"fengyu",color:"#e9af72",align:"center"}},{type:"Label",props:{y:106,x:37,width:679,text:"东风场的东，南风场的南，西风场的西就是场风牌",height:42,fontSize:30,font:"SimHei",color:"#dbd5d5"}},{type:"Image",props:{y:196,x:64,width:136,skin:"myres/lobby/east2.png",height:51}}]},{type:"Sprite",props:{y:342,x:755,width:749,name:"21",height:312},child:[{type:"Image",props:{y:76,x:12,width:764,skin:"myres/lobby/guide_bg.png",name:"bg",height:225,sizeGrid:"8,6,10,4"}},{type:"Image",props:{y:17,x:13,width:190,skin:"myres/lobby/guide_tab.png",name:"tab",height:62,sizeGrid:"8,8,9,6"}},{type:"Label",props:{y:27,x:16,width:181,text:"门风牌",name:"title",height:35,fontSize:35,font:"fengyu",color:"#e9af72",align:"center"}},{type:"Label",props:{y:106,x:31,width:679,text:"东家的东，南家的南，西家的西，北家的北就是门风牌",height:42,fontSize:30,font:"SimHei",color:"#dbd5d5"}},{type:"Image",props:{y:192,x:110,width:93,skin:"myres/lobby/south.png",height:63}}]},{type:"Sprite",props:{y:642,x:3,width:1395,name:"22",height:312},child:[{type:"Image",props:{y:76,x:12,width:961,skin:"myres/lobby/guide_bg.png",name:"bg",height:225,sizeGrid:"8,6,10,4"}},{type:"Image",props:{y:17,x:13,width:190,skin:"myres/lobby/guide_tab.png",name:"tab",height:62,sizeGrid:"8,8,9,6"}},{type:"Label",props:{y:27,x:14,width:190,text:"三元牌",name:"title",height:35,fontSize:35,font:"fengyu",color:"#e9af72",align:"center"}},{type:"Label",props:{y:103,x:38,width:248,text:"白、发、中这三种牌就是三元牌",height:40,fontSize:30,font:"SimHei",color:"#dbd5d5"}}]},{type:"Label",props:{y:27,x:474,text:"简单易懂的日麻教室·结束",name:"title7",fontSize:45,font:"fengyu",color:"#e9af72"}},{type:"Sprite",props:{y:107,x:21,width:1532,name:"23",height:231},child:[{type:"Image",props:{y:76,x:12,width:1447,skin:"myres/lobby/guide_bg.png",name:"bg",height:222,sizeGrid:"8,6,10,4"}},{type:"Image",props:{y:17,x:13,width:190,skin:"myres/lobby/guide_tab.png",name:"tab",height:62,sizeGrid:"8,8,9,6"}},{type:"Label",props:{y:27,x:11,width:191,text:"出师了",name:"title",height:35,fontSize:35,font:"fengyu",color:"#e9af72",align:"center"}},{type:"Label",props:{y:135,x:38,width:1394,text:"看完本教程，你已经掌握了日本麻将的基本玩法，可以开始快乐的游玩了~！",height:40,fontSize:30,font:"SimHei",color:"#dbd5d5",align:"center"}},{type:"Label",props:{y:200,x:38,width:1405,text:"更多番型介绍可在“设置”——“番型一览”中查看",height:40,fontSize:30,font:"SimHei",color:"#dbd5d5",align:"center"}}]}]}]},i}(View);t.guideUI=i}(e.lobby||(e.lobby={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("Text",laya.display.Text),View.regComponent("capsui.UICopy",capsui.UICopy),t.prototype.createChildren.call(this),this.createView(e.lobby.infoUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Sprite",props:{y:581,x:934,width:800,pivotY:350,pivotX:400,name:"root",height:700},child:[{type:"Image",props:{y:328,x:417,width:885,skin:"myres/pop_bg.png",name:"bg0",height:800,anchorY:.5,anchorX:.5,sizeGrid:"100,100,100,100"},child:[{type:"Image",props:{y:28,x:32,width:98,skin:"myres/pop_texturecut.png",name:"left",height:744,sizeGrid:"0,0,24,26"}},{type:"Image",props:{y:27,x:855,width:110,skin:"myres/pop_texturecut.png",scaleX:-1,name:"right",height:745,sizeGrid:"0,0,24,26"}},{type:"Image",props:{y:38,x:34,width:822,skin:"myres/pop_black.png",name:"bar",height:73}},{type:"Image",props:{y:118,x:35,width:821,skin:"myres/pop_black.png",name:"bar",height:645}}]},{type:"Image",props:{y:328,x:417,width:885,skin:"myres/pop_bound.png",name:"bound",height:800,anchorY:.5,anchorX:.5,sizeGrid:"131,102,97,106"}},{type:"Label",props:{y:-21,x:337,width:131,text:"公告栏",name:"title",height:42,fontSize:46,font:"fengyu",color:"#e9ae85"}},{type:"Button",props:{y:-40,x:830,width:80,pivotY:43,pivotX:43,name:"btn_close",height:80},child:[{type:"Image",props:{y:5,x:7,width:72,skin:"myres/btn_close.png",name:"close",height:72}}]},{type:"Panel",props:{y:45,x:9,width:803,vScrollBarSkin:"myres/vscroll.png",name:"info",height:642},child:[{type:"Sprite",props:{y:0,x:24,width:781,name:"templete",height:155},child:[{type:"Button",props:{y:8,x:10,width:754,name:"btn_open",height:90},child:[{type:"Image",props:{y:0,x:0,width:754,skin:"myres/lobby/btn-info.png",height:92}},{type:"Text",props:{y:4,x:48,wordWrap:!0,width:602,valign:"middle",text:"12月12日更新维护公告这个标题如果不",name:"info_title",height:81,fontSize:34,font:"SimHei",color:"#e9c18a",align:"center"}},{type:"Image",props:{y:64,x:707,width:58,skin:"myres/lobby/open_arrow.png",scaleY:1,rotation:0,name:"arrow",height:19,anchorY:.8,anchorX:.5}},{type:"Sprite",props:{y:110,x:27,width:726,name:"content",height:446},child:[{type:"Text",props:{y:0,x:0,wordWrap:!0,width:719,text:"公告内容好几百个公告内容好几百个公告内容好几百公告内容好几百个公告内容好几百个公告内容好几百公告内容好几百个公告内容好几百个公告内容好几百公告内容好几百个公告内容好几百个公告内容好几百公告内容好几百个公告内容好几百个公告内容好几百",leading:10,height:99,fontSize:28,font:"SimHei",color:"#cdc9c9"}}]}]},{type:"Image",props:{y:-3,x:702,width:65,skin:"myres/lobby/new.png",name:"new",height:49}},{type:"Script",props:{runtime:"capsui.UICopy"}}]}]}]}]},i}(View);t.infoUI=i}(e.lobby||(e.lobby={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.UICopy",capsui.UICopy),t.prototype.createChildren.call(this),this.createView(e.lobby.introduceUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Image",props:{y:-40,x:-40,width:2020,skin:"myres/bbg.png",name:"bmask",height:1180,alpha:.3,sizeGrid:"1,1,1,1"},child:[{type:"Button",props:{width:2020,name:"btn",height:1180}},{type:"Sprite",props:{y:104,x:577,width:780,name:"unhit",height:932}}]},{type:"Sprite",props:{y:537,x:943,width:813,pivotY:493,pivotX:419,name:"root",height:992},child:[{type:"Image",props:{y:22,x:11,width:780,skin:"myres/pop2_bg.png",name:"bg0",height:927,sizeGrid:"2,2,2,2"}},{type:"Image",props:{y:22,x:11,width:780,skin:"myres/pop2_bound.png",name:"bound",height:927,sizeGrid:"24,27,11,21"}},{type:"Label",props:{y:15,x:324,width:165,valign:"middle",text:"段位说明",height:76,fontSize:40,font:"fengyu",color:"#e8af71",align:"center"}},{type:"Panel",props:{y:122,x:69,width:679,vScrollBarSkin:"myres/vscroll.png",name:"content",height:783},child:[{type:"Sprite",props:{y:141,x:228,width:181,name:"templete",height:76},child:[{type:"Image",props:{width:181,skin:"myres/lobby/cell.png",name:"bound",height:76,sizeGrid:"4,4,4,4"}},{type:"Label",props:{y:0,x:0,width:258,valign:"middle",text:"段位级别",scaleY:.7,scaleX:.7,name:"info",height:108,fontSize:30,font:"fengyu",color:"#e8af71",align:"center"}},{type:"Script",props:{runtime:"capsui.UICopy"}}]}]}]}]},i}(View);t.introduceUI=i}(e.lobby||(e.lobby={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.CButton",capsui.CButton),t.prototype.createChildren.call(this),this.createView(e.lobby.lobbyUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Sprite",props:{y:0,x:0,width:1686,pivotY:0,pivotX:0,name:"page0",height:851},child:[{type:"Button",props:{y:736,x:1123,width:597,scaleY:1.2,scaleX:1.2,pivotY:76,pivotX:72,name:"btn_yourenfang",height:208,alpha:1},child:[{type:"Image",props:{y:11,x:28,width:551,skin:"myres/lobby/btn_yourenchang.png",height:192}}]},{type:"Button",props:{y:547,x:1110,width:591,scaleY:1.2,scaleX:1.2,pivotY:93,pivotX:76,name:"btn_dajiangsai",height:176,alpha:1},child:[{type:"Image",props:{y:2,x:42,width:545,skin:"myres/lobby/btn_dajiangsai.png",height:188}}]},{type:"Button",props:{y:368,x:1183,width:543,scaleY:1.2,scaleX:1.2,pivotY:148,pivotX:99,name:"btn_yibanchang",height:190,alpha:1},child:[{type:"Image",props:{y:2,x:13,width:516,skin:"myres/lobby/btn_yibanchang.png",height:201}}]},{type:"Sprite",props:{y:0,x:0,name:"effect"}}]},{type:"Sprite",props:{name:"page1"},child:[{type:"Sprite",props:{y:315,x:1101,width:553,name:"p0",height:594},child:[{type:"Panel",props:{y:0,x:0,width:640,vScrollBarSkin:"myres/vscroll.png",name:"content",height:590},child:[{type:"Sprite",props:{y:0,x:20,width:560,name:"btn0",height:183},compId:139,child:[{type:"Sprite",props:{y:0,x:0,width:562,name:"container",height:189},child:[{type:"Button",props:{y:3,x:0,width:547,stateNum:1,skin:"myres/lobby/bg_yibanchang.png",name:"btn",height:186}},{type:"Image",props:{y:43,x:132,width:261,skin:"myres/lobby/room1.png",name:"icon",height:87}},{type:"Button",props:{y:64,x:492,width:72,stateNum:1,name:"btn_tips",height:72,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:9,x:11,width:50,skin:"myres/lobby/tips.png",height:50}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Label",props:{y:138,x:144,width:309,visible:!0,valign:"middle",text:"初心、雀士",scaleY:.8,scaleX:.8,height:52,fontSize:28,font:"fengyu",color:"#ded4d4",align:"center"}}]},{type:"Image",props:{y:32,x:370,width:196,skin:"myres/lobby/closed.png",name:"stop",height:147}}]},{type:"Sprite",props:{y:166,x:20,width:560,name:"btn1",height:183},compId:364,child:[{type:"Sprite",props:{y:0,x:0,width:562,name:"container",height:189},child:[{type:"Button",props:{y:3,x:0,width:547,stateNum:1,skin:"myres/lobby/bg_yibanchang.png",name:"btn",height:186}},{type:"Image",props:{y:43,x:128,width:273,skin:"myres/lobby/room2.png",name:"icon",height:92}},{type:"Button",props:{y:64,x:492,width:72,stateNum:1,name:"btn_tips",height:72,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:9,x:11,width:50,skin:"myres/lobby/tips.png",height:50}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Label",props:{y:138,x:144,width:309,visible:!0,valign:"middle",text:"雀士、雀杰",scaleY:.8,scaleX:.8,height:52,fontSize:28,font:"fengyu",color:"#ded4d4",align:"center"}}]},{type:"Image",props:{y:32,x:370,width:196,skin:"myres/lobby/closed.png",name:"stop",height:147}}]},{type:"Sprite",props:{y:332,x:20,width:560,name:"btn2",height:183},compId:373,child:[{type:"Sprite",props:{y:0,x:0,width:562,name:"container",height:189},child:[{type:"Button",props:{y:3,x:0,width:547,stateNum:1,skin:"myres/lobby/bg_yibanchang.png",name:"btn",height:186}},{type:"Image",props:{y:38,x:128,width:269,skin:"myres/lobby/room3.png",name:"icon",height:91}},{type:"Button",props:{y:64,x:492,width:72,stateNum:1,name:"btn_tips",height:72,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:9,x:11,width:50,skin:"myres/lobby/tips.png",height:50}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Label",props:{y:138,x:144,width:309,visible:!0,valign:"middle",text:"雀杰、雀豪",scaleY:.8,scaleX:.8,height:52,fontSize:28,font:"fengyu",color:"#ded4d4",align:"center"}}]},{type:"Image",props:{y:32,x:370,width:196,skin:"myres/lobby/closed.png",name:"stop",height:147}}]},{type:"Sprite",props:{y:499,x:20,width:560,name:"btn3",height:183},compId:382,child:[{type:"Sprite",props:{y:0,x:0,width:562,name:"container",height:189},child:[{type:"Button",props:{y:3,x:0,width:547,stateNum:1,skin:"myres/lobby/bg_yibanchang.png",name:"btn",height:186}},{type:"Image",props:{y:44,x:143,width:259,skin:"myres/lobby/room4.png",name:"icon",height:87}},{type:"Button",props:{y:64,x:492,width:72,stateNum:1,name:"btn_tips",height:72,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:9,x:11,width:50,skin:"myres/lobby/tips.png",height:50}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Label",props:{y:138,x:144,width:309,visible:!0,valign:"middle",text:"雀豪以上",scaleY:.8,scaleX:.8,height:52,fontSize:28,font:"fengyu",color:"#ded4d4",align:"center"}}]},{type:"Image",props:{y:32,x:370,width:196,skin:"myres/lobby/closed.png",name:"stop",height:147}}]}]}]},{type:"Sprite",props:{y:292,x:1080,width:640,name:"p1",height:590},child:[{type:"Panel",props:{y:23,x:0,width:640,vScrollBarSkin:"myres/vscroll.png",name:"content",height:590},child:[{type:"Sprite",props:{y:4,x:38,width:543,name:"btn0",height:182},compId:155,child:[{type:"Button",props:{y:-1,x:4,width:547,stateNum:1,skin:"myres/lobby/bg_yibanchang.png",name:"btn",height:186}},{type:"Button",props:{y:58,x:496,width:73,stateNum:1,name:"btn_tips",height:73,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:10,x:11,width:50,skin:"myres/lobby/tips.png",height:50}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Image",props:{y:40,x:163,width:217,skin:"myres/lobby/mode1.png",scaleY:1.2,scaleX:1.2,name:"icon",height:74}},{type:"Label",props:{y:136,x:186,width:81,text:"在线：",scaleY:.7,scaleX:.7,name:"online",height:50,fontSize:28,font:"fengyu",color:"#ece6d6"}},{type:"Label",props:{y:143,x:304,text:"99",name:"count",fontSize:28,font:"SimHei",color:"#ece6d6",align:"left"}}]},{type:"Sprite",props:{y:170,x:38,width:543,name:"btn1",height:182},compId:391,child:[{type:"Button",props:{y:-1,x:4,width:547,stateNum:1,skin:"myres/lobby/bg_yibanchang.png",name:"btn",height:186}},{type:"Button",props:{y:58,x:496,width:73,stateNum:1,name:"btn_tips",height:73,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:10,x:11,width:50,skin:"myres/lobby/tips.png",height:50}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Image",props:{y:42,x:164,width:217,skin:"myres/lobby/mode2.png",scaleY:1.2,scaleX:1.2,name:"icon",height:67}},{type:"Label",props:{y:136,x:186,width:81,text:"在线：",scaleY:.7,scaleX:.7,name:"online",height:50,fontSize:28,font:"fengyu",color:"#ece6d6"}},{type:"Label",props:{y:143,x:304,text:"99",name:"count",fontSize:28,font:"SimHei",color:"#ece6d6",align:"left"}}]}]}]},{type:"Image",props:{y:231,x:1075,width:628,skin:"myres/lobby/bg_back0.png",name:"container_title",mouseThrough:!1,height:73},compId:53,child:[{type:"Label",props:{y:-1,x:248,width:138,valign:"middle",text:"一般场",scaleY:1.4,scaleX:1.4,name:"title",height:45,fontSize:65,font:"hanyi",color:"#e4b582",align:"center"}},{type:"Button",props:{y:38,x:150,width:219,pivotY:40,pivotX:104,name:"btn_back",height:73},child:[{type:"Image",props:{y:18,x:50,skin:"myres/img_return2.png",scaleY:1,scaleX:1}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]}]},{type:"Sprite",props:{name:"page2"},child:[{type:"Image",props:{y:231,x:1075,width:628,skin:"myres/lobby/bg_back0.png",name:"title",height:73},compId:70,child:[{type:"Label",props:{y:-4,x:174,width:265,valign:"middle",text:"友人房",scaleY:1.3,scaleX:1.3,height:63,fontSize:65,font:"hanyi",color:"#e4b582",align:"center"}},{type:"Button",props:{y:37,x:148,width:163,pivotY:34,pivotX:73,name:"btn_back",height:64},child:[{type:"Image",props:{y:12,x:23,skin:"myres/img_return2.png",scaleY:1,scaleX:1}},{type:"Script",props:{y:0,x:-1,runtime:"capsui.CButton"}}]}]},{type:"Panel",props:{y:318,x:1084,width:628,name:"content",height:504},child:[{type:"Button",props:{y:167,x:38,width:547,stateNum:1,skin:"myres/lobby/bg_yourenchang.png",name:"btn1",height:186},compId:408,child:[{type:"Image",props:{y:48,x:118,width:303,skin:"myres/lobby/btn_add_room.png",height:74}},{type:"Button",props:{y:15,x:0,width:569,name:"btn",height:183}},{type:"Button",props:{y:59,x:493,width:72,name:"btn_tips",mouseThrough:!1,height:72,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:10,x:10,width:50,skin:"myres/lobby/tips.png",height:50}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Label",props:{y:137,x:205,text:"限时免费",scaleY:.8,scaleX:.8,fontSize:28,font:"fengyu",color:"#ece5d8"}}]},{type:"Button",props:{y:1,x:38,width:547,stateNum:1,skin:"myres/lobby/bg_yourenchang.png",name:"btn0",height:186},compId:73,child:[{type:"Image",props:{y:48,x:118,width:303,skin:"myres/lobby/btn_create_room.png",height:74}},{type:"Button",props:{y:0,x:0,width:560,name:"btn",height:185}},{type:"Button",props:{y:59,x:493,width:72,name:"btn_tips",mouseThrough:!1,height:72,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:10,x:10,width:50,skin:"myres/lobby/tips.png",height:50}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Label",props:{y:137,x:205,text:"限时免费",scaleY:.8,scaleX:.8,fontSize:28,font:"fengyu",color:"#ece5d8"}}]}]}]},{type:"Sprite",props:{name:"page3"},child:[{type:"Panel",props:{y:315,x:1101,width:640,vScrollBarSkin:"myres/vscroll.png",name:"content",height:590},child:[{type:"Sprite",props:{y:0,x:20,width:560,name:"btn0",height:183},compId:428,child:[{type:"Sprite",props:{y:0,x:0,width:562,name:"container",height:189},child:[{type:"Button",props:{y:3,x:0,width:547,stateNum:1,skin:"myres/lobby/bg_bisaichang.png",name:"btn",height:186}},{type:"Image",props:{y:49,x:121,width:265,skin:"myres/lobby/btn_saishidating.png",scaleY:1.2,scaleX:1.2,name:"icon",height:76}},{type:"Button",props:{y:64,x:492,width:72,name:"btn_tips",height:72,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:9,x:11,width:50,skin:"myres/lobby/tips.png",height:50}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Label",props:{y:138,x:144,width:309,visible:!0,valign:"middle",text:"火热进行",scaleY:.8,scaleX:.8,height:52,fontSize:28,font:"fengyu",color:"#ded4d4",align:"center"}}]}]}]},{type:"Image",props:{y:231,x:1075,width:628,skin:"myres/lobby/bg_back0.png",name:"title",mouseThrough:!1,height:73},compId:482,child:[{type:"Label",props:{y:-1,x:248,width:138,valign:"middle",text:"比赛场",scaleY:1.4,scaleX:1.4,name:"title",height:45,fontSize:65,font:"hanyi",color:"#e4b582",align:"center"}},{type:"Button",props:{y:38,x:150,width:219,pivotY:40,pivotX:104,name:"btn_back",height:73},child:[{type:"Image",props:{y:18,x:50,skin:"myres/img_return2.png",scaleY:1,scaleX:1}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]}]},{type:"Sprite",props:{y:1459,x:504,name:"skeleton",alpha:1}},{type:"Sprite",props:{y:0,x:-312,name:"illust",alpha:0},compId:237,child:[{type:"Image",props:{y:123,x:23,width:912,skin:"extendRes/charactor/yiji/full.png",name:"illust",height:1373,alpha:1}},{type:"Sprite",props:{y:795,x:172,width:674,name:"chat",height:226},child:[{type:"Image",props:{y:15,x:25,width:633,skin:"myres/bothui/bf_chat.png",name:"bg",height:190,sizeGrid:"14,14,13,14"}},{type:"Label",props:{y:42,x:55,wordWrap:!0,width:578,text:"喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵",name:"info",leading:8,height:138,fontSize:29,font:"SimHei",color:"#cecece"}}]},{type:"Button",props:{y:141,x:90,width:776,name:"btn",height:1036}}]},{type:"Sprite",props:{y:-124,x:3,width:1939,name:"container_top",height:162},compId:82,child:[{type:"Image",props:{y:-1,x:10,width:481,skin:"myres/lobby/bg_2.png",height:164}},{type:"Image",props:{y:87,x:92,width:255,pivotY:114,pivotX:128,name:"rank",height:253},child:[{type:"Image",props:{y:51,x:37,width:170,skin:"extendRes/level/queshi.png",name:"icon",height:129}},{type:"Image",props:{y:143,x:71,width:26,skin:"myres/starbg.png",name:"star2",height:26},child:[{type:"Image",props:{width:26,skin:"myres/star.png",height:26}}]},{type:"Image",props:{y:122,x:52,width:26,skin:"myres/starbg.png",name:"star3",height:26},child:[{type:"Image",props:{width:26,skin:"myres/star.png",height:26}}]},{type:"Image",props:{y:162,x:93,width:26,skin:"myres/starbg.png",name:"star1",height:26},child:[{type:"Image",props:{width:26,skin:"myres/star.png",height:26}}]}]},{type:"Image",props:{y:28,x:154,width:242,skin:"extendRes/title/notitle.png",name:"img_title",height:46}},{type:"Button",props:{y:78,x:892,width:294,name:"container_gold0",height:89,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Image",props:{y:3,x:38,width:253,skin:"myres/lobby/bg_0.png",name:"bg",height:88}},{type:"Image",props:{y:8,x:10,width:70,skin:"myres/gold0.png",scaleY:1,scaleX:1,name:"icon",height:70}},{type:"Label",props:{y:25,x:77,width:125,valign:"middle",text:"9.024亿",name:"label_gold",height:39,fontSize:35,font:"SimHei",color:"#ffffff",align:"right"}}]},{type:"Button",props:{y:78,x:1183,width:294,name:"container_gold1",height:89,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Image",props:{y:3,x:38,width:253,skin:"myres/lobby/bg_0.png",name:"bg",height:88}},{type:"Image",props:{y:8,x:10,width:70,skin:"myres/gold1.png",scaleY:1,scaleX:1,name:"icon",height:70}},{type:"Label",props:{y:25,x:77,width:125,valign:"middle",text:"1000",name:"label_gold",height:39,fontSize:35,font:"SimHei",color:"#ffffff",align:"right"}}]},{type:"Button",props:{y:90,x:1591,width:103,stateNum:1,skin:"myres/lobby/denglong.png",pivotY:93,pivotX:50,name:"btn_rank",height:165},child:[{type:"Label",props:{y:65,x:10,width:93,text:"排名",scaleY:.85,scaleX:.85,height:44,fontSize:35,font:"fengyu",color:"#593c1c",align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:86,x:1723,width:103,stateNum:1,skin:"myres/lobby/denglong.png",pivotY:88,pivotX:49,name:"btn_info",height:165},child:[{type:"Label",props:{y:65,x:10,width:93,text:"公告",scaleY:.85,scaleX:.85,height:44,fontSize:35,font:"fengyu",color:"#593c1c",align:"center"}},{type:"Image",props:{y:90,x:-14,width:51,skin:"myres/lobby/redpoint.png",name:"redpoint",height:51}},{type:"Script",props:{y:0,x:-1,runtime:"capsui.CButton"}}]},{type:"Button",props:{y:94,x:1440,width:145,stateNum:1,skin:"myres/lobby/icon_act.png",name:"btn_activity",height:190,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:90,x:-15,width:51,skin:"myres/lobby/redpoint.png",name:"redpoint",height:51}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:-4,x:-9,width:515,name:"btn_playerinfo",height:180}},{type:"Button",props:{y:79,x:1848,width:120,name:"btn_set",height:120,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Image",props:{y:60,x:60,width:88,skin:"myres/lobby/btn_set.png",height:88,anchorY:.5,anchorX:.5}}]},{type:"Label",props:{y:95,x:151,width:266,text:"蹦蹦跳跳的仙太郎",name:"label_name",height:39,fontSize:30,font:"SimHei",color:"#ffffff",align:"center"}}]},{type:"Sprite",props:{x:-159,pivotX:-159,name:"container_btns"},child:[{type:"Button",props:{y:1163,x:946,width:134,stateNum:1,skin:"myres/lobby/btn1.png",height:112,anchorY:.5,anchorX:.5},compId:103,child:[{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:1160,x:1097,width:148,stateNum:1,skin:"myres/lobby/btn4.png",height:117,anchorY:.5,anchorX:.5},compId:104,child:[{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Image",props:{y:5,x:108,skin:"myres/lobby/redpoint.png",name:"redpoint"}}]},{type:"Button",props:{y:1159,x:1243,width:130,stateNum:1,skin:"myres/lobby/btn0.png",height:118,anchorY:.5,anchorX:.5},compId:105,child:[{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:1164,x:1382,width:127,stateNum:1,skin:"myres/lobby/btn2.png",height:112,anchorY:.5,anchorX:.5},compId:106,child:[{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:1165,x:1515,width:121,stateNum:1,skin:"myres/lobby/btn5.png",height:106,anchorY:.5,anchorX:.5},compId:107,child:[{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:1165,x:1652,width:129,stateNum:1,skin:"myres/lobby/btn3.png",height:113,anchorY:.5,anchorX:.5},compId:416,child:[{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:1165,x:1826,width:183,stateNum:1,skin:"myres/lobby/btn6.png",height:160,anchorY:.5,anchorX:.5},compId:421,child:[{type:"Script",props:{runtime:"capsui.CButton"}}]}]}],animations:[{nodes:[{target:103,keyframes:{y:[{value:1163,tweenMethod:"circOut",tween:!0,target:103,key:"y",index:0},{value:1009,tweenMethod:"linearNone",tween:!0,target:103,key:"y",index:6}]}},{target:104,keyframes:{y:[{value:1160,tweenMethod:"backInOut",tween:!0,target:104,key:"y",index:0},{value:1160,tweenMethod:"circOut",tween:!0,target:104,label:null,key:"y",index:1},{value:1005,tweenMethod:"linearNone",tween:!0,target:104,key:"y",index:7}]}},{target:105,keyframes:{y:[{value:1159,tweenMethod:"backInOut",tween:!0,target:105,key:"y",index:0},{value:1159,tweenMethod:"circOut",tween:!0,target:105,label:null,key:"y",index:2},{value:1009,tweenMethod:"linearNone",tween:!0,target:105,key:"y",index:8}]}},{target:106,keyframes:{y:[{value:1164,tweenMethod:"backInOut",tween:!0,target:106,key:"y",index:0},{value:1164,tweenMethod:"circOut",tween:!0,target:106,label:null,key:"y",index:3},{value:1012,tweenMethod:"linearNone",tween:!0,target:106,key:"y",index:9}]}},{target:107,keyframes:{y:[{value:1165,tweenMethod:"backInOut",tween:!0,target:107,key:"y",index:0},{value:1165,tweenMethod:"circOut",tween:!0,target:107,label:null,key:"y",index:4},{value:1012,tweenMethod:"linearNone",tween:!0,target:107,key:"y",index:10}]}},{target:82,keyframes:{y:[{value:-124,tweenMethod:"strongOut",tween:!0,target:82,key:"y",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:82,key:"y",index:11}],x:[{value:3,tweenMethod:"backInOut",tween:!0,target:82,key:"x",index:0},{value:3,tweenMethod:"linearNone",tween:!0,target:82,key:"x",index:11}]}},{target:237,keyframes:{x:[{value:0,tweenMethod:"linearNone",tween:!0,target:237,key:"x",index:0},{value:250,tweenMethod:"backOut",tween:!0,target:237,key:"x",index:12},{value:0,tweenMethod:"linearNone",tween:!0,target:237,key:"x",index:20}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:237,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:237,key:"alpha",index:12},{value:1,tweenMethod:"linearNone",tween:!0,target:237,key:"alpha",index:16}]}},{target:416,keyframes:{y:[{value:1165,tweenMethod:"linearNone",tween:!0,target:416,key:"y",index:0},{value:1165,tweenMethod:"cubicOut",tween:!0,target:416,key:"y",index:5},{value:1009,tweenMethod:"linearNone",tween:!0,target:416,key:"y",index:11}]}},{target:421,keyframes:{y:[{value:1165,tweenMethod:"linearNone",tween:!0,target:421,key:"y",index:0},{value:1165,tweenMethod:"cubicOut",tween:!0,target:421,key:"y",index:6},{value:984,tweenMethod:"linearNone",tween:!0,target:421,key:"y",index:12}]}}],name:"in",id:1,frameRate:30,action:0},{nodes:[{target:103,keyframes:{y:[{value:1009,tweenMethod:"linearNone",tween:!0,target:103,label:null,key:"y",index:0},{value:1009,tweenMethod:"linearNone",tween:!0,target:103,label:null,key:"y",index:1},{value:1163,tweenMethod:"circOut",tween:!0,target:103,label:null,key:"y",index:6}]}},{target:104,keyframes:{y:[{value:1005,tweenMethod:"linearNone",tween:!0,target:104,label:null,key:"y",index:0},{value:1005,tweenMethod:"linearNone",tween:!0,target:104,label:null,key:"y",index:1},{value:1160,tweenMethod:"circOut",tween:!0,target:104,label:null,key:"y",index:6}]}},{target:105,keyframes:{y:[{value:1009,tweenMethod:"linearNone",tween:!0,target:105,label:null,key:"y",index:0},{value:1009,tweenMethod:"linearNone",tween:!0,target:105,label:null,key:"y",index:1},{value:1159,tweenMethod:"circOut",tween:!0,target:105,label:null,key:"y",index:6}]}},{target:106,keyframes:{y:[{value:1012,tweenMethod:"linearNone",tween:!0,target:106,label:null,key:"y",index:0},{value:1012,tweenMethod:"linearNone",tween:!0,target:106,label:null,key:"y",index:1},{value:1164,tweenMethod:"circOut",tween:!0,target:106,label:null,key:"y",index:6}]}},{target:107,keyframes:{y:[{value:1012,tweenMethod:"linearNone",tween:!0,target:107,label:null,key:"y",index:0},{value:1012,tweenMethod:"linearNone",tween:!0,target:107,label:null,key:"y",index:1},{value:1165,tweenMethod:"circOut",tween:!0,target:107,label:null,key:"y",index:6}]}},{target:82,keyframes:{y:[{value:0,tweenMethod:"linearNone",tween:!0,target:82,label:null,key:"y",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:82,label:null,key:"y",index:1},{value:-124,tweenMethod:"backInOut",tween:!0,target:82,label:null,key:"y",index:6}],x:[{value:3,tweenMethod:"linearNone",tween:!0,target:82,label:null,key:"x",index:0},{value:3,tweenMethod:"linearNone",tween:!0,target:82,label:null,key:"x",index:1},{value:3,tweenMethod:"backInOut",tween:!0,target:82,label:null,key:"x",index:6}]}},{target:416,keyframes:{y:[{value:1009,tweenMethod:"linearNone",tween:!0,target:416,key:"y",index:0},{value:1009,tweenMethod:"linearNone",tween:!0,target:416,key:"y",index:1},{value:1165,tweenMethod:"linearNone",tween:!0,target:416,key:"y",index:6}]}},{target:421,keyframes:{y:[{value:984,tweenMethod:"linearNone",tween:!0,target:421,key:"y",index:0},{value:984,tweenMethod:"linearNone",tween:!0,target:421,key:"y",index:1},{value:1165,tweenMethod:"linearNone",tween:!0,target:421,key:"y",index:6}]}},{target:237,keyframes:{x:[{value:0,tweenMethod:"linearNone",tween:!0,target:237,key:"x",index:0},{value:-312,tweenMethod:"linearNone",tween:!0,target:237,key:"x",index:6}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:237,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:237,key:"alpha",index:6}]}}],name:"out",id:1,frameRate:30,action:0},{nodes:[{target:53,keyframes:{y:[{value:151,tweenMethod:"linearNone",tween:!0,target:53,key:"y",index:0},{value:231,tweenMethod:"linearNone",tween:!0,target:53,key:"y",index:3}],x:[{value:1075,tweenMethod:"linearNone",tween:!0,target:53,key:"x",index:0},{value:1075,tweenMethod:"backOut",tween:!0,target:53,label:null,key:"x",index:3}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:53,key:"alpha",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:53,key:"alpha",index:3}]}}],name:"YBin",id:2,frameRate:24,action:0},{nodes:[{target:53,keyframes:{y:[{value:231,tweenMethod:"linearNone",tween:!0,target:53,key:"y",index:0},{value:181,tweenMethod:"linearNone",tween:!0,target:53,key:"y",index:4}],x:[{value:1075,tweenMethod:"backOut",tween:!0,target:53,label:null,key:"x",index:0}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:53,label:null,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:53,key:"alpha",index:4}]}}],name:"YBout",id:2,frameRate:24,action:0},{nodes:[{target:155,keyframes:{y:[{value:-220,tweenMethod:"expoOut",tween:!0,target:155,label:null,key:"y",index:0},{value:-220,tweenMethod:"expoOut",tween:!0,target:155,key:"y",index:5},{value:4,tweenMethod:"linearNone",tween:!0,target:155,key:"y",index:10}],x:[{value:38,tweenMethod:"linearNone",tween:!0,target:155,label:null,key:"x",index:0},{value:38,tweenMethod:"linearNone",tween:!0,target:155,label:null,key:"x",index:5},{value:38,tweenMethod:"linearNone",tween:!0,target:155,key:"x",index:10}]}},{target:391,keyframes:{y:[{value:-220,tweenMethod:"expoOut",tween:!0,target:391,label:null,key:"y",index:0},{value:-220,tweenMethod:"expoOut",tween:!0,target:391,key:"y",index:3},{value:170,tweenMethod:"linearNone",tween:!0,target:391,key:"y",index:8}],x:[{value:38,tweenMethod:"linearNone",tween:!0,target:391,label:null,key:"x",index:0},{value:38,tweenMethod:"linearNone",tween:!0,target:391,label:null,key:"x",index:3},{value:38,tweenMethod:"linearNone",tween:!0,target:391,key:"x",index:8}]}}],name:"YB1in",id:3,frameRate:24,action:0},{nodes:[{target:155,keyframes:{y:[{value:4,tweenMethod:"linearNone",tween:!0,target:155,label:null,key:"y",index:0},{value:-36,tweenMethod:"linearNone",tween:!0,target:155,label:null,key:"y",index:4}],x:[{value:38,tweenMethod:"linearNone",tween:!0,target:155,label:null,key:"x",index:0},{value:38,tweenMethod:"linearNone",tween:!0,target:155,label:null,key:"x",index:4}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:155,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:155,key:"alpha",index:4}]}},{target:391,keyframes:{y:[{value:170,tweenMethod:"linearNone",tween:!0,target:391,key:"y",index:0},{value:130,tweenMethod:"linearNone",tween:!0,target:391,key:"y",index:4}],x:[{value:38,tweenMethod:"linearNone",tween:!0,target:391,key:"x",index:0},{value:38,tweenMethod:"linearNone",tween:!0,target:391,label:null,key:"x",index:4}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:391,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:391,key:"alpha",index:4}]}}],name:"YB1out",id:3,frameRate:24,action:0},{nodes:[{target:139,keyframes:{y:[{value:-220,tweenMethod:"expoOut",tween:!0,target:139,label:null,key:"y",index:0},{value:-220,tweenMethod:"expoOut",tween:!0,target:139,label:null,key:"y",index:7},{value:0,tweenMethod:"linearNone",tween:!0,target:139,key:"y",index:12}],x:[{value:20,tweenMethod:"linearNone",tween:!0,target:139,label:null,key:"x",index:0},{value:20,tweenMethod:"linearNone",tween:!0,target:139,label:null,key:"x",index:7},{value:20,tweenMethod:"linearNone",tween:!0,target:139,label:null,key:"x",index:12}]}},{target:364,keyframes:{y:[{value:-220,tweenMethod:"linearNone",tween:!0,target:364,label:null,key:"y",index:0},{value:-220,tweenMethod:"expoOut",tween:!0,target:364,key:"y",index:5},{value:166,tweenMethod:"linearNone",tween:!0,target:364,key:"y",index:10}],x:[{value:20,tweenMethod:"linearNone",tween:!0,target:364,label:null,key:"x",index:0},{value:20,tweenMethod:"linearNone",tween:!0,target:364,label:null,key:"x",index:5},{value:20,tweenMethod:"linearNone",tween:!0,target:364,label:null,key:"x",index:10}]}},{target:373,keyframes:{y:[{value:-220,tweenMethod:"linearNone",tween:!0,target:373,label:null,key:"y",index:0},{value:-220,tweenMethod:"expoOut",tween:!0,target:373,key:"y",index:3},{value:332,tweenMethod:"linearNone",tween:!0,target:373,key:"y",index:8}],x:[{value:20,tweenMethod:"linearNone",tween:!0,target:373,label:null,key:"x",index:0},{value:20,tweenMethod:"linearNone",tween:!0,target:373,label:null,key:"x",index:3},{value:20,tweenMethod:"linearNone",tween:!0,target:373,label:null,key:"x",index:8}]}},{target:382,keyframes:{y:[{value:-220,tweenMethod:"expoOut",tween:!0,target:382,key:"y",index:0},{value:499,tweenMethod:"linearNone",tween:!0,target:382,label:null,key:"y",index:5}],x:[{value:20,tweenMethod:"linearNone",tween:!0,target:382,key:"x",index:0},{value:20,tweenMethod:"linearNone",tween:!0,target:382,label:null,key:"x",index:5}]}}],name:"YB2in",id:4,frameRate:24,action:0},{nodes:[{target:139,keyframes:{y:[{value:0,tweenMethod:"linearNone",tween:!0,target:139,label:null,key:"y",index:0},{value:-40,tweenMethod:"linearNone",tween:!0,target:139,label:null,key:"y",index:4}],x:[{value:20,tweenMethod:"linearNone",tween:!0,target:139,label:null,key:"x",index:0},{value:20,tweenMethod:"linearNone",tween:!0,target:139,label:null,key:"x",index:4}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:139,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:139,key:"alpha",index:4}]}},{target:364,keyframes:{y:[{value:166,tweenMethod:"linearNone",tween:!0,target:364,key:"y",index:0},{value:126,tweenMethod:"linearNone",tween:!0,target:364,key:"y",index:4}],x:[{value:20,tweenMethod:"linearNone",tween:!0,target:364,key:"x",index:0},{value:20,tweenMethod:"linearNone",tween:!0,target:364,label:null,key:"x",index:4}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:364,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:364,key:"alpha",index:4}]}},{target:373,keyframes:{y:[{value:332,tweenMethod:"linearNone",tween:!0,target:373,key:"y",index:0},{value:292,tweenMethod:"linearNone",tween:!0,target:373,key:"y",index:4}],x:[{value:20,tweenMethod:"linearNone",tween:!0,target:373,key:"x",index:0},{value:20,tweenMethod:"linearNone",tween:!0,target:373,label:null,key:"x",index:4}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:373,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:373,key:"alpha",index:4}]}},{target:382,keyframes:{y:[{value:499,tweenMethod:"linearNone",tween:!0,target:382,key:"y",index:0},{value:459,tweenMethod:"linearNone",tween:!0,target:382,key:"y",index:4}],x:[{value:20,tweenMethod:"linearNone",tween:!0,target:382,key:"x",index:0},{value:20,tweenMethod:"linearNone",tween:!0,target:382,label:null,key:"x",index:4}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:382,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:382,key:"alpha",index:4}]}}],name:"YB2out",id:4,frameRate:24,action:0},{nodes:[{target:70,keyframes:{y:[{value:151,tweenMethod:"linearNone",tween:!0,target:70,key:"y",index:0},{value:231,tweenMethod:"linearNone",tween:!0,target:70,label:null,key:"y",index:3}],x:[{value:1075,tweenMethod:"linearNone",tween:!0,target:70,key:"x",index:0},{value:1075,tweenMethod:"linearNone",tween:!0,target:70,label:null,key:"x",index:3}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:70,key:"alpha",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:70,label:null,key:"alpha",index:3}]}}],name:"YRin",id:5,frameRate:24,action:0},{nodes:[{target:70,keyframes:{y:[{value:231,tweenMethod:"linearNone",tween:!0,target:70,label:null,key:"y",index:0},{value:181,tweenMethod:"linearNone",tween:!0,target:70,label:null,key:"y",index:4}],x:[{value:1075,tweenMethod:"linearNone",tween:!0,target:70,label:null,key:"x",index:0},{value:1075,tweenMethod:"linearNone",tween:!0,target:70,label:null,key:"x",index:4}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:70,label:null,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:70,label:null,key:"alpha",index:4}]}}],name:"YRout",id:5,frameRate:24,action:0},{nodes:[{target:482,keyframes:{y:[{value:151,tweenMethod:"linearNone",tween:!0,target:482,key:"y",index:0},{value:231,tweenMethod:"linearNone",tween:!0,target:482,label:null,key:"y",index:3}],x:[{value:1075,tweenMethod:"linearNone",tween:!0,target:482,key:"x",index:0},{value:1075,tweenMethod:"linearNone",tween:!0,target:482,label:null,key:"x",index:3}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:482,key:"alpha",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:482,label:null,key:"alpha",index:3}]}}],name:"BSin",id:5,frameRate:24,action:0},{nodes:[{target:482,keyframes:{y:[{value:231,tweenMethod:"linearNone",tween:!0,target:482,label:null,key:"y",index:0},{value:181,tweenMethod:"linearNone",tween:!0,target:482,label:null,key:"y",index:4}],x:[{value:1075,tweenMethod:"linearNone",tween:!0,target:482,label:null,key:"x",index:0},{value:1075,tweenMethod:"linearNone",tween:!0,target:482,label:null,key:"x",index:4}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:482,label:null,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:482,label:null,key:"alpha",index:4}]}}],name:"BSout",id:5,frameRate:24,action:0},{nodes:[{target:73,keyframes:{y:[{value:-220,tweenMethod:"expoOut",tween:!0,target:73,label:null,key:"y",index:0},{value:-220,tweenMethod:"expoOut",tween:!0,target:73,label:null,key:"y",index:5},{value:1,tweenMethod:"linearNone",tween:!0,target:73,label:null,key:"y",index:10}],x:[{value:38,tweenMethod:"linearNone",tween:!0,target:73,label:null,key:"x",index:0},{value:38,tweenMethod:"linearNone",tween:!0,target:73,label:null,key:"x",index:5},{value:38,tweenMethod:"linearNone",tween:!0,target:73,label:null,key:"x",index:10}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:73,label:null,key:"alpha",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:73,label:null,key:"alpha",index:5},{value:1,tweenMethod:"linearNone",tween:!0,target:73,label:null,key:"alpha",index:10}]}},{target:408,keyframes:{y:[{value:-220,tweenMethod:"linearNone",tween:!0,target:408,label:null,key:"y",index:0},{value:-220,tweenMethod:"expoOut",tween:!0,target:408,key:"y",index:3},{value:167,tweenMethod:"linearNone",tween:!0,target:408,key:"y",index:8}],x:[{value:38,tweenMethod:"linearNone",tween:!0,target:408,label:null,key:"x",index:0},{value:38,tweenMethod:"linearNone",tween:!0,target:408,label:null,key:"x",index:3},{value:38,tweenMethod:"linearNone",tween:!0,target:408,label:null,key:"x",index:8}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:408,key:"alpha",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:408,key:"alpha",index:1}]}}],name:"YR1in",id:6,frameRate:24,action:0},{nodes:[{target:73,keyframes:{y:[{value:1,tweenMethod:"linearNone",tween:!0,target:73,key:"y",index:0},{value:-39,tweenMethod:"linearNone",tween:!0,target:73,key:"y",index:4}],x:[{value:38,tweenMethod:"linearNone",tween:!0,target:73,key:"x",index:0},{value:38,tweenMethod:"linearNone",tween:!0,target:73,label:null,key:"x",index:4}],height:[{value:186,tweenMethod:"linearNone",tween:!0,target:73,key:"height",index:0},{value:186,tweenMethod:"linearNone",tween:!0,target:73,key:"height",index:4}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:73,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:73,key:"alpha",index:4}]}},{target:408,keyframes:{y:[{value:167,tweenMethod:"linearNone",tween:!0,target:408,key:"y",index:0},{value:127,tweenMethod:"linearNone",tween:!0,target:408,key:"y",index:4}],x:[{value:38,tweenMethod:"linearNone",tween:!0,target:408,key:"x",index:0},{value:38,tweenMethod:"linearNone",tween:!0,target:408,label:null,key:"x",index:4}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:408,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:408,key:"alpha",index:4}]}}],name:"YR1out",id:6,frameRate:24,action:0},{nodes:[{target:428,keyframes:{y:[{value:-220,tweenMethod:"expoOut",tween:!0,target:428,label:null,key:"y",index:0},{value:-220,tweenMethod:"expoOut",tween:!0,target:428,label:null,key:"y",index:3},{value:1,tweenMethod:"linearNone",tween:!0,target:428,label:null,key:"y",index:8}],x:[{value:38,tweenMethod:"linearNone",tween:!0,target:428,label:null,key:"x",index:0},{value:38,tweenMethod:"linearNone",tween:!0,target:428,label:null,key:"x",index:3},{value:38,tweenMethod:"linearNone",tween:!0,target:428,label:null,key:"x",index:8}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:428,label:null,key:"alpha",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:428,label:null,key:"alpha",index:3},{value:1,tweenMethod:"linearNone",tween:!0,target:428,label:null,key:"alpha",index:8}]}}],name:"BS1in",id:6,frameRate:24,action:0},{nodes:[{target:428,keyframes:{y:[{value:1,tweenMethod:"linearNone",tween:!0,target:428,key:"y",index:0},{value:-39,tweenMethod:"linearNone",tween:!0,target:428,key:"y",index:4}],x:[{value:38,tweenMethod:"linearNone",tween:!0,target:428,key:"x",index:0},{value:38,tweenMethod:"linearNone",tween:!0,target:428,label:null,key:"x",index:4}],height:[{value:186,tweenMethod:"linearNone",tween:!0,target:428,key:"height",index:0},{value:186,tweenMethod:"linearNone",tween:!0,target:428,key:"height",index:4}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:428,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:428,key:"alpha",index:4}]}}],name:"BS1out",id:6,frameRate:24,action:0}]},i}(View);t.lobbyUI=i}(e.lobby||(e.lobby={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("Text",laya.display.Text),View.regComponent("capsui.CButton",capsui.CButton),View.regComponent("capsui.UICopy",capsui.UICopy),View.regComponent("capsui.CScrollView",capsui.CScrollView),t.prototype.createChildren.call(this),this.createView(e.lobby.lobbychatUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Sprite",props:{y:123,x:638,width:1290,name:"root",height:780},compId:64,child:[{type:"Button",props:{y:316,x:-64,width:62,name:"btn_switch",height:172},child:[{type:"Image",props:{y:21,x:9,width:57,skin:"myres/lobby/btn_chat.png",height:129}}]},{type:"Sprite",props:{y:0,x:0,width:1290,name:"main",height:780},child:[{type:"Sprite",props:{y:0,x:409,width:880,name:"right",height:780},child:[{type:"Image",props:{width:880,skin:"myres/lobby/chat_right_bg.png",name:"bg",height:780}},{type:"Panel",props:{y:5,x:0,width:880,name:"content",height:650},child:[{type:"Sprite",props:{y:0,x:0,width:865,height:412},child:[{type:"Image",props:{y:20,x:31,skin:"myres/bg_head1.png",scaleY:.6,scaleX:.6,name:"head"},child:[{type:"Image",props:{skin:"extendRes/charactor/yiji/smallhead.png"}}]},{type:"Label",props:{y:35,x:150,width:356,text:"啦啦啦啦啦啦啦啦",name:"label_name",height:48,fontSize:42,font:"SimHei",color:"#ffffff"}},{type:"Image",props:{y:35,x:493,skin:"extendRes/title/1001.png",name:"title"}},{type:"Image",props:{y:110,x:170,width:675,skin:"myres/lobby/chat_bubble.png",name:"bubble",height:263}},{type:"Image",props:{y:138,x:149,width:70,skin:"myres/lobby/chat_bubble_arrow.png",name:"arrow",height:40}},{type:"Text",props:{y:130,x:190,wordWrap:!0,width:635,text:"搞什么飞机啊搞什么飞机啊搞什么飞机啊搞什么飞机啊搞什么飞机啊搞什么飞机啊搞什么飞机啊搞什么飞机啊搞什么飞机啊搞什么飞机啊搞什么飞机啊搞什么飞机啊搞什么飞机啊搞什么飞机啊搞什么飞机啊",name:"word",height:42,fontSize:37,font:"SimHei",color:"#ffffff"}}]}]},{type:"Sprite",props:{y:650,width:880,name:"input",height:130},child:[{type:"Button",props:{y:67,x:561,width:164,stateNum:1,skin:"myres/btn_small.png",name:"btn_send",height:92,anchorY:.5,anchorX:.5,sizeGrid:"30,30,30,30"},child:[{type:"Label",props:{y:20,x:15,width:132,valign:"middle",text:"发送",height:54,fontSize:50,font:"fengyu",color:"#e8af71",align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Image",props:{y:27,x:14,width:459,skin:"myres/inputbox.png",name:"input",height:80,sizeGrid:"7,12,10,9"},child:[{type:"TextInput",props:{y:7,x:1,wordWrap:!0,width:456,valign:"middle",promptColor:"#d0cdcd",name:"txtinput",height:66,fontSize:45,font:"SimHei",color:"#d0cdcd",align:"left"}}]},{type:"Button",props:{y:67,x:699,width:80,name:"btn_emo",height:80,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:12,x:10,width:58,skin:"myres/lobby/btn_emo.png",height:58}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:72,x:815,width:80,name:"btn_close",height:80,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:13,x:15,width:50,skin:"myres/pop2_close.png",height:50}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]}]},{type:"Sprite",props:{y:0,x:0,width:410,name:"left",height:780},child:[{type:"Image",props:{y:0,x:0,width:410,skin:"myres/lobby/chat_left_bg.png",name:"bg",height:780}},{type:"Panel",props:{y:5,x:0,width:410,name:"content",height:770},child:[{type:"Sprite",props:{y:0,x:0,width:410,name:"templete",height:160},child:[{type:"Image",props:{y:0,x:0,width:410,skin:"myres/lobby/chat_choose.png",name:"choose",height:160}},{type:"Text",props:{y:60,x:140,width:240,text:"啦啦啦啦啦",height:54,fontSize:42,font:"SimHei",color:"#ffffff"}},{type:"Image",props:{y:10,x:21,skin:"myres/bg_head1.png",scaleY:.6,scaleX:.6,name:"head"},child:[{type:"Image",props:{skin:"extendRes/charactor/yiji/smallhead.png"}}]},{type:"Image",props:{y:54,x:311,width:54,skin:"myres/lobby/redpoint.png",name:"redpoint",height:54},child:[{type:"Label",props:{y:0,x:0,width:54,valign:"middle",text:"99",name:"label_name",height:54,fontSize:40,font:"SimHei",color:"#ffffff",align:"center"}}]},{type:"Script",props:{runtime:"capsui.UICopy"}}]},{type:"Script",props:{runtime:"capsui.CScrollView"}}]}]},{type:"Image",props:{y:-3,x:-3,width:1296,skin:"myres/lobby/chatbound.png",name:"bound",height:786,sizeGrid:"10,10,10,10"}}]}]}],animations:[{nodes:[{target:64,keyframes:{x:[{value:1923,tweenMethod:"strongOut",tween:!0,target:64,key:"x",index:0},{value:638,tweenMethod:"linearNone",tween:!0,target:64,key:"x",index:4}]}}],name:"in",id:1,frameRate:24,action:0},{nodes:[{target:64,keyframes:{x:[{value:638,tweenMethod:"strongOut",tween:!0,target:64,key:"x",index:0},{value:1923,tweenMethod:"linearNone",tween:!0,target:64,key:"x",index:4}]}}],name:"out",id:2,frameRate:24,action:0}]},i}(View);t.lobbychatUI=i}(e.lobby||(e.lobby={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.CButton",capsui.CButton),View.regComponent("capsui.UICopy",capsui.UICopy),View.regComponent("capsui.CLoading",capsui.CLoading),View.regComponent("capsui.NoLimitList",capsui.NoLimitList),t.prototype.createChildren.call(this),this.createView(e.lobby.match_lobbyUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Image",props:{y:48,x:119,width:401,skin:"myres/img_return1_bg.png",name:"top",height:81},child:[{type:"Label",props:{y:3,x:60,width:170,text:"赛事大厅",scaleY:1.4,scaleX:1.4,height:45,font:"fengyu",color:"#e4ba86",align:"center"}},{type:"Button",props:{y:41,x:-44,width:182,pivotY:75,pivotX:72,name:"btn_back",height:142},child:[{type:"Image",props:{y:6,x:7,width:135,skin:"myres/img_return1.png",height:134}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]},{type:"Image",props:{y:155,x:76,width:1793,skin:"myres/shop/bg_container.png",name:"root",height:869,sizeGrid:"58,59,63,59"},child:[{type:"Image",props:{y:57,x:62,width:844,skin:"myres/inputbox.png",name:"input",height:73,sizeGrid:"7,12,10,9"},child:[{type:"TextInput",props:{y:-5,x:-5,width:851,valign:"middle",promptColor:"#888787",prompt:"输入赛事名称",padding:"10,20,10,20",name:"txtinput",maxChars:10,height:82,fontSize:33,font:"SimHei",color:"#d0cdcd",align:"left"}},{type:"Button",props:{y:36,x:958,width:188,stateNum:1,skin:"myres/lobby/btn_go.png",name:"btn_searchname",height:72,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:11,x:32,width:120,text:"搜索",name:"word",height:52,fontSize:38,font:"fengyu",color:"#0a0e1b",align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]},{type:"Button",props:{y:55,x:1297,width:408,name:"check_follow",height:75},child:[{type:"Label",props:{y:24,x:82,width:295,text:"只显示我关注的比赛",height:35,fontSize:30,font:"SimHei",color:"#d4ac66",align:"left"}},{type:"Image",props:{y:17,x:29,width:44,skin:"myres/bothui/checkbox.png",height:43}},{type:"Image",props:{y:17,x:29,width:44,skin:"myres/bothui/check.png",name:"check",height:43}}]},{type:"Sprite",props:{y:157,x:1709,width:50,name:"scrollbar",mouseThrough:!1,mouseEnabled:!0,height:671},child:[{type:"Image",props:{y:0,x:25,skin:"myres/sushe/ss_slidebar.png",name:"scrollbar",height:671,anchorX:.5}},{type:"Image",props:{y:96,x:25,width:45,skin:"myres/sushe/ss_slidebtn.png",name:"scrollpoint",height:45,anchorY:.5,anchorX:.5}}]},{type:"Panel",props:{y:157,x:53,width:1657,name:"content",height:672},child:[{type:"Image",props:{y:0,x:0,width:1642,name:"templete",height:206},child:[{type:"Image",props:{y:0,x:0,width:1642,skin:"myres/match_lobby/match_bg0.png",height:196,sizeGrid:"0,27,0,35"}},{type:"Button",props:{y:0,x:0,width:1642,name:"btn_enter",height:196}},{type:"Label",props:{y:17,x:1482,width:117,text:"已关注",name:"follow",height:35,fontSize:32,font:"SimHei",color:"#46dc82"}},{type:"Label",props:{y:17,x:35,width:1085,text:"赛事名称32个字赛事名称32个字赛事名称32个字赛事名称32个字",name:"name",height:35,fontSize:32,font:"SimHei",color:"#daae72"}},{type:"Label",props:{y:75,x:33,wordWrap:!0,width:926,valign:"middle",text:"头对外头对外头对外头对外头对外头对外头对外头对外头对外头对外头对外头对外头对外头对外头对外头对外头对外头对外头对外头对外头对外头对外头对外头对外头对外头对外头对外头对外头对外头对外头对外头对外头对外",name:"content",leading:8,height:106,fontSize:28,font:"SimHei",color:"#9598a4"}},{type:"Label",props:{y:84,x:1143,width:140,text:"未开始",name:"prepare",height:44,fontSize:40,font:"SimHei",color:"#58c4dd"},child:[{type:"Label",props:{y:60,x:-101,width:369,text:"开始时间：",height:34,fontSize:25,font:"SimHei",color:"#58c4dd"}},{type:"Label",props:{y:60,x:25,width:218,text:"99天15时59分59秒",name:"time",height:34,fontSize:25,font:"SimHei",color:"#58c4dd",align:"left"}}]},{type:"Label",props:{y:17,x:1080,width:244,text:"ID:6630153",name:"id",height:35,fontSize:32,font:"SimHei",color:"#daae72",align:"center"}},{type:"Label",props:{y:84,x:1143,width:136,text:"进行中",name:"start",height:34,fontSize:40,font:"SimHei",color:"#acde4f"},child:[{type:"Label",props:{y:60,x:-101,width:369,text:"结束时间：",height:34,fontSize:25,font:"SimHei",color:"#acde4f"}},{type:"Label",props:{y:60,x:25,width:227,text:"99天15时59分59秒",name:"time",height:34,fontSize:25,font:"SimHei",color:"#acde4f",align:"left"}}]},{type:"Label",props:{y:84,x:1143,width:136,text:"已结束",name:"end",height:34,fontSize:40,font:"SimHei",color:"#9598a4"},child:[{type:"Label",props:{y:60,x:-101,width:369,text:"结束时间：",height:34,fontSize:25,font:"SimHei",color:"#9598a4"}},{type:"Label",props:{y:60,x:25,width:248,text:"2019/12/12 23:59:59",name:"time",height:34,fontSize:25,font:"SimHei",color:"#9598a4",align:"left"}}]},{type:"Button",props:{y:129,x:1530,width:161,name:"check",height:67,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:0,x:0,width:161,skin:"myres/bothui/invite_btn1.png",name:"join",height:67,sizeGrid:"4,5,5,5"},child:[{type:"Label",props:{y:3,x:41,width:80,valign:"middle",text:"查看",scaleY:.9,scaleX:.9,height:63,fontSize:35,font:"fengyu",color:"#e8af71",align:"center"}}]},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Script",props:{runtime:"capsui.UICopy"}}]}]},{type:"Button",props:{y:-52,x:1662,width:240,stateNum:1,skin:"myres/btn_small.png",name:"btn_checkmatchID",height:70,anchorY:.5,anchorX:.5,sizeGrid:"30,30,30,30"},child:[{type:"Label",props:{y:5,x:9,width:280,valign:"middle",text:"输入赛事ID",scaleY:.8,scaleX:.8,height:74,fontSize:48,font:"fengyu",color:"#e8af71",align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Label",props:{y:221,x:340,width:1085,text:"无赛事",name:"noinfo",height:57,fontSize:50,font:"SimHei",color:"#daae72",align:"center"}},{type:"Sprite",props:{y:361,x:862,width:127,name:"loading",mouseThrough:!0,height:133},child:[{type:"Image",props:{y:67,x:26,skin:"myres/necessary/flower_nei.png",scaleY:1.2,scaleX:1.2,rotation:0,name:"flower",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:0,x:0,skin:"myres/necessary/flower_shine.png",name:"shine",alpha:1}},{type:"Image",props:{y:56,x:56,skin:"myres/necessary/round.png",name:"round",anchorY:.5,anchorX:.5}},{type:"Image",props:{y:142,x:0,skin:"myres/necessary/word.png"}}]},{type:"Script",props:{runtime:"capsui.CLoading"}}]},{type:"Script",props:{runtime:"capsui.NoLimitList"}}]},{type:"Sprite",props:{width:1920,name:"pop_info",height:1080},child:[{type:"Image",props:{y:570,x:989,width:1497,skin:"myres/pop2_bg.png",name:"root",height:789,anchorY:.5,anchorX:.5,sizeGrid:"2,2,2,2"},child:[{type:"Image",props:{y:0,x:0,width:1497,skin:"myres/pop2_bound.png",name:"bound",height:789,sizeGrid:"24,27,11,21"}},{type:"Button",props:{y:42,x:1455,width:80,name:"btn_close",height:80,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:19,x:17,skin:"myres/pop2_close.png",name:"close"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Image",props:{y:143,x:38,width:1427,skin:"myres/match_lobby/match_bg1.png",name:"infos",height:514,sizeGrid:"5,6,6,6"},child:[{type:"Panel",props:{y:20,x:21,width:1360,name:"content",height:477},child:[{type:"Label",props:{wordWrap:!0,width:1360,text:"对外公告开头部分对外公告开头部分对外公告开头部分对外公告开头部分对外公告开头部分对外公告开头部分对外公告开头部分对外公告开头部分对外公告开头部分对外公告开头部分",name:"label_info",leading:8,height:470,fontSize:28,font:"SimHei",color:"#9598a4"}}]},{type:"Sprite",props:{y:21,x:1381,width:40,name:"scrollbar",mouseThrough:!1,mouseEnabled:!0,height:477},child:[{type:"Image",props:{y:0,x:25,skin:"myres/match_lobby/match_scroll_bg.png",name:"scrollbar",height:470,anchorX:.5,sizeGrid:"9,0,7,0"}},{type:"Image",props:{y:50,x:25,skin:"myres/match_lobby/match_scroll_btn.png",name:"scrollpoint",height:92,anchorX:.5,sizeGrid:"8,0,9,0"}}]}]},{type:"Label",props:{y:39,x:206,width:1085,text:"赛事名称32个字赛事名称32个字赛事名称32个字赛事名称32个字",name:"name",height:35,fontSize:32,font:"SimHei",color:"#daae72",align:"center"}},{type:"Label",props:{y:95,x:393,width:705,text:"2018年12月12日 12:59:59 到 2018年12月12日 12:59:59",name:"starttime",height:27,fontSize:26,font:"SimHei",color:"#daae72",align:"center"}},{type:"Button",props:{y:714,x:561,width:201,stateNum:1,skin:"myres/match_lobby/match_btn0.png",name:"btn_close1",height:79,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:11,x:32,width:136,text:"关闭",name:"word",height:52,fontSize:38,font:"fengyu",color:"#2c2e3b",align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:714,x:927,width:201,stateNum:1,skin:"myres/match_lobby/match_btn1.png",name:"btn_enter",height:79,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:11,x:32,width:136,text:"进入",name:"word",height:52,fontSize:38,font:"fengyu",color:"#272745",align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]}]}]},i}(View);t.match_lobbyUI=i}(e.lobby||(e.lobby={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.CButton",capsui.CButton),View.regComponent("capsui.UICopy",capsui.UICopy),View.regComponent("capsui.CScrollView",capsui.CScrollView),View.regComponent("capsui.CLoading",capsui.CLoading),View.regComponent("capsui.NoLimitList",capsui.NoLimitList),t.prototype.createChildren.call(this),this.createView(e.lobby.match_roomUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Image",props:{y:49,x:119,width:401,skin:"myres/img_return1_bg.png",name:"top",height:81},child:[{type:"Label",props:{y:3,x:60,width:85,text:"赛事",scaleY:1.4,scaleX:1.4,height:45,font:"fengyu",color:"#e4ba86",align:"center"}},{type:"Button",props:{y:46,x:-42,width:182,pivotY:80,pivotX:74,name:"btn_back",height:142},child:[{type:"Image",props:{y:6,x:7,width:135,skin:"myres/img_return1.png",height:134}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Label",props:{y:37,x:185,width:135,text:"ID:100860",scaleY:1.4,scaleX:1.4,name:"id",height:24,fontSize:25,font:"SimHei",color:"#e4ba86",align:"left"}}]},{type:"Image",props:{y:157,x:330,width:1531,skin:"myres/shop/bg_container.png",name:"main",height:866,sizeGrid:"58,59,63,59"},child:[{type:"Sprite",props:{y:31,x:-281,width:290,name:"tabs",height:843},child:[{type:"Button",props:{y:89,x:295,width:336,stateNum:1,skin:"myres/shop/tab_unchoose.png",pivotY:69,pivotX:296,name:"btn_main",height:141},child:[{type:"Label",props:{y:15,x:24,width:209,valign:"middle",text:"主页",scaleY:1.3,scaleX:1.3,name:"label_name",height:85,fontSize:60,font:"fengyu",color:"#eab65e",align:"center"}}]},{type:"Button",props:{y:230,x:296,width:336,stateNum:1,skin:"myres/shop/tab_unchoose.png",pivotX:296,name:"btn_paipu",height:141,anchorY:.5},child:[{type:"Label",props:{y:17,x:24,width:207,valign:"middle",text:"赛事牌谱",scaleY:1.3,scaleX:1.3,name:"label_name",height:85,fontSize:60,font:"fengyu",color:"#eab65e",align:"center"}}]},{type:"Button",props:{y:370,x:296,width:336,stateNum:1,skin:"myres/shop/tab_unchoose.png",pivotX:296,name:"btn_ob",height:141,anchorY:.5},child:[{type:"Label",props:{y:18,x:24,width:207,valign:"middle",text:"赛事观战",scaleY:1.3,scaleX:1.3,name:"label_name",height:85,fontSize:60,font:"fengyu",color:"#eab65e",align:"center"}}]}]},{type:"Sprite",props:{y:-15,x:-13,width:1554,name:"page_main",height:895},child:[{type:"Image",props:{y:185,x:86,width:819,skin:"myres/match_lobby/match_info.png",name:"container_left",height:641,sizeGrid:"15,9,13,8"},child:[{type:"Sprite",props:{y:-13,x:-11,width:836,name:"chat",height:666},child:[{type:"Button",props:{y:561,x:18,width:235,name:"only_system",height:75},child:[{type:"Image",props:{y:17,x:10,width:44,skin:"myres/bothui/checkbox.png",height:43}},{type:"Image",props:{y:17,x:10,width:44,skin:"myres/bothui/check.png",name:"check",height:43}},{type:"Label",props:{y:24,x:60,width:175,text:"仅显示系统消息",name:"word",height:26,fontSize:25,font:"SimHei",color:"#d4ac66",align:"left"}}]},{type:"Image",props:{y:563,x:266,width:424,skin:"myres/inputbox.png",name:"input",height:73,sizeGrid:"7,12,10,9"},child:[{type:"TextInput",props:{y:-6,x:-5,width:433,valign:"middle",text:"123123",promptColor:"#d0cdcd",padding:"10,10,10,10",name:"txtinput",maxChars:100,height:83,fontSize:30,font:"SimHei",color:"#d0cdcd",align:"left"}}]},{type:"Button",props:{y:597,x:754,width:114,name:"send",height:72,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:0,x:0,width:115,skin:"myres/bothui/invite_btn1.png",name:"join",height:73,sizeGrid:"4,5,5,5"},child:[{type:"Label",props:{y:3,x:2,width:121,valign:"middle",text:"发送",scaleY:.85,scaleX:.85,height:75,fontSize:35,font:"fengyu",color:"#e8af71",align:"center"}}]},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Label",props:{y:59,x:52,wordWrap:!0,width:708,visible:!1,text:"[系统]对局结束，玩家名称玩家名称+99.99,玩家名称玩家名称+99.99,玩家名称玩家名称+99.99,玩家名称玩家名称+99.99",name:"system",leading:8,height:72,fontSize:26,font:"SimHei",color:"#d4ac66"}},{type:"Label",props:{y:131,x:54,wordWrap:!0,width:249,visible:!1,text:"玩家名称玩家名称：",name:"name",leading:8,height:28,fontSize:25,font:"SimHei",color:"#8b8c98"}},{type:"Label",props:{y:131,x:54,wordWrap:!0,width:700,visible:!1,text:"                  哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈",name:"dialogue",leading:10,height:63,fontSize:25,font:"SimHei",color:"#70d6ed"}},{type:"Panel",props:{y:45,x:42,width:738,name:"content",height:493},child:[{type:"Sprite",props:{y:0,x:0,width:738,name:"templete",height:34},child:[{type:"Script",props:{runtime:"capsui.UICopy"}},{type:"Sprite",props:{y:0,x:0,name:"container_content"}},{type:"Button",props:{width:738,name:"btn_click",height:50}}]}]},{type:"Sprite",props:{y:-3022,x:133,width:738,name:"container_get_word_height",height:100}},{type:"Sprite",props:{y:53,x:773,width:40,name:"scrollbar_light",mouseThrough:!1,mouseEnabled:!0,height:482},child:[{type:"Image",props:{y:0,x:25,skin:"myres/match_lobby/match_scroll_bg.png",name:"scrollbar",height:482,anchorX:.5,sizeGrid:"9,0,7,0"}},{type:"Image",props:{y:50,x:25,skin:"myres/match_lobby/match_scroll_btn.png",name:"scrollpoint",height:92,anchorX:.5,sizeGrid:"8,0,9,0"}}]},{type:"Script",props:{runtime:"capsui.CScrollView"}}]},{type:"Button",props:{y:-43,x:279,width:181,stateNum:1,skin:"myres/bothui/invite_btn1.png",name:"btn_chat",height:68,anchorY:.5,anchorX:.5,sizeGrid:"4,5,5,5"},child:[{type:"Label",props:{y:13,x:18,width:185,text:"聊天室",scaleY:.8,scaleX:.8,name:"info",height:45,font:"fengyu",color:"#fcba72",align:"center"}},{type:"Image",props:{y:66,x:2,skin:"myres/lobby/table_tag.png",name:"inchoose"}}]},{type:"Button",props:{y:-43,x:90,width:181,stateNum:1,skin:"myres/bothui/invite_btn1.png",name:"btn_info",height:68,anchorY:.5,anchorX:.5,sizeGrid:"4,5,5,5"},child:[{type:"Label",props:{y:13,x:18,width:185,text:"对内公告",scaleY:.8,scaleX:.8,name:"info",height:45,font:"fengyu",color:"#fcba72",align:"center"}},{type:"Image",props:{y:66,x:2,skin:"myres/lobby/table_tag.png",name:"inchoose"}}]},{type:"Sprite",props:{y:11,x:16,width:790,name:"notice",height:612},child:[{type:"Sprite",props:{y:37,x:746,width:40,name:"scrollbar",mouseThrough:!1,mouseEnabled:!0,height:544},child:[{type:"Image",props:{y:0,x:25,skin:"myres/match_lobby/match_scroll_bg.png",name:"scrollbar",height:544,anchorX:.5,sizeGrid:"9,0,7,0"}},{type:"Image",props:{y:50,x:25,skin:"myres/match_lobby/match_scroll_btn.png",name:"scrollpoint",height:92,anchorX:.5,sizeGrid:"8,0,9,0"}}]},{type:"Panel",props:{y:34,x:21,width:720,name:"panel",height:550},child:[{type:"Label",props:{y:0,x:0,wordWrap:!0,width:720,text:"对外公告开头部分对外公告开头部分对外公告开头部分对外公告开头部分对外公告开头部分对外公告开头部分对外公告开头部分对外公告开头部分对外公告开头部分对外公告开头部分",padding:"10,10,10,10",name:"content",leading:8,height:550,fontSize:28,font:"SimHei",color:"#9598a4"}}]}]}]},{type:"Sprite",props:{y:104,x:917,width:562,name:"container_right",height:731},child:[{type:"Image",props:{y:9,x:5,width:550,skin:"myres/match_lobby/match_common_bg.png",name:"bg",height:712,sizeGrid:"88,83,78,83"}},{type:"Label",props:{y:38,x:208,width:173,text:"赛事时间",scaleY:.9,scaleX:.9,height:45,font:"fengyu",color:"#e4ba86",align:"center"}},{type:"Label",props:{y:93,x:77,width:119,text:"开始时间：",name:"starttime",height:34,fontSize:27,font:"SimHei",color:"#8ba8db"},child:[{type:"Label",props:{y:0,x:136,width:141,text:"2018/12/12",name:"date",height:27,fontSize:27,font:"SimHei",color:"#8ba8db"}},{type:"Label",props:{y:0,x:298,width:141,text:"23:23:23",name:"time",height:27,fontSize:27,font:"SimHei",color:"#8ba8db"}}]},{type:"Label",props:{y:127,x:77,width:119,text:"结束时间：",name:"endtime",height:34,fontSize:27,font:"SimHei",color:"#8ba8db"},child:[{type:"Label",props:{y:0,x:136,width:141,text:"2018/12/12",name:"date",height:27,fontSize:27,font:"SimHei",color:"#8ba8db"}},{type:"Label",props:{y:0,x:298,width:141,text:"23:23:23",name:"time",height:27,fontSize:27,font:"SimHei",color:"#8ba8db"}}]},{type:"Label",props:{y:185,x:208,width:173,text:"赛事规则",scaleY:.9,scaleX:.9,height:45,font:"fengyu",color:"#e4ba86",align:"center"}},{type:"Label",props:{y:371,x:208,width:173,text:"我的排名",scaleY:.9,scaleX:.9,height:45,font:"fengyu",color:"#e4ba86",align:"center"}},{type:"Label",props:{y:423,x:284,width:116,text:"999",name:"rank",height:34,fontSize:35,font:"SimHei",color:"#67fef0",anchorX:.5,align:"center"}},{type:"Label",props:{y:470,x:78,width:262,text:"最近5战总计精算点：",name:"my_near_point",height:27,fontSize:27,font:"SimHei",color:"#8ba8db"},child:[{type:"Label",props:{y:0,x:295,width:110,text:"9999",name:"v",height:27,fontSize:27,font:"SimHei",color:"#8ba8db",align:"right"}}]},{type:"Label",props:{y:506,x:78,width:262,text:"最近5战位次：",name:"my_near_rank",height:27,fontSize:27,font:"SimHei",color:"#8ba8db"},child:[{type:"Label",props:{y:0,x:229,width:176,text:"1/1/1/1/1",name:"v",height:27,fontSize:27,font:"SimHei",color:"#8ba8db",align:"right"}}]},{type:"Button",props:{y:607,x:280,width:434,stateNum:1,skin:"myres/match_lobby/match_btn2.png",name:"btn_start",height:92,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:2,x:1,width:344,valign:"middle",text:"准备比赛",scaleY:1.2,scaleX:1.2,name:"label_name",height:76,fontSize:60,font:"fengyu",color:"#402031",align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Label",props:{y:660,x:231,width:125,text:"在线：",scaleY:.65,scaleX:.65,height:45,font:"fengyu",color:"#e4ba86",align:"center"}},{type:"Label",props:{y:663,x:311,width:81,text:"9999",name:"count_online",height:24,fontSize:28,font:"SimHei",color:"#60e373"}},{type:"Button",props:{y:296,x:432,width:135,name:"check_rule",height:95,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:0,x:-1,width:137,skin:"myres/bothui/invite_btn1.png",name:"join",height:95,sizeGrid:"4,5,5,5"},child:[{type:"Label",props:{y:27,x:3,width:188,valign:"middle",text:"查看详情",scaleY:.7,scaleX:.7,height:63,fontSize:35,font:"fengyu",color:"#e8af71",align:"center"}}]},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Image",props:{y:252,x:64,width:145,skin:"myres/match_lobby/match_mode.png",name:"rule0",height:43,sizeGrid:"11,14,8,13"},child:[{type:"Label",props:{y:5,x:0,width:145,valign:"middle",text:"南风",scaleY:1,scaleX:1,name:"label_name",height:34,fontSize:26,font:"SimHei",color:"#402031",align:"center"}}]},{type:"Image",props:{y:252,x:214,width:145,skin:"myres/match_lobby/match_mode.png",name:"rule1",height:43,sizeGrid:"11,14,8,13"},child:[{type:"Label",props:{y:5,x:0,width:145,valign:"middle",text:"南风",name:"label_name",height:34,fontSize:26,font:"SimHei",color:"#402031",align:"center"}}]},{type:"Image",props:{y:299,x:64,width:145,skin:"myres/match_lobby/match_mode.png",name:"rule2",height:43,sizeGrid:"11,14,8,13"},child:[{type:"Label",props:{y:5,x:0,width:145,valign:"middle",text:"南风",name:"label_name",height:34,fontSize:26,font:"SimHei",color:"#402031",align:"center"}}]},{type:"Image",props:{y:299,x:214,width:145,skin:"myres/match_lobby/match_mode.png",name:"rule3",height:43,sizeGrid:"11,14,8,13"},child:[{type:"Label",props:{y:5,x:0,width:145,valign:"middle",text:"南风",name:"label_name",height:35,fontSize:26,font:"SimHei",color:"#402031",align:"center"}}]}]},{type:"Label",props:{y:53,x:206,width:1085,text:"赛事名称32个字赛事名称32个字赛事名称32个字赛事名称32个字",name:"name",height:35,fontSize:32,font:"SimHei",color:"#daae72",align:"center"}},{type:"Button",props:{y:-67,x:1277,width:303,name:"check_follow",height:75},child:[{type:"Label",props:{y:24,x:82,width:142,text:"设为关注",name:"word",height:35,fontSize:30,font:"SimHei",color:"#d4ac66",align:"left"}},{type:"Image",props:{y:17,x:29,width:44,skin:"myres/bothui/checkbox.png",height:43}},{type:"Image",props:{y:17,x:29,width:44,skin:"myres/bothui/check.png",name:"check",height:43}}]}]},{type:"Sprite",props:{y:-157,x:-330,name:"page_ob"},child:[{type:"Sprite",props:{y:188,x:334,width:1767,scaleY:.85,scaleX:.85,name:"scrollview",height:958},child:[{type:"Sprite",props:{y:21,x:1712,width:50,name:"scrollbar",mouseThrough:!1,mouseEnabled:!0,height:750},child:[{type:"Image",props:{y:0,x:25,skin:"myres/scrollbar.png",name:"scrollbar",height:890,anchorX:.5}},{type:"Image",props:{y:96,x:25,width:45,skin:"myres/scrollpoint.png",name:"scrollpoint",height:45,anchorY:.5,anchorX:.5}}]},{type:"Panel",props:{y:6,x:45,width:1673,name:"content",height:924},child:[{type:"Sprite",props:{y:0,x:12,width:1670,name:"templete",height:231},child:[{type:"Image",props:{y:15,x:7,width:1636,skin:"myres/lobby/OB_bg.png",name:"bg",height:209}},{type:"Sprite",props:{y:58,x:12,width:399,name:"p0",height:160},child:[{type:"Image",props:{y:35,x:131,width:234,skin:"extendRes/title/yuanchuzhihuo.png",name:"title",height:45}},{type:"Label",props:{y:102,x:148,width:232,text:"蹦蹦跳跳的仙太郎",name:"name",height:39,fontSize:27,font:"SimHei",color:"#fbfbfb",align:"left"}},{type:"Image",props:{y:79,x:96,width:255,scaleY:.55,scaleX:.55,pivotY:114,pivotX:145,name:"rank",height:253},child:[{type:"Image",props:{y:0,x:0,skin:"myres/rank_bg.png",name:"bg"}},{type:"Image",props:{y:15,x:0,skin:"extendRes/level/queshi.png",name:"icon"}},{type:"Image",props:{y:191,x:58,skin:"myres/starbg.png",scaleY:1,scaleX:1,name:"star2",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]},{type:"Image",props:{y:142,x:29,skin:"myres/starbg.png",scaleY:.7,scaleX:.7,name:"star3",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]},{type:"Image",props:{y:214,x:110,skin:"myres/starbg.png",scaleY:.7,scaleX:.7,name:"star1",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]}]}]},{type:"Sprite",props:{y:58,x:422,width:398,name:"p1",height:160},child:[{type:"Image",props:{y:35,x:131,width:234,skin:"extendRes/title/yuanchuzhihuo.png",name:"title",height:45}},{type:"Label",props:{y:102,x:148,width:232,text:"蹦蹦跳跳的仙太郎",name:"name",height:39,fontSize:27,font:"SimHei",color:"#fbfbfb",align:"left"}},{type:"Image",props:{y:79,x:96,width:255,scaleY:.55,scaleX:.55,pivotY:114,pivotX:145,name:"rank",height:253},child:[{type:"Image",props:{y:0,x:0,skin:"myres/rank_bg.png",name:"bg"}},{type:"Image",props:{y:15,x:0,skin:"extendRes/level/queshi.png",name:"icon"}},{type:"Image",props:{y:191,x:58,skin:"myres/starbg.png",scaleY:1,scaleX:1,name:"star2",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]},{type:"Image",props:{y:142,x:29,skin:"myres/starbg.png",scaleY:.7,scaleX:.7,name:"star3",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]},{type:"Image",props:{y:214,x:110,skin:"myres/starbg.png",scaleY:.7,scaleX:.7,name:"star1",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]}]}]},{type:"Sprite",props:{y:58,x:814,width:410,name:"p2",height:160},child:[{type:"Image",props:{y:35,x:131,width:234,skin:"extendRes/title/yuanchuzhihuo.png",name:"title",height:45}},{type:"Label",props:{y:102,x:148,width:232,text:"蹦蹦跳跳的仙太郎",name:"name",height:39,fontSize:27,font:"SimHei",color:"#fbfbfb",align:"left"}},{type:"Image",props:{y:79,x:96,width:255,scaleY:.55,scaleX:.55,pivotY:114,pivotX:145,name:"rank",height:253},child:[{type:"Image",props:{y:0,x:0,skin:"myres/rank_bg.png",name:"bg"}},{type:"Image",props:{y:15,x:0,skin:"extendRes/level/queshi.png",name:"icon"}},{type:"Image",props:{y:191,x:58,skin:"myres/starbg.png",scaleY:1,scaleX:1,name:"star2",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]},{type:"Image",props:{y:142,x:29,skin:"myres/starbg.png",scaleY:.7,scaleX:.7,name:"star3",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]},{type:"Image",props:{y:214,x:110,skin:"myres/starbg.png",scaleY:.7,scaleX:.7,name:"star1",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]}]}]},{type:"Sprite",props:{y:58,x:1216,width:410,name:"p3",height:160},child:[{type:"Image",props:{y:35,x:131,width:234,skin:"extendRes/title/yuanchuzhihuo.png",name:"title",height:45}},{type:"Label",props:{y:102,x:148,width:232,text:"蹦蹦跳跳的仙太郎",name:"name",height:39,fontSize:27,font:"SimHei",color:"#fbfbfb",align:"left"}},{type:"Image",props:{y:79,x:96,width:255,scaleY:.55,scaleX:.55,pivotY:114,pivotX:145,name:"rank",height:253},child:[{type:"Image",props:{y:0,x:0,skin:"myres/rank_bg.png",name:"bg"}},{type:"Image",props:{y:15,x:0,skin:"extendRes/level/queshi.png",name:"icon"}},{type:"Image",props:{y:191,x:58,skin:"myres/starbg.png",scaleY:1,scaleX:1,name:"star2",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]},{type:"Image",props:{y:142,x:29,skin:"myres/starbg.png",scaleY:.7,scaleX:.7,name:"star3",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]},{type:"Image",props:{y:214,x:110,skin:"myres/starbg.png",scaleY:.7,scaleX:.7,name:"star1",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]}]}]},{type:"Label",props:{y:24,x:1523,width:91,text:"12:59",name:"time",height:40,fontSize:35,font:"SimHei",color:"#555f77",bold:!0}},{type:"Button",props:{y:15,x:7,width:1635,name:"btn",height:207}},{type:"Script",props:{y:0,x:-12,runtime:"capsui.UICopy"}},{type:"Label",props:{y:29,x:33,width:1085,text:"赛事名称32个字赛事名称32个字赛事名称32个字赛事名称32个字",name:"name",height:35,fontSize:32,font:"SimHei",color:"#daae72",align:"left"}}]}]},{type:"Script",props:{runtime:"capsui.CScrollView"}}]}]},{type:"Sprite",props:{y:-23,x:-10,width:1556,name:"page_paipu",height:912},child:[{type:"Sprite",props:{y:77,x:1466,width:50,name:"scrollbar",mouseThrough:!1,mouseEnabled:!0,height:750},child:[{type:"Image",props:{y:0,x:25,skin:"myres/scrollbar.png",name:"scrollbar",height:750,anchorX:.5}},{type:"Image",props:{y:96,x:25,width:45,skin:"myres/scrollpoint.png",name:"scrollpoint",height:45,anchorY:.5,anchorX:.5}}]},{type:"Panel",props:{y:68,x:70,width:1694,vScrollBarSkin:"myres/vscroll.png",scaleY:.82,scaleX:.82,name:"content",height:953},child:[{type:"Sprite",props:{y:0,x:0,width:1696,name:"templete",height:174},child:[{type:"Image",props:{y:0,x:-4,width:1700,skin:"myres/lobby/bg_paipu.png",name:"bg",height:169}},{type:"Sprite",props:{y:7,x:-3,name:"p0"},child:[{type:"Image",props:{y:26,x:6,width:603,skin:"myres/lobby/mask_chosen.png",name:"chosen",height:43}},{type:"Label",props:{y:22,x:27,width:32,text:"1",name:"rank",height:32,fontSize:36,font:"haolong",color:"#489dbc"}},{type:"Label",props:{y:26,x:107,text:"要七个字的名字",name:"name",fontSize:38,font:"SimHei",color:"#a0a0a0"}},{type:"Label",props:{y:26,x:341,width:194,text:"25000",name:"score",height:35,fontSize:35,color:"#ffc458",align:"right"}},{type:"Label",props:{y:20,x:51,width:33,text:"位",name:"rank_word",height:33,fontSize:33,font:"fengyu",color:"#489dbc"}}]},{type:"Sprite",props:{y:7,x:547,name:"p1"},child:[{type:"Image",props:{y:26,x:6,width:603,skin:"myres/lobby/mask_chosen.png",name:"chosen",height:43}},{type:"Label",props:{y:22,x:27,width:32,text:"2",name:"rank",height:32,fontSize:36,font:"haolong",color:"#57bbdf"}},{type:"Label",props:{y:26,x:107,text:"要七个字的名字",name:"name",fontSize:38,font:"SimHei",color:"#dfdfdf"}},{type:"Label",props:{y:26,x:369,width:166,text:"25000",name:"score",height:35,fontSize:35,color:"#ffc458",align:"right"}},{type:"Label",props:{y:20,x:51,width:33,text:"位",name:"rank_word",height:33,fontSize:33,font:"fengyu",color:"#57bbdf"}}]},{type:"Sprite",props:{y:76,x:-2,name:"p2"},child:[{type:"Image",props:{y:26,x:6,width:603,skin:"myres/lobby/mask_chosen.png",name:"chosen",height:43}},{type:"Label",props:{y:23,x:27,width:32,text:"3",name:"rank",height:32,fontSize:36,font:"haolong",color:"#489dbc"}},{type:"Label",props:{y:26,x:107,text:"要七个字的名字",name:"name",fontSize:38,font:"SimHei",color:"#a0a0a0"}},{type:"Label",props:{y:26,x:356,width:179,text:"25000",name:"score",height:35,fontSize:35,color:"#ffc458",align:"right"}},{type:"Label",props:{y:21,x:51,width:33,text:"位",name:"rank_word",height:33,fontSize:33,font:"fengyu",color:"#489dbc"}}]},{type:"Sprite",props:{y:76,x:548,name:"p3"},child:[{type:"Image",props:{y:26,x:6,width:603,skin:"myres/lobby/mask_chosen.png",name:"chosen",height:43}},{type:"Label",props:{y:22,x:27,width:32,text:"4",name:"rank",height:32,fontSize:36,font:"haolong",color:"#489dbc"}},{type:"Label",props:{y:26,x:107,text:"要七个字的名字",name:"name",fontSize:38,font:"SimHei",color:"#a0a0a0"}},{type:"Label",props:{y:26,x:375,width:160,text:"25000",name:"score",height:35,fontSize:35,color:"#ffc458",align:"right"}},{type:"Label",props:{y:20,x:51,width:33,text:"位",name:"rank_word",height:33,fontSize:33,font:"fengyu",color:"#489dbc"}}]},{type:"Label",props:{y:87,x:1171,width:450,valign:"middle",text:"2018/05/03 12:35",scaleY:.75,scaleX:.75,name:"date",height:88,fontSize:40,font:"haolong",color:"#b5b5b5",align:"left"}},{type:"Label",props:{y:42,x:1171,width:330,text:"对局时间",name:"room",height:50,fontSize:40,font:"fengyu",color:"#b5b5b5"}},{type:"Button",props:{y:49,x:1598,width:156,stateNum:1,skin:"myres/btn_small.png",name:"check",height:70,anchorY:.5,anchorX:.5,sizeGrid:"30,30,30,30"},child:[{type:"Label",props:{y:9,x:39,width:82,text:"查看",height:39,fontSize:40,font:"fengyu",color:"#e6ba78"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:122,x:1598,width:156,stateNum:1,skin:"myres/btn_small.png",name:"share",height:70,anchorY:.5,anchorX:.5,sizeGrid:"30,30,30,30"},child:[{type:"Label",props:{y:9,x:39,width:82,text:"分享",height:39,fontSize:40,font:"fengyu",color:"#e6ba78"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Script",props:{runtime:"capsui.UICopy"}}]}]},{type:"Button",props:{y:-33,x:1420,width:241,stateNum:1,skin:"myres/btn_small.png",name:"checkother",height:70,anchorY:.5,anchorX:.5,sizeGrid:"30,30,30,30"},child:[{type:"Label",props:{y:10,x:25,width:194,text:"其他牌谱",height:55,fontSize:40,font:"fengyu",color:"#e6ba78",align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Sprite",props:{y:394,x:740,width:127,name:"loading",mouseThrough:!0,height:133},child:[{type:"Image",props:{y:67,x:26,skin:"myres/necessary/flower_nei.png",scaleY:1.2,scaleX:1.2,rotation:0,name:"flower",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:0,x:0,skin:"myres/necessary/flower_shine.png",name:"shine",alpha:1}},{type:"Image",props:{y:56,x:56,skin:"myres/necessary/round.png",name:"round",anchorY:.5,anchorX:.5}},{type:"Image",props:{y:142,x:0,skin:"myres/necessary/word.png"}}]},{type:"Script",props:{runtime:"capsui.CLoading"}}]},{type:"Script",props:{runtime:"capsui.NoLimitList"}}]}]},{type:"Sprite",props:{y:0,x:0,width:1920,name:"pop_rule",height:1080},child:[{type:"Image",props:{y:538,x:954,width:1e3,skin:"myres/pop2_bg.png",name:"root",height:933,anchorY:.5,anchorX:.5,sizeGrid:"2,2,2,2"},child:[{type:"Image",props:{y:0,x:0,width:1e3,skin:"myres/pop2_bound.png",name:"bound",height:933,sizeGrid:"24,27,11,21"}},{type:"Image",props:{y:91,x:25,width:953,skin:"myres/match_lobby/match_bg1.png",name:"container_infos",height:692,sizeGrid:"5,6,6,6"},child:[{type:"Panel",props:{y:15,x:2,width:913,name:"content",height:658},child:[{type:"Sprite",props:{y:0,x:24,width:893,name:"templete",height:50},child:[{type:"Label",props:{y:10,x:9,wordWrap:!0,width:251,text:"有九个字的模式类型",name:"name",leading:8,height:28,fontSize:27,font:"SimHei",color:"#8b8c98",align:"right"}},{type:"Image",props:{y:3,x:270,width:145,skin:"myres/match_lobby/match_mode.png",name:"item0",height:43,sizeGrid:"11,14,8,13"},child:[{type:"Label",props:{y:5,x:0,width:144,valign:"middle",text:"南风",name:"label_name",height:34,fontSize:26,font:"SimHei",color:"#03751a",align:"center"}}]},{type:"Image",props:{y:3,x:420,width:145,skin:"myres/match_lobby/match_mode.png",name:"item1",height:43,sizeGrid:"11,14,8,13"},child:[{type:"Label",props:{y:5,x:0,width:144,valign:"middle",text:"南风",name:"label_name",height:34,fontSize:26,font:"SimHei",color:"#402031",align:"center"}}]},{type:"Image",props:{y:3,x:570,width:145,skin:"myres/match_lobby/match_mode.png",name:"item2",height:43,sizeGrid:"11,14,8,13"},child:[{type:"Label",props:{y:5,x:0,width:144,valign:"middle",text:"南风",name:"label_name",height:34,fontSize:26,font:"SimHei",color:"#402031",align:"center"}}]},{type:"Image",props:{y:3,x:720,width:145,skin:"myres/match_lobby/match_mode.png",name:"item3",height:43,sizeGrid:"11,14,8,13"},child:[{type:"Label",props:{y:5,x:0,width:144,valign:"middle",text:"南风",name:"label_name",height:34,fontSize:26,font:"SimHei",color:"#402031",align:"center"}}]},{type:"Script",props:{runtime:"capsui.UICopy"}}]}]},{type:"Script",props:{runtime:"capsui.CScrollView"}},{type:"Sprite",props:{y:15,x:906,width:40,name:"light_scrollbar",mouseThrough:!1,mouseEnabled:!0,height:666},child:[{type:"Image",props:{y:0,x:25,skin:"myres/match_lobby/match_scroll_bg.png",name:"scrollbar",height:659,anchorX:.5,sizeGrid:"9,0,7,0"}},{type:"Image",props:{y:50,x:25,skin:"myres/match_lobby/match_scroll_btn.png",name:"scrollpoint",height:92,anchorX:.5,sizeGrid:"8,0,9,0"}}]}]},{type:"Button",props:{y:38,x:963,width:80,name:"btn_close",height:80,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:19,x:17,skin:"myres/pop2_close.png",name:"close"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Label",props:{y:17,x:500,width:175,text:"规则详情",height:55,fontSize:40,font:"fengyu",color:"#e6ba78",anchorX:.5,align:"center"}},{type:"Button",props:{y:850,x:500,width:201,stateNum:1,skin:"myres/match_lobby/match_btn0.png",name:"btn_close1",height:79,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:11,x:32,width:136,text:"关闭",name:"word",height:52,fontSize:38,font:"fengyu",color:"#2c2e3b",align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]}]},{type:"Sprite",props:{y:0,x:0,width:1920,name:"pop_check_paipu",height:1080},child:[{type:"Sprite",props:{y:562,x:956,width:500,pivotY:250,pivotX:250,name:"root",height:500},child:[{type:"Image",props:{y:242,x:250,width:1200,skin:"myres/pop_bg.png",name:"bg0",height:530,anchorY:.5,anchorX:.5,sizeGrid:"100,100,100,100"},child:[{type:"Image",props:{y:28,x:32,width:98,skin:"myres/pop_texturecut.png",name:"left",height:477,sizeGrid:"0,0,24,26"}},{type:"Image",props:{y:27,x:1174,width:110,skin:"myres/pop_texturecut.png",scaleX:-1,name:"right",height:475,sizeGrid:"0,0,24,26"}},{type:"Image",props:{y:84,x:32,width:1142,skin:"myres/pop_black.png",name:"bar",height:361}}]},{type:"Image",props:{y:242,x:250,width:1200,skin:"myres/pop_bound.png",name:"bound",height:530,anchorY:.5,anchorX:.5,sizeGrid:"131,102,97,106"}},{type:"Label",props:{y:53,x:49,width:412,valign:"middle",text:"输入牌谱编号",name:"title",height:76,fontSize:45,font:"fengyu",color:"#e8af71",align:"center"}},{type:"Button",props:{y:386,x:244,width:181,stateNum:1,skin:"myres/btn_small.png",name:"btn_confirm",height:77,anchorY:.5,anchorX:.5,sizeGrid:"30,30,30,30"},child:[{type:"Label",props:{y:4,x:9,width:163,valign:"middle",text:"确定",height:66,fontSize:48,font:"fengyu",color:"#e8af71",align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Image",props:{y:150,x:-214,width:948,skin:"myres/inputbox.png",name:"input",height:187,sizeGrid:"7,12,10,9"},child:[{type:"TextInput",props:{y:0,x:0,wordWrap:!0,width:946,valign:"middle",promptColor:"#d0cdcd",name:"txtinput",multiline:!0,hitTestPrior:!0,height:186,fontSize:40,font:"SimHei",color:"#d0cdcd",align:"center"}}]},{type:"Button",props:{y:12,x:809,width:135,pivotY:63,pivotX:67,name:"btn_cancel",height:125},child:[{type:"Image",props:{y:15,x:19,width:96,skin:"myres/btn_close.png",height:96}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]}]},{type:"Sprite",props:{y:0,x:0,width:1920,name:"pop_no_access",height:1080},child:[{type:"Image",props:{y:566,x:1020,width:858,skin:"myres/pop2_bg.png",name:"root",height:443,anchorY:.5,anchorX:.5,sizeGrid:"2,2,2,2"},child:[{type:"Image",props:{y:0,x:0,width:858,skin:"myres/pop2_bound.png",name:"bound",height:443,sizeGrid:"24,27,11,21"}},{type:"Button",props:{y:31,x:827,width:80,name:"btn_close",height:80,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:19,x:17,skin:"myres/pop2_close.png",name:"close"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Label",props:{y:15,x:332,width:172,text:"没有资格",height:55,fontSize:40,font:"fengyu",color:"#e6ba78",align:"center"}},{type:"Label",props:{y:183,x:45,width:765,text:"您没有获得参与该项赛事的资格，无法准备比赛",height:35,fontSize:30,font:"SimHei",color:"#e05859",align:"center"}},{type:"Button",props:{y:365,x:425,width:201,stateNum:1,skin:"myres/match_lobby/match_btn0.png",name:"btn_close1",height:79,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:11,x:32,width:136,text:"关闭",name:"word",height:52,fontSize:38,font:"fengyu",color:"#2c2e3b",align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]}]}]},i}(View);t.match_roomUI=i}(e.lobby||(e.lobby={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.CButton",capsui.CButton),View.regComponent("capsui.UICopy",capsui.UICopy),t.prototype.createChildren.call(this),this.createView(e.lobby.match_shilianUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Image",props:{y:-1,x:-907,width:1529,skin:"myres/lobby/bg_2.png",name:"top",height:107},child:[{type:"Button",props:{y:56,x:930,width:236,pivotY:67,pivotX:49,name:"btn_back",height:113},child:[{type:"Image",props:{y:41,x:47,skin:"myres/img_return1.png",scaleY:1.2,scaleX:1.2}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Label",props:{y:9,x:1163,width:161,text:"试炼之道",height:78,fontSize:70,font:"fengyu",color:"#e4ba86",align:"center"}},{type:"Image",props:{y:28,x:1867,width:230,skin:"myres/lobby/bg_0.png",scaleY:1.1,scaleX:1.1,name:"container_gold0",height:55},child:[{type:"Image",props:{y:-14,x:-41,width:78,skin:"myres/gold0.png",scaleY:.95,scaleX:.95,height:79}},{type:"Button",props:{y:27,x:223,width:60,stateNum:1,skin:"myres/lobby/btn_add.png",name:"btn_add",height:64,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Label",props:{y:4,x:35,width:150,valign:"middle",text:"9999999",name:"label_gold",height:39,fontSize:40,font:"SimHei",color:"#ffffff",align:"right"}}]},{type:"Image",props:{y:28,x:2206,width:210,skin:"myres/lobby/bg_0.png",scaleY:1.1,scaleX:1.1,name:"container_gold1",height:55},child:[{type:"Image",props:{y:-13,x:-55,width:78,skin:"myres/gold1.png",scaleY:.95,scaleX:.95,height:79}},{type:"Button",props:{y:27,x:207,width:60,stateNum:1,skin:"myres/lobby/btn_add.png",name:"btn_add",height:64,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Label",props:{y:5,x:19,width:151,valign:"middle",text:"9999999",name:"label_gold",height:39,fontSize:40,font:"SimHei",color:"#ffffff",align:"right"}}]}]},{type:"Sprite",props:{y:203,x:45,width:1861,name:"root",height:622},child:[{type:"Sprite",props:{y:95,x:36,width:1814,name:"step",height:481},child:[{type:"Sprite",props:{y:232,x:124,width:306,pivotY:266,pivotX:152,name:"s1",height:531},compId:83,child:[{type:"Sprite",props:{y:0,x:0,width:317,name:"main",height:514},child:[{type:"Image",props:{y:-56,x:-26,skin:"myres/match/0_head.png",scaleY:1.2,scaleX:1.2,name:"head"}},{type:"Sprite",props:{y:98,x:48,width:207,name:"info",height:416},compId:8,child:[{type:"Image",props:{y:-154,x:-74,skin:"myres/match/0_bg.png",scaleY:1.2,scaleX:1.2}},{type:"Label",props:{y:141,x:44,width:128,visible:!1,text:"起点 99999",name:"qidian",height:28,fontSize:25,font:"SimHei",color:"#fec23b",alpha:0},compId:84},{type:"Label",props:{y:167,x:44,width:128,visible:!1,text:"返点 99999",name:"fandian",height:28,fontSize:25,font:"SimHei",color:"#fec23b",alpha:0},compId:85},{type:"Sprite",props:{y:256,x:34,visible:!1,name:"container_reward",alpha:0},compId:185,child:[{type:"Sprite",props:{y:0,x:0,width:150,name:"reward",height:43},child:[{type:"Image",props:{y:4,x:61,width:34,skin:"myres/gold1.png",name:"icon",height:34}},{type:"Label",props:{y:6,x:27,width:122,text:"×999999",name:"count",height:32,fontSize:30,font:"SimHei",color:"#dfe0dd"}},{type:"Script",props:{runtime:"capsui.UICopy"}}]}]},{type:"Image",props:{y:258,x:82,visible:!0,skin:"myres/match/star.png",scaleY:1.2,scaleX:1.2,name:"star",alpha:1},compId:150}]},{type:"Image",props:{y:-56,x:-26,skin:"myres/match/0_circle.png",scaleY:1.2,scaleX:1.2,name:"circle"}}]},{type:"Image",props:{y:341,x:152,visible:!1,skin:"myres/match/passed.png",scaleY:1.2,scaleX:1.2,name:"passed",anchorY:.5,anchorX:.5},compId:86}]},{type:"Sprite",props:{y:232,x:494,width:305,pivotY:266,pivotX:153,name:"s2",height:531},child:[{type:"Sprite",props:{y:0,x:0,name:"main"},child:[{type:"Image",props:{y:-56,x:-26,skin:"myres/match/1_head.png",scaleY:1.2,scaleX:1.2,name:"head"}},{type:"Sprite",props:{y:98,x:48,width:207,name:"info",height:416},child:[{type:"Image",props:{y:-154,x:-74,skin:"myres/match/1_bg.png",scaleY:1.2,scaleX:1.2}},{type:"Label",props:{y:141,x:44,width:128,text:"起点 99999",name:"qidian",height:28,fontSize:25,font:"SimHei",color:"#fec23b"}},{type:"Label",props:{y:167,x:44,width:128,text:"返点 99999",name:"fandian",height:28,fontSize:25,font:"SimHei",color:"#fec23b"}},{type:"Image",props:{y:258,x:82,skin:"myres/match/star.png",scaleY:1.2,scaleX:1.2,name:"star"}},{type:"Sprite",props:{y:256,x:34,name:"container_reward"},child:[{type:"Sprite",props:{y:0,x:0,width:150,name:"reward",height:43},child:[{type:"Image",props:{y:4,x:-3,width:34,skin:"myres/gold1.png",name:"icon",height:34}},{type:"Label",props:{y:6,x:27,width:125,text:"×999999",name:"count",height:32,fontSize:30,font:"SimHei",color:"#dfe0dd"}},{type:"Script",props:{runtime:"capsui.UICopy"}}]}]}]},{type:"Image",props:{y:-56,x:-26,skin:"myres/match/1_circle.png",scaleY:1.2,scaleX:1.2,name:"circle"}}]},{type:"Image",props:{y:341,x:152,skin:"myres/match/passed.png",scaleY:1.2,scaleX:1.2,name:"passed",anchorY:.5,anchorX:.5}}]},{type:"Sprite",props:{y:232,x:870,width:338,pivotY:266,pivotX:153,name:"s3",height:531},child:[{type:"Sprite",props:{y:0,x:0,name:"main"},child:[{type:"Image",props:{y:-56,x:-26,skin:"myres/match/2_head.png",scaleY:1.2,scaleX:1.2,name:"head"}},{type:"Sprite",props:{y:98,x:48,width:207,name:"info",height:416},child:[{type:"Image",props:{y:-154,x:-74,skin:"myres/match/2_bg.png",scaleY:1.2,scaleX:1.2}},{type:"Label",props:{y:141,x:44,width:128,text:"起点 99999",name:"qidian",height:28,fontSize:25,font:"SimHei",color:"#fec23b"}},{type:"Label",props:{y:167,x:44,width:128,text:"返点 99999",name:"fandian",height:28,fontSize:25,font:"SimHei",color:"#fec23b"}},{type:"Image",props:{y:258,x:82,skin:"myres/match/star.png",scaleY:1.2,scaleX:1.2,name:"star"}},{type:"Sprite",props:{y:256,x:34,name:"container_reward"},child:[{type:"Sprite",props:{y:0,x:0,width:150,name:"reward",height:43},child:[{type:"Image",props:{y:4,x:-3,width:34,skin:"myres/gold1.png",name:"icon",height:34}},{type:"Label",props:{y:6,x:27,width:125,text:"×999999",name:"count",height:32,fontSize:30,font:"SimHei",color:"#dfe0dd"}},{type:"Script",props:{y:4,x:-3,runtime:"capsui.UICopy"}}]}]}]},{type:"Image",props:{y:-56,x:-26,skin:"myres/match/2_circle.png",scaleY:1.2,scaleX:1.2,name:"circle"}}]},{type:"Image",props:{y:341,x:152,skin:"myres/match/passed.png",scaleY:1.2,scaleX:1.2,name:"passed",anchorY:.5,anchorX:.5}}]},{type:"Sprite",props:{y:232,x:1248,width:324,pivotY:266,pivotX:153,name:"s4",height:531},child:[{type:"Sprite",props:{y:0,x:0,name:"main"},child:[{type:"Image",props:{y:-56,x:-26,skin:"myres/match/3_head.png",scaleY:1.2,scaleX:1.2,name:"head"}},{type:"Sprite",props:{y:98,x:48,width:207,name:"info",height:416},child:[{type:"Image",props:{y:-154,x:-74,skin:"myres/match/3_bg.png",scaleY:1.2,scaleX:1.2}},{type:"Label",props:{y:141,x:44,width:128,text:"起点 99999",name:"qidian",height:28,fontSize:25,font:"SimHei",color:"#fec23b"}},{type:"Label",props:{y:167,x:44,width:128,text:"返点 99999",name:"fandian",height:28,fontSize:25,font:"SimHei",color:"#fec23b"}},{type:"Image",props:{y:258,x:82,skin:"myres/match/star.png",scaleY:1.2,scaleX:1.2,name:"star"}},{type:"Sprite",props:{y:256,x:34,name:"container_reward"},child:[{type:"Sprite",props:{y:0,x:0,width:150,name:"reward",height:43},child:[{type:"Image",props:{y:4,x:-3,width:34,skin:"myres/gold1.png",name:"icon",height:34}},{type:"Label",props:{y:6,x:27,width:125,text:"×999999",name:"count",height:32,fontSize:30,font:"SimHei",color:"#dfe0dd"}},{type:"Script",props:{y:4,x:-3,runtime:"capsui.UICopy"}}]}]}]},{type:"Image",props:{y:-56,x:-26,skin:"myres/match/3_circle.png",scaleY:1.2,scaleX:1.2,name:"circle"}}]},{type:"Image",props:{y:341,x:152,skin:"myres/match/passed.png",scaleY:1.2,scaleX:1.2,name:"passed",anchorY:.5,anchorX:.5}}]},{type:"Sprite",props:{y:232,x:1625,width:308,pivotY:266,pivotX:153,name:"s5",height:531},child:[{type:"Sprite",props:{y:0,x:0,name:"main"},child:[{type:"Image",props:{y:-56,x:-26,skin:"myres/match/4_head.png",scaleY:1.2,scaleX:1.2,name:"head"}},{type:"Sprite",props:{y:98,x:48,width:207,name:"info",height:416},child:[{type:"Image",props:{y:-154,x:-74,skin:"myres/match/4_bg.png",scaleY:1.2,scaleX:1.2}},{type:"Label",props:{y:141,x:44,width:128,text:"起点 99999",name:"qidian",height:28,fontSize:25,font:"SimHei",color:"#fec23b"}},{type:"Label",props:{y:167,x:44,width:128,text:"返点 99999",name:"fandian",height:28,fontSize:25,font:"SimHei",color:"#fec23b"}},{type:"Image",props:{y:258,x:82,skin:"myres/match/star.png",scaleY:1.2,scaleX:1.2,name:"star"}},{type:"Sprite",props:{y:256,x:34,name:"container_reward"},child:[{type:"Sprite",props:{y:0,x:0,width:150,name:"reward",height:43},child:[{type:"Image",props:{y:4,x:-3,width:34,skin:"myres/gold1.png",name:"icon",height:34}},{type:"Label",props:{y:6,x:27,width:125,text:"×999999",name:"count",height:32,fontSize:30,font:"SimHei",color:"#dfe0dd"}},{type:"Script",props:{runtime:"capsui.UICopy"}}]}]}]},{type:"Image",props:{y:-56,x:-26,skin:"myres/match/4_circle.png",scaleY:1.2,scaleX:1.2,name:"circle"}}]},{type:"Image",props:{y:341,x:152,skin:"myres/match/passed.png",scaleY:1.2,scaleX:1.2,name:"passed",anchorY:.5,anchorX:.5}}]}]},{type:"Sprite",props:{y:612,x:-9,width:1872,name:"down",height:256},child:[{type:"Image",props:{y:43,x:240,width:1400,skin:"myres/match/txt_bg.png",name:"tips",height:69},child:[{type:"Label",props:{y:11,x:189,width:1007,valign:"top",text:"通过的试炼越多奖励越好",height:51,fontSize:37,font:"youyuan",color:"#56df76",align:"center"}},{type:"Label",props:{y:11,x:189,width:1007,text:"在试炼中点数降到0点以下将会失败",height:51,fontSize:37,font:"youyuan",color:"#fe363b",align:"center"}}]},{type:"Button",props:{y:179,x:919,width:398,name:"btn_start",height:119,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:11,x:95,width:218,skin:"myres/match/startbtn.png",name:"bg",height:94,sizeGrid:"18,27,25,19"}},{type:"Image",props:{y:25,x:141,width:115,skin:"myres/match/starttxt.png",height:60}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:179,x:919,width:398,name:"btn_reward",height:119,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:12,x:67,width:270,skin:"myres/match/collect.png",name:"bg",height:95,sizeGrid:"21,28,27,25"}},{type:"Image",props:{y:31,x:93,skin:"myres/match/collecttxt.png",name:"txt"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:170,x:138,width:286,pivotY:78,pivotX:132,name:"btn_rule",height:141},child:[{type:"Image",props:{y:22,x:11,skin:"myres/match/rule.png",scaleY:1.2,scaleX:1.2,name:"rule"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:161,x:1769,width:197,pivotY:95,pivotX:93,name:"btn_quit",height:189},child:[{type:"Image",props:{y:6,x:12,skin:"myres/match/test_end.png",scaleY:1.2,scaleX:1.2,name:"end"}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]},{type:"Sprite",props:{y:-203,x:-45,width:1955,name:"result",height:1111},child:[{type:"Image",props:{y:529,x:960,width:1024,skin:"myres/match/lose_bg.png",scaleY:1.9,scaleX:1.9,name:"bg",height:264,anchorY:.5,anchorX:.5},compId:149},{type:"Image",props:{y:409,x:597,skin:"myres/match/lose.png",scaleY:1.2,scaleX:1.2,name:"fail"},compId:148},{type:"Image",props:{y:525,x:982,skin:"myres/match/win.png",scaleY:1.2,scaleX:1.2,name:"success",anchorY:.5,anchorX:.5},compId:147},{type:"Button",props:{width:1920,name:"btn",height:1080},compId:179}]},{type:"Image",props:{y:440,x:916,skin:"myres/match/effect.png",scaleY:1.2,scaleX:1.2,rotation:0,name:"shine",anchorY:.5,anchorX:.5}}]},{type:"Sprite",props:{name:"reward_fly"},child:[{type:"Sprite",props:{y:224,x:-301,width:150,name:"templete",height:43},child:[{type:"Image",props:{y:4,x:-3,width:34,skin:"myres/gold1.png",name:"icon",height:34}},{type:"Label",props:{y:6,x:27,width:125,text:"×999999",name:"count",height:32,fontSize:30,font:"SimHei",color:"#dfe0dd"}},{type:"Script",props:{runtime:"capsui.UICopy"}}]}]}],animations:[{nodes:[{target:149,keyframes:{height:[{value:100,tweenMethod:"strongOut",tween:!0,target:149,key:"height",index:0},{value:277,tweenMethod:"linearNone",tween:!0,target:149,key:"height",index:6}]}},{target:147,keyframes:{visible:[{value:!1,tweenMethod:"linearNone",tween:!1,target:147,key:"visible",index:0}]}},{target:148,keyframes:{visible:[{value:!1,tweenMethod:"linearNone",tween:!1,target:148,key:"visible",index:0},{value:!0,tweenMethod:"linearNone",tween:!1,target:148,key:"visible",index:7}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:148,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:148,key:"alpha",index:7},{value:1,tweenMethod:"linearNone",tween:!0,target:148,key:"alpha",index:14}]}},{target:179,keyframes:{disabled:[{value:!0,tweenMethod:"linearNone",tween:!1,target:179,key:"disabled",index:0},{value:!1,tweenMethod:"linearNone",tween:!1,target:179,key:"disabled",index:13},{value:!1,tweenMethod:"linearNone",tween:!1,target:179,key:"disabled",index:14}]}}],name:"fail_in",id:1,frameRate:20,action:0},{nodes:[{target:149,keyframes:{visible:[{value:!0,tweenMethod:"linearNone",tween:!1,target:149,key:"visible",index:0},{value:!1,tweenMethod:"linearNone",tween:!1,target:149,key:"visible",index:7}],height:[{value:277,tweenMethod:"linearNone",tween:!0,target:149,key:"height",index:0},{value:100,tweenMethod:"linearNone",tween:!0,target:149,key:"height",index:6}]}},{target:148,keyframes:{alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:148,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:148,key:"alpha",index:4}]}},{target:147,keyframes:{visible:[{value:!1,tweenMethod:"linearNone",tween:!1,target:147,key:"visible",index:0}]}},{target:179,keyframes:{disabled:[{value:!0,tweenMethod:"linearNone",tween:!1,target:179,key:"disabled",index:0}]}}],name:"fail_out",id:2,frameRate:20,action:0},{nodes:[{target:149,keyframes:{height:[{value:100,tweenMethod:"strongOut",tween:!0,target:149,key:"height",index:0},{value:277,tweenMethod:"linearNone",tween:!0,target:149,key:"height",index:6}]}},{target:148,keyframes:{visible:[{value:!1,tweenMethod:"linearNone",tween:!1,target:148,key:"visible",index:0}]}},{target:147,keyframes:{visible:[{value:!1,tweenMethod:"linearNone",tween:!1,target:147,key:"visible",index:0},{value:!0,tweenMethod:"linearNone",tween:!1,target:147,key:"visible",index:1}],scaleY:[{value:1.2,tweenMethod:"linearNone",tween:!0,target:147,key:"scaleY",index:0},{value:2.4,tweenMethod:"strongIn",tween:!0,target:147,key:"scaleY",index:9},{value:1.2,tweenMethod:"linearNone",tween:!0,target:147,key:"scaleY",index:15}],scaleX:[{value:1.2,tweenMethod:"linearNone",tween:!0,target:147,key:"scaleX",index:0},{value:2.4,tweenMethod:"strongIn",tween:!0,target:147,key:"scaleX",index:9},{value:1.2,tweenMethod:"linearNone",tween:!0,target:147,key:"scaleX",index:15}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:147,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:147,key:"alpha",index:1},{value:0,tweenMethod:"linearNone",tween:!0,target:147,key:"alpha",index:9},{value:1,tweenMethod:"linearNone",tween:!0,target:147,key:"alpha",index:15}]}},{target:179,keyframes:{disabled:[{value:!0,tweenMethod:"linearNone",tween:!1,target:179,key:"disabled",index:0},{value:!1,tweenMethod:"linearNone",tween:!1,target:179,key:"disabled",index:16}]}}],name:"success_in",id:3,frameRate:30,action:0},{nodes:[{target:149,keyframes:{visible:[{value:!0,tweenMethod:"linearNone",tween:!1,target:149,key:"visible",index:0},{value:!1,tweenMethod:"linearNone",tween:!1,target:149,key:"visible",index:7}],height:[{value:277,tweenMethod:"linearNone",tween:!0,target:149,key:"height",index:0},{value:100,tweenMethod:"linearNone",tween:!0,target:149,key:"height",index:6}]}},{target:148,keyframes:{visible:[{value:!1,tweenMethod:"linearNone",tween:!1,target:148,key:"visible",index:0}]}},{target:147,keyframes:{alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:147,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:147,key:"alpha",index:4}]}},{target:179,keyframes:{disabled:[{value:!0,tweenMethod:"linearNone",tween:!1,target:179,key:"disabled",index:0}]}}],name:"success_out",id:4,frameRate:24,action:0},{nodes:[{target:83,keyframes:{scaleY:[{value:1,tweenMethod:"strongOut",tween:!0,target:83,key:"scaleY",index:0},{value:.85,tweenMethod:"linearNone",tween:!0,target:83,key:"scaleY",index:6}],scaleX:[{value:1,tweenMethod:"strongOut",tween:!0,target:83,key:"scaleX",index:0},{value:.85,tweenMethod:"linearNone",tween:!0,target:83,key:"scaleX",index:6}]}},{target:8,keyframes:{y:[{value:98,tweenMethod:"linearNone",tween:!0,target:8,key:"y",index:0},{value:98.01,tweenMethod:"linearNone",tween:!0,target:8,key:"y",index:4}],x:[{value:48,tweenMethod:"linearNone",tween:!0,target:8,key:"x",index:0},{value:48.01,tweenMethod:"linearNone",tween:!0,target:8,key:"x",index:4}]}},{target:185,keyframes:{visible:[{value:!0,tweenMethod:"linearNone",tween:!1,target:185,key:"visible",index:0},{value:!1,tweenMethod:"linearNone",tween:!1,target:185,key:"visible",index:4}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:185,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:185,key:"alpha",index:3}]}},{target:150,keyframes:{alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:150,key:"alpha",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:150,key:"alpha",index:5}]}},{target:84,keyframes:{visible:[{value:!1,tweenMethod:"linearNone",tween:!1,target:84,key:"visible",index:0}]}},{target:85,keyframes:{visible:[{value:!1,tweenMethod:"linearNone",tween:!1,target:85,key:"visible",index:0}]}},{target:86,keyframes:{visible:[{value:!1,tweenMethod:"linearNone",tween:!1,target:86,key:"visible",index:0}]}}],name:"s_middle2small",id:5,frameRate:30,action:0},{nodes:[{target:83,keyframes:{scaleY:[{value:.85,tweenMethod:"backOut",tween:!0,target:83,key:"scaleY",index:0},{value:1.1,tweenMethod:"linearNone",tween:!0,target:83,key:"scaleY",index:8}],scaleX:[{value:.85,tweenMethod:"backOut",tween:!0,target:83,key:"scaleX",index:0},{value:1.1,tweenMethod:"linearNone",tween:!0,target:83,key:"scaleX",index:8}]}},{target:86,keyframes:{visible:[{value:!1,tweenMethod:"linearNone",tween:!1,target:86,key:"visible",index:0}]}},{target:8,keyframes:{y:[{value:98,tweenMethod:"linearNone",tween:!0,target:8,key:"y",index:0},{value:98,tweenMethod:"linearNone",tween:!0,target:8,key:"y",index:10},{value:144,tweenMethod:"linearNone",tween:!0,target:8,key:"y",index:15}]}},{target:84,keyframes:{visible:[{value:!1,tweenMethod:"linearNone",tween:!1,target:84,key:"visible",index:0},{value:!0,tweenMethod:"linearNone",tween:!1,target:84,key:"visible",index:10}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:84,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:84,key:"alpha",index:10},{value:1,tweenMethod:"linearNone",tween:!0,target:84,key:"alpha",index:15}]}},{target:85,keyframes:{visible:[{value:!1,tweenMethod:"linearNone",tween:!1,target:85,key:"visible",index:0},{value:!0,tweenMethod:"linearNone",tween:!1,target:85,key:"visible",index:10}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:85,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:85,key:"alpha",index:10},{value:1,tweenMethod:"linearNone",tween:!0,target:85,key:"alpha",index:15}]}},{target:150,keyframes:{visible:[{value:!0,tweenMethod:"linearNone",tween:!1,target:150,key:"visible",index:0},{value:!1,tweenMethod:"linearNone",tween:!1,target:150,key:"visible",index:11}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:150,key:"alpha",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:150,key:"alpha",index:10}]}},{target:185,keyframes:{visible:[{value:!1,tweenMethod:"linearNone",tween:!1,target:185,key:"visible",index:0},{value:!0,tweenMethod:"linearNone",tween:!1,target:185,key:"visible",index:10}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:185,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:185,key:"alpha",index:10},{value:1,tweenMethod:"linearNone",tween:!0,target:185,key:"alpha",index:15}]}}],name:"s_small2big",id:6,frameRate:30,action:0},{nodes:[{target:83,keyframes:{scaleY:[{value:1.1,tweenMethod:"backIn",tween:!0,target:83,key:"scaleY",index:0},{value:.85,tweenMethod:"linearNone",tween:!0,target:83,key:"scaleY",index:6}],scaleX:[{value:1.1,tweenMethod:"backIn",tween:!0,target:83,key:"scaleX",index:0},{value:.85,tweenMethod:"linearNone",tween:!0,target:83,key:"scaleX",index:6}]}},{target:86,keyframes:{visible:[{value:!1,tweenMethod:"linearNone",tween:!1,target:86,key:"visible",index:0},{value:!0,tweenMethod:"linearNone",tween:!1,target:86,key:"visible",index:10}],scaleY:[{value:1.2,tweenMethod:"linearNone",tween:!0,target:86,key:"scaleY",index:0},{value:2.4,tweenMethod:"strongIn",tween:!0,target:86,key:"scaleY",index:10},{value:1.2,tweenMethod:"linearNone",tween:!0,target:86,key:"scaleY",index:15}],scaleX:[{value:1.2,tweenMethod:"linearNone",tween:!0,target:86,key:"scaleX",index:0},{value:2.4,tweenMethod:"strongIn",tween:!0,target:86,key:"scaleX",index:10},{value:1.2,tweenMethod:"linearNone",tween:!0,target:86,key:"scaleX",index:15}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:86,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:86,key:"alpha",index:10},{value:1,tweenMethod:"linearNone",tween:!0,target:86,key:"alpha",index:15}]}},{target:8,keyframes:{y:[{value:144,tweenMethod:"linearNone",tween:!0,target:8,key:"y",index:0},{value:98,tweenMethod:"linearNone",tween:!0,target:8,key:"y",index:6}]}},{target:150,keyframes:{visible:[{value:!1,tweenMethod:"linearNone",tween:!1,target:150,key:"visible",index:0},{value:!0,tweenMethod:"linearNone",tween:!1,target:150,key:"visible",index:4}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:150,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:150,key:"alpha",index:4},{value:1,tweenMethod:"linearNone",tween:!0,target:150,key:"alpha",index:7}]}},{target:84,keyframes:{visible:[{value:!0,tweenMethod:"linearNone",tween:!1,target:84,key:"visible",index:0},{value:!1,tweenMethod:"linearNone",tween:!1,target:84,key:"visible",index:7}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:84,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:84,key:"alpha",index:6}]}},{target:85,keyframes:{visible:[{value:!0,tweenMethod:"linearNone",tween:!1,target:85,key:"visible",index:0},{value:!1,tweenMethod:"linearNone",tween:!1,target:85,key:"visible",index:7}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:85,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:85,key:"alpha",index:6}]}},{target:185,keyframes:{visible:[{value:!0,tweenMethod:"linearNone",tween:!1,target:185,key:"visible",index:0},{value:!1,tweenMethod:"linearNone",tween:!1,target:185,key:"visible",index:7}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:185,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:185,key:"alpha",index:6}]}}],name:"s_big2small",id:7,frameRate:30,action:0}]},i}(View);t.match_shilianUI=i}(e.lobby||(e.lobby={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.createView(e.lobby.match_ticketUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Sprite",props:{y:542,x:969,width:999,pivotY:347,pivotX:504,name:"root",height:656},child:[{type:"Image",props:{y:44,x:49,width:907,skin:"myres/pop2_bg.png",name:"bg0",height:586,sizeGrid:"2,2,2,2"},child:[{type:"Image",props:{y:126,x:0,width:927,skin:"myres/pop_black.png",name:"bar",height:497}},{type:"Image",props:{y:0,x:0,width:949,skin:"myres/pop_black.png",name:"bar",height:117}}]},{type:"Image",props:{y:44,x:49,width:907,skin:"myres/pop2_bound.png",name:"bound",height:586,sizeGrid:"24,27,11,21"}},{type:"Label",props:{y:43,x:409,width:165,valign:"middle",text:"入场方式选择",name:"titlebook",height:76,fontSize:45,font:"fengyu",color:"#e8af71",align:"center"}},{type:"Image",props:{y:483,x:134,width:336,skin:"myres/match/btn_ticket.png",height:101},child:[{type:"Label",props:{y:55,x:33,width:77,text:"消耗",height:38,fontSize:33,font:"SimHei",color:"#c8cbd0"},child:[{type:"Label",props:{y:0,x:190,width:77,text:"99999",height:38,fontSize:33,font:"SimHei",color:"#c8cbd0"}}]}]},{type:"Image",props:{y:483,x:532,width:340,skin:"myres/match/btn_coin.png",height:102},child:[{type:"Label",props:{y:54,x:32,width:77,text:"消耗",height:38,fontSize:33,font:"SimHei",color:"#c8cbd0"},child:[{type:"Label",props:{y:0,x:190,width:77,text:"99999",height:38,fontSize:33,font:"SimHei",color:"#c8cbd0"}}]}]},{type:"Label",props:{y:438,x:191,width:273,text:"拥有试炼券",height:42,fontSize:35,font:"SimHei",color:"#c8cbd0"},child:[{type:"Label",props:{y:4,x:197,text:"9999",fontSize:35,font:"SimHei",color:"#c8cbd0"}},{type:"Image",props:{y:-6,x:-44,width:42,skin:"myres/match_ticket.png",height:42}}]},{type:"Label",props:{y:438,x:589,width:273,text:"拥有铜币",height:42,fontSize:35,font:"SimHei",color:"#c8cbd0"},child:[{type:"Label",props:{y:4,x:197,text:"9999",fontSize:35,font:"SimHei",color:"#c8cbd0"}},{type:"Image",props:{y:-6,x:-44,width:42,skin:"myres/gold0.png",height:42}}]},{type:"Label",props:{y:257,x:282,width:443,underline:!0,text:"试炼券可以通过活动获取",height:43,fontSize:39,font:"SimHei",color:"#499f57"}},{type:"Image",props:{y:55,x:909,skin:"myres/match/close.png",scaleY:1.5,scaleX:1.5}}]}]},i}(View);t.match_ticketUI=i}(e.lobby||(e.lobby={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.CButton",capsui.CButton),t.prototype.createChildren.call(this),this.createView(e.lobby.nicknameUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Sprite",props:{y:539,x:913,width:834,pivotY:278,pivotX:417,name:"root",height:536},child:[{type:"Image",props:{y:9,x:14,width:804,skin:"myres/pop2_bg.png",name:"bg",height:518,sizeGrid:"2,2,2,2"},child:[{type:"Image",props:{y:9,x:-1,width:805,skin:"myres/pop_black.png",name:"bar",height:94}},{type:"Image",props:{y:123,x:-1,width:805,skin:"myres/pop_black.png",name:"bar",height:379}}]},{type:"Image",props:{y:9,x:11,width:807,skin:"myres/pop2_bound.png",name:"bound",height:518,sizeGrid:"24,27,11,21"}},{type:"Label",props:{y:39,x:305,width:234,text:"取个昵称吧",height:53,fontSize:45,font:"fengyu",color:"#e6af73"}},{type:"Image",props:{y:194,x:102,width:622,skin:"myres/inputbox.png",height:111,sizeGrid:"7,12,10,9"}},{type:"Label",props:{y:227,x:127,width:287,text:"昵称(1-7字)",name:"lb",height:65,fontSize:45,font:"youyuan",color:"#ffffff",bold:!1,align:"left"}},{type:"TextInput",props:{y:196,x:119,width:585,restrict:"a-zA-Z0-9\\u2E80-\\u9FFF~@!#$%&()_+=|{}:;<>",promptColor:"#ffffff",name:"txtinput",height:111,fontSize:45,font:"SimHei",color:"#ffffff"}},{type:"Label",props:{y:230,x:578,width:127,text:"可使用",name:"yes",height:46,fontSize:40,font:"youyuan",color:"#509859"}},{type:"Label",props:{y:230,x:578,width:115,text:"不可用",name:"no",height:35,fontSize:40,font:"youyuan",color:"#d12e30"}},{type:"Button",props:{y:416,x:411,width:404,name:"btn_confirm",height:96,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:1,x:0,width:401,skin:"myres/lobby/pickname.png",height:94}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]},{type:"Sprite",props:{y:539,x:913,width:834,pivotY:278,pivotX:417,name:"root_xinshou",height:536},child:[{type:"Image",props:{y:9,x:14,width:804,skin:"myres/pop2_bg.png",name:"bg",height:518,sizeGrid:"2,2,2,2"},child:[{type:"Image",props:{y:9,x:-1,width:805,skin:"myres/pop_black.png",name:"bar",height:94}},{type:"Image",props:{y:123,x:-1,width:805,skin:"myres/pop_black.png",name:"bar",height:379}}]},{type:"Image",props:{y:9,x:11,width:807,skin:"myres/pop2_bound.png",name:"bound",height:518,sizeGrid:"24,27,11,21"}},{type:"Label",props:{y:39,x:305,width:234,text:"新手教程",height:53,fontSize:45,font:"fengyu",color:"#e6af73",align:"center"}},{type:"Label",props:{y:208,x:95,width:655,text:"欢迎来到雀魂麻雀道馆！",name:"lb",height:58,fontSize:30,font:"SimHei",color:"#ffffff",bold:!1,align:"center"}},{type:"Label",props:{y:153,x:95,width:655,text:"昵称",name:"name",height:58,fontSize:35,font:"SimHei",color:"#ffffff",bold:!1,align:"center"}},{type:"Label",props:{y:265,x:94,width:655,text:"您了解麻雀的基本规则吗？",name:"lb",height:58,fontSize:30,font:"SimHei",color:"#ffffff",bold:!1,align:"center"}},{type:"Label",props:{y:322,x:94,width:655,text:"来看看我们的简单日麻教学吧！",name:"lb",height:58,fontSize:30,font:"SimHei",color:"#ffffff",bold:!1,align:"center"}},{type:"Button",props:{y:455,x:267,width:200,name:"btn_no",height:90,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:6,x:10,width:178,skin:"myres/lobby/act_btn1.png",height:80,sizeGrid:"17,27,24,29"},child:[{type:"Label",props:{y:20,x:9,width:158,text:"不用了",height:43,fontSize:35,font:"fengyu",color:"#1c0522",align:"center"}}]},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:455,x:568,width:200,name:"btn_yes",height:90,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:6,x:12,width:178,skin:"myres/lobby/act_btn1.png",height:80,sizeGrid:"17,27,24,29"},child:[{type:"Label",props:{y:20,x:9,width:158,text:"好的",height:43,fontSize:35,font:"fengyu",color:"#1c0522",align:"center"}}]},{type:"Script",props:{runtime:"capsui.CButton"}}]}]}]},i}(View);t.nicknameUI=i}(e.lobby||(e.lobby={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.CButton",capsui.CButton),t.prototype.createChildren.call(this),this.createView(e.lobby.number_inputUI.uiView)},i.uiView={type:"View",props:{x:0,width:1920,height:1080,anchorX:0},child:[{type:"Sprite",props:{y:548,x:864,width:813,pivotY:300,pivotX:400,name:"root",height:687},child:[{type:"Image",props:{y:318,x:407,width:788,skin:"myres/pop_bg.png",name:"bg0",height:767,anchorY:.5,anchorX:.5,sizeGrid:"100,100,100,100"},child:[{type:"Image",props:{y:28,x:32,width:98,skin:"myres/pop_texturecut.png",name:"left",height:714,sizeGrid:"0,0,24,26"}},{type:"Image",props:{y:27,x:762,width:110,skin:"myres/pop_texturecut.png",scaleX:-1,name:"right",height:715,sizeGrid:"0,0,24,26"}},{type:"Image",props:{y:38,x:34,width:730,skin:"myres/pop_black.png",name:"bar",height:73}},{type:"Image",props:{y:118,x:35,width:726,skin:"myres/pop_black.png",name:"bar",height:602}}]},{type:"Image",props:{y:318,x:407,width:788,skin:"myres/pop_bound.png",name:"bound",height:767,anchorY:.5,anchorX:.5,sizeGrid:"131,102,97,106"}},{type:"Label",props:{y:-31,x:319,width:165,valign:"middle",text:"加入房间",name:"title",height:76,fontSize:45,font:"fengyu",color:"#e8af71",align:"center"}},{type:"Button",props:{y:606,x:407,width:181,stateNum:1,skin:"myres/btn_small.png",name:"btn_confirm",height:77,anchorY:.5,anchorX:.5,sizeGrid:"30,30,30,30"},child:[{type:"Label",props:{y:5,x:9,width:163,valign:"middle",text:"确定",height:66,fontSize:48,font:"fengyu",color:"#e8af71",align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Image",props:{y:75,x:173,width:456,skin:"myres/inputbox.png",name:"input",height:80,sizeGrid:"7,12,10,9"},child:[{type:"TextInput",props:{y:7,x:3,width:445,valign:"middle",restrict:"0-9",promptColor:"#d0cdcd",name:"txtinput",maxChars:10,height:70,fontSize:50,font:"haolong",color:"#d0cdcd",align:"center"}}]},{type:"Button",props:{y:-30,x:758,width:113,pivotY:50,pivotX:53,name:"btn_cancel",height:111},child:[{type:"Image",props:{y:-1,x:3,width:96,skin:"myres/btn_close.png",height:96}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Sprite",props:{y:147,x:101,width:577,name:"numpad",height:388},child:[{type:"Image",props:{y:32,x:53,width:162,skin:"myres/lobby/num.png",name:"n1",height:84,sizeGrid:"19,22,21,20"},child:[{type:"Image",props:{y:0,x:0,width:162,skin:"myres/lobby/num_pressed.png",name:"s",height:84}},{type:"Label",props:{y:14,x:68,width:36,text:"1",height:52,fontSize:55,font:"SimHei",color:"#a0a2aa",bold:!0}}]},{type:"Image",props:{y:32,x:220,width:162,skin:"myres/lobby/num.png",name:"n2",height:84,sizeGrid:"19,22,21,20"},child:[{type:"Image",props:{y:0,x:0,width:162,skin:"myres/lobby/num_pressed.png",name:"s",height:84}},{type:"Label",props:{y:14,x:68,width:36,text:"2",height:52,fontSize:55,font:"SimHei",color:"#a0a2aa",bold:!0}}]},{type:"Image",props:{y:32,x:386,width:162,skin:"myres/lobby/num.png",name:"n3",height:84,sizeGrid:"19,22,21,20"},child:[{type:"Image",props:{y:0,x:0,width:162,skin:"myres/lobby/num_pressed.png",name:"s",height:84}},{type:"Label",props:{y:14,x:68,width:36,text:"3",height:52,fontSize:55,font:"SimHei",color:"#a0a2aa",bold:!0}}]},{type:"Image",props:{y:121,x:53,width:162,skin:"myres/lobby/num.png",name:"n4",height:84,sizeGrid:"19,22,21,20"},child:[{type:"Image",props:{y:0,x:0,width:162,skin:"myres/lobby/num_pressed.png",name:"s",height:84}},{type:"Label",props:{y:14,x:68,width:36,text:"4",height:52,fontSize:55,font:"SimHei",color:"#a0a2aa",bold:!0}}]},{type:"Image",props:{y:121,x:220,width:162,skin:"myres/lobby/num.png",name:"n5",height:84,sizeGrid:"19,22,21,20"},child:[{type:"Image",props:{y:0,x:0,width:162,skin:"myres/lobby/num_pressed.png",name:"s",height:84}},{type:"Label",props:{y:14,x:68,width:36,text:"5",height:52,fontSize:55,font:"SimHei",color:"#a0a2aa",bold:!0}}]},{type:"Image",props:{y:121,x:386,width:162,skin:"myres/lobby/num.png",name:"n6",height:84,sizeGrid:"19,22,21,20"},child:[{type:"Image",props:{y:0,x:0,width:162,skin:"myres/lobby/num_pressed.png",name:"s",height:84}},{type:"Label",props:{y:14,x:68,width:36,text:"6",height:52,fontSize:55,font:"SimHei",color:"#a0a2aa",bold:!0}}]},{type:"Image",props:{y:210,x:53,width:162,skin:"myres/lobby/num.png",name:"n7",height:84,sizeGrid:"19,22,21,20"},child:[{type:"Image",props:{y:0,x:0,width:162,skin:"myres/lobby/num_pressed.png",name:"s",height:84}},{type:"Label",props:{y:14,x:68,width:36,text:"7",height:52,fontSize:55,font:"SimHei",color:"#a0a2aa",bold:!0}}]},{type:"Image",props:{y:210,x:220,width:162,skin:"myres/lobby/num.png",name:"n8",height:84,sizeGrid:"19,22,21,20"},child:[{type:"Image",props:{y:0,x:0,width:162,skin:"myres/lobby/num_pressed.png",name:"s",height:84}},{type:"Label",props:{y:14,x:68,width:36,text:"8",height:52,fontSize:55,font:"SimHei",color:"#a0a2aa",bold:!0}}]},{type:"Image",props:{y:210,x:386,width:162,skin:"myres/lobby/num.png",name:"n9",height:84,sizeGrid:"19,22,21,20"},child:[{type:"Image",props:{y:0,x:0,width:162,skin:"myres/lobby/num_pressed.png",name:"s",height:84}},{type:"Label",props:{y:14,x:68,width:36,text:"9",height:52,fontSize:55,font:"SimHei",color:"#a0a2aa",bold:!0}}]},{type:"Image",props:{y:299,x:53,width:162,skin:"myres/lobby/num.png",name:"clear",height:84,sizeGrid:"19,22,21,20"},child:[{type:"Image",props:{y:0,x:0,width:162,skin:"myres/lobby/num_pressed.png",name:"s",height:84}},{type:"Label",props:{y:16,x:24,width:111,text:"清空",height:52,fontSize:45,font:"SimHei",color:"#a0a2aa",bold:!1,align:"center"}}]},{type:"Image",props:{y:299,x:220,width:162,skin:"myres/lobby/num.png",name:"n0",height:84,sizeGrid:"19,22,21,20"},child:[{type:"Image",props:{y:0,x:0,width:162,skin:"myres/lobby/num_pressed.png",name:"s",height:84}},{type:"Label",props:{y:14,x:68,width:36,text:"0",height:52,fontSize:55,font:"SimHei",color:"#a0a2aa",bold:!0}}]},{type:"Image",props:{y:299,x:386,width:162,skin:"myres/lobby/num.png",name:"del",height:84,sizeGrid:"19,22,21,20"},child:[{type:"Image",props:{y:0,x:0,width:162,skin:"myres/lobby/num_pressed.png",name:"s",height:84}},{type:"Image",props:{y:5,x:13,skin:"myres/lobby/back.png"}}]}]}]}]},i}(View);t.number_inputUI=i}(e.lobby||(e.lobby={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.UICopy",capsui.UICopy),View.regComponent("capsui.CScrollView",capsui.CScrollView),View.regComponent("capsui.CDropdown",capsui.CDropdown),View.regComponent("capsui.CButton",capsui.CButton),t.prototype.createChildren.call(this),this.createView(e.lobby.obUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Image",props:{y:156,x:73,width:1783,skin:"myres/shop/bg_container.png",name:"root",height:866,sizeGrid:"58,59,63,59"},child:[{type:"Label",props:{y:229,x:542,width:607,text:"当前没有对战信息",name:"noinfo",height:66,fontSize:50,font:"SimHei",color:"#d4ac66",align:"center"}},{type:"Sprite",props:{y:135,x:0,width:1767,name:"scrollview",height:734},child:[{type:"Sprite",props:{y:-78,x:1720,width:50,name:"scrollbar",mouseThrough:!1,mouseEnabled:!0,height:750},child:[{type:"Image",props:{y:0,x:25,skin:"myres/scrollbar.png",name:"scrollbar",height:750,anchorX:.5}},{type:"Image",props:{y:96,x:25,width:45,skin:"myres/scrollpoint.png",name:"scrollpoint",height:45,anchorY:.5,anchorX:.5}}]},{type:"Panel",props:{y:6,x:45,width:1673,name:"content",height:680},child:[{type:"Sprite",props:{y:0,x:12,width:1670,name:"templete",height:231},child:[{type:"Image",props:{y:15,x:7,width:1636,skin:"myres/lobby/OB_bg.png",name:"bg",height:209}},{type:"Sprite",props:{y:58,x:12,width:399,name:"p0",height:160},child:[{type:"Image",props:{y:35,x:131,width:234,skin:"extendRes/title/yuanchuzhihuo.png",name:"title",height:45}},{type:"Label",props:{y:102,x:148,width:232,text:"蹦蹦跳跳的仙太郎",name:"name",height:39,fontSize:27,font:"SimHei",color:"#fbfbfb",align:"left"}},{type:"Image",props:{y:79,x:96,width:255,scaleY:.55,scaleX:.55,pivotY:114,pivotX:145,name:"rank",height:253},child:[{type:"Image",props:{y:0,x:0,skin:"myres/rank_bg.png",name:"bg"}},{type:"Image",props:{y:15,x:0,skin:"extendRes/level/queshi.png",name:"icon"}},{type:"Image",props:{y:191,x:58,skin:"myres/starbg.png",scaleY:1,scaleX:1,name:"star2",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]},{type:"Image",props:{y:142,x:29,skin:"myres/starbg.png",scaleY:.7,scaleX:.7,name:"star3",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]},{type:"Image",props:{y:214,x:110,skin:"myres/starbg.png",scaleY:.7,scaleX:.7,name:"star1",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]}]}]},{type:"Sprite",props:{y:58,x:422,width:398,name:"p1",height:160},child:[{type:"Image",props:{y:35,x:131,width:234,skin:"extendRes/title/yuanchuzhihuo.png",name:"title",height:45}},{type:"Label",props:{y:102,x:148,width:232,text:"蹦蹦跳跳的仙太郎",name:"name",height:39,fontSize:27,font:"SimHei",color:"#fbfbfb",align:"left"}},{type:"Image",props:{y:79,x:96,width:255,scaleY:.55,scaleX:.55,pivotY:114,pivotX:145,name:"rank",height:253},child:[{type:"Image",props:{y:0,x:0,skin:"myres/rank_bg.png",name:"bg"}},{type:"Image",props:{y:15,x:0,skin:"extendRes/level/queshi.png",name:"icon"}},{type:"Image",props:{y:191,x:58,skin:"myres/starbg.png",scaleY:1,scaleX:1,name:"star2",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]},{type:"Image",props:{y:142,x:29,skin:"myres/starbg.png",scaleY:.7,scaleX:.7,name:"star3",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]},{type:"Image",props:{y:214,x:110,skin:"myres/starbg.png",scaleY:.7,scaleX:.7,name:"star1",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]}]}]},{type:"Sprite",props:{y:58,x:814,width:410,name:"p2",height:160},child:[{type:"Image",props:{y:35,x:131,width:234,skin:"extendRes/title/yuanchuzhihuo.png",name:"title",height:45}},{type:"Label",props:{y:102,x:148,width:232,text:"蹦蹦跳跳的仙太郎",name:"name",height:39,fontSize:27,font:"SimHei",color:"#fbfbfb",align:"left"}},{type:"Image",props:{y:79,x:96,width:255,scaleY:.55,scaleX:.55,pivotY:114,pivotX:145,name:"rank",height:253},child:[{type:"Image",props:{y:0,x:0,skin:"myres/rank_bg.png",name:"bg"}},{type:"Image",props:{y:15,x:0,skin:"extendRes/level/queshi.png",name:"icon"}},{type:"Image",props:{y:191,x:58,skin:"myres/starbg.png",scaleY:1,scaleX:1,name:"star2",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]},{type:"Image",props:{y:142,x:29,skin:"myres/starbg.png",scaleY:.7,scaleX:.7,name:"star3",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]},{type:"Image",props:{y:214,x:110,skin:"myres/starbg.png",scaleY:.7,scaleX:.7,name:"star1",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]}]}]},{type:"Sprite",props:{y:58,x:1216,width:410,name:"p3",height:160},child:[{type:"Image",props:{y:35,x:131,width:234,skin:"extendRes/title/yuanchuzhihuo.png",name:"title",height:45}},{type:"Label",props:{y:102,x:148,width:232,text:"蹦蹦跳跳的仙太郎",name:"name",height:39,fontSize:27,font:"SimHei",color:"#fbfbfb",align:"left"}},{type:"Image",props:{y:79,x:96,width:255,scaleY:.55,scaleX:.55,pivotY:114,pivotX:145,name:"rank",height:253},child:[{type:"Image",props:{y:0,x:0,skin:"myres/rank_bg.png",name:"bg"}},{type:"Image",props:{y:15,x:0,skin:"extendRes/level/queshi.png",name:"icon"}},{type:"Image",props:{y:191,x:58,skin:"myres/starbg.png",scaleY:1,scaleX:1,name:"star2",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]},{type:"Image",props:{y:142,x:29,skin:"myres/starbg.png",scaleY:.7,scaleX:.7,name:"star3",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]},{type:"Image",props:{y:214,x:110,skin:"myres/starbg.png",scaleY:.7,scaleX:.7,name:"star1",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]}]}]},{type:"Label",props:{y:25,x:43,width:295,text:"金之间·四人东",name:"mode",height:40,fontSize:35,font:"SimHei",color:"#d4ac66"}},{type:"Label",props:{y:24,x:1523,width:91,text:"12:59",name:"time",height:40,fontSize:35,font:"SimHei",color:"#555f77",bold:!0}},{type:"Button",props:{y:15,x:7,width:1635,name:"btn",height:207}},{type:"Script",props:{y:0,x:-12,runtime:"capsui.UICopy"}}]}]},{type:"Script",props:{runtime:"capsui.CScrollView"}}]},{type:"Button",props:{y:56,x:393,width:55,stateNum:1,skin:"myres/lobby/OB_arrow.png",name:"btn_dropdown0",height:72}},{type:"Sprite",props:{y:54,x:70,width:323,name:"dropdown0",height:72},child:[{type:"Button",props:{y:-276,x:-272,width:2167,name:"out",height:1215}},{type:"Image",props:{y:0,x:0,width:323,skin:"myres/inputbox.png",name:"bg",height:499,sizeGrid:"7,12,10,9"}},{type:"Image",props:{y:72,x:1,width:320,skin:"myres/lobby/OB_line.png",name:"line",height:3},child:[{type:"Script",props:{y:-72,x:-1,runtime:"capsui.UICopy"}}]},{type:"Button",props:{y:0,x:0,width:323,name:"templete",height:72},child:[{type:"Label",props:{y:22,x:0,width:323,text:"所有模式",name:"word",height:35,fontSize:35,font:"SimHei",color:"#d4ac66",align:"center"}},{type:"Script",props:{runtime:"capsui.UICopy"}}]},{type:"Panel",props:{y:73,x:0,width:323,name:"content",height:379}},{type:"Script",props:{runtime:"capsui.CDropdown"}}]},{type:"Button",props:{y:56,x:828,width:55,stateNum:1,skin:"myres/lobby/OB_arrow.png",name:"btn_dropdown1",height:72}},{type:"Sprite",props:{y:54,x:505,width:323,name:"dropdown1",height:72},child:[{type:"Button",props:{y:-270,x:-672,width:2127,name:"out",height:1183}},{type:"Image",props:{y:0,x:0,width:323,skin:"myres/inputbox.png",name:"bg",height:499,sizeGrid:"7,12,10,9"}},{type:"Image",props:{y:72,x:1,width:320,skin:"myres/lobby/OB_line.png",name:"line",height:3},child:[{type:"Script",props:{y:-72,x:-1,runtime:"capsui.UICopy"}}]},{type:"Button",props:{y:0,x:0,width:323,name:"templete",height:72},child:[{type:"Label",props:{y:22,x:0,width:323,text:"所有模式",name:"word",height:35,fontSize:35,font:"SimHei",color:"#d4ac66",align:"center"}},{type:"Script",props:{runtime:"capsui.UICopy"}}]},{type:"Panel",props:{y:73,x:0,width:323,name:"content",height:379}},{type:"Script",props:{runtime:"capsui.CDropdown"}}]},{type:"Button",props:{y:49,x:1290,width:408,name:"check_friend",height:75},child:[{type:"Label",props:{y:20,x:76,width:323,text:"仅显示好友所在对局",name:"word",height:35,fontSize:35,font:"SimHei",color:"#d4ac66",align:"center"}},{type:"Image",props:{y:17,x:29,width:44,skin:"myres/bothui/checkbox.png",name:"check",height:43}},{type:"Image",props:{y:17,x:29,width:44,skin:"myres/bothui/check.png",name:"checkbox",height:43}}]},{type:"Button",props:{y:92,x:1017,width:169,stateNum:1,skin:"myres/lobby/btn_go.png",name:"btn_refresh",height:72,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:13,x:25,skin:"myres/refresh.png"}},{type:"Label",props:{y:19,x:67,width:82,text:"刷新",name:"word",height:35,fontSize:35,font:"SimHei",color:"#0a0e1b",align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]},{type:"Image",props:{y:48,x:119,width:401,skin:"myres/img_return1_bg.png",name:"top",height:81},child:[{type:"Label",props:{y:3,x:105,width:95,text:"观战",scaleY:1.4,scaleX:1.4,height:45,font:"fengyu",color:"#e4ba86",align:"center"}},{type:"Button",props:{y:41,x:-42,width:182,pivotY:75,pivotX:74,name:"btn_back",height:142},child:[{type:"Image",props:{y:6,x:7,width:135,skin:"myres/img_return1.png",height:134}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]}]},i}(View);t.obUI=i}(e.lobby||(e.lobby={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.CButton",capsui.CButton),View.regComponent("capsui.CScrollView",capsui.CScrollView),View.regComponent("capsui.CLoading",capsui.CLoading),View.regComponent("capsui.UICopy",capsui.UICopy),t.prototype.createChildren.call(this),this.createView(e.lobby.paipuUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Sprite",props:{y:0,x:0,width:1924,name:"top",height:90},child:[{type:"Image",props:{y:-4,x:0,width:1922,skin:"myres/lobby/bg_1.png",name:"black",height:163}},{type:"Image",props:{y:37,x:119,width:401,skin:"myres/img_return1_bg.png",name:"top",height:81},child:[{type:"Label",props:{y:3,x:65,width:153,text:"牌谱",scaleY:1.4,scaleX:1.4,height:57,fontSize:70,font:"fengyu",color:"#e4ba86",align:"center"}}]},{type:"Button",props:{y:80,x:79,width:182,pivotY:77,pivotX:76,name:"btn_back",height:142},child:[{type:"Image",props:{y:6,x:7,skin:"myres/img_return1.png",scaleY:1.2,scaleX:1.2}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]},{type:"Image",props:{y:153,x:71,width:1797,skin:"myres/shop/bg_container.png",name:"scrollview",height:865,sizeGrid:"58,59,63,59"},child:[{type:"Script",props:{mouseMoveFix:1,runtime:"capsui.CScrollView"}},{type:"Sprite",props:{y:350,x:844,width:127,name:"loading",mouseThrough:!0,height:133},child:[{type:"Image",props:{y:67,x:26,skin:"myres/necessary/flower_nei.png",scaleY:1.2,scaleX:1.2,rotation:0,name:"flower",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:0,x:0,skin:"myres/necessary/flower_shine.png",name:"shine",alpha:1}},{type:"Image",props:{y:56,x:56,skin:"myres/necessary/round.png",name:"round",anchorY:.5,anchorX:.5}},{type:"Image",props:{y:142,x:0,skin:"myres/necessary/word.png"}}]},{type:"Script",props:{runtime:"capsui.CLoading"}}]},{type:"Sprite",props:{y:55,x:1737,width:50,name:"scrollbar",mouseThrough:!1,mouseEnabled:!0,height:750},child:[{type:"Image",props:{y:0,x:25,skin:"myres/scrollbar.png",name:"scrollbar",height:750,anchorX:.5}},{type:"Image",props:{y:96,x:25,width:45,skin:"myres/scrollpoint.png",name:"scrollpoint",height:45,anchorY:.5,anchorX:.5}}]},{type:"Panel",props:{y:45,x:47,width:1694,vScrollBarSkin:"myres/vscroll.png",name:"content",height:772},child:[{type:"Sprite",props:{y:0,x:0,width:1696,name:"templete",height:174},child:[{type:"Image",props:{y:0,x:-4,width:1700,skin:"myres/lobby/bg_paipu.png",name:"bg",height:169}},{type:"Sprite",props:{y:7,x:-3,name:"p0"},child:[{type:"Image",props:{y:26,x:6,width:603,skin:"myres/lobby/mask_chosen.png",name:"chosen",height:43}},{type:"Label",props:{y:22,x:27,width:32,text:"1",name:"rank",height:32,fontSize:36,font:"haolong",color:"#489dbc"}},{type:"Label",props:{y:26,x:107,text:"要七个字的名字",name:"name",fontSize:38,font:"SimHei",color:"#a0a0a0"}},{type:"Label",props:{y:26,x:341,width:194,text:"25000",name:"score",height:35,fontSize:35,color:"#ffc458",align:"right"}},{type:"Label",props:{y:20,x:51,width:33,text:"位",name:"rank_word",height:33,fontSize:33,font:"fengyu",color:"#489dbc"}}]},{type:"Sprite",props:{y:7,x:547,name:"p1"},child:[{type:"Image",props:{y:26,x:6,width:603,skin:"myres/lobby/mask_chosen.png",name:"chosen",height:43}},{type:"Label",props:{y:22,x:27,width:32,text:"2",name:"rank",height:32,fontSize:36,font:"haolong",color:"#57bbdf"}},{type:"Label",props:{y:26,x:107,text:"要七个字的名字",name:"name",fontSize:38,font:"SimHei",color:"#dfdfdf"}},{type:"Label",props:{y:26,x:369,width:166,text:"25000",name:"score",height:35,fontSize:35,color:"#ffc458",align:"right"}},{type:"Label",props:{y:20,x:51,width:33,text:"位",name:"rank_word",height:33,fontSize:33,font:"fengyu",color:"#57bbdf"}}]},{type:"Sprite",props:{y:76,x:-2,name:"p2"},child:[{type:"Image",props:{y:26,x:6,width:603,skin:"myres/lobby/mask_chosen.png",name:"chosen",height:43}},{type:"Label",props:{y:23,x:27,width:32,text:"3",name:"rank",height:32,fontSize:36,font:"haolong",color:"#489dbc"}},{type:"Label",props:{y:26,x:107,text:"要七个字的名字",name:"name",fontSize:38,font:"SimHei",color:"#a0a0a0"}},{type:"Label",props:{y:26,x:356,width:179,text:"25000",name:"score",height:35,fontSize:35,color:"#ffc458",align:"right"}},{type:"Label",props:{y:21,x:51,width:33,text:"位",name:"rank_word",height:33,fontSize:33,font:"fengyu",color:"#489dbc"}}]},{type:"Sprite",props:{y:76,x:548,name:"p3"},child:[{type:"Image",props:{y:26,x:6,width:603,skin:"myres/lobby/mask_chosen.png",name:"chosen",height:43}},{type:"Label",props:{y:22,x:27,width:32,text:"4",name:"rank",height:32,fontSize:36,font:"haolong",color:"#489dbc"}},{type:"Label",props:{y:26,x:107,text:"要七个字的名字",name:"name",fontSize:38,font:"SimHei",color:"#a0a0a0"}},{type:"Label",props:{y:26,x:375,width:160,text:"25000",name:"score",height:35,fontSize:35,color:"#ffc458",align:"right"}},{type:"Label",props:{y:20,x:51,width:33,text:"位",name:"rank_word",height:33,fontSize:33,font:"fengyu",color:"#489dbc"}}]},{type:"Label",props:{y:87,x:1171,width:450,valign:"middle",text:"2018/05/03 12:35",scaleY:.75,scaleX:.75,name:"date",height:88,fontSize:40,font:"haolong",color:"#b5b5b5",align:"left"}},{type:"Label",props:{y:42,x:1171,width:330,text:"对局时间",name:"room",height:50,fontSize:40,font:"fengyu",color:"#b5b5b5"}},{type:"Button",props:{y:49,x:1598,width:156,stateNum:1,skin:"myres/btn_small.png",name:"check",height:70,anchorY:.5,anchorX:.5,sizeGrid:"30,30,30,30"},child:[{type:"Label",props:{y:9,x:39,width:82,text:"查看",height:39,fontSize:40,font:"fengyu",color:"#e6ba78"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:122,x:1598,width:156,stateNum:1,skin:"myres/btn_small.png",name:"share",height:70,anchorY:.5,anchorX:.5,sizeGrid:"30,30,30,30"},child:[{type:"Label",props:{y:9,x:39,width:82,text:"分享",height:39,fontSize:40,font:"fengyu",color:"#e6ba78"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Script",props:{runtime:"capsui.UICopy"}}]}]},{type:"Button",props:{y:-51,x:1667,width:241,stateNum:1,skin:"myres/btn_small.png",name:"checkother",height:70,anchorY:.5,anchorX:.5,sizeGrid:"30,30,30,30"},child:[{type:"Label",props:{y:10,x:25,width:194,text:"其他牌谱",height:55,fontSize:40,font:"fengyu",color:"#e6ba78",align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]},{type:"Sprite",props:{y:574,x:948,width:813,pivotY:409,pivotX:400,name:"pop",height:714},child:[{type:"Image",props:{y:400,x:400,width:1200,skin:"myres/pop_bg.png",name:"bg0",height:530,anchorY:.5,anchorX:.5,sizeGrid:"100,100,100,100"},child:[{type:"Image",props:{y:28,x:32,width:98,skin:"myres/pop_texturecut.png",name:"left",height:477,sizeGrid:"0,0,24,26"}},{type:"Image",props:{y:27,x:1174,width:110,skin:"myres/pop_texturecut.png",scaleX:-1,name:"right",height:475,sizeGrid:"0,0,24,26"}},{type:"Image",props:{y:84,x:32,width:1142,skin:"myres/pop_black.png",name:"bar",height:361}}]},{type:"Image",props:{y:400,x:400,width:1200,skin:"myres/pop_bound.png",name:"bound",height:530,anchorY:.5,anchorX:.5,sizeGrid:"131,102,97,106"}},{type:"Label",props:{y:211,x:199,width:412,valign:"middle",text:"输入牌谱编号",name:"title",height:76,fontSize:45,font:"fengyu",color:"#e8af71",align:"center"}},{type:"Button",props:{y:544,x:394,width:181,stateNum:1,skin:"myres/btn_small.png",name:"btn_confirm",height:77,anchorY:.5,anchorX:.5,sizeGrid:"30,30,30,30"},child:[{type:"Label",props:{y:4,x:9,width:163,valign:"middle",text:"确定",height:66,fontSize:48,font:"fengyu",color:"#e8af71",align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Image",props:{y:308,x:-64,width:948,skin:"myres/inputbox.png",name:"input",height:187,sizeGrid:"7,12,10,9"},child:[{type:"TextInput",props:{y:0,x:0,wordWrap:!0,width:946,valign:"middle",promptColor:"#d0cdcd",name:"txtinput",multiline:!0,hitTestPrior:!0,height:186,fontSize:40,font:"SimHei",color:"#d0cdcd",align:"center"}}]},{type:"Button",props:{y:170,x:959,width:135,pivotY:63,pivotX:67,name:"btn_cancel",height:125},child:[{type:"Image",props:{y:15,x:19,width:96,skin:"myres/btn_close.png",height:96}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]}]},i}(View);t.paipuUI=i}(e.lobby||(e.lobby={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.CButton",capsui.CButton),t.prototype.createChildren.call(this),this.createView(e.lobby.pipeiUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Sprite",props:{y:499,x:950,width:500,pivotY:255,pivotX:255,name:"root",height:500},child:[{type:"Image",props:{y:255,x:255,width:500,skin:"myres/pop_bg.png",name:"bg0",height:360,anchorY:.5,anchorX:.5,sizeGrid:"100,100,100,100"},child:[{type:"Image",props:{y:26,x:32,width:57,skin:"myres/pop_texturecut.png",height:306,sizeGrid:"0,0,24,26"}},{type:"Image",props:{y:30,x:470,width:57,skin:"myres/pop_texturecut.png",scaleX:-1,height:306,sizeGrid:"0,0,24,26"}},{type:"Image",props:{y:54,x:32,width:442,skin:"myres/pop_black.png",name:"bar",height:63}},{type:"Image",props:{y:125,x:32,width:442,skin:"myres/pop_black.png",name:"bar",height:127}}]},{type:"Image",props:{y:255,x:255,width:500,skin:"myres/pop_bound.png",name:"bound",height:360,anchorY:.5,anchorX:.5,sizeGrid:"131,102,97,106"}},{type:"Label",props:{y:118,x:94,width:335,valign:"middle",text:"匹配场",name:"ttt",height:76,fontSize:41,font:"fengyu",color:"#e8af71",align:"center"}},{type:"Label",props:{y:214,x:99,width:320,valign:"middle",text:"匹配对手中",name:"text",height:95,fontSize:30,font:"SimHei",color:"#c9c9c9",align:"center"}},{type:"Button",props:{y:365,x:262,width:153,stateNum:1,skin:"myres/btn_small.png",name:"btn",height:65,anchorY:.5,anchorX:.5,sizeGrid:"30,30,30,30"},child:[{type:"Label",props:{y:2,x:12,width:143,valign:"middle",text:"取消",scaleY:.9,scaleX:.9,height:61,fontSize:38,font:"fengyu",color:"#e8af71",align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]}]},i}(View);t.pipeiUI=i}(e.lobby||(e.lobby={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.CButton",capsui.CButton),View.regComponent("capsui.UICopy",capsui.UICopy),View.regComponent("capsui.CScrollView",capsui.CScrollView),t.prototype.createChildren.call(this),this.createView(e.lobby.playerinfoUI.uiView)},i.uiView={type:"View",props:{y:0,width:1920,height:1080},child:[{type:"Image",props:{y:0,x:0,width:1920,skin:"设计稿/3.jpg",height:1080}},{type:"Sprite",props:{y:105,x:843,width:1048,name:"root",height:950},child:[{type:"Sprite",props:{y:193,x:-263,width:727,name:"bg",height:556},child:[{type:"Image",props:{y:293,x:792,width:1062,skin:"myres/pop_bg.png",name:"bg0",height:955,anchorY:.5,anchorX:.5,sizeGrid:"100,100,100,100"}},{type:"Image",props:{y:293,x:792,width:1062,skin:"myres/pop_bound.png",name:"bound",height:955,anchorY:.5,anchorX:.5,sizeGrid:"131,102,97,106"}}]},{type:"Button",props:{y:214,x:29,width:83,stateNum:1,skin:"myres/bothui/info_tab_dark.png",name:"tab_info",height:152,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:25,x:20,wordWrap:!0,width:45,text:"信",height:86,fontSize:40,font:"fengyu",color:"#e8af71"}},{type:"Label",props:{y:75,x:20,wordWrap:!0,width:45,text:"息",height:86,fontSize:40,font:"fengyu",color:"#e8af71"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:368,x:29,width:83,stateNum:1,skin:"myres/bothui/info_tab_dark.png",name:"tab_note",height:152,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:25,x:20,wordWrap:!0,width:45,text:"留",height:86,fontSize:40,font:"fengyu",color:"#e8af71"}},{type:"Label",props:{y:75,x:20,wordWrap:!0,width:45,text:"言",height:86,fontSize:40,font:"fengyu",color:"#e8af71"}},{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Image",props:{y:3,x:49,width:40,skin:"myres/lobby/redpoint.png",name:"redpoint",height:40}}]},{type:"Sprite",props:{y:39,x:65,width:938,visible:!1,name:"container_note",height:886},child:[{type:"Image",props:{y:166,x:17,width:909,skin:"myres/bothui/bg.png",name:"bg",height:708,sizeGrid:"18,18,17,17"}},{type:"Label",props:{y:391,x:216,width:508,valign:"middle",text:"没有留言",name:"nonote",height:67,fontSize:40,font:"SimHei",color:"#e8af71",align:"center"}},{type:"Panel",props:{y:184,x:37,width:868,name:"content",height:587},child:[{type:"Sprite",props:{y:0,x:4,width:857,name:"templete",height:244},child:[{type:"Image",props:{y:9,x:116,width:725,skin:"myres/bothui/sms_bg.png",height:225,sizeGrid:"70,72,55,67"}},{type:"Image",props:{y:8,x:118,width:434,skin:"myres/bothui/sms_name.png",height:56,sizeGrid:"9,12,9,4"}},{type:"Button",props:{y:34,x:816,width:60,name:"btn_del",height:60,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:7,x:7,width:46,skin:"myres/bothui/sms_×.png",name:"close",height:46}}]},{type:"Image",props:{y:-11,x:-7,skin:"myres/bg_head1.png",scaleY:.65,scaleX:.65,name:"head"},child:[{type:"Image",props:{y:35,x:23,width:154,skin:"extendRes/charactor/yiji/smallhead.png",height:154}}]},{type:"Label",props:{y:25,x:566,width:130,text:"2018/99/99",name:"date",height:25,fontSize:25,font:"SimHei",color:"#58638d"}},{type:"Label",props:{y:25,x:714,text:"23:59",name:"time",fontSize:25,font:"SimHei",color:"#58638d"}},{type:"Image",props:{y:74,x:142,width:135,skin:"extendRes/emo/e200001/0.png",name:"emo",height:135}},{type:"Label",props:{y:91,x:155,wordWrap:!0,width:664,text:"言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言",name:"word",height:134,fontSize:28,font:"SimHei",color:"#9199ad"}},{type:"Button",props:{y:143,x:58,width:113,pivotY:44,pivotX:58,name:"btn_checkinfo",height:83},child:[{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Image",props:{y:21,x:5,width:104,skin:"myres/bothui/sms_btn.png",name:"info",height:46,sizeGrid:"4,13,11,10"},child:[{type:"Label",props:{y:0,x:2,width:126,text:"信息",scaleY:.8,scaleX:.8,name:"send",height:57,fontSize:30,font:"fengyu",color:"#9b9fa4",align:"center"}}]}]},{type:"Script",props:{runtime:"capsui.UICopy"}},{type:"Label",props:{y:18,x:127,wordWrap:!0,width:274,text:"名字名字名字名字",name:"name",height:35,fontSize:30,font:"SimHei",color:"#9199ad"}},{type:"Label",props:{y:10,x:387,width:184,valign:"middle",text:"段位级别",scaleY:.75,scaleX:.75,name:"level",height:64,fontSize:30,font:"fengyu",color:"#e8af71",align:"right"}}]}]},{type:"Sprite",props:{y:191,x:880,width:50,name:"scrollbar",mouseThrough:!1,mouseEnabled:!0,height:657},child:[{type:"Image",props:{y:0,x:25,skin:"myres/scrollbar.png",name:"scrollbar",height:657,anchorX:.5,alpha:.5}},{type:"Image",props:{y:96,x:25,width:45,skin:"myres/scrollpoint.png",name:"scrollpoint",height:45,anchorY:.5,anchorX:.5}}]},{type:"Sprite",props:{y:768,x:266,width:386,name:"page_controller",height:96},child:[{type:"Image",props:{y:18,x:120,width:144,skin:"myres/bothui/sms_btn.png",height:56,sizeGrid:"4,13,11,10"}},{type:"Label",props:{y:18,x:120,width:144,valign:"middle",text:"1",name:"curr_page",height:55,fontSize:35,font:"SimHei",color:"#9b9da6",align:"center"}},{type:"Button",props:{y:5,x:92,width:198,name:"btn_page",height:83}},{type:"Button",props:{y:46,x:326,width:90,name:"btn_right",height:90,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Image",props:{y:15,x:28,width:46,skin:"myres/bothui/sms_arrow.png",name:"next",height:57}}]},{type:"Button",props:{y:45,x:58,width:90,name:"btn_left",height:90,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Image",props:{y:16,x:61,width:46,skin:"myres/bothui/sms_arrow.png",scaleX:-1,name:"left",height:57}}]},{type:"Image",props:{y:-180,x:120,width:144,name:"container_pages",height:201},child:[{type:"Button",props:{y:-562,x:-386,width:945,name:"close",height:865}},{type:"Image",props:{x:0,width:144,skin:"myres/bothui/page_bg.png",name:"bg",height:200,sizeGrid:"8,10,6,10"},child:[{type:"Panel",props:{y:3,x:3,width:138,name:"content",height:196},child:[{type:"Sprite",props:{width:138,name:"templete",height:54},child:[{type:"Button",props:{y:0,x:0,width:138,stateNum:1,skin:"myres/bothui/dot_line.png",name:"btn",height:51,sizeGrid:"1,1,1,1"}},{type:"Label",props:{y:0,x:0,width:138,valign:"middle",text:"1",name:"page",height:51,fontSize:35,font:"SimHei",color:"#9b9da6",align:"center"}},{type:"Script",props:{y:0,x:0,runtime:"capsui.UICopy"}}]}]},{type:"Script",props:{y:0,x:0,runtime:"capsui.CScrollView"}}]}]}]},{type:"Script",props:{runtime:"capsui.CScrollView"}},{type:"Sprite",props:{y:17,x:7,width:924,name:"sign",height:154},child:[{type:"Image",props:{y:15,x:9,width:903,skin:"myres/bothui/bg.png",name:"bg",height:134,alpha:.5,sizeGrid:"18,18,17,17"}},{type:"Image",props:{y:15,x:132,width:780,skin:"myres/bothui/bg.png",name:"2",height:134,alpha:.5,sizeGrid:"18,18,17,17"}},{type:"Image",props:{y:97,x:859,width:30,skin:"myres/bothui/edit.png",scaleY:1.2,scaleX:1.2,height:31}},{type:"Label",props:{y:69,x:420,wordWrap:!0,width:123,text:"暂无签名",name:"noinfo",height:35,fontSize:30,font:"SimHei",color:"#5c678b"}},{type:"Label",props:{y:61,x:20,width:126,text:"签名",scaleY:.9,scaleX:.9,height:57,fontSize:30,font:"fengyu",color:"#9b9fa4",align:"center"}},{type:"Label",props:{y:49,x:171,wordWrap:!0,width:677,valign:"middle",text:"签名签名签名签名签名签名签名签名签名签名签名签名签名签名签名签名签名签名签名签名签名签名签名签名签名签名签名签名签名签名签名签名签名签名签名签名签名签名签名签名",overflow:"scroll",name:"content",leading:5,height:68,fontSize:30,font:"SimHei",color:"#5c678b"}},{type:"Button",props:{y:33,x:151,width:748,name:"btn_change",height:105}}]}]},{type:"Sprite",props:{y:59,x:58,width:981,name:"container_info",height:888},child:[{type:"Image",props:{y:84,x:846,width:255,scaleY:.75,scaleX:.75,pivotY:114,pivotX:128,name:"rank",height:253},child:[{type:"Image",props:{y:15,x:0,skin:"extendRes/level/queshi.png",name:"icon"}},{type:"Image",props:{y:159,x:-84,skin:"myres/starbg.png",scaleY:1,scaleX:1,name:"star2",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]},{type:"Image",props:{y:159,x:-150,skin:"myres/starbg.png",scaleY:1,scaleX:1,name:"star3",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]},{type:"Image",props:{y:159,x:-15,skin:"myres/starbg.png",scaleY:1,scaleX:1,name:"star1",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]},{type:"Sprite",props:{y:92,x:-176,width:149,scaleY:1.3,scaleX:1.3,name:"exp",height:23},child:[{type:"Label",props:{y:-32,x:0,width:64,text:"6666",name:"value",height:32,fontSize:32,font:"SimHei",color:"#6a97b0",align:"right"}},{type:"Label",props:{y:-32,x:80,text:"9999",name:"max",fontSize:32,font:"SimHei",color:"#6a97b0",align:"left"}},{type:"Label",props:{y:-32,x:64,text:"/",fontSize:32,font:"SimHei",color:"#6a97b0"}},{type:"Sprite",props:{y:0,x:0,width:146,name:"bar",height:22},child:[{type:"Image",props:{y:0,x:0,width:146,skin:"myres/bothui/bg-exp.png",renderType:"mask",name:"mask",height:18}},{type:"Image",props:{y:0,x:-8,width:300,skin:"myres/bothui/rankexp.png",name:"v",height:18}}]}]}]},{type:"Image",props:{y:23,x:37,width:294,skin:"extendRes/title/notitle.png",name:"title",height:56}},{type:"Button",props:{y:52,x:449,width:193,visible:!0,stateNum:1,skin:"myres/bothui/info_btn.png",name:"btn_title",height:76,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Label",props:{y:6,x:9,width:192,valign:"middle",text:"查看称号",scaleY:.9,scaleX:.9,height:62,fontSize:35,font:"fengyu",color:"#6084b0",align:"center"}}]},{type:"Button",props:{y:118,x:449,width:193,stateNum:1,skin:"myres/bothui/info_btn.png",name:"btn_changenickname",height:76,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Label",props:{y:8,x:9,width:192,valign:"middle",text:"更改昵称",scaleY:.9,scaleX:.9,height:63,fontSize:35,font:"fengyu",color:"#6084b0",align:"center"}}]},{type:"Image",props:{y:72,x:31,width:313,skin:"myres/bothui/bg_nickname.png",height:83}},{type:"Label",props:{y:97,x:61,width:258,text:"蹦蹦跳跳的仙太郎",name:"ID",height:35,fontSize:32,font:"SimHei",color:"#f9f6f6",align:"center"}},{type:"Sprite",props:{y:182,x:-8,width:962,name:"data",height:658},child:[{type:"Panel",props:{y:0,x:0,width:956,vScrollBarSkin:"myres/vscroll.png",name:"content",height:667},child:[{type:"Sprite",props:{y:0,x:0,width:950,name:"dahe",height:150},child:[{type:"Image",props:{y:31,x:53,width:195,skin:"myres/underline.png",height:22},child:[{type:"Label",props:{y:-30,x:4,width:169,valign:"middle",text:"最近大和",scaleY:.9,scaleX:.9,height:46,fontSize:38,font:"fengyu",color:"#e8af71",align:"center"}}]},{type:"Sprite",props:{y:152,x:59,width:1623,scaleY:.65,scaleX:.65,pivotY:133,name:"container_hand",height:133},child:[{type:"Image",props:{y:0,x:0,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:80,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:160,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:240,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:320,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:400,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:480,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:560,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:640,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:720,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:800,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:880,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:960,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:1040,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:1120,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:1200,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:1280,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:1360,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:1440,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:1520,width:80,skin:"myres/8p.png",height:120}}]},{type:"Sprite",props:{y:32,x:827,width:650,scaleY:.4,scaleX:.4,pivotY:85,pivotX:430,name:"container_title",height:150},child:[{type:"Image",props:{width:160,name:"0",height:155}},{type:"Image",props:{y:0,x:160,width:160,name:"1",height:155}},{type:"Image",props:{y:0,x:320,width:160,name:"2",height:155}},{type:"Image",props:{y:0,x:480,width:160,name:"3",height:155}}]},{type:"Label",props:{y:65,x:77,width:293,valign:"middle",text:"暂无记录，请加油",name:"label_noinfo",height:81,fontSize:30,font:"SimHei",color:"#e8af71"}}]},{type:"Sprite",props:{y:150,x:0,width:950,name:"fengge",height:280},child:[{type:"Label",props:{y:86,x:64,width:38,valign:"middle",text:"攻",scaleY:.9,scaleX:.9,height:38,fontSize:34,font:"fengyu",color:"#ff637d",align:"center"}},{type:"Label",props:{y:92,x:117,width:39,valign:"middle",text:"99",scaleY:.75,scaleX:.75,name:"gong",height:34,fontSize:34,font:"haolong",color:"#d1f2f2",align:"center"}},{type:"Label",props:{y:128,x:64,width:38,valign:"middle",text:"防",scaleY:.9,scaleX:.9,height:38,fontSize:34,font:"fengyu",color:"#46d277",align:"center"}},{type:"Label",props:{y:133,x:117,width:39,valign:"middle",text:"99",scaleY:.75,scaleX:.75,name:"fang",height:34,fontSize:34,font:"haolong",color:"#d1f2f2",align:"center"}},{type:"Label",props:{y:172,x:64,width:38,valign:"middle",text:"速",scaleY:.9,scaleX:.9,height:38,fontSize:34,font:"fengyu",color:"#39b9be",align:"center"}},{type:"Label",props:{y:178,x:117,width:39,valign:"middle",text:"99",scaleY:.75,scaleX:.75,name:"su",height:34,fontSize:34,font:"haolong",color:"#d1f2f2",align:"center"}},{type:"Label",props:{y:214,x:64,width:38,valign:"middle",text:"运",scaleY:.9,scaleX:.9,height:38,fontSize:34,font:"fengyu",color:"#be7b39",align:"center"}},{type:"Label",props:{y:221,x:117,width:39,valign:"middle",text:"99",scaleY:.75,scaleX:.75,name:"yun",height:34,fontSize:34,font:"haolong",color:"#d1f2f2",align:"center"}},{type:"Image",props:{y:150,x:587,width:237,skin:"myres/radar.png",name:"radar",height:237,anchorY:.5,anchorX:.5,size:100},child:[{type:"Label",props:{y:-34,x:101,width:38,valign:"middle",text:"攻",scaleY:.9,scaleX:.9,name:"gong",height:38,fontSize:34,font:"fengyu",color:"#ff637d",align:"center"}},{type:"Label",props:{y:229,x:100,width:38,valign:"middle",text:"防",scaleY:.9,scaleX:.9,name:"fang",height:38,fontSize:34,font:"fengyu",color:"#46d277",align:"center"}},{type:"Label",props:{y:95,x:-32,width:38,valign:"middle",text:"速",scaleY:.9,scaleX:.9,name:"su",height:38,fontSize:34,font:"fengyu",color:"#39b9be",align:"center"}},{type:"Label",props:{y:98,x:232,width:38,valign:"middle",text:"运",scaleY:.9,scaleX:.9,name:"yun",height:38,fontSize:34,font:"fengyu",color:"#be7b39",align:"center"}},{type:"Sprite",props:{y:119,x:119,width:108,rotation:-90,pivotY:108,pivotX:0,name:"sanjiao0",height:108},child:[{type:"Image",props:{y:85,x:33,width:108,skin:"myres/line_orange.png",rotation:45,name:"wai",height:108,anchorY:0,anchorX:.5}},{type:"Image",props:{y:84,x:30,width:108,skin:"myres/radar_yellow.png",rotation:45,name:"nei",height:108,anchorY:0,anchorX:.5,size:100}},{type:"Image",props:{y:108.5,x:-.5,width:120,skin:"myres/line_orange.png",rotation:0,renderType:"mask",name:"mask",height:120,anchorY:1,anchorX:0}}]},{type:"Sprite",props:{y:119,x:119,width:108,rotation:-180,pivotY:108,pivotX:0,name:"sanjiao1",height:108},child:[{type:"Image",props:{y:85,x:33,width:108,skin:"myres/line_orange.png",rotation:45,name:"wai",height:108,anchorY:0,anchorX:.5}},{type:"Image",props:{y:84,x:30,width:108,skin:"myres/radar_yellow.png",rotation:45,name:"nei",height:108,anchorY:0,anchorX:.5,size:100}},{type:"Image",props:{y:108.5,x:-.5,width:120,skin:"myres/line_orange.png",rotation:0,renderType:"mask",name:"mask",height:120,anchorY:1,anchorX:0}}]},{type:"Sprite",props:{y:119,x:119,width:108,rotation:-270,pivotY:108,pivotX:0,name:"sanjiao2",height:108},child:[{type:"Image",props:{y:85,x:33,width:108,skin:"myres/line_orange.png",rotation:45,name:"wai",height:108,anchorY:0,anchorX:.5}},{type:"Image",props:{y:58,x:62,width:200,skin:"myres/radar_yellow.png",rotation:45,name:"nei",height:200,anchorY:0,anchorX:.5,size:100}},{type:"Image",props:{y:108.5,x:-.5,width:120,skin:"myres/line_orange.png",rotation:0,renderType:"mask",name:"mask",height:120,anchorY:1,anchorX:0}}]},{type:"Sprite",props:{y:119,x:119,width:108,pivotY:108,pivotX:0,name:"sanjiao3",height:108},child:[{type:"Image",props:{y:104,x:34,width:108,skin:"myres/line_orange.png",rotation:18,name:"wai",height:108,anchorY:0,anchorX:.5}},{type:"Image",props:{y:84,x:30,width:108,skin:"myres/radar_yellow.png",rotation:45,name:"nei",height:108,anchorY:0,anchorX:.5,size:100}},{type:"Image",props:{y:108.5,x:-.5,width:120,skin:"myres/line_orange.png",rotation:0,renderType:"mask",name:"mask",height:120,anchorY:1,anchorX:0}}]}]},{type:"Image",props:{y:56,x:53,width:195,skin:"myres/underline.png",height:22},child:[{type:"Label",props:{y:-30,x:4,width:159,valign:"middle",text:"风格属性",scaleY:.9,scaleX:.9,height:38,fontSize:38,font:"fengyu",color:"#e8af71",align:"center"}}]},{type:"Button",props:{y:45,x:246,width:70,name:"what",height:70,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:15,x:15,skin:"myres/bothui/what.png",scaleY:1.2,scaleX:1.2,name:"what"}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]},{type:"Sprite",props:{y:430,x:0,width:950,name:"zoushi",height:270},child:[{type:"Image",props:{y:76,x:130,width:760,skin:"myres/line_blue.png",name:"line1",height:3}},{type:"Image",props:{y:119,x:130,width:760,skin:"myres/line_blue.png",name:"line2",height:3}},{type:"Image",props:{y:163,x:130,width:760,skin:"myres/line_blue.png",name:"line3",height:3}},{type:"Image",props:{y:206,x:130,width:760,skin:"myres/line_blue.png",name:"line4",height:3}},{type:"Sprite",props:{y:-783,x:-890,name:"lines"},child:[{type:"Image",props:{y:965,x:1274,width:159,skin:"myres/line_orange.png",rotation:57,height:5,anchorY:.5}},{type:"Image",props:{y:975,x:1284,width:159,skin:"myres/line_orange.png",rotation:0,height:5,anchorY:.5}},{type:"Image",props:{y:985,x:1294,width:159,skin:"myres/line_orange.png",rotation:0,height:5,anchorY:.5}},{type:"Image",props:{y:995,x:1304,width:159,skin:"myres/line_orange.png",rotation:0,height:5,anchorY:.5}},{type:"Image",props:{y:1005,x:1314,width:159,skin:"myres/line_orange.png",rotation:0,height:5,anchorY:.5}},{type:"Image",props:{y:1015,x:1324,width:159,skin:"myres/line_orange.png",rotation:0,height:5,anchorY:.5}},{type:"Image",props:{y:1025,x:1334,width:159,skin:"myres/line_orange.png",rotation:0,height:5,anchorY:.5}},{type:"Image",props:{y:1035,x:1344,width:159,skin:"myres/line_orange.png",rotation:0,height:5,anchorY:.5}},{type:"Image",props:{y:1045,x:1354,width:159,skin:"myres/line_orange.png",rotation:0,height:5,anchorY:.5}},{type:"Image",props:{y:1055,x:1364,width:159,skin:"myres/line_orange.png",rotation:0,height:5,anchorY:.5}},{type:"Image",props:{y:1065,x:1374,width:159,skin:"myres/line_orange.png",rotation:0,height:5,anchorY:.5}}]},{type:"Sprite",props:{y:-783,x:-890,name:"points"},child:[{type:"Image",props:{y:991,x:1744,skin:"myres/point.png",anchorY:.5,anchorX:.5}},{type:"Image",props:{y:870,x:1323,skin:"myres/point.png",anchorY:.5,anchorX:.5}},{type:"Image",props:{y:880,x:1323,skin:"myres/point.png",anchorY:.5,anchorX:.5}},{type:"Image",props:{y:890,x:1323,skin:"myres/point.png",anchorY:.5,anchorX:.5}},{type:"Image",props:{y:900,x:1323,skin:"myres/point.png",anchorY:.5,anchorX:.5}},{type:"Image",props:{y:910,x:1323,skin:"myres/point.png",anchorY:.5,anchorX:.5}},{type:"Image",props:{y:920,x:1323,skin:"myres/point.png",anchorY:.5,anchorX:.5}},{type:"Image",props:{y:930,x:1323,skin:"myres/point.png",anchorY:.5,anchorX:.5}},{type:"Image",props:{y:940,x:1323,skin:"myres/point.png",anchorY:.5,anchorX:.5}},{type:"Image",props:{y:950,x:1323,skin:"myres/point.png",anchorY:.5,anchorX:.5}},{type:"Image",props:{y:960,x:1323,skin:"myres/point.png",anchorY:.5,anchorX:.5}},{type:"Image",props:{y:970,x:1323,skin:"myres/point.png",anchorY:.5,anchorX:.5}}]},{type:"Label",props:{y:182,x:65,width:26,valign:"middle",text:"4",scaleY:.75,scaleX:.75,height:37,fontSize:35,font:"haolong",color:"#d1f2f2",align:"center"},child:[{type:"Label",props:{y:0,x:34,width:26,valign:"middle",text:"位",height:37,fontSize:34,font:"fengyu",color:"#d1f2f2",align:"center"}}]},{type:"Label",props:{y:140,x:65,width:26,valign:"middle",text:"3",scaleY:.75,scaleX:.75,height:37,fontSize:35,font:"haolong",color:"#d1f2f2",align:"center"},child:[{type:"Label",props:{y:0,x:34,width:26,valign:"middle",text:"位",height:37,fontSize:34,font:"fengyu",color:"#d1f2f2",align:"center"}}]},{type:"Label",props:{y:94,x:65,width:26,valign:"middle",text:"2",scaleY:.75,scaleX:.75,height:37,fontSize:35,font:"haolong",color:"#d1f2f2",align:"center"},child:[{type:"Label",props:{y:0,x:34,width:26,valign:"middle",text:"位",height:37,fontSize:34,font:"fengyu",color:"#d1f2f2",align:"center"}}]},{type:"Label",props:{y:54,x:62,width:26,valign:"middle",text:"1",scaleY:.75,scaleX:.75,height:37,fontSize:35,font:"haolong",color:"#d1f2f2",align:"center"},child:[{type:"Label",props:{y:0,x:34,width:26,valign:"middle",text:"位",height:37,fontSize:34,font:"fengyu",color:"#d1f2f2",align:"center"}}]},{type:"Image",props:{y:28,x:53,width:195,skin:"myres/underline.png",height:22},child:[{type:"Label",props:{y:-30,x:4,width:159,valign:"middle",text:"最近走势",scaleY:.9,scaleX:.9,height:38,fontSize:38,font:"fengyu",color:"#e8af71",align:"center"}}]}]},{type:"Sprite",props:{y:700,x:0,width:950,name:"tabs",height:87},child:[{type:"Image",props:{y:59,x:46,width:899,skin:"myres/bothui/bg.png",name:"bg",height:1121,sizeGrid:"18,18,17,17"}},{type:"Button",props:{y:-3,x:54,width:202,stateNum:1,skin:"myres/bothui/pi_choosed.png",name:"btn_pipei",height:72},child:[{type:"Label",props:{y:11,x:29,width:145,text:"匹配场",height:50,fontSize:40,font:"fengyu",color:"#e8af71",align:"center"}}]},{type:"Button",props:{y:-3,x:256,width:202,stateNum:1,skin:"myres/bothui/pi_unchosen.png",name:"btn_friend",height:72},child:[{type:"Label",props:{y:11,x:29,width:145,text:"友人房",height:50,fontSize:40,font:"fengyu",color:"#e8af71",align:"center"}}]}]},{type:"Sprite",props:{y:787,x:15,width:950,name:"mode0",height:77},child:[{type:"Button",props:{y:0,x:25,width:900,name:"btn",height:77},child:[{type:"Image",props:{y:10,x:26,width:854,skin:"myres/bar.png",height:57}},{type:"Image",props:{y:37,x:838,width:46,skin:"myres/arrow.png",name:"arrow",height:19,anchorY:.2,anchorX:.5}},{type:"Label",props:{y:13,x:45,width:323,valign:"middle",text:"一场胜负",scaleY:.9,scaleX:.9,name:"mode",height:57,fontSize:38,font:"fengyu",color:"#e8af71",align:"left"}}]},{type:"Sprite",props:{y:77,x:25,width:900,name:"detail",height:233},child:[{type:"Label",props:{y:11,x:44,text:"一位率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:11,x:170,width:110,text:"99.99%",scaleY:1,scaleX:1,name:"pos1",height:33,fontSize:33,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:54,x:44,text:"二位率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:54,x:170,width:110,text:"99.99%",scaleY:1,scaleX:1,name:"pos2",height:33,fontSize:33,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:97,x:44,text:"三位率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:97,x:170,width:110,text:"99.99%",scaleY:1,scaleX:1,name:"pos3",height:33,fontSize:33,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:140,x:44,text:"四位率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:140,x:170,width:110,text:"99.99%",scaleY:1,scaleX:1,name:"pos4",height:33,fontSize:33,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:183,x:44,text:"被飞率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:183,x:170,width:110,text:"99.99%",scaleY:1,scaleX:1,name:"knockout",height:35,fontSize:33,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:11,x:340,text:"总对局数",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:11,x:484,width:110,text:"99999",scaleY:.8,scaleX:.8,name:"changci",height:40,fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:54,x:340,text:"平均打点",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:54,x:484,width:110,text:"99999",scaleY:.8,scaleX:.8,name:"dadian",fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:97,x:340,text:"平均顺位",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:97,x:484,width:110,text:"99999",scaleY:.8,scaleX:.8,name:"shunwei",fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:140,x:340,text:"最大连庄",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:140,x:484,width:110,text:"99999",scaleY:.8,scaleX:.8,name:"lianzhuang",fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:183,x:340,text:"和了巡数",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:183,x:484,width:110,text:"99999",scaleY:.8,scaleX:.8,name:"hule",fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:11,x:635,text:"和牌率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:11,x:755,width:145,text:"99.99%",scaleY:.8,scaleX:.8,name:"hupai",height:33,fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:54,x:635,text:"自摸率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:54,x:755,width:145,text:"99.99%",scaleY:.8,scaleX:.8,name:"zimo",height:33,fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:97,x:635,text:"放铳率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:97,x:755,width:145,text:"99.99%",scaleY:.8,scaleX:.8,name:"fangchong",height:33,fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:140,x:635,text:"副露率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:140,x:755,width:145,text:"99.99%",scaleY:.8,scaleX:.8,name:"fulu",height:33,fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:183,x:635,text:"立直率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:183,x:755,width:145,text:"99.99%",scaleY:.8,scaleX:.8,name:"liqi",height:33,fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}}]}]},{type:"Sprite",props:{y:1097,x:15,width:950,name:"mode1",height:77},child:[{type:"Button",props:{y:0,x:25,width:900,name:"btn",height:77},child:[{type:"Image",props:{y:10,x:26,width:854,skin:"myres/bar.png",height:57}},{type:"Image",props:{y:37,x:838,width:46,skin:"myres/arrow.png",name:"arrow",height:19,anchorY:.2,anchorX:.5}},{type:"Label",props:{y:12,x:45,width:306,valign:"middle",text:"四人东风",scaleY:.9,scaleX:.9,name:"mode",height:59,fontSize:38,font:"fengyu",color:"#e8af71",align:"left"}}]},{type:"Sprite",props:{y:77,x:25,width:900,name:"detail",height:233},child:[{type:"Label",props:{y:11,x:44,text:"一位率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:11,x:170,width:110,text:"99.99%",scaleY:1,scaleX:1,name:"pos1",height:33,fontSize:33,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:54,x:44,text:"二位率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:54,x:170,width:110,text:"99.99%",scaleY:1,scaleX:1,name:"pos2",height:33,fontSize:33,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:97,x:44,text:"三位率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:97,x:170,width:110,text:"99.99%",scaleY:1,scaleX:1,name:"pos3",height:33,fontSize:33,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:140,x:44,text:"四位率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:140,x:170,width:110,text:"99.99%",scaleY:1,scaleX:1,name:"pos4",height:33,fontSize:33,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:183,x:44,text:"被飞率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:183,x:170,width:110,text:"99.99%",scaleY:1,scaleX:1,name:"knockout",height:35,fontSize:33,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:11,x:340,text:"总对局数",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:11,x:484,width:110,text:"99999",scaleY:.8,scaleX:.8,name:"changci",height:40,fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:54,x:340,text:"平均打点",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:54,x:484,width:110,text:"99999",scaleY:.8,scaleX:.8,name:"dadian",fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:97,x:340,text:"平均顺位",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:97,x:484,width:110,text:"99999",scaleY:.8,scaleX:.8,name:"shunwei",fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:140,x:340,text:"最大连庄",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:140,x:484,width:110,text:"99999",scaleY:.8,scaleX:.8,name:"lianzhuang",fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:183,x:340,text:"和了巡数",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:183,x:484,width:110,text:"99999",scaleY:.8,scaleX:.8,name:"hule",fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:11,x:635,text:"和牌率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:11,x:755,width:145,text:"99.99%",scaleY:.8,scaleX:.8,name:"hupai",height:33,fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:54,x:635,text:"自摸率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:54,x:755,width:145,text:"99.99%",scaleY:.8,scaleX:.8,name:"zimo",height:33,fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:97,x:635,text:"放铳率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:97,x:755,width:145,text:"99.99%",scaleY:.8,scaleX:.8,name:"fangchong",height:33,fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:140,x:635,text:"副露率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:140,x:755,width:145,text:"99.99%",scaleY:.8,scaleX:.8,name:"fulu",height:33,fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:183,x:635,text:"立直率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:183,x:755,width:145,text:"99.99%",scaleY:.8,scaleX:.8,name:"liqi",height:33,fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}}]}]},{type:"Sprite",props:{y:1407,x:15,width:950,name:"mode2",height:77},child:[{type:"Button",props:{y:0,x:25,width:900,name:"btn",height:77},child:[{type:"Image",props:{y:10,x:26,width:854,skin:"myres/bar.png",height:57}},{type:"Image",props:{y:37,x:838,width:46,skin:"myres/arrow.png",name:"arrow",height:19,anchorY:.2,anchorX:.5}},{type:"Label",props:{y:14,x:45,width:350,valign:"middle",text:"四人南风",scaleY:.9,scaleX:.9,name:"mode",height:56,fontSize:38,font:"fengyu",color:"#e8af71",align:"left"}}]},{type:"Sprite",props:{y:77,x:25,width:900,name:"detail",height:233},child:[{type:"Label",props:{y:11,x:44,text:"一位率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:11,x:170,width:110,text:"99.99%",scaleY:1,scaleX:1,name:"pos1",height:33,fontSize:33,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:54,x:44,text:"二位率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:54,x:170,width:110,text:"99.99%",scaleY:1,scaleX:1,name:"pos2",height:33,fontSize:33,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:97,x:44,text:"三位率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:97,x:170,width:110,text:"99.99%",scaleY:1,scaleX:1,name:"pos3",height:33,fontSize:33,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:140,x:44,text:"四位率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:140,x:170,width:110,text:"99.99%",scaleY:1,scaleX:1,name:"pos4",height:33,fontSize:33,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:183,x:44,text:"被飞率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:183,x:170,width:110,text:"99.99%",scaleY:1,scaleX:1,name:"knockout",height:35,fontSize:33,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:11,x:340,text:"总对局数",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:11,x:484,width:110,text:"99999",scaleY:.8,scaleX:.8,name:"changci",height:40,fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:54,x:340,text:"平均打点",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:54,x:484,width:110,text:"99999",scaleY:.8,scaleX:.8,name:"dadian",fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:97,x:340,text:"平均顺位",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:97,x:484,width:110,text:"99999",scaleY:.8,scaleX:.8,name:"shunwei",fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:140,x:340,text:"最大连庄",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:140,x:484,width:110,text:"99999",scaleY:.8,scaleX:.8,name:"lianzhuang",fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:183,x:340,text:"和了巡数",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:183,x:484,width:110,text:"99999",scaleY:.8,scaleX:.8,name:"hule",fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:11,x:635,text:"和牌率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:11,x:755,width:145,text:"99.99%",scaleY:.8,scaleX:.8,name:"hupai",height:33,fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:54,x:635,text:"自摸率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:54,x:755,width:145,text:"99.99%",scaleY:.8,scaleX:.8,name:"zimo",height:33,fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:97,x:635,text:"放铳率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:97,x:755,width:145,text:"99.99%",scaleY:.8,scaleX:.8,name:"fangchong",height:33,fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:140,x:635,text:"副露率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:140,x:755,width:145,text:"99.99%",scaleY:.8,scaleX:.8,name:"fulu",height:33,fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}},{type:"Label",props:{y:183,x:635,text:"立直率",scaleY:.8,scaleX:.8,fontSize:33,font:"youyuan_bold",color:"#eee1e1"}},{type:"Label",props:{y:183,x:755,width:145,text:"99.99%",scaleY:.8,scaleX:.8,name:"liqi",height:33,fontSize:40,font:"SimHei",color:"#ffc751",align:"right"}}]}]},{type:"Sprite",props:{y:1717,x:15,width:950,name:"fan",height:77},child:[{type:"Button",props:{y:0,x:25,width:900,name:"btn",height:77},child:[{type:"Image",props:{y:10,x:26,width:854,skin:"myres/bar.png",height:57}},{type:"Image",props:{y:37,x:838,width:46,skin:"myres/arrow.png",name:"arrow",height:19,anchorY:.2,anchorX:.5}},{type:"Label",props:{y:12,x:45,width:249,valign:"middle",text:"番数达成次数",scaleY:.9,scaleX:.9,name:"mode",height:58,fontSize:38,font:"fengyu",color:"#e8af71",align:"center"}}]},{type:"Sprite",props:{y:77,x:25,width:900,name:"detail",height:233},child:[{type:"Sprite",props:{y:3,x:-25,width:950,name:"templete",height:50},child:[{type:"Label",props:{y:14,x:87,text:"国士无双十三面",scaleY:.8,scaleX:.8,name:"fan",fontSize:33,font:"youyuan",color:"#eee1e1"}},{type:"Label",props:{y:16,x:717,width:169,text:"0",scaleY:.8,scaleX:.8,name:"count",height:33,fontSize:33,font:"youyuan",color:"#ffc751",bold:!0,align:"right"}},{type:"Label",props:{y:16,x:352,width:486,text:"—————————————",scaleY:.8,scaleX:.8,height:33,fontSize:33,font:"youyuan",color:"#ffc751",align:"center"}},{type:"Script",props:{runtime:"capsui.UICopy"}}]}]}]},{type:"Sprite",props:{y:1727,x:15,width:950,name:"blank",height:300}}]},{type:"Sprite",props:{y:0,x:930,width:50,name:"scrollbar",mouseThrough:!1,mouseEnabled:!0,height:658},child:[{type:"Image",props:{y:0,x:25,skin:"myres/scrollbar.png",name:"scrollbar",height:658,anchorX:.5,alpha:.5}},{type:"Image",props:{y:96,x:25,width:45,skin:"myres/scrollpoint.png",name:"scrollpoint",height:45,anchorY:.5,anchorX:.5}}]}]},{type:"Button",props:{y:22,x:593,width:321,name:"btn_rank",height:153}}]},{type:"Button",props:{y:41,x:1026,width:100,name:"btn_close",height:100,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:8,x:10,width:80,skin:"myres/btn_close.png",height:80}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]},{type:"Sprite",props:{width:1920,name:"container_sign_input",height:1080},child:[{type:"Button",props:{y:0,x:0,width:1920,name:"btn_confirm",height:1080}},{type:"Image",props:{y:193,x:1064,width:749,skin:"myres/inputbox.png",mouseThrough:!1,mouseEnabled:!0,height:103,sizeGrid:"7,12,10,9"}},{type:"TextInput",props:{y:197,x:1069,wordWrap:!0,width:734,valign:"middle",text:"签名签名签名签名签名签名签名签名签名签名签名签名签名签名签名签名签名签名签名签名",padding:"15,15,15,15",name:"input",multiline:!0,maxChars:80,height:95,fontSize:30,font:"SimHei",color:"#5c678b"}}]}]},i}(View);t.playerinfoUI=i}(e.lobby||(e.lobby={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.CButton",capsui.CButton),t.prototype.createChildren.call(this),this.createView(e.lobby.popnoticeUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Sprite",props:{y:515,x:955,width:500,pivotY:250,pivotX:250,name:"root",height:500},child:[{type:"Image",props:{y:250,x:250,width:811,skin:"myres/pop_bg.png",name:"bg0",height:584,anchorY:.5,anchorX:.5,sizeGrid:"100,100,100,100"},child:[{type:"Image",props:{y:33,x:43,width:89,skin:"myres/entrance/pop_texturecut.png",height:515}},{type:"Image",props:{y:32,x:773,width:107,skin:"myres/entrance/pop_texturecut.png",scaleX:-1,height:514}},{type:"Image",props:{y:139,x:45,width:730,skin:"myres/entrance/pop_black.png",name:"bar",height:382}},{type:"Image",props:{y:55,x:43,width:731,skin:"myres/entrance/pop_black.png",name:"bar",height:74}}]},{type:"Image",props:{y:250,x:250,width:811,skin:"myres/pop_bound.png",name:"bound",height:584,anchorY:.5,anchorX:.5,sizeGrid:"131,102,97,106"}},{type:"Button",props:{y:453,x:258,width:153,stateNum:1,skin:"myres/necessary/btn_small.png",name:"btn",height:65,anchorY:.5,anchorX:.5,sizeGrid:"15,20,15,20"},child:[{type:"Label",props:{y:2,x:12,width:132,valign:"middle",text:"确定",height:54,fontSize:38,font:"fengyu",color:"#e8af71",align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Label",props:{y:25,x:55,width:392,valign:"middle",text:"测试还没结束哟！",name:"title",height:54,fontSize:38,font:"SimHei",color:"#e8af71",align:"center"}},{type:"Sprite",props:{y:127,x:-51,width:629,name:"content",height:284},child:[{type:"Label",props:{y:-40,x:15,wordWrap:!0,width:600,valign:"middle",text:"感受到大家希望继续体验游戏的期望",name:"text",height:78,fontSize:28,font:"SimHei",color:"#c9c9c9",align:"left"}},{type:"Label",props:{y:-4,x:15,wordWrap:!0,width:600,valign:"middle",text:"原计划于6月14日11:00结束的删档测试",name:"text",height:78,fontSize:28,font:"SimHei",color:"#c9c9c9",align:"left"}},{type:"Label",props:{y:35,x:15,wordWrap:!0,width:600,valign:"middle",text:"将会继续开启友人场供大家玩耍",name:"text",height:78,fontSize:28,font:"SimHei",color:"#c9c9c9",align:"left"}},{type:"Label",props:{y:73,x:15,wordWrap:!0,width:600,valign:"middle",text:"同时还会在匹配中开启不计PT的“乱斗之间”",name:"text",height:78,fontSize:28,font:"SimHei",color:"#c9c9c9",align:"left"}},{type:"Label",props:{y:110,x:15,wordWrap:!0,width:600,valign:"middle",text:"以便于大家随机组局游戏",name:"text",height:78,fontSize:28,font:"SimHei",color:"#c9c9c9",align:"left"}},{type:"Label",props:{y:149,x:15,wordWrap:!0,width:600,valign:"middle",text:"微博关注“雀魂麻将Majsoul”了解更新动态",name:"text",height:78,fontSize:28,font:"SimHei",color:"#c9c9c9",align:"left"}},{type:"Label",props:{y:186,x:15,wordWrap:!0,width:600,valign:"middle",text:"也欢迎加入QQ群794316484参与讨论",name:"text",height:78,fontSize:28,font:"SimHei",color:"#c9c9c9",align:"left"}},{type:"Label",props:{y:223,x:15,wordWrap:!0,width:600,valign:"middle",text:"也欢迎加入QQ群794316484参与讨论",name:"text",height:78,fontSize:28,font:"SimHei",color:"#c9c9c9",align:"left"}}]}]}]},i}(View);t.popnoticeUI=i}(e.lobby||(e.lobby={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.UICopy",capsui.UICopy),View.regComponent("capsui.NoLimitList",capsui.NoLimitList),View.regComponent("capsui.CLoading",capsui.CLoading),View.regComponent("capsui.CButton",capsui.CButton),t.prototype.createChildren.call(this),this.createView(e.lobby.rankUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Sprite",props:{y:468,x:961,width:729,pivotY:250,pivotX:250,name:"root",height:737},child:[{type:"Sprite",props:{y:-129,x:-212,width:1003,name:"bg",height:1038},child:[{type:"Image",props:{y:460,x:457,width:1460,skin:"myres/pop_bg.png",name:"bg0",height:987,anchorY:.5,anchorX:.5,sizeGrid:"100,100,100,100"},child:[{type:"Image",props:{y:25,x:33,width:144,skin:"myres/pop_texturecut.png",name:"left",height:937,sizeGrid:"0,0,24,26"}},{type:"Image",props:{y:38,x:32,width:1398,skin:"myres/pop_black.png",name:"bar",height:65}},{type:"Image",props:{y:123,x:32,width:1400,skin:"myres/pop_black.png",name:"bar",height:800}},{type:"Image",props:{y:25,x:1433,width:144,skin:"myres/pop_texturecut.png",scaleX:-1,name:"left",height:937,sizeGrid:"0,0,24,26"}}]},{type:"Image",props:{y:460,x:457,width:1460,skin:"myres/pop_bound.png",name:"bound",height:987,anchorY:.5,anchorX:.5,sizeGrid:"131,102,97,106"}}]},{type:"Label",props:{y:-136,x:160,width:165,valign:"middle",text:"排行榜",name:"title",height:76,fontSize:45,font:"fengyu",color:"#e8af71",align:"center"}},{type:"Sprite",props:{y:-55,x:-206,width:913,name:"content",height:781},child:[{type:"Panel",props:{y:29,x:-244,width:1391,name:"content",height:626},child:[{type:"Image",props:{y:5,x:5,width:1400,skin:"myres/lobby/bg_rank.png",name:"templete",height:136},child:[{type:"Image",props:{y:25,x:44,width:91,skin:"myres/lobby/rank_1.png",name:"rank_img",height:85}},{type:"Image",props:{y:28,x:585,width:403,name:"title",height:78}},{type:"Label",props:{y:49,x:306,width:252,text:"蹦蹦跳跳的仙太郎",name:"name",height:39,fontSize:32,font:"SimHei",color:"#fbfbfb",align:"left"}},{type:"Label",props:{y:46,x:1161,width:149,text:"9999",scaleY:.8,scaleX:.8,name:"rankscore",height:44,fontSize:44,font:"haolong",color:"#6ec0bd",align:"right"}},{type:"Label",props:{y:54,x:1283,width:65,text:"pt",height:29,fontSize:50,font:"hanyi",color:"#65aadd"}},{type:"Image",props:{y:-4,x:166,skin:"myres/bg_head1.png",scaleY:.65,scaleX:.65,name:"head"},child:[{type:"Image",props:{y:35,x:23,width:154,skin:"extendRes/charactor/yiji/smallhead.png",height:154}}]},{type:"Label",props:{y:44,x:47,width:72,text:"5",scaleY:1.2,scaleX:1.2,name:"rankno",height:57,fontSize:60,font:"hanyi",color:"#adadad",align:"center"}},{type:"Image",props:{y:55,x:1120.75,width:255,scaleY:.55,scaleX:.55,pivotY:114,pivotX:145,name:"rank",height:253},child:[{type:"Image",props:{y:0,x:0,skin:"myres/rank_bg.png",name:"bg"}},{type:"Image",props:{y:15,x:0,skin:"extendRes/level/queshi.png",name:"icon"}},{type:"Image",props:{y:191,x:58,skin:"myres/starbg.png",scaleY:1,scaleX:1,name:"star2",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]},{type:"Image",props:{y:142,x:29,skin:"myres/starbg.png",scaleY:.7,scaleX:.7,name:"star3",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]},{type:"Image",props:{y:214,x:110,skin:"myres/starbg.png",scaleY:.7,scaleX:.7,name:"star1",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]}]},{type:"Button",props:{y:23,x:76,width:1390,pivotY:25,pivotX:53,name:"btn_see",height:135}},{type:"Script",props:{y:-8,x:-5,runtime:"capsui.UICopy"}}]}]},{type:"Script",props:{runtime:"capsui.NoLimitList"}},{type:"Sprite",props:{y:270,x:424,width:127,name:"loading",mouseThrough:!0,height:133},child:[{type:"Image",props:{y:67,x:26,skin:"myres/necessary/flower_nei.png",scaleY:1.2,scaleX:1.2,rotation:0,name:"flower",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:0,x:0,skin:"myres/necessary/flower_shine.png",name:"shine",alpha:1}},{type:"Image",props:{y:56,x:56,skin:"myres/necessary/round.png",name:"round",anchorY:.5,anchorX:.5}},{type:"Image",props:{y:142,x:0,skin:"myres/necessary/word.png"}}]},{type:"Script",props:{runtime:"capsui.CLoading"}}]},{type:"Sprite",props:{y:44,x:1094,width:50,name:"scrollbar",mouseThrough:!1,mouseEnabled:!0,height:599},child:[{type:"Image",props:{y:0,x:25,skin:"myres/sushe/ss_slidebar.png",name:"scrollbar",height:596,anchorX:.5,alpha:.3}},{type:"Image",props:{y:96,x:25,width:33,skin:"myres/sushe/ss_slidebtn.png",name:"scrollpoint",height:33,anchorY:.5,anchorX:.5,alpha:.7}}]}]},{type:"Button",props:{y:-128,x:939,width:100,name:"btn_close",height:100,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Image",props:{y:10,x:10,width:80,skin:"myres/btn_close.png",height:80}}]},{type:"Sprite",props:{y:602,x:-483,width:1459,name:"self",height:156},child:[{type:"Image",props:{y:-14,x:32,width:1400,skin:"myres/lobby/myrank.png",name:"bg",height:168,sizeGrid:"22,0,13,0"}},{type:"Sprite",props:{y:-10,x:2,width:1457,name:"self",height:172},child:[{type:"Image",props:{y:45,x:74,width:91,skin:"myres/lobby/rank_1.png",name:"rank_img",height:85}},{type:"Image",props:{y:41,x:614,width:403,name:"title",height:78}},{type:"Label",props:{y:69,x:338,width:265,text:"蹦蹦跳跳的仙太郎",name:"name",height:39,fontSize:32,font:"SimHei",color:"#fbfbfb",align:"left"}},{type:"Image",props:{y:9,x:197,skin:"myres/bg_head1.png",scaleY:.65,scaleX:.65,name:"head"},child:[{type:"Image",props:{y:35,x:23,width:154,skin:"extendRes/charactor/yiji/smallhead.png",height:154}}]},{type:"Image",props:{y:76,x:1152.75,width:255,scaleY:.55,scaleX:.55,pivotY:114,pivotX:145,name:"rank",height:253},child:[{type:"Image",props:{y:0,x:0,skin:"myres/rank_bg.png",name:"bg"}},{type:"Image",props:{y:15,x:0,skin:"extendRes/level/queshi.png",name:"icon"}},{type:"Image",props:{y:191,x:58,skin:"myres/starbg.png",scaleY:1,scaleX:1,name:"star2",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]},{type:"Image",props:{y:142,x:29,skin:"myres/starbg.png",scaleY:.7,scaleX:.7,name:"star3",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]},{type:"Image",props:{y:214,x:110,skin:"myres/starbg.png",scaleY:.7,scaleX:.7,name:"star1",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]}]},{type:"Button",props:{y:31,x:52,width:1456,pivotY:25,pivotX:53,name:"btn_see",height:152}},{type:"Label",props:{y:62,x:56,width:108,text:"5",scaleY:1.2,scaleX:1.2,name:"rankno",height:47,fontSize:60,font:"hanyi",color:"#adadad",align:"center"}},{type:"Label",props:{y:59,x:1221,width:117,text:"9999",scaleY:.8,scaleX:.8,name:"rankscore",height:44,fontSize:44,font:"haolong",color:"#6ec0bd",align:"right"}},{type:"Label",props:{y:67,x:1320,width:65,text:"pt",height:29,fontSize:50,font:"hanyi",color:"#65aadd"}}]}]}]}]},i}(View);t.rankUI=i}(e.lobby||(e.lobby={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.CButton",capsui.CButton),View.regComponent("capsui.UICopy",capsui.UICopy),View.regComponent("capsui.CScrollView",capsui.CScrollView),View.regComponent("capsui.CLoading",capsui.CLoading),t.prototype.createChildren.call(this),this.createView(e.lobby.rechargeUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Image",props:{skin:"设计稿/【扫码】.jpg"}},{type:"Image",props:{y:48,x:119,width:401,skin:"myres/img_return1_bg.png",name:"top",height:81},child:[{type:"Label",props:{y:3,x:105,width:95,text:"商家",scaleY:1.4,scaleX:1.4,height:45,font:"fengyu",color:"#e4ba86",align:"center"}},{type:"Button",props:{y:33,x:-67,width:182,pivotY:67,pivotX:49,name:"btn_back",height:142},child:[{type:"Image",props:{y:6,x:7,width:135,skin:"myres/img_return1.png",height:134}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:49.5,x:1218,width:294,name:"container_gold0",height:89,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Image",props:{y:3,x:38,width:253,skin:"myres/lobby/bg_0.png",name:"bg",height:88}},{type:"Image",props:{y:8,x:10,width:70,skin:"myres/gold0.png",scaleY:1,scaleX:1,name:"icon",height:70}},{type:"Label",props:{y:25,x:77,width:125,valign:"middle",text:"9.024亿",name:"label_gold",height:39,fontSize:35,font:"SimHei",color:"#ffffff",align:"right"}}]},{type:"Button",props:{y:49.5,x:1509,width:294,name:"container_gold1",height:89,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Image",props:{y:3,x:38,width:253,skin:"myres/lobby/bg_0.png",name:"bg",height:88}},{type:"Image",props:{y:8,x:10,width:70,skin:"myres/gold1.png",scaleY:1,scaleX:1,name:"icon",height:70}},{type:"Label",props:{y:25,x:77,width:125,valign:"middle",text:"1000",name:"label_gold",height:39,fontSize:35,font:"SimHei",color:"#ffffff",align:"right"}}]}]},{type:"Image",props:{y:154,x:362,width:1461,skin:"myres/shop/bg_container.png",name:"content",height:857,sizeGrid:"58,59,63,59"},child:[{type:"Sprite",props:{y:-1,x:-291,width:338,name:"tabs",height:816},child:[{type:"Button",props:{y:118,x:178,width:336,stateNum:1,skin:"myres/shop/tab_unchoose.png",height:141,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:24,x:24,width:184,valign:"middle",text:"杂货屋",scaleY:1.5,scaleX:1.5,name:"label_name",height:66,fontSize:60,font:"fengyu",color:"#ebb661",align:"center"}}]},{type:"Button",props:{y:244,x:178,width:336,stateNum:1,skin:"myres/shop/tab_unchoose.png",height:141,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:24,x:24,width:184,valign:"middle",text:"祈愿屋",scaleY:1.5,scaleX:1.5,name:"label_name",height:66,fontSize:60,font:"fengyu",color:"#ebb661",align:"center"}}]},{type:"Button",props:{y:369,x:178,width:336,stateNum:1,skin:"myres/shop/tab_unchoose.png",height:141,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:24,x:24,width:184,valign:"middle",text:"星之屋",scaleY:1.5,scaleX:1.5,name:"label_name",height:66,fontSize:60,font:"fengyu",color:"#ebb661",align:"center"}}]}]},{type:"Sprite",props:{y:0,x:0,width:1463,name:"right",height:863},child:[{type:"Panel",props:{y:45,x:102,width:1280,name:"content",height:761},child:[{type:"Sprite",props:{y:0,x:0,width:320,name:"templete",height:409},child:[{type:"Button",props:{y:186,x:147,width:256,pivotY:165,pivotX:127,name:"btn",height:363,gray:!1},child:[{type:"Image",props:{y:-4,x:-7,width:269,skin:"myres/shop/item_bg.png",name:"bbg",height:370}},{type:"Image",props:{y:160,x:128,width:163,skin:"myres/kuangbg.png",name:"bg",height:163,anchorY:.5,anchorX:.5,sizeGrid:"7,7,8,7"}},{type:"Image",props:{y:160,x:128,width:163,name:"icon",height:163,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:160,x:128,width:169,skin:"myres/kuangbound.png",name:"bound",height:169,anchorY:.5,anchorX:.5,sizeGrid:"18,20,12,12"}},{type:"Label",props:{y:9,x:-2,width:324,text:"二阶堂美树",scaleY:.8,scaleX:.8,name:"label_name",height:49,fontSize:40,font:"fengyu",color:"#e4b886",align:"center"}},{type:"Image",props:{y:286,x:14,width:228,skin:"myres/shop/btn_buy.png",name:"btn_buy",height:65},child:[{type:"Image",props:{y:33,x:28,width:47,skin:"myres/gold0.png",scaleY:.95,scaleX:.95,name:"currency",height:48,anchorY:.5,anchorX:0}},{type:"Label",props:{y:33,x:74,width:129,valign:"middle",text:"999999",name:"label_gold",height:39,fontSize:42,font:"SimHei",color:"#3a2138",anchorY:.5,align:"left"}}]},{type:"Label",props:{y:245,x:42,width:216,text:"9999",scaleY:.8,scaleX:.8,name:"count",height:40,fontSize:42,font:"SimHei",color:"#bac6cc",align:"center"}},{type:"Image",props:{y:91,x:1,width:257,skin:"myres/shop/buyed.png",name:"buyed",height:156}},{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Image",props:{y:1,x:-1,skin:"myres/lobby/recharge_first.png",name:"shouchong"},child:[{type:"Label",props:{y:252,x:2,width:318,text:"首次购买奖励120000个",scaleY:.8,scaleX:.8,name:"desc_shouchong",height:40,fontSize:30,font:"SimHei",color:"#f56aff",align:"center"}}]}]},{type:"Script",props:{y:-43,x:-23,runtime:"capsui.UICopy"}}]}]},{type:"Sprite",props:{y:47,x:1379,width:50,name:"scrollbar",mouseThrough:!1,mouseEnabled:!0,height:749},child:[{type:"Image",props:{y:0,x:25,skin:"myres/scrollbar.png",name:"scrollbar",height:749,anchorX:.5,alpha:.5}},{type:"Image",props:{y:96,x:25,width:45,skin:"myres/scrollpoint.png",name:"scrollpoint",height:45,anchorY:.5,anchorX:.5}}]},{type:"Script",props:{runtime:"capsui.CScrollView"}}]},{type:"Sprite",props:{y:-4,x:-11,width:1461,name:"page_vip",height:847},child:[{type:"Image",props:{y:68,x:848,skin:"myres/bothui/box_line.png"},child:[{type:"Image",props:{y:0,x:-202,skin:"myres/bothui/box_line.png",scaleX:-1}},{type:"Label",props:{y:-24,x:-177,width:168,text:"称号效果",scaleY:.99,scaleX:.9,height:51,font:"fengyu",color:"#fcc45f"}}]},{type:"Image",props:{y:562,x:744,skin:"myres/lobby/contract__line.png",name:"shuxian"}},{type:"Image",props:{y:310,x:433,width:641,skin:"myres/lobby/contract_bg.png",name:"bg_title",height:104,sizeGrid:"0,109,0,109"}},{type:"Image",props:{y:744,x:135,width:1222,skin:"myres/lobby/contract_bar_bg.png",name:"bar",height:26,sizeGrid:"1,1,1,1"},child:[{type:"Sprite",props:{width:1222,name:"v",height:26},child:[{type:"Image",props:{y:0,x:0,width:1222,skin:"myres/lobby/contract_bar.png",scaleX:1,pivotX:0,height:26,sizeGrid:"0,5,0,2"}},{type:"Image",props:{x:0,width:1222,skin:"myres/bbg.png",scaleX:1,renderType:"mask",pivotX:0,name:"mask",height:26,sizeGrid:"1,1,1,1"}}]}]},{type:"Image",props:{y:560,x:132,width:1225,skin:"myres/lobby/contract_info.png",name:"container_infos",height:156,sizeGrid:"9,6,10,9"},child:[{type:"Label",props:{y:13,x:4,width:606,text:"角色对局时获得的好感度+5",height:27,fontSize:25,font:"SimHei",color:"#68c65e",align:"center"}},{type:"Label",props:{y:13,x:617,width:606,text:"角色对局时获得的好感度+5",height:27,fontSize:25,font:"SimHei",color:"#68c65e",align:"center"}},{type:"Label",props:{y:48,x:4,width:606,text:"角色对局时获得的好感度+5",height:27,fontSize:25,font:"SimHei",color:"#68c65e",align:"center"}},{type:"Label",props:{y:48,x:617,width:606,text:"角色对局时获得的好感度+5",height:27,fontSize:25,font:"SimHei",color:"#68c65e",align:"center"}},{type:"Label",props:{y:84,x:4,width:606,text:"角色对局时获得的好感度+5",height:27,fontSize:25,font:"SimHei",color:"#68c65e",align:"center"}},{type:"Label",props:{y:84,x:617,width:606,text:"角色对局时获得的好感度+5",height:27,fontSize:25,font:"SimHei",color:"#68c65e",align:"center"}},{type:"Label",props:{y:119,x:4,width:606,text:"角色对局时获得的好感度+5",height:27,fontSize:25,font:"SimHei",color:"#68c65e",align:"center"}},{type:"Label",props:{y:119,x:617,width:606,text:"角色对局时获得的好感度+5",height:27,fontSize:25,font:"SimHei",color:"#68c65e",align:"center"}}]},{type:"Label",props:{y:522,x:587,text:"达成条件：充值10000辉玉",name:"require",fontSize:25,font:"SimHei",color:"#c5a56b"}},{type:"Image",props:{y:310,x:479,width:547,skin:"extendRes/title/yuanchuzhihuo.png",name:"current_title_big",height:105}},{type:"Button",props:{y:361,x:273,width:153,pivotY:111,pivotX:89,name:"btn_left",height:219},child:[{type:"Image",props:{y:81,x:100,skin:"myres/lobby/contract_arrow.png",scaleX:-1,name:"left"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:361,x:1230,width:148,pivotY:112,pivotX:66,name:"btn_right",height:216},child:[{type:"Image",props:{y:82,x:58,skin:"myres/lobby/contract_arrow.png",name:"right"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Sprite",props:{y:774,x:254,width:1084,name:"container_next",height:47},child:[{type:"Label",props:{y:6,x:84,text:"当前",fontSize:25,font:"SimHei",color:"#c5a56b"}},{type:"Image",props:{y:-3,x:138,width:221,skin:"extendRes/title/yuanchuzhihuo.png",name:"current_title_small",height:43}},{type:"Label",props:{y:6,x:412,width:315,text:"再充值99999辉玉即可升级为",name:"next_info",height:25,fontSize:25,font:"SimHei",color:"#c5a56b"}},{type:"Image",props:{y:-3,x:733,width:221,skin:"extendRes/title/yuanchuzhihuo.png",name:"next_title",height:43}}]},{type:"Label",props:{y:745,x:506,width:479,text:"999/999",name:"value",height:27,fontSize:25,font:"SimHei",color:"#ffffff",align:"center"}}]}]},{type:"Sprite",props:{width:1920,name:"pop_buy_single",mouseThrough:!1,mouseEnabled:!0,height:1080},child:[{type:"Sprite",props:{y:568,x:992,width:804,pivotY:317,pivotX:413,name:"root",height:595},child:[{type:"Image",props:{y:101,x:129,width:565,skin:"myres/pop2_bg.png",name:"bg0",height:424,sizeGrid:"2,2,2,2"}},{type:"Image",props:{y:101,x:129,width:567,skin:"myres/pop2_bound.png",name:"bound",height:424,sizeGrid:"24,27,11,21"}},{type:"Label",props:{y:110,x:133,width:699,valign:"middle",text:"一之濑的琴",scaleY:.8,scaleX:.8,name:"label_name",height:65,fontSize:45,font:"SimHei",color:"#e8af71",align:"center"}},{type:"Label",props:{y:176,x:329,wordWrap:!0,width:341,valign:"middle",text:"我擦咧搞毛啊啊啊啊啊啊啊啊啊啊啊啊啊",name:"desc",leading:4,height:153,fontSize:25,font:"SimHei",color:"#b5c4c8",align:"left"}},{type:"Button",props:{y:105,x:692,width:100,pivotY:51,pivotX:60,name:"btn_close",height:100},child:[{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Image",props:{y:11,x:20,width:80,skin:"myres/btn_close.png",height:80}}]},{type:"Sprite",props:{y:130,x:135,width:298,scaleY:.63,scaleX:.63,name:"item",height:349},child:[{type:"Image",props:{y:195,x:151,width:242,skin:"myres/kuangbg.png",name:"bg",height:242,anchorY:.5,anchorX:.5,sizeGrid:"7,7,8,7"}},{type:"Image",props:{y:195,x:151,width:242,name:"icon",height:242,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:195,x:151,width:242,skin:"myres/kuangbound.png",name:"bound",height:242,anchorY:.5,anchorX:.5,sizeGrid:"18,20,12,12"}},{type:"Image",props:{y:147,x:26,width:252,skin:"myres/shop/buyed.png",name:"buyed",height:153}}]},{type:"Button",props:{y:470,x:405,width:225,stateNum:1,skin:"myres/shop/btn_buy.png",name:"btn_buy",height:64,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:7,x:37,width:148,valign:"middle",text:"购买",name:"label_gold",height:39,fontSize:40,font:"fengyu",color:"#4d0307",align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Image",props:{y:392,x:241,width:338,skin:"myres/shop/price_bg.png",name:"price",height:34},child:[{type:"Label",props:{y:6,x:53,width:53,text:"总价",name:"label0",height:27,fontSize:25,font:"SimHei",color:"#dbd8d8"}},{type:"Image",props:{y:-5,x:112,width:43,skin:"extendRes/items/gold1.png",name:"icon",height:43}},{type:"Label",props:{y:-1,x:160,width:122,text:"999999",name:"count",height:35,fontSize:35,font:"SimHei",color:"#dbd8d8",align:"left"}}]}]}]},{type:"Sprite",props:{width:1920,name:"choose_method",height:1080},child:[{type:"Sprite",props:{y:541,x:946,width:804,pivotY:317,pivotX:413,name:"root",height:595},child:[{type:"Image",props:{y:17,x:45,width:748,skin:"myres/pop2_bg.png",name:"bg0",height:549,sizeGrid:"2,2,2,2"}},{type:"Image",props:{y:17,x:45,width:748,skin:"myres/pop2_bound.png",name:"bound",height:549,sizeGrid:"24,27,11,21"}},{type:"Button",props:{y:21,x:789,width:130,pivotY:51,pivotX:60,name:"btn_close",height:113},child:[{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Image",props:{y:11,x:20,width:80,skin:"myres/btn_close.png",height:80}}]},{type:"Label",props:{y:42,x:297,width:261,text:"选择支付方式",height:42,fontSize:46,font:"fengyu",color:"#e9ae85",align:"center"}},{type:"Label",props:{y:198,x:89,width:246,text:"商品名称：",height:37,fontSize:30,font:"SimHei",color:"#646f97"}},{type:"Label",props:{y:247,x:89,width:246,text:"6800辉玉",name:"title",height:37,fontSize:35,font:"SimHei",color:"#dfe1e7"}},{type:"Label",props:{y:318,x:89,width:246,text:"应付金额：",height:37,fontSize:30,font:"SimHei",color:"#646f97"}},{type:"Label",props:{y:362,x:89,width:246,text:"680.00元",name:"price",height:55,fontSize:50,font:"SimHei",color:"#ff814b"}},{type:"Label",props:{y:518,x:81,width:522,text:"支付疑问请加 QQ：951307369",name:"extendinfo",height:37,fontSize:30,font:"SimHei",color:"#a6a8af"}},{type:"Panel",props:{y:119,x:332,width:422,name:"lst",height:369},child:[{type:"Button",props:{y:0,x:213,width:410,name:"wx",height:141,anchorX:.5},child:[{type:"Sprite",props:{y:6,x:6,width:397,name:"wechat",height:129},child:[{type:"Image",props:{y:4,x:6,width:384,skin:"myres/lobby/pay_bg.png",height:120,alpha:.5,sizeGrid:"8,7,7,7"}},{type:"Label",props:{y:47,x:135,width:158,text:"微信",height:37,fontSize:38,font:"SimHei",color:"#789bbf"}},{type:"Image",props:{y:21,x:34,width:86,skin:"myres/lobby/pay_wechat.png",height:86}},{type:"Image",props:{y:44,x:343,width:25,skin:"myres/lobby/pay_arrow.png",height:42}}]},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:144,x:213,width:410,name:"alipay",height:141,anchorX:.5},child:[{type:"Sprite",props:{y:6,x:6,width:397,name:"alipay",height:129},child:[{type:"Image",props:{y:4,x:6,width:384,skin:"myres/lobby/pay_bg.png",height:120,alpha:.5,sizeGrid:"8,7,7,7"}},{type:"Label",props:{y:47,x:135,width:158,text:"支付宝",height:37,fontSize:38,font:"SimHei",color:"#789bbf"}},{type:"Image",props:{y:21,x:34,width:86,skin:"myres/lobby/pay_ali.png",height:86}},{type:"Image",props:{y:44,x:343,width:25,skin:"myres/lobby/pay_arrow.png",height:42}}]},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:288,x:213,width:410,name:"alipay_code",height:141,anchorX:.5},child:[{type:"Sprite",props:{y:6,x:6,width:397,name:"alipay",height:129},child:[{type:"Image",props:{y:4,x:6,width:384,skin:"myres/lobby/pay_bg.png",height:120,alpha:.5,sizeGrid:"8,7,7,7"}},{type:"Label",props:{y:47,x:135,width:158,text:"支付宝扫码",height:37,fontSize:38,font:"SimHei",color:"#789bbf"}},{type:"Image",props:{y:21,x:34,width:86,skin:"myres/lobby/pay_ali.png",height:86}},{type:"Image",props:{y:44,x:343,width:25,skin:"myres/lobby/pay_arrow.png",height:42}}]},{type:"Script",props:{runtime:"capsui.CButton"}}]}]}]}]},{type:"Sprite",props:{y:0,x:0,width:1920,name:"wxcode",height:1080},child:[{type:"Sprite",props:{y:534,x:931,width:855,pivotY:381,pivotX:436,name:"root",height:828},child:[{type:"Image",props:{y:17,x:45,width:787,skin:"myres/pop2_bg.png",name:"bg0",height:786,sizeGrid:"2,2,2,2"}},{type:"Image",props:{y:17,x:45,width:787,skin:"myres/pop2_bound.png",name:"bound",height:786,sizeGrid:"24,27,11,21"}},{type:"Button",props:{y:23,x:829,width:100,pivotY:51,pivotX:60,name:"btn_close",height:100},child:[{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Image",props:{y:11,x:20,width:80,skin:"myres/btn_close.png",height:80}}]},{type:"Image",props:{y:308,x:441,width:353,skin:"myres/kuangbg.png",name:"bg",height:353,anchorY:.5,anchorX:.5,sizeGrid:"7,7,8,7"}},{type:"Image",props:{y:308,x:441,width:354,name:"icon",height:354,anchorY:.5,anchorX:.5}},{type:"Label",props:{y:523,x:198,width:246,text:"商品名称：",name:"title",height:37,fontSize:37,font:"SimHei",color:"#646f97"},child:[{type:"Label",props:{y:0,x:198,width:246,text:"6800辉玉",name:"v",height:37,fontSize:37,font:"SimHei",color:"#646f97"}}]},{type:"Label",props:{y:603,x:198,width:246,text:"应付金额：",name:"price",height:37,fontSize:37,font:"SimHei",color:"#646f97"},child:[{type:"Label",props:{y:0,x:198,width:246,text:"680.00元",name:"v",height:37,fontSize:37,font:"SimHei",color:"#646f97"}}]},{type:"Label",props:{y:61,x:119,width:100,text:"请打开",height:37,fontSize:33,font:"SimHei",color:"#646f97"}},{type:"Label",props:{y:61,x:334,width:451,text:"“扫一扫”扫描二维码完成支付",height:37,fontSize:33,font:"SimHei",color:"#646f97"}},{type:"Label",props:{y:61,x:229,width:108,text:"支付宝",name:"method",height:37,fontSize:33,font:"SimHei",color:"#00a9ec",align:"center"}},{type:"Button",props:{y:717,x:439,width:172,name:"btn_close2",height:103,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:11,x:22,width:128,skin:"myres/lobby/pay_bg.png",height:80,sizeGrid:"8,7,7,7"},child:[{type:"Label",props:{y:19,x:16,width:94,text:"关闭",height:45,fontSize:37,font:"SimHei",color:"#9fa8ca",align:"center"}}]},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Sprite",props:{y:238,x:415,width:127,name:"loading",mouseThrough:!0,height:133},child:[{type:"Image",props:{y:67,x:26,skin:"myres/necessary/flower_nei.png",scaleY:1.2,scaleX:1.2,rotation:0,name:"flower",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:0,x:0,skin:"myres/necessary/flower_shine.png",name:"shine",alpha:1}},{type:"Image",props:{y:56,x:56,skin:"myres/necessary/round.png",name:"round",anchorY:.5,anchorX:.5}}]},{type:"Script",props:{runtime:"capsui.CLoading"}}]}]}]},{type:"Sprite",props:{width:1920,name:"container_loading",height:1080},child:[{type:"Sprite",props:{y:450,x:929,width:127,name:"loading",mouseThrough:!0,height:133},child:[{type:"Image",props:{y:67,x:26,skin:"myres/necessary/flower_nei.png",scaleY:1.2,scaleX:1.2,rotation:0,name:"flower",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:0,x:0,skin:"myres/necessary/flower_shine.png",name:"shine",alpha:1}},{type:"Image",props:{y:56,x:56,skin:"myres/necessary/round.png",name:"round",anchorY:.5,anchorX:.5}}]},{type:"Script",props:{runtime:"capsui.CLoading"}}]}]}]},i}(View);t.rechargeUI=i}(e.lobby||(e.lobby={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.CButton",capsui.CButton),View.regComponent("capsui.UICopy",capsui.UICopy),View.regComponent("capsui.CScrollView",capsui.CScrollView),t.prototype.createChildren.call(this),this.createView(e.lobby.shopUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Image",props:{y:154,x:362,width:1461,skin:"myres/shop/bg_container.png",name:"content",height:857,sizeGrid:"58,59,63,59"},child:[{type:"Sprite",props:{y:-1,x:-291,width:338,name:"tabs",height:816},child:[{type:"Button",props:{y:118,x:178,width:336,stateNum:1,skin:"myres/shop/tab_unchoose.png",height:141,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:24,x:24,width:184,valign:"middle",text:"杂货屋",scaleY:1.5,scaleX:1.5,name:"label_name",height:66,fontSize:60,font:"fengyu",color:"#ebb661",align:"center"}}]},{type:"Button",props:{y:244,x:178,width:336,stateNum:1,skin:"myres/shop/tab_unchoose.png",height:141,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:24,x:24,width:184,valign:"middle",text:"祈愿屋",scaleY:1.5,scaleX:1.5,name:"label_name",height:66,fontSize:60,font:"fengyu",color:"#ebb661",align:"center"}}]},{type:"Button",props:{y:369,x:178,width:336,stateNum:1,skin:"myres/shop/tab_unchoose.png",height:141,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:24,x:24,width:184,valign:"middle",text:"星之屋",scaleY:1.5,scaleX:1.5,name:"label_name",height:66,fontSize:60,font:"fengyu",color:"#ebb661",align:"center"}}]},{type:"Button",props:{y:490,x:178,width:336,stateNum:1,skin:"myres/shop/tab_unchoose.png",height:141,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:24,x:24,width:184,valign:"middle",text:"福袋屋",scaleY:1.5,scaleX:1.5,name:"label_name",height:66,fontSize:60,font:"fengyu",color:"#ebb661",align:"center"}}]}]},{type:"Sprite",props:{y:0,x:0,width:1463,name:"right",height:863},child:[{type:"Image",props:{y:122,x:88,width:1294,skin:"myres/lobby/sell_line.png",name:"line",height:4}},{type:"Sprite",props:{y:34,x:58,width:1335,name:"head0",height:77},child:[{type:"Button",props:{y:39,x:1182,width:262,stateNum:1,skin:"myres/bothui/invite_btn1.png",name:"refresh",height:68,anchorY:.5,anchorX:.5,sizeGrid:"4,5,5,5"},child:[{type:"Label",props:{y:13,x:2,width:321,text:"立即刷新",scaleY:.8,scaleX:.8,name:"free",height:45,font:"fengyu",color:"#fcba72",align:"center"}},{type:"Sprite",props:{y:0,x:0,width:262,name:"pay",height:68},child:[{type:"Label",props:{y:14,x:24,width:117,text:"刷新",scaleY:.8,scaleX:.8,name:"count",height:45,font:"fengyu",color:"#fcba72",align:"left"}},{type:"Image",props:{y:20,x:122,width:33,skin:"extendRes/items/gold1.png",name:"icon",height:33}},{type:"Label",props:{y:21,x:159,width:106,text:"×999",scaleY:.8,scaleX:.8,name:"money",height:45,fontSize:40,font:"SimHei",color:"#fcba72",align:"left"}}]},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Label",props:{y:29,x:677,width:444,text:"剩余刷新次数：99",scaleY:.8,scaleX:.8,name:"count",height:45,fontSize:40,font:"SimHei",color:"#fcba72",align:"right"}},{type:"Label",props:{y:24,x:30,width:310,text:"每日凌晨5点刷新",scaleY:.8,scaleX:.8,height:45,fontSize:40,font:"SimHei",color:"#fcba72",align:"left"}},{type:"Label",props:{y:24,x:941,width:468,text:"今日刷新次数已经用完",scaleY:.8,scaleX:.8,name:"noinfo",height:45,fontSize:40,font:"SimHei",color:"#fcba72",align:"right"}}]},{type:"Sprite",props:{y:34,x:58,width:1335,name:"head1",height:77},child:[{type:"Label",props:{y:30,x:287,text:"重复获得的角色将兑换为许愿石",fontSize:25,font:"SimHei",color:"#81b3c2"}},{type:"Label",props:{y:23,x:79,text:"×999999",name:"count",fontSize:32,font:"SimHei",color:"#e4b777",align:"left"}},{type:"Image",props:{y:16,x:30,width:46,name:"icon",height:46}}]},{type:"Sprite",props:{y:34,x:58,width:1335,name:"head2",height:77},child:[{type:"Image",props:{y:16,x:30,width:46,name:"icon",height:46}},{type:"Label",props:{y:23,x:79,text:"×999999",name:"count",fontSize:32,font:"SimHei",color:"#e4b777",align:"left"}},{type:"Label",props:{y:30,x:287,text:"重复获得的装扮将兑换为星之石",fontSize:25,font:"SimHei",color:"#81b3c2"}}]},{type:"Sprite",props:{y:34,x:58,width:1335,name:"head3",height:77},child:[{type:"Image",props:{y:16,x:30,width:46,name:"icon",height:46}},{type:"Label",props:{y:30,x:287,text:"可以通过奉纳礼物获得星之粉尘",fontSize:25,font:"SimHei",color:"#81b3c2"}},{type:"Label",props:{y:23,x:79,text:"×999999",name:"count",fontSize:32,font:"SimHei",color:"#e4b777",align:"left"}}]},{type:"Panel",props:{y:139,x:102,width:1280,name:"content",height:667},child:[{type:"Sprite",props:{y:0,x:0,width:320,name:"templete",height:409},child:[{type:"Button",props:{y:186,x:147,width:256,pivotY:165,pivotX:127,name:"btn",height:363,gray:!1},child:[{type:"Image",props:{y:-4,x:-7,width:269,skin:"myres/shop/item_bg.png",name:"bbg",height:370}},{type:"Image",props:{y:160,x:128,width:163,skin:"myres/kuangbg.png",name:"bg",height:163,anchorY:.5,anchorX:.5,sizeGrid:"7,7,8,7"}},{type:"Image",props:{y:160,x:128,width:163,name:"icon",height:163,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:160,x:128,width:169,skin:"myres/kuangbound.png",name:"bound",height:169,anchorY:.5,anchorX:.5,sizeGrid:"18,20,12,12"}},{type:"Label",props:{y:17,x:-2,width:324,text:"二阶堂美树",scaleY:.8,scaleX:.8,name:"label_name",height:49,fontSize:40,font:"SimHei",color:"#eeeae6",align:"center"}},{type:"Image",props:{y:286,x:14,width:228,skin:"myres/shop/btn_buy.png",name:"btn_buy",height:65},child:[{type:"Image",props:{y:33,x:28,width:47,skin:"myres/gold0.png",scaleY:.95,scaleX:.95,name:"currency",height:48,anchorY:.5,anchorX:0}},{type:"Label",props:{y:33,x:74,width:129,valign:"middle",text:"999999",name:"label_gold",height:39,fontSize:42,font:"SimHei",color:"#3a2138",anchorY:.5,align:"left"}}]},{type:"Label",props:{y:245,x:42,width:216,text:"9999",scaleY:.8,scaleX:.8,name:"count",height:40,fontSize:42,font:"SimHei",color:"#bac6cc",align:"center"}},{type:"Image",props:{y:75,x:23,width:211,skin:"myres/shop/buyed.png",name:"buyed",height:169}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Script",props:{y:-43,x:-23,runtime:"capsui.UICopy"}}]}]},{type:"Sprite",props:{y:138,x:1351,width:50,name:"scrollbar",mouseThrough:!1,mouseEnabled:!0,height:658},child:[{type:"Image",props:{y:0,x:25,skin:"myres/scrollbar.png",name:"scrollbar",height:658,anchorX:.5,alpha:.5}},{type:"Image",props:{y:96,x:25,width:45,skin:"myres/scrollpoint.png",name:"scrollpoint",height:45,anchorY:.5,anchorX:.5}}]},{type:"Script",props:{runtime:"capsui.CScrollView"}}]}]},{type:"Image",props:{y:48,x:119,width:401,skin:"myres/img_return1_bg.png",name:"top",height:81},child:[{type:"Label",props:{y:3,x:105,width:95,text:"商家",scaleY:1.4,scaleX:1.4,height:45,font:"fengyu",color:"#e4ba86",align:"center"}},{type:"Button",props:{y:33,x:-67,width:182,pivotY:67,pivotX:49,name:"btn_back",height:142},child:[{type:"Image",props:{y:6,x:7,width:135,skin:"myres/img_return1.png",height:134}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:49.5,x:1218,width:294,name:"container_gold0",height:89,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Image",props:{y:3,x:38,width:253,skin:"myres/lobby/bg_0.png",name:"bg",height:88}},{type:"Image",props:{y:8,x:10,width:70,skin:"myres/gold0.png",scaleY:1,scaleX:1,name:"icon",height:70}},{type:"Label",props:{y:25,x:77,width:125,valign:"middle",text:"9.024亿",name:"label_gold",height:39,fontSize:35,font:"SimHei",color:"#ffffff",align:"right"}}]},{type:"Button",props:{y:49.5,x:1509,width:294,name:"container_gold1",height:89,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Image",props:{y:3,x:38,width:253,skin:"myres/lobby/bg_0.png",name:"bg",height:88}},{type:"Image",props:{y:8,x:10,width:70,skin:"myres/gold1.png",scaleY:1,scaleX:1,name:"icon",height:70}},{type:"Label",props:{y:25,x:77,width:125,valign:"middle",text:"1000",name:"label_gold",height:39,fontSize:35,font:"SimHei",color:"#ffffff",align:"right"}}]}]},{type:"Sprite",props:{width:1920,name:"pop_buy_single",mouseThrough:!1,mouseEnabled:!0,height:1080},child:[{type:"Sprite",props:{y:568,x:992,width:804,pivotY:317,pivotX:413,name:"root",height:595},child:[{type:"Image",props:{y:101,x:129,width:565,skin:"myres/pop2_bg.png",name:"bg0",height:424,sizeGrid:"2,2,2,2"}},{type:"Image",props:{y:101,x:129,width:567,skin:"myres/pop2_bound.png",name:"bound",height:424,sizeGrid:"24,27,11,21"}},{type:"Label",props:{y:110,x:133,width:699,valign:"middle",text:"一之濑的琴",scaleY:.8,scaleX:.8,name:"label_name",height:65,fontSize:45,font:"SimHei",color:"#e8af71",align:"center"}},{type:"Label",props:{y:176,x:329,wordWrap:!0,width:341,valign:"middle",text:"我擦咧搞毛啊啊啊啊啊啊啊啊啊啊啊啊啊",name:"desc",leading:4,height:153,fontSize:25,font:"SimHei",color:"#b5c4c8",align:"left"}},{type:"Button",props:{y:120,x:676,width:100,pivotY:51,pivotX:60,name:"btn_close",height:100},child:[{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Image",props:{y:11,x:20,width:80,skin:"myres/btn_close.png",height:80}}]},{type:"Sprite",props:{y:130,x:135,width:298,scaleY:.63,scaleX:.63,name:"item",height:349},child:[{type:"Image",props:{y:195,x:151,width:236,skin:"myres/kuangbg.png",name:"bg",height:236,anchorY:.5,anchorX:.5,sizeGrid:"7,7,8,7"}},{type:"Image",props:{y:195,x:151,width:236,name:"icon",height:236,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:195,x:151,width:242,skin:"myres/kuangbound.png",name:"bound",height:242,anchorY:.5,anchorX:.5,sizeGrid:"18,20,12,12"}},{type:"Image",props:{y:71,x:-4,width:310,skin:"myres/shop/buyed.png",name:"buyed",height:249}}]},{type:"Button",props:{y:470,x:405,width:225,stateNum:1,skin:"myres/shop/btn_buy.png",name:"btn_buy",height:64,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:7,x:37,width:148,valign:"middle",text:"购买",name:"label_gold",height:39,fontSize:40,font:"fengyu",color:"#4d0307",align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Image",props:{y:392,x:241,width:338,skin:"myres/shop/price_bg.png",name:"price",height:34},child:[{type:"Label",props:{y:6,x:53,width:53,text:"总价",name:"label0",height:27,fontSize:25,font:"SimHei",color:"#dbd8d8"}},{type:"Image",props:{y:-5,x:112,width:43,skin:"extendRes/items/gold1.png",name:"icon",height:43}},{type:"Label",props:{y:-1,x:160,width:122,text:"999999",name:"count",height:35,fontSize:35,font:"SimHei",color:"#dbd8d8",align:"left"}}]}]}]},{type:"Sprite",props:{width:1920,name:"pop_buy_multi",mouseThrough:!1,mouseEnabled:!0,height:1080},child:[{type:"Sprite",props:{y:565,x:969,width:1e3,pivotY:456,pivotX:478,name:"root",height:812},child:[{type:"Image",props:{y:101,x:129,width:711,skin:"myres/pop2_bg.png",pivotY:0,pivotX:0,name:"bg0",height:708,sizeGrid:"2,2,2,2"}},{type:"Image",props:{y:101,x:129,width:711,skin:"myres/pop2_bound.png",name:"bound",height:708,sizeGrid:"24,27,11,21"}},{type:"Label",props:{y:110,x:133,width:880,valign:"middle",text:"一之濑的琴",scaleY:.8,scaleX:.8,name:"label_name",height:82,fontSize:45,font:"SimHei",color:"#e8af71",align:"center"}},{type:"Label",props:{y:190,x:404,wordWrap:!0,width:360,valign:"middle",text:"我擦咧搞毛啊啊啊啊啊啊啊啊啊啊啊啊啊",name:"desc",leading:4,height:153,fontSize:25,font:"SimHei",color:"#b5c4c8",align:"left"}},{type:"Button",props:{y:103,x:834,width:100,name:"btn_close",height:100,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Image",props:{y:10,x:10,width:80,skin:"myres/btn_close.png",height:80}}]},{type:"Sprite",props:{y:143,x:207,width:298,scaleY:.63,scaleX:.63,name:"item",height:349},child:[{type:"Image",props:{y:195,x:151,width:236,skin:"myres/kuangbg.png",name:"bg",height:236,anchorY:.5,anchorX:.5,sizeGrid:"7,7,8,7"}},{type:"Image",props:{y:195,x:151,width:236,name:"icon",height:236,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:195,x:151,width:242,skin:"myres/kuangbound.png",name:"bound",height:242,anchorY:.5,anchorX:.5,sizeGrid:"18,20,12,12"}},{type:"Image",props:{y:70,x:-3,width:311,skin:"myres/shop/buyed.png",name:"buyed",height:249}}]},{type:"Button",props:{y:751,x:482,width:225,stateNum:1,skin:"myres/shop/btn_buy.png",name:"btn_buy",height:64,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:6,x:37,width:148,valign:"middle",text:"购买",name:"label_gold",height:39,fontSize:40,font:"fengyu",color:"#4d0307",align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Image",props:{y:389,x:300,width:170,skin:"myres/shop/detail_bg.png",name:"danjia",height:84,sizeGrid:"10,10,10,10"},child:[{type:"Label",props:{y:7,x:8,text:"单价",fontSize:26,font:"SimHei",color:"#6c779d"}},{type:"Image",props:{y:44,x:12,width:32,skin:"extendRes/items/gold1.png",name:"icon",height:32}},{type:"Label",props:{y:45,x:58,width:106,text:"999999",name:"price",height:35,fontSize:33,font:"SimHei",color:"#8c9cb4",align:"left"}}]},{type:"Image",props:{y:389,x:488,width:170,skin:"myres/shop/detail_bg.png",name:"left",height:84,sizeGrid:"10,10,10,10"},child:[{type:"Label",props:{y:7,x:8,text:"剩余",fontSize:26,font:"SimHei",color:"#6c779d"}},{type:"Label",props:{y:47,x:28,width:125,text:"999/月",name:"count",height:35,fontSize:28,font:"SimHei",color:"#8c9cb4",align:"right"}}]},{type:"Label",props:{y:480,x:387,text:"每个月刷新一次",name:"refresh_info",fontSize:26,font:"SimHei",color:"#4f7da8"}},{type:"Image",props:{y:674,x:311,width:338,skin:"myres/shop/price_bg.png",name:"price",height:34},child:[{type:"Label",props:{y:6,x:53,width:53,text:"总价",name:"label0",height:27,fontSize:25,font:"SimHei",color:"#dbd8d8"}},{type:"Image",props:{y:-5,x:112,width:43,skin:"extendRes/items/gold1.png",name:"icon",height:43}},{type:"Label",props:{y:-1,x:160,width:122,text:"999999",name:"count",height:35,fontSize:35,font:"SimHei",color:"#dbd8d8",align:"left"}}]},{type:"Label",props:{y:546,x:436,width:89,text:"99",name:"count",height:59,fontSize:55,font:"SimHei",color:"#dbd8d8",align:"center"}},{type:"Image",props:{y:530,x:183,width:86,skin:"myres/lobby/num.png",name:"-10",height:84,sizeGrid:"19,22,21,20"},child:[{type:"Image",props:{y:0,x:0,width:86,skin:"myres/lobby/num_pressed.png",name:"s",height:84}},{type:"Label",props:{y:17,x:6,width:64,text:"-10",height:44,fontSize:45,font:"SimHei",color:"#79b1d6"}}]},{type:"Image",props:{y:530,x:695,width:86,skin:"myres/lobby/num.png",name:"+10",height:84,sizeGrid:"19,22,21,20"},child:[{type:"Image",props:{y:0,x:0,width:86,skin:"myres/lobby/num_pressed.png",name:"s",height:84}},{type:"Label",props:{y:17,x:6,width:64,text:"+10",height:44,fontSize:45,font:"SimHei",color:"#79b1d6"}}]},{type:"Image",props:{y:530,x:583,width:86,skin:"myres/lobby/num.png",name:"+1",height:84,sizeGrid:"19,22,21,20"},child:[{type:"Image",props:{y:0,x:0,width:86,skin:"myres/lobby/num_pressed.png",name:"s",height:84}},{type:"Label",props:{y:17,x:22,width:44,text:"+1",height:44,fontSize:45,font:"SimHei",color:"#79b1d6"}}]},{type:"Image",props:{y:530,x:294,width:86,skin:"myres/lobby/num.png",name:"-1",height:84,sizeGrid:"19,22,21,20"},child:[{type:"Image",props:{y:0,x:0,width:86,skin:"myres/lobby/num_pressed.png",name:"s",height:84}},{type:"Label",props:{y:17,x:22,width:44,text:"-1",height:44,fontSize:45,font:"SimHei",color:"#79b1d6"}}]}]}]}]},i}(View);t.shopUI=i}(e.lobby||(e.lobby={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.CButton",capsui.CButton),View.regComponent("capsui.UICopy",capsui.UICopy),t.prototype.createChildren.call(this),this.createView(e.lobby.signUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Image",props:{skin:"设计稿/主界面_签到181017版.jpg"}},{type:"Sprite",props:{y:68,x:356,width:1171,height:965},child:[{type:"Image",props:{y:480,x:584,width:1165,skin:"myres/pop_bg.png",name:"bg0",height:950,anchorY:.5,anchorX:.5,sizeGrid:"100,100,100,100"},child:[{type:"Image",props:{y:28,x:32,width:98,skin:"myres/pop_texturecut.png",name:"left",height:894,sizeGrid:"0,0,24,26"}},{type:"Image",props:{y:27,x:1139,width:110,skin:"myres/pop_texturecut.png",scaleX:-1,name:"right",height:896,sizeGrid:"0,0,24,26"}},{type:"Image",props:{y:38,x:34,width:1098,skin:"myres/pop_black.png",name:"bar",height:73}},{type:"Image",props:{y:119,x:35,width:1101,skin:"myres/pop_black.png",name:"bar",height:802}}]},{type:"Image",props:{y:481,x:584,width:1165,skin:"myres/pop_bound.png",name:"bound",height:950,anchorY:.5,anchorX:.5,sizeGrid:"131,102,97,106"}},{type:"Label",props:{y:59,x:488,width:220,text:"每日祈福",name:"title",height:45,fontSize:46,font:"fengyu",color:"#e9ae85",align:"center"}},{type:"Sprite",props:{y:190,x:140,width:134,name:"templete",height:122},child:[{type:"Image",props:{y:-36,x:-22,width:185,skin:"myres/lobby/sign_bg.png",height:185}},{type:"Button",props:{y:57,x:66,width:200,scaleY:.75,scaleX:.75,name:"btn_detail",height:188,anchorY:.5,anchorX:.5},child:[{type:"Sprite",props:{y:96,x:100,width:160,scaleY:1.1,scaleX:1.1,pivotY:80,pivotX:80,name:"content",height:160},child:[{type:"Image",props:{y:0,x:0,width:160,skin:"myres/kuangbg.png",name:"bg",height:160,sizeGrid:"7,7,8,7"}},{type:"Image",props:{y:1,x:0,width:160,name:"icon",height:160}},{type:"Image",props:{y:-2,x:-3,width:166,skin:"myres/kuangbound.png",name:"bound",height:166,sizeGrid:"18,20,12,12"}},{type:"Label",props:{y:126,x:62,width:91,text:999,strokeColor:"#000000",stroke:2,name:"num",height:31,fontSize:30,font:"SimHei",color:"#ffffff",align:"right"}}]},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Script",props:{y:0,x:0,runtime:"capsui.UICopy"}},{type:"Image",props:{y:4,x:16,width:105,skin:"myres/lobby/sign_collected.png",height:107}},{type:"Image",props:{y:-28,x:59,width:94,skin:"myres/lobby/sign_date.png",height:29},child:[{type:"Label",props:{y:-2,x:13,width:42,text:"第",scaleY:.6,scaleX:.6,height:45,fontSize:46,font:"fengyu",color:"#ffefde",align:"center"}},{type:"Label",props:{y:-2,x:63,width:42,text:"天",scaleY:.6,scaleX:.6,height:45,fontSize:46,font:"fengyu",color:"#ffefde",align:"center"}},{type:"Label",props:{y:2,x:35,width:32,text:"99",strokeColor:"#000000",name:"num",height:21,fontSize:25,font:"SimHei",color:"#ffefde",align:"center"}}]},{type:"Image",props:{y:-36,x:-23,width:184,skin:"myres/lobby/sign_outline.png",height:184}}]},{type:"Sprite",props:{y:190,x:903,width:134,name:"templete",height:122},child:[{type:"Image",props:{y:-36,x:-22,width:185,skin:"myres/lobby/sign_bg1.png",height:185}},{type:"Button",props:{y:57,x:66,width:200,scaleY:.75,scaleX:.75,name:"btn_detail",height:188,anchorY:.5,anchorX:.5},child:[{type:"Sprite",props:{y:96,x:100,width:160,scaleY:1.1,scaleX:1.1,pivotY:80,pivotX:80,name:"content",height:160},child:[{type:"Image",props:{y:0,x:0,width:160,skin:"myres/kuangbg.png",name:"bg",height:160,sizeGrid:"7,7,8,7"}},{type:"Image",props:{y:1,x:0,width:160,name:"icon",height:160}},{type:"Image",props:{y:-2,x:-3,width:166,skin:"myres/kuangbound.png",name:"bound",height:166,sizeGrid:"18,20,12,12"}},{type:"Label",props:{y:126,x:62,width:91,text:999,strokeColor:"#000000",stroke:2,name:"num",height:31,fontSize:30,font:"SimHei",color:"#ffffff",align:"right"}}]},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Script",props:{y:0,x:0,runtime:"capsui.UICopy"}},{type:"Image",props:{y:4,x:16,width:105,skin:"myres/lobby/sign_collected.png",height:107}},{type:"Image",props:{y:-28,x:59,width:94,skin:"myres/lobby/sign_date.png",height:29},child:[{type:"Label",props:{y:-2,x:13,width:42,text:"第",scaleY:.6,scaleX:.6,height:45,fontSize:46,font:"fengyu",color:"#ffefde",align:"center"}},{type:"Label",props:{y:-2,x:63,width:42,text:"天",scaleY:.6,scaleX:.6,height:45,fontSize:46,font:"fengyu",color:"#ffefde",align:"center"}},{type:"Label",props:{y:2,x:35,width:32,text:"99",strokeColor:"#000000",name:"num",height:21,fontSize:25,font:"SimHei",color:"#ffefde",align:"center"}}]},{type:"Image",props:{y:-36,x:-23,width:184,skin:"myres/lobby/sign_outline.png",height:184}}]},{type:"Button",props:{y:847,x:587,width:212,stateNum:1,skin:"myres/bothui/gift_btn.png",name:"confirm",height:76,anchorY:.5,anchorX:.5,sizeGrid:"0,68,0,51"},child:[{type:"Label",props:{y:7,x:57,width:86,text:"领取",scaleY:1.2,scaleX:1.2,height:53,font:"fengyu",color:"#1e0b1d"}},{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Label",props:{y:7,x:20,width:140,text:"已领取",scaleY:1.2,scaleX:1.2,name:"collected",height:53,font:"fengyu",color:"#1e0b1d",align:"center"}}]}]}]},i}(View);t.signUI=i}(e.lobby||(e.lobby={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.CButton",capsui.CButton),t.prototype.createChildren.call(this),this.createView(e.lobby.susheUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Sprite",props:{y:61,x:948,name:"illust"},child:[{type:"Sprite",props:{y:639,x:-486,name:"illust"},child:[{type:"Image",props:{y:-555,x:-498,width:944,skin:"extendRes/charactor/yiji/full.png",name:"illust",height:1421}}]},{type:"Image",props:{y:121,x:-879,width:85,skin:"myres/sushe/bg_name.png",name:"container_name",height:409},child:[{type:"Label",props:{y:-16,x:12,wordWrap:!0,width:51,valign:"middle",text:"二阶堂美树",scaleY:1.1,scaleX:1.3,name:"label_name",height:301,fontSize:60,font:"hanyi",color:"#e7e3df",align:"center"}},{type:"Image",props:{y:217,x:-42,width:45,skin:"myres/sushe/bg_cv.png",name:"cv",height:287}},{type:"Label",props:{y:228,x:-39,wordWrap:!0,width:51,valign:"middle",text:"CV藤原佳奈",scaleY:.7,scaleX:.9,name:"label_CV",height:384,fontSize:60,font:"hanyi",color:"#e7e3df",align:"center"}}]},{type:"Sprite",props:{y:741,x:-834,width:674,name:"chat",height:226},child:[{type:"Image",props:{y:15,x:25,width:633,skin:"myres/bothui/bf_chat.png",name:"bg",height:190,sizeGrid:"14,14,13,14"}},{type:"Label",props:{y:42,x:55,wordWrap:!0,width:578,text:"喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵",name:"info",leading:8,height:138,fontSize:29,font:"SimHei",color:"#e2dfdf"}}]},{type:"Button",props:{y:75,x:-750,width:646,name:"btn",height:914}}]},{type:"Sprite",props:{width:1920,name:"look_illust",mouseThrough:!0,height:1080},child:[{type:"Sprite",props:{y:0,x:0,width:1920,name:"move",height:1080}},{type:"Button",props:{y:855,x:1819,width:130,name:"btn_big",height:130,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:15,x:16,skin:"myres/sushe/btn_big.png",scaleY:1.5,scaleX:1.5}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:997,x:1819,width:130,name:"btn_small",height:130,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:16,x:16,skin:"myres/sushe/btn_small.png",scaleY:1.5,scaleX:1.5}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:61,x:1857,width:130,name:"btn_close",height:130,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:35,x:38,skin:"myres/sushe/bf_close.png",scaleY:1.5,scaleX:1.5}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]},{type:"Sprite",props:{y:0,x:0,width:1920,name:"container_page",mouseThrough:!0,height:1080}}]},i}(View);t.susheUI=i}(e.lobby||(e.lobby={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.CButton",capsui.CButton),View.regComponent("capsui.UICopy",capsui.UICopy),View.regComponent("capsui.CScrollView",capsui.CScrollView),t.prototype.createChildren.call(this),this.createView(e.lobby.sushe_selectUI.uiView)},i.uiView={type:"View",props:{width:1920,mouseThrough:!0,height:1080},child:[{type:"Image",props:{y:169,x:887,width:991,skin:"myres/shop/bg_container.png",name:"heads",height:865,sizeGrid:"58,59,63,59"},child:[{type:"Button",props:{y:85,x:-61,width:147,pivotY:134,pivotX:81,name:"btn_visit",height:361},child:[{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Image",props:{y:49,x:23,skin:"myres/sushe/bf_icon.png",name:"visit"}}]},{type:"Panel",props:{y:35,x:55,width:889,name:"content",height:784},child:[{type:"Sprite",props:{y:0,x:0,width:270,name:"templete",height:270},child:[{type:"Script",props:{y:0,x:0,runtime:"capsui.UICopy"}},{type:"Button",props:{y:0,x:0,width:265,scaleY:1,scaleX:1,name:"btn",height:259},child:[{type:"Image",props:{y:-2,x:-8,skin:"myres/sushe/choosed.png",name:"choose"}},{type:"Image",props:{y:-2,x:-8,skin:"myres/sushe/bg_head.png",name:"bg"}},{type:"Image",props:{y:13,x:25,width:225,skin:"extendRes/charactor/yiji/bighead.png",name:"head",height:224}},{type:"Image",props:{y:-2,x:-8,skin:"myres/sushe/bg_head2.png",name:"bound"}},{type:"Image",props:{y:158,x:109,width:143,skin:"myres/lobby/using.png",name:"using",height:106}},{type:"Label",props:{y:37,x:9,wordWrap:!0,width:64,valign:"middle",text:"二阶堂美树",scaleY:.6,scaleX:.7,name:"label_name",height:273,font:"fengyu",color:"#efab4e",align:"center"}}]}]}]},{type:"Script",props:{runtime:"capsui.CScrollView"}}]},{type:"Image",props:{y:48,x:119,width:401,skin:"myres/img_return1_bg.png",name:"top",height:81},child:[{type:"Label",props:{y:3,x:105,width:95,text:"寮舍",scaleY:1.4,scaleX:1.4,height:45,font:"fengyu",color:"#e4ba86",align:"center"}},{type:"Button",props:{y:39,x:-42,width:182,pivotY:73,pivotX:74,name:"btn_back",height:142},child:[{type:"Image",props:{y:6,x:7,width:135,skin:"myres/img_return1.png",height:134}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]},{type:"Button",props:{y:1011,x:73,width:180,pivotY:99,pivotX:93,name:"btn_look",height:179},child:[{type:"Image",props:{y:47,x:41,skin:"myres/sushe/bf_check.png"}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]},i}(View);t.sushe_selectUI=i}(e.lobby||(e.lobby={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.CLoading",capsui.CLoading),t.prototype.createChildren.call(this),this.createView(e.lobby.tanfang0UI.uiView)},i.uiView={type:"View",props:{width:1920,mouseThrough:!1,mouseEnabled:!0,height:1080},child:[{type:"Sprite",props:{y:437,x:936,width:127,name:"loading",mouseThrough:!0,height:133},child:[{type:"Image",props:{y:67,x:26,skin:"myres/necessary/flower_nei.png",scaleY:1.2,scaleX:1.2,rotation:0,name:"flower",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:0,x:0,skin:"myres/necessary/flower_shine.png",name:"shine",alpha:1}},{type:"Image",props:{y:56,x:56,skin:"myres/necessary/round.png",name:"round",anchorY:.5,anchorX:.5}},{type:"Image",props:{y:142,x:0,skin:"myres/necessary/word.png"}}]},{type:"Script",props:{runtime:"capsui.CLoading"}}]},{type:"Sprite",props:{name:"root"}}]},i}(View);t.tanfang0UI=i}(e.lobby||(e.lobby={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.CButton",capsui.CButton),t.prototype.createChildren.call(this),this.createView(e.lobby.tangfang1UI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Sprite",props:{y:0,x:0,width:1920,name:"container_scene",height:1080},child:[{type:"Image",props:{y:0,x:511,width:752,skin:"tanfang/sky.png",scaleY:1.2,scaleX:1.2,name:"sky",height:555,alpha:1},compId:13},{type:"Sprite",props:{y:0,x:0,name:"liuxing"}},{type:"Image",props:{y:0,x:0,width:1920,skin:"tanfang/front_scene.png",height:1080,alpha:1},compId:60},{type:"Image",props:{y:0,x:354,width:1212,skin:"tanfang/scene_light.png",scaleY:1,scaleX:1,name:"light",height:1080,alpha:1},compId:20}]},{type:"Button",props:{width:1920,name:"btn_next",height:1080}},{type:"Sprite",props:{y:574,x:959,width:521,pivotY:226,pivotX:263,name:"tanfang_wupin",height:468},compId:29,child:[{type:"Button",props:{y:-348,x:-696,width:1920,name:"btn_next",height:1080}},{type:"Image",props:{y:226,x:261,width:718,skin:"tanfang/bg_light_1.png",pivotY:404,pivotX:368,name:"bg_sakura",height:718},compId:24},{type:"Image",props:{y:226,x:261,width:718,skin:"tanfang/bg_light_0.png",pivotY:404,pivotX:368,name:"bg_normal",height:718},compId:25},{type:"Image",props:{y:226,x:261,width:350,skin:"tanfang/item_outline.png",height:350,anchorY:.5,anchorX:.5},compId:10},{type:"Sprite",props:{y:226,x:261,width:247,pivotY:110,pivotX:123,name:"item",height:257},compId:114,child:[{type:"Button",props:{y:112,x:122,width:214,pivotY:109,pivotX:109,name:"btn",height:214},child:[{type:"Image",props:{y:23,x:26,width:167,skin:"extendRes/items/coin0.jpg",name:"icon_origin",height:168},child:[{type:"Label",props:{y:137,x:54,width:110,text:"999999",name:"count",height:27,fontSize:28,font:"SimHei",color:"#f0eccb",align:"right"}}]},{type:"Image",props:{y:238,x:-36,width:175,skin:"myres/kuangbound.png",pivotY:219,pivotX:-58,name:"bound",height:175,sizeGrid:"18,20,12,12"}}]},{type:"Label",props:{y:206,x:7,width:217,text:"二阶堂美树",name:"name_origin",height:32,fontSize:28,font:"SimHei",color:"#f0eccb",align:"center"}}]}]},{type:"Sprite",props:{y:574,x:961,name:"effect_wuping"}},{type:"Sprite",props:{y:0,x:0,name:"tanfang_juese",mouseThrough:!1,mouseEnabled:!0},child:[{type:"Button",props:{y:0,x:0,width:1920,name:"btn_next",height:1080}},{type:"Sprite",props:{y:441,x:777,width:383,name:"jianying",height:343,alpha:1},compId:26,child:[{type:"Image",props:{y:-358,x:19,width:274,skin:"tanfang/character_light.png",scaleY:1.2,scaleX:1.2,name:"JYlight",height:608}},{type:"Sprite",props:{y:-441,x:-777,name:"scene_jianying_sakura"}},{type:"Image",props:{y:-72,x:112,width:111,visible:!1,skin:"tanfang/character_sakura.png",scaleY:1.2,scaleX:1.2,name:"JYyinghua",height:309}},{type:"Image",props:{y:102,x:137,width:67,skin:"tanfang/boy.png",scaleY:1.2,scaleX:1.2,name:"jianying_boy",height:159}},{type:"Image",props:{y:102,x:137,width:67,skin:"tanfang/girl.png",scaleY:1.2,scaleX:1.2,name:"jianying_girl",height:159}}]},{type:"Sprite",props:{y:-8,x:434,width:1071,visible:!1,name:"container_illust",height:1084},compId:32,child:[{type:"Image",props:{y:-490,x:-407,width:1812,skin:"tanfang/bg_light_1.png",name:"wupindi2",height:1812}},{type:"Image",props:{y:393,x:52,width:38,skin:"tanfang/bg_cv.png",scaleY:1.2,scaleX:1.2,name:"shengyouname",height:243,alpha:0},compId:8},{type:"Image",props:{y:188,x:87,width:73,skin:"tanfang/bg_name.png",scaleY:1.2,scaleX:1.2,name:"bigname",height:353,alpha:0},compId:9},{type:"Image",props:{y:57,x:62,width:916,skin:"extendRes/charactor/yiji/full.png",name:"illust",height:1378}},{type:"Label",props:{y:109,x:97,wordWrap:!0,width:51,valign:"middle",text:"二阶堂美树",scaleY:1.2,scaleX:1.3,name:"label_name",height:301,fontSize:60,font:"hanyi",color:"#efab4e",alpha:0,align:"center"},compId:112},{type:"Label",props:{y:329,x:48,wordWrap:!0,width:51,valign:"middle",text:"斋藤千和",scaleY:1,scaleX:1,name:"label_cv",height:301,fontSize:60,font:"hanyi",color:"#efab4e",alpha:0,align:"center"},compId:113},{type:"Sprite",props:{y:760,x:172,width:674,name:"chat",height:226},child:[{type:"Image",props:{y:15,x:25,width:633,skin:"myres/bothui/bf_chat.png",name:"bg",height:190,sizeGrid:"14,14,13,14"}},{type:"Label",props:{y:42,x:55,wordWrap:!0,width:578,text:"喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵",name:"info",leading:8,height:138,fontSize:29,font:"SimHei",color:"#cecece"}}]}]},{type:"Image",props:{y:576,x:971,width:1306,skin:"tanfang/character_bang_light.png",scaleY:4,scaleX:4,rotation:100,pivotY:578,pivotX:648,name:"chuxianlight",height:1084,alpha:1},compId:14},{type:"Image",props:{y:0,x:0,width:1920,skin:"tanfang/bbg.jpg",name:"chunbai",height:1080,alpha:1,sizeGrid:"1,1,1,1"},compId:33}]},{type:"Button",props:{y:145,x:1696,width:206,name:"btn_pass",height:110,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:12,x:15,width:147,skin:"myres/bothui/jump.png",scaleY:1.2,scaleX:1.2,name:"pass",height:69,alpha:1}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Sprite",props:{y:0,x:0,width:1920,name:"container_final_info",height:1080},child:[{type:"Image",props:{y:542,x:960,width:1920,skin:"tanfang/bg_result.png",name:"bg",height:644,anchorY:.5,anchorX:.5},compId:40},{type:"Image",props:{y:162,x:952,width:593,skin:"tanfang/title_result.png",scaleY:1.2,scaleX:1.2,name:"title",height:131,anchorY:.5,anchorX:.5},compId:44},{type:"Sprite",props:{y:309,x:391,width:1138,name:"tubiao",height:448},compId:53,child:[{type:"Sprite",props:{y:41,x:380,width:247,scaleY:1.5,scaleX:1.5,name:"item1",height:257},child:[{type:"Button",props:{y:112,x:122,width:214,pivotY:109,pivotX:109,name:"btn",height:214},child:[{type:"Image",props:{y:106,x:110,width:207,skin:"tanfang/gold_bound.png",name:"gold_bg",height:208,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:20,x:23,width:174,skin:"myres/kuangbg.png",name:"bg",height:172,sizeGrid:"7,7,8,7"}},{type:"Image",props:{y:20,x:23,width:174,skin:"extendRes/items/coin0.jpg",name:"icon_origin",height:172},child:[{type:"Label",props:{y:143,x:58,width:110,text:"999999",name:"count",height:27,fontSize:28,font:"SimHei",color:"#f0eccb",align:"right"}}]},{type:"Image",props:{y:20,x:23,width:174,skin:"extendRes/items/coin0.jpg",name:"icon_final",height:172},child:[{type:"Label",props:{y:143,x:58,width:110,text:"999999",name:"count",height:27,fontSize:28,font:"SimHei",color:"#f0eccb",align:"right"}}]},{type:"Image",props:{y:106,x:110,width:182,skin:"myres/kuangbound.png",name:"bound",height:182,anchorY:.5,anchorX:.5,sizeGrid:"18,20,12,12"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Label",props:{y:211,x:16,width:217,text:"二阶堂美树",name:"name_orgin",height:32,fontSize:28,font:"SimHei",color:"#f0eccb",align:"center"}},{type:"Label",props:{y:211,x:16,width:217,text:"二阶堂美树",name:"name_final",height:32,fontSize:28,font:"SimHei",color:"#f0eccb",align:"center"}}]},{type:"Sprite",props:{y:0,x:0,width:1196,name:"container10",height:472},child:[{type:"Sprite",props:{y:-13,x:-90,width:247,name:"item",height:257},child:[{type:"Button",props:{y:112,x:122,width:214,pivotY:109,pivotX:109,name:"btn",height:214},child:[{type:"Image",props:{y:106,x:110,width:207,skin:"tanfang/gold_bound.png",name:"gold_bg",height:208,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:20,x:23,width:174,skin:"myres/kuangbg.png",name:"bg",height:172,sizeGrid:"7,7,8,7"}},{type:"Image",props:{y:20,x:23,width:174,skin:"extendRes/items/coin0.jpg",name:"icon_origin",height:172},child:[{type:"Label",props:{y:143,x:58,width:110,text:"999999",name:"count",height:27,fontSize:28,font:"SimHei",color:"#f0eccb",align:"right"}}]},{type:"Image",props:{y:20,x:23,width:174,skin:"extendRes/items/coin0.jpg",name:"icon_final",height:172},child:[{type:"Label",props:{y:143,x:58,width:110,text:"999999",name:"count",height:27,fontSize:28,font:"SimHei",color:"#f0eccb",align:"right"}}]},{type:"Image",props:{y:106,x:110,width:182,skin:"myres/kuangbound.png",name:"bound",height:182,anchorY:.5,anchorX:.5,sizeGrid:"18,20,12,12"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Label",props:{y:211,x:16,width:217,text:"二阶堂美树",name:"name_orgin",height:32,fontSize:28,font:"SimHei",color:"#f0eccb",align:"center"}},{type:"Label",props:{y:211,x:16,width:217,text:"二阶堂美树",name:"name_final",height:32,fontSize:28,font:"SimHei",color:"#f0eccb",align:"center"}}]},{type:"Sprite",props:{y:-13,x:180,width:247,name:"item",height:257},child:[{type:"Button",props:{y:112,x:122,width:214,pivotY:109,pivotX:109,name:"btn",height:214},child:[{type:"Image",props:{y:106,x:110,width:207,skin:"tanfang/gold_bound.png",name:"gold_bg",height:208,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:20,x:23,width:174,skin:"myres/kuangbg.png",name:"bg",height:172,sizeGrid:"7,7,8,7"}},{type:"Image",props:{y:20,x:23,width:174,skin:"extendRes/items/coin0.jpg",name:"icon_origin",height:172},child:[{type:"Label",props:{y:143,x:58,width:110,text:"999999",name:"count",height:27,fontSize:28,font:"SimHei",color:"#f0eccb",align:"right"}}]},{type:"Image",props:{y:20,x:23,width:174,skin:"extendRes/items/coin0.jpg",name:"icon_final",height:172},child:[{type:"Label",props:{y:143,x:58,width:110,text:"999999",name:"count",height:27,fontSize:28,font:"SimHei",color:"#f0eccb",align:"right"}}]},{type:"Image",props:{y:106,x:110,width:182,skin:"myres/kuangbound.png",name:"bound",height:182,anchorY:.5,anchorX:.5,sizeGrid:"18,20,12,12"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Label",props:{y:211,x:16,width:217,text:"二阶堂美树",name:"name_orgin",height:32,fontSize:28,font:"SimHei",color:"#f0eccb",align:"center"}},{type:"Label",props:{y:211,x:16,width:217,text:"二阶堂美树",name:"name_final",height:32,fontSize:28,font:"SimHei",color:"#f0eccb",align:"center"}}]},{type:"Sprite",props:{y:-13,x:450,width:247,name:"item",height:257},child:[{type:"Button",props:{y:112,x:122,width:214,pivotY:109,pivotX:109,name:"btn",height:214},child:[{type:"Image",props:{y:106,x:110,width:207,skin:"tanfang/gold_bound.png",name:"gold_bg",height:208,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:20,x:23,width:174,skin:"myres/kuangbg.png",name:"bg",height:172,sizeGrid:"7,7,8,7"}},{type:"Image",props:{y:20,x:23,width:174,skin:"extendRes/items/coin0.jpg",name:"icon_origin",height:172},child:[{type:"Label",props:{y:143,x:58,width:110,text:"999999",name:"count",height:27,fontSize:28,font:"SimHei",color:"#f0eccb",align:"right"}}]},{type:"Image",props:{y:20,x:23,width:174,skin:"extendRes/items/coin0.jpg",name:"icon_final",height:172},child:[{type:"Label",props:{y:143,x:58,width:110,text:"999999",name:"count",height:27,fontSize:28,font:"SimHei",color:"#f0eccb",align:"right"}}]},{type:"Image",props:{y:106,x:110,width:182,skin:"myres/kuangbound.png",name:"bound",height:182,anchorY:.5,anchorX:.5,sizeGrid:"18,20,12,12"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Label",props:{y:211,x:16,width:217,text:"二阶堂美树",name:"name_orgin",height:32,fontSize:28,font:"SimHei",color:"#f0eccb",align:"center"}},{type:"Label",props:{y:211,x:16,width:217,text:"二阶堂美树",name:"name_final",height:32,fontSize:28,font:"SimHei",color:"#f0eccb",align:"center"}}]},{type:"Sprite",props:{y:-13,x:720,width:247,name:"item",height:257},child:[{type:"Button",props:{y:112,x:122,width:214,pivotY:109,pivotX:109,name:"btn",height:214},child:[{type:"Image",props:{y:106,x:110,width:207,skin:"tanfang/gold_bound.png",name:"gold_bg",height:208,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:20,x:23,width:174,skin:"myres/kuangbg.png",name:"bg",height:172,sizeGrid:"7,7,8,7"}},{type:"Image",props:{y:20,x:23,width:174,skin:"extendRes/items/coin0.jpg",name:"icon_origin",height:172},child:[{type:"Label",props:{y:143,x:58,width:110,text:"999999",name:"count",height:27,fontSize:28,font:"SimHei",color:"#f0eccb",align:"right"}}]},{type:"Image",props:{y:20,x:23,width:174,skin:"extendRes/items/coin0.jpg",name:"icon_final",height:172},child:[{type:"Label",props:{y:143,x:58,width:110,text:"999999",name:"count",height:27,fontSize:28,font:"SimHei",color:"#f0eccb",align:"right"}}]},{type:"Image",props:{y:106,x:110,width:182,skin:"myres/kuangbound.png",name:"bound",height:182,anchorY:.5,anchorX:.5,sizeGrid:"18,20,12,12"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Label",props:{y:211,x:16,width:217,text:"二阶堂美树",name:"name_orgin",height:32,fontSize:28,font:"SimHei",color:"#f0eccb",align:"center"}},{type:"Label",props:{y:211,x:16,width:217,text:"二阶堂美树",name:"name_final",height:32,fontSize:28,font:"SimHei",color:"#f0eccb",align:"center"}}]},{type:"Sprite",props:{y:-13,x:990,width:247,name:"item",height:257},child:[{type:"Button",props:{y:112,x:122,width:214,pivotY:109,pivotX:109,name:"btn",height:214},child:[{type:"Image",props:{y:106,x:110,width:207,skin:"tanfang/gold_bound.png",name:"gold_bg",height:208,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:20,x:23,width:174,skin:"myres/kuangbg.png",name:"bg",height:172,sizeGrid:"7,7,8,7"}},{type:"Image",props:{y:20,x:23,width:174,skin:"extendRes/items/coin0.jpg",name:"icon_origin",height:172},child:[{type:"Label",props:{y:143,x:58,width:110,text:"999999",name:"count",height:27,fontSize:28,font:"SimHei",color:"#f0eccb",align:"right"}}]},{type:"Image",props:{y:20,x:23,width:174,skin:"extendRes/items/coin0.jpg",name:"icon_final",height:172},child:[{type:"Label",props:{y:143,x:58,width:110,text:"999999",name:"count",height:27,fontSize:28,font:"SimHei",color:"#f0eccb",align:"right"}}]},{type:"Image",props:{y:106,x:110,width:182,skin:"myres/kuangbound.png",name:"bound",height:182,anchorY:.5,anchorX:.5,sizeGrid:"18,20,12,12"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Label",props:{y:211,x:16,width:217,text:"二阶堂美树",name:"name_orgin",height:32,fontSize:28,font:"SimHei",color:"#f0eccb",align:"center"}},{type:"Label",props:{y:211,x:16,width:217,text:"二阶堂美树",name:"name_final",height:32,fontSize:28,font:"SimHei",color:"#f0eccb",align:"center"}}]},{type:"Sprite",props:{y:266,x:-90,width:247,name:"item",height:257},child:[{type:"Button",props:{y:112,x:122,width:214,pivotY:109,pivotX:109,name:"btn",height:214},child:[{type:"Image",props:{y:106,x:110,width:207,skin:"tanfang/gold_bound.png",name:"gold_bg",height:208,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:20,x:23,width:174,skin:"myres/kuangbg.png",name:"bg",height:172,sizeGrid:"7,7,8,7"}},{type:"Image",props:{y:20,x:23,width:174,skin:"extendRes/items/coin0.jpg",name:"icon_origin",height:172},child:[{type:"Label",props:{y:143,x:58,width:110,text:"999999",name:"count",height:27,fontSize:28,font:"SimHei",color:"#f0eccb",align:"right"}}]},{type:"Image",props:{y:20,x:23,width:174,skin:"extendRes/items/coin0.jpg",name:"icon_final",height:172},child:[{type:"Label",props:{y:143,x:58,width:110,text:"999999",name:"count",height:27,fontSize:28,font:"SimHei",color:"#f0eccb",align:"right"}}]},{type:"Image",props:{y:106,x:110,width:182,skin:"myres/kuangbound.png",name:"bound",height:182,anchorY:.5,anchorX:.5,sizeGrid:"18,20,12,12"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Label",props:{y:211,x:16,width:217,text:"二阶堂美树",name:"name_orgin",height:32,fontSize:28,font:"SimHei",color:"#f0eccb",align:"center"}},{type:"Label",props:{y:211,x:16,width:217,text:"二阶堂美树",name:"name_final",height:32,fontSize:28,font:"SimHei",color:"#f0eccb",align:"center"}}]},{type:"Sprite",props:{y:266,x:180,width:247,name:"item",height:257},child:[{type:"Button",props:{y:112,x:122,width:214,pivotY:109,pivotX:109,name:"btn",height:214},child:[{type:"Image",props:{y:106,x:110,width:207,skin:"tanfang/gold_bound.png",name:"gold_bg",height:208,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:20,x:23,width:174,skin:"myres/kuangbg.png",name:"bg",height:172,sizeGrid:"7,7,8,7"}},{type:"Image",props:{y:20,x:23,width:174,skin:"extendRes/items/coin0.jpg",name:"icon_origin",height:172},child:[{type:"Label",props:{y:143,x:58,width:110,text:"999999",name:"count",height:27,fontSize:28,font:"SimHei",color:"#f0eccb",align:"right"}}]},{type:"Image",props:{y:20,x:23,width:174,skin:"extendRes/items/coin0.jpg",name:"icon_final",height:172},child:[{type:"Label",props:{y:143,x:58,width:110,text:"999999",name:"count",height:27,fontSize:28,font:"SimHei",color:"#f0eccb",align:"right"}}]},{type:"Image",props:{y:106,x:110,width:182,skin:"myres/kuangbound.png",name:"bound",height:182,anchorY:.5,anchorX:.5,sizeGrid:"18,20,12,12"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Label",props:{y:211,x:16,width:217,text:"二阶堂美树",name:"name_orgin",height:32,fontSize:28,font:"SimHei",color:"#f0eccb",align:"center"}},{type:"Label",props:{y:211,x:16,width:217,text:"二阶堂美树",name:"name_final",height:32,fontSize:28,font:"SimHei",color:"#f0eccb",align:"center"}}]},{type:"Sprite",props:{y:266,x:450,width:247,name:"item",height:257},child:[{type:"Button",props:{y:112,x:122,width:214,pivotY:109,pivotX:109,name:"btn",height:214},child:[{type:"Image",props:{y:106,x:110,width:207,skin:"tanfang/gold_bound.png",name:"gold_bg",height:208,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:20,x:23,width:174,skin:"myres/kuangbg.png",name:"bg",height:172,sizeGrid:"7,7,8,7"}},{type:"Image",props:{y:20,x:23,width:174,skin:"extendRes/items/coin0.jpg",name:"icon_origin",height:172},child:[{type:"Label",props:{y:143,x:58,width:110,text:"999999",name:"count",height:27,fontSize:28,font:"SimHei",color:"#f0eccb",align:"right"}}]},{type:"Image",props:{y:20,x:23,width:174,skin:"extendRes/items/coin0.jpg",name:"icon_final",height:172},child:[{type:"Label",props:{y:143,x:58,width:110,text:"999999",name:"count",height:27,fontSize:28,font:"SimHei",color:"#f0eccb",align:"right"}}]},{type:"Image",props:{y:106,x:110,width:182,skin:"myres/kuangbound.png",name:"bound",height:182,anchorY:.5,anchorX:.5,sizeGrid:"18,20,12,12"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Label",props:{y:211,x:16,width:217,text:"二阶堂美树",name:"name_orgin",height:32,fontSize:28,font:"SimHei",color:"#f0eccb",align:"center"}},{type:"Label",props:{y:211,x:16,width:217,text:"二阶堂美树",name:"name_final",height:32,fontSize:28,font:"SimHei",color:"#f0eccb",align:"center"}}]},{type:"Sprite",props:{y:266,x:720,width:247,name:"item",height:257},child:[{type:"Button",props:{y:112,x:122,width:214,pivotY:109,pivotX:109,name:"btn",height:214},child:[{type:"Image",props:{y:106,x:110,width:207,skin:"tanfang/gold_bound.png",name:"gold_bg",height:208,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:20,x:23,width:174,skin:"myres/kuangbg.png",name:"bg",height:172,sizeGrid:"7,7,8,7"}},{type:"Image",props:{y:20,x:23,width:174,skin:"extendRes/items/coin0.jpg",name:"icon_origin",height:172},child:[{type:"Label",props:{y:143,x:58,width:110,text:"999999",name:"count",height:27,fontSize:28,font:"SimHei",color:"#f0eccb",align:"right"}}]},{type:"Image",props:{y:20,x:23,width:174,skin:"extendRes/items/coin0.jpg",name:"icon_final",height:172},child:[{type:"Label",props:{y:143,x:58,width:110,text:"999999",name:"count",height:27,fontSize:28,font:"SimHei",color:"#f0eccb",align:"right"}}]},{type:"Image",props:{y:106,x:110,width:182,skin:"myres/kuangbound.png",name:"bound",height:182,anchorY:.5,anchorX:.5,sizeGrid:"18,20,12,12"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Label",props:{y:211,x:16,width:217,text:"二阶堂美树",name:"name_orgin",height:32,fontSize:28,font:"SimHei",color:"#f0eccb",align:"center"}},{type:"Label",props:{y:211,x:16,width:217,text:"二阶堂美树",name:"name_final",height:32,fontSize:28,font:"SimHei",color:"#f0eccb",align:"center"}}]},{type:"Sprite",props:{y:266,x:990,width:247,name:"item",height:257},child:[{type:"Button",props:{y:112,x:122,width:214,pivotY:109,pivotX:109,name:"btn",height:214},child:[{type:"Image",props:{y:106,x:110,width:207,skin:"tanfang/gold_bound.png",name:"gold_bg",height:208,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:20,x:23,width:174,skin:"myres/kuangbg.png",name:"bg",height:172,sizeGrid:"7,7,8,7"}},{type:"Image",props:{y:20,x:23,width:174,skin:"extendRes/items/coin0.jpg",name:"icon_origin",height:172},child:[{type:"Label",props:{y:143,x:58,width:110,text:"999999",name:"count",height:27,fontSize:28,font:"SimHei",color:"#f0eccb",align:"right"}}]},{type:"Image",props:{y:20,x:23,width:174,skin:"extendRes/items/coin0.jpg",name:"icon_final",height:172},child:[{type:"Label",props:{y:143,x:58,width:110,text:"999999",name:"count",height:27,fontSize:28,font:"SimHei",color:"#f0eccb",align:"right"}}]},{type:"Image",props:{y:106,x:110,width:182,skin:"myres/kuangbound.png",name:"bound",height:182,anchorY:.5,anchorX:.5,sizeGrid:"18,20,12,12"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Label",props:{y:211,x:16,width:217,text:"二阶堂美树",name:"name_orgin",height:32,fontSize:28,font:"SimHei",color:"#f0eccb",align:"center"}},{type:"Label",props:{y:211,x:16,width:217,text:"二阶堂美树",name:"name_final",height:32,fontSize:28,font:"SimHei",color:"#f0eccb",align:"center"}}]}]}]},{type:"Button",props:{y:952,x:968,width:272,stateNum:1,skin:"myres/bothui/gift_btn.png",name:"confirm",height:98,anchorY:.5,anchorX:.5,sizeGrid:"0,68,0,51"},compId:106,child:[{type:"Label",props:{y:12,x:79,width:86,text:"确定",scaleY:1.4,scaleX:1.4,height:53,font:"fengyu",color:"#1e0b1d"}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]},{type:"Image",props:{y:0,x:0,width:1424,skin:"tanfang/left_tree.png",name:"left_tree",height:1080,alpha:1},compId:54},{type:"Image",props:{y:0,x:678,width:1242,skin:"tanfang/right_tree.png",name:"right_tree",height:1080,alpha:1},compId:55},{type:"Sprite",props:{y:525,x:961,name:"effect_juese"}}],animations:[{nodes:[{target:24,keyframes:{x:[{value:261,tweenMethod:"linearNone",tween:!0,target:24,label:null,key:"x",index:0},{value:261,tweenMethod:"linearNone",tween:!0,target:24,key:"x",index:5},{value:261,tweenMethod:"linearNone",tween:!0,target:24,label:null,key:"x",index:7}],scaleY:[{value:0,tweenMethod:"linearNone",tween:!0,target:24,key:"scaleY",index:0},{value:.5,tweenMethod:"linearNone",tween:!0,target:24,key:"scaleY",index:5},{value:1,tweenMethod:"linearNone",tween:!0,target:24,label:null,key:"scaleY",index:7}],scaleX:[{value:0,tweenMethod:"linearNone",tween:!0,target:24,key:"scaleX",index:0},{value:.5,tweenMethod:"linearNone",tween:!0,target:24,key:"scaleX",index:5},{value:1,tweenMethod:"linearNone",tween:!0,target:24,label:null,key:"scaleX",index:7}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:24,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:24,key:"alpha",index:5},{value:1,tweenMethod:"linearNone",tween:!0,target:24,label:null,key:"alpha",index:7}]}},{target:25,keyframes:{x:[{value:261,tweenMethod:"linearNone",tween:!0,target:25,label:null,key:"x",index:0},{value:261,tweenMethod:"linearNone",tween:!0,target:25,label:null,key:"x",index:5},{value:261,tweenMethod:"linearNone",tween:!0,target:25,label:null,key:"x",index:7}],scaleY:[{value:0,tweenMethod:"linearNone",tween:!0,target:25,key:"scaleY",index:0},{value:.5,tweenMethod:"linearNone",tween:!0,target:25,key:"scaleY",index:5},{value:1,tweenMethod:"linearNone",tween:!0,target:25,label:null,key:"scaleY",index:7}],scaleX:[{value:0,tweenMethod:"linearNone",tween:!0,target:25,key:"scaleX",index:0},{value:.5,tweenMethod:"linearNone",tween:!0,target:25,key:"scaleX",index:5},{value:1,tweenMethod:"linearNone",tween:!0,target:25,label:null,key:"scaleX",index:7}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:25,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:25,key:"alpha",index:5},{value:1,tweenMethod:"linearNone",tween:!0,target:25,label:null,key:"alpha",index:7}]}},{target:10,keyframes:{x:[{value:261,tweenMethod:"linearNone",tween:!0,target:10,label:null,key:"x",index:0},{value:261,tweenMethod:"linearNone",tween:!0,target:10,label:null,key:"x",index:5},{value:261,tweenMethod:"linearNone",tween:!0,target:10,label:null,key:"x",index:7}],scaleY:[{value:.2,tweenMethod:"linearNone",tween:!0,target:10,label:null,key:"scaleY",index:0},{value:.5,tweenMethod:"linearNone",tween:!0,target:10,key:"scaleY",index:5},{value:1,tweenMethod:"linearNone",tween:!0,target:10,label:null,key:"scaleY",index:7}],scaleX:[{value:.2,tweenMethod:"linearNone",tween:!0,target:10,label:null,key:"scaleX",index:0},{value:.5,tweenMethod:"linearNone",tween:!0,target:10,key:"scaleX",index:5},{value:1,tweenMethod:"linearNone",tween:!0,target:10,label:null,key:"scaleX",index:7}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:10,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:10,key:"alpha",index:5},{value:1,tweenMethod:"linearNone",tween:!0,target:10,label:null,key:"alpha",index:7}]}},{target:114,keyframes:{scaleY:[{value:.4,tweenMethod:"linearNone",tween:!0,target:114,key:"scaleY",index:0},{value:1.25,tweenMethod:"linearNone",tween:!0,target:114,label:null,key:"scaleY",index:5},{value:1,tweenMethod:"linearNone",tween:!0,target:114,key:"scaleY",index:7}],scaleX:[{value:.4,tweenMethod:"linearNone",tween:!0,target:114,key:"scaleX",index:0},{value:1.25,tweenMethod:"linearNone",tween:!0,target:114,label:null,key:"scaleX",index:5},{value:1,tweenMethod:"linearNone",tween:!0,target:114,key:"scaleX",index:7}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:114,key:"alpha",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:114,label:null,key:"alpha",index:5},{value:1,tweenMethod:"linearNone",tween:!0,target:114,key:"alpha",index:7}]}}],name:"WPin",id:2,frameRate:24,action:0},{nodes:[{target:29,keyframes:{y:[{value:574,tweenMethod:"circIn",tween:!0,target:29,label:null,key:"y",index:0},{value:483,tweenMethod:"strongOut",tween:!0,target:29,label:null,key:"y",index:5}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:29,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:29,key:"alpha",index:5}]}}],name:"WPout",id:2,frameRate:24,action:0},{nodes:[{target:26,keyframes:{x:[{value:777,tweenMethod:"linearNone",tween:!0,target:26,key:"x",index:0},{value:777,tweenMethod:"linearNone",tween:!0,target:26,label:null,key:"x",index:10},{value:777,tweenMethod:"linearNone",tween:!0,target:26,label:null,key:"x",index:63}],alpha:[{value:0,tweenMethod:"strongIn",tween:!0,target:26,key:"alpha",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:26,key:"alpha",index:10},{value:1,tweenMethod:"linearNone",tween:!0,target:26,label:null,key:"alpha",index:63}]}},{target:14,keyframes:{scaleY:[{value:.9,tweenMethod:"linearNone",tween:!0,target:14,key:"scaleY",index:0},{value:.9,tweenMethod:"linearNone",tween:!0,target:14,key:"scaleY",index:42},{value:1,tweenMethod:"strongIn",tween:!0,target:14,label:null,key:"scaleY",index:45},{value:4,tweenMethod:"linearNone",tween:!0,target:14,key:"scaleY",index:63},{value:4,tweenMethod:"linearNone",tween:!0,target:14,label:null,key:"scaleY",index:90},{value:4,tweenMethod:"linearNone",tween:!0,target:14,label:null,key:"scaleY",index:100}],scaleX:[{value:.9,tweenMethod:"linearNone",tween:!0,target:14,key:"scaleX",index:0},{value:.9,tweenMethod:"linearNone",tween:!0,target:14,key:"scaleX",index:42},{value:1,tweenMethod:"strongIn",tween:!0,target:14,label:null,key:"scaleX",index:45},{value:4,tweenMethod:"linearNone",tween:!0,target:14,key:"scaleX",index:63},{value:4,tweenMethod:"linearNone",tween:!0,target:14,label:null,key:"scaleX",index:90},{value:4,tweenMethod:"linearNone",tween:!0,target:14,label:null,key:"scaleX",index:100}],rotation:[{value:0,tweenMethod:"linearNone",tween:!0,target:14,key:"rotation",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:14,key:"rotation",index:42},{value:0,tweenMethod:"strongIn",tween:!0,target:14,key:"rotation",index:45},{value:100,tweenMethod:"linearNone",tween:!0,target:14,key:"rotation",index:63}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:14,key:"alpha",index:0},{value:0,tweenMethod:"strongOut",tween:!0,target:14,key:"alpha",index:42},{value:1,tweenMethod:"linearNone",tween:!0,target:14,label:null,key:"alpha",index:45},{value:1,tweenMethod:"linearNone",tween:!0,target:14,key:"alpha",index:90},{value:0,tweenMethod:"linearNone",tween:!0,target:14,label:null,key:"alpha",index:100}]}},{target:33,keyframes:{alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:33,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:33,key:"alpha",index:58},{value:1,tweenMethod:"linearNone",tween:!0,target:33,key:"alpha",index:73},{value:1,tweenMethod:"linearNone",tween:!0,target:33,label:null,key:"alpha",index:86},{value:0,tweenMethod:"linearNone",tween:!0,target:33,label:null,key:"alpha",index:100}]}},{target:32,keyframes:{x:[{value:434,tweenMethod:"linearNone",tween:!0,target:32,key:"x",index:0},{value:434,tweenMethod:"linearNone",tween:!0,target:32,key:"x",index:78},{value:434,tweenMethod:"linearNone",tween:!0,target:32,label:null,key:"x",index:79}],visible:[{value:!1,tweenMethod:"linearNone",tween:!1,target:32,key:"visible",index:0},{value:!1,tweenMethod:"linearNone",tween:!1,target:32,key:"visible",index:78},{value:!0,tweenMethod:"linearNone",tween:!1,target:32,key:"visible",index:79}]}},{target:9,keyframes:{y:[{value:188,tweenMethod:"linearNone",tween:!0,target:9,key:"y",index:0},{value:188,tweenMethod:"linearNone",tween:!0,target:9,key:"y",index:111},{value:138,tweenMethod:"linearNone",tween:!0,target:9,key:"y",index:117}],x:[{value:87,tweenMethod:"linearNone",tween:!0,target:9,key:"x",index:0},{value:87,tweenMethod:"linearNone",tween:!0,target:9,label:null,key:"x",index:111},{value:87,tweenMethod:"linearNone",tween:!0,target:9,key:"x",index:117}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:9,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:9,key:"alpha",index:111},{value:1,tweenMethod:"linearNone",tween:!0,target:9,key:"alpha",index:117}]}},{target:112,keyframes:{x:[{value:97,tweenMethod:"linearNone",tween:!0,target:112,key:"x",index:0},{value:97,tweenMethod:"linearNone",tween:!0,target:112,key:"x",index:119},{value:97,tweenMethod:"linearNone",tween:!0,target:112,label:null,key:"x",index:124}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:112,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:112,key:"alpha",index:119},{value:1,tweenMethod:"linearNone",tween:!0,target:112,key:"alpha",index:124}]}},{target:8,keyframes:{y:[{value:393,tweenMethod:"linearNone",tween:!0,target:8,key:"y",index:0},{value:393,tweenMethod:"linearNone",tween:!0,target:8,key:"y",index:132},{value:343,tweenMethod:"linearNone",tween:!0,target:8,key:"y",index:139}],x:[{value:52,tweenMethod:"linearNone",tween:!0,target:8,key:"x",index:0},{value:52,tweenMethod:"linearNone",tween:!0,target:8,key:"x",index:132},{value:52,tweenMethod:"linearNone",tween:!0,target:8,label:null,key:"x",index:139}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:8,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:8,key:"alpha",index:132},{value:1,tweenMethod:"linearNone",tween:!0,target:8,key:"alpha",index:139}]}},{target:113,keyframes:{x:[{value:48,tweenMethod:"linearNone",tween:!0,target:113,key:"x",index:0},{value:48,tweenMethod:"linearNone",tween:!0,target:113,key:"x",index:142},{value:48,tweenMethod:"linearNone",tween:!0,target:113,label:null,key:"x",index:150}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:113,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:113,key:"alpha",index:142},{value:1,tweenMethod:"linearNone",tween:!0,target:113,key:"alpha",index:150}]}}],name:"JSin",id:3,frameRate:24,action:0},{nodes:[{target:32,keyframes:{y:[{value:-8,tweenMethod:"linearNone",tween:!0,target:32,key:"y",index:0},{value:-79,tweenMethod:"linearNone",tween:!0,target:32,key:"y",index:5}],x:[{value:434,tweenMethod:"linearNone",tween:!0,target:32,key:"x",index:0},{value:434,tweenMethod:"linearNone",tween:!0,target:32,label:null,key:"x",index:5}],visible:[{value:!0,tweenMethod:"linearNone",tween:!1,target:32,key:"visible",index:0},{value:!0,tweenMethod:"linearNone",tween:!1,target:32,label:null,key:"visible",index:5}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:32,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:32,key:"alpha",index:5}]}},{target:26,keyframes:{alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:26,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:26,key:"alpha",index:5}]}}],name:"JSout",id:4,frameRate:24,action:0},{nodes:[{target:40,keyframes:{x:[{value:960,tweenMethod:"linearNone",tween:!0,target:40,key:"x",index:0},{value:960,tweenMethod:"linearNone",tween:!0,target:40,label:null,key:"x",index:5}],scaleY:[{value:0,tweenMethod:"linearNone",tween:!0,target:40,key:"scaleY",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:40,key:"scaleY",index:5}]}},{target:44,keyframes:{x:[{value:952,tweenMethod:"linearNone",tween:!0,target:44,key:"x",index:0},{value:952,tweenMethod:"linearNone",tween:!0,target:44,key:"x",index:6},{value:952,tweenMethod:"linearNone",tween:!0,target:44,label:null,key:"x",index:10}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:44,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:44,key:"alpha",index:6},{value:1,tweenMethod:"linearNone",tween:!0,target:44,key:"alpha",index:10}]}},{target:53,keyframes:{x:[{value:391,tweenMethod:"linearNone",tween:!0,target:53,key:"x",index:0},{value:391,tweenMethod:"linearNone",tween:!0,target:53,key:"x",index:10},{value:391,tweenMethod:"linearNone",tween:!0,target:53,label:null,key:"x",index:14}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:53,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:53,key:"alpha",index:10},{value:1,tweenMethod:"linearNone",tween:!0,target:53,key:"alpha",index:14}]}},{target:106,keyframes:{visible:[{value:!1,tweenMethod:"linearNone",tween:!1,target:106,key:"visible",index:0},{value:!0,tweenMethod:"linearNone",tween:!1,target:106,key:"visible",index:18}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:106,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:106,key:"alpha",index:18},{value:1,tweenMethod:"linearNone",tween:!0,target:106,key:"alpha",index:22}]}}],name:"XMJGin",id:5,frameRate:24,action:0},{nodes:[{target:53,keyframes:{x:[{value:391,tweenMethod:"linearNone",tween:!0,target:53,key:"x",index:0},{value:391,tweenMethod:"linearNone",tween:!0,target:53,label:null,key:"x",index:3}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:53,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:53,key:"alpha",index:3}]}},{target:44,keyframes:{x:[{value:952,tweenMethod:"linearNone",tween:!0,target:44,key:"x",index:0},{value:952,tweenMethod:"linearNone",tween:!0,target:44,label:null,key:"x",index:2},{value:952,tweenMethod:"linearNone",tween:!0,target:44,label:null,key:"x",index:5}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:44,key:"alpha",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:44,key:"alpha",index:2},{value:0,tweenMethod:"linearNone",tween:!0,target:44,key:"alpha",index:5}]}},{target:40,keyframes:{x:[{value:960,tweenMethod:"linearNone",tween:!0,target:40,key:"x",index:0},{value:960,tweenMethod:"linearNone",tween:!0,target:40,label:null,key:"x",index:5},{value:960,tweenMethod:"linearNone",tween:!0,target:40,label:null,key:"x",index:8}],scaleY:[{value:1,tweenMethod:"linearNone",tween:!0,target:40,key:"scaleY",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:40,key:"scaleY",index:5},{value:0,tweenMethod:"linearNone",tween:!0,target:40,key:"scaleY",index:8}]}}],name:"XMJGout",id:6,frameRate:24,action:0},{nodes:[{target:13,keyframes:{x:[{value:511,tweenMethod:"linearNone",tween:!0,target:13,key:"x",index:0},{value:511,tweenMethod:"linearNone",tween:!0,target:13,label:null,key:"x",index:3}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:13,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:13,key:"alpha",index:3}]}},{target:60,keyframes:{x:[{value:0,tweenMethod:"linearNone",tween:!0,target:60,key:"x",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:60,label:null,key:"x",index:1},{value:0,tweenMethod:"linearNone",tween:!0,target:60,key:"x",index:5}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:60,key:"alpha",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:60,key:"alpha",index:1},{value:0,tweenMethod:"linearNone",tween:!0,target:60,key:"alpha",index:5}]}}],name:"XMout",id:7,frameRate:24,action:0},{nodes:[{target:13,keyframes:{x:[{value:511,tweenMethod:"linearNone",tween:!0,target:13,key:"x",index:0},{value:511,tweenMethod:"linearNone",tween:!0,target:13,label:null,key:"x",index:7},{value:511,tweenMethod:"linearNone",tween:!0,target:13,label:null,key:"x",index:9}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:13,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:13,key:"alpha",index:7},{value:1,tweenMethod:"linearNone",tween:!0,target:13,label:null,key:"alpha",index:9}]}},{target:54,keyframes:{x:[{value:-1500,tweenMethod:"strongOut",tween:!0,target:54,label:null,key:"x",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:54,label:null,key:"x",index:7},{value:0,tweenMethod:"strongIn",tween:!0,target:54,label:null,key:"x",index:20},{value:-1500,tweenMethod:"linearNone",tween:!0,target:54,label:null,key:"x",index:30}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:54,label:null,key:"alpha",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:54,key:"alpha",index:7},{value:1,tweenMethod:"linearNone",tween:!0,target:54,label:null,key:"alpha",index:20},{value:1,tweenMethod:"linearNone",tween:!0,target:54,label:null,key:"alpha",index:30}]}},{target:55,keyframes:{x:[{value:1978,tweenMethod:"strongOut",tween:!0,target:55,label:null,key:"x",index:0},{value:678,tweenMethod:"linearNone",tween:!0,target:55,label:null,key:"x",index:7},{value:678,tweenMethod:"strongIn",tween:!0,target:55,label:null,key:"x",index:20},{value:1978,tweenMethod:"linearNone",tween:!0,target:55,label:null,key:"x",index:30}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:55,label:null,key:"alpha",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:55,key:"alpha",index:7},{value:1,tweenMethod:"linearNone",tween:!0,target:55,label:null,key:"alpha",index:20},{value:1,tweenMethod:"linearNone",tween:!0,target:55,label:null,key:"alpha",index:30}]}},{target:60,keyframes:{alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:60,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:60,key:"alpha",index:7},{value:1,tweenMethod:"linearNone",tween:!0,target:60,key:"alpha",index:9}]}}],name:"XMin_new",id:1,frameRate:24,action:0},{nodes:[{target:20,keyframes:{x:[{value:354,tweenMethod:"linearNone",tween:!0,target:20,key:"x",index:0},{value:354,tweenMethod:"linearNone",tween:!0,target:20,key:"x",index:25},{value:354,tweenMethod:"linearNone",tween:!0,target:20,label:null,key:"x",index:35}],alpha:[{value:.3,tweenMethod:"linearNone",tween:!0,target:20,key:"alpha",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:20,key:"alpha",index:25},{value:1,tweenMethod:"linearNone",tween:!0,target:20,label:null,key:"alpha",index:35},{value:.3,tweenMethod:"linearNone",tween:!0,target:20,key:"alpha",index:60},{value:.3,tweenMethod:"linearNone",tween:!0,target:20,label:null,key:"alpha",index:70}]}}],name:"light",id:8,frameRate:24,action:0}]},i}(View);t.tangfang1UI=i}(e.lobby||(e.lobby={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.UICopy",capsui.UICopy),View.regComponent("capsui.CScrollView",capsui.CScrollView),View.regComponent("capsui.CButton",capsui.CButton),t.prototype.createChildren.call(this),this.createView(e.lobby.titlebookUI.uiView)},i.uiView={type:"View",props:{width:1920,mouseThrough:!1,height:1080},child:[{type:"Image",props:{y:-50,x:-50,width:2020,skin:"myres/bbg.png",name:"bmask",height:1180,alpha:.3,sizeGrid:"1,1,1,1"},child:[{type:"Button",props:{width:2020,name:"btn",height:1180}},{type:"Sprite",props:{y:240,x:351,width:1258,name:"unhit",height:813}}]},{type:"Sprite",props:{y:605,x:928,width:1258,pivotY:412,pivotX:626,name:"root",height:813},child:[{type:"Image",props:{width:1258,skin:"myres/pop2_bg.png",name:"bg0",height:813,sizeGrid:"2,2,2,2"},child:[{type:"Image",props:{y:126,width:1258,skin:"myres/pop_black.png",name:"bar",height:691}},{type:"Image",props:{y:0,x:0,width:1258,skin:"myres/pop_black.png",name:"bar",height:117}}]},{type:"Image",props:{y:0,x:0,width:1258,skin:"myres/pop2_bound.png",name:"bound",height:813,sizeGrid:"24,27,11,21"}},{type:"Label",props:{y:8,x:542,width:165,valign:"middle",text:"称号簿",name:"titlebook",height:76,fontSize:45,font:"fengyu",color:"#e8af71",align:"center"}},{type:"Label",props:{y:62,x:37,wordWrap:!0,width:142,text:"已获得",name:"owned",height:45,fontSize:36,font:"SimHei",color:"#505775"}},{type:"Sprite",props:{y:127,x:19,width:1222,name:"content",height:671},child:[{type:"Panel",props:{y:0,x:0,width:1222,name:"content",height:664},child:[{type:"Sprite",props:{y:6,x:-1,width:1218,name:"templete",height:85},child:[{type:"Image",props:{y:-2,x:-1,width:405.6,skin:"extendRes/title/yuanchuzhihuo.png",name:"img_title",height:78}},{type:"Image",props:{y:-28,x:1012,width:151,skin:"myres/lobby/using.png",name:"using",height:115}},{type:"Image",props:{y:84,x:16,width:1204,skin:"myres/lobby/title_spilit.png",name:"split",height:6}},{type:"Label",props:{y:3,x:461,wordWrap:!0,width:490,valign:"middle",text:"称号获取方式两排称号获取方式两排称号获取方式两排",name:"desc",height:78,fontSize:32,font:"SimHei",color:"#cfcfcf"}},{type:"Script",props:{runtime:"capsui.UICopy"}},{type:"Button",props:{y:-10,x:-1,width:1227,name:"btn",height:97}}]}]},{type:"Script",props:{runtime:"capsui.CScrollView"}}]},{type:"Button",props:{y:31,x:1225,width:80,name:"btn_close",height:80,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:19,x:17,skin:"myres/pop2_close.png",name:"close"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Label",props:{y:147,x:282,width:702,valign:"middle",text:"称号簿空空，快去收集吧",name:"noinfo",height:76,fontSize:35,font:"SimHei",color:"#e8af71",align:"center"}}]}]},i}(View);t.titlebookUI=i}(e.lobby||(e.lobby={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.CButton",capsui.CButton),View.regComponent("capsui.UICopy",capsui.UICopy),View.regComponent("capsui.CScrollView",capsui.CScrollView),t.prototype.createChildren.call(this),this.createView(e.lobby.treasureUI.uiView)},i.uiView={type:"View",props:{x:0,width:1920,height:1080},child:[{type:"Sprite",props:{y:136,x:94,width:1789,name:"content",height:923},child:[{type:"Image",props:{y:388,x:1048,width:727,skin:"myres/treasure/treasure_bg.png",name:"container10",height:510,sizeGrid:"37,29,38,30"},child:[{type:"Label",props:{y:16,x:293,width:194,text:"寻觅10次",scaleY:.8,scaleX:.8,height:54,font:"fengyu",color:"#f9f6f6",align:"center"}},{type:"Label",props:{y:131,x:225,width:133,text:"获得",scaleY:.8,scaleX:.8,height:46,fontSize:40,font:"SimHei",color:"#f9f6f6",align:"center"}},{type:"Label",props:{y:131,x:391,width:133,text:"x10",scaleY:.8,scaleX:.8,height:46,fontSize:45,font:"SimHei",color:"#f9f6f6",bold:!0,align:"center"}},{type:"Label",props:{y:221,x:167,width:460,text:"可获得角色，装扮，礼物",scaleY:.8,scaleX:.8,height:46,fontSize:40,font:"SimHei",color:"#f9f6f6",align:"center"}},{type:"Image",props:{y:113,x:334,width:67,skin:"myres/lobby/xycoin.png",name:"icon",height:67}},{type:"Button",props:{y:417,x:366,width:558,stateNum:1,skin:"myres/treasure/treasure_btn.png",name:"btn_tanfang",height:155,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:18,x:156,width:175,text:"寻觅10次",scaleY:1.3,scaleX:1.3,height:50,font:"fengyu",color:"#0b080b",align:"center"}},{type:"Sprite",props:{y:82,x:125,width:280,name:"price",height:61},child:[{type:"Image",props:{y:11,x:50,width:50,skin:"extendRes/items/gold1.png",name:"icon",height:50}},{type:"Label",props:{y:13,x:112,width:175,text:"x1800",name:"count",height:50,fontSize:42,font:"SimHei",color:"#0b080b",bold:!0,align:"left"}}]},{type:"Script",props:{runtime:"capsui.CButton"}}]}]},{type:"Image",props:{y:388,x:299,width:727,skin:"myres/treasure/treasure_bg.png",name:"container1",height:510,sizeGrid:"37,29,38,30"},child:[{type:"Label",props:{y:16,x:293,width:194,text:"寻觅1次",scaleY:.8,scaleX:.8,height:54,font:"fengyu",color:"#f9f6f6",align:"center"}},{type:"Label",props:{y:131,x:225,width:133,text:"获得",scaleY:.8,scaleX:.8,height:46,fontSize:40,font:"SimHei",color:"#f9f6f6",align:"center"}},{type:"Label",props:{y:131,x:391,width:133,text:"x1",scaleY:.8,scaleX:.8,height:46,fontSize:45,font:"SimHei",color:"#f9f6f6",bold:!0,align:"center"}},{type:"Label",props:{y:221,x:167,width:460,text:"可获得角色，装扮，礼物",scaleY:.8,scaleX:.8,height:46,fontSize:40,font:"SimHei",color:"#f9f6f6",align:"center"}},{type:"Image",props:{y:113,x:334,width:67,skin:"myres/lobby/xycoin.png",name:"icon",height:67}},{type:"Button",props:{y:417,x:366,width:558,stateNum:1,skin:"myres/treasure/treasure_btn.png",name:"btn_tanfang",height:155,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:18,x:156,width:175,text:"寻觅1次",scaleY:1.3,scaleX:1.3,height:50,font:"fengyu",color:"#0b080b",align:"center"}},{type:"Sprite",props:{y:82,x:125,width:280,name:"price",height:61},child:[{type:"Image",props:{y:11,x:50,width:50,skin:"extendRes/items/gold1.png",name:"icon",height:50}},{type:"Label",props:{y:13,x:112,width:175,text:"x1800",name:"count",height:50,fontSize:42,font:"SimHei",color:"#0b080b",bold:!0,align:"left"}}]},{type:"Script",props:{runtime:"capsui.CButton"}}]}]},{type:"Image",props:{y:27,x:298,width:1474,skin:"myres2/treasurehead/treasure_pic.png",name:"head",height:337}},{type:"Image",props:{y:111,x:15,width:166,skin:"myres/treasure/treasure_btn0.png",height:191}},{type:"Button",props:{y:296,x:310,width:173,name:"btn_xiangqing",height:60}},{type:"Sprite",props:{y:58,x:295,width:268,name:"container_shop",height:69},child:[{type:"Button",props:{y:33,x:235,width:52,name:"btn_what",height:57,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:8,x:5,width:41,skin:"myres/bothui/what.png",height:41}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:32,x:108,width:195,stateNum:1,skin:"myres/lobby/xy_btn.png",name:"btn_shop",height:55,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:14,x:69,width:86,text:"99999",name:"count",height:27,fontSize:33,font:"SimHei",color:"#febe61",align:"center"}},{type:"Image",props:{y:6,x:14,width:43,skin:"myres/lobby/xycoin.png",height:43}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]}]},{type:"Image",props:{y:48,x:119,width:401,skin:"myres/img_return1_bg.png",name:"top",height:81},child:[{type:"Label",props:{y:3,x:105,width:95,text:"探访",scaleY:1.4,scaleX:1.4,height:45,font:"fengyu",color:"#e4ba86",align:"center"}},{type:"Button",props:{y:46,x:-40,width:182,pivotY:80,pivotX:76,name:"btn_back",height:142},child:[{type:"Image",props:{y:6,x:7,width:135,skin:"myres/img_return1.png",height:134}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:29.5,x:1319,width:294,name:"container_gold0",height:89,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Image",props:{y:3,x:38,width:253,skin:"myres/lobby/bg_0.png",name:"bg",height:88}},{type:"Image",props:{y:8,x:10,width:70,skin:"myres/gold0.png",scaleY:1,scaleX:1,name:"icon",height:70}},{type:"Label",props:{y:25,x:77,width:125,valign:"middle",text:"9.024亿",name:"label_gold",height:39,fontSize:35,font:"SimHei",color:"#ffffff",align:"right"}}]},{type:"Button",props:{y:29.5,x:1610,width:294,name:"container_gold1",height:89,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Image",props:{y:3,x:38,width:253,skin:"myres/lobby/bg_0.png",name:"bg",height:88}},{type:"Image",props:{y:8,x:10,width:70,skin:"myres/gold1.png",scaleY:1,scaleX:1,name:"icon",height:70}},{type:"Label",props:{y:25,x:77,width:125,valign:"middle",text:"1000",name:"label_gold",height:39,fontSize:35,font:"SimHei",color:"#ffffff",align:"right"}}]}]},{type:"Sprite",props:{width:1920,name:"tips",mouseThrough:!1,mouseEnabled:!0,height:1080},child:[{type:"Button",props:{y:0,x:0,width:1920,name:"btn_close",height:1080}},{type:"Sprite",props:{y:29,x:572,width:580,name:"root",mouseThrough:!1,mouseEnabled:!0,height:450},child:[{type:"Image",props:{width:580,skin:"myres/bbg.png",height:450,alpha:.9,sizeGrid:"1,1,1,1"}},{type:"Image",props:{y:-5,x:-5,width:590,skin:"myres/kuangbound.png",name:"bound",height:460,sizeGrid:"18,20,12,12"}},{type:"Panel",props:{y:25,x:24,width:536,name:"content",height:399},child:[{type:"Label",props:{y:0,x:0,wordWrap:!0,width:528,text:"1313132132\\n1313132132\\n1313132132\\n1313132132",name:"info",leading:5,height:399,fontSize:28,color:"#ffffff"}}]}]}]},{type:"Sprite",props:{y:98,x:308,width:1578,name:"xy",height:966},child:[{type:"Image",props:{y:54,x:77,width:1490,skin:"myres/lobby/xy_bg.png",name:"bg",height:893,sizeGrid:"55,54,54,53"}},{type:"Image",props:{y:101,x:91,width:239,skin:"myres/lobby/xy_bg1.png",height:56},child:[{type:"Image",props:{y:5,x:14,width:43,skin:"myres/lobby/xycoin.png",height:43}}]},{type:"Label",props:{y:114,x:160,width:86,text:"99999",name:"count",height:27,fontSize:33,font:"SimHei",color:"#febe61",align:"center"}},{type:"Label",props:{y:113,x:634,width:479,text:"请选择你想要兑换的内容",scaleY:.8,scaleX:.8,height:49,fontSize:42,font:"SimHei",color:"#dc7cff",align:"center"}},{type:"Button",props:{y:119,x:1502,width:106,pivotY:62,pivotX:45,name:"btn_close",height:108},child:[{type:"Image",props:{y:39,x:25,width:47,skin:"myres/sushe/bf_close.png",name:"close",height:48}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Panel",props:{y:184,x:165,width:1283,name:"content",height:711},child:[{type:"Sprite",props:{width:320,name:"templete",height:409},child:[{type:"Button",props:{y:186,x:147,width:256,pivotY:165,pivotX:127,name:"btn",height:363,gray:!1},child:[{type:"Image",props:{y:-4,x:-7,width:269,skin:"myres/shop/item_bg.png",name:"bbg",height:370}},{type:"Image",props:{y:160,x:128,width:163,skin:"myres/kuangbg.png",name:"bg",height:163,anchorY:.5,anchorX:.5,sizeGrid:"7,7,8,7"}},{type:"Image",props:{y:160,x:128,width:163,name:"icon",height:163,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:160,x:128,width:169,skin:"myres/kuangbound.png",name:"bound",height:169,anchorY:.5,anchorX:.5,sizeGrid:"18,20,12,12"}},{type:"Label",props:{y:17,x:-2,width:324,text:"二阶堂美树",scaleY:.8,scaleX:.8,name:"label_name",height:49,fontSize:40,font:"SimHei",color:"#eeeae6",align:"center"}},{type:"Image",props:{y:286,x:14,width:228,skin:"myres/shop/btn_buy.png",name:"btn_buy",height:65},child:[{type:"Image",props:{y:33,x:26,width:47,skin:"myres/lobby/xycoin.png",scaleY:.95,scaleX:.95,name:"currency",height:48,anchorY:.5,anchorX:0}},{type:"Label",props:{y:33,x:74,width:129,valign:"middle",text:"999999",name:"label_gold",height:39,fontSize:42,font:"SimHei",color:"#3a2138",anchorY:.5,align:"left"}}]},{type:"Image",props:{y:75,x:23,width:211,skin:"myres/shop/owned.png",name:"buyed",height:170}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Script",props:{y:-43,x:-23,runtime:"capsui.UICopy"}}]}]},{type:"Sprite",props:{y:201,x:1461,width:50,name:"scrollbar",mouseThrough:!1,mouseEnabled:!0,height:702},child:[{type:"Image",props:{y:0,x:25,skin:"myres/scrollbar.png",name:"scrollbar",height:693,anchorX:.5,alpha:.5}},{type:"Image",props:{y:96,x:25,width:45,skin:"myres/scrollpoint.png",name:"scrollpoint",height:45,anchorY:.5,anchorX:.5}}]},{type:"Script",props:{runtime:"capsui.CScrollView"}}]},{type:"Sprite",props:{width:1920,name:"pop_buy_single",mouseThrough:!1,mouseEnabled:!0,height:1080},child:[{type:"Sprite",props:{y:568,x:992,width:804,pivotY:317,pivotX:413,name:"root",height:595},child:[{type:"Image",props:{y:101,x:129,width:565,skin:"myres/pop2_bg.png",name:"bg0",height:424,sizeGrid:"2,2,2,2"}},{type:"Image",props:{y:101,x:129,width:567,skin:"myres/pop2_bound.png",name:"bound",height:424,sizeGrid:"24,27,11,21"}},{type:"Label",props:{y:110,x:133,width:699,valign:"middle",text:"一之濑的琴",scaleY:.8,scaleX:.8,name:"label_name",height:65,fontSize:45,font:"SimHei",color:"#e8af71",align:"center"}},{type:"Label",props:{y:176,x:329,wordWrap:!0,width:341,valign:"middle",text:"我擦咧搞毛啊啊啊啊啊啊啊啊啊啊啊啊啊",name:"desc",leading:4,height:153,fontSize:25,font:"SimHei",color:"#b5c4c8",align:"left"}},{type:"Button",props:{y:105,x:692,width:100,pivotY:51,pivotX:60,name:"btn_close",height:100},child:[{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Image",props:{y:11,x:20,width:80,skin:"myres/btn_close.png",height:80}}]},{type:"Sprite",props:{y:130,x:135,width:298,scaleY:.63,scaleX:.63,name:"item",height:349},child:[{type:"Image",props:{y:195,x:151,width:236,skin:"myres/kuangbg.png",name:"bg",height:236,anchorY:.5,anchorX:.5,sizeGrid:"7,7,8,7"}},{type:"Image",props:{y:195,x:151,width:236,name:"icon",height:236,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:195,x:151,width:242,skin:"myres/kuangbound.png",name:"bound",height:242,anchorY:.5,anchorX:.5,sizeGrid:"18,20,12,12"}},{type:"Image",props:{y:71,x:-1,width:308,skin:"myres/shop/owned.png",name:"buyed",height:247}}]},{type:"Button",props:{y:470,x:405,width:225,stateNum:1,skin:"myres/shop/btn_buy.png",name:"btn_buy",height:64,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:7,x:37,width:148,valign:"middle",text:"购买",name:"label_gold",height:39,fontSize:40,font:"fengyu",color:"#4d0307",align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Image",props:{y:392,x:241,width:338,skin:"myres/shop/price_bg.png",name:"price",height:34},child:[{type:"Label",props:{y:6,x:53,width:53,text:"总价",name:"label0",height:27,fontSize:25,font:"SimHei",color:"#dbd8d8"}},{type:"Image",props:{y:-5,x:112,width:43,skin:"myres/lobby/xycoin.png",name:"icon",height:43}},{type:"Label",props:{y:-1,x:160,width:122,text:"999999",name:"count",height:35,fontSize:35,font:"SimHei",color:"#dbd8d8",align:"left"}}]}]}]},{type:"Sprite",props:{width:1920,name:"pop_buy_multi",mouseThrough:!1,mouseEnabled:!0,height:1080},child:[{type:"Sprite",props:{y:565,x:969,width:1e3,pivotY:456,pivotX:478,name:"root",height:812},child:[{type:"Image",props:{y:101,x:129,width:711,skin:"myres/pop2_bg.png",pivotY:0,pivotX:0,name:"bg0",height:708,sizeGrid:"2,2,2,2"}},{type:"Image",props:{y:101,x:129,width:711,skin:"myres/pop2_bound.png",name:"bound",height:708,sizeGrid:"24,27,11,21"}},{type:"Label",props:{y:110,x:133,width:880,valign:"middle",text:"一之濑的琴",scaleY:.8,scaleX:.8,name:"label_name",height:82,fontSize:45,font:"SimHei",color:"#e8af71",align:"center"}},{type:"Label",props:{y:190,x:404,wordWrap:!0,width:360,valign:"middle",text:"我擦咧搞毛啊啊啊啊啊啊啊啊啊啊啊啊啊",name:"desc",leading:4,height:153,fontSize:25,font:"SimHei",color:"#b5c4c8",align:"left"}},{type:"Button",props:{y:103,x:834,width:100,name:"btn_close",height:100,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Image",props:{y:10,x:10,width:80,skin:"myres/btn_close.png",height:80}}]},{type:"Sprite",props:{y:143,x:207,width:298,scaleY:.63,scaleX:.63,name:"item",height:349},child:[{type:"Image",props:{y:195,x:151,width:236,skin:"myres/kuangbg.png",name:"bg",height:236,anchorY:.5,anchorX:.5,sizeGrid:"7,7,8,7"}},{type:"Image",props:{y:195,x:151,width:236,name:"icon",height:236,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:195,x:151,width:242,skin:"myres/kuangbound.png",name:"bound",height:242,anchorY:.5,anchorX:.5,sizeGrid:"18,20,12,12"}},{type:"Image",props:{y:71,x:-3,width:311,skin:"myres/shop/owned.png",name:"buyed",height:249}}]},{type:"Button",props:{y:751,x:482,width:225,stateNum:1,skin:"myres/shop/btn_buy.png",name:"btn_buy",height:64,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:6,x:37,width:148,valign:"middle",text:"购买",name:"label_gold",height:39,fontSize:40,font:"fengyu",color:"#4d0307",align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Image",props:{y:389,x:300,width:170,skin:"myres/shop/detail_bg.png",name:"danjia",height:84,sizeGrid:"10,10,10,10"},child:[{type:"Label",props:{y:7,x:8,text:"单价",fontSize:26,font:"SimHei",color:"#6c779d"}},{type:"Image",props:{y:44,x:12,width:32,skin:"myres/lobby/xycoin.png",name:"icon",height:32}},{type:"Label",props:{y:45,x:58,width:106,text:"999999",name:"price",height:35,fontSize:33,font:"SimHei",color:"#8c9cb4",align:"left"}}]},{type:"Image",props:{y:389,x:488,width:170,skin:"myres/shop/detail_bg.png",name:"left",height:84,sizeGrid:"10,10,10,10"},child:[{type:"Label",props:{y:7,x:8,text:"剩余",fontSize:26,font:"SimHei",color:"#6c779d"}},{type:"Label",props:{y:47,x:28,width:125,text:"999/月",name:"count",height:35,fontSize:28,font:"SimHei",color:"#8c9cb4",align:"right"}}]},{type:"Label",props:{y:480,x:387,text:"每个月刷新一次",name:"refresh_info",fontSize:26,font:"SimHei",color:"#4f7da8"}},{type:"Image",props:{y:674,x:311,width:338,skin:"myres/shop/price_bg.png",name:"price",height:34},child:[{type:"Label",props:{y:6,x:53,width:53,text:"总价",name:"label0",height:27,fontSize:25,font:"SimHei",color:"#dbd8d8"}},{type:"Image",props:{y:-5,x:112,width:43,skin:"myres/lobby/xycoin.png",name:"icon",height:43}},{type:"Label",props:{y:-1,x:160,width:122,text:"999999",name:"count",height:35,fontSize:35,font:"SimHei",color:"#dbd8d8",align:"left"}}]},{type:"Label",props:{y:546,x:436,width:89,text:"99",name:"count",height:59,fontSize:55,font:"SimHei",color:"#dbd8d8",align:"center"}},{type:"Image",props:{y:530,x:183,width:86,skin:"myres/lobby/num.png",name:"-10",height:84,sizeGrid:"19,22,21,20"},child:[{type:"Image",props:{y:0,x:0,width:86,skin:"myres/lobby/num_pressed.png",name:"s",height:84}},{type:"Label",props:{y:17,x:6,width:64,text:"-10",height:44,fontSize:45,font:"SimHei",color:"#79b1d6"}}]},{type:"Image",props:{y:530,x:695,width:86,skin:"myres/lobby/num.png",name:"+10",height:84,sizeGrid:"19,22,21,20"},child:[{type:"Image",props:{y:0,x:0,width:86,skin:"myres/lobby/num_pressed.png",name:"s",height:84}},{type:"Label",props:{y:17,x:6,width:64,text:"+10",height:44,fontSize:45,font:"SimHei",color:"#79b1d6"}}]},{type:"Image",props:{y:530,x:583,width:86,skin:"myres/lobby/num.png",name:"+1",height:84,sizeGrid:"19,22,21,20"},child:[{type:"Image",props:{y:0,x:0,width:86,skin:"myres/lobby/num_pressed.png",name:"s",height:84}},{type:"Label",props:{y:17,x:22,width:44,text:"+1",height:44,fontSize:45,font:"SimHei",color:"#79b1d6"}}]},{type:"Image",props:{y:530,x:294,width:86,skin:"myres/lobby/num.png",name:"-1",height:84,sizeGrid:"19,22,21,20"},child:[{type:"Image",props:{y:0,x:0,width:86,skin:"myres/lobby/num_pressed.png",name:"s",height:84}},{type:"Label",props:{y:17,x:22,width:44,text:"-1",height:44,fontSize:45,font:"SimHei",color:"#79b1d6"}}]}]}]}]},i}(View);t.treasureUI=i}(e.lobby||(e.lobby={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.CButton",capsui.CButton),View.regComponent("capsui.UICopy",capsui.UICopy),View.regComponent("capsui.CScrollView",capsui.CScrollView),t.prototype.createChildren.call(this),this.createView(e.lobby.visitUI.uiView)},i.uiView={type:"View",props:{width:1920,mouseThrough:!0,height:1080},child:[{type:"Image",props:{y:48,x:119,width:401,name:"top",height:81},child:[{type:"Image",props:{y:0,x:0,width:401,skin:"myres/img_return1_bg.png",height:81}},{type:"Button",props:{y:38,x:-34,width:182,pivotY:72,pivotX:82,name:"btn_back",height:142},child:[{type:"Image",props:{y:6,x:7,width:135,skin:"myres/img_return1.png",height:134}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Label",props:{y:3,x:105,width:95,text:"拜访",scaleY:1.4,scaleX:1.4,height:45,font:"fengyu",color:"#e4ba86",align:"center"}}]},{type:"Sprite",props:{y:831,x:114,width:674,name:"chat",height:226},child:[{type:"Image",props:{y:15,x:12,width:654,skin:"myres/bothui/bf_chat.png",name:"bg",height:205,sizeGrid:"14,14,13,14"}},{type:"Label",props:{y:47,x:47,wordWrap:!0,width:595,text:"喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵喵",name:"info",leading:8,height:160,fontSize:29,font:"SimHei",color:"#cecece"}}]},{type:"Sprite",props:{y:96,x:826,width:1063,name:"right",height:971},child:[{type:"Image",props:{y:52,x:92,width:915,skin:"myres/sushe/gift_bbg.png",height:889,alpha:.8}},{type:"Image",props:{y:48,x:45,width:1009,skin:"myres/sushe/bg_frame.png",name:"bg",height:915,sizeGrid:"32,65,27,64"}},{type:"Image",props:{y:61,x:45,width:11,skin:"myres/sushe/bf_lampline.png",height:503}},{type:"Button",props:{y:167,x:50,width:121,stateNum:1,skin:"myres/sushe/bf_unchooesd.png",name:"btn_page0",height:164,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:36,x:42,wordWrap:!0,width:43,text:"档案",scaleY:.9,scaleX:.9,height:104,font:"fengyu",color:"#2a1e25"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:443,x:50,width:121,stateNum:1,skin:"myres/sushe/bf_unchooesd.png",name:"btn_page1",height:164,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:36,x:42,wordWrap:!0,width:43,text:"语音",scaleY:.9,scaleX:.9,height:104,font:"fengyu",color:"#2a1e25"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:307,x:50,width:121,stateNum:1,skin:"myres/sushe/bf_unchooesd.png",name:"btn_page2",height:164,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:36,x:42,wordWrap:!0,width:43,text:"效果",scaleY:.9,scaleX:.9,height:104,font:"fengyu",color:"#2a1e25"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Sprite",props:{y:273,x:110,width:885,name:"page_intro",height:645},child:[{type:"Sprite",props:{y:0,x:0,name:"intro"},child:[{type:"Panel",props:{y:27,x:6,width:828,name:"content",height:612},child:[{type:"Image",props:{y:14,x:16,width:294,skin:"myres/sushe/bf_title_bg.png",name:"intro",height:51,sizeGrid:"0,0,0,15"},child:[{type:"Label",props:{y:0,x:20,width:178,text:"人物介绍",scaleY:.85,scaleX:.85,height:48,font:"fengyu",color:"#ffd562"}}]},{type:"Sprite",props:{y:81,x:9,width:792,name:"container_text",height:465},child:[{type:"Label",props:{y:13,x:30,width:101,text:"身高：",scaleY:.7,scaleX:.7,height:50,fontSize:28,font:"fengyu",color:"#a27d3d"}},{type:"Label",props:{y:18,x:109,width:184,text:"165厘米",name:"height",height:32,fontSize:28,font:"SimHei",color:"#b2aeac"}},{type:"Label",props:{y:49,x:30,width:67,text:"生日：",scaleY:.7,scaleX:.7,height:32,fontSize:28,font:"fengyu",color:"#a27d3d"}},{type:"Label",props:{y:55,x:109,width:206,text:"11月11日",name:"birth",height:32,fontSize:28,font:"SimHei",color:"#b2aeac"}},{type:"Label",props:{y:87,x:30,width:67,text:"年龄：",scaleY:.7,scaleX:.7,height:32,fontSize:28,font:"fengyu",color:"#a27d3d"}},{type:"Label",props:{y:92,x:109,width:67,text:"17",name:"age",height:32,fontSize:28,font:"SimHei",color:"#b2aeac"}},{type:"Label",props:{y:125,x:30,width:67,text:"血型：",scaleY:.7,scaleX:.7,height:32,fontSize:28,font:"fengyu",color:"#a27d3d"}},{type:"Label",props:{y:129,x:109,width:67,text:"AB",name:"bloodtype",height:32,fontSize:28,font:"SimHei",color:"#b2aeac"}},{type:"Label",props:{y:161,x:30,width:67,text:"声优：",scaleY:.7,scaleX:.7,height:32,fontSize:28,font:"fengyu",color:"#a27d3d"}},{type:"Label",props:{y:166,x:109,width:153,text:"内田真礼",name:"cv",height:32,fontSize:28,font:"SimHei",color:"#b2aeac"}},{type:"Label",props:{y:198,x:30,width:67,text:"爱好：",scaleY:.7,scaleX:.7,height:32,fontSize:28,font:"fengyu",color:"#a27d3d"}},{type:"Label",props:{y:202,x:109,width:119,text:"麻将、",name:"hobby",height:32,fontSize:28,font:"SimHei",color:"#b2aeac"}},{type:"Label",props:{y:235,x:30,width:67,text:"简介：",scaleY:.7,scaleX:.7,height:32,fontSize:28,font:"fengyu",color:"#a27d3d"}},{type:"Label",props:{y:277,x:31,wordWrap:!0,width:762,text:"出身出身出身出身出身出身出身出身出身出身出身出身出身出身出身出身出身出身出身出身出身出身出身出身出身出身出身出身出身出身出身出身出身出身出身出身出身出身出身出身出身出身出身出身出身出身出身出身出身出身出身出身出身出身出身出身出身出身出身出身出身出身出出身出出身",name:"desc",leading:8,height:194,fontSize:28,font:"SimHei",color:"#b2aeac"}}]},{type:"Image",props:{y:188,x:687,width:212,skin:"myres/kuangbg.png",name:"container_head",height:212,anchorY:.5,anchorX:.5,sizeGrid:"7,7,8,7"},child:[{type:"Image",props:{y:0,x:0,width:212,skin:"extendRes/charactor/yiji/smallhead.png",name:"head",height:212}},{type:"Image",props:{y:-5,x:-5,width:222,skin:"myres/kuangbound.png",name:"bound",height:222,sizeGrid:"18,20,12,12"}},{type:"Button",props:{y:186,x:188,width:237,pivotY:199,pivotX:197,name:"btn_skin",height:239},child:[{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Image",props:{y:160,x:157,width:75,skin:"myres/sushe/bf_skin.png",name:"skin",height:75}}]}]},{type:"Sprite",props:{y:561,width:846,name:"container_emj",height:490},child:[{type:"Image",props:{y:16,x:16,width:294,skin:"myres/sushe/bf_title_bg.png",height:51,sizeGrid:"0,0,0,15"},child:[{type:"Label",props:{y:1,x:18,width:178,text:"聊天表情",scaleY:.85,scaleX:.85,height:48,font:"fengyu",color:"#ffd562"}}]},{type:"Sprite",props:{y:92,x:19,width:812,name:"container",height:384},child:[{type:"Image",props:{y:0,x:0,width:176,skin:"extendRes/emo/e200001/0.png",name:"emo_templete",height:176},child:[{type:"Image",props:{width:176,skin:"myres/bbg.png",name:"lock",height:176,alpha:.7,sizeGrid:"1,1,1,1"},child:[{type:"Image",props:{y:62,x:67,width:44,skin:"myres/sushe/bf_unlock.png",height:43}},{type:"Image",props:{y:127,x:1,width:174,skin:"myres/sushe/bf_unlock1.png",height:36}},{type:"Label",props:{y:127,x:12,width:220,text:"羁绊LV3解锁",scaleY:.68,scaleX:.68,height:52,font:"fengyu",color:"#040c11"}}]},{type:"Image",props:{y:-1,x:-1,width:178,skin:"myres/sushe/bound_emo.png",name:"bound",height:178,sizeGrid:"4,4,4,4"}},{type:"Script",props:{runtime:"capsui.UICopy"}}]}]}]}]},{type:"Sprite",props:{y:40,x:839,width:50,name:"scrollbar",mouseThrough:!1,mouseEnabled:!0,height:595},child:[{type:"Image",props:{y:0,x:25,skin:"myres/sushe/ss_slidebar.png",name:"scrollbar",height:595,anchorX:.5}},{type:"Image",props:{y:96,x:25,width:45,skin:"myres/sushe/ss_slidebtn.png",name:"scrollpoint",height:45,anchorY:.5,anchorX:.5}}]}]},{type:"Image",props:{y:-41,x:-3,width:882,skin:"myres/sushe/gift_heart_bg.png",name:"container_gift",height:697,sizeGrid:"59,61,56,68"},child:[{type:"Image",props:{y:67,x:38,width:807,skin:"myres/sushe/gift_bbg.png",name:"bg",height:468}},{type:"Sprite",props:{y:2,x:-8,width:906,name:"page_qiyue",height:703},child:[{type:"Label",props:{y:572,x:290,width:338,text:"需要五心好感度",name:"nomet",height:58,font:"fengyu",align:"center"}},{type:"Sprite",props:{y:549,x:324,width:241,name:"container_tupo_btn",height:128},child:[{type:"Button",props:{y:74,x:122,width:211,stateNum:1,skin:"myres/bothui/gift_btn.png",name:"send",height:76,anchorY:.5,anchorX:.5,sizeGrid:"0,68,0,51"},child:[{type:"Label",props:{y:11,x:62,width:97,text:"献礼",height:51,font:"fengyu",color:"#1f0b15"}},{type:"Script",props:{y:0,x:-1,runtime:"capsui.CButton"}}]}]}]},{type:"Sprite",props:{y:2,x:-7,width:906,name:"page_gift",height:703},child:[{type:"Button",props:{y:624,x:445,width:211,stateNum:1,skin:"myres/bothui/gift_btn.png",name:"send",height:76,anchorY:.5,anchorX:.5,sizeGrid:"0,68,0,51"},child:[{type:"Label",props:{y:11,x:62,width:97,text:"赠送",height:51,font:"fengyu",color:"#1f0b15"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Label",props:{y:556,x:303,width:264,text:"今日剩余送礼次数：",height:25,fontSize:25,font:"SimHei",color:"#f6b664",align:"center"}},{type:"Label",props:{y:556,x:535,width:34,text:"10",name:"count",height:25,fontSize:25,font:"SimHei",color:"#f6b664",align:"center"}}]},{type:"Panel",props:{y:80,x:56,width:763,name:"content",height:441},child:[{type:"Sprite",props:{y:0,x:0,width:190,name:"templete",height:220},child:[{type:"Button",props:{y:94,x:95,width:190,name:"btn",height:188,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:1,x:0,width:188,skin:"myres/sushe/gift_chosen.png",name:"choosed",height:188,sizeGrid:"37,39,31,31"}},{type:"Image",props:{y:95,x:94,width:151,skin:"myres/kuangbg.png",name:"icon",height:151,anchorY:.5,anchorX:.5,sizeGrid:"7,7,8,7"}},{type:"Image",props:{y:15,x:13,width:161,skin:"myres/kuangbound.png",name:"bound",height:161,sizeGrid:"18,20,12,12"}},{type:"Label",props:{y:138,x:60,width:106,text:999,strokeColor:"#000000",stroke:2,name:"num",height:31,fontSize:30,font:"SimHei",color:"#ffffff",align:"right"}}]},{type:"Script",props:{y:0,x:0,runtime:"capsui.UICopy"}},{type:"Label",props:{y:185,x:-3,width:192,text:"香喷喷曲奇",name:"name",height:25,fontSize:25,font:"SimHei",color:"#d7d5d5",align:"center"}},{type:"Sprite",props:{y:181,x:0,width:189,name:"counts",height:32},child:[{type:"Label",props:{y:-1,x:32,width:93,text:"9999",strokeColor:"#0d0d0d",name:"count_have",height:34,fontSize:32,font:"SimHei",color:"#61dd6e",align:"left"}},{type:"Label",props:{y:-1,x:81,width:72,text:"/99",strokeColor:"#0d0d0d",name:"count_need",height:34,fontSize:32,font:"SimHei",color:"#f9b864",align:"left"}}]}]}]},{type:"Sprite",props:{y:82,x:801,width:50,name:"scrollbar",mouseThrough:!1,mouseEnabled:!0,height:440},child:[{type:"Image",props:{y:0,x:25,skin:"myres/sushe/ss_slidebar.png",name:"scrollbar",height:440,anchorX:.5}},{type:"Image",props:{y:96,x:25,width:45,skin:"myres/sushe/ss_slidebtn.png",name:"scrollpoint",height:45,anchorY:.5,anchorX:.5}}]},{type:"Button",props:{y:36,x:842,width:97,pivotY:52,pivotX:48,name:"btn_close",height:85},child:[{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Image",props:{y:28,x:24,width:51,skin:"myres/sushe/bf_close.png",height:53}}]},{type:"Script",props:{runtime:"capsui.CScrollView"}}]},{type:"Sprite",props:{y:-217,x:-26,width:924,name:"container_heart",height:211},child:[{type:"Image",props:{y:19,x:23,width:882,skin:"myres/sushe/gift_heart_bg.png",name:"bg",height:158,sizeGrid:"59,61,56,68"}},{type:"Image",props:{y:76,x:685,skin:"myres/sushe/gift_star.png",scaleY:1.2,scaleX:1.2}},{type:"Image",props:{y:76,x:391,skin:"myres/sushe/gift_star.png",scaleY:1.2,scaleX:-1.2,pivotX:-135}},{type:"Image",props:{y:47,x:241,skin:"myres/sushe/heart_normal.png",scaleY:1.2,scaleX:1.2,name:"bg_hearts"}},{type:"Sprite",props:{y:66,x:422,width:73,name:"hearts",height:62},child:[{type:"Image",props:{y:33,x:-124,width:77,skin:"myres/bothui/bf_heart_bg.png",name:"heart",height:67,anchorY:.5,anchorX:.5},child:[{type:"Sprite",props:{name:"v"},child:[{type:"Image",props:{y:0,x:0,width:77,skin:"myres/bothui/bf_heart.png",name:"h",height:67}},{type:"Image",props:{y:67,width:77,skin:"myres/bbg.png",scaleY:.92,renderType:"mask",height:67,anchorY:1,sizeGrid:"1,1,1,1"}}]}]},{type:"Image",props:{y:33,x:-43,width:77,skin:"myres/bothui/bf_heart_bg.png",name:"heart",height:67,anchorY:.5,anchorX:.5},child:[{type:"Sprite",props:{name:"v"},child:[{type:"Image",props:{y:0,x:0,width:77,skin:"myres/bothui/bf_heart.png",name:"h",height:67}},{type:"Image",props:{y:67,width:77,skin:"myres/bbg.png",scaleY:.92,renderType:"mask",height:67,anchorY:1,sizeGrid:"1,1,1,1"}}]}]},{type:"Image",props:{y:33,x:38,width:77,skin:"myres/bothui/bf_heart_bg.png",name:"heart",height:67,anchorY:.5,anchorX:.5},child:[{type:"Sprite",props:{name:"v"},child:[{type:"Image",props:{y:0,x:0,width:77,skin:"myres/bothui/bf_heart.png",name:"h",height:67}},{type:"Image",props:{y:67,width:77,skin:"myres/bbg.png",scaleY:.92,renderType:"mask",height:67,anchorY:1,sizeGrid:"1,1,1,1"}}]}]},{type:"Image",props:{y:33,x:118,width:77,skin:"myres/bothui/bf_heart_bg.png",name:"heart",height:67,anchorY:.5,anchorX:.5},child:[{type:"Sprite",props:{name:"v"},child:[{type:"Image",props:{y:0,x:0,width:77,skin:"myres/bothui/bf_heart.png",name:"h",height:67}},{type:"Image",props:{y:67,width:77,skin:"myres/bbg.png",scaleY:.92,renderType:"mask",height:67,anchorY:1,sizeGrid:"1,1,1,1"}}]}]},{type:"Image",props:{y:33,x:198,width:77,skin:"myres/bothui/bf_heart_bg.png",name:"heart",height:67,anchorY:.5,anchorX:.5},child:[{type:"Sprite",props:{name:"v"},child:[{type:"Image",props:{y:0,x:0,width:77,skin:"myres/bothui/bf_heart.png",name:"h",height:67}},{type:"Image",props:{y:67,width:77,skin:"myres/bbg.png",scaleY:.92,renderType:"mask",height:67,anchorY:1,sizeGrid:"1,1,1,1"}}]}]}]}]},{type:"Sprite",props:{y:-80,x:231,width:405,name:"tabs",height:78},child:[{type:"Button",props:{y:39,x:109,width:179,stateNum:1,skin:"myres/sushe/gift_sign.png",name:"sign",height:60,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{width:179,skin:"myres/sushe/gift_sign1.png",name:"chosen",height:60}},{type:"Label",props:{y:8,x:20,width:182,text:"缔结契约",scaleY:.8,scaleX:.8,name:"label",height:50,font:"fengyu",color:"#cfcdcc",align:"center"}}]},{type:"Button",props:{y:39,x:293,width:179,stateNum:1,skin:"myres/sushe/gift_send.png",name:"send",height:60,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{width:179,skin:"myres/sushe/gift_sign1.png",name:"chosen",height:60}},{type:"Label",props:{y:8,x:20,width:182,text:"赠送礼物",scaleY:.8,scaleX:.8,name:"label",height:50,font:"fengyu",color:"#cfcdcc",align:"center"}}]}]}]},{type:"Sprite",props:{y:62,x:105,width:894,name:"sound",height:872},child:[{type:"Image",props:{y:33,x:18,width:294,skin:"myres/sushe/bf_title_bg.png",name:"title",height:51,sizeGrid:"0,0,0,15"},child:[{type:"Label",props:{y:0,x:20,width:178,text:"语音",scaleY:.85,scaleX:.85,height:48,font:"fengyu",color:"#ffd562"}}]},{type:"Panel",props:{y:37,x:18,width:831,name:"content",height:806},child:[{type:"Image",props:{y:63,x:-1,width:813,skin:"myres/sushe/bf_bg_sound.png",name:"templete",height:81,sizeGrid:"17,17,17,16"},child:[{type:"Label",props:{y:11,x:36,width:607,valign:"middle",text:"指定在别家铳和自己时的特效",name:"desc",height:60,fontSize:28,font:"SimHei",color:"#a8a8a8",align:"left"}},{type:"Button",props:{y:4,x:681,width:129,name:"btn_play",height:79},child:[{type:"Image",props:{y:9,x:59,width:52,skin:"myres/sushe/bf_play.png",name:"img",height:54}}]},{type:"Image",props:{y:42,x:554,width:253,skin:"myres/sushe/bf_tip_unlock.png",name:"lock",height:34},child:[{type:"Label",props:{y:0,x:90,width:220,text:"羁绊LV3解锁",scaleY:.68,scaleX:.68,name:"info",height:52,font:"fengyu",color:"#040c11"}}]},{type:"Script",props:{runtime:"capsui.UICopy"}}]}]},{type:"Sprite",props:{y:40,x:839,width:50,name:"scrollbar",mouseThrough:!1,mouseEnabled:!0,height:803},child:[{type:"Image",props:{y:0,x:25,skin:"myres/sushe/ss_slidebar.png",name:"scrollbar",height:803,anchorX:.5}},{type:"Image",props:{y:96,x:25,width:45,skin:"myres/sushe/ss_slidebtn.png",name:"scrollpoint",height:45,anchorY:.5,anchorX:.5}}]},{type:"Script",props:{runtime:"capsui.CScrollView"}}]},{type:"Sprite",props:{y:62,x:105,width:894,name:"effect",height:872},child:[{type:"Sprite",props:{y:46,x:205,width:471,visible:!1,name:"container_head",height:516},child:[{type:"Image",props:{y:43,x:44,width:377,visible:!0,skin:"myres/sushe/bf_bg_hand.png",name:"circle",height:377}},{type:"Image",props:{y:347,x:316,width:112,visible:!1,skin:"myres/sushe/bf_decorate.png",name:"deco",height:112}},{type:"Image",props:{y:347,x:180,width:112,visible:!1,skin:"myres/sushe/bf_decorate.png",name:"ring",height:112}}]},{type:"Image",props:{y:35,x:17,width:294,skin:"myres/sushe/bf_title_bg.png",name:"title",height:51,sizeGrid:"0,0,0,15"},child:[{type:"Label",props:{y:0,x:20,width:178,text:"效果",scaleY:.85,scaleX:.85,height:48,font:"fengyu",color:"#ffd562"}}]},{type:"Button",props:{y:155,x:424,width:816,name:"slot0",height:115,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:1,x:1,width:812,skin:"myres/sushe/bf_bg_sound.png",name:"bg",height:111,sizeGrid:"17,17,17,16"}},{type:"Image",props:{y:11,x:9,width:93,skin:"myres/sushe/bf_frame_anime.png",name:"icon",height:93}},{type:"Image",props:{y:55,x:54,width:47,skin:"myres/sushe/bg_effectplus.png",name:"plus",height:47,anchorY:.5,anchorX:.5}},{type:"Label",props:{y:19,x:143,wordWrap:!0,width:636,valign:"middle",text:"指定在别家铳和自己时的特效",name:"desc",height:77,fontSize:28,font:"SimHei",color:"#a8a8a8",align:"center"}}]},{type:"Button",props:{y:275,x:424,width:816,name:"slot1",height:115,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:1,x:1,width:812,skin:"myres/sushe/bf_bg_sound.png",name:"bg",height:111,sizeGrid:"17,17,17,16"}},{type:"Image",props:{y:11,x:9,width:93,skin:"myres/sushe/bf_frame_anime.png",name:"icon",height:93}},{type:"Image",props:{y:55,x:54,width:47,skin:"myres/sushe/bg_effectplus.png",name:"plus",height:47,anchorY:.5,anchorX:.5}},{type:"Label",props:{y:19,x:143,wordWrap:!0,width:636,valign:"middle",text:"指定在别家铳和自己时的特效",name:"desc",height:77,fontSize:28,font:"SimHei",color:"#a8a8a8",align:"center"}}]},{type:"Button",props:{y:395,x:424,width:816,name:"slot2",height:115,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:1,x:1,width:812,skin:"myres/sushe/bf_bg_sound.png",name:"bg",height:111,sizeGrid:"17,17,17,16"}},{type:"Image",props:{y:11,x:9,width:93,skin:"myres/sushe/bf_frame_anime.png",name:"icon",height:93}},{type:"Image",props:{y:55,x:54,width:47,skin:"myres/sushe/bg_effectplus.png",name:"plus",height:47,anchorY:.5,anchorX:.5}},{type:"Label",props:{y:19,x:143,wordWrap:!0,width:636,valign:"middle",text:"指定在别家铳和自己时的特效",name:"desc",height:77,fontSize:28,font:"SimHei",color:"#a8a8a8",align:"center"}}]}]}]},{type:"Sprite",props:{y:0,x:0,width:1920,name:"pop_skin",mouseThrough:!1,mouseEnabled:!0,height:1080},child:[{type:"Image",props:{y:565,x:1494,width:616,skin:"myres/sushe/bf_popout.png",name:"root",height:585,anchorY:.5,anchorX:1,sizeGrid:"17,18,17,17"},child:[{type:"Label",props:{y:18,x:239,width:176,text:"更换皮肤",scaleY:.85,scaleX:.85,height:45,font:"fengyu",color:"#fab766"}},{type:"Image",props:{y:60,x:294,width:27,skin:"myres/sushe/bf_sakura.png",height:24},child:[{type:"Image",props:{y:11,x:30,width:269,skin:"myres/sushe/bf_popline.png",name:"line"}},{type:"Image",props:{y:11,x:-273,width:269,skin:"myres/sushe/bf_popline.png",name:"line"}}]},{type:"Panel",props:{y:90,x:39,width:555,name:"content",height:471},child:[{type:"Sprite",props:{y:0,x:0,width:180,name:"templete",height:180},child:[{type:"Button",props:{y:86,x:89,width:173,pivotY:86,pivotX:89,name:"btn",height:168},child:[{type:"Image",props:{y:84,x:89,width:150,skin:"myres/kuangbg.png",name:"bg",height:150,anchorY:.5,anchorX:.5,sizeGrid:"7,7,8,7"}},{type:"Image",props:{y:9,x:14,width:150,skin:"extendRes/charactor/yiji/smallhead.png",name:"icon",height:150}},{type:"Sprite",props:{y:9,x:14,name:"locked"},child:[{type:"Image",props:{y:0,x:0,width:150,skin:"myres/bbg.png",height:150,alpha:.7,sizeGrid:"1,1,1,1"}},{type:"Image",props:{y:47,x:53,width:44,skin:"myres/sushe/bf_unlock.png",height:43}},{type:"Image",props:{y:104,x:-1,width:150,skin:"myres/sushe/bf_unlock1.png",height:36}},{type:"Label",props:{y:104,x:0,width:212,text:"活动",scaleY:.7,scaleX:.7,name:"info",height:51,font:"fengyu",color:"#030c0f",align:"center"}}]},{type:"Image",props:{y:4,x:9,width:158,skin:"myres/kuangbound.png",name:"bound",height:158,sizeGrid:"18,20,12,12"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Image",props:{y:88,x:60,skin:"myres/lobby/using.png",name:"using"}},{type:"Script",props:{runtime:"capsui.UICopy"}}]}]},{type:"Button",props:{y:40,x:577,width:106,pivotY:62,pivotX:45,name:"btn_close",height:108},child:[{type:"Image",props:{y:39,x:25,width:47,skin:"myres/sushe/bf_close.png",name:"close",height:48}}]},{type:"Script",props:{runtime:"capsui.CScrollView"}}]}]},{type:"Sprite",props:{y:0,x:0,width:1920,name:"pop_effect",mouseThrough:!1,mouseEnabled:!0,height:1080},child:[{type:"Image",props:{y:591,x:827,width:616,skin:"myres/sushe/bf_popout.png",name:"root",height:585,anchorY:.5,anchorX:.5,sizeGrid:"17,18,17,17"},child:[{type:"Image",props:{y:71,x:325,width:269,skin:"myres/sushe/bf_popline.png"}},{type:"Image",props:{y:71,x:22,width:269,skin:"myres/sushe/bf_popline.png"}},{type:"Image",props:{y:60,x:295,width:27,skin:"myres/sushe/bf_sakura.png",height:24}},{type:"Label",props:{y:17,x:155,width:360,text:"立直棒特效",scaleY:.85,scaleX:.85,name:"title",height:45,font:"fengyu",color:"#fab766",align:"center"}},{type:"Button",props:{y:40,x:578,width:110,pivotY:61,pivotX:46,name:"btn_close",height:107},child:[{type:"Image",props:{y:38,x:25,width:47,skin:"myres/sushe/bf_close.png",name:"close",height:48}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Panel",props:{y:89,x:42,width:543,name:"content",height:468},child:[{type:"Sprite",props:{width:180,name:"templete",height:180},child:[{type:"Button",props:{y:90,x:90,width:156,name:"btn",height:156,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:78,x:78,width:156,skin:"myres/kuangbg.png",name:"bg",height:156,anchorY:.5,anchorX:.5,sizeGrid:"7,7,8,7"}},{type:"Image",props:{y:0,x:0,width:156,name:"icon",height:156}},{type:"Image",props:{y:-5,x:-5,width:166,skin:"myres/kuangbound.png",name:"bound",height:166,sizeGrid:"18,20,12,12"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Image",props:{y:78,x:46,width:143,skin:"myres/lobby/using.png",name:"using",height:106}},{type:"Script",props:{y:0,x:0,runtime:"capsui.UICopy"}}]}]},{type:"Script",props:{y:89,x:36,runtime:"capsui.CScrollView"}},{type:"Label",props:{y:139,x:128,width:360,text:"空空如也",scaleY:1,scaleX:1,name:"no_info",height:45,fontSize:25,font:"SimHei",color:"#fab766",align:"center"}}]}]},{type:"Image",props:{y:524,x:0,width:1920,skin:"myres/light_tips_bg.png",name:"levelup",height:339,anchorY:.5,sizeGrid:"6,11,8,12"},child:[{type:"Label",props:{y:59,x:744,width:422,valign:"top",text:"获得新的装扮！",name:"info",height:229,fontSize:32,font:"SimHei",color:"#7ade91",align:"center"}}]}]},i}(View);t.visitUI=i}(e.lobby||(e.lobby={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.CButton",capsui.CButton),View.regComponent("capsui.UICopy",capsui.UICopy),View.regComponent("capsui.CScrollView",capsui.CScrollView),t.prototype.createChildren.call(this),this.createView(e.lobby.waitingroomUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Sprite",props:{width:1920,name:"root",height:1080},child:[{type:"Button",props:{y:991,x:955,width:218,stateNum:1,skin:"myres/room/btn_ready.png",name:"btn_ok",height:88,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Image",props:{y:144,x:70,width:376,skin:"myres/room/frame_gold.png",name:"player_0",height:779},child:[{type:"Image",props:{y:0,x:0,width:376,skin:"myres/bothui/character_bg.png",height:779}},{type:"Button",props:{width:379,name:"btn_info",height:784}},{type:"Sprite",props:{y:0,x:0,width:408,name:"container_illust",height:762},child:[{type:"Image",props:{y:18,x:14,width:350,skin:"extendRes/charactor/yiji/waitingroom.png",name:"illust",height:747}}]},{type:"Image",props:{y:512,x:155,width:213,skin:"myres/room/ready.png",name:"flag",height:158}},{type:"Button",props:{y:20,x:341,width:74,stateNum:1,skin:"myres/room/btn_t.png",name:"btn_t",height:70,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Image",props:{y:673,x:0,width:828,skin:"myres/namebg.png",scaleY:.6,scaleX:.6,name:"container_name",height:176},child:[{type:"Label",props:{y:47,x:160,width:473,text:"搞什么飞机啊啊啊",name:"label_name",height:63,fontSize:55,font:"SimHei",color:"#ffffff"}},{type:"Image",props:{y:80,x:80,width:255,scaleY:.8,scaleX:.8,pivotY:114,pivotX:128,name:"rank",height:253},child:[{type:"Image",props:{y:0,x:0,skin:"myres/rank_bg.png",name:"bg"}},{type:"Image",props:{y:15,x:0,skin:"extendRes/level/queshi.png",name:"icon"}},{type:"Image",props:{y:191,x:58,skin:"myres/starbg.png",scaleY:1,scaleX:1,name:"star2",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]},{type:"Image",props:{y:142,x:29,skin:"myres/starbg.png",scaleY:.7,scaleX:.7,name:"star3",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]},{type:"Image",props:{y:214,x:110,skin:"myres/starbg.png",scaleY:.7,scaleX:.7,name:"star1",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]}]},{type:"Image",props:{y:-55,x:153,skin:"extendRes/title/notitle.png",scaleY:1.3,scaleX:1.3,name:"title"}}]},{type:"Image",props:{y:24,x:28,width:107,skin:"myres/room/roomowner.png",name:"host",height:100}}]},{type:"Image",props:{y:144,x:457,width:376,skin:"myres/room/frame_gold.png",name:"player_1",height:779},child:[{type:"Image",props:{y:0,x:0,width:376,skin:"myres/bothui/character_bg.png",height:779}},{type:"Button",props:{width:379,name:"btn_info",height:784}},{type:"Sprite",props:{y:0,x:0,width:408,name:"container_illust",height:762},child:[{type:"Image",props:{y:18,x:14,width:350,skin:"extendRes/charactor/yiji/waitingroom.png",name:"illust",height:747}}]},{type:"Image",props:{y:512,x:155,width:213,skin:"myres/room/ready.png",name:"flag",height:158}},{type:"Button",props:{y:20,x:341,width:74,stateNum:1,skin:"myres/room/btn_t.png",name:"btn_t",height:70,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Image",props:{y:24,x:28,width:107,skin:"myres/room/roomowner.png",name:"host",height:100}},{type:"Image",props:{y:673,x:0,width:828,skin:"myres/namebg.png",scaleY:.6,scaleX:.6,name:"container_name",height:176},child:[{type:"Label",props:{y:47,x:160,width:473,text:"搞什么飞机啊啊啊",name:"label_name",height:63,fontSize:55,font:"SimHei",color:"#ffffff"}},{type:"Image",props:{y:80,x:80,width:255,scaleY:.8,scaleX:.8,pivotY:114,pivotX:128,name:"rank",height:253},child:[{type:"Image",props:{y:0,x:0,skin:"myres/rank_bg.png",name:"bg"}},{type:"Image",props:{y:15,x:0,skin:"extendRes/level/queshi.png",name:"icon"}},{type:"Image",props:{y:191,x:58,skin:"myres/starbg.png",scaleY:1,scaleX:1,name:"star2",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]},{type:"Image",props:{y:142,x:29,skin:"myres/starbg.png",scaleY:.7,scaleX:.7,name:"star3",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]},{type:"Image",props:{y:214,x:110,skin:"myres/starbg.png",scaleY:.7,scaleX:.7,name:"star1",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]}]},{type:"Image",props:{y:-55,x:153,skin:"extendRes/title/notitle.png",scaleY:1.3,scaleX:1.3,name:"title"}}]}]},{type:"Image",props:{y:144,x:838,width:376,skin:"myres/room/frame_gold.png",name:"player_2",height:779},child:[{type:"Image",props:{y:0,x:0,width:376,skin:"myres/bothui/character_bg.png",height:779}},{type:"Button",props:{y:0,x:0,width:379,name:"btn_info",height:784}},{type:"Sprite",props:{y:0,x:0,width:408,name:"container_illust",height:762},child:[{type:"Image",props:{y:18,x:14,width:350,skin:"extendRes/charactor/yiji/waitingroom.png",name:"illust",height:747}}]},{type:"Image",props:{y:512,x:155,width:213,skin:"myres/room/ready.png",name:"flag",height:158}},{type:"Button",props:{y:20,x:341,width:74,stateNum:1,skin:"myres/room/btn_t.png",name:"btn_t",height:70,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Image",props:{y:24,x:28,width:107,skin:"myres/room/roomowner.png",name:"host",height:100}},{type:"Image",props:{y:673,width:828,skin:"myres/namebg.png",scaleY:.6,scaleX:.6,name:"container_name",height:176},child:[{type:"Label",props:{y:47,x:160,width:473,text:"搞什么飞机啊啊啊",name:"label_name",height:63,fontSize:55,font:"SimHei",color:"#ffffff"}},{type:"Image",props:{y:80,x:80,width:255,scaleY:.8,scaleX:.8,pivotY:114,pivotX:128,name:"rank",height:253},child:[{type:"Image",props:{y:0,x:0,skin:"myres/rank_bg.png",name:"bg"}},{type:"Image",props:{y:15,x:0,skin:"extendRes/level/queshi.png",name:"icon"}},{type:"Image",props:{y:191,x:58,skin:"myres/starbg.png",scaleY:1,scaleX:1,name:"star2",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]},{type:"Image",props:{y:142,x:29,skin:"myres/starbg.png",scaleY:.7,scaleX:.7,name:"star3",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]},{type:"Image",props:{y:214,x:110,skin:"myres/starbg.png",scaleY:.7,scaleX:.7,name:"star1",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]}]},{type:"Image",props:{y:-55,x:153,skin:"extendRes/title/notitle.png",scaleY:1.3,scaleX:1.3,name:"title"}}]}]},{type:"Image",props:{y:144,x:1217,width:376,skin:"myres/room/frame_gold.png",name:"player_3",height:779},child:[{type:"Image",props:{y:0,x:0,width:376,skin:"myres/bothui/character_bg.png",height:779}},{type:"Button",props:{y:0,x:0,width:379,name:"btn_info",height:784}},{type:"Sprite",props:{y:0,x:0,width:408,name:"container_illust",height:762},child:[{type:"Image",props:{y:18,x:14,width:350,skin:"extendRes/charactor/yiji/waitingroom.png",name:"illust",height:747}}]},{type:"Image",props:{y:512,x:155,width:213,skin:"myres/room/ready.png",name:"flag",height:158}},{type:"Button",props:{y:20,x:341,width:74,stateNum:1,skin:"myres/room/btn_t.png",name:"btn_t",height:70,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Image",props:{y:24,x:28,width:107,skin:"myres/room/roomowner.png",name:"host",height:100}},{type:"Image",props:{y:673,x:0,width:828,skin:"myres/namebg.png",scaleY:.6,scaleX:.6,name:"container_name",height:176},child:[{type:"Label",props:{y:47,x:160,width:473,text:"搞什么飞机啊啊啊",name:"label_name",height:63,fontSize:55,font:"SimHei",color:"#ffffff"}},{type:"Image",props:{y:80,x:80,width:255,scaleY:.8,scaleX:.8,pivotY:114,pivotX:128,name:"rank",height:253},child:[{type:"Image",props:{y:0,x:0,skin:"myres/rank_bg.png",name:"bg"}},{type:"Image",props:{y:15,x:0,skin:"extendRes/level/queshi.png",name:"icon"}},{type:"Image",props:{y:191,x:58,skin:"myres/starbg.png",scaleY:1,scaleX:1,name:"star2",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]},{type:"Image",props:{y:142,x:29,skin:"myres/starbg.png",scaleY:.7,scaleX:.7,name:"star3",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]},{type:"Image",props:{y:214,x:110,skin:"myres/starbg.png",scaleY:.7,scaleX:.7,name:"star1",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]}]},{type:"Image",props:{y:-55,x:153,skin:"extendRes/title/notitle.png",scaleY:1.3,scaleX:1.3,name:"title"}}]}]},{type:"Sprite",props:{name:"top"},child:[{type:"Image",props:{y:15,x:750,width:447,skin:"myres/title_bg.png",height:93}},{type:"Label",props:{y:42,x:1004,width:177,text:"222",name:"label_roomid",height:66,fontSize:60,font:"haolong",color:"#e8af71",bold:!0,align:"left"}},{type:"Label",props:{y:23,x:799,width:145,valign:"middle",text:"好友房",scaleY:1.4,scaleX:1.4,height:56,fontSize:70,font:"fengyu",color:"#e8af71",align:"center"}},{type:"Image",props:{y:42,x:126,width:401,skin:"myres/img_return1_bg.png",height:81}},{type:"Button",props:{y:82,x:85,width:164,pivotY:91,pivotX:87,name:"btn_leave",height:155},child:[{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Image",props:{y:24,x:19,width:135,skin:"myres/img_return1.png",height:134}}]},{type:"Label",props:{y:44,x:191,width:153,text:"好友房",scaleY:1.4,scaleX:1.4,height:57,fontSize:70,font:"fengyu",color:"#e4ba86",align:"center"}}]},{type:"Sprite",props:{name:"right"},child:[{type:"Sprite",props:{y:334,x:1679,width:198,name:"container_rules",height:400},child:[{type:"Image",props:{y:334,x:6,width:247,skin:"myres/room/btn_choosen.png",scaleY:.72,scaleX:.72,height:88},child:[{type:"Label",props:{y:43,x:121,width:231,valign:"middle",text:"一位必要点数：\\n30000",height:80,fontSize:30,font:"SimHei",color:"#894b4b",anchorY:.5,anchorX:.5,align:"center"}}]},{type:"Image",props:{y:344,x:16,width:247,skin:"myres/room/btn_choosen.png",scaleY:.72,scaleX:.72,height:88},child:[{type:"Label",props:{y:43,x:121,width:231,valign:"middle",text:"一位必要点数：\\n30000",height:80,fontSize:30,font:"SimHei",color:"#894b4b",anchorY:.5,anchorX:.5,align:"center"}}]},{type:"Image",props:{y:354,x:26,width:247,skin:"myres/room/btn_choosen.png",scaleY:.72,scaleX:.72,height:88},child:[{type:"Label",props:{y:43,x:121,width:231,valign:"middle",text:"一位必要点数：\\n30000",height:80,fontSize:30,font:"SimHei",color:"#894b4b",anchorY:.5,anchorX:.5,align:"center"}}]},{type:"Image",props:{y:364,x:36,width:247,skin:"myres/room/btn_choosen.png",scaleY:.72,scaleX:.72,height:88},child:[{type:"Label",props:{y:43,x:121,width:231,valign:"middle",text:"一位必要点数：\\n30000",height:80,fontSize:30,font:"SimHei",color:"#894b4b",anchorY:.5,anchorX:.5,align:"center"}}]},{type:"Image",props:{y:374,x:46,width:247,skin:"myres/room/btn_choosen.png",scaleY:.72,scaleX:.72,height:88},child:[{type:"Label",props:{y:43,x:121,width:231,valign:"middle",text:"一位必要点数：\\n30000",height:80,fontSize:30,font:"SimHei",color:"#894b4b",anchorY:.5,anchorX:.5,align:"center"}}]},{type:"Image",props:{y:384,x:56,width:247,skin:"myres/room/btn_choosen.png",scaleY:.72,scaleX:.72,height:88},child:[{type:"Label",props:{y:43,x:121,width:231,valign:"middle",text:"一位必要点数：\\n30000",height:80,fontSize:30,font:"SimHei",color:"#894b4b",anchorY:.5,anchorX:.5,align:"center"}}]},{type:"Image",props:{y:394,x:66,width:247,skin:"myres/room/btn_choosen.png",scaleY:.72,scaleX:.72,height:88},child:[{type:"Label",props:{y:43,x:121,width:231,valign:"middle",text:"一位必要点数：\\n30000",height:80,fontSize:30,font:"SimHei",color:"#894b4b",anchorY:.5,anchorX:.5,align:"center"}}]},{type:"Image",props:{y:404,x:76,width:247,skin:"myres/room/btn_choosen.png",scaleY:.72,scaleX:.72,height:88},child:[{type:"Label",props:{y:43,x:121,width:231,valign:"middle",text:"一位必要点数：\\n30000",height:80,fontSize:30,font:"SimHei",color:"#894b4b",anchorY:.5,anchorX:.5,align:"center"}}]},{type:"Image",props:{y:414,x:86,width:247,skin:"myres/room/btn_choosen.png",scaleY:.72,scaleX:.72,height:88},child:[{type:"Label",props:{y:43,x:121,width:231,valign:"middle",text:"一位必要点数：\\n30000",height:80,fontSize:30,font:"SimHei",color:"#894b4b",anchorY:.5,anchorX:.5,align:"center"}}]},{type:"Image",props:{y:424,x:96,width:247,skin:"myres/room/btn_choosen.png",scaleY:.72,scaleX:.72,height:88},child:[{type:"Label",props:{y:43,x:121,width:231,valign:"middle",text:"一位必要点数：\\n30000",height:80,fontSize:30,font:"SimHei",color:"#894b4b",anchorY:.5,anchorX:.5,align:"center"}}]},{type:"Image",props:{y:434,x:106,width:247,skin:"myres/room/btn_choosen.png",scaleY:.72,scaleX:.72,height:88},child:[{type:"Label",props:{y:43,x:121,width:231,valign:"middle",text:"一位必要点数：\\n30000",height:80,fontSize:30,font:"SimHei",color:"#894b4b",anchorY:.5,anchorX:.5,align:"center"}}]},{type:"Image",props:{y:444,x:116,width:247,skin:"myres/room/btn_choosen.png",scaleY:.72,scaleX:.72,height:88},child:[{type:"Label",props:{y:43,x:121,width:231,valign:"middle",text:"一位必要点数：\\n30000",height:80,fontSize:30,font:"SimHei",color:"#894b4b",anchorY:.5,anchorX:.5,align:"center"}}]},{type:"Image",props:{y:454,x:126,width:247,skin:"myres/room/btn_choosen.png",scaleY:.72,scaleX:.72,height:88},child:[{type:"Label",props:{y:43,x:121,width:231,valign:"middle",text:"一位必要点数：\\n30000",height:80,fontSize:30,font:"SimHei",color:"#894b4b",anchorY:.5,anchorX:.5,align:"center"}}]}]},{type:"Button",props:{y:771,x:1778,width:238,stateNum:1,skin:"myres/btn_small.png",name:"btn_friend",height:71,anchorY:.5,anchorX:.5,sizeGrid:"30,30,30,30"},child:[{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Label",props:{y:3,x:10,width:217,valign:"middle",text:"邀请好友",height:61,fontSize:38,font:"fengyu",color:"#e8af71",align:"center"}}]},{type:"Button",props:{y:842,x:1778,width:238,stateNum:1,skin:"myres/btn_small.png",name:"btn_robot",height:71,anchorY:.5,anchorX:.5,sizeGrid:"30,30,30,30"},child:[{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Label",props:{y:3,x:10,width:217,valign:"middle",text:"添加电脑",height:62,fontSize:38,font:"fengyu",color:"#e8af71",align:"center"}}]},{type:"Button",props:{y:913,x:1778,width:238,stateNum:1,skin:"myres/btn_small.png",name:"btn_copy",height:71,anchorY:.5,anchorX:.5,sizeGrid:"30,30,30,30"},child:[{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Label",props:{y:3,x:10,width:217,valign:"middle",text:"复制链接",height:61,fontSize:38,font:"fengyu",color:"#e8af71",align:"center"}}]}]}]},{type:"Sprite",props:{y:568,x:957,width:813,pivotY:409,pivotX:400,name:"pop",height:714},child:[{type:"Image",props:{y:400,x:400,width:1200,skin:"myres/pop_bg.png",name:"bg0",height:360,anchorY:.5,anchorX:.5,sizeGrid:"100,100,100,100"},child:[{type:"Image",props:{y:28,x:32,width:98,skin:"myres/pop_texturecut.png",name:"left",height:347,sizeGrid:"0,0,24,26"}},{type:"Image",props:{y:27,x:1174,width:110,skin:"myres/pop_texturecut.png",scaleX:-1,name:"right",height:346,sizeGrid:"0,0,24,26"}},{type:"Image",props:{y:59,x:32,width:1142,skin:"myres/pop_black.png",name:"bar",height:269}}]},{type:"Image",props:{y:400,x:400,width:1200,skin:"myres/pop_bound.png",name:"bound",height:360,anchorY:.5,anchorX:.5,sizeGrid:"131,102,97,106"}},{type:"Label",props:{y:313,x:-58,width:932,valign:"middle",text:"复制房间链接，发送给好友",name:"title",height:76,fontSize:45,font:"fengyu",color:"#e8af71",align:"center"}},{type:"Image",props:{y:399,x:-63,width:948,skin:"myres/inputbox.png",name:"input",height:80,sizeGrid:"7,12,10,9"},child:[{type:"TextInput",props:{y:-30,x:3,width:945,valign:"middle",promptColor:"#d0cdcd",name:"txtinput",height:138,fontSize:35,font:"SimHei",color:"#d0cdcd",align:"center"}}]},{type:"Button",props:{y:248,x:953,width:142,name:"btn_cancel",height:132,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:18,x:26,width:96,skin:"myres/btn_close.png",height:96}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]},{type:"Sprite",props:{y:0,x:0,width:1920,visible:!1,name:"invite_friend",height:1080},child:[{type:"Button",props:{y:0,x:0,width:1920,name:"blackbg",height:1080},child:[{type:"Image",props:{y:0,x:0,width:1920,skin:"myres/bbg.png",height:1080,alpha:.4,sizeGrid:"1,1,1,1"}}]},{type:"Image",props:{y:582,x:935,width:712,skin:"myres/pop2_bg.png",name:"root",mouseThrough:!1,height:661,anchorY:.5,anchorX:.5,sizeGrid:"2,2,2,2"},child:[{type:"Image",props:{y:0,x:0,width:712,skin:"myres/pop2_bound.png",name:"bound",height:661,sizeGrid:"24,27,11,21"}},{type:"Sprite",props:{y:35,x:666,width:50,name:"scrollbar",mouseThrough:!1,mouseEnabled:!0,height:600},child:[{type:"Image",props:{y:0,x:25,skin:"myres/scrollbar.png",name:"scrollbar",height:600,anchorX:.5}},{type:"Image",props:{y:96,x:25,width:45,skin:"myres/scrollpoint.png",name:"scrollpoint",height:45,anchorY:.5,anchorX:.5}}]},{type:"Panel",props:{y:39,x:28,width:671,name:"content",height:585},child:[{type:"Sprite",props:{y:0,x:5,width:649,name:"templete",height:135},child:[{type:"Image",props:{y:-14,x:-6,skin:"myres/bg_head1.png",scaleY:.75,scaleX:.75,name:"head"},child:[{type:"Image",props:{y:35,x:23,width:153,skin:"extendRes/charactor/yiji/smallhead.png",height:153}}]},{type:"Label",props:{y:38,x:143,width:345,text:"蹦蹦跳跳的仙太郎",name:"label_name",height:48,fontSize:40,font:"SimHei",color:"#ffffff",align:"left"}},{type:"Button",props:{y:72,x:569,width:144,name:"btn_invite",height:93,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Image",props:{y:11,x:3,width:137,skin:"myres/room/btn_invite.png",height:71,sizeGrid:"20,22,20,20"},child:[{type:"Label",props:{y:0,x:4,width:130,valign:"middle",text:"邀请",height:67,fontSize:40,font:"fengyu",color:"#e8af71",align:"center"}}]}]},{type:"Label",props:{y:37,x:503,width:130,valign:"middle",text:"已邀请",name:"invited",height:67,fontSize:40,font:"fengyu",color:"#70e875",align:"center"}},{type:"Script",props:{runtime:"capsui.UICopy"}},{type:"Label",props:{y:92,x:145,width:345,text:"正在游戏",name:"label_state",height:38,fontSize:30,font:"SimHei",color:"#fb6361",align:"left"}}]}]},{type:"Script",props:{runtime:"capsui.CScrollView"}},{type:"Label",props:{y:92,x:109,width:508,valign:"middle",text:"没有可邀请的好友",name:"noinfo",height:67,fontSize:40,font:"SimHei",color:"#e8af71",align:"center"}}]}]}]},i}(View);t.waitingroomUI=i}(e.lobby||(e.lobby={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.CButton",capsui.CButton),t.prototype.createChildren.call(this),this.createView(e.lobby.waitobUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Sprite",props:{y:560,x:960,width:500,pivotY:250,pivotX:250,name:"root",height:500},child:[{type:"Image",props:{y:250,x:250,width:550,skin:"myres/pop2_bg.png",name:"bg0",height:350,anchorY:.5,anchorX:.5,sizeGrid:"2,2,2,2"},child:[{type:"Image",props:{y:0,x:0,width:550,skin:"myres/pop2_bg.png",renderType:"mask",name:"mk",height:350,sizeGrid:"2,2,2,2"}},{type:"Image",props:{y:44,x:-160,width:935,skin:"myres/pop_black.png",name:"bar",height:258}}]},{type:"Image",props:{y:250,x:250,width:550,skin:"myres/pop2_bound.png",name:"bound",height:350,anchorY:.5,anchorX:.5,sizeGrid:"24,27,11,21"}},{type:"Label",props:{y:144,x:32,wordWrap:!0,width:455,text:"距离观战开始还剩：",height:130,fontSize:40,font:"SimHei",color:"#d6d1d1"}},{type:"Button",props:{y:338,x:250,width:158,stateNum:1,skin:"myres/bothui/btn_confirm.png",name:"btn_confirm",height:67,anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:0,x:0,width:161,valign:"middle",text:"确认",height:62,fontSize:40,font:"fengyu",color:"#e7b97a",align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Label",props:{y:220,x:101,wordWrap:!0,width:162,text:"269",name:"sec",height:67,fontSize:60,font:"SimHei",color:"#d6d1d1",align:"right"}},{type:"Label",props:{y:238,x:276,wordWrap:!0,width:118,text:"秒",height:41,fontSize:40,font:"SimHei",color:"#d6d1d1",align:"left"}}]}]},i}(View);t.waitobUI=i}(e.lobby||(e.lobby={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.createView(e.mj.alUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Image",props:{y:424,x:945,skin:"myres/mjdesktop/al.png",anchorY:.5,anchorX:.5},compId:2}],animations:[{nodes:[{target:2,keyframes:{scaleY:[{value:2,tweenMethod:"strongIn",tween:!0,target:2,key:"scaleY",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:2,key:"scaleY",index:6}],scaleX:[{value:2,tweenMethod:"strongIn",tween:!0,target:2,key:"scaleX",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:2,key:"scaleX",index:6}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:2,key:"alpha",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:2,key:"alpha",index:6}]}}],name:"start",id:1,frameRate:30,action:0}]},i}(View);t.alUI=i}(e.mj||(e.mj={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.CButton",capsui.CButton),t.prototype.createChildren.call(this),this.createView(e.mj.chipenghuUI.uiView)},i.uiView={type:"View",props:{y:0,x:0,width:1920,name:"root",mouseThrough:!0,height:1080},child:[{type:"Sprite",props:{y:821,x:812,width:1099,type:2,to_right:100,span:20,scaleY:.7,scaleX:.7,name:"container_btns",height:150},child:[{type:"Button",props:{y:87,x:-1225,width:384,visible:!0,stateNum:1,skin:"myres/mjdesktop/op_liuju.png",name:"btn_jiuzhongjiupai",height:186,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{y:74,x:-1208,sback_mask:"myres/op_btn_mask.png",move_y:20,move_x:20,runtime:"capsui.CButton"}}]},{type:"Button",props:{y:91,x:-986,width:384,visible:!0,toggle:!0,stateNum:1,skin:"myres/mjdesktop/op_chi.png",name:"btn_chi",height:186,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{sback_mask:"myres/op_btn_mask.png",move_y:20,move_x:20,runtime:"capsui.CButton"}}]},{type:"Button",props:{y:72,x:-764,width:384,visible:!0,stateNum:1,skin:"myres/mjdesktop/op_peng.png",name:"btn_peng",height:186,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{y:16,x:357,sback_mask:"myres/op_btn_mask.png",move_y:20,move_x:20,runtime:"capsui.CButton"}}]},{type:"Button",props:{y:58,x:-450,width:384,visible:!0,stateNum:1,skin:"myres/mjdesktop/op_gang.png",name:"btn_gang",height:186,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{y:40,x:53,sback_mask:"myres/op_btn_mask.png",move_y:20,move_x:20,runtime:"capsui.CButton"}}]},{type:"Button",props:{y:7,x:-50,width:384,visible:!0,stateNum:1,skin:"myres/mjdesktop/op_lizhi.png",name:"btn_lizhi",height:186,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{y:11,x:-208,sback_mask:"myres/op_btn_mask.png",move_y:20,move_x:20,runtime:"capsui.CButton"}}]},{type:"Button",props:{y:56,x:424,width:384,visible:!0,stateNum:1,skin:"myres/mjdesktop/op_hu.png",name:"btn_hu",height:186,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{y:59,x:-175,sback_mask:"myres/op_btn_mask.png",move_y:20,move_x:20,runtime:"capsui.CButton"}}]},{type:"Button",props:{y:-119,x:493,width:384,visible:!0,stateNum:1,skin:"myres/mjdesktop/op_zimo.png",name:"btn_zimo",height:186,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{y:81,x:-76,sback_mask:"myres/op_btn_mask.png",move_y:20,move_x:20,runtime:"capsui.CButton"}}]},{type:"Button",props:{y:64,x:808,width:384,visible:!0,stateNum:1,skin:"myres/mjdesktop/op_x.png",name:"btn_cancel",height:186,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{y:74,x:-1208,sback_mask:"myres/op_btn_mask.png",move_y:20,move_x:20,runtime:"capsui.CButton"}}]}]},{type:"Image",props:{y:626,x:369,width:1091,skin:"myres/mjdesktop/bg_chipengchoose.png",name:"container_detail",height:255,sizeGrid:"80,80,80,80"},child:[{type:"Image",props:{y:42,x:555,width:430,skin:"myres/mjdesktop/bg_chipengchoose_title.png",pivotY:46,pivotX:215,name:"container_title",height:56},child:[{type:"Label",props:{y:10,x:22,width:387,text:"请选择要吃的牌",name:"lab_title",height:48,fontSize:34,font:"SimHei",color:"#a45d4b",align:"center"}}]},{type:"Sprite",props:{y:88,x:151,width:756,name:"container_chooses",height:122},child:[{type:"Button",props:{y:-23,x:-66,width:324,name:"c0",height:122},child:[{type:"Image",props:{y:0,x:0,width:80,skin:"myres/8p.png",name:"img0",height:120}},{type:"Image",props:{y:0,x:80,width:80,skin:"myres/8p.png",name:"img1",height:120}},{type:"Image",props:{y:0,x:160,width:80,skin:"myres/8p.png",name:"img2",height:120}},{type:"Image",props:{y:0,x:240,width:80,skin:"myres/8p.png",name:"img3",height:120}}]},{type:"Button",props:{y:-23,x:437,width:324,name:"c1",height:122},child:[{type:"Image",props:{y:0,x:0,width:80,skin:"myres/8p.png",name:"img0",height:120}},{type:"Image",props:{y:0,x:80,width:80,skin:"myres/8p.png",name:"img1",height:120}},{type:"Image",props:{y:0,x:160,width:80,skin:"myres/8p.png",name:"img2",height:120}},{type:"Image",props:{y:0,x:240,width:80,skin:"myres/8p.png",name:"img3",height:120}}]},{type:"Button",props:{y:-23,x:0,width:324,name:"c2",height:122},child:[{type:"Image",props:{y:0,x:0,width:80,skin:"myres/8p.png",name:"img0",height:120}},{type:"Image",props:{y:0,x:80,width:80,skin:"myres/8p.png",name:"img1",height:120}},{type:"Image",props:{y:0,x:160,width:80,skin:"myres/8p.png",name:"img2",height:120}},{type:"Image",props:{y:0,x:240,width:80,skin:"myres/8p.png",name:"img3",height:120}}]},{type:"Button",props:{y:-23,x:0,width:324,name:"c3",height:122},child:[{type:"Image",props:{y:0,x:0,width:80,skin:"myres/8p.png",name:"img0",height:120}},{type:"Image",props:{y:0,x:80,width:80,skin:"myres/8p.png",name:"img1",height:120}},{type:"Image",props:{y:0,x:160,width:80,skin:"myres/8p.png",name:"img2",height:120}},{type:"Image",props:{y:0,x:240,width:80,skin:"myres/8p.png",name:"img3",height:120}}]},{type:"Button",props:{y:-23,x:2,width:324,name:"c4",height:122},child:[{type:"Image",props:{y:0,x:0,width:80,skin:"myres/8p.png",name:"img0",height:120}},{type:"Image",props:{y:0,x:80,width:80,skin:"myres/8p.png",name:"img1",height:120}},{type:"Image",props:{y:0,x:160,width:80,skin:"myres/8p.png",name:"img2",height:120}},{type:"Image",props:{y:0,x:240,width:80,skin:"myres/8p.png",name:"img3",height:120}}]},{type:"Button",props:{y:-23,x:37,width:324,pivotY:0,pivotX:0,name:"c5",height:122},child:[{type:"Image",props:{y:0,x:0,width:80,skin:"myres/8p.png",name:"img0",height:120}},{type:"Image",props:{y:0,x:80,width:80,skin:"myres/8p.png",name:"img1",height:120}},{type:"Image",props:{y:0,x:160,width:80,skin:"myres/8p.png",name:"img2",height:120}},{type:"Image",props:{y:0,x:240,width:80,skin:"myres/8p.png",name:"img3",height:120}}]}]},{type:"Button",props:{y:46,x:1035,width:72,stateNum:1,skin:"myres/mjdesktop/bg_chipeng_back.png",name:"btn_back",height:57,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{runtime:"capsui.CButton"}}]}]},{type:"Button",props:{y:848,x:1442,width:103,stateNum:1,skin:"myres/mjdesktop/bg_chipeng_back.png",name:"btn_cancel",height:98,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{runtime:"capsui.CButton"}}]}]},i}(View);t.chipenghuUI=i}(e.mj||(e.mj={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.CButton",capsui.CButton),t.prototype.createChildren.call(this),this.createView(e.mj.desktopInfoUI.uiView)},i.uiView={type:"View",props:{mouseThrough:!0},child:[{type:"Sprite",props:{y:-283,x:-1255,width:4563,name:"mbg",height:1747}},{type:"Button",props:{y:-283,x:-415,width:2544,name:"btn_double_pass",height:1541}},{type:"Button",props:{y:904,x:183,width:1442,name:"range_hand",height:188}},{type:"Sprite",props:{y:4,x:-1,width:335,name:"container_lefttop",height:209},child:[{type:"Image",props:{y:28,x:11,width:313,skin:"myres/mjdesktop/left_top.png",height:158}},{type:"Sprite",props:{y:44,x:28,width:283,name:"container_doras",height:86},child:[{type:"Image",props:{y:0,x:0,width:54,skin:"myres/back.png",name:"dora0",height:81}},{type:"Image",props:{y:0,x:56,width:54,skin:"myres/back.png",name:"dora1",height:81}},{type:"Image",props:{y:0,x:112,width:54,skin:"myres/back.png",name:"dora2",height:81}},{type:"Image",props:{y:0,x:168,width:54,skin:"myres/back.png",name:"dora3",height:81}},{type:"Image",props:{y:0,x:224,width:54,skin:"myres/back.png",name:"dora4",height:81}}]},{type:"Image",props:{y:139,x:117,width:24,skin:"myres/mjdesktop/w_0.png",name:"num_lizhi_0",height:36}},{type:"Image",props:{y:139,x:142,width:24,skin:"myres/mjdesktop/w_0.png",name:"num_lizhi_1",height:36}},{type:"Image",props:{y:139,x:256,width:24,skin:"myres/mjdesktop/w_0.png",name:"num_ben_0",height:36}},{type:"Image",props:{y:139,x:281,width:24,skin:"myres/mjdesktop/w_0.png",name:"num_ben_1",height:36}},{type:"Image",props:{y:186,x:23,width:290,skin:"myres/mjdesktop/bg_type.png",name:"gamemode",height:51},child:[{type:"Label",props:{y:4,x:143,width:309,text:"玉之间·四人南",name:"lb_mode",height:42,fontSize:35,font:"hanyi",color:"#e8af71",anchorX:.5,align:"center"}}]},{type:"Label",props:{y:51,x:32,wordWrap:!0,width:276,text:"本局MD5码：BD44409041410FFA0B10609B8654CCB6",name:"MD5",height:78,fontSize:25,font:"SimHei",color:"#e5e5e5",align:"left"}},{type:"Button",props:{y:32,x:19,width:301,name:"btn_md5change",height:141}}]},{type:"Sprite",props:{y:3,x:1669,width:253,name:"container_righttop",height:77},child:[{type:"Button",props:{y:72,x:10,width:153,name:"btn_set",height:107,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:0,x:0,skin:"myres/mjdesktop/quit_btn.png",scaleY:1.2,scaleX:1.2}},{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Label",props:{y:23,x:13,width:124,valign:"middle",text:"设置",height:61,fontSize:50,font:"fengyu",color:"#494752",align:"center"}}]},{type:"Button",props:{y:73,x:166,width:153,pivotY:55,pivotX:74,name:"btn_leave",height:107},child:[{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Image",props:{y:0,x:0,skin:"myres/mjdesktop/quit_btn.png",scaleY:1.2,scaleX:1.2}},{type:"Label",props:{y:19,x:13,width:126,valign:"middle",text:"退出",height:70,fontSize:50,font:"fengyu",color:"#494752",align:"center"}}]},{type:"Button",props:{y:73,x:166,width:153,pivotY:55,pivotX:74,name:"btn_fanzhong",height:107},child:[{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Image",props:{y:0,x:0,skin:"myres/mjdesktop/quit_btn.png",scaleY:1.2,scaleX:1.2}},{type:"Label",props:{y:19,x:13,width:126,valign:"middle",text:"役种",height:70,fontSize:50,font:"fengyu",color:"#494752",align:"center"}}]}]},{type:"Sprite",props:{y:227,x:15,width:192,name:"container_player_3",height:186},child:[{type:"Image",props:{y:139,x:20,width:151,skin:"myres/mjdesktop/bg_name.png",name:"container_name",height:32,alpha:1},child:[{type:"Label",props:{y:3,x:-26,width:200,text:"啦啦啦啦啦啦",name:"label_name",height:28,fontSize:22,font:"SimHei",color:"#ffffff",align:"center"}}]},{type:"Sprite",props:{y:176,x:-39,width:767,name:"container_shout",height:436},child:[{type:"Image",props:{y:68,x:571,width:608,skin:"myres/mjdesktop/shout_horizontal.png",scaleX:-1,name:"container_shout",height:320}},{type:"Sprite",props:{y:-9,x:-142,name:"illust"},child:[{type:"Image",props:{y:-193,x:433,width:601,skin:"myres/mjdesktop/shout_maskleftright.png",scaleX:-1,renderType:"mask",name:"mask",height:531,anchorX:.5}},{type:"Image",props:{y:-178,x:78,width:789,skin:"extendRes/charactor/yiji/half.png",name:"illust",height:523},child:[{type:"Image",props:{}}]}]},{type:"Image",props:{y:69,x:352,width:211,skin:"myres/mjdesktop/shout_chi.png",name:"img_content",height:161}}]},{type:"Sprite",props:{y:94,x:168,width:227,name:"chat_bubble",height:200},child:[{type:"Image",props:{y:0,x:0,width:217,skin:"myres/mjdesktop/bg_chat_content.png",height:184,sizeGrid:"56,28,40,61"}},{type:"Image",props:{y:93,x:124,width:160,name:"content",height:160,anchorY:.5,anchorX:.5}}]},{type:"Image",props:{y:-5,x:21,skin:"myres/bg_head1.png",scaleY:.75,scaleX:.75,name:"head"},child:[{type:"Image",props:{y:35,x:23,width:153,skin:"extendRes/charactor/yiji/smallhead.png",height:153},child:[{type:"Image",props:{}},{type:"Image",props:{y:0,x:0,width:153,skin:"myres/bbg.png",name:"disconnect",height:153,alpha:.7,sizeGrid:"1,1,1,1"},child:[{type:"Image",props:{y:0,x:0,width:153,skin:"myres/mjdesktop/lightning.png",height:153,alpha:.8}}]}]}]},{type:"Image",props:{y:172,x:10,width:178,skin:"extendRes/title/notitle.png",name:"title",height:35}},{type:"Button",props:{y:10,x:18,width:154,name:"btn_head",height:167},child:[{type:"Button",props:{y:224,x:132,width:95,pivotY:48,pivotX:47,name:"btn_seeinfo",height:93},child:[{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Image",props:{y:4,x:4,skin:"myres/mjdesktop/checkinfo.png",scaleY:1.1,scaleX:1.1,name:"info"}}]},{type:"Button",props:{y:222,x:256,width:100,name:"btn_banemj",height:100,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:8,x:8,skin:"myres/mjdesktop/mute.png",scaleY:1.1,scaleX:1.1,name:"mute"}},{type:"Image",props:{y:8,x:8,skin:"myres/mjdesktop/mute_on.png",scaleY:1.1,scaleX:1.1,name:"banned"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:222,x:256,width:100,name:"btn_change",height:100,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:8,x:8,skin:"myres/mjdesktop/OB_icon.png",scaleY:1.1,scaleX:1.1,name:"mute"}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]}]},{type:"Sprite",props:{y:8,x:1310,width:192,name:"container_player_2",height:186},child:[{type:"Image",props:{y:139,x:31,width:151,skin:"myres/mjdesktop/bg_name.png",name:"container_name",mouseThrough:!0,height:32,alpha:1},child:[{type:"Label",props:{y:3,x:-26,width:200,text:"啦啦啦啦啦啦",name:"label_name",mouseThrough:!0,height:28,fontSize:22,font:"SimHei",color:"#ffffff",align:"center"}}]},{type:"Sprite",props:{y:-210,x:278,width:767,name:"container_shout",height:436},child:[{type:"Image",props:{y:412,x:-576,width:726,skin:"myres/mjdesktop/shout_vertical.png",rotation:180,pivotY:237,pivotX:378,name:"container_shout",height:450}},{type:"Sprite",props:{y:0,x:0,name:"illust"},child:[{type:"Image",props:{y:193,x:-878,width:612,skin:"myres/mjdesktop/shout_maskup.png",renderType:"mask",name:"mask",height:423}},{type:"Image",props:{y:203,x:-239,width:789,skin:"extendRes/charactor/yiji/half.png",scaleX:-1,name:"illust",height:523},child:[{type:"Image",props:{}}]}]},{type:"Image",props:{y:459,x:-890,skin:"myres/mjdesktop/shout_chi.png",name:"img_content"}}]},{type:"Sprite",props:{y:88,x:18,width:227,pivotX:227,name:"chat_bubble",height:200},child:[{type:"Image",props:{y:0,x:227,width:217,skin:"myres/mjdesktop/bg_chat_content.png",scaleX:-1,height:186,sizeGrid:"56,28,40,61"}},{type:"Image",props:{y:93,x:103,width:160,name:"content",height:160,anchorY:.5,anchorX:.5}}]},{type:"Image",props:{y:-5,x:33,skin:"myres/bg_head1.png",scaleY:.75,scaleX:.75,name:"head"},child:[{type:"Image",props:{y:35,x:23,width:153,height:153},child:[{type:"Image",props:{}},{type:"Image",props:{y:0,x:0,width:153,skin:"myres/bbg.png",name:"disconnect",height:153,alpha:.7,sizeGrid:"1,1,1,1"},child:[{type:"Image",props:{y:0,x:0,width:153,skin:"myres/mjdesktop/lightning.png",height:153,alpha:.8}}]}]}]},{type:"Image",props:{y:172,x:10,width:178,skin:"extendRes/title/notitle.png",name:"title",height:35}},{type:"Button",props:{y:4,x:26,width:161,name:"btn_head",height:174},child:[{type:"Button",props:{y:230,x:163,width:100,name:"btn_banemj",height:100,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:9,x:8,skin:"myres/mjdesktop/mute.png",scaleY:1.1,scaleX:1.1,name:"mute"}},{type:"Image",props:{y:9,x:8,skin:"myres/mjdesktop/mute_on.png",scaleY:1.1,scaleX:1.1,name:"banned"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:230,x:7,width:89,pivotY:44,pivotX:43,name:"btn_seeinfo",height:88},child:[{type:"Image",props:{skin:"myres/mjdesktop/checkinfo.png",scaleY:1.1,scaleX:1.1}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:230,x:163,width:100,name:"btn_change",height:100,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:9,x:8,skin:"myres/mjdesktop/OB_icon.png",scaleY:1.1,scaleX:1.1,name:"mute"}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]}]},{type:"Sprite",props:{y:180,x:1738,width:192,name:"container_player_1",height:186},child:[{type:"Image",props:{y:183,x:-2,width:151,skin:"myres/mjdesktop/bg_name.png",name:"container_name",height:32,alpha:1},child:[{type:"Label",props:{y:3,x:-26,width:200,text:"啦啦啦啦啦啦",name:"label_name",height:28,fontSize:22,font:"SimHei",color:"#ffffff",align:"center"}}]},{type:"Sprite",props:{y:222,x:-546,width:767,name:"container_shout",height:436},child:[{type:"Image",props:{y:79,x:158,width:608,skin:"myres/mjdesktop/shout_horizontal.png",name:"container_shout",height:320}},{type:"Sprite",props:{y:0,x:0,name:"illust"},child:[{type:"Image",props:{y:-193,x:133,width:601,skin:"myres/mjdesktop/shout_maskleftright.png",renderType:"mask",name:"mask",height:531}},{type:"Image",props:{y:-178,x:865,width:789,skin:"extendRes/charactor/yiji/half.png",scaleX:-1,name:"illust",height:523},child:[{type:"Image",props:{}}]}]},{type:"Image",props:{y:66,x:160,width:211,skin:"myres/mjdesktop/shout_chi.png",name:"img_content",height:161}}]},{type:"Sprite",props:{y:83,x:8,width:227,pivotX:227,name:"chat_bubble",height:200},child:[{type:"Image",props:{y:0,x:227,width:218,skin:"myres/mjdesktop/bg_chat_content.png",scaleX:-1,height:186,sizeGrid:"56,28,40,61"}},{type:"Image",props:{y:93,x:102,width:160,name:"content",height:160,anchorY:.5,anchorX:.5}}]},{type:"Image",props:{y:41,x:-1,skin:"myres/bg_head1.png",scaleY:.75,scaleX:.75,name:"head"},child:[{type:"Image",props:{y:35,x:23,width:153,skin:"extendRes/charactor/yiji/smallhead.png",height:153},child:[{type:"Image",props:{}},{type:"Image",props:{y:0,x:0,width:153,skin:"myres/bbg.png",name:"disconnect",height:153,alpha:.7,sizeGrid:"1,1,1,1"},child:[{type:"Image",props:{y:0,x:0,width:153,skin:"myres/mjdesktop/lightning.png",height:153,alpha:.8}}]}]}]},{type:"Image",props:{y:216,x:-12,width:178,skin:"extendRes/title/notitle.png",name:"title",height:35}},{type:"Button",props:{y:130,x:74,width:148,pivotY:71,pivotX:73,name:"btn_head",height:154},child:[{type:"Button",props:{y:210,x:84,width:100,name:"btn_banemj",height:100,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:9,x:9,skin:"myres/mjdesktop/mute.png",scaleY:1.1,scaleX:1.1,name:"mute"}},{type:"Image",props:{y:9,x:9,skin:"myres/mjdesktop/mute_on.png",scaleY:1.1,scaleX:1.1,name:"banned"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:210,x:-21,width:99,pivotY:53,pivotX:52,name:"btn_seeinfo",height:98},child:[{type:"Image",props:{skin:"myres/mjdesktop/checkinfo.png",centerY:1.1,centerX:1.1}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:210,x:84,width:100,name:"btn_change",height:100,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:9,x:9,skin:"myres/mjdesktop/OB_icon.png",scaleY:1.1,scaleX:1.1,name:"mute"}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]}]},{type:"Sprite",props:{y:708,x:365,width:192,name:"container_player_0",height:186},child:[{type:"Image",props:{y:139,x:20,width:151,skin:"myres/mjdesktop/bg_name.png",name:"container_name",height:32,alpha:1},child:[{type:"Label",props:{y:3,x:-26,width:200,text:"啦啦啦啦啦啦",name:"label_name",height:28,fontSize:22,font:"SimHei",color:"#ffffff",align:"center"}}]},{type:"Sprite",props:{y:-220,x:268,width:767,name:"container_shout",height:436},child:[{type:"Image",props:{y:44,x:-17,width:602,skin:"myres/mjdesktop/shout_vertical.png",name:"container_shout",height:374}},{type:"Sprite",props:{y:-591,x:-683,name:"illust"},child:[{type:"Image",props:{y:325,x:517,width:882,skin:"myres/mjdesktop/shou_maskdown.png",renderType:"mask",name:"mask",height:677}},{type:"Image",props:{y:532,x:525,width:789,skin:"extendRes/charactor/yiji/half.png",name:"illust",height:523},child:[{type:"Image",props:{}}]}]},{type:"Image",props:{y:228,x:-37,width:250,skin:"myres/mjdesktop/shout_lizhi.png",name:"img_content",height:191}}]},{type:"Sprite",props:{y:78,x:178,width:227,pivotY:200,name:"chat_bubble",height:200},child:[{type:"Image",props:{y:200,x:0,width:217,skin:"myres/mjdesktop/bg_chat_content.png",scaleY:-1,height:185,sizeGrid:"56,28,40,61"}},{type:"Image",props:{y:108,x:124,width:160,name:"content",height:160,anchorY:.5,anchorX:.5}}]},{type:"Image",props:{y:-5,x:21,skin:"myres/bg_head1.png",scaleY:.75,scaleX:.75,name:"head"},child:[{type:"Image",props:{y:35,x:23,width:153,skin:"extendRes/charactor/yiji/smallhead.png",height:153},child:[{type:"Image",props:{}},{type:"Image",props:{y:0,x:0,width:153,skin:"myres/bbg.png",name:"disconnect",height:153,alpha:.7,sizeGrid:"1,1,1,1"},child:[{type:"Image",props:{y:0,x:0,width:153,skin:"myres/mjdesktop/lightning.png",height:153,alpha:.8}}]}]}]},{type:"Button",props:{y:18,x:22,width:151,name:"btn_seeinfo",height:141}},{type:"Image",props:{y:172,x:10,width:178,skin:"extendRes/title/notitle.png",name:"title",height:35}}]},{type:"Sprite",props:{y:763,x:1419,width:372,name:"container_countdown",height:117},child:[{type:"Image",props:{y:34,x:157,width:57,skin:"myres/mjdesktop/at_plus.png",name:"plus",height:75},compId:208,child:[{type:"Image",props:{y:2,x:46,width:57,skin:"myres/mjdesktop/at_1.png",name:"add_0",height:75}},{type:"Image",props:{y:2,x:89,width:57,skin:"myres/mjdesktop/at_1.png",name:"add_1",height:75}}]},{type:"Sprite",props:{y:0,x:0,width:159,name:"c0",height:111,alpha:0},compId:332,child:[{type:"Image",props:{y:57,x:43,width:87,skin:"myres/mjdesktop/t_1.png",name:"num1",height:115,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:57,x:118,width:87,skin:"myres/mjdesktop/t_8.png",name:"num0",height:115,anchorY:.5,anchorX:.5}}]},{type:"Sprite",props:{y:54,x:121,width:159,pivotY:51,pivotX:121,name:"c1",height:111},compId:337,child:[{type:"Image",props:{y:57,x:43,width:87,skin:"myres/mjdesktop/t_1.png",name:"num1",height:115,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:57,x:118,width:87,skin:"myres/mjdesktop/t_8.png",name:"num0",height:115,anchorY:.5,anchorX:.5}}]}]},{type:"Button",props:{y:315,x:806,width:308,name:"btn_change_score",height:214}},{type:"Image",props:{y:953,x:70,width:150,skin:"myres/pic_zhengting.png",name:"img_zhenting",height:100}},{type:"Sprite",props:{y:368,x:-528,width:629,name:"container_func",mouseThrough:!0,height:543},child:[{type:"Image",props:{y:-2,x:535.4,width:222,skin:"myres/mjdesktop/chat.png",scaleY:1.2,scaleX:-1.2,name:"bg",mouseThrough:!0,height:464,sizeGrid:"26,0,27,24"}},{type:"Image",props:{y:81,x:605,width:87,skin:"myres/mjdesktop/chat_btn.png",scaleX:-1,name:"btn",height:382,sizeGrid:"27,18,27,16"}},{type:"Button",props:{y:83,x:399,width:199,scaleY:1.2,scaleX:1.2,name:"btn_autolipai",height:100,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:0,x:0,width:192,skin:"myres/mjdesktop/func_btn.png",height:100,sizeGrid:"26,17,21,23"}},{type:"Label",props:{y:35,x:51,width:130,text:"自动理牌",scaleY:.8,scaleX:.8,height:41,fontSize:30,font:"youyuan",color:"#f9f9f9"}},{type:"Image",props:{y:35,x:12,width:34,skin:"myres/mjdesktop/unchoosed.png",height:34}},{type:"Image",props:{y:35,x:12,width:34,skin:"myres/mjdesktop/choosed.png",name:"img_choosed",height:34}},{type:"Label",props:{y:69,x:215,width:43,text:"理",name:"out",height:45,fontSize:40,font:"fengyu",color:"#7992b3"}}]},{type:"Button",props:{y:211,x:399,width:199,scaleY:1.2,scaleX:1.2,name:"btn_autohu",height:100,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:0,x:0,width:192,skin:"myres/mjdesktop/func_btn.png",height:100,sizeGrid:"26,17,21,23"}},{type:"Label",props:{y:35,x:51,width:130,text:"自动和牌",scaleY:.8,scaleX:.8,height:41,fontSize:30,font:"youyuan",color:"#f9f9f9"}},{type:"Image",props:{y:35,x:12,width:34,skin:"myres/mjdesktop/unchoosed.png",height:34}},{type:"Image",props:{y:35,x:12,width:34,skin:"myres/mjdesktop/choosed.png",name:"img_choosed",height:34}},{type:"Label",props:{y:16,x:215,width:43,text:"和",name:"out",height:45,fontSize:40,font:"fengyu",color:"#7992b3"}}]},{type:"Button",props:{y:339,x:399,width:199,scaleY:1.2,scaleX:1.2,name:"btn_autonoming",height:100,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:0,x:0,width:192,skin:"myres/mjdesktop/func_btn.png",height:100,sizeGrid:"26,17,21,23"}},{type:"Label",props:{y:35,x:51,width:130,text:"不吃碰杠",scaleY:.8,scaleX:.8,height:41,fontSize:30,font:"youyuan",color:"#f9f9f9"}},{type:"Image",props:{y:35,x:12,width:34,skin:"myres/mjdesktop/unchoosed.png",height:34}},{type:"Image",props:{y:35,x:12,width:34,skin:"myres/mjdesktop/choosed.png",name:"img_choosed",height:34}},{type:"Label",props:{y:-35,x:215,width:43,text:"鸣",name:"out",height:45,fontSize:40,font:"fengyu",color:"#7992b3"}}]},{type:"Button",props:{y:467,x:399,width:199,scaleY:1.2,scaleX:1.2,name:"btn_automoqie",height:100,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:0,x:0,width:192,skin:"myres/mjdesktop/func_btn.png",height:100,sizeGrid:"26,17,21,23"}},{type:"Image",props:{y:35,x:12,width:34,skin:"myres/mjdesktop/unchoosed.png",height:34}},{type:"Image",props:{y:35,x:12,width:34,skin:"myres/mjdesktop/choosed.png",name:"img_choosed",height:34}},{type:"Label",props:{y:35,x:51,width:130,text:"自动摸切",scaleY:.8,scaleX:.8,height:41,fontSize:30,font:"youyuan",color:"#f9f9f9"}},{type:"Label",props:{y:-92,x:215,width:43,text:"切",name:"out",height:45,fontSize:40,font:"fengyu",color:"#7992b3"}}]},{type:"Button",props:{y:76,x:517,width:98,name:"btn_func",height:393}},{type:"Image",props:{y:394,x:562,width:22,skin:"myres/mjdesktop/func_arrow.png",scaleX:-1,name:"arrow",height:43,anchorY:.5,anchorX:.5}},{type:"Button",props:{y:101,x:530,width:71,name:"btn_autolipai2",height:64}},{type:"Button",props:{y:164,x:531,width:71,name:"btn_autohu2",height:64}},{type:"Button",props:{y:231,x:531,width:71,name:"btn_autonoming2",height:64}},{type:"Button",props:{y:294,x:532,width:71,name:"btn_automoqie2",height:64}},{type:"Button",props:{y:364,x:534,width:71,name:"btn_func2",height:73}}]},{type:"Sprite",props:{y:273,x:1903,width:1008,name:"container_chat_choose",height:598},child:[{type:"Image",props:{y:49,x:10,width:440,skin:"myres/mjdesktop/chat.png",scaleY:1.2,scaleX:1.2,height:460,sizeGrid:"26,0,27,24"}},{type:"Button",props:{y:227,x:-63,width:88,name:"btn_chat",height:225}},{type:"Sprite",props:{y:194,x:582,width:370,name:"container",height:370},child:[{type:"Button",props:{y:-32,x:-460,width:150,stateNum:1,name:"e0",height:150,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:139,x:-459,width:150,stateNum:1,name:"e1",height:150,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:304,x:-455,width:150,stateNum:1,name:"e2",height:150,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:85,x:85,width:110,stateNum:1,name:"e3",height:110,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:95,x:95,width:110,stateNum:1,name:"e4",height:110,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:105,x:105,width:110,stateNum:1,name:"e5",height:110,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:115,x:115,width:110,stateNum:1,name:"e6",height:110,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:125,x:125,width:110,stateNum:1,name:"e7",height:110,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:135,x:135,width:110,stateNum:1,name:"e8",height:110,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{runtime:"capsui.CButton"}}]}]},{type:"Image",props:{y:224,x:-60,width:87,skin:"myres/mjdesktop/chat_btn.png",height:195,sizeGrid:"27,18,27,16"}},{type:"Label",props:{y:261,x:-40,wordWrap:!0,width:48,text:"表",scaleY:1.2,scaleX:1.2,name:"emo",height:90,fontSize:48,font:"fengyu",color:"#e19137"}},{type:"Label",props:{y:323,x:-40,wordWrap:!0,width:48,text:"情",scaleY:1.2,scaleX:1.2,name:"emo",height:90,fontSize:48,font:"fengyu",color:"#e19137"}}]},{type:"Image",props:{y:1002,x:1828,width:84,skin:"myres/mjdesktop/signal_normal.png",name:"img_signal",height:72}}],animations:[{nodes:[{target:332,keyframes:{alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:332,key:"alpha",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:332,key:"alpha",index:25},{value:0,tweenMethod:"linearNone",tween:!0,target:332,key:"alpha",index:30}]}}],name:"cd0",id:1,frameRate:30,action:0},{nodes:[{target:337,keyframes:{scaleY:[{value:1,tweenMethod:"strongOut",tween:!0,target:337,key:"scaleY",index:0},{value:1.5,tweenMethod:"linearNone",tween:!0,target:337,key:"scaleY",index:12}],scaleX:[{value:1,tweenMethod:"strongOut",tween:!0,target:337,key:"scaleX",index:0},{value:1.5,tweenMethod:"linearNone",tween:!0,target:337,key:"scaleX",index:12}],alpha:[{value:1,tweenMethod:"strongOut",tween:!0,target:337,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:337,key:"alpha",index:12}]}}],name:"cd1",id:2,frameRate:30,action:0},{nodes:[{target:208,keyframes:{alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:208,key:"alpha",index:0},{value:1,tweenMethod:"strongIn",tween:!0,target:208,key:"alpha",index:28},{value:0,tweenMethod:"linearNone",tween:!0,target:208,key:"alpha",index:30}]}},{target:332,keyframes:{alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:332,key:"alpha",index:0},{value:1,tweenMethod:"strongIn",tween:!0,target:332,key:"alpha",index:28},{value:0,tweenMethod:"linearNone",tween:!0,target:332,key:"alpha",index:30}]}}],name:"cd2",id:3,frameRate:30,action:0}]},i}(View);t.desktopInfoUI=i}(e.mj||(e.mj={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.createView(e.mj.fightbeginUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Image",props:{y:-1860,x:-1540,width:5e3,skin:"myres/bbg.png",name:"blackbg",height:5e3,sizeGrid:"1,1,1,1"}},{type:"Sprite",props:{y:54,x:-332,width:1187,name:"container_3",height:992},child:[{type:"Image",props:{y:41,x:332,width:863,skin:"myres/mjdesktop/start_left.png",height:924}},{type:"Sprite",props:{name:"illust"},child:[{type:"Image",props:{y:41,x:332,width:863,skin:"myres/mjdesktop/start_left.png",renderType:"mask",height:924}},{type:"Image",props:{y:179,x:132,width:1063,skin:"extendRes/charactor/yiji/full.png",name:"body",height:1601}}]},{type:"Image",props:{y:692,x:346,width:682,skin:"myres/namebg.png",name:"container_name",height:126},child:[{type:"Label",props:{y:37,x:110,width:457,text:"搞什么飞机啊啊啊",name:"label_name",height:45,fontSize:45,font:"SimHei",color:"#ffffff"}},{type:"Image",props:{y:54,x:58,width:255,scaleY:.55,scaleX:.55,pivotY:114,pivotX:128,name:"rank",height:253},child:[{type:"Image",props:{y:0,x:0,skin:"myres/rank_bg.png",name:"bg"}},{type:"Image",props:{y:15,x:0,skin:"extendRes/level/queshi.png",name:"icon"}},{type:"Image",props:{y:191,x:58,skin:"myres/starbg.png",scaleY:1,scaleX:1,name:"star2",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]},{type:"Image",props:{y:142,x:29,skin:"myres/starbg.png",scaleY:.7,scaleX:.7,name:"star3",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]},{type:"Image",props:{y:214,x:110,skin:"myres/starbg.png",scaleY:.7,scaleX:.7,name:"star1",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]}]},{type:"Image",props:{y:-40,x:105,width:263,skin:"extendRes/title/notitle.png",scaleY:1.3,scaleX:1.3,name:"title",height:50}}]}]},{type:"Sprite",props:{y:350,x:380,width:1187,name:"container_0",height:992},child:[{type:"Image",props:{y:169,x:-292,width:1798,skin:"myres/mjdesktop/start_down.png",height:585}},{type:"Sprite",props:{name:"illust"},child:[{type:"Image",props:{y:169,x:-292,width:1798,skin:"myres/mjdesktop/start_down.png",renderType:"mask",height:585}},{type:"Image",props:{y:181,x:55,width:1004,skin:"extendRes/charactor/yiji/half.png",name:"body",height:666}}]},{type:"Image",props:{y:579,x:829,width:682,skin:"myres/namebg.png",name:"container_name",height:126},child:[{type:"Label",props:{y:37,x:110,width:457,text:"搞什么飞机啊啊啊",name:"label_name",height:45,fontSize:45,font:"SimHei",color:"#ffffff"}},{type:"Image",props:{y:54,x:58,width:255,scaleY:.55,scaleX:.55,pivotY:114,pivotX:128,name:"rank",height:253},child:[{type:"Image",props:{y:0,x:0,skin:"myres/rank_bg.png",name:"bg"}},{type:"Image",props:{y:15,x:0,skin:"extendRes/level/queshi.png",name:"icon"}},{type:"Image",props:{y:191,x:58,skin:"myres/starbg.png",scaleY:1,scaleX:1,name:"star2",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]},{type:"Image",props:{y:142,x:29,skin:"myres/starbg.png",scaleY:.7,scaleX:.7,name:"star3",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]},{type:"Image",props:{y:214,x:110,skin:"myres/starbg.png",scaleY:.7,scaleX:.7,name:"star1",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]}]},{type:"Image",props:{y:-40,x:105,width:263,skin:"extendRes/title/notitle.png",scaleY:1.3,scaleX:1.3,name:"title",height:50}}]},{type:"Image",props:{y:555,x:1268,width:105,skin:"myres/mjdesktop/myself.png",height:50}}]},{type:"Sprite",props:{y:-95,x:1094,width:1187,name:"container_1",height:992},child:[{type:"Image",props:{y:88,x:95,width:744,skin:"myres/mjdesktop/start_right.png",height:816}},{type:"Sprite",props:{name:"illust"},child:[{type:"Image",props:{y:88,x:95,width:744,skin:"myres/mjdesktop/start_right.png",renderType:"mask",height:816}},{type:"Image",props:{y:185,x:584,width:1063,skin:"extendRes/charactor/yiji/full.png",scaleX:-1,name:"body",height:1601,anchorX:.5}}]},{type:"Image",props:{y:651,x:242,width:682,skin:"myres/namebg.png",name:"container_name",height:126},child:[{type:"Label",props:{y:37,x:110,width:457,text:"搞什么飞机啊啊啊",name:"label_name",height:45,fontSize:45,font:"SimHei",color:"#ffffff"}},{type:"Image",props:{y:54,x:58,width:255,scaleY:.55,scaleX:.55,pivotY:114,pivotX:128,name:"rank",height:253},child:[{type:"Image",props:{y:0,x:0,skin:"myres/rank_bg.png",name:"bg"}},{type:"Image",props:{y:15,x:0,skin:"extendRes/level/queshi.png",name:"icon"}},{type:"Image",props:{y:191,x:58,skin:"myres/starbg.png",scaleY:1,scaleX:1,name:"star2",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]},{type:"Image",props:{y:142,x:29,skin:"myres/starbg.png",scaleY:.7,scaleX:.7,name:"star3",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]},{type:"Image",props:{y:214,x:110,skin:"myres/starbg.png",scaleY:.7,scaleX:.7,name:"star1",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]}]},{type:"Image",props:{y:-40,x:105,width:263,skin:"extendRes/title/notitle.png",scaleY:1.3,scaleX:1.3,name:"title",height:50}}]}]},{type:"Sprite",props:{y:-259,x:392,width:1187,name:"container_2",height:992},child:[{type:"Image",props:{y:255,x:-285,width:1659,skin:"myres/mjdesktop/start_up.png",height:457}},{type:"Sprite",props:{name:"illust"},child:[{type:"Image",props:{y:255,x:-285,width:1659,skin:"myres/mjdesktop/start_up.png",renderType:"mask",height:457}},{type:"Image",props:{y:221,x:652,width:988,skin:"extendRes/charactor/yiji/half.png",scaleX:-1,name:"body",height:657,anchorX:.5}}]},{type:"Image",props:{y:305,x:-109,width:682,skin:"myres/namebg.png",name:"container_name",height:126},child:[{type:"Label",props:{y:37,x:110,width:457,text:"搞什么飞机啊啊啊",name:"label_name",height:45,fontSize:45,font:"SimHei",color:"#ffffff"}},{type:"Image",props:{y:54,x:58,width:255,scaleY:.55,scaleX:.55,pivotY:114,pivotX:128,name:"rank",height:253},child:[{type:"Image",props:{y:0,x:0,skin:"myres/rank_bg.png",name:"bg"}},{type:"Image",props:{y:15,x:0,skin:"extendRes/level/queshi.png",name:"icon"}},{type:"Image",props:{y:191,x:58,skin:"myres/starbg.png",scaleY:1,scaleX:1,name:"star2",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]},{type:"Image",props:{y:142,x:29,skin:"myres/starbg.png",scaleY:.7,scaleX:.7,name:"star3",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]},{type:"Image",props:{y:214,x:110,skin:"myres/starbg.png",scaleY:.7,scaleX:.7,name:"star1",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",anchorY:.5,anchorX:.5}}]}]},{type:"Image",props:{y:-40,x:105,width:263,skin:"extendRes/title/notitle.png",scaleY:1.3,scaleX:1.3,name:"title",height:50}}]}]},{type:"Sprite",props:{y:493,x:1012,name:"container_effect"}}]},i}(View);t.fightbeginUI=i}(e.mj||(e.mj={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.CButton",capsui.CButton),t.prototype.createChildren.call(this),this.createView(e.mj.gameendUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Sprite",props:{name:"root"},child:[{type:"Image",props:{y:-10,x:-10,width:2e3,skin:"myres/bbg.png",name:"blackmask",height:1180,alpha:.7,sizeGrid:"1,1,1,1"}},{type:"Image",props:{y:62,x:-3,width:960,skin:"extendRes/charactor/yiji/full.png",name:"illust",height:1445},child:[{type:"Image",props:{}}]},{type:"Image",props:{y:180,x:662,width:1155,skin:"myres/mjdesktop/bg_end0.png",scaleY:.95,scaleX:.95,name:"p0",height:224},child:[{type:"Image",props:{y:-22,x:133,skin:"myres/bg_head1.png",name:"head"},child:[{type:"Image",props:{y:36,x:24,width:152,skin:"extendRes/charactor/yiji/smallhead.png",height:152},child:[{type:"Image",props:{}}]}]},{type:"Label",props:{y:17,x:341,width:333,text:"啦啦啦啦啦啦啦啦",name:"label_name",height:54,fontSize:44,font:"SimHei",color:"#ffffff"}},{type:"Sprite",props:{y:124,x:436,width:493,scaleY:.7,scaleX:.7,pivotY:57,pivotX:138,name:"container_score",height:110},child:[{type:"Image",props:{y:0,x:0,skin:"myres/mjdesktop/ww_2.png",name:"6"}},{type:"Image",props:{x:70,skin:"myres/mjdesktop/ww_2.png",name:"5"}},{type:"Image",props:{y:0,x:140,skin:"myres/mjdesktop/ww_2.png",name:"4"}},{type:"Image",props:{y:0,x:210,skin:"myres/mjdesktop/ww_2.png",name:"3"}},{type:"Image",props:{y:0,x:280,skin:"myres/mjdesktop/ww_2.png",name:"2"}},{type:"Image",props:{y:0,x:350,skin:"myres/mjdesktop/ww_2.png",name:"1"}},{type:"Image",props:{y:0,x:420,skin:"myres/mjdesktop/ww_2.png",name:"0"}}]},{type:"Image",props:{y:43,x:894,width:40,skin:"myres/gold0.png",name:"img_g0",height:40},child:[{type:"Label",props:{y:1,x:50,width:236,text:"+10000",scaleY:.8,scaleX:.8,name:"val",height:72,fontSize:40,font:"haolong",color:"#ffffff"}}]},{type:"Image",props:{y:98,x:912,width:40,skin:"myres/PT.png",name:"img_g1",height:40},child:[{type:"Label",props:{y:1,x:50,width:236,text:"+10000",scaleY:.8,scaleX:.8,name:"val",height:72,fontSize:40,font:"haolong",color:"#ffffff"}}]},{type:"Label",props:{y:94,x:703,width:149,text:"+4500",name:"val",height:49,fontSize:50,font:"haolong",color:"#45c36a",align:"center"}},{type:"Image",props:{y:15,x:725,width:100,skin:"myres/mjdesktop/myself.png",name:"myself",height:48}},{type:"Image",props:{y:-1,x:41,width:123,skin:"myres/mjdesktop/bg_end.png",scaleY:1.02,scaleX:1.02,name:"rank",height:201},child:[{type:"Image",props:{y:19,x:25,skin:"myres/mjdesktop/s_1.png"}},{type:"Image",props:{y:117,x:57,skin:"myres/mjdesktop/s_1_1.png"}}]}]},{type:"Image",props:{y:407,x:819,width:1155,skin:"myres/mjdesktop/bg_end123.png",scaleY:.73,scaleX:.73,name:"p1",height:224},child:[{type:"Label",props:{y:17,x:338,width:333,text:"啦啦啦啦啦啦啦啦",name:"label_name",height:54,fontSize:42,font:"SimHei",color:"#ffffff"}},{type:"Sprite",props:{y:124,x:436,width:493,scaleY:.7,scaleX:.7,pivotY:57,pivotX:138,name:"container_score",height:110},child:[{type:"Image",props:{y:0,x:0,skin:"myres/mjdesktop/ww_2.png",name:"6"}},{type:"Image",props:{x:70,skin:"myres/mjdesktop/ww_2.png",name:"5"}},{type:"Image",props:{y:0,x:140,skin:"myres/mjdesktop/ww_2.png",name:"4"}},{type:"Image",props:{y:0,x:210,skin:"myres/mjdesktop/ww_2.png",name:"3"}},{type:"Image",props:{y:0,x:280,skin:"myres/mjdesktop/ww_2.png",name:"2"}},{type:"Image",props:{y:0,x:350,skin:"myres/mjdesktop/ww_2.png",name:"1"}},{type:"Image",props:{y:0,x:420,skin:"myres/mjdesktop/ww_2.png",name:"0"}}]},{type:"Image",props:{y:43,x:894,width:40,skin:"myres/gold0.png",name:"img_g0",height:40},child:[{type:"Label",props:{y:1,x:50,width:236,text:"+10000",scaleY:.8,scaleX:.8,name:"val",height:72,fontSize:40,font:"haolong",color:"#ff3451"}}]},{type:"Image",props:{y:98,x:912,width:40,skin:"myres/PT.png",name:"img_g1",height:40},child:[{type:"Label",props:{y:1,x:50,width:236,text:"+10000",scaleY:.8,scaleX:.8,name:"val",height:72,fontSize:40,font:"haolong",color:"#ffffff"}}]},{type:"Label",props:{y:94,x:703,width:149,text:"+4500",strokeColor:"#000000",name:"val",height:49,fontSize:50,font:"haolong",color:"#f94538",align:"center"}},{type:"Image",props:{y:15,x:725,width:100,skin:"myres/mjdesktop/myself.png",name:"myself",height:48}},{type:"Image",props:{y:-23,x:134,skin:"myres/bg_head1.png",scaleY:1,scaleX:1,name:"head"},child:[{type:"Image",props:{y:35,x:23,width:153,skin:"extendRes/charactor/yiji/smallhead.png",height:153}}]},{type:"Image",props:{y:8,x:50,skin:"myres/mjdesktop/bg_end.png",scaleY:1.2,scaleX:1.2,name:"rank"},child:[{type:"Image",props:{y:6,x:14,skin:"myres/mjdesktop/s_2.png",scaleY:.9,scaleX:.9}},{type:"Image",props:{y:87,x:40,skin:"myres/mjdesktop/s_2_2.png",scaleY:.95,scaleX:.95}}]}]},{type:"Image",props:{y:592,x:919,width:1155,skin:"myres/mjdesktop/bg_end123.png",scaleY:.73,scaleX:.73,name:"p2",height:224},child:[{type:"Label",props:{y:17,x:338,width:333,text:"啦啦啦啦啦啦啦啦",name:"label_name",height:54,fontSize:42,font:"SimHei",color:"#ffffff"}},{type:"Sprite",props:{y:124,x:436,width:493,scaleY:.7,scaleX:.7,pivotY:57,pivotX:138,name:"container_score",height:110},child:[{type:"Image",props:{y:0,x:0,skin:"myres/mjdesktop/ww_2.png",name:"6"}},{type:"Image",props:{x:70,skin:"myres/mjdesktop/ww_2.png",name:"5"}},{type:"Image",props:{y:0,x:140,skin:"myres/mjdesktop/ww_2.png",name:"4"}},{type:"Image",props:{y:0,x:210,skin:"myres/mjdesktop/ww_2.png",name:"3"}},{type:"Image",props:{y:0,x:280,skin:"myres/mjdesktop/ww_2.png",name:"2"}},{type:"Image",props:{y:0,x:350,skin:"myres/mjdesktop/ww_2.png",name:"1"}},{type:"Image",props:{y:0,x:420,skin:"myres/mjdesktop/ww_2.png",name:"0"}}]},{type:"Image",props:{y:43,x:894,width:40,skin:"myres/gold0.png",name:"img_g0",height:40},child:[{type:"Label",props:{y:1,x:50,width:236,text:"+10000",scaleY:.8,scaleX:.8,name:"val",height:72,fontSize:40,font:"haolong",color:"#ffffff"}}]},{type:"Image",props:{y:98,x:912,width:40,skin:"myres/PT.png",name:"img_g1",height:40},child:[{type:"Label",props:{y:1,x:50,width:236,text:"+10000",scaleY:.8,scaleX:.8,name:"val",height:72,fontSize:40,font:"haolong",color:"#ffffff"}}]},{type:"Label",props:{y:94,x:703,width:149,text:"+4500",name:"val",height:49,fontSize:50,font:"haolong",color:"#45c36a",align:"center"}},{type:"Image",props:{y:15,x:725,width:100,skin:"myres/mjdesktop/myself.png",name:"myself",height:48}},{type:"Image",props:{y:-23,x:133,skin:"myres/bg_head1.png",scaleY:1,scaleX:1,name:"head"},child:[{type:"Image",props:{y:35,x:23,width:153,skin:"extendRes/charactor/yiji/smallhead.png",height:153}}]},{type:"Image",props:{y:8,x:49,skin:"myres/mjdesktop/bg_end.png",scaleY:1.2,scaleX:1.2,name:"rank"},child:[{type:"Image",props:{y:6,x:14,skin:"myres/mjdesktop/s_3.png",scaleY:.9,scaleX:.9}},{type:"Image",props:{y:87,x:40,skin:"myres/mjdesktop/s_3_3.png",scaleY:.95,scaleX:.95}}]}]},{type:"Image",props:{y:772,x:1017,width:1155,skin:"myres/mjdesktop/bg_end123.png",scaleY:.73,scaleX:.73,name:"p3",height:224},child:[{type:"Label",props:{y:17,x:338,width:333,text:"啦啦啦啦啦啦啦啦",name:"label_name",height:54,fontSize:42,font:"SimHei",color:"#ffffff"}},{type:"Sprite",props:{y:124,x:436,width:493,scaleY:.7,scaleX:.7,pivotY:57,pivotX:138,name:"container_score",height:110},child:[{type:"Image",props:{y:0,x:0,skin:"myres/mjdesktop/ww_2.png",name:"6"}},{type:"Image",props:{x:70,skin:"myres/mjdesktop/ww_2.png",name:"5"}},{type:"Image",props:{y:0,x:140,skin:"myres/mjdesktop/ww_2.png",name:"4"}},{type:"Image",props:{y:0,x:210,skin:"myres/mjdesktop/ww_2.png",name:"3"}},{type:"Image",props:{y:0,x:280,skin:"myres/mjdesktop/ww_2.png",name:"2"}},{type:"Image",props:{y:0,x:350,skin:"myres/mjdesktop/ww_2.png",name:"1"}},{type:"Image",props:{y:0,x:420,skin:"myres/mjdesktop/ww_2.png",name:"0"}}]},{type:"Image",props:{y:43,x:894,width:40,skin:"myres/gold0.png",name:"img_g0",height:40},child:[{type:"Label",props:{y:1,x:50,width:236,text:"+10000",scaleY:.8,scaleX:.8,name:"val",height:72,fontSize:40,font:"haolong",color:"#ffffff"}}]},{type:"Image",props:{y:98,x:912,width:40,skin:"myres/PT.png",name:"img_g1",height:40},child:[{type:"Label",props:{y:1,x:50,width:236,text:"+10000",scaleY:.8,scaleX:.8,name:"val",height:72,fontSize:40,font:"haolong",color:"#ffffff"}}]},{type:"Label",props:{y:94,x:703,width:149,text:"+4500",name:"val",height:49,fontSize:50,font:"haolong",color:"#45c36a",align:"center"}},{type:"Image",props:{y:15,x:725,width:100,skin:"myres/mjdesktop/myself.png",name:"myself",height:48}},{type:"Image",props:{y:-21,x:131,skin:"myres/bg_head1.png",scaleY:1,scaleX:1,name:"head"},child:[{type:"Image",props:{y:35,x:23,width:153,skin:"extendRes/charactor/yiji/smallhead.png",height:153},child:[{type:"Image",props:{}}]}]},{type:"Image",props:{y:6,x:48,skin:"myres/mjdesktop/bg_end.png",scaleY:1.2,scaleX:1.2,name:"rank"},child:[{type:"Image",props:{y:6,x:14,skin:"myres/mjdesktop/s_4.png",scaleY:.9,scaleX:.9}},{type:"Image",props:{y:87,x:40,skin:"myres/mjdesktop/s_4_4.png",scaleY:.95,scaleX:.95}}]}]},{type:"Label",props:{y:49,x:875,width:101,text:"终局",scaleY:1.3,scaleX:1.3,name:"title",height:56,fontSize:80,font:"fengyu",color:"#f8f0ef"}},{type:"Sprite",props:{y:422,x:875,width:1254,scaleY:.8,scaleX:.8,name:"gettitle",height:291,alpha:1},compId:297,child:[{type:"Image",props:{y:0,x:-104,width:1438,skin:"myres/title_get_bg.png",height:287}},{type:"Image",props:{y:49,x:660,width:265,scaleY:1,scaleX:1,height:69,anchorY:.5,anchorX:.5,alpha:1},compId:299},{type:"Label",props:{y:224,x:538,width:228,text:"已放入称号簿",height:36,fontSize:36,font:"SimHei",color:"#7be296",alpha:1},compId:300},{type:"Image",props:{y:137,x:666,width:676,skin:"extendRes/title/1001.png",scaleY:1,scaleX:1,name:"img_title",height:103,anchorY:.5,anchorX:.5,alpha:1},compId:301}]},{type:"Button",props:{y:1004,x:1787,width:228,name:"btn_next",height:153,anchorY:.5,anchorX:.5},child:[{type:"Script",props:{y:34,x:36,runtime:"capsui.CButton"}},{type:"Image",props:{y:76,x:112,width:153,skin:"myres/mjdesktop/confirm.png",height:83,anchorY:.5,anchorX:.5}}]}]}],animations:[{nodes:[{target:297,keyframes:{x:[{value:300,tweenMethod:"linearNone",tween:!0,target:297,key:"x",index:0},{value:500,tweenMethod:"strongOut",tween:!0,target:297,key:"x",index:1},{value:875,tweenMethod:"linearNone",tween:!0,target:297,key:"x",index:6}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:297,key:"alpha",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:297,key:"alpha",index:6}]}},{target:299,keyframes:{scaleY:[{value:1,tweenMethod:"linearNone",tween:!0,target:299,key:"scaleY",index:0},{value:2,tweenMethod:"strongOut",tween:!0,target:299,key:"scaleY",index:8},{value:1,tweenMethod:"linearNone",tween:!0,target:299,key:"scaleY",index:13}],scaleX:[{value:1,tweenMethod:"linearNone",tween:!0,target:299,key:"scaleX",index:0},{value:2,tweenMethod:"strongOut",tween:!0,target:299,key:"scaleX",index:8},{value:1,tweenMethod:"linearNone",tween:!0,target:299,key:"scaleX",index:13}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:299,key:"alpha",index:0},{value:0,tweenMethod:"strongOut",tween:!0,target:299,key:"alpha",index:8},{value:1,tweenMethod:"linearNone",tween:!0,target:299,key:"alpha",index:13}]}},{target:301,keyframes:{scaleY:[{value:1,tweenMethod:"linearNone",tween:!0,target:301,key:"scaleY",index:0},{value:2,tweenMethod:"strongOut",tween:!0,target:301,key:"scaleY",index:18},{value:1,tweenMethod:"linearNone",tween:!0,target:301,key:"scaleY",index:24}],scaleX:[{value:1,tweenMethod:"linearNone",tween:!0,target:301,key:"scaleX",index:0},{value:2,tweenMethod:"strongOut",tween:!0,target:301,key:"scaleX",index:18},{value:1,tweenMethod:"linearNone",tween:!0,target:301,key:"scaleX",index:24}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:301,key:"alpha",index:0},{value:0,tweenMethod:"strongOut",tween:!0,target:301,key:"alpha",index:18},{value:1,tweenMethod:"linearNone",tween:!0,target:301,key:"alpha",index:24}]}},{target:300,keyframes:{alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:300,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:300,key:"alpha",index:29},{value:1,tweenMethod:"linearNone",tween:!0,target:300,key:"alpha",index:34}]}}],name:"title_in",id:1,frameRate:30,action:0},{nodes:[{target:297,keyframes:{x:[{value:875,tweenMethod:"backIn",tween:!0,target:297,key:"x",index:0},{value:1300,tweenMethod:"linearNone",tween:!0,target:297,key:"x",index:6}],alpha:[{value:1,tweenMethod:"backIn",tween:!0,target:297,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:297,key:"alpha",index:6}]}}],name:"title_out",id:2,frameRate:24,action:0}]},i}(View);t.gameendUI=i}(e.mj||(e.mj={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.createView(e.mj.huleshowUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Image",props:{y:0,x:0,width:1920,skin:"myres/bbg.png",name:"black_mask",height:1080,sizeGrid:"1,1,1,1"}},{type:"Sprite",props:{y:0,x:0,width:1920,name:"container_zimo",height:1080},child:[{type:"Image",props:{y:674,x:981,width:726,skin:"myres/mjdesktop/show_zimo.png",name:"0",height:295,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:420,x:1338,width:726,skin:"myres/mjdesktop/show_zimo.png",name:"1",height:295,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:185,x:960,width:726,skin:"myres/mjdesktop/show_zimo.png",name:"2",height:295,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:423,x:508,width:726,skin:"myres/mjdesktop/show_zimo.png",name:"3",height:295,anchorY:.5,anchorX:.5}}]},{type:"Sprite",props:{y:0,x:0,width:1920,name:"container_rong",height:1080},child:[{type:"Image",props:{y:674,x:981,width:726,skin:"myres/mjdesktop/show_rong.png",name:"0",height:295,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:420,x:1338,width:726,skin:"myres/mjdesktop/show_rong.png",name:"1",height:295,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:185,x:960,width:726,skin:"myres/mjdesktop/show_rong.png",name:"2",height:295,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:423,x:508,width:726,skin:"myres/mjdesktop/show_rong.png",name:"3",height:295,anchorY:.5,anchorX:.5}}]},{type:"Sprite",props:{y:2,x:-3,width:1920,name:"container_liuju",height:1080},child:[{type:"Image",props:{y:132,x:504,width:880,skin:"myres/mjdesktop/round_bg.png",name:"t2",height:131,sizeGrid:"9,10,12,10"},child:[{type:"Image",props:{y:21,x:17,width:60,skin:"myres/8p.png",name:"img0",height:91}},{type:"Image",props:{y:21,x:83,width:60,skin:"myres/8p.png",name:"img0",height:91}},{type:"Image",props:{y:21,x:149,width:60,skin:"myres/8p.png",name:"img0",height:91}},{type:"Image",props:{y:21,x:215,width:60,skin:"myres/8p.png",name:"img0",height:91}},{type:"Image",props:{y:21,x:281,width:60,skin:"myres/8p.png",name:"img0",height:91}},{type:"Image",props:{y:21,x:346,width:60,skin:"myres/8p.png",name:"img0",height:91}},{type:"Image",props:{y:21,x:411,width:60,skin:"myres/8p.png",name:"img0",height:91}},{type:"Image",props:{y:21,x:476,width:60,skin:"myres/8p.png",name:"img0",height:91}},{type:"Image",props:{y:21,x:541,width:60,skin:"myres/8p.png",name:"img0",height:91}},{type:"Image",props:{y:21,x:606,width:60,skin:"myres/8p.png",name:"img0",height:91}},{type:"Image",props:{y:21,x:671,width:60,skin:"myres/8p.png",name:"img0",height:91}},{type:"Image",props:{y:21,x:736,width:60,skin:"myres/8p.png",name:"img0",height:91}},{type:"Image",props:{y:21,x:801,width:60,skin:"myres/8p.png",name:"img0",height:91}}]},{type:"Image",props:{y:618,x:506,width:880,skin:"myres/mjdesktop/round_bg.png",name:"t0",height:131,sizeGrid:"9,10,12,10"},child:[{type:"Image",props:{y:21,x:17,width:60,skin:"myres/8p.png",name:"img0",height:91}},{type:"Image",props:{y:21,x:83,width:60,skin:"myres/8p.png",name:"img0",height:91}},{type:"Image",props:{y:21,x:149,width:60,skin:"myres/8p.png",name:"img0",height:91}},{type:"Image",props:{y:21,x:215,width:60,skin:"myres/8p.png",name:"img0",height:91}},{type:"Image",props:{y:21,x:281,width:60,skin:"myres/8p.png",name:"img0",height:91}},{type:"Image",props:{y:21,x:346,width:60,skin:"myres/8p.png",name:"img0",height:91}},{type:"Image",props:{y:21,x:411,width:60,skin:"myres/8p.png",name:"img0",height:91}},{type:"Image",props:{y:21,x:476,width:60,skin:"myres/8p.png",name:"img0",height:91}},{type:"Image",props:{y:21,x:541,width:60,skin:"myres/8p.png",name:"img0",height:91}},{type:"Image",props:{y:21,x:606,width:60,skin:"myres/8p.png",name:"img0",height:91}},{type:"Image",props:{y:21,x:671,width:60,skin:"myres/8p.png",name:"img0",height:91}},{type:"Image",props:{y:21,x:736,width:60,skin:"myres/8p.png",name:"img0",height:91}},{type:"Image",props:{y:21,x:801,width:60,skin:"myres/8p.png",name:"img0",height:91}}]},{type:"Image",props:{y:598,x:779,width:355,skin:"myres/mjdesktop/show_tingpai.png",name:"0",height:72,anchorY:.5}},{type:"Image",props:{y:554,x:742,skin:"myres/mjdesktop/noting.png",name:"no0"}},{type:"Image",props:{y:429,x:287,width:880,skin:"myres/mjdesktop/round_bg.png",name:"t3",height:131,sizeGrid:"9,10,12,10"},child:[{type:"Image",props:{y:21,x:17,width:60,skin:"myres/8p.png",name:"img0",height:91}},{type:"Image",props:{y:21,x:83,width:60,skin:"myres/8p.png",name:"img0",height:91}},{type:"Image",props:{y:21,x:149,width:60,skin:"myres/8p.png",name:"img0",height:91}},{type:"Image",props:{y:21,x:215,width:60,skin:"myres/8p.png",name:"img0",height:91}},{type:"Image",props:{y:21,x:281,width:60,skin:"myres/8p.png",name:"img0",height:91}},{type:"Image",props:{y:21,x:346,width:60,skin:"myres/8p.png",name:"img0",height:91}},{type:"Image",props:{y:21,x:411,width:60,skin:"myres/8p.png",name:"img0",height:91}},{type:"Image",props:{y:21,x:476,width:60,skin:"myres/8p.png",name:"img0",height:91}},{type:"Image",props:{y:21,x:541,width:60,skin:"myres/8p.png",name:"img0",height:91}},{type:"Image",props:{y:21,x:606,width:60,skin:"myres/8p.png",name:"img0",height:91}},{type:"Image",props:{y:21,x:671,width:60,skin:"myres/8p.png",name:"img0",height:91}},{type:"Image",props:{y:21,x:736,width:60,skin:"myres/8p.png",name:"img0",height:91}},{type:"Image",props:{y:21,x:801,width:60,skin:"myres/8p.png",name:"img0",height:91}}]},{type:"Image",props:{y:429,x:799,width:880,skin:"myres/mjdesktop/round_bg.png",name:"t1",height:131,sizeGrid:"9,10,12,10"},child:[{type:"Image",props:{y:21,x:17,width:60,skin:"myres/8p.png",name:"img0",height:91}},{type:"Image",props:{y:21,x:83,width:60,skin:"myres/8p.png",name:"img0",height:91}},{type:"Image",props:{y:21,x:149,width:60,skin:"myres/8p.png",name:"img0",height:91}},{type:"Image",props:{y:21,x:215,width:60,skin:"myres/8p.png",name:"img0",height:91}},{type:"Image",props:{y:21,x:281,width:60,skin:"myres/8p.png",name:"img0",height:91}},{type:"Image",props:{y:21,x:346,width:60,skin:"myres/8p.png",name:"img0",height:91}},{type:"Image",props:{y:21,x:411,width:60,skin:"myres/8p.png",name:"img0",height:91}},{type:"Image",props:{y:21,x:476,width:60,skin:"myres/8p.png",name:"img0",height:91}},{type:"Image",props:{y:21,x:541,width:60,skin:"myres/8p.png",name:"img0",height:91}},{type:"Image",props:{y:21,x:606,width:60,skin:"myres/8p.png",name:"img0",height:91}},{type:"Image",props:{y:21,x:671,width:60,skin:"myres/8p.png",name:"img0",height:91}},{type:"Image",props:{y:21,x:736,width:60,skin:"myres/8p.png",name:"img0",height:91}},{type:"Image",props:{y:21,x:801,width:60,skin:"myres/8p.png",name:"img0",height:91}}]},{type:"Image",props:{y:407,x:280,width:355,skin:"myres/mjdesktop/show_tingpai.png",name:"3",height:72,anchorY:.5}},{type:"Image",props:{y:365,x:249,skin:"myres/mjdesktop/noting.png",name:"no3"}},{type:"Image",props:{y:287,x:777,width:355,skin:"myres/mjdesktop/show_tingpai.png",name:"2",height:72,anchorY:.5}},{type:"Image",props:{y:249,x:736,skin:"myres/mjdesktop/noting.png",name:"no2"}},{type:"Image",props:{y:407,x:1321,width:355,skin:"myres/mjdesktop/show_tingpai.png",name:"1",height:72,anchorY:.5}},{type:"Image",props:{y:368,x:1288,skin:"myres/mjdesktop/noting.png",name:"no1"}},{type:"Image",props:{y:375,x:742,width:429,skin:"myres/mjdesktop/huangpailiuju.png",name:"title",height:113}}]}]},i}(View);t.huleshowUI=i}(e.mj||(e.mj={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.createView(e.mj.hu_cutinUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Sprite",props:{y:194,x:6,width:1835,staticCache:!1,name:"root",height:604},child:[{type:"Image",props:{y:811,x:-2796,width:14e3,skin:"myres/mjdesktop/cutinbg.png",scaleY:0,rotation:-7,name:"backline",height:700,anchorY:.5,anchorX:.5},compId:3},{type:"Sprite",props:{y:-194,x:-6,name:"effect"}},{type:"Sprite",props:{y:-30,x:-50,name:"container_illust",alpha:0},compId:5,child:[{type:"Image",props:{y:339,x:1133,width:2e3,skin:"myres/mjdesktop/cutinbg.png",rotation:-7,renderType:"mask",name:"mask",height:650,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:60,x:1594,width:1183,skin:"extendRes/charactor/yiji/half.png",scaleX:-1,name:"illust",height:784},child:[{type:"Image",props:{y:0,x:1183}}]}]},{type:"Image",props:{y:811,x:-2796,width:14e3,skin:"myres/mjdesktop/cutin_line.png",scaleY:0,rotation:-7,name:"frontline",height:700,anchorY:.5,anchorX:.5},compId:4}]}],animations:[{nodes:[{target:3,keyframes:{y:[{value:-188,tweenMethod:"linearNone",tween:!0,target:3,key:"y",index:0},{value:811,tweenMethod:"linearNone",tween:!0,target:3,label:null,key:"y",index:36}],x:[{value:5435,tweenMethod:"linearNone",tween:!0,target:3,key:"x",index:0},{value:-2796,tweenMethod:"linearNone",tween:!0,target:3,label:null,key:"x",index:36}],scaleY:[{value:0,tweenMethod:"strongIn",tween:!0,target:3,key:"scaleY",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:3,key:"scaleY",index:4},{value:1,tweenMethod:"strongIn",tween:!0,target:3,key:"scaleY",index:33},{value:0,tweenMethod:"linearNone",tween:!0,target:3,key:"scaleY",index:36}]}},{target:4,keyframes:{y:[{value:-188,tweenMethod:"linearNone",tween:!0,target:4,label:null,key:"y",index:0},{value:811,tweenMethod:"linearNone",tween:!0,target:4,label:null,key:"y",index:36}],x:[{value:5435,tweenMethod:"linearNone",tween:!0,target:4,label:null,key:"x",index:0},{value:-2796,tweenMethod:"linearNone",tween:!0,target:4,label:null,key:"x",index:36}],scaleY:[{value:0,tweenMethod:"strongIn",tween:!0,target:4,label:null,key:"scaleY",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:4,label:null,key:"scaleY",index:4},{value:1,tweenMethod:"strongIn",tween:!0,target:4,label:null,key:"scaleY",index:33},{value:0,tweenMethod:"linearNone",tween:!0,target:4,label:null,key:"scaleY",index:36}]}},{target:5,keyframes:{y:[{value:-30,tweenMethod:"linearNone",tween:!0,target:5,key:"y",index:0},{value:-30,tweenMethod:"linearNone",tween:!0,target:5,key:"y",index:3},{value:-30,tweenMethod:"linearNone",tween:!0,target:5,key:"y",index:4},{value:-30,tweenMethod:"linearNone",tween:!0,target:5,key:"y",index:33}],x:[{value:274,tweenMethod:"linearNone",tween:!0,target:5,key:"x",index:0},{value:274,tweenMethod:"linearNone",tween:!0,target:5,key:"x",index:3},{value:274,tweenMethod:"linearNone",tween:!0,target:5,key:"x",index:4},{value:188,tweenMethod:"linearNone",tween:!0,target:5,key:"x",index:33},{value:-50,tweenMethod:"linearNone",tween:!0,target:5,key:"x",index:36}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:5,key:"alpha",index:0},{value:.01,tweenMethod:"linearNone",tween:!0,target:5,key:"alpha",index:3},{value:1,tweenMethod:"linearNone",tween:!0,target:5,key:"alpha",index:4},{value:1,tweenMethod:"linearNone",tween:!0,target:5,key:"alpha",index:33},{value:.01,tweenMethod:"linearNone",tween:!0,target:5,key:"alpha",index:34},{value:0,tweenMethod:"linearNone",tween:!0,target:5,key:"alpha",index:36}]}}],name:"cutin",id:1,frameRate:30,action:0}]},i}(View);t.hu_cutinUI=i}(e.mj||(e.mj={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.CButton",capsui.CButton),t.prototype.createChildren.call(this),this.createView(e.mj.info_md5UI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Sprite",props:{y:560,x:960,width:500,pivotY:250,pivotX:250,name:"root",height:500},child:[{type:"Image",props:{y:250,x:250,width:1200,skin:"myres/pop2_bg.png",name:"bg0",height:700,anchorY:.5,anchorX:.5,sizeGrid:"2,2,2,2"}},{type:"Image",props:{y:250,x:250,width:1200,skin:"myres/pop2_bound.png",name:"bound",height:700,anchorY:.5,anchorX:.5,sizeGrid:"24,27,11,21"}},{type:"Panel",props:{y:-67,x:-314,width:1117,name:"content",height:634},child:[{type:"Label",props:{y:10,x:12,wordWrap:!0,width:1117,text:"    雀魂保证游戏生成完全随机，在游戏开始之时牌山序列已经固定，不会根据场面情况针对性地发牌，不会在牌局中篡改牌山。为证明此声明，我们引入了MD5码验证系统。\\n    MD5码被广泛的应用于加密解密技术，是一个公用的标准算法。它通过一个固定的算法把输入的字节（牌山序列）转化成一个字符串码。MD5码具有单向性、唯一性和混沌性。\\n    单向性：生成出来的MD5码无法被反解析成原来的输入内容，所以不用担心我们事先给出的MD5码会被人破解而提前看到牌山。（ps：网上那些MD5反解析工具都是暴力尝试，若要尝试出我们牌山的序列，大概几亿年吧）。 \\n   唯一性：唯一的输入只会产出唯一的MD5码的输出。\\n   混沌性：一个牌山序列和另一个牌山序列即使只有一张牌的微小差异，生成的MD5码也会全然不同。\\n   唯一性和混沌性保证了牌山无法篡改，一经改动MD5码就会剧烈波动。\\n   MD5码验证步骤：\\n   1.对局中，玩家可以点击左上角的宝牌指示牌的位置查看本次对局的牌山生成MD5码并记录下来。MD5码是每一次配牌生成一次的。\\n   2.对局结束后，玩家可以在牌谱中对照每一个小局的MD5码是否跟之前游戏中的相同。以此验证游戏中给的MD5码没有给错。\\n   3.按照大家比较通用的习惯，每张牌都有唯一的编码，万字用m表示，筒子用p表示，条子用s表示，字牌用z表示，所以1万的编码是1m，9筒的编码是9p，5条的编码是5s，东南西北白发中的编码分别是1z、2z、3z、4z、5z、6z和7z，特殊的红5万用0m表示，红5筒用0p表示，红5条用0s表示。因此牌山可以唯一的用一串字符序列来表示。假设牌山是8筒7索东风红5万的话，那么编码序列就是8p7s1z0m。玩家可以在牌谱中查看牌山，牌山显示的是发完牌之后剩余的牌山序列，根据牌谱中显示的牌山可以用上述的表示方法得到唯一的牌山序列。牌山显示的最下方那个牌山代码就是用这种方式生成的。\\n   4.打开网址http://tool.chinaz.com/tools/md5.aspx，这是一个比较常见的在线MD5码加密网站。把在3中获得的牌山代码输入进左边的输入框，然后中间选择加密32位[大]，点击加密按钮，右边就会出现MD5码。拿右边的MD5码与1中游戏中给的MD5做对比，相同则意为着您在本局游戏进行的时候，牌山就是固定的，我们后期并未进行篡改。因为一旦篡改，牌谱中就会发现发牌不对，或者生成的MD5码不匹配。\\n   感谢大家对雀魂的大力支持，祝大家玩得开心，雀力日进。",name:"desc",leading:10,height:1241,fontSize:28,font:"SimHei",color:"#d6d1d1"}}]},{type:"Button",props:{y:-64,x:814,width:96,pivotY:65,pivotX:44,name:"btn_close",height:109},child:[{type:"Image",props:{y:43,x:22,skin:"myres/pop2_close.png"}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]}]},i}(View);t.info_md5UI=i}(e.mj||(e.mj={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.createView(e.mj.liujuUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Sprite",props:{width:1920,name:"root",height:1080,alpha:1},child:[{type:"Image",props:{y:-1920,x:-1560,width:5e3,skin:"myres/bbg.png",height:5e3,alpha:.7,sizeGrid:"1,1,1,1"}},{type:"Image",props:{y:357,x:742,width:429,skin:"myres/mjdesktop/huangpailiuju.png",name:"title",height:113}}]}]},i}(View);t.liujuUI=i}(e.mj||(e.mj={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.CButton",capsui.CButton),t.prototype.createChildren.call(this),this.createView(e.mj.live_broadcastUI.uiView)},i.uiView={type:"View",props:{width:1920,mouseThrough:!0,height:1080},child:[{type:"Sprite",props:{y:562,x:-6,width:342,visible:!0,name:"config",height:293},child:[{type:"Image",props:{y:-8,x:263,width:261,skin:"myres/mjdesktop/chat.png",scaleX:-1,name:"bg",height:299,sizeGrid:"26,0,27,24"},child:[{type:"Image",props:{y:51,x:-75,width:90,skin:"myres/mjdesktop/chat_btn.png",height:194,sizeGrid:"27,18,27,16"}}]},{type:"Label",props:{y:86,x:267,wordWrap:!0,width:48,text:"观战",height:104,fontSize:48,font:"fengyu",color:"#e19137"}},{type:"Button",props:{y:78,x:125,width:233,name:"btn_shoupai",height:124,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:1,x:1,width:230,skin:"myres/mjdesktop/func_btn.png",height:119,sizeGrid:"26,17,21,23"},child:[{type:"Label",props:{y:41,x:66,width:147,text:"显示手牌",height:38,fontSize:36,font:"youyuan",color:"#7793b8"}}]},{type:"Image",props:{y:39,x:12,skin:"myres/mjdesktop/unchoosed.png",scaleY:1.2,scaleX:1.2}},{type:"Image",props:{y:39,x:12,skin:"myres/mjdesktop/choosed.png",scaleY:1.2,scaleX:1.2,name:"choosed"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:206,x:125,width:233,name:"btn_paopai",height:124,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:1,x:1,width:230,skin:"myres/mjdesktop/func_btn.png",height:119,sizeGrid:"26,17,21,23"},child:[{type:"Label",props:{y:41,x:66,width:147,text:"铳牌提示",height:38,fontSize:36,font:"youyuan",color:"#7793b8"}}]},{type:"Image",props:{y:39,x:12,skin:"myres/mjdesktop/unchoosed.png",scaleY:1.2,scaleX:1.2}},{type:"Image",props:{y:39,x:12,skin:"myres/mjdesktop/choosed.png",scaleY:1.2,scaleX:1.2,name:"choosed"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:15,x:254,width:111,name:"btn_out",height:242}}]}]},i}(View);t.live_broadcastUI=i}(e.mj||(e.mj={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("Text",laya.display.Text),t.prototype.createChildren.call(this),this.createView(e.mj.rankchangeUI.uiView)},i.uiView={type:"View",props:{width:1920,mouseThrough:!0,height:1080},child:[{type:"Sprite",props:{y:534,x:1363,width:255,scaleY:1.5,scaleX:1.5,pivotY:121,pivotX:129,name:"rank_change",height:253},child:[{type:"Image",props:{y:114,x:128,width:255,pivotY:114,pivotX:128,name:"rank",height:253},child:[{type:"Image",props:{y:0,x:0,skin:"myres/rank_bg.png",name:"bg"}},{type:"Image",props:{y:115,x:131,visible:!0,skin:"extendRes/level/queshi.png",scaleY:1,scaleX:1,name:"icon_old",anchorY:.5,anchorX:.5,alpha:0},compId:5},{type:"Image",props:{y:115,x:131,visible:!0,skin:"extendRes/level/queshi.png",scaleY:1,scaleX:1,name:"icon_new",anchorY:.5,anchorX:.5,alpha:1},compId:61},{type:"Image",props:{y:181,x:56,skin:"myres/starbg.png",scaleY:.7,scaleX:.7,name:"star2",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",scaleY:1,scaleX:1,anchorY:.5,anchorX:.5,alpha:1},compId:7}]},{type:"Image",props:{y:134,x:25,skin:"myres/starbg.png",scaleY:1,scaleX:1,name:"star3",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",scaleY:1,scaleX:1,anchorY:.5,anchorX:.5,alpha:1},compId:9}]},{type:"Image",props:{y:202,x:91,skin:"myres/starbg.png",scaleY:.5,scaleX:.5,name:"star1",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:26,x:27,skin:"myres/star.png",scaleY:1,scaleX:1,anchorY:.5,anchorX:.5,alpha:1},compId:11}]}]},{type:"Image",props:{y:-47,x:157,skin:"myres/mjdesktop/expbar_base2.png",name:"bar"},child:[{type:"Image",props:{y:0,x:0,skin:"myres/mjdesktop/expbar_base.png"}},{type:"Image",props:{y:0,x:0,skin:"myres/mjdesktop/expbar_full.png",name:"fullshine"},compId:60},{type:"Sprite",props:{name:"container"},child:[{type:"Image",props:{y:0,x:0,skin:"myres/mjdesktop/expbar.png",name:"value"}},{type:"Image",props:{y:277,x:0,width:112,skin:"myres/wbg.png",scaleY:.6,renderType:"mask",name:"mask",height:277,anchorY:1,sizeGrid:"1,1,1,1"}}]},{type:"Label",props:{y:152,x:140,width:180,text:"9999/9999",scaleY:.5,scaleX:.5,name:"score",height:35,fontSize:28,font:"haolong",color:"#4fedff",align:"center"}}]},{type:"Sprite",props:{y:-61,x:90,width:63,visible:!1,name:"f_jinji",height:74},child:[{type:"Image",props:{y:4,x:5,width:69.6,skin:"myres/mjdesktop/upgrade_arrow.png",height:50.4,alpha:0},compId:26},{type:"Image",props:{y:31,x:0,width:76.8,skin:"myres/mjdesktop/upgrade.png",height:45.6,alpha:0},compId:27}]},{type:"Sprite",props:{y:200,x:92,width:63,visible:!0,name:"f_shengduan",height:74},child:[{type:"Image",props:{y:44,x:-1,width:69.6,skin:"myres/mjdesktop/star_down_arrow.png",height:57.6,alpha:1},compId:29},{type:"Image",props:{y:29,x:-3,width:79.2,skin:"myres/mjdesktop/star_down.png",height:45.6,alpha:1},compId:30}]},{type:"Sprite",props:{y:70,x:86,width:88,visible:!1,name:"f_jiangduan",height:74},child:[{type:"Image",props:{y:60,x:43,width:85.2,skin:"myres/mjdesktop/rank_down_arrow.png",scaleY:1,scaleX:1,height:60,anchorY:.5,anchorX:.5,alpha:0},compId:33},{type:"Image",props:{y:31,x:48,width:106.8,skin:"myres/mjdesktop/rank_down.png",scaleY:1,scaleX:1,height:57.6,anchorY:.5,anchorX:.5,alpha:0},compId:32}]},{type:"Image",props:{y:134,x:342,skin:"myres/mjdesktop/exp_line.png",scaleY:1.2,scaleX:1.2,name:"-",anchorY:.5,anchorX:.5},child:[{type:"Label",props:{y:11,x:30,width:224,text:"-120",scaleY:.5,scaleX:.5,name:"score",height:51,fontSize:28,font:"haolong",color:"#aaa7a9",align:"center"}},{type:"Image",props:{y:33,x:72,width:37,skin:"myres/mjdesktop/star_down_arrow.png",name:"arrow",height:27}}]},{type:"Image",props:{y:91,x:235,skin:"myres/mjdesktop/exp_line.png",scaleY:1.2,scaleX:1.2,name:"+"},child:[{type:"Label",props:{y:-22,x:42,width:187,text:"120",scaleY:.5,scaleX:.5,name:"score",height:50,fontSize:28,font:"haolong",color:"#4ddeff",align:"center"}},{type:"Image",props:{y:-49,x:70,width:37,skin:"myres/mjdesktop/star_upgrade.png",name:"arrow",height:30}}]}]},{type:"Sprite",props:{width:1920,name:"rankup",height:1080},child:[{type:"Image",props:{x:0,width:1920,skin:"myres/bbg.png",name:"black",height:1080,alpha:.7,sizeGrid:"1,1,1,1"},compId:35},{type:"Image",props:{y:505,x:1354,width:927.6,visible:!1,skin:"myres/mjdesktop/shengduan/shine.png",name:"shine",height:924,anchorY:.5,anchorX:.5,alpha:0},compId:36},{type:"Image",props:{y:556,x:1418,width:200,visible:!1,skin:"myres/mjdesktop/shengduan/sdb0.png",scaleY:1,scaleX:1,rotation:0,name:"book_shine",height:997,anchorY:.5,anchorX:.5,alpha:1},compId:37},{type:"Button",props:{y:0,x:0,width:1920,name:"btn_open",height:1080}},{type:"Sprite",props:{y:559,x:940,width:1201,visible:!0,pivotY:482.5,pivotX:600.5,name:"main",height:965,alpha:1},compId:51,child:[{type:"Sprite",props:{y:-26,x:19,width:1195,name:"page",height:987},child:[{type:"Image",props:{y:92,x:1119,width:1015.2,visible:!0,skin:"myres/bbg.png",renderType:"mask",name:"mask",height:835.2,anchorY:0,anchorX:1,sizeGrid:"1,1,1,1"},compId:59},{type:"Image",props:{y:510,x:1120,width:1015.2,visible:!0,skin:"myres/mjdesktop/shengduan/bg.png",name:"page",height:835.2,anchorY:.5,anchorX:1},compId:39}]},{type:"Image",props:{y:197,x:669,width:231.6,visible:!0,skin:"myres/mjdesktop/shengduan/title.png",scaleY:1,scaleX:1,height:49.2,anchorY:.5,anchorX:.5,alpha:1},compId:42},{type:"Image",props:{y:263,x:509,width:96,visible:!0,skin:"myres/mjdesktop/shengduan/w0.png",name:"call",height:33.6,alpha:1},compId:43},{type:"Image",props:{y:251,x:208,width:272,visible:!0,skin:"myres/mjdesktop/shengduan/bg_name.png",name:"name",height:52,alpha:1,sizeGrid:"0,36,0,74"},compId:44,child:[{type:"Text",props:{y:0,x:70,width:289,valign:"middle",text:"啊啊啊啊啊啊",name:"name",height:50,fontSize:28,font:"SimHei",color:"#ffffff",align:"left"}}]},{type:"Image",props:{y:321,x:283,width:706.8,visible:!0,skin:"myres/mjdesktop/shengduan/w1.png",height:37.2,alpha:1},compId:45},{type:"Image",props:{y:706,x:724,width:313.2,visible:!0,skin:"myres/mjdesktop/shengduan/w2.png",height:33.6,alpha:0},compId:46},{type:"Label",props:{y:759,x:741,wordWrap:!0,width:362,text:"2020/02/02",scaleY:.8,scaleX:.8,name:"time",height:44,fontSize:28,font:"haolong",color:"#351f1f",bold:!0,alpha:0,align:"right"},compId:52},{type:"Button",props:{y:126.6198347107438,x:1186,width:91,visible:!1,pivotY:106,pivotX:35,name:"btn_close",height:223,alpha:0},compId:53,child:[{type:"Image",props:{y:28,x:10,width:60,skin:"myres/mjdesktop/shengduan/btn_close.png",height:150}}]},{type:"Image",props:{y:530,x:629,width:294,visible:!0,skin:"myres/rank_bg.png",scaleY:1,scaleX:1,name:"rankbg",height:274,anchorY:.5,anchorX:.5,alpha:1},compId:55,child:[{type:"Image",props:{y:22,x:0,width:314.4,skin:"extendRes/level/queshi.png",name:"rank",height:241.2}}]},{type:"Image",props:{y:61,x:1129,width:28.8,visible:!0,skin:"myres/mjdesktop/shengduan/sdbar.png",name:"bar",height:847.2,alpha:1},compId:47},{type:"Image",props:{y:480,x:105,width:141.6,visible:!0,skin:"myres/mjdesktop/shengduan/sdb1.png",name:"book",height:957.6,anchorY:.5,anchorX:.5,alpha:1},compId:38}]}]}],animations:[{nodes:[{target:36,keyframes:{x:[{value:1354,tweenMethod:"backOut",tween:!0,target:36,key:"x",index:0},{value:1354,tweenMethod:"backOut",tween:!0,target:36,label:null,key:"x",index:4},{value:1354,tweenMethod:"linearNone",tween:!0,target:36,label:null,key:"x",index:8},{value:1354,tweenMethod:"linearNone",tween:!0,target:36,label:null,key:"x",index:9},{value:1354,tweenMethod:"linearNone",tween:!0,target:36,label:null,key:"x",index:14}],visible:[{value:!1,tweenMethod:"linearNone",tween:!1,target:36,key:"visible",index:0},{value:!0,tweenMethod:"linearNone",tween:!1,target:36,key:"visible",index:4}],alpha:[{value:0,tweenMethod:"backOut",tween:!0,target:36,key:"alpha",index:0},{value:0,tweenMethod:"backOut",tween:!0,target:36,label:null,key:"alpha",index:4},{value:0,tweenMethod:"linearNone",tween:!0,target:36,key:"alpha",index:8},{value:1,tweenMethod:"linearNone",tween:!0,target:36,key:"alpha",index:9},{value:1,tweenMethod:"linearNone",tween:!0,target:36,label:null,key:"alpha",index:14}]}},{target:37,keyframes:{y:[{value:556,tweenMethod:"linearNone",tween:!0,target:37,key:"y",index:0},{value:549,tweenMethod:"linearNone",tween:!0,target:37,key:"y",index:14}],x:[{value:1377,tweenMethod:"expoOut",tween:!0,target:37,key:"x",index:0},{value:1377,tweenMethod:"expoOut",tween:!0,target:37,label:null,key:"x",index:4},{value:1377,tweenMethod:"linearNone",tween:!0,target:37,label:null,key:"x",index:14}],width:[{value:200,tweenMethod:"linearNone",tween:!0,target:37,key:"width",index:0},{value:141.6,tweenMethod:"linearNone",tween:!0,target:37,key:"width",index:14}],visible:[{value:!1,tweenMethod:"linearNone",tween:!1,target:37,key:"visible",index:0},{value:!0,tweenMethod:"linearNone",tween:!1,target:37,key:"visible",index:4}],scaleY:[{value:.1,tweenMethod:"backOut",tween:!0,target:37,key:"scaleY",index:0},{value:.1,tweenMethod:"strongOut",tween:!0,target:37,label:null,key:"scaleY",index:4},{value:1,tweenMethod:"linearNone",tween:!0,target:37,key:"scaleY",index:14}],scaleX:[{value:.1,tweenMethod:"backOut",tween:!0,target:37,key:"scaleX",index:0},{value:.1,tweenMethod:"strongOut",tween:!0,target:37,label:null,key:"scaleX",index:4},{value:1,tweenMethod:"linearNone",tween:!0,target:37,key:"scaleX",index:14}],rotation:[{value:15,tweenMethod:"linearNone",tween:!0,target:37,key:"rotation",index:0},{value:15,tweenMethod:"linearNone",tween:!0,target:37,key:"rotation",index:4},{value:15,tweenMethod:"linearNone",tween:!0,target:37,key:"rotation",index:14}],height:[{value:997,tweenMethod:"linearNone",tween:!0,target:37,key:"height",index:0},{value:705.6,tweenMethod:"linearNone",tween:!0,target:37,key:"height",index:14}]}},{target:35,keyframes:{x:[{value:0,tweenMethod:"linearNone",tween:!0,target:35,key:"x",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:35,label:null,key:"x",index:2},{value:0,tweenMethod:"linearNone",tween:!0,target:35,label:null,key:"x",index:14}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:35,key:"alpha",index:0},{value:.7,tweenMethod:"linearNone",tween:!0,target:35,key:"alpha",index:2},{value:.7,tweenMethod:"linearNone",tween:!0,target:35,label:null,key:"alpha",index:14}]}},{target:51,keyframes:{visible:[{value:!0,tweenMethod:"linearNone",tween:!1,target:51,key:"visible",index:0},{value:!1,tweenMethod:"linearNone",tween:!1,target:51,key:"visible",index:1}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:51,key:"alpha",index:0}]}}],name:"ani1",id:1,frameRate:24,action:0},{nodes:[{target:36,keyframes:{x:[{value:1354,tweenMethod:"linearNone",tween:!0,target:36,key:"x",index:0},{value:1354,tweenMethod:"linearNone",tween:!0,target:36,label:null,key:"x",index:2},{value:1354,tweenMethod:"linearNone",tween:!0,target:36,label:null,key:"x",index:3}],visible:[{value:!0,tweenMethod:"linearNone",tween:!1,target:36,key:"visible",index:0},{value:!1,tweenMethod:"linearNone",tween:!1,target:36,key:"visible",index:3}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:36,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:36,key:"alpha",index:2},{value:0,tweenMethod:"linearNone",tween:!0,target:36,label:null,key:"alpha",index:3}]}},{target:37,keyframes:{y:[{value:549,tweenMethod:"linearNone",tween:!0,target:37,key:"y",index:0},{value:556,tweenMethod:"expoOut",tween:!0,target:37,key:"y",index:6},{value:556,tweenMethod:"linearNone",tween:!0,target:37,label:null,key:"y",index:7}],x:[{value:1377,tweenMethod:"linearNone",tween:!0,target:37,key:"x",index:0},{value:1418,tweenMethod:"expoOut",tween:!0,target:37,label:null,key:"x",index:6},{value:1418,tweenMethod:"linearNone",tween:!0,target:37,label:null,key:"x",index:7}],width:[{value:141.6,tweenMethod:"expoOut",tween:!0,target:37,key:"width",index:0},{value:200,tweenMethod:"expoOut",tween:!0,target:37,key:"width",index:6},{value:200,tweenMethod:"linearNone",tween:!0,target:37,label:null,key:"width",index:7}],visible:[{value:!0,tweenMethod:"linearNone",tween:!1,target:37,key:"visible",index:0},{value:!1,tweenMethod:"linearNone",tween:!1,target:37,key:"visible",index:7}],rotation:[{value:15,tweenMethod:"linearNone",tween:!0,target:37,key:"rotation",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:37,key:"rotation",index:6},{value:0,tweenMethod:"linearNone",tween:!0,target:37,label:null,key:"rotation",index:7}],height:[{value:705.6,tweenMethod:"expoOut",tween:!0,target:37,key:"height",index:0},{value:997,tweenMethod:"linearNone",tween:!0,target:37,key:"height",index:6},{value:997,tweenMethod:"linearNone",tween:!0,target:37,label:null,key:"height",index:7}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:37,key:"alpha",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:37,key:"alpha",index:6},{value:1,tweenMethod:"linearNone",tween:!0,target:37,label:null,key:"alpha",index:7}]}},{target:47,keyframes:{x:[{value:1129,tweenMethod:"linearNone",tween:!0,target:47,key:"x",index:0},{value:1129,tweenMethod:"linearNone",tween:!0,target:47,key:"x",index:6},{value:1129,tweenMethod:"linearNone",tween:!0,target:47,label:null,key:"x",index:7},{value:1129,tweenMethod:"linearNone",tween:!0,target:47,key:"x",index:17}],visible:[{value:!1,tweenMethod:"linearNone",tween:!1,target:47,key:"visible",index:0},{value:!1,tweenMethod:"linearNone",tween:!1,target:47,key:"visible",index:6},{value:!0,tweenMethod:"linearNone",tween:!1,target:47,label:null,key:"visible",index:7}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:47,key:"alpha",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:47,key:"alpha",index:6}]}},{target:38,keyframes:{y:[{value:480,tweenMethod:"linearNone",tween:!0,target:38,label:null,key:"y",index:0},{value:480,tweenMethod:"linearNone",tween:!0,target:38,label:null,key:"y",index:5},{value:480,tweenMethod:"linearNone",tween:!0,target:38,key:"y",index:6},{value:480,tweenMethod:"linearNone",tween:!0,target:38,label:null,key:"y",index:11},{value:480,tweenMethod:"linearNone",tween:!0,target:38,label:null,key:"y",index:17}],x:[{value:1068,tweenMethod:"linearNone",tween:!0,target:38,label:null,key:"x",index:0},{value:1068,tweenMethod:"linearNone",tween:!0,target:38,label:null,key:"x",index:5},{value:1068,tweenMethod:"linearNone",tween:!0,target:38,key:"x",index:6},{value:1068,tweenMethod:"expoOut",tween:!0,target:38,label:null,key:"x",index:11},{value:105,tweenMethod:"linearNone",tween:!0,target:38,label:null,key:"x",index:17}],visible:[{value:!1,tweenMethod:"linearNone",tween:!1,target:38,key:"visible",index:0},{value:!1,tweenMethod:"linearNone",tween:!1,target:38,key:"visible",index:5},{value:!0,tweenMethod:"linearNone",tween:!1,target:38,key:"visible",index:6},{value:!0,tweenMethod:"linearNone",tween:!1,target:38,label:null,key:"visible",index:11},{value:!0,tweenMethod:"linearNone",tween:!1,target:38,label:null,key:"visible",index:17}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:38,key:"alpha",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:38,key:"alpha",index:5}]}},{target:59,keyframes:{x:[{value:1119,tweenMethod:"linearNone",tween:!0,target:59,key:"x",index:0},{value:1119,tweenMethod:"linearNone",tween:!0,target:59,key:"x",index:17}],width:[{value:70,tweenMethod:"linearNone",tween:!0,target:59,label:null,key:"width",index:0},{value:70,tweenMethod:"linearNone",tween:!0,target:59,label:null,key:"width",index:6},{value:70,tweenMethod:"linearNone",tween:!0,target:59,label:null,key:"width",index:7},{value:70,tweenMethod:"expoOut",tween:!0,target:59,key:"width",index:11},{value:1015.2,tweenMethod:"linearNone",tween:!0,target:59,key:"width",index:17}],visible:[{value:!1,tweenMethod:"linearNone",tween:!1,target:59,key:"visible",index:0},{value:!0,tweenMethod:"linearNone",tween:!1,target:59,key:"visible",index:7}]}},{target:39,keyframes:{x:[{value:1120,tweenMethod:"linearNone",tween:!0,target:39,key:"x",index:0},{value:1120,tweenMethod:"linearNone",tween:!0,target:39,label:null,key:"x",index:6},{value:1120,tweenMethod:"linearNone",tween:!0,target:39,label:null,key:"x",index:7},{value:1120,tweenMethod:"linearNone",tween:!0,target:39,label:null,key:"x",index:11},{value:1120,tweenMethod:"linearNone",tween:!0,target:39,key:"x",index:17}],visible:[{value:!1,tweenMethod:"linearNone",tween:!1,target:39,key:"visible",index:0},{value:!1,tweenMethod:"linearNone",tween:!1,target:39,key:"visible",index:6},{value:!0,tweenMethod:"linearNone",tween:!1,target:39,key:"visible",index:7}]}},{target:42,keyframes:{x:[{value:669,tweenMethod:"linearNone",tween:!0,target:42,label:null,key:"x",index:0},{value:669,tweenMethod:"linearNone",tween:!0,target:42,label:null,key:"x",index:27},{value:669,tweenMethod:"linearNone",tween:!0,target:42,label:null,key:"x",index:37}],visible:[{value:!1,tweenMethod:"linearNone",tween:!1,target:42,key:"visible",index:0},{value:!0,tweenMethod:"linearNone",tween:!1,target:42,key:"visible",index:27}],scaleY:[{value:1,tweenMethod:"linearNone",tween:!0,target:42,label:null,key:"scaleY",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:42,label:null,key:"scaleY",index:27},{value:1,tweenMethod:"linearNone",tween:!0,target:42,key:"scaleY",index:37}],scaleX:[{value:1,tweenMethod:"linearNone",tween:!0,target:42,label:null,key:"scaleX",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:42,label:null,key:"scaleX",index:27},{value:1,tweenMethod:"linearNone",tween:!0,target:42,key:"scaleX",index:37}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:42,label:null,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:42,label:null,key:"alpha",index:27},{value:1,tweenMethod:"linearNone",tween:!0,target:42,key:"alpha",index:37}]}},{target:44,keyframes:{visible:[{value:!1,tweenMethod:"linearNone",tween:!1,target:44,key:"visible",index:0},{value:!0,tweenMethod:"linearNone",tween:!1,target:44,key:"visible",index:41}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:44,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:44,key:"alpha",index:41},{value:1,tweenMethod:"linearNone",tween:!0,target:44,key:"alpha",index:51}]}},{target:43,keyframes:{visible:[{value:!1,tweenMethod:"linearNone",tween:!1,target:43,key:"visible",index:0},{value:!0,tweenMethod:"linearNone",tween:!1,target:43,key:"visible",index:41}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:43,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:43,key:"alpha",index:41},{value:1,tweenMethod:"linearNone",tween:!0,target:43,key:"alpha",index:51}]}},{target:45,keyframes:{x:[{value:283,tweenMethod:"linearNone",tween:!0,target:45,key:"x",index:0},{value:283,tweenMethod:"linearNone",tween:!0,target:45,label:null,key:"x",index:55},{value:283,tweenMethod:"linearNone",tween:!0,target:45,label:null,key:"x",index:65}],visible:[{value:!1,tweenMethod:"linearNone",tween:!1,target:45,key:"visible",index:0},{value:!0,tweenMethod:"linearNone",tween:!1,target:45,key:"visible",index:55}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:45,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:45,key:"alpha",index:55},{value:1,tweenMethod:"linearNone",tween:!0,target:45,key:"alpha",index:65}]}},{target:55,keyframes:{y:[{value:529,tweenMethod:"linearNone",tween:!0,target:55,label:null,key:"y",index:0},{value:529,tweenMethod:"linearNone",tween:!0,target:55,key:"y",index:80},{value:530,tweenMethod:"linearNone",tween:!0,target:55,key:"y",index:90}],x:[{value:627,tweenMethod:"linearNone",tween:!0,target:55,label:null,key:"x",index:0},{value:627,tweenMethod:"linearNone",tween:!0,target:55,key:"x",index:80},{value:629,tweenMethod:"linearNone",tween:!0,target:55,label:null,key:"x",index:90}],width:[{value:294,tweenMethod:"linearNone",tween:!0,target:55,label:null,key:"width",index:0},{value:294,tweenMethod:"linearNone",tween:!0,target:55,key:"width",index:80}],visible:[{value:!1,tweenMethod:"linearNone",tween:!1,target:55,key:"visible",index:0},{value:!0,tweenMethod:"linearNone",tween:!1,target:55,key:"visible",index:80}],scaleY:[{value:2,tweenMethod:"linearNone",tween:!0,target:55,label:null,key:"scaleY",index:0},{value:4,tweenMethod:"strongIn",tween:!0,target:55,key:"scaleY",index:80},{value:1,tweenMethod:"linearNone",tween:!0,target:55,key:"scaleY",index:90}],scaleX:[{value:2,tweenMethod:"linearNone",tween:!0,target:55,label:null,key:"scaleX",index:0},{value:4,tweenMethod:"strongIn",tween:!0,target:55,key:"scaleX",index:80},{value:1,tweenMethod:"linearNone",tween:!0,target:55,key:"scaleX",index:90}],height:[{value:273.6,tweenMethod:"linearNone",tween:!0,target:55,label:null,key:"height",index:0},{value:273.6,tweenMethod:"expoOut",tween:!0,target:55,key:"height",index:80},{value:274,tweenMethod:"linearNone",tween:!0,target:55,key:"height",index:90}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:55,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:55,key:"alpha",index:80},{value:1,tweenMethod:"linearNone",tween:!0,target:55,key:"alpha",index:90}]}},{target:46,keyframes:{x:[{value:724,tweenMethod:"linearNone",tween:!0,target:46,key:"x",index:0},{value:724,tweenMethod:"linearNone",tween:!0,target:46,key:"x",index:102},{value:724,tweenMethod:"linearNone",tween:!0,target:46,label:null,key:"x",index:112}],visible:[{value:!1,tweenMethod:"linearNone",tween:!1,target:46,key:"visible",index:0},{value:!0,tweenMethod:"linearNone",tween:!1,target:46,key:"visible",index:102}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:46,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:46,key:"alpha",index:102},{value:1,tweenMethod:"linearNone",tween:!0,target:46,key:"alpha",index:112}]}},{target:52,keyframes:{wordWrap:[{value:!1,tweenMethod:"linearNone",tween:!1,target:52,key:"wordWrap",index:0},{value:!0,tweenMethod:"linearNone",tween:!1,target:52,key:"wordWrap",index:102}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:52,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:52,key:"alpha",index:102},{value:1,tweenMethod:"linearNone",tween:!0,target:52,key:"alpha",index:112}]}},{target:53,keyframes:{y:[{value:189,tweenMethod:"linearNone",tween:!0,target:53,label:null,key:"y",index:0},{value:115,tweenMethod:"linearNone",tween:!0,target:53,key:"y",index:121},{value:110,tweenMethod:"linearNone",tween:!0,target:53,key:"y",index:131}],x:[{value:1186,tweenMethod:"linearNone",tween:!0,target:53,label:null,key:"x",index:0},{value:1186,tweenMethod:"linearNone",tween:!0,target:53,key:"x",index:121},{value:1186,tweenMethod:"linearNone",tween:!0,target:53,label:null,key:"x",index:131}],visible:[{value:!1,tweenMethod:"linearNone",tween:!1,target:53,key:"visible",index:0},{value:!0,tweenMethod:"linearNone",tween:!1,target:53,key:"visible",index:121}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:53,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:53,key:"alpha",index:121},{value:1,tweenMethod:"linearNone",tween:!0,target:53,key:"alpha",index:131}]}},{target:35,keyframes:{x:[{value:0,tweenMethod:"linearNone",tween:!0,target:35,key:"x",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:35,label:null,key:"x",index:131}]}},{target:51,keyframes:{visible:[{value:!0,tweenMethod:"linearNone",tween:!1,target:51,key:"visible",index:0}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:51,key:"alpha",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:51,key:"alpha",index:1}]}}],name:"ani2",id:2,frameRate:24,action:0},{nodes:[{target:35,keyframes:{x:[{value:0,tweenMethod:"linearNone",tween:!0,target:35,key:"x",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:35,label:null,key:"x",index:14},{value:0,tweenMethod:"linearNone",tween:!0,target:35,label:null,key:"x",index:20}],alpha:[{value:.7,tweenMethod:"linearNone",tween:!0,target:35,key:"alpha",index:0},{value:.7,tweenMethod:"linearNone",tween:!0,target:35,key:"alpha",index:14},{value:0,tweenMethod:"linearNone",tween:!0,target:35,key:"alpha",index:20}]}},{target:42,keyframes:{x:[{value:669,tweenMethod:"linearNone",tween:!0,target:42,key:"x",index:0},{value:669,tweenMethod:"linearNone",tween:!0,target:42,key:"x",index:1}],visible:[{value:!0,tweenMethod:"linearNone",tween:!1,target:42,key:"visible",index:0},{value:!1,tweenMethod:"linearNone",tween:!1,target:42,key:"visible",index:1}]}},{target:43,keyframes:{visible:[{value:!0,tweenMethod:"linearNone",tween:!1,target:43,key:"visible",index:0},{value:!1,tweenMethod:"linearNone",tween:!1,target:43,key:"visible",index:1}]}},{target:44,keyframes:{visible:[{value:!0,tweenMethod:"linearNone",tween:!1,target:44,key:"visible",index:0},{value:!1,tweenMethod:"linearNone",tween:!1,target:44,key:"visible",index:1}]}},{target:45,keyframes:{x:[{value:283,tweenMethod:"linearNone",tween:!0,target:45,key:"x",index:0},{value:283,tweenMethod:"linearNone",tween:!0,target:45,key:"x",index:1}],visible:[{value:!0,tweenMethod:"linearNone",tween:!1,target:45,key:"visible",index:0},{value:!1,tweenMethod:"linearNone",tween:!1,target:45,key:"visible",index:1}]}},{target:55,keyframes:{x:[{value:629,tweenMethod:"linearNone",tween:!0,target:55,key:"x",index:0},{value:629,tweenMethod:"linearNone",tween:!0,target:55,key:"x",index:1}],visible:[{value:!0,tweenMethod:"linearNone",tween:!1,target:55,key:"visible",index:0},{value:!1,tweenMethod:"linearNone",tween:!1,target:55,key:"visible",index:1}]}},{target:46,keyframes:{x:[{value:724,tweenMethod:"linearNone",tween:!0,target:46,key:"x",index:0},{value:724,tweenMethod:"linearNone",tween:!0,target:46,key:"x",index:1}],visible:[{value:!0,tweenMethod:"linearNone",tween:!1,target:46,key:"visible",index:0},{value:!1,tweenMethod:"linearNone",tween:!1,target:46,key:"visible",index:1}]}},{target:52,keyframes:{wordWrap:[{value:!1,tweenMethod:"linearNone",tween:!1,target:52,key:"wordWrap",index:0}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:52,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:52,key:"alpha",index:1}]}},{target:47,keyframes:{x:[{value:1129,tweenMethod:"linearNone",tween:!0,target:47,key:"x",index:0},{value:1129,tweenMethod:"linearNone",tween:!0,target:47,key:"x",index:11},{value:1129,tweenMethod:"linearNone",tween:!0,target:47,label:null,key:"x",index:12},{value:1129,tweenMethod:"linearNone",tween:!0,target:47,label:null,key:"x",index:14}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:47,key:"alpha",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:47,key:"alpha",index:12},{value:0,tweenMethod:"linearNone",tween:!0,target:47,key:"alpha",index:14}]}},{target:38,keyframes:{x:[{value:105,tweenMethod:"expoOut",tween:!0,target:38,key:"x",index:0},{value:1068,tweenMethod:"linearNone",tween:!0,target:38,key:"x",index:11},{value:1068,tweenMethod:"linearNone",tween:!0,target:38,label:null,key:"x",index:12},{value:1068,tweenMethod:"linearNone",tween:!0,target:38,label:null,key:"x",index:14}],visible:[{value:!0,tweenMethod:"linearNone",tween:!1,target:38,key:"visible",index:0}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:38,key:"alpha",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:38,key:"alpha",index:11},{value:0,tweenMethod:"linearNone",tween:!0,target:38,key:"alpha",index:14}]}},{target:39,keyframes:{x:[{value:1120,tweenMethod:"linearNone",tween:!0,target:39,key:"x",index:0},{value:1120,tweenMethod:"linearNone",tween:!0,target:39,label:null,key:"x",index:10},{value:1120,tweenMethod:"linearNone",tween:!0,target:39,label:null,key:"x",index:11}],visible:[{value:!0,tweenMethod:"linearNone",tween:!1,target:39,key:"visible",index:0},{value:!1,tweenMethod:"linearNone",tween:!1,target:39,key:"visible",index:11}]}},{target:59,keyframes:{x:[{value:1119,tweenMethod:"linearNone",tween:!0,target:59,key:"x",index:0},{value:1119,tweenMethod:"linearNone",tween:!0,target:59,label:null,key:"x",index:10},{value:1119,tweenMethod:"linearNone",tween:!0,target:59,label:null,key:"x",index:11}],width:[{value:1015.2,tweenMethod:"expoOut",tween:!0,target:59,key:"width",index:0},{value:70,tweenMethod:"linearNone",tween:!0,target:59,label:null,key:"width",index:10},{value:70,tweenMethod:"linearNone",tween:!0,target:59,key:"width",index:11}],visible:[{value:!0,tweenMethod:"linearNone",tween:!1,target:59,key:"visible",index:0},{value:!1,tweenMethod:"linearNone",tween:!1,target:59,key:"visible",index:11}]}},{target:53,keyframes:{x:[{value:1186,tweenMethod:"linearNone",tween:!0,target:53,key:"x",index:0},{value:1186,tweenMethod:"linearNone",tween:!0,target:53,label:null,key:"x",index:12},{value:1186,tweenMethod:"linearNone",tween:!0,target:53,key:"x",index:14}],visible:[{value:!1,tweenMethod:"linearNone",tween:!1,target:53,key:"visible",index:0}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:53,key:"alpha",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:53,label:null,key:"alpha",index:12},{value:0,tweenMethod:"linearNone",tween:!0,target:53,key:"alpha",index:14}]}},{target:36,keyframes:{visible:[{value:!1,tweenMethod:"linearNone",tween:!1,target:36,key:"visible",index:0}]}},{target:51,keyframes:{visible:[{value:!0,tweenMethod:"linearNone",tween:!1,target:51,key:"visible",index:0}]}}],name:"ani3",id:3,frameRate:24,action:0},{nodes:[{target:60,keyframes:{x:[{value:0,tweenMethod:"linearNone",tween:!0,target:60,key:"x",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:60,label:null,key:"x",index:15}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:60,key:"alpha",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:60,label:null,key:"alpha",index:15}]}}],name:"ani0",id:5,frameRate:24,action:0},{nodes:[{target:5,keyframes:{y:[{value:115,tweenMethod:"linearNone",tween:!0,target:5,key:"y",index:0},{value:115,tweenMethod:"linearNone",tween:!0,target:5,key:"y",index:11},{value:115,tweenMethod:"linearNone",tween:!0,target:5,key:"y",index:25}],x:[{value:131,tweenMethod:"linearNone",tween:!0,target:5,key:"x",index:0},{value:131,tweenMethod:"linearNone",tween:!0,target:5,label:null,key:"x",index:11},{value:131,tweenMethod:"linearNone",tween:!0,target:5,label:null,key:"x",index:25}],visible:[{value:!0,tweenMethod:"linearNone",tween:!1,target:5,key:"visible",index:0}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:5,key:"alpha",index:0},{value:1,tweenMethod:"sineIn",tween:!0,target:5,label:null,key:"alpha",index:11},{value:0,tweenMethod:"linearNone",tween:!0,target:5,key:"alpha",index:25}]}},{target:33,keyframes:{y:[{value:35,tweenMethod:"linearNone",tween:!0,target:33,key:"y",index:0},{value:31,tweenMethod:"linearNone",tween:!0,target:33,key:"y",index:31},{value:43.888888888888886,tweenMethod:"strongOut",tween:!0,target:33,key:"y",index:35},{value:60,tweenMethod:"linearNone",tween:!0,target:33,label:null,key:"y",index:48},{value:60,tweenMethod:"linearNone",tween:!0,target:33,label:null,key:"y",index:50}],x:[{value:43,tweenMethod:"linearNone",tween:!0,target:33,key:"x",index:0},{value:43,tweenMethod:"linearNone",tween:!0,target:33,key:"x",index:31},{value:43,tweenMethod:"linearNone",tween:!0,target:33,key:"x",index:33},{value:43,tweenMethod:"linearNone",tween:!0,target:33,key:"x",index:35},{value:43,tweenMethod:"linearNone",tween:!0,target:33,label:null,key:"x",index:48},{value:43,tweenMethod:"linearNone",tween:!0,target:33,label:null,key:"x",index:50}],scaleY:[{value:2,tweenMethod:"linearNone",tween:!0,target:33,key:"scaleY",index:0},{value:1.2,tweenMethod:"linearNone",tween:!0,target:33,key:"scaleY",index:31},{value:1,tweenMethod:"linearNone",tween:!0,target:33,key:"scaleY",index:33},{value:1,tweenMethod:"linearNone",tween:!0,target:33,key:"scaleY",index:35}],scaleX:[{value:2,tweenMethod:"linearNone",tween:!0,target:33,key:"scaleX",index:0},{value:1.2,tweenMethod:"linearNone",tween:!0,target:33,key:"scaleX",index:31},{value:1,tweenMethod:"linearNone",tween:!0,target:33,key:"scaleX",index:33}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:33,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:33,key:"alpha",index:31},{value:1,tweenMethod:"linearNone",tween:!0,target:33,key:"alpha",index:35},{value:1,tweenMethod:"linearNone",tween:!0,target:33,key:"alpha",index:48},{value:0,tweenMethod:"linearNone",tween:!0,target:33,label:null,key:"alpha",index:50}]}},{target:32,keyframes:{y:[{value:31,tweenMethod:"linearNone",tween:!0,target:32,key:"y",index:0},{value:27,tweenMethod:"linearNone",tween:!0,target:32,key:"y",index:31},{value:31,tweenMethod:"linearNone",tween:!0,target:32,key:"y",index:33},{value:31,tweenMethod:"linearNone",tween:!0,target:32,label:null,key:"y",index:35},{value:31,tweenMethod:"linearNone",tween:!0,target:32,key:"y",index:48},{value:31,tweenMethod:"linearNone",tween:!0,target:32,label:null,key:"y",index:50}],x:[{value:48,tweenMethod:"linearNone",tween:!0,target:32,key:"x",index:0},{value:48,tweenMethod:"linearNone",tween:!0,target:32,label:null,key:"x",index:31},{value:48,tweenMethod:"linearNone",tween:!0,target:32,key:"x",index:33},{value:48,tweenMethod:"linearNone",tween:!0,target:32,label:null,key:"x",index:35},{value:48,tweenMethod:"linearNone",tween:!0,target:32,label:null,key:"x",index:48},{value:48,tweenMethod:"linearNone",tween:!0,target:32,label:null,key:"x",index:50}],scaleY:[{value:1,tweenMethod:"linearNone",tween:!0,target:32,key:"scaleY",index:0},{value:1.2,tweenMethod:"linearNone",tween:!0,target:32,key:"scaleY",index:31},{value:1,tweenMethod:"linearNone",tween:!0,target:32,key:"scaleY",index:33}],scaleX:[{value:1,tweenMethod:"linearNone",tween:!0,target:32,key:"scaleX",index:0},{value:1.2,tweenMethod:"linearNone",tween:!0,target:32,key:"scaleX",index:31},{value:1,tweenMethod:"linearNone",tween:!0,target:32,key:"scaleX",index:33}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:32,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:32,key:"alpha",index:31},{value:1,tweenMethod:"linearNone",tween:!0,target:32,key:"alpha",index:33},{value:1,tweenMethod:"linearNone",tween:!0,target:32,label:null,key:"alpha",index:35},{value:1,tweenMethod:"linearNone",tween:!0,target:32,key:"alpha",index:48},{value:0,tweenMethod:"linearNone",tween:!0,target:32,label:null,key:"alpha",index:50}]}},{target:61,keyframes:{y:[{value:115,tweenMethod:"linearNone",tween:!0,target:61,key:"y",index:0},{value:115,tweenMethod:"linearNone",tween:!0,target:61,key:"y",index:56},{value:115,tweenMethod:"linearNone",tween:!0,target:61,key:"y",index:60}],x:[{value:131,tweenMethod:"linearNone",tween:!0,target:61,key:"x",index:0},{value:131,tweenMethod:"linearNone",tween:!0,target:61,label:null,key:"x",index:56},{value:131,tweenMethod:"linearNone",tween:!0,target:61,key:"x",index:60}],visible:[{value:!0,tweenMethod:"linearNone",tween:!1,target:61,key:"visible",index:0}],scaleY:[{value:2,tweenMethod:"linearNone",tween:!0,target:61,key:"scaleY",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:61,key:"scaleY",index:56},{value:1,tweenMethod:"linearNone",tween:!0,target:61,key:"scaleY",index:60}],scaleX:[{value:2,tweenMethod:"linearNone",tween:!0,target:61,key:"scaleX",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:61,key:"scaleX",index:56},{value:1,tweenMethod:"linearNone",tween:!0,target:61,key:"scaleX",index:60}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:61,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:61,label:null,key:"alpha",index:56},{value:1,tweenMethod:"linearNone",tween:!0,target:61,key:"alpha",index:60}]}},{target:11,keyframes:{x:[{value:27,tweenMethod:"linearNone",tween:!0,target:11,key:"x",index:0},{value:27,tweenMethod:"linearNone",tween:!0,target:11,label:null,key:"x",index:56},{value:27,tweenMethod:"linearNone",tween:!0,target:11,key:"x",index:60}],scaleY:[{value:1,tweenMethod:"linearNone",tween:!0,target:11,key:"scaleY",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:11,key:"scaleY",index:56},{value:1,tweenMethod:"linearNone",tween:!0,target:11,key:"scaleY",index:60}],scaleX:[{value:1,tweenMethod:"linearNone",tween:!0,target:11,key:"scaleX",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:11,key:"scaleX",index:56},{value:1,tweenMethod:"linearNone",tween:!0,target:11,key:"scaleX",index:60}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:11,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:11,label:null,key:"alpha",index:56},{value:1,tweenMethod:"linearNone",tween:!0,target:11,key:"alpha",index:60}]}},{target:7,keyframes:{x:[{value:27,tweenMethod:"linearNone",tween:!0,target:7,key:"x",index:0},{value:27,tweenMethod:"linearNone",tween:!0,target:7,label:null,key:"x",index:56},{value:27,tweenMethod:"linearNone",tween:!0,target:7,label:null,key:"x",index:60}],scaleY:[{value:1,tweenMethod:"linearNone",tween:!0,target:7,key:"scaleY",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:7,key:"scaleY",index:56},{value:1,tweenMethod:"linearNone",tween:!0,target:7,key:"scaleY",index:60}],scaleX:[{value:1,tweenMethod:"linearNone",tween:!0,target:7,key:"scaleX",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:7,key:"scaleX",index:56},{value:1,tweenMethod:"linearNone",tween:!0,target:7,key:"scaleX",index:60}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:7,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:7,key:"alpha",index:56},{value:1,tweenMethod:"linearNone",tween:!0,target:7,key:"alpha",index:60}]}},{target:9,keyframes:{x:[{value:27,tweenMethod:"linearNone",tween:!0,target:9,key:"x",index:0},{value:27,tweenMethod:"linearNone",tween:!0,target:9,label:null,key:"x",index:56},{value:27,tweenMethod:"linearNone",tween:!0,target:9,label:null,key:"x",index:60}],scaleY:[{value:1,tweenMethod:"linearNone",tween:!0,target:9,key:"scaleY",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:9,key:"scaleY",index:56},{value:1,tweenMethod:"linearNone",tween:!0,target:9,key:"scaleY",index:60}],scaleX:[{value:1,tweenMethod:"linearNone",tween:!0,target:9,key:"scaleX",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:9,key:"scaleX",index:56},{value:1,tweenMethod:"linearNone",tween:!0,target:9,key:"scaleX",index:60}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:9,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:9,key:"alpha",index:56},{value:1,tweenMethod:"linearNone",tween:!0,target:9,key:"alpha",index:60}]}}],name:"ani_jiangduan",id:6,frameRate:24,action:0},{nodes:[{target:11,keyframes:{x:[{value:27,tweenMethod:"linearNone",tween:!0,target:11,key:"x",index:0},{value:27,tweenMethod:"linearNone",tween:!0,target:11,label:null,key:"x",index:5}]}},{target:7,keyframes:{x:[{value:27,tweenMethod:"linearNone",tween:!0,target:7,key:"x",index:0},{value:27,tweenMethod:"linearNone",tween:!0,target:7,label:null,key:"x",index:5},{value:27,tweenMethod:"linearNone",tween:!0,target:7,label:null,key:"x",index:6},{value:27,tweenMethod:"linearNone",tween:!0,target:7,label:null,key:"x",index:7}],scaleY:[{value:4,tweenMethod:"linearNone",tween:!0,target:7,key:"scaleY",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:7,key:"scaleY",index:5},{value:1.2,tweenMethod:"linearNone",tween:!0,target:7,label:null,key:"scaleY",index:6},{value:1,tweenMethod:"linearNone",tween:!0,target:7,label:null,key:"scaleY",index:7}],scaleX:[{value:4,tweenMethod:"linearNone",tween:!0,target:7,key:"scaleX",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:7,key:"scaleX",index:5},{value:1.2,tweenMethod:"linearNone",tween:!0,target:7,label:null,key:"scaleX",index:6},{value:1,tweenMethod:"linearNone",tween:!0,target:7,label:null,key:"scaleX",index:7}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:7,key:"alpha",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:7,key:"alpha",index:5},{value:1,tweenMethod:"linearNone",tween:!0,target:7,label:null,key:"alpha",index:6},{value:1,tweenMethod:"linearNone",tween:!0,target:7,label:null,key:"alpha",index:7}]}},{target:9,keyframes:{x:[{value:27,tweenMethod:"linearNone",tween:!0,target:9,key:"x",index:0},{value:27,tweenMethod:"linearNone",tween:!0,target:9,label:null,key:"x",index:5}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:9,key:"alpha",index:0}]}},{target:26,keyframes:{y:[{value:33,tweenMethod:"linearNone",tween:!0,target:26,key:"y",index:0},{value:33,tweenMethod:"linearNone",tween:!0,target:26,label:null,key:"y",index:13},{value:33,tweenMethod:"linearNone",tween:!0,target:26,key:"y",index:14},{value:29,tweenMethod:"linearNone",tween:!0,target:26,label:null,key:"y",index:17},{value:4,tweenMethod:"linearNone",tween:!0,target:26,label:null,key:"y",index:20},{value:4,tweenMethod:"linearNone",tween:!0,target:26,label:null,key:"y",index:26}],x:[{value:5,tweenMethod:"linearNone",tween:!0,target:26,key:"x",index:0},{value:5,tweenMethod:"linearNone",tween:!0,target:26,label:null,key:"x",index:13},{value:5,tweenMethod:"linearNone",tween:!0,target:26,key:"x",index:14},{value:5,tweenMethod:"linearNone",tween:!0,target:26,label:null,key:"x",index:17},{value:5,tweenMethod:"linearNone",tween:!0,target:26,label:null,key:"x",index:20},{value:5,tweenMethod:"linearNone",tween:!0,target:26,label:null,key:"x",index:26}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:26,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:26,key:"alpha",index:13},{value:1,tweenMethod:"linearNone",tween:!0,target:26,key:"alpha",index:14},{value:1,tweenMethod:"linearNone",tween:!0,target:26,key:"alpha",index:26}]}},{target:27,keyframes:{y:[{value:35,tweenMethod:"linearNone",tween:!0,target:27,key:"y",index:0},{value:35,tweenMethod:"linearNone",tween:!0,target:27,label:null,key:"y",index:13},{value:35,tweenMethod:"linearNone",tween:!0,target:27,key:"y",index:14},{value:31,tweenMethod:"linearNone",tween:!0,target:27,key:"y",index:17},{value:31,tweenMethod:"linearNone",tween:!0,target:27,label:null,key:"y",index:20},{value:31,tweenMethod:"linearNone",tween:!0,target:27,label:null,key:"y",index:26}],x:[{value:0,tweenMethod:"linearNone",tween:!0,target:27,key:"x",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:27,label:null,key:"x",index:13},{value:0,tweenMethod:"linearNone",tween:!0,target:27,label:null,key:"x",index:14},{value:0,tweenMethod:"linearNone",tween:!0,target:27,label:null,key:"x",index:17},{value:0,tweenMethod:"linearNone",tween:!0,target:27,label:null,key:"x",index:20},{value:0,tweenMethod:"linearNone",tween:!0,target:27,label:null,key:"x",index:26}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:27,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:27,key:"alpha",index:13},{value:1,tweenMethod:"linearNone",tween:!0,target:27,key:"alpha",index:14},{value:1,tweenMethod:"linearNone",tween:!0,target:27,key:"alpha",index:26}]}}],name:"ani_sheng2xing",id:7,frameRate:24,action:0},{nodes:[{target:11,keyframes:{x:[{value:27,tweenMethod:"linearNone",tween:!0,target:11,key:"x",index:0},{value:27,tweenMethod:"linearNone",tween:!0,target:11,label:null,key:"x",index:24}]}},{target:7,keyframes:{x:[{value:27,tweenMethod:"linearNone",tween:!0,target:7,label:null,key:"x",index:0},{value:27,tweenMethod:"linearNone",tween:!0,target:7,label:null,key:"x",index:3},{value:27,tweenMethod:"linearNone",tween:!0,target:7,label:null,key:"x",index:6},{value:27,tweenMethod:"linearNone",tween:!0,target:7,label:null,key:"x",index:24}],scaleY:[{value:1,tweenMethod:"linearNone",tween:!0,target:7,label:null,key:"scaleY",index:0},{value:1.2,tweenMethod:"linearNone",tween:!0,target:7,label:null,key:"scaleY",index:3},{value:1,tweenMethod:"linearNone",tween:!0,target:7,label:null,key:"scaleY",index:6},{value:2,tweenMethod:"linearNone",tween:!0,target:7,label:null,key:"scaleY",index:24}],scaleX:[{value:1,tweenMethod:"linearNone",tween:!0,target:7,label:null,key:"scaleX",index:0},{value:1.2,tweenMethod:"linearNone",tween:!0,target:7,label:null,key:"scaleX",index:3},{value:1,tweenMethod:"linearNone",tween:!0,target:7,label:null,key:"scaleX",index:6},{value:2,tweenMethod:"linearNone",tween:!0,target:7,label:null,key:"scaleX",index:24}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:7,label:null,key:"alpha",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:7,label:null,key:"alpha",index:3},{value:1,tweenMethod:"linearNone",tween:!0,target:7,label:null,key:"alpha",index:6},{value:0,tweenMethod:"linearNone",tween:!0,target:7,label:null,key:"alpha",index:24}]}},{target:9,keyframes:{x:[{value:27,tweenMethod:"linearNone",tween:!0,target:9,key:"x",index:0},{value:27,tweenMethod:"linearNone",tween:!0,target:9,label:null,key:"x",index:24}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:9,key:"alpha",index:0}]}},{target:29,keyframes:{y:[{value:19,tweenMethod:"linearNone",tween:!0,target:29,key:"y",index:0},{value:15,tweenMethod:"linearNone",tween:!0,target:29,key:"y",index:29},{value:19,tweenMethod:"linearNone",tween:!0,target:29,key:"y",index:32},{value:44,tweenMethod:"linearNone",tween:!0,target:29,label:null,key:"y",index:35},{value:44,tweenMethod:"linearNone",tween:!0,target:29,label:null,key:"y",index:41}],x:[{value:-1,tweenMethod:"linearNone",tween:!0,target:29,key:"x",index:0},{value:-1,tweenMethod:"linearNone",tween:!0,target:29,label:null,key:"x",index:28},{value:-1,tweenMethod:"linearNone",tween:!0,target:29,label:null,key:"x",index:29},{value:-1,tweenMethod:"linearNone",tween:!0,target:29,label:null,key:"x",index:32},{value:-1,tweenMethod:"linearNone",tween:!0,target:29,label:null,key:"x",index:35},{value:-1,tweenMethod:"linearNone",tween:!0,target:29,label:null,key:"x",index:41}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:29,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:29,key:"alpha",index:28},{value:1,tweenMethod:"linearNone",tween:!0,target:29,key:"alpha",index:29},{value:1,tweenMethod:"linearNone",tween:!0,target:29,label:null,key:"alpha",index:32},{value:1,tweenMethod:"linearNone",tween:!0,target:29,label:null,key:"alpha",index:35},{value:1,tweenMethod:"linearNone",tween:!0,target:29,label:null,key:"alpha",index:41}]}},{target:30,keyframes:{y:[{value:29,tweenMethod:"linearNone",tween:!0,target:30,key:"y",index:0},{value:25,tweenMethod:"linearNone",tween:!0,target:30,key:"y",index:29},{value:29,tweenMethod:"linearNone",tween:!0,target:30,key:"y",index:32},{value:29,tweenMethod:"linearNone",tween:!0,target:30,label:null,key:"y",index:35},{value:29,tweenMethod:"linearNone",tween:!0,target:30,label:null,key:"y",index:41}],x:[{value:-3,tweenMethod:"linearNone",tween:!0,target:30,key:"x",index:0},{value:-3,tweenMethod:"linearNone",tween:!0,target:30,label:null,key:"x",index:28},{value:-3,tweenMethod:"linearNone",tween:!0,target:30,label:null,key:"x",index:29},{value:-3,tweenMethod:"linearNone",tween:!0,target:30,label:null,key:"x",index:32},{value:-3,tweenMethod:"linearNone",tween:!0,target:30,label:null,key:"x",index:35},{value:-3,tweenMethod:"linearNone",tween:!0,target:30,label:null,key:"x",index:41}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:30,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:30,key:"alpha",index:28},{value:1,tweenMethod:"linearNone",tween:!0,target:30,key:"alpha",index:29},{value:1,tweenMethod:"linearNone",tween:!0,target:30,label:null,key:"alpha",index:32},{value:1,tweenMethod:"linearNone",tween:!0,target:30,label:null,key:"alpha",index:35},{value:1,tweenMethod:"linearNone",tween:!0,target:30,label:null,key:"alpha",index:41}]}}],name:"ani_diao1xing",id:7,frameRate:24,action:0},{nodes:[{target:11,keyframes:{x:[{value:27,tweenMethod:"linearNone",tween:!0,target:11,key:"x",index:0},{value:27,tweenMethod:"linearNone",tween:!0,target:11,label:null,key:"x",index:5}]}},{target:7,keyframes:{x:[{value:27,tweenMethod:"linearNone",tween:!0,target:7,key:"x",index:0},{value:27,tweenMethod:"linearNone",tween:!0,target:7,label:null,key:"x",index:5}],scaleY:[{value:1,tweenMethod:"linearNone",tween:!0,target:7,key:"scaleY",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:7,key:"scaleY",index:5}],scaleX:[{value:1,tweenMethod:"linearNone",tween:!0,target:7,key:"scaleX",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:7,key:"scaleX",index:5}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:7,key:"alpha",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:7,key:"alpha",index:5}]}},{target:9,keyframes:{x:[{value:27,tweenMethod:"linearNone",tween:!0,target:9,key:"x",index:0},{value:27,tweenMethod:"linearNone",tween:!0,target:9,label:null,key:"x",index:5},{value:27,tweenMethod:"linearNone",tween:!0,target:9,label:null,key:"x",index:6},{value:27,tweenMethod:"linearNone",tween:!0,target:9,label:null,key:"x",index:7}],scaleY:[{value:4,tweenMethod:"linearNone",tween:!0,target:9,key:"scaleY",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:9,key:"scaleY",index:5},{value:1.2,tweenMethod:"linearNone",tween:!0,target:9,key:"scaleY",index:6},{value:1,tweenMethod:"linearNone",tween:!0,target:9,key:"scaleY",index:7}],scaleX:[{value:4,tweenMethod:"linearNone",tween:!0,target:9,key:"scaleX",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:9,key:"scaleX",index:5},{value:1.2,tweenMethod:"linearNone",tween:!0,target:9,key:"scaleX",index:6},{value:1,tweenMethod:"linearNone",tween:!0,target:9,key:"scaleX",index:7}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:9,key:"alpha",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:9,key:"alpha",index:5}]}},{target:26,keyframes:{y:[{value:33,tweenMethod:"linearNone",tween:!0,target:26,key:"y",index:0},{value:33,tweenMethod:"linearNone",tween:!0,target:26,label:null,key:"y",index:13},{value:33,tweenMethod:"linearNone",tween:!0,target:26,key:"y",index:14},{value:29,tweenMethod:"linearNone",tween:!0,target:26,label:null,key:"y",index:17},{value:4,tweenMethod:"linearNone",tween:!0,target:26,label:null,key:"y",index:20},{value:4,tweenMethod:"linearNone",tween:!0,target:26,label:null,key:"y",index:26}],x:[{value:5,tweenMethod:"linearNone",tween:!0,target:26,key:"x",index:0},{value:5,tweenMethod:"linearNone",tween:!0,target:26,label:null,key:"x",index:13},{value:5,tweenMethod:"linearNone",tween:!0,target:26,key:"x",index:14},{value:5,tweenMethod:"linearNone",tween:!0,target:26,label:null,key:"x",index:17},{value:5,tweenMethod:"linearNone",tween:!0,target:26,label:null,key:"x",index:20},{value:5,tweenMethod:"linearNone",tween:!0,target:26,label:null,key:"x",index:26}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:26,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:26,key:"alpha",index:13},{value:1,tweenMethod:"linearNone",tween:!0,target:26,key:"alpha",index:14},{value:1,tweenMethod:"linearNone",tween:!0,target:26,key:"alpha",index:26}]}},{target:27,keyframes:{y:[{value:35,tweenMethod:"linearNone",tween:!0,target:27,key:"y",index:0},{value:35,tweenMethod:"linearNone",tween:!0,target:27,label:null,key:"y",index:13},{value:35,tweenMethod:"linearNone",tween:!0,target:27,key:"y",index:14},{value:31,tweenMethod:"linearNone",tween:!0,target:27,key:"y",index:17},{value:31,tweenMethod:"linearNone",tween:!0,target:27,label:null,key:"y",index:20},{value:31,tweenMethod:"linearNone",tween:!0,target:27,label:null,key:"y",index:26}],x:[{value:0,tweenMethod:"linearNone",tween:!0,target:27,key:"x",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:27,label:null,key:"x",index:13},{value:0,tweenMethod:"linearNone",tween:!0,target:27,label:null,key:"x",index:14},{value:0,tweenMethod:"linearNone",tween:!0,target:27,label:null,key:"x",index:17},{value:0,tweenMethod:"linearNone",tween:!0,target:27,label:null,key:"x",index:20},{value:0,tweenMethod:"linearNone",tween:!0,target:27,label:null,key:"x",index:26}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:27,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:27,key:"alpha",index:13},{value:1,tweenMethod:"linearNone",tween:!0,target:27,key:"alpha",index:14},{value:1,tweenMethod:"linearNone",tween:!0,target:27,key:"alpha",index:26}]}}],name:"ani_sheng3xing",id:7,frameRate:24,action:0},{nodes:[{target:11,keyframes:{x:[{value:27,tweenMethod:"linearNone",tween:!0,target:11,key:"x",index:0},{value:27,tweenMethod:"linearNone",tween:!0,target:11,label:null,key:"x",index:24}]}},{target:7,keyframes:{x:[{value:27,tweenMethod:"linearNone",tween:!0,target:7,label:null,key:"x",index:0},{value:27,tweenMethod:"linearNone",tween:!0,target:7,label:null,key:"x",index:24}],scaleY:[{value:1,tweenMethod:"linearNone",tween:!0,target:7,label:null,key:"scaleY",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:7,label:null,key:"scaleY",index:24}],scaleX:[{value:1,tweenMethod:"linearNone",tween:!0,target:7,label:null,key:"scaleX",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:7,label:null,key:"scaleX",index:24}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:7,label:null,key:"alpha",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:7,label:null,key:"alpha",index:24}]}},{target:9,keyframes:{x:[{value:27,tweenMethod:"linearNone",tween:!0,target:9,key:"x",index:0},{value:27,tweenMethod:"linearNone",tween:!0,target:9,label:null,key:"x",index:3},{value:27,tweenMethod:"linearNone",tween:!0,target:9,label:null,key:"x",index:6},{value:27,tweenMethod:"linearNone",tween:!0,target:9,label:null,key:"x",index:24}],scaleY:[{value:1,tweenMethod:"linearNone",tween:!0,target:9,key:"scaleY",index:0},{value:1.2,tweenMethod:"linearNone",tween:!0,target:9,key:"scaleY",index:3},{value:1,tweenMethod:"linearNone",tween:!0,target:9,key:"scaleY",index:6},{value:2,tweenMethod:"linearNone",tween:!0,target:9,key:"scaleY",index:24}],scaleX:[{value:1,tweenMethod:"linearNone",tween:!0,target:9,key:"scaleX",index:0},{value:1.2,tweenMethod:"linearNone",tween:!0,target:9,key:"scaleX",index:3},{value:1,tweenMethod:"linearNone",tween:!0,target:9,key:"scaleX",index:6},{value:2,tweenMethod:"linearNone",tween:!0,target:9,key:"scaleX",index:24}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:9,key:"alpha",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:9,label:null,key:"alpha",index:3},{value:1,tweenMethod:"linearNone",tween:!0,target:9,label:null,key:"alpha",index:6},{value:0,tweenMethod:"linearNone",tween:!0,target:9,key:"alpha",index:24}]}},{target:29,keyframes:{y:[{value:19,tweenMethod:"linearNone",tween:!0,target:29,key:"y",index:0},{value:15,tweenMethod:"linearNone",tween:!0,target:29,key:"y",index:29},{value:19,tweenMethod:"linearNone",tween:!0,target:29,key:"y",index:32},{value:44,tweenMethod:"linearNone",tween:!0,target:29,label:null,key:"y",index:35},{value:44,tweenMethod:"linearNone",tween:!0,target:29,label:null,key:"y",index:41}],x:[{value:-1,tweenMethod:"linearNone",tween:!0,target:29,key:"x",index:0},{value:-1,tweenMethod:"linearNone",tween:!0,target:29,label:null,key:"x",index:28},{value:-1,tweenMethod:"linearNone",tween:!0,target:29,label:null,key:"x",index:29},{value:-1,tweenMethod:"linearNone",tween:!0,target:29,label:null,key:"x",index:32},{value:-1,tweenMethod:"linearNone",tween:!0,target:29,label:null,key:"x",index:35},{value:-1,tweenMethod:"linearNone",tween:!0,target:29,label:null,key:"x",index:41}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:29,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:29,key:"alpha",index:28},{value:1,tweenMethod:"linearNone",tween:!0,target:29,key:"alpha",index:29},{value:1,tweenMethod:"linearNone",tween:!0,target:29,label:null,key:"alpha",index:32},{value:1,tweenMethod:"linearNone",tween:!0,target:29,label:null,key:"alpha",index:35},{value:1,tweenMethod:"linearNone",tween:!0,target:29,label:null,key:"alpha",index:41}]}},{target:30,keyframes:{y:[{value:29,tweenMethod:"linearNone",tween:!0,target:30,key:"y",index:0},{value:25,tweenMethod:"linearNone",tween:!0,target:30,key:"y",index:29},{value:29,tweenMethod:"linearNone",tween:!0,target:30,key:"y",index:32},{value:29,tweenMethod:"linearNone",tween:!0,target:30,label:null,key:"y",index:35},{value:29,tweenMethod:"linearNone",tween:!0,target:30,label:null,key:"y",index:41}],x:[{value:-3,tweenMethod:"linearNone",tween:!0,target:30,key:"x",index:0},{value:-3,tweenMethod:"linearNone",tween:!0,target:30,label:null,key:"x",index:28},{value:-3,tweenMethod:"linearNone",tween:!0,target:30,label:null,key:"x",index:29},{value:-3,tweenMethod:"linearNone",tween:!0,target:30,label:null,key:"x",index:32},{value:-3,tweenMethod:"linearNone",tween:!0,target:30,label:null,key:"x",index:35},{value:-3,tweenMethod:"linearNone",tween:!0,target:30,label:null,key:"x",index:41}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:30,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:30,key:"alpha",index:28},{value:1,tweenMethod:"linearNone",tween:!0,target:30,key:"alpha",index:29},{value:1,tweenMethod:"linearNone",tween:!0,target:30,label:null,key:"alpha",index:32},{value:1,tweenMethod:"linearNone",tween:!0,target:30,label:null,key:"alpha",index:35},{value:1,tweenMethod:"linearNone",tween:!0,target:30,label:null,key:"alpha",index:41}]}}],name:"ani_diao2xing",id:7,frameRate:24,action:0}]},i}(View);t.rankchangeUI=i}(e.mj||(e.mj={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.CButton",capsui.CButton),View.regComponent("capsui.UICopy",capsui.UICopy),View.regComponent("capsui.CScrollView",capsui.CScrollView),t.prototype.createChildren.call(this),this.createView(e.mj.replayUI.uiView)},i.uiView={type:"View",props:{width:1920,mouseThrough:!0,height:1080},child:[{type:"Button",props:{y:315,x:806,width:308,name:"btn_change_score",height:214}},{type:"Sprite",props:{y:765,x:570,width:1211,scaleY:.9,scaleX:.9,name:"root",height:124},child:[{type:"Image",props:{y:-1,x:-5,width:1213,skin:"myres/mjdesktop/replaybox.png",height:123,sizeGrid:"17,19,19,19"}},{type:"Button",props:{y:58,x:238,width:80,name:"preround",height:80,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:16,x:16,width:46,skin:"myres/mjdesktop/fastforward.png",height:48}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:58,x:465,width:80,name:"nextround",height:80,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:16,x:41,width:46,skin:"myres/mjdesktop/fastforward.png",scaleX:-1,height:48,anchorX:.5}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:58,x:587,width:80,name:"preturn",height:80,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:16,x:15,width:44,skin:"myres/mjdesktop/forward.png",height:47}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:58,x:831,width:80,name:"nextturn",height:80,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:16,x:64,width:44,skin:"myres/mjdesktop/forward.png",scaleX:-1,height:47}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:58,x:960,width:80,name:"prestep",height:80,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:16,x:15,width:36,skin:"myres/mjdesktop/next.png",height:53}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:58,x:1054,width:80,name:"play",height:80,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:16,x:30,width:26,skin:"myres/mjdesktop/play.png",name:"play",height:51}},{type:"Image",props:{y:21,x:28,skin:"myres/mjdesktop/pause.png",name:"pause"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:58,x:1144,width:80,name:"nextstep",height:80,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:16,x:67,width:36,skin:"myres/mjdesktop/next.png",scaleX:-1,height:53}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:59,x:355,width:137,name:"round",height:79,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:10,x:12,width:111,skin:"myres/mjdesktop/btn_round.png",name:"bg",height:59}},{type:"Label",props:{y:19,x:55,text:"8",scaleY:.9,scaleX:.9,name:"ju",fontSize:40,font:"haolong",color:"#120208"}},{type:"Label",props:{y:14,x:13,width:49,text:"东",name:"chang",height:40,fontSize:40,font:"fengyu",color:"#120208",align:"center"}},{type:"Label",props:{y:14,x:67,width:63,text:"局",height:40,fontSize:40,font:"fengyu",color:"#120208",align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:58,x:711,width:158,name:"turn",height:98,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:20,x:18,width:123,skin:"myres/mjdesktop/btn_round.png",height:59}},{type:"Label",props:{y:24,x:85,text:"巡",name:"turn",fontSize:40,font:"fengyu",color:"#120208"}},{type:"Label",props:{y:31,x:36,width:49,text:"99",scaleY:.9,scaleX:.9,name:"xun",height:44,fontSize:44,font:"haolong",color:"#120208",align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Image",props:{y:20,x:526,width:4,skin:"myres/mjdesktop/vline.png",height:76}},{type:"Image",props:{y:20,x:893,width:4,skin:"myres/mjdesktop/vline.png",height:76}},{type:"Image",props:{y:20,x:176,width:4,skin:"myres/mjdesktop/vline.png",height:76}},{type:"Button",props:{y:59,x:99,width:137,name:"paishan",height:79,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:10,x:12,width:111,skin:"myres/mjdesktop/btn_round.png",name:"bg",height:59}},{type:"Label",props:{y:14,x:7,width:123,text:"牌山",height:40,fontSize:40,font:"fengyu",color:"#120208",align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]},{type:"Sprite",props:{y:125,x:600,width:570,name:"info_chang",height:634},child:[{type:"Image",props:{y:0,x:0,width:573,skin:"myres/mjdesktop/round_bg.png",name:"bg",mouseThrough:!1,height:630,sizeGrid:"9,10,12,10"}},{type:"Panel",props:{y:49,x:13,width:548,name:"content",height:531},child:[{type:"Button",props:{y:0,x:7,width:532,name:"templete",height:179},child:[{type:"Image",props:{y:2,x:0,width:532,skin:"myres/mjdesktop/func_btn.png",name:"bg",height:175,sizeGrid:"26,17,21,23"}},{type:"Image",props:{y:120,x:18,width:496,skin:"myres/mjdesktop/line.png",name:"line",height:2}},{type:"Label",props:{y:7,x:157,text:"东 ",scaleX:.9,name:"chang",fontSize:34,font:"fengyu",color:"#698ad7"}},{type:"Label",props:{y:15,x:193,text:"8",scaleY:.85,scaleX:.85,name:"ju",fontSize:34,font:"haolong",color:"#698ad7"}},{type:"Label",props:{y:7,x:216,text:"局",fontSize:34,font:"fengyu",color:"#698ad7"}},{type:"Label",props:{y:15,x:260,width:38,text:"8",scaleY:.85,scaleX:.85,name:"ben",height:34,fontSize:34,font:"haolong",color:"#698ad7",align:"right"}},{type:"Label",props:{y:7,x:274,width:117,text:"本场",height:40,fontSize:34,font:"fengyu",color:"#698ad7",align:"center"}},{type:"Label",props:{y:70,x:23,text:"荒牌流局",scaleY:.8,scaleX:.7,name:"liuju",fontSize:36,font:"fengyu",color:"#8d8fac"}},{type:"Sprite",props:{y:64,x:17,width:503,name:"win",height:40},child:[{type:"Sprite",props:{y:0,x:105,width:397,name:"player",height:113},child:[{type:"Sprite",props:{y:0,x:0,width:397,height:40},child:[{type:"Label",props:{y:12,x:21,width:241,text:"蹦蹦跳跳的仙太郎",name:"name",height:31,fontSize:28,font:"SimHei",color:"#b3b2b5",align:"center"}},{type:"Label",props:{y:10,x:281,width:124,text:"25000",scaleY:.7,scaleX:.7,name:"point",height:30,fontSize:30,font:"haolong",color:"#698ad7",align:"right"}}]},{type:"Sprite",props:{y:40,width:397,height:40},child:[{type:"Label",props:{y:12,x:21,width:241,text:"蹦蹦跳跳的仙太郎",name:"name",height:31,fontSize:28,font:"SimHei",color:"#b3b2b5",align:"center"}},{type:"Label",props:{y:10,x:281,width:124,text:"25000",scaleY:.7,scaleX:.7,name:"point",fontSize:30,font:"haolong",color:"#698ad7",align:"right"}}]},{type:"Sprite",props:{y:80,x:0,width:397,height:40},child:[{type:"Label",props:{y:12,x:21,width:241,text:"蹦蹦跳跳的仙太郎",name:"name",height:31,fontSize:28,font:"SimHei",color:"#b3b2b5",align:"center"}},{type:"Label",props:{y:10,x:281,width:124,text:"25000",scaleY:.7,scaleX:.7,name:"point",fontSize:30,font:"haolong",color:"#698ad7",align:"right"}}]},{type:"Sprite",props:{y:120,x:0,width:397,height:40},child:[{type:"Label",props:{y:12,x:21,width:241,text:"蹦蹦跳跳的仙太郎",name:"name",height:31,fontSize:28,font:"SimHei",color:"#b3b2b5",align:"center"}},{type:"Label",props:{y:10,x:281,width:124,text:"25000",scaleY:.7,scaleX:.7,name:"point",fontSize:30,font:"haolong",color:"#698ad7",align:"right"}}]}]},{type:"Label",props:{y:5,x:5,text:"自摸",scaleY:.8,scaleX:.8,name:"info",fontSize:36,font:"fengyu",color:"#ea3694"}}]},{type:"Sprite",props:{y:123,x:17,width:503,name:"lose",height:40},child:[{type:"Sprite",props:{y:0,x:105,width:397,name:"player",height:113},child:[{type:"Sprite",props:{y:0,x:0,width:397,height:40},child:[{type:"Label",props:{y:12,x:21,width:241,text:"蹦蹦跳跳的仙太郎",name:"name",height:31,fontSize:28,font:"SimHei",color:"#b3b2b5",align:"center"}},{type:"Label",props:{y:10,x:257,width:161,text:"25000",scaleY:.7,scaleX:.7,name:"point",height:50,fontSize:30,font:"haolong",color:"#698ad7",align:"right"}}]}]},{type:"Label",props:{y:3,x:5,width:130,text:"放铳",scaleY:.8,scaleX:.8,name:"chong",height:50,fontSize:36,font:"fengyu",color:"#af6ae8"}}]},{type:"Script",props:{y:-8,x:-7,runtime:"capsui.UICopy"}}]}]},{type:"Button",props:{y:31,x:285,width:549,pivotY:24,pivotX:274,name:"up",height:44},child:[{type:"Image",props:{y:25,x:273,width:39,skin:"myres/mjdesktop/open_arrow.png",scaleY:1,rotation:0,name:"arrow",height:12,anchorY:.8,anchorX:.5}}]},{type:"Button",props:{y:600,x:285,width:549,pivotY:24,pivotX:274,name:"down",height:44},child:[{type:"Image",props:{y:22,x:273,width:39,skin:"myres/mjdesktop/open_arrow.png",scaleY:-1,rotation:0,name:"arrow",height:12,anchorY:.8,anchorX:.5}}]},{type:"Script",props:{runtime:"capsui.CScrollView"}}]},{type:"Sprite",props:{y:342,x:1065,width:276,name:"info_xun",height:414},child:[{type:"Image",props:{y:0,x:0,width:275,skin:"myres/mjdesktop/round_bg.png",name:"bg",mouseThrough:!1,height:414,sizeGrid:"9,10,12,10"}},{type:"Panel",props:{y:43,x:18,width:242,name:"content",height:325},child:[{type:"Button",props:{y:0,x:7,width:227,name:"templete",height:74},child:[{type:"Image",props:{y:2,x:0,width:227,skin:"myres/mjdesktop/func_btn.png",height:70,sizeGrid:"26,17,21,23"}},{type:"Label",props:{y:23,x:70,text:"99",scaleY:.8,scaleX:.8,name:"num",fontSize:35,font:"haolong",color:"#698ad7",align:"center"}},{type:"Label",props:{y:14,x:116,text:"巡",name:"xun",fontSize:35,font:"fengyu",color:"#698ad7"}},{type:"Script",props:{runtime:"capsui.UICopy"}}]}]},{type:"Button",props:{y:27,x:139,width:233,name:"up",height:28,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:17,x:116,width:39,skin:"myres/mjdesktop/open_arrow.png",scaleY:1,rotation:0,name:"arrow",height:12,anchorY:.8,anchorX:.5}}]},{type:"Button",props:{y:389,x:140,width:233,name:"down",height:28,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:11,x:116,width:39,skin:"myres/mjdesktop/open_arrow.png",scaleY:-1,rotation:0,name:"arrow",height:12,anchorY:.8,anchorX:.5}}]},{type:"Script",props:{runtime:"capsui.CScrollView"}}]},{type:"Sprite",props:{y:562,x:-6,width:342,visible:!0,name:"config",height:293},child:[{type:"Image",props:{y:-8,x:263,width:261,skin:"myres/mjdesktop/chat.png",scaleX:-1,name:"bg",height:299,sizeGrid:"26,0,27,24"},child:[{type:"Image",props:{y:51,x:-75,width:90,skin:"myres/mjdesktop/chat_btn.png",height:194,sizeGrid:"27,18,27,16"}}]},{type:"Label",props:{y:76,x:267,wordWrap:!0,width:48,text:"牌谱",scaleY:1.2,scaleX:1.2,height:104,fontSize:48,font:"fengyu",color:"#e19137"}},{type:"Button",props:{y:78,x:125,width:233,name:"btn_shoupai",height:124,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:1,x:1,width:230,skin:"myres/mjdesktop/func_btn.png",height:119,sizeGrid:"26,17,21,23"},child:[{type:"Label",props:{y:41,x:66,width:147,text:"显示手牌",scaleY:.9,scaleX:.9,height:38,fontSize:36,font:"youyuan",color:"#7793b8"}}]},{type:"Image",props:{y:39,x:12,skin:"myres/mjdesktop/unchoosed.png",scaleY:1.2,scaleX:1.2}},{type:"Image",props:{y:39,x:12,skin:"myres/mjdesktop/choosed.png",scaleY:1.2,scaleX:1.2,name:"choosed"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:206,x:125,width:233,name:"btn_paopai",height:124,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:1,x:1,width:230,skin:"myres/mjdesktop/func_btn.png",height:119,sizeGrid:"26,17,21,23"},child:[{type:"Label",props:{y:41,x:66,width:147,text:"铳牌提示",scaleY:.9,scaleX:.9,height:38,fontSize:36,font:"youyuan",color:"#7793b8"}}]},{type:"Image",props:{y:39,x:12,skin:"myres/mjdesktop/unchoosed.png",scaleY:1.2,scaleX:1.2}},{type:"Image",props:{y:39,x:12,skin:"myres/mjdesktop/choosed.png",scaleY:1.2,scaleX:1.2,name:"choosed"}},{type:"Script",props:{runtime:"capsui.CButton"}}]},{type:"Button",props:{y:15,x:254,width:111,name:"btn_out",height:242}}]},{type:"Sprite",props:{y:113,x:558,width:871,name:"info_paishan",height:634},child:[{type:"Image",props:{y:0,x:-30,width:870,skin:"myres/mjdesktop/round_bg.png",name:"root",mouseThrough:!1,height:630,sizeGrid:"9,10,12,10"},child:[{type:"Panel",props:{y:22,x:19,width:830,name:"content",height:587},child:[{type:"Image",props:{y:0,x:0,width:68,skin:"myres/0m.png",name:"tile_templete",height:110},child:[{type:"Script",props:{runtime:"capsui.UICopy"}}]},{type:"Image",props:{y:469,x:20,width:800,skin:"myres/inputbox.png",name:"input",height:109,sizeGrid:"7,12,10,9"},child:[{type:"TextInput",props:{y:0,x:4,wordWrap:!0,width:786,valign:"top",text:"5p4z6s1z2s7p5p8p0s5z2s8s9m4m6p6s7m3z1m7p2p8s9s3p7s4s8m1s6z1p3m7m4p9p7s7p5s2p8m9p2p2m7z1s9p1s7s4m5z9p8p7m8s1s2p1m0m4p2z3s1m6z4m6s6m5m4m3m8p4s5s9m1z3p9m2s3m3p9s2m1p4z7s",promptColor:"#d0cdcd",padding:"10,10,10,10",name:"txtinput",multiline:!0,height:109,fontSize:25,font:"SimHei",editable:!1,color:"#d0cdcd",align:"left"}},{type:"Label",props:{y:-45,x:4,width:149,text:"牌山代码：",height:39,fontSize:30,font:"SimHei",color:"#ffffff"}},{type:"Button",props:{y:-30,x:185,width:73,name:"btn_what",height:53,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:10,x:20,skin:"myres/bothui/what.png"}},{type:"Script",props:{runtime:"capsui.CButton"}}]}]}]}]}]}]},i}(View);t.replayUI=i}(e.mj||(e.mj={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.createView(e.mj.replay_whellUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Sprite",props:{width:1920,name:"wheel",height:1080}}]},i}(View);t.replay_whellUI=i}(e.mj||(e.mj={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.createView(e.mj.rewardprogressUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Image",props:{y:249,x:959,width:819,skin:"myres/mjdesktop/box_bg.png",name:"container_box",height:295,sizeGrid:"0,113,-9,113"},child:[{type:"Image",props:{y:65,x:298,width:179,skin:"myres/mjdesktop/giftbox.png",name:"icon",height:179}},{type:"Label",props:{y:17,x:315,width:173,text:"铜之礼盒",scaleY:.8,scaleX:.8,name:"title",height:59,font:"fengyu",color:"#fcc45f",align:"center"}},{type:"Image",props:{y:37,x:309,skin:"myres/bothui/box_line.png",scaleX:-1}},{type:"Image",props:{y:37,x:459,skin:"myres/bothui/box_line.png"}},{type:"Image",props:{y:262,x:193,width:384,skin:"myres/mjdesktop/box_exp_bg.png",name:"bar",height:12,sizeGrid:"0,5,0,5"},child:[{type:"Label",props:{y:4,x:454,width:87,text:"+120",name:"num",height:28,fontSize:30,font:"SimHei",color:"#fcc45f",anchorY:.5,anchorX:.5,align:"center"}},{type:"Sprite",props:{width:384,name:"v",height:12},child:[{type:"Image",props:{y:0,x:0,width:384,skin:"myres/mjdesktop/box_exp.png",height:12,sizeGrid:"0,8,0,6"}},{type:"Image",props:{width:384,skin:"myres/mjdesktop/box_exp.png",scaleX:1,renderType:"mask",name:"mask",height:12,sizeGrid:"0,8,0,6"}}]}]}]},{type:"Image",props:{y:635,x:1064,width:785,skin:"myres/mjdesktop/box_bg1.png",name:"container_jiban",height:173,sizeGrid:"0,79,0,78"},child:[{type:"Label",props:{y:21,x:329,width:95,text:"羁绊",scaleY:.8,scaleX:.8,height:59,font:"fengyu",color:"#fcc45f",align:"center"}},{type:"Image",props:{y:41,x:327,skin:"myres/bothui/box_line.png",scaleX:-1}},{type:"Image",props:{y:41,x:408,skin:"myres/bothui/box_line.png"}},{type:"Sprite",props:{y:82,x:334,width:73,name:"hearts",height:62},child:[{type:"Image",props:{y:30,x:0,width:77,skin:"myres/bothui/bf_heart_bg.png",name:"heart",height:67,anchorY:.5,anchorX:0},child:[{type:"Sprite",props:{name:"v"},child:[{type:"Image",props:{y:0,x:0,width:77,skin:"myres/bothui/bf_heart.png",name:"h",height:67}},{type:"Image",props:{y:67,width:77,skin:"myres/bbg.png",scaleY:.1,renderType:"mask",height:67,anchorY:1,sizeGrid:"1,1,1,1"}}]}]},{type:"Image",props:{y:30,x:10,width:77,skin:"myres/bothui/bf_heart_bg.png",name:"heart",height:67,anchorY:.5,anchorX:0},child:[{type:"Sprite",props:{name:"v"},child:[{type:"Image",props:{y:0,x:0,width:77,skin:"myres/bothui/bf_heart.png",name:"h",height:67}},{type:"Image",props:{y:67,width:77,skin:"myres/bbg.png",scaleY:.92,renderType:"mask",height:67,anchorY:1,sizeGrid:"1,1,1,1"}}]}]},{type:"Image",props:{y:30,x:20,width:77,skin:"myres/bothui/bf_heart_bg.png",name:"heart",height:67,anchorY:.5,anchorX:0},child:[{type:"Sprite",props:{name:"v"},child:[{type:"Image",props:{y:0,x:0,width:77,skin:"myres/bothui/bf_heart.png",name:"h",height:67}},{type:"Image",props:{y:67,width:77,skin:"myres/bbg.png",scaleY:.92,renderType:"mask",height:67,anchorY:1,sizeGrid:"1,1,1,1"}}]}]},{type:"Image",props:{y:30,x:30,width:77,skin:"myres/bothui/bf_heart_bg.png",name:"heart",height:67,anchorY:.5,anchorX:0},child:[{type:"Sprite",props:{name:"v"},child:[{type:"Image",props:{y:0,x:0,width:77,skin:"myres/bothui/bf_heart.png",name:"h",height:67}},{type:"Image",props:{y:67,width:77,skin:"myres/bbg.png",scaleY:.92,renderType:"mask",height:67,anchorY:1,sizeGrid:"1,1,1,1"}}]}]},{type:"Image",props:{y:30,x:40,width:77,skin:"myres/bothui/bf_heart_bg.png",name:"heart",height:67,anchorY:.5,anchorX:0},child:[{type:"Sprite",props:{name:"v"},child:[{type:"Image",props:{y:0,x:0,width:77,skin:"myres/bothui/bf_heart.png",name:"h",height:67}},{type:"Image",props:{y:67,width:77,skin:"myres/bbg.png",scaleY:.92,renderType:"mask",height:67,anchorY:1,sizeGrid:"1,1,1,1"}}]}]}]},{type:"Label",props:{y:105,x:642,width:97,text:"+120",name:"num",height:32,fontSize:30,font:"SimHei",color:"#fcc45f",anchorY:.5,anchorX:.5,align:"center"}}]}]},i}(View);t.rewardprogressUI=i}(e.mj||(e.mj={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.createView(e.mj.scoreboardUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Sprite",props:{y:213,x:261,width:1458,height:549},child:[{type:"Image",props:{y:86,x:463,skin:"myres/scoreboard/grade.png",scaleY:1.2,scaleX:1.2,name:"title"},child:[{type:"Image",props:{x:281,skin:"myres/scoreboard/r_chuxin.png",name:"chuxin"}},{type:"Image",props:{x:281,skin:"myres/scoreboard/r_huntian.png",name:"huntain"}},{type:"Image",props:{x:281,skin:"myres/scoreboard/r_quehao.png",name:"quehao"}},{type:"Image",props:{x:281,skin:"myres/scoreboard/r_quejie.png",name:"quejie"}},{type:"Image",props:{x:281,skin:"myres/scoreboard/r_quesheng.png",name:"quesheng"}},{type:"Image",props:{x:281,skin:"myres/scoreboard/r_queshi.png",name:"queshi"}}]},{type:"Image",props:{y:-13,x:-31,width:1442,skin:"myres/scoreboard/board.png",name:"bg",height:558}},{type:"Image",props:{y:207,x:149,skin:"myres/scoreboard/1.png",scaleY:1.2,scaleX:1.2,name:"1"},child:[{type:"Image",props:{y:0,x:125,skin:"myres/scoreboard/2.png",name:"2"}},{type:"Image",props:{y:0,x:249,skin:"myres/scoreboard/3.png",name:"3"}},{type:"Image",props:{y:0,x:375,skin:"myres/scoreboard/4.png",name:"4"}},{type:"Image",props:{x:500,skin:"myres/scoreboard/5.png",name:"5"}},{type:"Image",props:{y:0,x:625,skin:"myres/scoreboard/6.png",name:"6"}},{type:"Image",props:{x:750,skin:"myres/scoreboard/7.png",name:"7"}},{type:"Image",props:{x:875,skin:"myres/scoreboard/9.png",name:"9"}},{type:"Image",props:{x:850,skin:"myres/scoreboard/9.png",name:"9"}},{type:"Image",props:{x:897,skin:"myres/scoreboard/9.png",name:"9"}}]},{type:"Label",props:{y:268,x:97,width:173,text:"+999.9",height:52,fontSize:50,font:"haolong",color:"#3cda63"}},{type:"Label",props:{y:268,x:258,width:173,text:"+99.9",name:"2",height:52,fontSize:50,font:"haolong",color:"#ea2e31"}},{type:"Label",props:{y:268,x:410,width:173,text:"+99.9",name:"3",height:52,fontSize:50,font:"haolong",color:"#ea2e31"}},{type:"Label",props:{y:268,x:558,width:173,text:"+99.9",name:"4",height:52,fontSize:50,font:"haolong",color:"#ea2e31"}},{type:"Label",props:{y:268,x:711,width:173,text:"+99.9",name:"5",height:52,fontSize:50,font:"haolong",color:"#ea2e31"}},{type:"Label",props:{y:268,x:860,width:173,text:"+99.9",name:"6",height:52,fontSize:50,font:"haolong",color:"#ea2e31"}},{type:"Label",props:{y:268,x:1009,width:173,text:"+99.9",name:"7",height:52,fontSize:50,font:"haolong",color:"#ea2e31"}},{type:"Label",props:{y:268,x:1160,width:173,text:"+99.9",name:"8",height:52,fontSize:50,font:"haolong",color:"#ea2e31"}},{type:"Label",props:{y:359,x:70,text:"·连续8局净胜分达到+50即可获得",fontSize:35,font:"SimHei",color:"#c0bdbd"},child:[{type:"Label",props:{y:0,x:574,text:"X999999",fontSize:35,font:"SimHei",color:"#c0bdbd"}},{type:"Image",props:{y:-5,x:529,width:43,skin:"myres/gold0.png",height:43}}]},{type:"Image",props:{y:297,x:622,width:320,skin:"myres/finished.png",height:246}},{type:"Label",props:{y:413,x:70,text:"·每周一次",fontSize:35,font:"SimHei",color:"#c0bdbd"}},{type:"Image",props:{y:409,x:833,width:175,skin:"myres/scoreboard/netscore.png",height:38}},{type:"Label",props:{y:403,x:1076,width:173,text:"+999.9",height:52,fontSize:50,font:"haolong",color:"#3cda63"}},{type:"Image",props:{y:407,x:1220,width:76,skin:"myres/scoreboard/50.png",height:41}},{type:"Image",props:{y:8,x:1388,width:61,skin:"myres/scoreboard/btn_close.png",name:"close",height:153}}]}]},i}(View);t.scoreboardUI=i}(e.mj||(e.mj={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.CButton",capsui.CButton),t.prototype.createChildren.call(this),this.createView(e.mj.scorechangeUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Image",props:{width:1920,skin:"myres/bbg.png",name:"black_mask",height:1080,alpha:.5,sizeGrid:"1,1,1,1"}},{type:"Image",props:{y:682,x:725,width:491,skin:"myres/mjdesktop/scorechange_bg.png",name:"player_0",height:213},child:[{type:"Label",props:{y:14,x:7,width:324,text:"啦啦啦啦啦啦啦啦",name:"label_name",height:36,fontSize:35,font:"SimHei",color:"#f8f4f4",align:"center"}},{type:"Label",props:{y:66,x:64,width:308,text:"+12000",scaleY:.8,scaleX:.8,name:"label_delta",height:49,fontSize:35,font:"haolong",color:"#d61111",align:"right"}},{type:"Image",props:{y:-57,x:306,skin:"myres/bg_head1.png",scaleY:.86,scaleX:.86,name:"head"},child:[{type:"Image",props:{y:35,x:22,width:154,skin:"extendRes/charactor/yiji/smallhead.png",height:154},child:[{type:"Image",props:{}}]}]},{type:"Image",props:{y:147,x:127,skin:"myres/mjdesktop/bg_point.png",scaleY:1.2,scaleX:1.2,name:"rank",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:-35,x:14,skin:"myres/mjdesktop/s_1.png",name:"val"}},{type:"Image",props:{y:4,x:61,skin:"myres/mjdesktop/s_1_1.png"}}]},{type:"Sprite",props:{y:142,x:272,width:493,scaleY:.52,scaleX:.52,pivotY:57,pivotX:138,name:"container_score",height:110},child:[{type:"Image",props:{y:0,x:0,skin:"myres/mjdesktop/ww_2.png",name:"6"}},{type:"Image",props:{x:70,skin:"myres/mjdesktop/ww_2.png",name:"5"}},{type:"Image",props:{y:0,x:140,skin:"myres/mjdesktop/ww_2.png",name:"4"}},{type:"Image",props:{y:0,x:210,skin:"myres/mjdesktop/ww_2.png",name:"3"}},{type:"Image",props:{y:0,x:280,skin:"myres/mjdesktop/ww_2.png",name:"2"}},{type:"Image",props:{y:0,x:350,skin:"myres/mjdesktop/ww_2.png",name:"1"}},{type:"Image",props:{y:0,x:420,skin:"myres/mjdesktop/ww_2.png",name:"0"}}]},{type:"Image",props:{y:147,x:127,skin:"myres/mjdesktop/bg_point.png",scaleY:1.2,scaleX:1.2,name:"rank1",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:-35,x:14,skin:"myres/mjdesktop/s_1.png",name:"val"}},{type:"Image",props:{y:4,x:61,skin:"myres/mjdesktop/s_1_1.png"}}]}]},{type:"Image",props:{y:404,x:1194,width:491,skin:"myres/mjdesktop/scorechange_bg.png",name:"player_1",height:213},child:[{type:"Image",props:{y:-54,x:295,skin:"myres/bg_head1.png",scaleY:.86,scaleX:.86,name:"head"},child:[{type:"Image",props:{y:35,x:22,width:154,skin:"extendRes/charactor/yiji/smallhead.png",height:154},child:[{type:"Image",props:{}}]}]},{type:"Label",props:{y:14,x:7,width:324,text:"啦啦啦啦啦啦啦啦",name:"label_name",height:36,fontSize:35,font:"SimHei",color:"#f8f4f4",align:"center"}},{type:"Label",props:{y:68,x:50,width:308,text:"+12000",scaleY:.8,scaleX:.8,name:"label_delta",height:49,fontSize:35,font:"haolong",color:"#64cf42",align:"right"}},{type:"Image",props:{y:147,x:127,skin:"myres/mjdesktop/bg_point.png",scaleY:1.2,scaleX:1.2,name:"rank",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:-35,x:14,skin:"myres/mjdesktop/s_1.png",name:"val"}},{type:"Image",props:{y:4,x:61,skin:"myres/mjdesktop/s_1_1.png"}}]},{type:"Sprite",props:{y:144,x:260,width:493,scaleY:.52,scaleX:.52,pivotY:57,pivotX:138,name:"container_score",height:110},child:[{type:"Image",props:{y:0,x:0,skin:"myres/mjdesktop/ww_2.png",name:"6"}},{type:"Image",props:{x:70,skin:"myres/mjdesktop/ww_2.png",name:"5"}},{type:"Image",props:{y:0,x:140,skin:"myres/mjdesktop/ww_2.png",name:"4"}},{type:"Image",props:{y:0,x:210,skin:"myres/mjdesktop/ww_2.png",name:"3"}},{type:"Image",props:{y:0,x:280,skin:"myres/mjdesktop/ww_2.png",name:"2"}},{type:"Image",props:{y:0,x:350,skin:"myres/mjdesktop/ww_2.png",name:"1"}},{type:"Image",props:{y:0,x:420,skin:"myres/mjdesktop/ww_2.png",name:"0"}}]},{type:"Image",props:{y:147,x:127,skin:"myres/mjdesktop/bg_point.png",scaleY:1.2,scaleX:1.2,name:"rank1",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:-35,x:14,skin:"myres/mjdesktop/s_1.png",name:"val"}},{type:"Image",props:{y:4,x:61,skin:"myres/mjdesktop/s_1_1.png"}}]}]},{type:"Image",props:{y:145,x:726,width:491,skin:"myres/mjdesktop/scorechange_bg.png",name:"player_2",height:213},child:[{type:"Label",props:{y:14,x:7,width:324,text:"啦啦啦啦啦啦啦啦",name:"label_name",height:36,fontSize:35,font:"SimHei",color:"#f8f4f4",align:"center"}},{type:"Label",props:{y:68,x:55,width:308,text:"+12000",scaleY:.8,scaleX:.8,name:"label_delta",height:49,fontSize:35,font:"haolong",color:"#64cf42",align:"right"}},{type:"Image",props:{y:-57,x:299,skin:"myres/bg_head1.png",scaleY:.86,scaleX:.86,name:"head"},child:[{type:"Image",props:{y:35,x:22,width:154,skin:"extendRes/charactor/yiji/smallhead.png",height:154},child:[{type:"Image",props:{}}]}]},{type:"Image",props:{y:147,x:127,skin:"myres/mjdesktop/bg_point.png",scaleY:1.2,scaleX:1.2,name:"rank",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:-35,x:14,skin:"myres/mjdesktop/s_1.png",name:"val"}},{type:"Image",props:{y:4,x:61,skin:"myres/mjdesktop/s_1_1.png"}}]},{type:"Sprite",props:{y:142,x:268,width:493,scaleY:.52,scaleX:.52,pivotY:57,pivotX:138,name:"container_score",height:110},child:[{type:"Image",props:{y:0,x:0,skin:"myres/mjdesktop/ww_2.png",name:"6"}},{type:"Image",props:{x:70,skin:"myres/mjdesktop/ww_2.png",name:"5"}},{type:"Image",props:{y:0,x:140,skin:"myres/mjdesktop/ww_2.png",name:"4"}},{type:"Image",props:{y:0,x:210,skin:"myres/mjdesktop/ww_2.png",name:"3"}},{type:"Image",props:{y:0,x:280,skin:"myres/mjdesktop/ww_2.png",name:"2"}},{type:"Image",props:{y:0,x:350,skin:"myres/mjdesktop/ww_2.png",name:"1"}},{type:"Image",props:{y:0,x:420,skin:"myres/mjdesktop/ww_2.png",name:"0"}}]},{type:"Image",props:{y:147,x:127,skin:"myres/mjdesktop/bg_point.png",scaleY:1.2,scaleX:1.2,name:"rank1",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:-35,x:14,skin:"myres/mjdesktop/s_1.png",name:"val"}},{type:"Image",props:{y:4,x:61,skin:"myres/mjdesktop/s_1_1.png"}}]}]},{type:"Image",props:{y:404,x:284,width:491,skin:"myres/mjdesktop/scorechange_bg.png",name:"player_3",height:213},child:[{type:"Label",props:{y:14,x:7,width:324,text:"啦啦啦啦啦啦啦啦",name:"label_name",height:36,fontSize:35,font:"SimHei",color:"#f8f4f4",align:"center"}},{type:"Label",props:{y:68,x:52,width:308,text:"+12000",scaleY:.8,scaleX:.8,name:"label_delta",height:49,fontSize:35,font:"haolong",color:"#64cf42",align:"right"}},{type:"Image",props:{y:-55,x:296,skin:"myres/bg_head1.png",scaleY:.86,scaleX:.86,name:"head"},child:[{type:"Image",props:{y:35,x:22,width:154,skin:"extendRes/charactor/yiji/smallhead.png",height:154},child:[{type:"Image",props:{}}]}]},{type:"Image",props:{y:147,x:127,skin:"myres/mjdesktop/bg_point.png",scaleY:1.2,scaleX:1.2,name:"rank",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:-35,x:14,skin:"myres/mjdesktop/s_1.png",name:"val"}},{type:"Image",props:{y:4,x:61,skin:"myres/mjdesktop/s_1_1.png"}}]},{type:"Sprite",props:{y:145,x:266,width:493,scaleY:.52,scaleX:.52,pivotY:57,pivotX:138,name:"container_score",height:110},child:[{type:"Image",props:{y:0,x:0,skin:"myres/mjdesktop/ww_2.png",name:"6"}},{type:"Image",props:{x:70,skin:"myres/mjdesktop/ww_2.png",name:"5"}},{type:"Image",props:{y:0,x:140,skin:"myres/mjdesktop/ww_2.png",name:"4"}},{type:"Image",props:{y:0,x:210,skin:"myres/mjdesktop/ww_2.png",name:"3"}},{type:"Image",props:{y:0,x:280,skin:"myres/mjdesktop/ww_2.png",name:"2"}},{type:"Image",props:{y:0,x:350,skin:"myres/mjdesktop/ww_2.png",name:"1"}},{type:"Image",props:{y:0,x:420,skin:"myres/mjdesktop/ww_2.png",name:"0"}}]},{type:"Image",props:{y:147,x:127,skin:"myres/mjdesktop/bg_point.png",scaleY:1.2,scaleX:1.2,name:"rank1",anchorY:.5,anchorX:.5},child:[{type:"Image",props:{y:-35,x:14,skin:"myres/mjdesktop/s_1.png",name:"val"}},{type:"Image",props:{y:4,x:61,skin:"myres/mjdesktop/s_1_1.png"}}]}]},{type:"Sprite",props:{y:72,x:163,width:1650,name:"container_arrow",height:942},child:[{type:"Image",props:{y:448,x:808,width:90,skin:"myres/mjdesktop/scorechangearrow_0.png",name:"02",height:343,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:450,x:807,width:90,skin:"myres/mjdesktop/scorechangearrow_0.png",rotation:180,name:"20",height:343,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:438,x:805,width:90,skin:"myres/mjdesktop/scorechangearrow_0.png",rotation:90,name:"31",height:343,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:438,x:805,width:90,skin:"myres/mjdesktop/scorechangearrow_0.png",rotation:270,name:"13",height:343,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:634,x:1173,width:241,skin:"myres/mjdesktop/scorechangearrow_1.png",rotation:180,name:"10",height:189,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:254,x:441,width:241,skin:"myres/mjdesktop/scorechangearrow_1.png",rotation:0,name:"32",height:189,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:246,x:444,width:241,skin:"myres/mjdesktop/scorechangearrow_1.png",scaleX:-1,rotation:290,name:"23",height:189,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:252,x:1182,width:241,skin:"myres/mjdesktop/scorechangearrow_1.png",scaleY:-1,scaleX:-1,rotation:252,name:"21",height:189,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:250,x:1180,width:241,skin:"myres/mjdesktop/scorechangearrow_1.png",scaleX:-1,rotation:0,name:"12",height:189,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:628,x:1181,width:241,skin:"myres/mjdesktop/scorechangearrow_1.png",scaleX:-1,rotation:108,name:"01",height:189,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:634,x:429,width:241,skin:"myres/mjdesktop/scorechangearrow_1.png",scaleX:-1,rotation:180,name:"30",height:189,anchorY:.5,anchorX:.5}},{type:"Image",props:{y:634,x:434,width:241,skin:"myres/mjdesktop/scorechangearrow_1.png",rotation:247,name:"03",height:189,anchorY:.5,anchorX:.5}}]},{type:"Button",props:{y:993,x:1741,width:245,stateNum:1,skin:"myres/btn_small.png",name:"btn_confirm",height:90,anchorY:.5,anchorX:.5,sizeGrid:"30,30,30,30"},child:[{type:"Label",props:{y:22,x:18,width:75,text:"(3)",name:"countdown",height:50,fontSize:50,font:"SimHei",color:"#ffffff",align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Label",props:{y:12,x:64,width:145,valign:"middle",text:"确定",scaleY:1.2,scaleX:1.2,name:"confirm",height:55,fontSize:52,font:"fengyu",color:"#e8af71",align:"center"}}]},{type:"Label",props:{y:973,x:1512,width:350,text:"等待其他玩家确认...",strokeColor:"#000000",stroke:2,name:"waitingother",height:50,fontSize:35,font:"SimHei",color:"#ffffff",align:"right"}}]},i}(View);t.scorechangeUI=i}(e.mj||(e.mj={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.createView(e.mj.task_progressUI.uiView)},i.uiView={type:"View",props:{width:1920,height:1080},child:[{type:"Sprite",props:{y:164,x:55,width:1810,name:"root",height:727},child:[{type:"Sprite",props:{y:50,x:173,width:1433,name:"task0",height:212},child:[{type:"Image",props:{y:0,x:0,width:1438,skin:"myres/title_get_bg.png",name:"bg",height:209}},{type:"Image",props:{y:27,x:343,width:149,skin:"extendRes/items/coin0.jpg",name:"item",height:150}},{type:"Image",props:{y:27,x:343,width:149,skin:"myres/kuangbound.png",height:150,sizeGrid:"18,20,12,12"}},{type:"Label",props:{y:94,x:518,text:"铜钱",name:"item_name",fontSize:32,font:"SimHei",color:"#e7b879"}},{type:"Label",props:{y:35,x:516,width:638,text:"在一般场进行2次对局",name:"requirement",height:30,fontSize:30,font:"SimHei",color:"#bcc9e7"}},{type:"Label",props:{y:94,x:593,width:113,text:"120",name:"item_count",height:35,fontSize:35,font:"SimHei",color:"#e7b879",align:"right"}},{type:"Label",props:{y:97,x:714,text:"枚",fontSize:28,font:"SimHei",color:"#e7b879"}},{type:"Image",props:{y:145,x:519,width:277,skin:"myres/progress_bg.png",name:"bar",height:26},child:[{type:"Image",props:{y:0,x:0,width:277,skin:"myres/progress.png",scaleX:.5,name:"val",height:26}}]},{type:"Label",props:{y:143,x:807,text:"0/2",name:"progress",fontSize:28,font:"SimHei",color:"#bcc9e7"}},{type:"Image",props:{y:78,x:501,width:756,skin:"myres/line.png",name:"line",height:4}},{type:"Image",props:{y:100,x:1069,width:182,skin:"myres/finished.png",name:"finished",height:131,anchorY:.5,anchorX:.5}}]},{type:"Sprite",props:{y:270,x:173,width:1433,name:"task1",height:212},child:[{type:"Image",props:{y:0,x:0,width:1438,skin:"myres/title_get_bg.png",name:"bg",height:209}},{type:"Image",props:{y:27,x:343,width:149,skin:"extendRes/items/coin0.jpg",name:"item",height:150}},{type:"Image",props:{y:27,x:343,width:149,skin:"myres/kuangbound.png",height:150,sizeGrid:"18,20,12,12"}},{type:"Label",props:{y:94,x:518,text:"铜钱",name:"item_name",fontSize:32,font:"SimHei",color:"#e7b879"}},{type:"Label",props:{y:35,x:516,width:638,text:"在一般场进行2次对局",name:"requirement",height:30,fontSize:30,font:"SimHei",color:"#bcc9e7"}},{type:"Label",props:{y:94,x:593,width:113,text:"120",name:"item_count",height:35,fontSize:35,font:"SimHei",color:"#e7b879",align:"right"}},{type:"Label",props:{y:97,x:714,text:"枚",fontSize:28,font:"SimHei",color:"#e7b879"}},{type:"Image",props:{y:145,x:519,width:277,skin:"myres/progress_bg.png",name:"bar",height:26},child:[{type:"Image",props:{y:0,x:0,width:277,skin:"myres/progress.png",scaleX:.5,name:"val",height:26}}]},{type:"Label",props:{y:143,x:807,text:"0/2",name:"progress",fontSize:28,font:"SimHei",color:"#bcc9e7"}},{type:"Image",props:{y:78,x:501,width:756,skin:"myres/line.png",name:"line",height:4}},{type:"Image",props:{y:100,x:1069,width:182,skin:"myres/finished.png",name:"finished",height:131,anchorY:.5,anchorX:.5}}]},{type:"Sprite",props:{y:490,x:173,width:1433,name:"task2",height:212},child:[{type:"Image",props:{y:0,x:0,width:1438,skin:"myres/title_get_bg.png",name:"bg",height:209}},{type:"Image",props:{y:27,x:343,width:149,skin:"extendRes/items/coin0.jpg",name:"item",height:150}},{type:"Image",props:{y:27,x:343,width:149,skin:"myres/kuangbound.png",height:150,sizeGrid:"18,20,12,12"}},{type:"Label",props:{y:94,x:518,text:"铜钱",name:"item_name",fontSize:32,font:"SimHei",color:"#e7b879"}},{type:"Label",props:{y:35,x:516,width:638,text:"在一般场进行2次对局",name:"requirement",height:30,fontSize:30,font:"SimHei",color:"#bcc9e7"}},{type:"Label",props:{y:94,x:593,width:113,text:"120",name:"item_count",height:35,fontSize:35,font:"SimHei",color:"#e7b879",align:"right"}},{type:"Label",props:{y:97,x:714,text:"枚",fontSize:28,font:"SimHei",color:"#e7b879"}},{type:"Image",props:{y:145,x:519,width:277,skin:"myres/progress_bg.png",name:"bar",height:26},child:[{type:"Image",props:{y:0,x:0,width:277,skin:"myres/progress.png",scaleX:.5,name:"val",height:26}}]},{type:"Label",props:{y:143,x:807,text:"0/2",name:"progress",fontSize:28,font:"SimHei",color:"#bcc9e7"}},{type:"Image",props:{y:78,x:501,width:756,skin:"myres/line.png",name:"line",height:4}},{type:"Image",props:{y:100,x:1069,width:182,skin:"myres/finished.png",name:"finished",height:131,anchorY:.5,anchorX:.5}}]}]},{type:"Button",props:{y:0,x:0,width:1920,name:"btn_close",height:1080}}]},i}(View);t.task_progressUI=i}(e.mj||(e.mj={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.createView(e.mj.tingpaiUI.uiView)},i.uiView={type:"View",props:{width:1920,mouseThrough:!0,height:1080},child:[{type:"Sprite",props:{y:640,x:493,width:724,name:"root",height:253},child:[{type:"Image",props:{y:0,x:0,width:460,skin:"myres/pop_bg.png",name:"bg0",height:240,sizeGrid:"100,100,100,100"},child:[{type:"Image",props:{y:0,x:0,width:460,skin:"myres/pop_bg.png",renderType:"mask",name:"mk",height:240,sizeGrid:"100,100,100,100"}},{type:"Image",props:{y:-96,x:20,skin:"myres/pop_texture.png",name:"left"}},{type:"Image",props:{y:-102,x:440,skin:"myres/pop_texture.png",scaleX:-1,name:"right"}},{type:"Image",props:{y:43,x:-44,width:764,skin:"myres/pop_black.png",name:"bar",height:120}}]},{type:"Image",props:{y:0,x:0,width:460,skin:"myres/pop_bound.png",name:"bound",height:240,sizeGrid:"131,102,97,106"}},{type:"Sprite",props:{y:-3,x:24,width:597,name:"container_tiles",height:210},child:[{type:"Image",props:{y:45,x:79,width:80,skin:"myres/8p.png",height:120},child:[{type:"Image",props:{y:130,x:0,width:82,skin:"myres/mjdesktop/bg_3.png",name:"container_left",height:30},child:[{type:"Label",props:{y:1,x:-30,width:140,text:"2张",height:28,fontSize:27,font:"SimHei",color:"#ffffff",align:"center"}}]},{type:"Image",props:{y:-35,x:-1,width:82,skin:"myres/mjdesktop/bg_4.png",name:"flag_zhenting",height:30},child:[{type:"Label",props:{y:-1,x:1,width:122,valign:"middle",text:"振听",scaleY:.65,scaleX:.7,height:47,fontSize:27,font:"fengyu",color:"#ffffff",align:"center"}}]},{type:"Image",props:{y:127,x:4,width:70,visible:!1,skin:"myres/mjdesktop/nofan.png",name:"noyi",height:34}}]},{type:"Image",props:{y:55,x:89,width:80,skin:"myres/8p.png",height:120},child:[{type:"Image",props:{y:130,x:0,width:82,skin:"myres/mjdesktop/bg_3.png",name:"container_left",height:30},child:[{type:"Label",props:{y:1,x:-30,width:140,text:"2张",height:28,fontSize:27,font:"SimHei",color:"#ffffff",align:"center"}}]},{type:"Image",props:{y:-35,x:-1,width:82,skin:"myres/mjdesktop/bg_4.png",name:"flag_zhenting",height:30},child:[{type:"Label",props:{y:-1,x:1,width:122,valign:"middle",text:"振听",scaleY:.65,scaleX:.7,height:47,fontSize:27,font:"fengyu",color:"#ffffff",align:"center"}}]},{type:"Image",props:{y:127,x:4,width:70,visible:!1,skin:"myres/mjdesktop/nofan.png",name:"noyi",height:34}}]},{type:"Image",props:{y:65,x:99,width:80,skin:"myres/8p.png",height:120},child:[{type:"Image",props:{y:130,x:0,width:82,skin:"myres/mjdesktop/bg_3.png",name:"container_left",height:30},child:[{type:"Label",props:{y:1,x:-30,width:140,text:"2张",height:28,fontSize:27,font:"SimHei",color:"#ffffff",align:"center"}}]},{type:"Image",props:{y:-35,x:-1,width:82,skin:"myres/mjdesktop/bg_4.png",name:"flag_zhenting",height:30},child:[{type:"Label",props:{y:-1,x:1,width:122,valign:"middle",text:"振听",scaleY:.65,scaleX:.7,height:47,fontSize:27,font:"fengyu",color:"#ffffff",align:"center"}}]},{type:"Image",props:{y:127,x:4,width:70,visible:!1,skin:"myres/mjdesktop/nofan.png",name:"noyi",height:34}}]},{type:"Image",props:{y:75,x:109,width:80,skin:"myres/8p.png",height:120},child:[{type:"Image",props:{y:130,x:0,width:82,skin:"myres/mjdesktop/bg_3.png",name:"container_left",height:30},child:[{type:"Label",props:{y:1,x:-30,width:140,text:"2张",height:28,fontSize:27,font:"SimHei",color:"#ffffff",align:"center"}}]},{type:"Image",props:{y:-35,x:-1,width:82,skin:"myres/mjdesktop/bg_4.png",name:"flag_zhenting",height:30},child:[{type:"Label",props:{y:-1,x:1,width:122,valign:"middle",text:"振听",scaleY:.65,scaleX:.7,height:47,fontSize:27,font:"fengyu",color:"#ffffff",align:"center"}}]},{type:"Image",props:{y:127,x:4,width:70,visible:!1,skin:"myres/mjdesktop/nofan.png",name:"noyi",height:34}}]},{type:"Image",props:{y:85,x:119,width:80,skin:"myres/8p.png",height:120},child:[{type:"Image",props:{y:130,x:0,width:82,skin:"myres/mjdesktop/bg_3.png",name:"container_left",height:30},child:[{type:"Label",props:{y:1,x:-30,width:140,text:"2张",height:28,fontSize:27,font:"SimHei",color:"#ffffff",align:"center"}}]},{type:"Image",props:{y:-35,x:-1,width:82,skin:"myres/mjdesktop/bg_4.png",name:"flag_zhenting",height:30},child:[{type:"Label",props:{y:-1,x:1,width:122,valign:"middle",text:"振听",scaleY:.65,scaleX:.7,height:47,fontSize:27,font:"fengyu",color:"#ffffff",align:"center"}}]},{type:"Image",props:{y:127,x:4,width:70,visible:!1,skin:"myres/mjdesktop/nofan.png",name:"noyi",height:34}}]},{type:"Image",props:{y:95,x:129,width:80,skin:"myres/8p.png",height:120},child:[{type:"Image",props:{y:130,x:0,width:82,skin:"myres/mjdesktop/bg_3.png",name:"container_left",height:30},child:[{type:"Label",props:{y:1,x:-30,width:140,text:"2张",height:28,fontSize:27,font:"SimHei",color:"#ffffff",align:"center"}}]},{type:"Image",props:{y:-35,x:-1,width:82,skin:"myres/mjdesktop/bg_4.png",name:"flag_zhenting",height:30},child:[{type:"Label",props:{y:-1,x:1,width:122,valign:"middle",text:"振听",scaleY:.65,scaleX:.7,height:47,fontSize:27,font:"fengyu",color:"#ffffff",align:"center"}}]},{type:"Image",props:{y:127,x:4,width:70,visible:!1,skin:"myres/mjdesktop/nofan.png",name:"noyi",height:34}}]},{type:"Image",props:{y:105,x:139,width:80,skin:"myres/8p.png",height:120},child:[{type:"Image",props:{y:130,x:0,width:82,skin:"myres/mjdesktop/bg_3.png",name:"container_left",height:30},child:[{type:"Label",props:{y:1,x:-30,width:140,text:"2张",height:28,fontSize:27,font:"SimHei",color:"#ffffff",align:"center"}}]},{type:"Image",props:{y:-35,x:-1,width:82,skin:"myres/mjdesktop/bg_4.png",name:"flag_zhenting",height:30},child:[{type:"Label",props:{y:-1,x:1,width:122,valign:"middle",text:"振听",scaleY:.65,scaleX:.7,height:47,fontSize:27,font:"fengyu",color:"#ffffff",align:"center"}}]},{type:"Image",props:{y:127,x:4,width:70,visible:!1,skin:"myres/mjdesktop/nofan.png",name:"noyi",height:34}}]},{type:"Image",props:{y:115,x:149,width:80,skin:"myres/8p.png",height:120},child:[{type:"Image",props:{y:130,x:0,width:82,skin:"myres/mjdesktop/bg_3.png",name:"container_left",height:30},child:[{type:"Label",props:{y:1,x:-30,width:140,text:"2张",height:28,fontSize:27,font:"SimHei",color:"#ffffff",align:"center"}}]},{type:"Image",props:{y:-35,x:-1,width:82,skin:"myres/mjdesktop/bg_4.png",name:"flag_zhenting",height:30},child:[{type:"Label",props:{y:-1,x:1,width:122,valign:"middle",text:"振听",scaleY:.65,scaleX:.7,height:47,fontSize:27,font:"fengyu",color:"#ffffff",align:"center"}}]},{type:"Image",props:{y:127,x:4,width:70,visible:!1,skin:"myres/mjdesktop/nofan.png",name:"noyi",height:34}}]},{type:"Image",props:{y:125,x:159,width:80,skin:"myres/8p.png",height:120},child:[{type:"Image",props:{y:130,x:0,width:82,skin:"myres/mjdesktop/bg_3.png",name:"container_left",height:30},child:[{type:"Label",props:{y:1,x:-30,width:140,text:"2张",height:28,fontSize:27,font:"SimHei",color:"#ffffff",align:"center"}}]},{type:"Image",props:{y:-35,x:-1,width:82,skin:"myres/mjdesktop/bg_4.png",name:"flag_zhenting",height:30},child:[{type:"Label",props:{y:-1,x:1,width:122,valign:"middle",text:"振听",scaleY:.65,scaleX:.7,height:47,fontSize:27,font:"fengyu",color:"#ffffff",align:"center"}}]},{type:"Image",props:{y:127,x:4,width:70,visible:!1,skin:"myres/mjdesktop/nofan.png",name:"noyi",height:34}}]},{type:"Image",props:{y:135,x:169,width:80,skin:"myres/8p.png",height:120},child:[{type:"Image",props:{y:130,x:0,width:82,skin:"myres/mjdesktop/bg_3.png",name:"container_left",height:30},child:[{type:"Label",props:{y:1,x:-30,width:140,text:"2张",height:28,fontSize:27,font:"SimHei",color:"#ffffff",align:"center"}}]},{type:"Image",props:{y:-35,x:-1,width:82,skin:"myres/mjdesktop/bg_4.png",name:"flag_zhenting",height:30},child:[{type:"Label",props:{y:-1,x:1,width:122,valign:"middle",text:"振听",scaleY:.65,scaleX:.7,height:47,fontSize:27,font:"fengyu",color:"#ffffff",align:"center"}}]},{type:"Image",props:{y:127,x:4,width:70,visible:!1,skin:"myres/mjdesktop/nofan.png",name:"noyi",height:34}}]},{type:"Image",props:{y:145,x:179,width:80,skin:"myres/8p.png",height:120},child:[{type:"Image",props:{y:130,x:0,width:82,skin:"myres/mjdesktop/bg_3.png",name:"container_left",height:30},child:[{type:"Label",props:{y:1,x:-30,width:140,text:"2张",height:28,fontSize:27,font:"SimHei",color:"#ffffff",align:"center"}}]},{type:"Image",props:{y:-35,x:-1,width:82,skin:"myres/mjdesktop/bg_4.png",name:"flag_zhenting",height:30},child:[{type:"Label",props:{y:-1,x:1,width:122,valign:"middle",text:"振听",scaleY:.65,scaleX:.7,height:47,fontSize:27,font:"fengyu",color:"#ffffff",align:"center"}}]},{type:"Image",props:{y:127,x:4,width:70,visible:!1,skin:"myres/mjdesktop/nofan.png",name:"noyi",height:34}}]},{type:"Image",props:{y:155,x:189,width:80,skin:"myres/8p.png",height:120},child:[{type:"Image",props:{y:130,x:0,width:82,skin:"myres/mjdesktop/bg_3.png",name:"container_left",height:30},child:[{type:"Label",props:{y:1,x:-30,width:140,text:"2张",height:28,fontSize:27,font:"SimHei",color:"#ffffff",align:"center"}}]},{type:"Image",props:{y:-35,x:-1,width:82,skin:"myres/mjdesktop/bg_4.png",name:"flag_zhenting",height:30},child:[{type:"Label",props:{y:-1,x:1,width:122,valign:"middle",text:"振听",scaleY:.65,scaleX:.7,height:47,fontSize:27,font:"fengyu",color:"#ffffff",align:"center"}}]},{type:"Image",props:{y:127,x:4,width:70,visible:!1,skin:"myres/mjdesktop/nofan.png",name:"noyi",height:34}}]},{type:"Image",props:{y:165,x:199,width:80,skin:"myres/8p.png",height:120},child:[{type:"Image",props:{y:130,x:0,width:82,skin:"myres/mjdesktop/bg_3.png",name:"container_left",height:30},child:[{type:"Label",props:{y:1,x:-30,width:140,text:"2张",height:28,fontSize:27,font:"SimHei",color:"#ffffff",align:"center"}}]},{type:"Image",props:{y:-35,x:-1,width:82,skin:"myres/mjdesktop/bg_4.png",name:"flag_zhenting",height:30},child:[{type:"Label",props:{y:-1,x:1,width:122,valign:"middle",text:"振听",scaleY:.65,scaleX:.7,height:47,fontSize:27,font:"fengyu",color:"#ffffff",align:"center"}}]},{type:"Image",props:{y:127,x:4,width:70,visible:!1,skin:"myres/mjdesktop/nofan.png",name:"noyi",height:34}}]},{type:"Image",props:{y:175,x:209,width:80,skin:"myres/8p.png",height:120},child:[{type:"Image",props:{y:130,x:0,width:82,skin:"myres/mjdesktop/bg_3.png",name:"container_left",height:30},child:[{type:"Label",props:{y:1,x:-30,width:140,text:"2张",height:28,fontSize:27,font:"SimHei",color:"#ffffff",align:"center"}}]},{type:"Image",props:{y:-35,x:-1,width:82,skin:"myres/mjdesktop/bg_4.png",name:"flag_zhenting",height:30},child:[{type:"Label",props:{y:-1,x:1,width:122,valign:"middle",text:"振听",scaleY:.65,scaleX:.7,height:47,fontSize:27,font:"fengyu",color:"#ffffff",align:"center"}}]},{type:"Image",props:{y:127,x:4,width:70,visible:!1,skin:"myres/mjdesktop/nofan.png",name:"noyi",height:34}}]}]}]},{type:"Button",props:{y:912,x:1875,width:80,name:"btn_show",height:80,anchorY:.5,anchorX:.5},child:[{type:"Image",props:{skin:"myres/mjdesktop/hint.png"}}]}]},i}(View);t.tingpaiUI=i}(e.mj||(e.mj={}))}(ui||(ui={})),function(e){!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.createChildren=function(){View.regComponent("capsui.CButton",capsui.CButton),t.prototype.createChildren.call(this),this.createView(e.mj.winUI.uiView)},i.uiView={type:"View",props:{name:"fan"},child:[{type:"Image",props:{y:-361,x:-901,width:3780,skin:"myres/bbg.png",height:1870,alpha:.8,sizeGrid:"1,1,1,1"}},{type:"Sprite",props:{y:0,x:0,width:1925,name:"root",height:1084},child:[{type:"Image",props:{y:-2,x:0,width:1920,skin:"myres/mjdesktop/bg_jiesuan.png",name:"bg",height:1080}},{type:"Image",props:{y:59,x:-49,width:963,skin:"extendRes/charactor/yiji/full.png",name:"xiaojiejie",height:1450},child:[{type:"Image",props:{}}]},{type:"Sprite",props:{y:305,x:622,width:1623,scaleY:1,scaleX:.72,rotation:-6,pivotY:133,name:"container_hand",height:133},child:[{type:"Image",props:{y:0,x:0,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:80,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:160,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:240,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:320,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:400,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:480,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:560,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:640,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:720,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:800,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:880,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:960,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:1040,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:1120,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:1200,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:1280,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:1360,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:1440,width:80,skin:"myres/8p.png",height:120}},{type:"Image",props:{y:0,x:1520,width:80,skin:"myres/8p.png",height:120}}]},{type:"Sprite",props:{y:292,x:990,scaleY:.7,scaleX:.7,rotation:-6,name:"container_dora"},child:[{type:"Image",props:{y:11,x:-172,width:215,skin:"myres/mjdesktop/bg_dora.png",rotation:6,height:115}},{type:"Image",props:{y:0,x:0,width:80,skin:"myres/8p.png",name:"img0",height:120}},{type:"Image",props:{y:0,x:80,width:80,skin:"myres/8p.png",name:"img1",height:120}},{type:"Image",props:{y:0,x:160,width:80,skin:"myres/8p.png",name:"img2",height:120}},{type:"Image",props:{y:0,x:240,width:80,skin:"myres/8p.png",name:"img3",height:120}},{type:"Image",props:{y:0,x:320,width:80,skin:"myres/8p.png",name:"img4",height:120}}]},{type:"Sprite",props:{y:239,x:1499,scaleY:.7,scaleX:.7,rotation:-6,name:"container_lidora"},child:[{type:"Image",props:{y:8,x:-176,width:215,skin:"myres/mjdesktop/bg_lidora.png",rotation:8,height:115}},{type:"Image",props:{y:0,x:0,width:80,skin:"myres/8p.png",name:"img0",height:120}},{type:"Image",props:{y:0,x:80,width:80,skin:"myres/8p.png",name:"img1",height:120}},{type:"Image",props:{y:0,x:160,width:80,skin:"myres/8p.png",name:"img2",height:120}},{type:"Image",props:{y:0,x:240,width:80,skin:"myres/8p.png",name:"img3",height:120}},{type:"Image",props:{y:0,x:320,width:80,skin:"myres/8p.png",name:"img4",height:120}}]},{type:"Sprite",props:{y:430,x:903,name:"container_fan_yiman"},child:[{type:"Sprite",props:{y:101,x:-143,width:471,scaleY:1.2,scaleX:1.2,pivotY:-21,pivotX:22,name:0,height:100},child:[{type:"Image",props:{y:-126,x:114,skin:"myres/mjdesktop/bg_yakuman.png",name:"img"}},{type:"Label",props:{y:-80,x:135,width:327,text:"门前清自摸和",skewX:-10,scaleY:.8,scaleX:.8,rotation:-6,name:"l_name",height:44,fontSize:50,font:"youyuan",color:"#f1eeda",align:"center"}}]},{type:"Sprite",props:{y:195,x:-192,width:471,scaleY:1.2,scaleX:1.2,pivotY:-21,pivotX:22,name:1,height:100},child:[{type:"Image",props:{y:-126,x:114,skin:"myres/mjdesktop/bg_yakuman.png",name:"img"}},{type:"Label",props:{y:-80,x:135,width:327,text:"门前清自摸和",skewX:-10,scaleY:.8,scaleX:.8,rotation:-6,name:"l_name",height:44,fontSize:50,font:"youyuan",color:"#f1eeda",align:"center"}}]},{type:"Sprite",props:{y:284,x:-159,width:471,scaleY:1.2,scaleX:1.2,pivotY:-21,pivotX:22,name:2,height:100},child:[{type:"Image",props:{y:-126,x:114,skin:"myres/mjdesktop/bg_yakuman.png",name:"img"}},{type:"Label",props:{y:-80,x:135,width:327,text:"门前清自摸和",skewX:-10,scaleY:.8,scaleX:.8,rotation:-6,name:"l_name",height:44,fontSize:50,font:"youyuan",color:"#f1eeda",align:"center"}}]},{type:"Sprite",props:{y:357,x:-48,width:471,scaleY:1.2,scaleX:1.2,pivotY:-21,pivotX:22,name:3,height:100},child:[{type:"Image",props:{y:-126,x:114,skin:"myres/mjdesktop/bg_yakuman.png",name:"img"}},{type:"Label",props:{y:-80,x:135,width:327,text:"门前清自摸和",skewX:-10,scaleY:.8,scaleX:.8,rotation:-6,name:"l_name",height:44,fontSize:50,font:"youyuan",color:"#f1eeda",align:"center"}}]},{type:"Sprite",props:{y:31,x:393,width:471,scaleY:1.2,scaleX:1.2,pivotY:-21,pivotX:22,name:4,height:100},child:[{type:"Image",props:{y:-126,x:114,skin:"myres/mjdesktop/bg_yakuman.png",name:"img"}},{type:"Label",props:{y:-80,x:135,width:327,text:"门前清自摸和",skewX:-10,scaleY:.8,scaleX:.8,rotation:-6,name:"l_name",height:44,fontSize:50,font:"youyuan",color:"#f1eeda",align:"center"}}]},{type:"Sprite",props:{y:103,x:482,width:471,scaleY:1.2,scaleX:1.2,pivotY:-21,pivotX:22,name:5,height:100},child:[{type:"Image",props:{y:-126,x:114,skin:"myres/mjdesktop/bg_yakuman.png",name:"img"}},{type:"Label",props:{y:-80,x:135,width:327,text:"门前清自摸和",skewX:-10,scaleY:.8,scaleX:.8,rotation:-6,name:"l_name",height:44,fontSize:50,font:"youyuan",color:"#f1eeda",align:"center"}}]},{type:"Sprite",props:{y:192,x:510,width:471,scaleY:1.2,scaleX:1.2,pivotY:-21,pivotX:22,name:6,height:100},child:[{type:"Image",props:{y:-126,x:114,skin:"myres/mjdesktop/bg_yakuman.png",name:"img"}},{type:"Label",props:{y:-80,x:135,width:327,text:"门前清自摸和",skewX:-10,scaleY:.8,scaleX:.8,rotation:-6,name:"l_name",height:44,fontSize:50,font:"youyuan",color:"#f1eeda",align:"center"}}]},{type:"Sprite",props:{y:298,x:403,width:471,scaleY:1.2,scaleX:1.2,pivotY:-21,pivotX:22,name:7,height:100},child:[{type:"Image",props:{y:-126,x:114,skin:"myres/mjdesktop/bg_yakuman.png",name:"img"}},{type:"Label",props:{y:-80,x:135,width:327,text:"门前清自摸和",skewX:-10,scaleY:.8,scaleX:.8,rotation:-6,name:"l_name",height:44,fontSize:50,font:"youyuan",color:"#f1eeda",align:"center"}}]}]},{type:"Sprite",props:{y:430,x:903,name:"container_fan_liuju"},child:[{type:"Sprite",props:{y:101,x:-143,width:471,scaleY:1.2,scaleX:1.2,pivotY:-21,pivotX:22,name:0,height:100},child:[{type:"Image",props:{y:-130,x:157,skin:"myres/mjdesktop/bg_fan1.png",name:"img"}},{type:"Label",props:{y:-80,x:135,width:327,text:"流局满贯",skewX:-10,scaleY:.8,scaleX:.8,rotation:-6,name:"l_name",height:44,fontSize:50,font:"youyuan",color:"#f1eeda",align:"center"}}]}]},{type:"Sprite",props:{y:430,x:903,name:"container_fan_8"},child:[{type:"Sprite",props:{y:101,x:-143,width:471,scaleY:1.2,scaleX:1.2,pivotY:-21,pivotX:22,name:0,height:100},child:[{type:"Image",props:{y:-130,x:157,skin:"myres/mjdesktop/bg_fan.png",name:"img"}},{type:"Label",props:{y:-80,x:135,width:327,text:"门前清自摸和",skewX:-10,scaleY:.8,scaleX:.8,rotation:-6,name:"l_name",height:44,fontSize:50,font:"youyuan",color:"#f1eeda",align:"center"}},{type:"Image",props:{y:-104,x:398,width:21,skin:"myres/mjdesktop/word_fan.png",height:21}},{type:"Image",props:{y:-113,x:378,width:22,skin:"myres/mjdesktop/h_1.png",height:34}},{type:"Image",props:{y:-111,x:361,width:22,skin:"myres/mjdesktop/h_1.png",height:34}}]},{type:"Sprite",props:{y:195,x:-192,width:471,scaleY:1.2,scaleX:1.2,pivotY:-21,pivotX:22,name:1,height:100},child:[{type:"Image",props:{y:-130,x:157,skin:"myres/mjdesktop/bg_fan.png",name:"img"}},{type:"Label",props:{y:-80,x:135,width:327,text:"门前清自摸和",skewX:-10,scaleY:.8,scaleX:.8,rotation:-6,name:"l_name",height:44,fontSize:50,font:"youyuan",color:"#f1eeda",align:"center"}},{type:"Image",props:{y:-104,x:398,width:21,skin:"myres/mjdesktop/word_fan.png",height:21}},{type:"Image",props:{y:-113,x:378,width:22,skin:"myres/mjdesktop/h_1.png",height:34}},{type:"Image",props:{y:-111,x:361,width:22,skin:"myres/mjdesktop/h_1.png",height:34}}]},{type:"Sprite",props:{y:284,x:-159,width:471,scaleY:1.2,scaleX:1.2,pivotY:-21,pivotX:22,name:2,height:100},child:[{type:"Image",props:{y:-130,x:157,skin:"myres/mjdesktop/bg_fan.png",name:"img"}},{type:"Label",props:{y:-80,x:135,width:327,text:"门前清自摸和",skewX:-10,scaleY:.8,scaleX:.8,rotation:-6,name:"l_name",height:44,fontSize:50,font:"youyuan",color:"#f1eeda",align:"center"}},{type:"Image",props:{y:-104,x:398,width:21,skin:"myres/mjdesktop/word_fan.png",height:21}},{type:"Image",props:{y:-113,x:378,width:22,skin:"myres/mjdesktop/h_1.png",height:34}},{type:"Image",props:{y:-111,x:361,width:22,skin:"myres/mjdesktop/h_1.png",height:34}}]},{type:"Sprite",props:{y:357,x:-48,width:471,scaleY:1.2,scaleX:1.2,pivotY:-21,pivotX:22,name:3,height:100},child:[{type:"Image",props:{y:-130,x:157,skin:"myres/mjdesktop/bg_fan.png",name:"img"}},{type:"Label",props:{y:-80,x:135,width:327,text:"门前清自摸和",skewX:-10,scaleY:.8,scaleX:.8,rotation:-6,name:"l_name",height:44,fontSize:50,font:"youyuan",color:"#f1eeda",align:"center"}},{type:"Image",props:{y:-104,x:398,width:21,skin:"myres/mjdesktop/word_fan.png",height:21}},{type:"Image",props:{y:-113,x:378,width:22,skin:"myres/mjdesktop/h_1.png",height:34}},{type:"Image",props:{y:-111,x:361,width:22,skin:"myres/mjdesktop/h_1.png",height:34}}]},{type:"Sprite",props:{y:31,x:393,width:471,scaleY:1.2,scaleX:1.2,pivotY:-21,pivotX:22,name:4,height:100},child:[{type:"Image",props:{y:-130,x:157,skin:"myres/mjdesktop/bg_fan.png",name:"img"}},{type:"Label",props:{y:-80,x:135,width:327,text:"门前清自摸和",skewX:-10,scaleY:.8,scaleX:.8,rotation:-6,name:"l_name",height:44,fontSize:50,font:"youyuan",color:"#f1eeda",align:"center"}},{type:"Image",props:{y:-104,x:398,width:21,skin:"myres/mjdesktop/word_fan.png",height:21}},{type:"Image",props:{y:-113,x:378,width:22,skin:"myres/mjdesktop/h_1.png",height:34}},{type:"Image",props:{y:-111,x:361,width:22,skin:"myres/mjdesktop/h_1.png",height:34}}]},{type:"Sprite",props:{y:103,x:482,width:471,scaleY:1.2,scaleX:1.2,pivotY:-21,pivotX:22,name:5,height:100},child:[{type:"Image",props:{y:-130,x:157,skin:"myres/mjdesktop/bg_fan.png",name:"img"}},{type:"Label",props:{y:-80,x:135,width:327,text:"门前清自摸和",skewX:-10,scaleY:.8,scaleX:.8,rotation:-6,name:"l_name",height:44,fontSize:50,font:"youyuan",color:"#f1eeda",align:"center"}},{type:"Image",props:{y:-104,x:398,width:21,skin:"myres/mjdesktop/word_fan.png",height:21}},{type:"Image",props:{y:-113,x:378,width:22,skin:"myres/mjdesktop/h_1.png",height:34}},{type:"Image",props:{y:-111,x:361,width:22,skin:"myres/mjdesktop/h_1.png",height:34}}]},{type:"Sprite",props:{y:192,x:510,width:471,scaleY:1.2,scaleX:1.2,pivotY:-21,pivotX:22,name:6,height:100},child:[{type:"Image",props:{y:-130,x:157,skin:"myres/mjdesktop/bg_fan.png",name:"img"}},{type:"Label",props:{y:-80,x:135,width:327,text:"门前清自摸和",skewX:-10,scaleY:.8,scaleX:.8,rotation:-6,name:"l_name",height:44,fontSize:50,font:"youyuan",color:"#f1eeda",align:"center"}},{type:"Image",props:{y:-104,x:398,width:21,skin:"myres/mjdesktop/word_fan.png",height:21}},{type:"Image",props:{y:-113,x:378,width:22,skin:"myres/mjdesktop/h_1.png",height:34}},{type:"Image",props:{y:-111,x:361,width:22,skin:"myres/mjdesktop/h_1.png",height:34}}]},{type:"Sprite",props:{y:298,x:403,width:471,scaleY:1.2,scaleX:1.2,pivotY:-21,pivotX:22,name:7,height:100},child:[{type:"Image",props:{y:-130,x:157,skin:"myres/mjdesktop/bg_fan.png",name:"img"}},{type:"Label",props:{y:-80,x:135,width:327,text:"门前清自摸和",skewX:-10,scaleY:.8,scaleX:.8,rotation:-6,name:"l_name",height:44,fontSize:50,font:"youyuan",color:"#f1eeda",align:"center"}},{type:"Image",props:{y:-104,x:398,width:21,skin:"myres/mjdesktop/word_fan.png",height:21}},{type:"Image",props:{y:-113,x:378,width:22,skin:"myres/mjdesktop/h_1.png",height:34}},{type:"Image",props:{y:-111,x:361,width:22,skin:"myres/mjdesktop/h_1.png",height:34}}]}]},{type:"Sprite",props:{y:430,x:903,name:"container_fan_12"},child:[{type:"Sprite",props:{y:53,x:-61,width:402,scaleY:1,scaleX:1,pivotY:-21,pivotX:22,name:0,height:85},child:[{type:"Image",props:{y:-130,x:157,skin:"myres/mjdesktop/bg_fan.png",name:"img"}},{type:"Label",props:{y:-80,x:135,width:327,text:"门前清自摸和",skewX:-10,scaleY:.8,scaleX:.8,rotation:-6,name:"l_name",height:44,fontSize:50,font:"youyuan",color:"#f1eeda",align:"center"}},{type:"Image",props:{y:-104,x:398,width:21,skin:"myres/mjdesktop/word_fan.png",height:21}},{type:"Image",props:{y:-113,x:378,width:22,skin:"myres/mjdesktop/h_1.png",height:34}},{type:"Image",props:{y:-111,x:361,width:22,skin:"myres/mjdesktop/h_1.png",height:34}}]},{type:"Sprite",props:{y:134,x:-110,width:402,scaleY:1,scaleX:1,pivotY:-21,pivotX:22,name:1,height:85},child:[{type:"Image",props:{y:-130,x:157,skin:"myres/mjdesktop/bg_fan.png",name:"img"}},{type:"Label",props:{y:-80,x:135,width:327,text:"门前清自摸和",skewX:-10,scaleY:.8,scaleX:.8,rotation:-6,name:"l_name",height:44,fontSize:50,font:"youyuan",color:"#f1eeda",align:"center"}},{type:"Image",props:{y:-104,x:398,width:21,skin:"myres/mjdesktop/word_fan.png",height:21}},{type:"Image",props:{y:-113,x:378,width:22,skin:"myres/mjdesktop/h_1.png",height:34}},{type:"Image",props:{y:-111,x:361,width:22,skin:"myres/mjdesktop/h_1.png",height:34}}]},{type:"Sprite",props:{y:219,x:-118,width:402,scaleY:1,scaleX:1,pivotY:-21,pivotX:22,name:2,height:85},child:[{type:"Image",props:{y:-130,x:157,skin:"myres/mjdesktop/bg_fan.png",name:"img"}},{type:"Label",props:{y:-80,x:135,width:327,text:"门前清自摸和",skewX:-10,scaleY:.8,scaleX:.8,rotation:-6,name:"l_name",height:44,fontSize:50,font:"youyuan",color:"#f1eeda",align:"center"}},{type:"Image",props:{y:-104,x:398,width:21,skin:"myres/mjdesktop/word_fan.png",height:21}},{type:"Image",props:{y:-113,x:378,width:22,skin:"myres/mjdesktop/h_1.png",height:34}},{type:"Image",props:{y:-111,x:361,width:22,skin:"myres/mjdesktop/h_1.png",height:34}}]},{type:"Sprite",props:{y:287,x:-78,width:402,scaleY:1,scaleX:1,pivotY:-21,pivotX:22,name:3,height:85},child:[{type:"Image",props:{y:-130,x:157,skin:"myres/mjdesktop/bg_fan.png",name:"img"}},{type:"Label",props:{y:-80,x:135,width:327,text:"门前清自摸和",skewX:-10,scaleY:.8,scaleX:.8,rotation:-6,name:"l_name",height:44,fontSize:50,font:"youyuan",color:"#f1eeda",align:"center"}},{type:"Image",props:{y:-104,x:398,width:21,skin:"myres/mjdesktop/word_fan.png",height:21}},{type:"Image",props:{y:-113,x:378,width:22,skin:"myres/mjdesktop/h_1.png",height:34}},{type:"Image",props:{y:-111,x:361,width:22,skin:"myres/mjdesktop/h_1.png",height:34}}]},{type:"Sprite",props:{y:349,x:-23,width:402,scaleY:1,scaleX:1,pivotY:-21,pivotX:22,name:4,height:85},child:[{type:"Image",props:{y:-130,x:157,skin:"myres/mjdesktop/bg_fan.png",name:"img"}},{type:"Label",props:{y:-80,x:135,width:327,text:"门前清自摸和",skewX:-10,scaleY:.8,scaleX:.8,rotation:-6,name:"l_name",height:44,fontSize:50,font:"youyuan",color:"#f1eeda",align:"center"}},{type:"Image",props:{y:-104,x:398,width:21,skin:"myres/mjdesktop/word_fan.png",height:21}},{type:"Image",props:{y:-113,x:378,width:22,skin:"myres/mjdesktop/h_1.png",height:34}},{type:"Image",props:{y:-111,x:361,width:22,skin:"myres/mjdesktop/h_1.png",height:34}}]},{type:"Sprite",props:{y:398,x:80,width:402,scaleY:1,scaleX:1,pivotY:-21,pivotX:22,name:5,height:85},child:[{type:"Image",props:{y:-130,x:157,skin:"myres/mjdesktop/bg_fan.png",name:"img"}},{type:"Label",props:{y:-80,x:135,width:327,text:"门前清自摸和",skewX:-10,scaleY:.8,scaleX:.8,rotation:-6,name:"l_name",height:44,fontSize:50,font:"youyuan",color:"#f1eeda",align:"center"}},{type:"Image",props:{y:-104,x:398,width:21,skin:"myres/mjdesktop/word_fan.png",height:21}},{type:"Image",props:{y:-113,x:378,width:22,skin:"myres/mjdesktop/h_1.png",height:34}},{type:"Image",props:{y:-111,x:361,width:22,skin:"myres/mjdesktop/h_1.png",height:34}}]},{type:"Sprite",props:{y:1,x:425,width:402,scaleY:1,scaleX:1,pivotY:-21,pivotX:22,name:6,height:85},child:[{type:"Image",props:{y:-130,x:157,skin:"myres/mjdesktop/bg_fan.png",name:"img"}},{type:"Label",props:{y:-80,x:135,width:327,text:"门前清自摸和",skewX:-10,scaleY:.8,scaleX:.8,rotation:-6,name:"l_name",height:44,fontSize:50,font:"youyuan",color:"#f1eeda",align:"center"}},{type:"Image",props:{y:-104,x:398,width:21,skin:"myres/mjdesktop/word_fan.png",height:21}},{type:"Image",props:{y:-113,x:378,width:22,skin:"myres/mjdesktop/h_1.png",height:34}},{type:"Image",props:{y:-111,x:361,width:22,skin:"myres/mjdesktop/h_1.png",height:34}}]},{type:"Sprite",props:{y:51,x:505,width:402,scaleY:1,scaleX:1,pivotY:-21,pivotX:22,name:7,height:85},child:[{type:"Image",props:{y:-130,x:157,skin:"myres/mjdesktop/bg_fan.png",name:"img"}},{type:"Label",props:{y:-80,x:135,width:327,text:"门前清自摸和",skewX:-10,scaleY:.8,scaleX:.8,rotation:-6,name:"l_name",height:44,fontSize:50,font:"youyuan",color:"#f1eeda",align:"center"}},{type:"Image",props:{y:-104,x:398,width:21,skin:"myres/mjdesktop/word_fan.png",height:21}},{type:"Image",props:{y:-113,x:378,width:22,skin:"myres/mjdesktop/h_1.png",height:34}},{type:"Image",props:{y:-111,x:361,width:22,skin:"myres/mjdesktop/h_1.png",height:34}}]},{type:"Sprite",props:{y:113,x:551,width:402,scaleY:1,scaleX:1,pivotY:-21,pivotX:22,name:8,height:85},child:[{type:"Image",props:{y:-130,x:157,skin:"myres/mjdesktop/bg_fan.png",name:"img"}},{type:"Label",props:{y:-80,x:135,width:327,text:"门前清自摸和",skewX:-10,scaleY:.8,scaleX:.8,rotation:-6,name:"l_name",height:44,fontSize:50,font:"youyuan",color:"#f1eeda",align:"center"}},{type:"Image",props:{y:-104,x:398,width:21,skin:"myres/mjdesktop/word_fan.png",height:21}},{type:"Image",props:{y:-113,x:378,width:22,skin:"myres/mjdesktop/h_1.png",height:34}},{type:"Image",props:{y:-111,x:361,width:22,skin:"myres/mjdesktop/h_1.png",height:34}}]},{type:"Sprite",props:{y:194,x:552,width:402,scaleY:1,scaleX:1,pivotY:-21,pivotX:22,name:9,height:85},child:[{type:"Image",props:{y:-130,x:157,skin:"myres/mjdesktop/bg_fan.png",name:"img"}},{type:"Label",props:{y:-80,x:135,width:327,text:"门前清自摸和",skewX:-10,scaleY:.8,scaleX:.8,rotation:-6,name:"l_name",height:44,fontSize:50,font:"youyuan",color:"#f1eeda",align:"center"}},{type:"Image",props:{y:-104,x:398,width:21,skin:"myres/mjdesktop/word_fan.png",height:21}},{type:"Image",props:{y:-113,x:378,width:22,skin:"myres/mjdesktop/h_1.png",height:34}},{type:"Image",props:{y:-111,x:361,width:22,skin:"myres/mjdesktop/h_1.png",height:34}}]},{type:"Sprite",props:{y:273,x:509,width:402,scaleY:1,scaleX:1,pivotY:-21,pivotX:22,name:10,height:85},child:[{type:"Image",props:{y:-130,x:157,skin:"myres/mjdesktop/bg_fan.png",name:"img"}},{type:"Label",props:{y:-80,x:135,width:327,text:"门前清自摸和",skewX:-10,scaleY:.8,scaleX:.8,rotation:-6,name:"l_name",height:44,fontSize:50,font:"youyuan",color:"#f1eeda",align:"center"}},{type:"Image",props:{y:-104,x:398,width:21,skin:"myres/mjdesktop/word_fan.png",height:21}},{type:"Image",props:{y:-113,x:378,width:22,skin:"myres/mjdesktop/h_1.png",height:34}},{type:"Image",props:{y:-111,x:361,width:22,skin:"myres/mjdesktop/h_1.png",height:34}}]},{type:"Sprite",props:{y:353,x:455,width:402,scaleY:1,scaleX:1,pivotY:-21,pivotX:22,name:11,height:85},child:[{type:"Image",props:{y:-130,x:157,skin:"myres/mjdesktop/bg_fan.png",name:"img"}},{type:"Label",props:{y:-80,x:135,width:327,text:"门前清自摸和",skewX:-10,scaleY:.8,scaleX:.8,rotation:-6,name:"l_name",height:44,fontSize:50,font:"youyuan",color:"#f1eeda",align:"center"}},{type:"Image",props:{y:-104,x:398,width:21,skin:"myres/mjdesktop/word_fan.png",height:21}},{type:"Image",props:{y:-113,x:378,width:22,skin:"myres/mjdesktop/h_1.png",height:34}},{type:"Image",props:{y:-111,x:361,width:22,skin:"myres/mjdesktop/h_1.png",height:34}}]}]},{type:"Sprite",props:{y:432,x:919,name:"container_fan_15"},child:[{type:"Sprite",props:{y:41,x:-44,width:402,scaleY:.9,scaleX:.9,pivotY:-21,pivotX:22,name:0,height:85},child:[{type:"Image",props:{y:-130,x:157,skin:"myres/mjdesktop/bg_fan.png",name:"img"}},{type:"Label",props:{y:-80,x:135,width:327,text:"门前清自摸和",skewX:-10,scaleY:.8,scaleX:.8,rotation:-6,name:"l_name",height:44,fontSize:50,font:"youyuan",color:"#f1eeda",align:"center"}},{type:"Image",props:{y:-104,x:398,width:21,skin:"myres/mjdesktop/word_fan.png",height:21}},{type:"Image",props:{y:-113,x:378,width:22,skin:"myres/mjdesktop/h_1.png",height:34}},{type:"Image",props:{y:-111,x:361,width:22,skin:"myres/mjdesktop/h_1.png",height:34}}]},{type:"Sprite",props:{y:97,x:-81,width:402,scaleY:.9,scaleX:.9,pivotY:-21,pivotX:22,name:0,height:85},child:[{type:"Image",props:{y:-130,x:157,skin:"myres/mjdesktop/bg_fan.png",name:"img"}},{type:"Label",props:{y:-80,x:135,width:327,text:"门前清自摸和",skewX:-10,scaleY:.8,scaleX:.8,rotation:-6,name:"l_name",height:44,fontSize:50,font:"youyuan",color:"#f1eeda",align:"center"}},{type:"Image",props:{y:-104,x:398,width:21,skin:"myres/mjdesktop/word_fan.png",height:21}},{type:"Image",props:{y:-113,x:378,width:22,skin:"myres/mjdesktop/h_1.png",height:34}},{type:"Image",props:{y:-111,x:361,width:22,skin:"myres/mjdesktop/h_1.png",height:34}}]},{type:"Sprite",props:{y:157,x:-112,width:402,scaleY:.9,scaleX:.9,pivotY:-21,pivotX:22,name:0,height:85},child:[{type:"Image",props:{y:-130,x:157,skin:"myres/mjdesktop/bg_fan.png",name:"img"}},{type:"Label",props:{y:-80,x:135,width:327,text:"门前清自摸和",skewX:-10,scaleY:.8,scaleX:.8,rotation:-6,name:"l_name",height:44,fontSize:50,font:"youyuan",color:"#f1eeda",align:"center"}},{type:"Image",props:{y:-104,x:398,width:21,skin:"myres/mjdesktop/word_fan.png",height:21}},{type:"Image",props:{y:-113,x:378,width:22,skin:"myres/mjdesktop/h_1.png",height:34}},{type:"Image",props:{y:-111,x:361,width:22,skin:"myres/mjdesktop/h_1.png",height:34}}]},{type:"Sprite",props:{y:218,x:-114,width:402,scaleY:.9,scaleX:.9,pivotY:-21,pivotX:22,name:0,height:85},child:[{type:"Image",props:{y:-130,x:157,skin:"myres/mjdesktop/bg_fan.png",name:"img"}},{type:"Label",props:{y:-80,x:135,width:327,text:"门前清自摸和",skewX:-10,scaleY:.8,scaleX:.8,rotation:-6,name:"l_name",height:44,fontSize:50,font:"youyuan",color:"#f1eeda",align:"center"}},{type:"Image",props:{y:-104,x:398,width:21,skin:"myres/mjdesktop/word_fan.png",height:21}},{type:"Image",props:{y:-113,x:378,width:22,skin:"myres/mjdesktop/h_1.png",height:34}},{type:"Image",props:{y:-111,x:361,width:22,skin:"myres/mjdesktop/h_1.png",height:34}}]},{type:"Sprite",props:{y:279,x:-106,width:402,scaleY:.9,scaleX:.9,pivotY:-21,pivotX:22,name:0,height:85},child:[{type:"Image",props:{y:-130,x:157,skin:"myres/mjdesktop/bg_fan.png",name:"img"}},{type:"Label",props:{y:-80,x:135,width:327,text:"门前清自摸和",skewX:-10,scaleY:.8,scaleX:.8,rotation:-6,name:"l_name",height:44,fontSize:50,font:"youyuan",color:"#f1eeda",align:"center"}},{type:"Image",props:{y:-104,x:398,width:21,skin:"myres/mjdesktop/word_fan.png",height:21}},{type:"Image",props:{y:-113,x:378,width:22,skin:"myres/mjdesktop/h_1.png",height:34}},{type:"Image",props:{y:-111,x:361,width:22,skin:"myres/mjdesktop/h_1.png",height:34}}]},{type:"Sprite",props:{y:328,x:-61,width:402,scaleY:.9,scaleX:.9,pivotY:-21,pivotX:22,name:0,height:85},child:[{type:"Image",props:{y:-130,x:157,skin:"myres/mjdesktop/bg_fan.png",name:"img"}},{type:"Label",props:{y:-80,x:135,width:327,text:"门前清自摸和",skewX:-10,scaleY:.8,scaleX:.8,rotation:-6,name:"l_name",height:44,fontSize:50,font:"youyuan",color:"#f1eeda",align:"center"}},{type:"Image",props:{y:-104,x:398,width:21,skin:"myres/mjdesktop/word_fan.png",height:21}},{type:"Image",props:{y:-113,x:378,width:22,skin:"myres/mjdesktop/h_1.png",height:34}},{type:"Image",props:{y:-111,x:361,width:22,skin:"myres/mjdesktop/h_1.png",height:34}}]},{type:"Sprite",props:{y:373,x:-2,width:402,scaleY:.9,scaleX:.9,pivotY:-21,pivotX:22,name:0,height:85},child:[{type:"Image",props:{y:-130,x:157,skin:"myres/mjdesktop/bg_fan.png",name:"img"}},{type:"Label",props:{y:-80,x:135,width:327,text:"门前清自摸和",skewX:-10,scaleY:.8,scaleX:.8,rotation:-6,name:"l_name",height:44,fontSize:50,font:"youyuan",color:"#f1eeda",align:"center"}},{type:"Image",props:{y:-104,x:398,width:21,skin:"myres/mjdesktop/word_fan.png",height:21}},{type:"Image",props:{y:-113,x:378,width:22,skin:"myres/mjdesktop/h_1.png",height:34}},{type:"Image",props:{y:-111,x:361,width:22,skin:"myres/mjdesktop/h_1.png",height:34}}]},{type:"Sprite",props:{y:-9,x:416,width:402,scaleY:.9,scaleX:.9,pivotY:-21,pivotX:22,name:0,height:85},child:[{type:"Image",props:{y:-130,x:157,skin:"myres/mjdesktop/bg_fan.png",name:"img"}},{type:"Label",props:{y:-80,x:135,width:327,text:"门前清自摸和",skewX:-10,scaleY:.8,scaleX:.8,rotation:-6,name:"l_name",height:44,fontSize:50,font:"youyuan",color:"#f1eeda",align:"center"}},{type:"Image",props:{y:-104,x:398,width:21,skin:"myres/mjdesktop/word_fan.png",height:21}},{type:"Image",props:{y:-113,x:378,width:22,skin:"myres/mjdesktop/h_1.png",height:34}},{type:"Image",props:{y:-111,x:361,width:22,skin:"myres/mjdesktop/h_1.png",height:34}}]},{type:"Sprite",props:{y:28,x:494,width:402,scaleY:.9,scaleX:.9,pivotY:-21,pivotX:22,name:0,height:85},child:[{type:"Image",props:{y:-130,x:157,skin:"myres/mjdesktop/bg_fan.png",name:"img"}},{type:"Label",props:{y:-80,x:135,width:327,text:"门前清自摸和",skewX:-10,scaleY:.8,scaleX:.8,rotation:-6,name:"l_name",height:44,fontSize:50,font:"youyuan",color:"#f1eeda",align:"center"}},{type:"Image",props:{y:-104,x:398,width:21,skin:"myres/mjdesktop/word_fan.png",height:21}},{type:"Image",props:{y:-113,x:378,width:22,skin:"myres/mjdesktop/h_1.png",height:34}},{type:"Image",props:{y:-111,x:361,width:22,skin:"myres/mjdesktop/h_1.png",height:34}}]},{type:"Sprite",props:{y:73,x:547,width:402,scaleY:.9,scaleX:.9,pivotY:-21,pivotX:22,name:0,height:85},child:[{type:"Image",props:{y:-130,x:157,skin:"myres/mjdesktop/bg_fan.png",name:"img"}},{type:"Label",props:{y:-80,x:135,width:327,text:"门前清自摸和",skewX:-10,scaleY:.8,scaleX:.8,rotation:-6,name:"l_name",height:44,fontSize:50,font:"youyuan",color:"#f1eeda",align:"center"}},{type:"Image",props:{y:-104,x:398,width:21,skin:"myres/mjdesktop/word_fan.png",height:21}},{type:"Image",props:{y:-113,x:378,width:22,skin:"myres/mjdesktop/h_1.png",height:34}},{type:"Image",props:{y:-111,x:361,width:22,skin:"myres/mjdesktop/h_1.png",height:34}}]},{type:"Sprite",props:{y:130,x:570,width:402,scaleY:.9,scaleX:.9,pivotY:-21,pivotX:22,name:0,height:85},child:[{type:"Image",props:{y:-130,x:157,skin:"myres/mjdesktop/bg_fan.png",name:"img"}},{type:"Label",props:{y:-80,x:135,width:327,text:"门前清自摸和",skewX:-10,scaleY:.8,scaleX:.8,rotation:-6,name:"l_name",height:44,fontSize:50,font:"youyuan",color:"#f1eeda",align:"center"}},{type:"Image",props:{y:-104,x:398,width:21,skin:"myres/mjdesktop/word_fan.png",height:21}},{type:"Image",props:{y:-113,x:378,width:22,skin:"myres/mjdesktop/h_1.png",height:34}},{type:"Image",props:{y:-111,x:361,width:22,skin:"myres/mjdesktop/h_1.png",height:34}}]},{type:"Sprite",props:{y:189,x:564,width:402,scaleY:.9,scaleX:.9,pivotY:-21,pivotX:22,name:0,height:85},child:[{type:"Image",props:{y:-130,x:157,skin:"myres/mjdesktop/bg_fan.png",name:"img"}},{type:"Label",props:{y:-80,x:135,width:327,text:"门前清自摸和",skewX:-10,scaleY:.8,scaleX:.8,rotation:-6,name:"l_name",height:44,fontSize:50,font:"youyuan",color:"#f1eeda",align:"center"}},{type:"Image",props:{y:-104,x:398,width:21,skin:"myres/mjdesktop/word_fan.png",height:21}},{type:"Image",props:{y:-113,x:378,width:22,skin:"myres/mjdesktop/h_1.png",height:34}},{type:"Image",props:{y:-111,x:361,width:22,skin:"myres/mjdesktop/h_1.png",height:34}}]},{type:"Sprite",props:{y:246,x:544,width:402,scaleY:.9,scaleX:.9,pivotY:-21,pivotX:22,name:0,height:85},child:[{type:"Image",props:{y:-130,x:157,skin:"myres/mjdesktop/bg_fan.png",name:"img"}},{type:"Label",props:{y:-80,x:135,width:327,text:"门前清自摸和",skewX:-10,scaleY:.8,scaleX:.8,rotation:-6,name:"l_name",height:44,fontSize:50,font:"youyuan",color:"#f1eeda",align:"center"}},{type:"Image",props:{y:-104,x:398,width:21,skin:"myres/mjdesktop/word_fan.png",height:21}},{type:"Image",props:{y:-113,x:378,width:22,skin:"myres/mjdesktop/h_1.png",height:34}},{type:"Image",props:{y:-111,x:361,width:22,skin:"myres/mjdesktop/h_1.png",height:34}}]},{type:"Sprite",props:{y:309,x:503,width:402,scaleY:.9,scaleX:.9,pivotY:-21,pivotX:22,name:0,height:85},child:[{type:"Image",props:{y:-130,x:157,skin:"myres/mjdesktop/bg_fan.png",name:"img"}},{type:"Label",props:{y:-80,x:135,width:327,text:"门前清自摸和",skewX:-10,scaleY:.8,scaleX:.8,rotation:-6,name:"l_name",height:44,fontSize:50,font:"youyuan",color:"#f1eeda",align:"center"}},{type:"Image",props:{y:-104,x:398,width:21,skin:"myres/mjdesktop/word_fan.png",height:21}},{type:"Image",props:{y:-113,x:378,width:22,skin:"myres/mjdesktop/h_1.png",height:34}},{type:"Image",props:{y:-111,x:361,width:22,skin:"myres/mjdesktop/h_1.png",height:34}}]},{type:"Sprite",props:{y:342,x:254,width:402,scaleY:.9,scaleX:.9,pivotY:-21,pivotX:22,name:0,height:85},child:[{type:"Image",props:{y:-130,x:157,skin:"myres/mjdesktop/bg_fan.png",name:"img"}},{type:"Label",props:{y:-80,x:135,width:327,text:"门前清自摸和",skewX:-10,scaleY:.8,scaleX:.8,rotation:-6,name:"l_name",height:44,fontSize:50,font:"youyuan",color:"#f1eeda",align:"center"}},{type:"Image",props:{y:-104,x:398,width:21,skin:"myres/mjdesktop/word_fan.png",height:21}},{type:"Image",props:{y:-113,x:378,width:22,skin:"myres/mjdesktop/h_1.png",height:34}},{type:"Image",props:{y:-111,x:361,width:22,skin:"myres/mjdesktop/h_1.png",height:34}}]}]},{type:"Image",props:{y:590,x:1328,width:185,skin:"myres/mjdesktop/bg_center_fan.png",pivotY:149,pivotX:24,name:"container_fanfu",height:179},child:[{type:"Sprite",props:{y:-34,x:96,name:"fan"},child:[{type:"Image",props:{y:58,x:-88,width:73,skin:"myres/mjdesktop/h_2.png",scaleY:.7,scaleX:.7,name:"1",height:113}},{type:"Image",props:{y:54,x:-38,width:73,skin:"myres/mjdesktop/h_3.png",scaleY:.7,scaleX:.7,name:"0",height:113}},{type:"Image",props:{y:109,x:8,width:88,skin:"myres/mjdesktop/word_fan.png",scaleY:.65,scaleX:.65,name:"word",height:87}}]},{type:"Sprite",props:{y:145,x:-47,name:"fu"},child:[{type:"Image",props:{y:-17,x:33,skin:"myres/mjdesktop/ww_4.png",skewX:-10,scaleY:.3,scaleX:.3,rotation:-10,name:"2"}},{type:"Image",props:{y:-21,x:51,skin:"myres/mjdesktop/ww_1.png",skewX:-10,scaleY:.3,scaleX:.3,rotation:-10,name:"1"}},{type:"Image",props:{y:-25,x:69,skin:"myres/mjdesktop/ww_4.png",skewX:-10,scaleY:.3,scaleX:.3,rotation:-10,name:"0"}},{type:"Image",props:{y:-31,x:90,width:69,skin:"myres/mjdesktop/word_fu.png",scaleY:.5,scaleX:.5,name:"word",height:67}}]},{type:"Image",props:{y:54,x:17,width:148,skin:"myres/mjdesktop/word_yiman.png",name:"yiman",height:90}}]},{type:"Sprite",props:{y:863,x:1464,width:589,scaleY:1.2,scaleX:1.2,rotation:-6,pivotY:55,pivotX:290,name:"container_score",height:110},child:[{type:"Image",props:{x:70,skin:"myres/mjdesktop/ww_2.png",name:"s5"}},{type:"Image",props:{y:0,x:140,skin:"myres/mjdesktop/ww_2.png",name:"s4"}},{type:"Image",props:{y:0,x:210,skin:"myres/mjdesktop/ww_2.png",name:"s3"}},{type:"Image",props:{y:0,x:280,skin:"myres/mjdesktop/ww_2.png",name:"s2"}},{type:"Image",props:{y:0,x:350,skin:"myres/mjdesktop/ww_2.png",name:"s1"}},{type:"Image",props:{y:0,x:420,skin:"myres/mjdesktop/ww_2.png",name:"s0"}},{type:"Image",props:{y:19,x:499,skin:"myres/mjdesktop/word_point.png"}}]},{type:"Sprite",props:{y:954,x:902,width:650,scaleY:1.2,scaleX:1.2,pivotY:85,pivotX:430,name:"container_title",height:150},child:[{type:"Image",props:{y:0,x:0,width:160,name:"0",height:155}},{type:"Image",props:{y:0,x:160,width:160,name:"1",height:155}},{type:"Image",props:{y:0,x:320,width:160,name:"2",height:155}},{type:"Image",props:{y:0,x:480,width:160,name:"3",height:155}}]},{type:"Image",props:{y:834,x:0,width:385,skin:"myres/mjdesktop/bg_nickname.png",name:"container_name",height:122},child:[{type:"Label",props:{y:54,x:13,width:339,text:"名字在这里啊啊啊",rotation:-6,height:80,fontSize:40,font:"SimHei",color:"#ffffff",align:"center"}}]},{type:"Image",props:{y:65,x:1748,skin:"myres/mjdesktop/pg_he.png",scaleY:1.2,scaleX:1.2,name:"he"}},{type:"Button",props:{y:1005,x:1755,stateNum:1,skin:"myres/btn_small.png",scaleY:1.2,scaleX:1.2,rotation:0,name:"btn_confirm",anchorY:.5,anchorX:.5,sizeGrid:"30,30,30,30"},child:[{type:"Label",props:{y:14,x:1,width:75,text:"(3)",name:"countdown",height:50,fontSize:39,font:"SimHei",color:"#ffffff",align:"center"}},{type:"Script",props:{runtime:"capsui.CButton"}},{type:"Label",props:{y:6,x:43,width:132,valign:"middle",text:"确定",scaleY:.9,scaleX:.9,name:"confirm",height:60,fontSize:35,font:"fengyu",color:"#e8af71",align:"center"}}]},{type:"Sprite",props:{y:1015,x:943,name:"effect_yiman"}},{type:"Sprite",props:{y:1007,x:748,name:"effect_yiman2"}}]}]},i}(View);t.winUI=i}(e.mj||(e.mj={}))}(ui||(ui={}));var uiscript;!function(e){var t=function(){function t(e){this._me=null,this._enable=!1,this._valid=!1,this._enable=this._valid=!1,e?(this._me=e,this._me.visible=!1,this._me.frameOnce(4,this,this._onload)):console.error("加载UI失败")}return Object.defineProperty(t.prototype,"me",{get:function(){return this._me},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"enable",{get:function(){return this._valid&&this._enable},set:function(e){this._valid&&this._enable!=e&&(this._enable=e,this._me.visible=e,e?this._onEnable():this._onDisable())},enumerable:!0,configurable:!0}),t.prototype._onload=function(){this._valid=!0,this.onCreate(),this.me.frameLoop(1,this,this._update)},t.prototype._update=function(){this.enable&&this.update()},t.prototype._onEnable=function(){this._valid&&(this.me.event("onenable"),this.onEnable())},t.prototype._onDisable=function(){this._valid&&(this.me.event("ondisable"),this.onDisable())},t.prototype.destroy=function(){this._valid&&(Laya.timer.clearAll(this),this.enable=!1,this.onDestroy(),this._valid=!1,this._me.destroy(!0),e.UIMgr.Inst.onUIDestory(this))},t.prototype.onCreate=function(){},t.prototype.onEnable=function(){},t.prototype.update=function(){},t.prototype.onDisable=function(){},t.prototype.onDestroy=function(){},t.anim_pop_out=function(e,t){e.alpha=0;var i=e.scaleX,n=e.scaleY;e.scaleX=.6*i,e.scaleY=.6*n,Laya.Tween.to(e,{alpha:1,scaleX:i,scaleY:n},150,Laya.Ease.backOut,Laya.Handler.create(e,function(){e.scaleX=i,e.scaleY=n,e.alpha=1,t&&t.run()}))},t.anim_pop_hide=function(e,t){e.alpha=1;var i=e.scaleX,n=e.scaleY;Laya.Tween.to(e,{alpha:0,scaleX:.6*i,scaleY:.6*n},150,Laya.Ease.backOut,Laya.Handler.create(e,function(){e.scaleX=i,e.scaleY=n,e.alpha=0,t&&t.run()}))},t.anim_alpha_in=function(e,t,i,n,a,r){void 0===n&&(n=0),void 0===a&&(a=null),void 0===r&&(r=null);var o={};for(var s in t)o[s]=e[s],e[s]+=t[s];e.alpha=0,o.alpha=1,Laya.Tween.to(e,o,i,r,a,n)},t.anim_alpha_out=function(e,t,i,n,a,r){void 0===n&&(n=0),void 0===a&&(a=null),void 0===r&&(r=null);var o={};for(var s in t)o[s]=e[s],t[s]+=e[s];t.alpha=0,Laya.Tween.to(e,t,i,r,Laya.Handler.create(e,function(){for(var i in t)e[i]=o[i];e.alpha=0,a&&a.run()}),n)},t}();e.UIBase=t}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(e){function t(t,i){var n=e.call(this,i)||this;return n.__activity_name=t,n}return __extends(t,e),Object.defineProperty(t.prototype,"activity_name",{get:function(){return this.__activity_name},enumerable:!0,configurable:!0}),t.prototype.show=function(){},t.prototype.hide=function(){},t}(e.UIBase);e.UI_ActivityBase=t}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(t){function i(){var e=t.call(this,"复活币",new ui.lobby.activitys.activity_jiujiUI)||this;return e.btn_cd=0,e}return __extends(i,t),i.Init=function(){var t=this;app.NetAgent.sendReq2Lobby("Lobby","fetchReviveCoinInfo",{},function(i,n){i||n.error?e.UIMgr.Inst.showNetReqError("fetchReviveCoinInfo",i,n):t.has_gained=n.has_gained}),app.NetAgent.AddListener2Lobby("NotifyReviveCoinUpdate",Laya.Handler.create(this,function(e){t.has_gained=e.has_gained,t.Inst&&t.Inst.enable&&t.Inst.refresh()},null,!1))},i.prototype.onCreate=function(){var t=this;this.root=this.me.getChildByName("root"),this.title=this.root.getChildByName("title"),this.desc=this.root.getChildByName("desc");var n=this.root.getChildByName("task");this.task={container:n,bg:n.getChildByName("bg"),container_info:n.getChildByName("info"),item_icon:n.getChildByName("info").getChildByName("item"),item_count:n.getChildByName("info").getChildByName("item_count"),item_name:n.getChildByName("info").getChildByName("item_name"),btn_get:n.getChildByName("info").getChildByName("btn_get"),getno:n.getChildByName("info").getChildByName("noget"),alreadyget:n.getChildByName("info").getChildByName("alreadyget")},this.task.btn_get.clickHandler=Laya.Handler.create(this,function(){t.btn_cd>Laya.timer.currTimer||(t.btn_cd=Laya.timer.currTimer+1e3,app.NetAgent.sendReq2Lobby("Lobby","gainReviveCoin",{},function(n,a){t.btn_cd=0,n||a.error?e.UIMgr.Inst.showNetReqError("gainReviveCoin",n,a):(t.task.btn_get.visible=!1,t.task.alreadyget.visible=!0,i.has_gained=!0)}))},null,!1)},i.prototype.show=function(){this.me.visible=!0,this.btn_cd=0,this.refresh()},i.prototype.hide=function(){this.me.visible=!1},i.prototype.findData=function(){var e=0;return cfg.events.soscoin.forEach(function(t){t.level_limit==GameMgr.Inst.account_data.level.id&&(e=t.id)}),e},i.prototype.refresh=function(){var e=cfg.events.soscoin.get(this.findData());if(e)if(this.desc.text=e.desc,e.gold_num<1)this.task.bg.skin="myres/lobby/bg_rules_no.png",this.task.container_info.visible=!1;else{this.task.bg.skin="myres/lobby/bg_rules.png",this.task.container_info.visible=!0,this.task.getno.visible=!1,this.task.btn_get.visible=!1,this.task.alreadyget.visible=!1,this.task.item_count.text=e.gold_num.toString(),i.has_gained?this.task.alreadyget.visible=!0:GameMgr.Inst.account_data.gold<e.gold_limit?this.task.btn_get.visible=!0:this.task.getno.visible=!0;var t=cfg.item_definition.currency.get(100002);this.task.item_icon.skin=game.LoadMgr.getResImageSkin(t.icon),this.task.item_name.text=t.name}else this.desc.text="未找到信息，丢失了",this.task.container_info.visible=!1,this.task.bg.skin="myres/lobby/bg_rules_no.png"},i.Inst=null,i.has_gained=!1,i}(e.UI_ActivityBase);e.UI_Activity_Jiuji=t}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(t){function i(){var e=t.call(this,"悬赏任务",new ui.lobby.activitys.activity_xuanshangUI)||this;return e.tasks=[],e.btn_cd=0,e}return __extends(i,t),i.Init=function(){var t=this;app.NetAgent.sendReq2Lobby("Lobby","fetchDailyTask",{},function(i,n){i||n.error?e.UIMgr.Inst.showNetReqError("fetchDailyTask",i,n):(t.has_refresh_count=n.has_refresh_count,t.datas=n.progresses)}),app.NetAgent.AddListener2Lobby("NotifyDailyTaskUpdate",Laya.Handler.create(this,function(e){t.has_refresh_count=!0,t.datas=e.progresses,t.Inst&&t.Inst.enable&&t.Inst.refresh()},null,!1))},i.dataUpdate=function(e){for(var t=0;t<e.progresses.length;t++)for(var i=e.progresses[t],n=0;n<this.datas.length;n++)if(!this.datas[n].achieved&&this.datas[n].id==i.id){null!=i.achieved&&void 0!=i.achieved&&(this.datas[n].achieved=i.achieved),null!=i.counter&&void 0!=i.counter&&(this.datas[n].counter=i.counter);break}},i.prototype.onCreate=function(){this.root=this.me.getChildByName("root");for(var e=0;e<3;e++){var t=this.root.getChildByName("task"+e);this.tasks.push({container:t,bg:t.getChildByName("bg"),container_info:t.getChildByName("info"),item_icon:t.getChildByName("info").getChildByName("item"),item_name:t.getChildByName("info").getChildByName("item_name"),item_count:t.getChildByName("info").getChildByName("item_count"),desc:t.getChildByName("info").getChildByName("requirement"),progress_bar:t.getChildByName("info").getChildByName("bar").getChildByName("val"),progress_label:t.getChildByName("info").getChildByName("progress"),btn_change:t.getChildByName("info").getChildByName("btn_change")})}},i.prototype.show=function(){this.enable=!0,this.btn_cd=0,this.refresh()},i.prototype.hide=function(){this.enable=!1},i.prototype.refresh=function(){for(var t=this,n=function(n){var r=a.tasks[n];if(n<i.datas.length){var o=i.datas[n],s=cfg.events.dailyevent.get(o.id);if(o.achieved||!s)r.container_info.visible=!1,r.bg.skin="myres/lobby/bg_rules_no.png";else{r.container_info.visible=!0,r.bg.skin="myres/lobby/bg_rules.png",r.btn_change.visible=i.has_refresh_count,r.desc.text=s.desc,r.item_count.text=s.reward_num.toString();var h=cfg.item_definition.currency.get(s.reward_type);h&&(r.item_icon.skin=game.LoadMgr.getResImageSkin(h.icon),r.item_name.text=h.name);var l=cfg.item_definition.item.get(s.reward_type);l&&(r.item_icon.skin=game.LoadMgr.getResImageSkin(l.icon),r.item_name.text=l.name),r.progress_bar.scaleX=o.counter/s.target,r.progress_label.text=o.counter.toString()+"/"+s.target.toString(),r.btn_change.clickHandler=Laya.Handler.create(a,function(){if(!(t.btn_cd>Laya.timer.currTimer)){t.btn_cd=1e3+Laya.timer.currTimer;for(var a=0;a<t.tasks.length;a++)t.tasks[a].btn_change.visible=!1;app.NetAgent.sendReq2Lobby("Lobby","refreshDailyTask",{task_id:o.id},function(a,r){if(t.btn_cd=0,a||r.error)e.UIMgr.Inst.showNetReqError("refreshDailyTask",a,r);else{i.has_refresh_count=!1,i.datas[n]=r.progress;for(var o=[],s=0;s<i.datas.length;s++)i.datas[s].achieved||o.push(i.datas[s]);i.datas=o,t.refresh()}})}},null,!1)}}else r.container_info.visible=!1,r.bg.skin="myres/lobby/bg_rules_no.png"},a=this,r=0;r<this.tasks.length;r++)n(r)},i.has_refresh_count=!1,i.datas=[],i}(e.UI_ActivityBase);e.UI_Activity_Xuanshang=t}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(){function t(t){this.tasks=[],this.left_scrollview=null,this.panel_right=null,this.select_index=0,this.notask=null,this.me=t,this.me.visible=!1,this.notask=this.me.getChildByName("notask"),this.left_scrollview=this.me.getChildByName("left").scriptMap["capsui.CScrollView"],this.left_scrollview.init_scrollview(Laya.Handler.create(this,this.renderLeft,null,!1)),this.panel_right=this.me.getChildByName("right"),this.addTask(new e.UI_Activity_Xuanshang),this.addTask(new e.UI_Activity_Jiuji)}return t.prototype.addTask=function(e){this.panel_right.addChild(e.me),this.tasks.push(e)},t.prototype.show=function(){this.me.visible=!0,this.left_scrollview.reset(),this.select_index=0,this.tasks.length>0?(this.left_scrollview.me.visible=!0,this.panel_right.visible=!0,this.notask.visible=!1,this.left_scrollview.addItem(this.tasks.length),this.tasks[this.select_index].show()):(this.left_scrollview.me.visible=!1,this.panel_right.visible=!1,this.notask.visible=!0)},t.prototype.hide=function(){this.me.visible=!1,this.select_index>=0&&this.select_index<this.tasks.length&&(this.tasks[this.select_index].hide(),this.left_scrollview.wantToRefreshItem(this.select_index)),this.select_index=-1,this.left_scrollview.reset()},t.prototype.renderLeft=function(e){var t=this,i=e.index,n=e.container,a=n.getChildByName("bg");a.skin=this.select_index==i?"myres/lobby/act_choosed.png":"myres/lobby/act_unchoosen.png",n.clickHandler=Laya.Handler.create(this,function(){if(t.select_index!=i){var e=t.select_index;t.select_index=i,e>=0&&e<t.tasks.length&&(t.tasks[e].hide(),t.left_scrollview.wantToRefreshItem(e)),a.skin="myres/lobby/act_choosed.png",t.select_index=i,t.tasks[t.select_index].show()}},null,!1),n.getChildByName("title").text=this.tasks[i].activity_name},t}(),i=function(i){function n(){var e=i.call(this,new ui.lobby.activityUI)||this;return e.root=null,e.tabs=[],e.redpoint=null,e.page_huodong=null,e.select_tab=-1,e.locking=!1,n.Inst=e,e}return __extends(n,i),n.prototype.onCreate=function(){var i=this;this.root=this.me.getChildByName("root");for(var n=0;n<2;n++)this.tabs.push(this.root.getChildByName("tabs").getChildByName("tab"+n.toString())),this.tabs[n].clickHandler=Laya.Handler.create(this,this._switchTab,[n,!1],!1);this.redpoint=this.tabs[1].getChildByName("redpoint"),this.redpoint.visible=!1,new e.UI_Mail(this.root.getChildByName("page_mail")),this.page_huodong=new t(this.root.getChildByName("page_huodong")),this.root.getChildByName("btn_close").clickHandler=Laya.Handler.create(this,function(){i.close()},null,!1)},n.prototype.show=function(){var t=this;this.enable=!0,this.locking=!0,this._switchTab(0,!0),this.refresh_redpoint(),e.UIBase.anim_pop_out(this.root,Laya.Handler.create(this,function(){t.locking=!1}))},n.prototype.close=function(){var t=this;this.locking=!0,e.UIBase.anim_pop_hide(this.root,Laya.Handler.create(this,function(){t.locking=!1,t.enable=!1}))},n.prototype.onDisable=function(){this.page_huodong.hide(),e.UI_Mail.Inst.hide()},n.prototype._switchTab=function(t,i){(i||this.select_tab!=t)&&(this.select_tab=t,this.tabs[0].getChildByName("img").skin=0==t?"myres/lobby/act_bright.png":"myres/lobby/act_dark.png",this.tabs[1].getChildByName("img").skin=1==t?"myres/lobby/mail_bright.png":"myres/lobby/mail_dark.png",1==this.select_tab?(this.page_huodong.hide(),e.UI_Mail.Inst.show()):(this.page_huodong.show(),e.UI_Mail.Inst.hide()))},n.prototype.refresh_redpoint=function(){this.redpoint.visible=e.UI_Mail.haveRedPoint},n.Inst=null,n}(e.UIBase);e.UI_Activity=i}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(t){function i(){var e=t.call(this,new ui.lobby.add_roomUI)||this;return e.txtinput=null,e.locking=!1,e.root=null,i.Inst=e,e}return __extends(i,t),i.Show=function(){this.Inst._show()},i.Close=function(){null!=this.Inst&&this.Inst._hide()},i.prototype.onCreate=function(){var e=this;this.root=this.me.getChildByName("root"),this.root.getChildByName("btn_cancel").clickHandler=Laya.Handler.create(this,function(){e.locking||e._hide()},null,!1),this.root.getChildByName("btn_create").clickHandler=Laya.Handler.create(this,this._btnAddRoom,null,!1),this.txtinput=this.root.getChildByName("input").getChildByName("txtinput");for(var t=this.root.getChildByName("numpad"),i=function(i){var a=t.getChildByName("n"+i),r=a.getChildByName("s");r.alpha=0;var o=!1;a.on("mousedown",n,function(){r.alpha=0,o=!0,Laya.Tween.to(r,{alpha:1},50,null,null,0,!0,!0)}),a.on("mouseup",n,function(){Laya.Tween.to(r,{alpha:0},50,null,null,0,!0,!0),o&&e.txtinput.text.length<e.txtinput.maxChars&&(e.txtinput.text=e.txtinput.text+i.toString()),o=!1}),a.on("mouseout",n,function(){Laya.Tween.to(r,{alpha:0},50,null,null,0,!0,!0),o=!1})},n=this,a=0;a<10;a++)i(a);var r=(s=t.getChildByName("clear")).getChildByName("s");r.alpha=0;var o=!1;s.on("mousedown",this,function(){r.alpha=0,o=!0,Laya.Tween.to(r,{alpha:1},50,null,null,0,!0,!0)}),s.on("mouseup",this,function(){Laya.Tween.to(r,{alpha:0},50,null,null,0,!0,!0),o&&(e.txtinput.text=""),o=!1}),s.on("mouseout",this,function(){Laya.Tween.to(r,{alpha:0},50,null,null,0,!0,!0),o=!1});var s=t.getChildByName("del"),h=s.getChildByName("s");h.alpha=0;var l=!1;s.on("mousedown",this,function(){h.alpha=0,l=!0,Laya.Tween.to(h,{alpha:1},50,null,null,0,!0,!0)}),s.on("mouseup",this,function(){if(Laya.Tween.to(h,{alpha:0},50,null,null,0,!0,!0),l){var t=e.txtinput.text;t.length>0&&(t=t.substr(0,t.length-1)),e.txtinput.text=t}l=!1}),s.on("mouseout",this,function(){Laya.Tween.to(h,{alpha:0},50,null,null,0,!0,!0),l=!1})},i.prototype._show=function(){var t=this;this.enable=!0,this.txtinput.text="",this.locking||(this.locking=!0,e.UIBase.anim_pop_out(this.root,Laya.Handler.create(this,function(){t.locking=!1})))},i.prototype._hide=function(){var t=this;this.locking=!0,e.UIBase.anim_pop_hide(this.root,Laya.Handler.create(this,function(){t.locking=!1,t.enable=!1}))},i.prototype._btnAddRoom=function(){var t=this;this.locking||(this._hide(),app.NetAgent.sendReq2Lobby("Lobby","joinRoom",{room_id:parseInt(this.txtinput.text)},function(i,n){i||n.error?e.UIMgr.Inst.showNetReqError("joinRoom",i,n):(t.enable=!1,e.UI_Lobby.Inst.enable=!1,e.UI_WaitingRoom.Inst.updateData(n.room),e.UIMgr.Inst.ShowWaitingRoom())}))},i.Inst=null,i}(e.UIBase);e.UI_Add_Room=t}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(t){function i(){return t.call(this,new ui.mj.alUI)||this}return __extends(i,t),i.Show=function(){var t=new i;e.UIMgr.Inst.AddMJUI(t),Laya.timer.frameOnce(5,this,function(){t.show()})},i.prototype.show=function(){var e=this;this.me.visible=!0,this.me.start.play(0,!1),Laya.timer.once(1300,this,function(){e.me.visible=!1,e.me.destroy(!0)})},i}(e.UIBase);e.UI_AL=t}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(t){function i(){var e=t.call(this,new ui.common.anotherloginUI)||this;return i.Inst=e,e}return __extends(i,t),i.prototype.onCreate=function(){this.root=this.me.getChildByName("root"),this.root.getChildByName("btn").clickHandler=Laya.Handler.create(this,this.hide,null,!1)},i.prototype.show=function(){this.me.visible=!0,Laya.LocalStorage.setItem("_pre_sociotype",""),app.Log.info_net("UI_AnotherLogin  close net"),game.LobbyNetMgr.Inst.Close(),game.MJNetMgr.Inst&&game.MJNetMgr.Inst.Close(),e.UIBase.anim_pop_out(this.root,null)},i.prototype.hide=function(){if(Laya.LocalStorage.setItem("_pre_sociotype",""),Laya.Browser.window.conch){Laya.PlatformClass.createClass("layaair.majsoul.mjmgr").call("restart")}else Laya.Browser.window.location.href=GameMgr.Inst.link_url},i.Inst=null,i}(e.UIBase);e.UI_AnotherLogin=t}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(t){function i(){return t.call(this,new ui.entrance.apptestinfoUI)||this}return __extends(i,t),i.show=function(t){var n=this;Laya.Browser.window.conch?game.LoadMgr.loadRes(game.E_LoadType.entrance,Laya.Handler.create(this,function(){var a=null;e.UIMgr.Inst.AddCommonUI(a=new i),Laya.timer.frameOnce(5,n,function(){a._show(t)})})):t.run()},i.prototype._show=function(t){var i=this;this.enable=!0;var n=this.me.getChildByName("root");e.UIBase.anim_pop_out(n,Laya.Handler.create(this,function(){n.getChildByName("btn").clickHandler=Laya.Handler.create(i,function(){e.UIBase.anim_pop_hide(n,Laya.Handler.create(i,function(){i.enable=!1,i.destroy(),t.run()}))})}))},i}(e.UIBase);e.UI_AppTestInfo=t}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t;!function(e){e[e.none=0]="none",e[e.daoju=1]="daoju",e[e.gift=2]="gift",e[e.fudai=3]="fudai",e[e.character_view=4]="character_view",e[e.common_view=5]="common_view"}(t=e.EItemCategory||(e.EItemCategory={}));var i=function(i){function n(){var e=i.call(this,new ui.lobby.bagUI)||this;return e.container_top=null,e.container_content=null,e.locking=!1,e.tabs=[],e.page_item=null,e.page_gift=null,e.page_desktop=null,e.select_index=0,n.Inst=e,e}return __extends(n,i),n.init=function(){var e=this;app.NetAgent.AddListener2Lobby("NotifyAccountUpdate",Laya.Handler.create(this,function(t){var i=t.update;i&&i.bag&&e.update_data(i.bag.update_items)},null,!1)),this.fetch()},n.fetch=function(){var t=this;this._item_map={},app.NetAgent.sendReq2Lobby("Lobby","fetchBagInfo",{},function(i,n){if(i||n.error)e.UIMgr.Inst.showNetReqError("fetchBagInfo",i,n);else{app.Log.log("背包信息："+JSON.stringify(n));var a=n.bag;if(a&&a.items)for(var r=0;r<a.items.length;r++){var o=a.items[r].item_id,s=a.items[r].stack,h=cfg.item_definition.item.get(o);h&&(t._item_map[o]={item_id:o,count:s,category:h.category})}}})},n.find_item=function(e){var t=this._item_map[e];return t?{item_id:t.item_id,category:t.category,count:t.count}:null},n.get_item_count=function(e){var t=this.find_item(e);if(t)return t.count;if(100001==e){var i=GameMgr.Inst.account_data.diamond;return GameMgr.inGooglePlay&&GameMgr.Inst.account_numerical_resource[101001]&&(i+=GameMgr.Inst.account_numerical_resource[101001]),GameMgr.inChina&&GameMgr.Inst.account_numerical_resource[101002]&&(i+=GameMgr.Inst.account_numerical_resource[101002]),i}return 100002==e?GameMgr.Inst.access_token.gold:0},n.find_items_by_category=function(e){var t=[];for(var i in this._item_map)this._item_map[i].category==e&&t.push({item_id:this._item_map[i].item_id,category:this._item_map[i].category,count:this._item_map[i].count});return t},n.update_data=function(e){for(r=0;r<e.length;r++){var t=e[r].item_id,i=e[r].stack;i>0?this._item_map.hasOwnProperty(t.toString())?this._item_map[t].count=i:this._item_map[t]={item_id:t,count:i,category:cfg.item_definition.item.get(t).category}:this._item_map.hasOwnProperty(t.toString())&&(this._item_map[t]=0,delete this._item_map[t])}this.Inst&&this.Inst.when_data_change();for(r=0;r<e.length;r++){t=e[r].item_id;if(this._item_listener.hasOwnProperty(t.toString()))for(var n=this._item_listener[t],a=0;a<n.length;a++)n[a].run()}for(var r=0;r<this._all_item_listener.length;r++)this._all_item_listener[r].run()},n.add_item_listener=function(e,t){this._item_listener.hasOwnProperty(e.toString())||(this._item_listener[e]=[]),this._item_listener[e].push(t)},n.remove_item_listener=function(e,t){var i=this._item_listener[e];if(i)for(var n=0;n<i.length;n++)if(i[n]===t){i[n]=i[i.length-1],i.pop();break}},n.add_all_item_listener=function(e){this._all_item_listener.push(e)},n.remove_all_item_listener=function(e){for(var t=this._all_item_listener,i=0;i<t.length;i++)if(t[i]===e){t[i]=t[t.length-1],t.pop();break}},n.prototype.onCreate=function(){var t=this;this.container_top=this.me.getChildByName("top"),this.container_top.getChildByName("btn_back").clickHandler=Laya.Handler.create(this,function(){t.locking||t.hide(Laya.Handler.create(t,function(){e.UI_Lobby.Inst.enable=!0}))},null,!1),this.container_content=this.me.getChildByName("content");for(var i=function(e){n.tabs.push(n.container_content.getChildByName("tabs").getChildAt(e)),n.tabs[e].clickHandler=Laya.Handler.create(n,function(){t.select_index!=e&&t.on_change_tab(e)},null,!1)},n=this,a=0;a<4;a++)i(a);this.page_item=new e.UI_Bag_PageItem(this.container_content.getChildByName("page_items")),this.page_gift=new e.UI_Bag_PageGift(this.container_content.getChildByName("page_gift")),this.page_desktop=new e.UI_Bag_PageDesktop(this.container_content.getChildByName("page_desktop"))},n.prototype.show=function(){var t=this;this.enable=!0,this.locking=!0,e.UIBase.anim_alpha_in(this.container_top,{y:-30},200),e.UIBase.anim_alpha_in(this.container_content,{y:30},200),Laya.timer.once(300,this,function(){t.locking=!1}),this.on_change_tab(0),game.Scene_Lobby.Inst.change_bg("indoor",!1)},n.prototype.hide=function(t){var i=this;this.locking=!0,e.UIBase.anim_alpha_out(this.container_top,{y:-30},200),e.UIBase.anim_alpha_out(this.container_content,{y:30},200),Laya.timer.once(300,this,function(){i.locking=!1,i.enable=!1,t&&t.run()})},n.prototype.onDisable=function(){this.page_desktop.me.visible&&this.page_desktop.close()},n.prototype.on_change_tab=function(e){this.select_index=e;for(var i=0;i<this.tabs.length;i++)this.tabs[i].skin=e==i?"myres/shop/tab_choose.png":"myres/shop/tab_unchoose.png",this.tabs[i].getChildAt(0).color=e==i?"#d9b263":"#8cb65f";switch(this.page_item.close(),this.page_gift.close(),this.page_desktop.close(),e){case 0:this.page_item.show(t.daoju);break;case 1:this.page_gift.show();break;case 2:this.page_item.show(t.character_view);break;case 3:this.page_desktop.show()}},n.prototype.when_data_change=function(){this.page_item.me.visible&&this.page_item.when_update_data(),this.page_gift.me.visible&&this.page_gift.when_update_data()},n._item_map={},n._item_listener={},n._all_item_listener=[],n.Inst=null,n}(e.UIBase);e.UI_Bag=i}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(t){function i(){var e=t.call(this,new ui.lobby.chang_nicknameUI)||this;return e.locking=!1,i.Inst=e,e}return __extends(i,t),i.prototype.onCreate=function(){var e=this;this.root=this.me.getChildByName("root"),this.container_input=this.root.getChildByName("container_input"),this.lb=this.container_input.getChildByName("lb"),this.input=this.container_input.getChildByName("txtinput"),this.input_no=this.container_input.getChildByName("no"),this.btn_confirm=this.container_input.getChildByName("btn_confirm"),this.btn_confirm.clickHandler=Laya.Handler.create(this,this.onBtnConfrim,null,!1),this.input.on("focus",this,function(){e.lb.visible=!1,e.input_no.visible=!1}),this.input.on("blur",this,function(){e.lb.visible=!e.input.text||""==e.input.text}),this.input.on("input",this,function(){if(e.input.text&&""!=e.input.text){for(var t=e.input.text,i=0,n=0,a=0;a<t.length;a++){if(t.charCodeAt(a)>255){if(i+2>16)break;i+=2}else{if(i+1>16)break;i+=1}n++}n!=t.length&&(e.input.text=t.substr(0,n))}}),this.container_no=this.root.getChildByName("container_no"),this.label_count=this.container_no.getChildByName("count"),this.root.getChildByName("btn_close").clickHandler=Laya.Handler.create(this,function(){e.close()},null,!1)},i.prototype.show=function(){var t=this,i=Date.now()/1e3,n=30-Math.floor((i-GameMgr.Inst.last_mod_name_time)/3600/24);if(n>0)this.container_no.visible=!0,this.label_count.text=n.toString(),this.container_input.visible=!1;else{this.container_input.visible=!0,this.container_no.visible=!1,this.input_no.visible=!1,this.lb.visible=!0,this.input.text="";var a=this.container_input.getChildByName("price"),r=cfg.item_definition.item.get(302013);game.LoadMgr.setImgSkin(a.getChildByName("icon"),r.icon);var o=a.getChildByName("count");o.text="x1",e.UI_Bag.get_item_count(302013)>0?(o.color="#00ff00",game.Tools.setGrayDisable(this.btn_confirm,!1)):(o.color="#ff0000",game.Tools.setGrayDisable(this.btn_confirm,!0)),game.Tools.child_align_center(a,[10,10,10])}this.enable=!0,this.locking=!0,e.UIBase.anim_pop_out(this.root,Laya.Handler.create(this,function(){t.locking=!1}))},i.prototype.onBtnConfrim=function(){var t=this;if(!this.locking&&""!=this.input.text){var i=this.input.text;e.UI_Entrance.Accountforbidden(i)?this.input_no.visible=!0:(game.Tools.setGrayDisable(this.btn_confirm,!0),app.NetAgent.sendReq2Lobby("Lobby","modifyNickname",{nickname:i,use_item_id:302013},function(n,a){n||a.error?(e.UIMgr.Inst.showNetReqError("modifyNickname",n,a),game.Tools.setGrayDisable(t.btn_confirm,!1)):(GameMgr.Inst.account_data.nickname=i,GameMgr.Inst.last_mod_name_time=Date.now()/1e3,e.UI_PlayerInfo.Inst.refreshBaseInfo(),e.UI_Lobby.Inst.top.refresh(),t.close())}))}},i.prototype.close=function(){var t=this;this.locking=!0,e.UIBase.anim_pop_hide(this.root,Laya.Handler.create(this,function(){t.locking=!1,t.enable=!1}))},i}(e.UIBase);e.UI_Change_Nickname=t}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(t){function i(){var e=t.call(this,new ui.both_ui.character_star_upUI)||this;return e.ress=["myres/star_up/levelup.png","myres/star_up/bg.jpg","myres/star_up/bang_heart.png"],e.effect_path="scene/scene_shengjiban.ls",i.Inst=e,Laya.loader.load(e.ress,null,null,"image"),e}return __extends(i,t),i.prototype.onCreate=function(){var t=this;this.blackbg=this.me.getChildByName("blackbg"),this.btn_bigclose=this.me.getChildByName("bigclose"),this.btn_bigclose.clickHandler=Laya.Handler.create(this,function(){t.close()},null,!1),this.root=this.me.getChildByName("root"),this.container_avatar=this.root.getChildByName("container_avatar"),this.avatar0=new e.UI_Character_Skin(this.container_avatar.getChildByName("avatar0")),this.avatar1=new e.UI_Character_Skin(this.container_avatar.getChildByName("avatar1")),this.avatar1.me.visible=!1,this.bg=this.root.getChildByName("bg"),this.img_word=this.root.getChildByName("container_hearts").getChildByName("img_word"),this.container_hearts=this.root.getChildByName("container_hearts"),this.hearts=[];for(i=0;i<5;i++)this.hearts.push(this.container_hearts.getChildByName("heart"+i));this.bang=this.container_hearts.getChildByName("bang"),this.bang_imgs=[];for(var i=0;i<5;i++)this.bang_imgs.push(this.bang.getChildAt(i));this.btn_close=this.root.getChildByName("btn_close"),this.btn_close.clickHandler=Laya.Handler.create(this,function(){t.close()},null,!1),this.block_chat=new e.UI_Character_Chat(this.me.getChildByName("chat")),this.container_effect=this.me.getChildByName("container_effect")},i.prototype.show=function(e,t){var i=this;this.reset(),this.enable=!0,this.chara_info=e,this.back_func=t;var n=cfg.item_definition.skin.get(this.chara_info.skin);this.avatar1.me.visible=!1,n&&this.avatar0.setSkin(this.chara_info.skin,"full");for(var a=0;a<this.hearts.length;a++)if(a>=5)this.hearts[a].visible=!1,this.bang_imgs[a].visible=!1;else{this.hearts[a].visible=!0,this.hearts[a].x=314+107*a-214,this.bang_imgs[a].visible=!0;var r=this.hearts[a].getChildByName("v").mask;a<this.chara_info.level?r.scaleY=1:r.scaleY=0,e.is_upgraded?this.hearts[a].getChildByName("v").getChildByName("full").skin="myres/bothui/heart_gold.png":this.hearts[a].getChildByName("v").getChildByName("full").skin="myres/bothui/bf_heart.png"}if(this.bang.visible=!1,this.img_word.visible=!0,this.container_hearts.visible=!0,this.me.in.play(0,!1),this.block_chat.me.visible=!1,this.btn_bigclose.visible=!1,view.AudioMgr.refresh_music_volume(!0),Laya.loader.create(this.effect_path),this.chara_info.is_upgraded){var o=cfg.item_definition.character.get(this.chara_info.charid).full_fetter_skin;game.LoadMgr.loadResImage([cfg.item_definition.skin.get(o).path+"/full.png"])}Laya.timer.once(1400,this,function(){i.bang.visible=!0,i.me.bang.play(0,!1),Laya.timer.once(1550,i,function(){i.bang.visible=!1,i.chara_info.is_upgraded?i.change_full_fetter_skin():i.when_over()}),i.chara_info.is_upgraded||Laya.timer.once(500,i,function(){var e=Laya.loader.getRes(i.effect_path);e&&(i.container_effect.addChild(e),e.visible=!0),view.AudioMgr.PlayAudio(113)})})},i.prototype.reset=function(){this.bg.skin="",this.img_word.skin="",this.bg.skin="myres/star_up/bg.jpg",this.img_word.skin="myres/star_up/levelup.png";for(var e=0;e<this.bang_imgs.length;e++)this.bang_imgs[e].skin="",this.bang_imgs[e].skin="myres/star_up/bang_heart.png"},i.prototype.change_full_fetter_skin=function(){var e=this;if(this.enable){var t=cfg.item_definition.character.get(this.chara_info.charid);if(t){cfg.item_definition.skin.get(t.full_fetter_skin)&&(this.avatar1.setSkin(this.chara_info.skin,"full"),this.avatar1.me.visible=!0,this.avatar1.me.filters=[new Laya.ColorFilter([0,0,0,0,255,0,0,0,0,255,0,0,0,0,255,0,0,0,1,0])],this.avatar1.me.alpha=0,Laya.Tween.to(this.avatar1.me,{alpha:1},1e3,null,Laya.Handler.create(this,function(){e.enable&&(Laya.timer.once(1e3,e,function(){e.avatar0.setSkin(t.full_fetter_skin,"full"),e.avatar1.me.visible=!1,Laya.timer.once(500,e,function(){e.when_over()})}),Laya.timer.once(1e3,e,function(){var t=Laya.loader.getRes(e.effect_path);t&&(e.container_effect.addChild(t),t.visible=!0),view.AudioMgr.PlayAudio(113)}))})))}}},i.prototype.when_over=function(){var e=this,t="";if(!this.chara_info.is_upgraded)switch(this.chara_info.level){case 1:t="";break;case 2:t="lobby_levelup1";break;case 3:t="lobby_levelup2";break;case 4:t="lobby_levelup3";break;case 5:t="lobby_levelmax"}var i=cfg.item_definition.character.get(this.chara_info.charid),n=cfg.voice.sound.getGroup(i.sound),a=0;if(""!=t){for(var r="",o="",s=0;s<n.length;s++)if(n[s].type==t){r=n[s].words,o=n[s].path,a=n[s].time_length;break}this.block_chat.show(r),this.sound_channel=view.AudioMgr.PlaySound(o,i.sound_volume),this.img_word.visible=!1,this.container_hearts.visible=!1}Laya.timer.once(a+2e3,this,function(){e.btn_bigclose.visible=!0})},i.prototype.onDisable=function(){view.AudioMgr.refresh_music_volume(!1);for(t=0;t<this.ress.length;t++)Laya.loader.clearTextureRes(this.ress[t]);if(this.avatar0.clear(),this.avatar1.clear(),this.chara_info.is_upgraded)for(var t=0;t<e.UI_Sushe.characters.length;t++)if(e.UI_Sushe.characters[t].charid==this.chara_info.charid){e.UI_Sushe.characters[t].level=5,e.UI_Sushe.characters[t].exp=0,e.UI_Sushe.characters[t].skin=cfg.item_definition.character.get(this.chara_info.charid).full_fetter_skin,e.UI_Sushe.main_character_id==this.chara_info.charid&&(GameMgr.Inst.account_data.avatar_id=e.UI_Sushe.characters[t].skin);break}this.chara_info=null,Laya.timer.clearAll(this),this.sound_channel&&(this.sound_channel.stop(),Laya.SoundManager.removeChannel(this.sound_channel),this.sound_channel=null);var i=Laya.loader.getRes(this.effect_path);i&&i.destroy(!0)},i.prototype.close=function(){this.enable=!1,this.back_func&&this.back_func.run()},i.Inst=null,i}(e.UIBase);e.UI_Character_star_up=t}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(e){function t(){var t=e.call(this,new ui.mj.chipenghuUI)||this;return t.container_Detail=null,t.btn_cancel=null,t.btn_detail_back=null,t.op_btns=new Object,t}return __extends(t,e),t.prototype.onCreate=function(){var e=this.me.getChildByName("container_btns");this.container_btns=e;for(i=0;i<this.container_btns.numChildren;i++){var t=this.container_btns.getChildAt(i);this.op_btns[t.name]=t,t.visible=!1,t.clickHandler=new Laya.Handler(this,this.onClickOpBtn,[t.name])}this.container_Detail=this.me.getChildByName("container_detail"),this.container_Detail.visible=!1;for(var i=0;i<6;i++){var n=this.container_Detail.getChildByName("container_chooses").getChildByName("c"+i);n.visible=!1,n.clickHandler=laya.utils.Handler.create(this,this.onClickDetail,[i],!1)}this.btn_detail_back=this.container_Detail.getChildByName("btn_back"),this.btn_detail_back.clickHandler=new Laya.Handler(this,this.onDetailBack,null,!1),this.btn_cancel=this.me.getChildByName("btn_cancel"),this.btn_cancel.visible=!1},t.prototype.show=function(e){},t.prototype.onClickOpBtn=function(e){},t.prototype.onClickDetail=function(e){},t.prototype.onDetailBack=function(){},t.prototype.showOp=function(e){this.container_Detail.visible=!1,this.container_btns.visible=!0,this.btn_cancel.visible=!1;for(var t=this.container_btns.width,i=0,n=0,a=this.container_btns.numChildren-1;a>=0;a--){for(var r=!1,o=this.container_btns.getChildAt(a),s=0;s<e.length;s++)if(e[s]==o.name){r=!0;break}r?(o.visible=!0,o.x=t-o.width,o.y=i,t-=o.width+0,3==++n&&(i-=180,t=this.container_btns.width,n=0)):o.visible=!1}Laya.Tween.from(this.container_btns,{x:940,alpha:0},160)},t.prototype.showDetail=function(e,t){this.container_btns.visible=!1,this.btn_cancel.visible=!1;for(var i=this.container_Detail.getChildByName("container_title"),n=(i.getChildByName("lab_title"),this.container_Detail.getChildByName("container_chooses")),a=0,r=n.getChildByName("c0").getChildByName("img0").width,o=.5*r,s="myres2/mjp/"+GameMgr.Inst.mjp_view+"/ui/",h=0;h<6;h++){var l=n.getChildByName("c"+h);if(h<t.length){for(var c=t[h].split("|"),p=0;p<4;p++){var u=l.getChildByName("img"+p);p<c.length?(u.skin=s+c[p]+".png",u.x=p*r,u.y=0,u.visible=!0):u.visible=!1}l.width=c.length*r,0!=h&&(a+=o),l.x=a,a+=l.width,l.y=-23,l.visible=!0}else l.visible=!1}n.width=a,this.container_Detail.width=a+240,i.x=.5*this.container_Detail.width,n.x=120,this.btn_detail_back.x=this.container_Detail.width-56,this.container_Detail.visible=!0,this.container_Detail.x=960-this.container_Detail.width/2},t}(e.UIBase);e.UI_PlayerOperation=t}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(t){function i(){var e=t.call(this)||this;return e._data=new Object,e.choosed_op=mjcore.E_PlayOperation.eat,e._oplist=[],i.Inst=e,e}return __extends(i,t),i.prototype.show=function(e){for(var t=[],i=0;i<e.length;i++)switch(e[i].type){case mjcore.E_PlayOperation.eat:t.push("btn_chi"),this._data.chi=e[i].combination;break;case mjcore.E_PlayOperation.peng:t.push("btn_peng"),this._data.peng=e[i].combination;break;case mjcore.E_PlayOperation.ming_gang:t.push("btn_gang");break;case mjcore.E_PlayOperation.rong:t.push("btn_hu")}t.push("btn_cancel"),this._oplist=t,this.showOp(t),this.enable=!0,view.DesktopMgr.Inst.ShowChiPengEffect(),view.AudioMgr.PlayAudio(202)},i.prototype.onClickOpBtn=function(e){if(view.DesktopMgr.Inst.mode==view.EMJMode.play)switch(view.AudioMgr.PlayAudio(101),e){case"btn_chi":this.onBtn_Chi();break;case"btn_peng":this.onBtn_Peng();break;case"btn_gang":this.onBtn_Gang();break;case"btn_hu":this.onBtn_Hu();break;case"btn_cancel":this.onBtn_Cancel()}},i.prototype.onClickDetail=function(e){view.DesktopMgr.Inst.mode==view.EMJMode.play&&(view.AudioMgr.PlayAudio(101),app.NetAgent.sendReq2MJ("FastTest","inputChiPengGang",{type:this.choosed_op,index:e},function(e,t){}),view.DesktopMgr.Inst.WhenOperationEnd())},i.prototype.onDetailBack=function(){this.showOp(this._oplist),view.AudioMgr.PlayAudio(101)},i.prototype.onBtn_Chi=function(){this._data.chi.length>1?(this.choosed_op=mjcore.E_PlayOperation.eat,this.showDetail("请选择要吃的牌",this._data.chi)):(app.NetAgent.sendReq2MJ("FastTest","inputChiPengGang",{type:mjcore.E_PlayOperation.eat,index:0,timeuse:e.UI_DesktopInfo.Inst._timecd.timeuse},function(e,t){}),view.DesktopMgr.Inst.WhenOperationEnd())},i.prototype.onBtn_Peng=function(){this._data.peng.length>1?(this.choosed_op=mjcore.E_PlayOperation.peng,this.showDetail("请选择要碰的牌",this._data.peng)):(app.NetAgent.sendReq2MJ("FastTest","inputChiPengGang",{type:mjcore.E_PlayOperation.peng,index:0,timeuse:e.UI_DesktopInfo.Inst._timecd.timeuse},function(e,t){}),view.DesktopMgr.Inst.WhenOperationEnd())},i.prototype.onBtn_Gang=function(){app.NetAgent.sendReq2MJ("FastTest","inputChiPengGang",{type:mjcore.E_PlayOperation.ming_gang,index:0,timeuse:e.UI_DesktopInfo.Inst._timecd.timeuse},function(e,t){}),view.DesktopMgr.Inst.WhenOperationEnd()},i.prototype.onBtn_Hu=function(){app.NetAgent.sendReq2MJ("FastTest","inputChiPengGang",{type:mjcore.E_PlayOperation.rong,index:0,timeuse:e.UI_DesktopInfo.Inst._timecd.timeuse},function(e,t){}),view.DesktopMgr.Inst.WhenOperationEnd()},i.prototype.onBtn_Cancel=function(){app.NetAgent.sendReq2MJ("FastTest","inputChiPengGang",{cancel_operation:!0,timeuse:e.UI_DesktopInfo.Inst._timecd.timeuse},function(e,t){}),view.DesktopMgr.Inst.WhenOperationEnd()},i.prototype.onDisable=function(){view.DesktopMgr.Inst.CloseChiPngEffect(),Laya.timer.clearAll(this)},i.prototype.onDoubleClick=function(){this.onBtn_Cancel()},i.Inst=null,i}(e.UI_PlayerOperation);e.UI_ChiPengHu=t}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(t){function i(){return t.call(this,new ui.entrance.chooseserverUI)||this}return __extends(i,t),i.show=function(t){if(!this._inited)if(this._complete=t,this._inited=!0,this._ips=GameMgr.config_data.ip,1==this._ips.length)this._linkLobby(0);else{var n=new i;e.UIMgr.Inst.AddLobbyUI(n),Laya.timer.frameOnce(5,this,function(){n._show()})}},i._linkLobby=function(e){var t=this._ips[e];game.LobbyNetMgr.gateway_name=t.name,game.LobbyNetMgr.gateway_url=(GameMgr.inHttps?"https://":"http://")+t.url,game.LobbyNetMgr.Inst.OpenConnect(null),this._complete.run()},i.do_guanzhan=function(){var e=0,t=[],i=function(e){var t=net.MessageWrapper.decodeMessage(e.action_data);return{timestamp:e.timestamp,category:e.action_category,name:t.$type.name,data:t}},n=function(){if(e>42)console.log(JSON.stringify(t));else{var a=new Laya.HttpRequest;a.once(Laya.Event.COMPLETE,this,function(a){t.push({index:e,split:"==================================================="});var r=new Laya.Byte;r.writeArrayBuffer(a);for(var o=net.MessageWrapper.decodeMessage(r.getUint8Array(0,r.length)),s=0;s<o.actions.length;s++)t.push(i(o.actions[s]));e++,n()}),a.once(Laya.Event.ERROR,this,function(e){});a.send("guanzhan/"+e,"","get","arraybuffer",[])}};n()},i.prototype.onCreate=function(){var e=this;this.root=this.me.getChildByName("root"),this.scorllview=this.root.getChildByName("lst").scriptMap["capsui.CScrollView"],this.scorllview.init_scrollview(Laya.Handler.create(this,function(t){var n=t.index,a=t.container;a.label=i._ips[n].name,a.clickHandler=Laya.Handler.create(e,function(){i._linkLobby(n),e.enable=!1,e.me.destroy(!0)},null,!1)},null,!1))},i.prototype._show=function(){this.enable=!0,this.scorllview.reset(),this.scorllview.addItem(i._ips.length)},i._ips=[],i._inited=!1,i._complete=null,i}(e.UIBase);e.UI_ChooseServer=t}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(t){function i(){var e=t.call(this,new ui.common.closeappUI)||this;return e.locking=!1,i.Inst=e,e}return __extends(i,t),i.prototype.onCreate=function(){var t=this;this.root=this.me.getChildByName("root"),this.root.getChildByName("btn_confirm").clickHandler=Laya.Handler.create(this,function(){t.locking||(t.close(),Laya.Browser.window.conch&&Laya.Browser.window.conch.exit&&Laya.Browser.window.conch.exit())},null,!1),this.root.getChildByName("btn_cancel").clickHandler=Laya.Handler.create(this,function(){t.locking||t.close()},null,!1),this.root.getChildByName("btn_cancel").filters=[new Laya.ColorFilter([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0])],this.desc=this.root.getChildByName("desc"),this.desc.text=cfg.str.str.get(22).desc,this.locking=!1,GameMgr.inConch&&Laya.Browser.window.conch.setOnBackPressedFunction&&Laya.Browser.window.conch.setOnBackPressedFunction(function(){t.locking||e.UI_CloseApp.Inst.show()})},i.prototype.show=function(){var t=this;this.locking=!0,this.enable=!0,e.UIBase.anim_pop_out(this.root,Laya.Handler.create(this,function(){t.locking=!1}))},i.prototype.close=function(){var t=this;this.locking=!0,e.UIBase.anim_pop_hide(this.root,Laya.Handler.create(this,function(){t.locking=!1,t.enable=!1}))},i.Inst=null,i}(e.UIBase);e.UI_CloseApp=t}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(e){function t(){var i=e.call(this,new ui.common.commonUI)||this;return i.label_net_lobby=null,i.label_net_mj=null,i.label_fps=null,i._fps_count=0,i._last_time=0,t.Inst=i,i}return __extends(t,e),t.prototype.onCreate=function(){var e=this.me.getChildByName("container_net");this.label_net_lobby=e.getChildByName("lobby"),this.label_net_mj=e.getChildByName("mj"),this.label_fps=e.getChildByName("fps"),this.label_net_lobby.text="",this.label_net_mj.text="",this.label_fps.text=""},t.prototype.onEnable=function(){this._fps_count=0,this._last_time=Laya.timer.currTimer,game.LobbyNetMgr.Inst.refreshCommonShow()},t.prototype.update=function(){this._fps_count++;var e=Laya.timer.currTimer-this._last_time;e>=500&&(this.label_fps.text="fps:"+Math.floor(this._fps_count/e*1e3),this._fps_count=0,this._last_time=Laya.timer.currTimer)},t.Inst=null,t}(e.UIBase);e.UI_Common=t}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(){function e(e){var t=this;this._during_drag=!1,this.me=e,this.bar=this.me.getChildByName("val"),this.point=this.me.getChildByName("point"),this.me.on("mousedown",this,function(){t._during_drag=!0,t.rate=t.me.mouseX/t.me.width}),this.me.on("mousemove",this,function(){t._during_drag&&(t.rate=t.me.mouseX/t.me.width)}),this.me.on("mouseout",this,function(){t._during_drag=!1}),this.me.on("mouseup",this,function(){t._during_drag=!1})}return Object.defineProperty(e.prototype,"rate",{get:function(){return this._rate},set:function(e){this._rate=e,this._rate<0?this._rate=0:this._rate>1&&(this._rate=1),this.me.event("change"),this.bar.width=this._rate*this.me.width,this.point.x=this._rate*this.me.width},enumerable:!0,configurable:!0}),e.prototype.initset=function(e){this._rate=e,this._rate<0?this._rate=0:this._rate>1&&(this._rate=1),this.bar.width=this._rate*this.me.width,this.point.x=this._rate*this.me.width},e}(),i=(function(){}(),function(){}(),function(i){function n(){var e=i.call(this,new ui.both_ui.configUI)||this;return e.music_controll=null,e.audio_controll=null,e.sound_controll=null,e.fps_controll=null,e.click1_controll=null,e.click2_controll=null,e.click3_controll=null,e.comment_0_controll=null,e.comment_1_controll=null,e.comment_2_controll=null,e.locking=!1,e.btn_restart=null,e.btn_save=null,e._scrollbar=null,e._scrollpoint=null,e._drag_scroll=!1,n.Inst=e,e}return __extends(n,i),n.prototype.onCreate=function(){var i=this;this.root=this.me.getChildByName("root"),this.panel=this.root.getChildByName("panel"),this.panel.vScrollBar.visible=!1,this._scrollbar=this.root.getChildByName("scrollbar"),this._scrollpoint=this._scrollbar.getChildByName("scrollpoint"),this._scrollbar&&(this._scrollbar.on("mousedown",this,function(){i._drag_scroll=!0,i.panel.vScrollBar.stopScroll(),i.panel.vScrollBar.value=i._scrollbar.mouseY/i._scrollbar.height*i.panel.vScrollBar.max}),this._scrollbar.on("mousemove",this,function(){i._drag_scroll&&(i.panel.vScrollBar.stopScroll(),i.panel.vScrollBar.value=i._scrollbar.mouseY/i._scrollbar.height*i.panel.vScrollBar.max)}),this._scrollbar.on("mouseup",this,function(){i._drag_scroll=!1}),this._scrollbar.on("mouseout",this,function(){i._drag_scroll=!1}),this.panel.vScrollBar.on("change",this,function(){i._scrollpoint.y=i._scrollbar.height*i.panel.vScrollBar.value/i.panel.vScrollBar.max})),this.music_controll={slider:new t(this.panel.getChildByName("audio").getChildByName("music").getChildByName("slider")),btn_mute:this.panel.getChildByName("audio").getChildByName("music").getChildByName("checkbox").getChildByName("btn"),check:this.panel.getChildByName("audio").getChildByName("music").getChildByName("checkbox").getChildByName("checkbox")},this.audio_controll={slider:new t(this.panel.getChildByName("audio").getChildByName("audio").getChildByName("slider")),btn_mute:this.panel.getChildByName("audio").getChildByName("audio").getChildByName("checkbox").getChildByName("btn"),check:this.panel.getChildByName("audio").getChildByName("audio").getChildByName("checkbox").getChildByName("checkbox")},this.sound_controll={slider:new t(this.panel.getChildByName("audio").getChildByName("sound").getChildByName("slider")),btn_mute:this.panel.getChildByName("audio").getChildByName("sound").getChildByName("checkbox").getChildByName("btn"),check:this.panel.getChildByName("audio").getChildByName("sound").getChildByName("checkbox").getChildByName("checkbox")},this.click1_controll={btn:this.panel.getChildByName("prefer").getChildByName("click1").getChildByName("checkbox").getChildByName("btn"),check:this.panel.getChildByName("prefer").getChildByName("click1").getChildByName("checkbox").getChildByName("checkbox")},this.click2_controll={btn:this.panel.getChildByName("prefer").getChildByName("click2").getChildByName("checkbox").getChildByName("btn"),check:this.panel.getChildByName("prefer").getChildByName("click2").getChildByName("checkbox").getChildByName("checkbox")},this.click3_controll={btn:this.panel.getChildByName("prefer").getChildByName("click3").getChildByName("checkbox").getChildByName("btn"),check:this.panel.getChildByName("prefer").getChildByName("click3").getChildByName("checkbox").getChildByName("checkbox")},this.comment_0_controll={btn:this.panel.getChildByName("comment").getChildByName("click1").getChildByName("checkbox").getChildByName("btn"),check:this.panel.getChildByName("comment").getChildByName("click1").getChildByName("checkbox").getChildByName("checkbox")},this.comment_1_controll={btn:this.panel.getChildByName("comment").getChildByName("click2").getChildByName("checkbox").getChildByName("btn"),check:this.panel.getChildByName("comment").getChildByName("click2").getChildByName("checkbox").getChildByName("checkbox")},this.comment_2_controll={btn:this.panel.getChildByName("comment").getChildByName("click3").getChildByName("checkbox").getChildByName("btn"),check:this.panel.getChildByName("comment").getChildByName("click3").getChildByName("checkbox").getChildByName("checkbox")},this.fps_controll={btn:this.panel.getChildByName("other").getChildByName("fps").getChildByName("checkbox").getChildByName("btn"),check:this.panel.getChildByName("other").getChildByName("fps").getChildByName("checkbox").getChildByName("checkbox")},this.music_controll.btn_mute.clickHandler=Laya.Handler.create(this,function(){i.locking||(view.AudioMgr.musicMuted=!view.AudioMgr.musicMuted,i.refreshMusicMute())},null,!1),this.audio_controll.btn_mute.clickHandler=Laya.Handler.create(this,function(){i.locking||(view.AudioMgr.audioMuted=!view.AudioMgr.audioMuted,i.refreshAudioMute())},null,!1),this.sound_controll.btn_mute.clickHandler=Laya.Handler.create(this,function(){i.locking||(view.AudioMgr.soundMuted=!view.AudioMgr.soundMuted,i.refreshSoundMute())},null,!1),this.music_controll.slider.me.on("change",this,function(){i.locking||(view.AudioMgr.musicVolume=i.music_controll.slider.rate,view.AudioMgr.musicMuted=!1,i.refreshMusicMute())}),this.audio_controll.slider.me.on("change",this,function(){i.locking||(view.AudioMgr.audioVolume=i.audio_controll.slider.rate,view.AudioMgr.audioMuted=!1,i.refreshAudioMute())}),this.sound_controll.slider.me.on("change",this,function(){i.locking||(view.AudioMgr.soundVolume=i.sound_controll.slider.rate,view.AudioMgr.soundMuted=!1,i.refreshSoundMute())}),Laya.Browser.onPC&&!GameMgr.inConch||(this.panel.getChildByName("prefer").getChildByName("click1").visible=!1,this.panel.getChildByName("prefer").getChildByName("click2").visible=!1),this.click1_controll.btn.clickHandler=Laya.Handler.create(this,function(){i.click1_controll.check.visible=!0,i.click2_controll.check.visible=!1,view.DesktopMgr.click_prefer=0,Laya.LocalStorage.setItem("click_prefer","0")},null,!1),this.click2_controll.btn.clickHandler=Laya.Handler.create(this,function(){i.click2_controll.check.visible=!0,i.click1_controll.check.visible=!1,view.DesktopMgr.click_prefer=1,Laya.LocalStorage.setItem("click_prefer","1")},null,!1),this.click3_controll.btn.clickHandler=Laya.Handler.create(this,function(){view.DesktopMgr.double_click_pass^=1,i.click3_controll.check.visible=1==view.DesktopMgr.double_click_pass,Laya.LocalStorage.setItem("double_click_pass",view.DesktopMgr.double_click_pass.toString())},null,!1),this.comment_0_controll.btn.clickHandler=Laya.Handler.create(this,function(){i.comment_0_controll.check.visible||(i.comment_0_controll.check.visible=!0,i.comment_1_controll.check.visible=!1,i.comment_2_controll.check.visible=!1,app.NetAgent.sendReq2Lobby("Lobby","updateCommentSetting",{comment_allow:0},function(t,n){t||n.error?(e.UIMgr.Inst.showNetReqError("updateCommentSetting",t,n),i.comment_0_controll.check.visible=!1):GameMgr.Inst.comment_allow=0}))},null,!1),this.comment_1_controll.btn.clickHandler=Laya.Handler.create(this,function(){i.comment_1_controll.check.visible||(i.comment_0_controll.check.visible=!1,i.comment_1_controll.check.visible=!0,i.comment_2_controll.check.visible=!1,app.NetAgent.sendReq2Lobby("Lobby","updateCommentSetting",{comment_allow:1},function(t,n){t||n.error?(e.UIMgr.Inst.showNetReqError("updateCommentSetting",t,n),i.comment_1_controll.check.visible=!1):GameMgr.Inst.comment_allow=1}))},null,!1),this.comment_2_controll.btn.clickHandler=Laya.Handler.create(this,function(){i.comment_2_controll.check.visible||(i.comment_0_controll.check.visible=!1,i.comment_1_controll.check.visible=!1,i.comment_2_controll.check.visible=!0,app.NetAgent.sendReq2Lobby("Lobby","updateCommentSetting",{comment_allow:2},function(t,n){t||n.error?(e.UIMgr.Inst.showNetReqError("updateCommentSetting",t,n),i.comment_2_controll.check.visible=!1):GameMgr.Inst.comment_allow=2}))},null,!1),this.fps_controll.btn.clickHandler=Laya.Handler.create(this,function(){if(!i.locking){var e=Laya.LocalStorage.getItem("fpsmode");e="slow"==e?"fast":"slow",i.btn_restart.visible=!0,Laya.LocalStorage.setItem("fpsmode",e),i.refreshFps()}},null,!1),this.root.getChildByName("btn_close").clickHandler=Laya.Handler.create(this,function(){i.locking||i.hide()},null,!1),this.btn_restart=this.panel.getChildByName("btn_restart"),this.btn_restart.visible=!1,this.btn_restart.clickHandler=Laya.Handler.create(this,function(){if(Laya.Browser.window.conch){Laya.PlatformClass.createClass("layaair.majsoul.mjmgr").call("restart")}else Laya.Browser.window.location.href=GameMgr.Inst.link_url},null,!1),this.panel.getChildByName("btn_course").clickHandler=Laya.Handler.create(this,function(){i.hide(),e.UI_Course.Inst.show()},null,!1),this.panel.getChildByName("btn_rule").clickHandler=Laya.Handler.create(this,function(){i.hide(),e.UI_Rules.Inst.show()},null,!1),this.panel.getChildByName("btn_gift").clickHandler=Laya.Handler.create(this,function(){i.hide(),e.UI_Giftcode.Inst.show()},null,!1),this.root.getChildByName("btn_logout").clickHandler=Laya.Handler.create(this,function(){if(app.NetAgent.sendReq2Lobby("Lobby","logout",{},function(){}),Laya.LocalStorage.setItem("_pre_sociotype",""),Laya.Browser.window.conch){Laya.PlatformClass.createClass("layaair.majsoul.mjmgr").call("restart")}else Laya.Browser.window.location.href=GameMgr.Inst.link_url},null,!1);var n=this.root.getChildByName("version");n.text="当前版本："+game.ResourceVersion.version,n.visible=!0},n.prototype.refreshMusicMute=function(){this.music_controll.check.visible=view.AudioMgr.musicMuted,this.music_controll.slider.bar.gray=view.AudioMgr.musicMuted,this.music_controll.slider.point.gray=view.AudioMgr.musicMuted},n.prototype.refreshAudioMute=function(){this.audio_controll.check.visible=view.AudioMgr.audioMuted,this.audio_controll.slider.bar.gray=view.AudioMgr.audioMuted,this.audio_controll.slider.point.gray=view.AudioMgr.audioMuted},n.prototype.refreshSoundMute=function(){this.sound_controll.check.visible=view.AudioMgr.soundMuted,this.sound_controll.slider.bar.gray=view.AudioMgr.soundMuted,this.sound_controll.slider.point.gray=view.AudioMgr.soundMuted},n.prototype.refreshFps=function(){var e=Laya.LocalStorage.getItem("fpsmode");this.fps_controll.check.visible="slow"!=e},n.prototype.show=function(){var t=this;GameMgr.Inst.BehavioralStatistics(17),this.audio_controll.slider.initset(view.AudioMgr.audioVolume),this.music_controll.slider.initset(view.AudioMgr.musicVolume),this.sound_controll.slider.initset(view.AudioMgr.soundVolume),this.refreshMusicMute(),this.refreshAudioMute(),this.refreshSoundMute(),this.refreshFps(),this.locking=!0,this.enable=!0,this.click1_controll.check.visible=0==view.DesktopMgr.click_prefer,this.click2_controll.check.visible=0!=view.DesktopMgr.click_prefer,this.click3_controll.check.visible=1==view.DesktopMgr.double_click_pass,this.comment_0_controll.check.visible=0==GameMgr.Inst.comment_allow,this.comment_1_controll.check.visible=1==GameMgr.Inst.comment_allow,this.comment_2_controll.check.visible=2==GameMgr.Inst.comment_allow,this.panel.vScrollBar.value=0,this._drag_scroll=!1,this._scrollpoint.y=0;var i=this.root.getChildByName("panel").getChildByName("renzheng"),n=i.getChildByName("info");if(e.UI_ShiMingRenZheng.renzhenged)n.text="实名认证：已认证",n.color="#72f882",i.getChildByName("icon").visible=!0,i.getChildByName("btn").visible=!1;else{n.text="实名认证：尚未认证",n.color="#ff5757",i.getChildByName("icon").visible=!1;var a=i.getChildByName("btn");a.visible=!0,a.clickHandler=Laya.Handler.create(this,function(){t.locking||(t.hide(),e.UI_ShiMingRenZheng.Inst.show())},null,!1)}i.visible=!GameMgr.Inst.player_in_haiwai,e.UIBase.anim_pop_out(this.root,Laya.Handler.create(this,function(){t.locking=!1}))},n.prototype.hide=function(){var t=this;this.locking=!0,e.UIBase.anim_pop_hide(this.root,Laya.Handler.create(this,function(){t.locking=!1,t.enable=!1}))},n.Inst=null,n}(e.UIBase));e.UI_Config=i}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(e){function t(){var i=e.call(this,new ui.both_ui.courseUI)||this;return i.locking=!1,i.loadover=[],i.urls=["course/course0.png","course/course1.png","course/course2.png","course/course3.png","course/course4.png","course/course5.png","course/course6.png","course/course7.png","course/course8.png"],i.pageindex=0,t.Inst=i,i}return __extends(t,e),t.prototype.onCreate=function(){var e=this;this.root=this.me.getChildByName("root"),this.page=this.root.getChildByName("page"),this.btn_left=this.root.getChildByName("left"),this.btn_right=this.root.getChildByName("right"),this.btn_close=this.root.getChildByName("btn_close"),this.loading=this.root.getChildByName("loading"),this.btn_close.clickHandler=Laya.Handler.create(this,function(){e.locking||e.close()},null,!1),this.btn_left.clickHandler=Laya.Handler.create(this,function(){e.locking||0!=e.pageindex&&e.showPage(e.pageindex-1)},null,!1),this.btn_right.clickHandler=Laya.Handler.create(this,function(){e.locking||e.pageindex!=e.urls.length-1&&e.showPage(e.pageindex+1)},null,!1);for(var t=0;t<this.urls.length;t++)this.loadover.push(!1)},t.prototype.show=function(e){var t=this;void 0===e&&(e=null),this.enable=!0,this.func_complete=e,this.locking=!0,this.root.alpha=0,Laya.Tween.to(this.root,{alpha:1},120,null,Laya.Handler.create(this,function(){t.locking=!1})),this.showPage(0);for(var i=function(e){n.loadover.push(!1),Laya.loader.load(n.urls[e],Laya.Handler.create(n,function(){Laya.timer.frameOnce(3,t,function(){t.loadover[e]=!0,t.enable&&t.pageindex==e&&(t.loading.visible=!1,t.page.source=Laya.loader.getRes(t.urls[e]),t.page.visible=!0),t.enable||Laya.loader.clearTextureRes(t.urls[e])})}))},n=this,a=0;a<this.urls.length;a++)i(a)},t.prototype.close=function(){var e=this;this.locking=!0,this.root.alpha=1,Laya.Tween.to(this.root,{alpha:0},120,null,Laya.Handler.create(this,function(){e.locking=!1,e.enable=!1;for(var t=0;t<e.urls.length;t++)e.loadover[t]&&Laya.loader.clearTextureRes(e.urls[t]);e.func_complete&&e.func_complete.run()}))},t.prototype.showPage=function(e){this.pageindex=e,this.btn_left.visible=0!=e,this.btn_right.visible=e!=this.urls.length-1,this.loadover[e]?(this.page.visible=!0,this.page.source=Laya.loader.getRes(this.urls[e]),this.loading.visible=!1):(this.page.visible=!1,this.loading.visible=!0)},t}(e.UIBase);e.UI_Course=t}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(){function e(e){this.me=e}return e.prototype.show=function(e){},e.prototype.reset=function(){},e}(),i=function(e){function t(t){var i=e.call(this,t)||this;i.container_hand=null,i.img_hands=[],i.title_imgs=[],i.label_noinfo=null,i.container_title=null,i.container_hand=i.me.getChildByName("container_hand"),i.img_hands=[];for(a=0;a<i.container_hand.numChildren;a++){var n=i.container_hand.getChildAt(a);n.visible=!1,i.img_hands.push(n)}i.container_title=i.me.getChildByName("container_title");for(var a=0;a<4;a++)i.title_imgs.push(i.container_title.getChildByName(a.toString()));return i.label_noinfo=i.me.getChildByName("label_noinfo"),i}return __extends(t,e),t.prototype.show=function(e){var t=e.statistic_data;t.highest_hu?(this.container_hand.visible=!0,this.container_title.visible=!0,this._showDaHe(t.highest_hu.hands,t.highest_hu.ming,t.highest_hu.hupai),this._setTitle(t.highest_hu.title),this.label_noinfo.visible=!1):(this.container_hand.visible=!1,this.container_title.visible=!1,this.label_noinfo.visible=!0)},t.prototype.reset=function(){this.container_hand.visible=!1,this.label_noinfo.visible=!1,this.container_title.visible=!1},t.prototype._showDaHe=function(e,t,i){for(var n=this.img_hands[0].width,a=.5*n,r=0;r<this.img_hands.length;r++)this.img_hands[r].visible=!1;for(var o=0,s=0,h="myres2/mjp/"+game.GameUtility.get_common_view_res_name(game.ECommonView.mjp)+"/ui/",r=0;r<e.length;r++)this.img_hands[o].skin=h+e[r]+".png",this.img_hands[o].x=s,this.img_hands[o].y=0,s+=n,this.img_hands[o].visible=!0,o++;if(t&&t.length>0){s+=a;for(r=0;r<t.length;r++){var l=t[r];if(")"!=l.charAt(l.length-1)){if(1==(p=l.split("|")).length){_=p[0].charAt(1);"0"==(d=p[0].charAt(0))&&(d="5");for(y=0;y<4;y++){v="";v=0==y||3==y?"back":1==y&&"5"==d&&"z"!=_?"0"+_:d+_,this.img_hands[o].skin=h+v+".png",this.img_hands[o].x=s,this.img_hands[o].y=0,s+=n,this.img_hands[o].visible=!0,o++}}else for(y=0;y<p.length;y++){v=p[y].toString();this.img_hands[o].skin=h+v+".png",this.img_hands[o].x=s,this.img_hands[o].y=0,s+=n,this.img_hands[o].visible=!0,o++}}else{for(var c="",p=[],u=0;u<l.length;u++)if("("==l.charAt(u)){c=l.substring(0,u),p=l.substring(u+1,l.length-1).split(",");break}if("angang"==c){for(var d=p[0].charAt(0),_=p[0].charAt(1),m=0,f=0;f<p.length;f++)"0"==p[f].charAt(0)&&m++;m>0&&(d="5");for(var g=0;g<p.length;g++){v="";v=0==g||3==g?"back":g<=m?"0"+_:d+_,this.img_hands[o].skin=h+v+".png",this.img_hands[o].x=s,this.img_hands[o].y=0,s+=n,this.img_hands[o].visible=!0,o++}}else for(var y=0;y<p.length;y++){var v=p[y];this.img_hands[o].skin=h+v+".png",this.img_hands[o].x=s,this.img_hands[o].y=0,s+=n,this.img_hands[o].visible=!0,o++}}}}s+=a,this.img_hands[o].skin=h+i+".png",this.img_hands[o].x=s,this.img_hands[o].y=0,s+=n,this.img_hands[o].visible=!0;var x=-.12*(++o-14)/4+.65;this.container_hand.scaleX=this.container_hand.scaleY=x},t.prototype._setTitle=function(e){var t=[];switch(e){case"满贯":t=["","","man","guan"];break;case"跳满":t=["","","tiao","man"];break;case"倍满":t=["","","bei","man"];break;case"三倍满":t=["","san","bei","man"];break;case"累积役满":t=["lei","ji","yi","man"];break;case"役满":t=["","","yi","man"];break;case"两倍役满":t=["liang","bei","yi","man"];break;case"三倍役满":t=["san","bei","yi","man"];break;case"四倍役满":t=["si","bei","yi","man"];break;case"五倍役满":t=["wu","bei","yi","man"];break;case"六倍役满":t=["liu","bei","yi","man"]}for(i=0;i<this.title_imgs.length;i++)this.title_imgs[i].visible=!1;for(var i=0;i<t.length;i++)if(""!=t[i]){var n=this.title_imgs[i];n.visible=!0,n.skin="myres/word_"+t[i]+".png"}},t}(t),n=function(t){function i(i){var n=t.call(this,i)||this;n.fengge=[],n.radar_triangle=[];var a=n.me;n.fengge.push(a.getChildByName("gong")),n.fengge.push(a.getChildByName("su")),n.fengge.push(a.getChildByName("fang")),n.fengge.push(a.getChildByName("yun"));for(var r=0;r<4;r++)n.radar_triangle.push(a.getChildByName("radar").getChildByName("sanjiao"+r.toString()));var o=n.me.getChildByName("what");return o&&(o.clickHandler=Laya.Handler.create(n,function(){e.UI_InfoLite.Inst.show(cfg.str.str.find(51).desc)},null,!1)),n}return __extends(i,t),i.prototype.show=function(e){var t=this,i=e.statistic_data,n=[0,0,0,0];if(i.recent_20_hu_summary&&i.recent_20_hu_summary.total_count>0){(a=(i.recent_20_hu_summary.average_hu_point-3e3)/5e3*100)<0?a=0:a>100&&(a=100),n[0]=a}if(i.recent_round&&i.recent_round.total_count>0){i.recent_round.rong_count+i.recent_round.zimo_count==0?n[1]=0:(n[1]=((i.recent_round.rong_count+i.recent_round.zimo_count)/i.recent_round.total_count-.1)/.3*100,n[1]<0?n[1]=0:n[1]>100&&(n[1]=100));(a=100*(1.12-i.recent_round.fangchong_count/i.recent_round.total_count*3.4))<0?a=0:a>100&&(a=100),n[2]=a}if(i.recent_10_hu_summary&&i.recent_10_hu_summary.total_fanshu>0){var a=i.recent_10_hu_summary.total_xuanshang/i.recent_10_hu_summary.total_fanshu*1.5*100;a=a<0?0:a>100?100:a,n[3]=a}this._showRadar([0,0,0,0]),Laya.timer.once(500,this,function(){Laya.timer.clearAll(t);var e=Laya.timer.currTimer,i=function(){var a=Laya.timer.currTimer-e;if(a>=300)t._showRadar(n),Laya.timer.clear(t,i);else{for(var r=Laya.Ease.linearNone(a,0,1,300),o=[],s=0;s<n.length;s++)o.push(n[s]*r);t._showRadar(o)}};Laya.timer.frameLoop(1,t,i,null,!0)})},i.prototype.reset=function(){Laya.timer.clearAll(this),this._showRadar([0,0,0,0])},i.prototype._showRadar=function(e){for(t=0;t<e.length;t++)this.fengge[t].text=Math.floor(e[t]).toString();for(var t=0;t<e.length;t++)for(var i=0;i<2;i++){var n=this.radar_triangle[t].getChildByName(0==i?"nei":"wai"),a=e[t]/20,r=e[(t+1)%e.length]/20;a<=.2&&(a=.2),a>=4.8&&(a=4.8),r<=.2&&(r=.2),r>=4.8&&(r=4.8),1==i&&(a+=.3,r+=.3);var o=180*Math.atan(r/a)/3.1415926,s=108*a/5,h=108*r/5;n.rotation=o,n.x=.5*s,n.y=108-.5*h,n.width=n.height=Math.sqrt(s*s+h*h)+10}},i}(t),a=function(e){function t(t){var i=e.call(this,t)||this;i.zoushi_points=[],i.zoushi_lines=[];for(var n=i.me,a=n.getChildByName("lines"),r=0;r<a.numChildren;r++)i.zoushi_lines.push(a.getChildAt(r));for(var o=n.getChildByName("points"),r=0;r<o.numChildren;r++)i.zoushi_points.push(o.getChildAt(r));return i}return __extends(t,e),t.prototype.show=function(e){var t=this,i=e.statistic_data;if(i.recent_ranks){Laya.timer.clearAll(this);var n=i.recent_ranks;this._showZoushi([],0),Laya.timer.clearAll(this),Laya.timer.once(500,this,function(){var e=n.length>=10?10:n.length,i=Laya.timer.currTimer;Laya.timer.frameLoop(1,t,function(){var a=.01*(Laya.timer.currTimer-i);a>=e?(t._showZoushi(n,e),Laya.timer.clearAll(t)):t._showZoushi(n,a)},null,!0)})}},t.prototype.reset=function(){this._showZoushi([],0)},t.prototype._showZoushi=function(e,t){var i=0;i=e.length>=10?e.length-10:0;for(r=0;r<this.zoushi_points.length;r++)this.zoushi_points[r].visible=!1;for(r=0;r<this.zoushi_lines.length;r++)this.zoushi_lines[r].visible=!1;for(var n=[],a=Math.floor(t),r=0;r+i<e.length;r++){var o=-705*(9-r)/9+1755,s=-129*(4-e[r+i])/3+991;n.push(new Laya.Vector2(o,s))}for(r=0;r<n.length&&!(r>a);r++)if(this.zoushi_points[r].visible=!0,this.zoushi_points[r].x=n[r].x,this.zoushi_points[r].y=n[r].y,r+1<n.length)if(r==a){var h=t-a;if(h>.001){this.zoushi_lines[r].visible=!0,this.zoushi_lines[r].x=n[r].x,this.zoushi_lines[r].y=n[r].y;var l=n[r+1].y-n[r].y,c=n[r+1].x-n[r].x,p=180*Math.atan(l/c)/3.1415926;this.zoushi_lines[r].rotation=p,this.zoushi_lines[r].width=Math.sqrt(c*c+l*l)*h}}else{this.zoushi_lines[r].visible=!0,this.zoushi_lines[r].x=n[r].x,this.zoushi_lines[r].y=n[r].y;var l=n[r+1].y-n[r].y,c=n[r+1].x-n[r].x,p=180*Math.atan(l/c)/3.1415926;this.zoushi_lines[r].rotation=p,this.zoushi_lines[r].width=Math.sqrt(c*c+l*l)}},t}(t),r=function(e){function t(t,i){var n=e.call(this,t)||this;return n.mode=0,n.btn=null,n.arrow=null,n.indetail=!1,n.container_detail=null,n.h_hide=0,n.h_detail=0,n.mode=i,n.btn=n.me.getChildByName("btn"),n.btn.clickHandler=Laya.Handler.create(n,n.switchState,null,!1),n.arrow=n.btn.getChildByName("arrow"),n.container_detail=n.me.getChildByName("detail"),n.h_detail=310,n.h_hide=n.btn.height,n.container_detail.visible=!1,n.indetail=!1,n.me.height=n.btn.height,n.arrow.rotation=0,n._pos1=n.container_detail.getChildByName("pos1"),n._pos2=n.container_detail.getChildByName("pos2"),n._pos3=n.container_detail.getChildByName("pos3"),n._pos4=n.container_detail.getChildByName("pos4"),n._knockout=n.container_detail.getChildByName("knockout"),n._changci=n.container_detail.getChildByName("changci"),n._dadian=n.container_detail.getChildByName("dadian"),n._shunwei=n.container_detail.getChildByName("shunwei"),n._lianzhuang=n.container_detail.getChildByName("lianzhuang"),n._hule=n.container_detail.getChildByName("hule"),n._shunwei=n.container_detail.getChildByName("shunwei"),n._hupai=n.container_detail.getChildByName("hupai"),n._zimo=n.container_detail.getChildByName("zimo"),n._fangchong=n.container_detail.getChildByName("fangchong"),n._fulu=n.container_detail.getChildByName("fulu"),n._liqi=n.container_detail.getChildByName("liqi"),n._pos1.width=100,n._pos2.width=100,n._pos3.width=100,n._pos4.width=100,n._knockout.width=100,n._changci.width=100,n._dadian.width=100,n._shunwei.width=100,n._lianzhuang.width=100,n._hule.width=100,n._hupai.width=100,n._zimo.width=100,n._fangchong.width=100,n._fulu.width=100,n._liqi.width=100,n}return __extends(t,e),t.prototype.show=function(e){this.changeCategory(e,2)},t.prototype.changeCategory=function(e,t){this._pos1.text="--/--",this._pos2.text="--/--",this._pos3.text="--/--",this._pos4.text="--/--",this._knockout.text="--/--",this._changci.text="--/--",this._dadian.text="--/--",this._shunwei.text="--/--",this._lianzhuang.text="--/--",this._hule.text="--/--",this._hupai.text="--/--",this._zimo.text="--/--",this._fangchong.text="--/--",this._fulu.text="--/--",this._liqi.text="--/--";var i=e.detail_data;if(i){var n=null;if(1==t?n=i.friend_room_statistic:2==t&&(n=i.rank_statistic.total_statistic.all_level_statistic),n)for(var a=0;a<n.game_mode.length;a++){var r=n.game_mode[a];if(r.mode==this.mode){var o=r.game_count_sum;if(o>0){this._pos1.text=(r.game_final_position[0]/o*100).toFixed(2).toString()+"%",this._pos2.text=(r.game_final_position[1]/o*100).toFixed(2).toString()+"%",this._pos3.text=(r.game_final_position[2]/o*100).toFixed(2).toString()+"%",this._pos4.text=(r.game_final_position[3]/o*100).toFixed(2).toString()+"%",this._knockout.text=(r.fly_count/o*100).toFixed(2).toString()+"%",this._changci.text=o.toString();for(var s=0,h=0;h<4;h++)s+=(h+1)*r.game_final_position[h];this._shunwei.text=(s/o).toFixed(2).toString()}else this._pos1.text="--/--",this._pos2.text="--/--",this._pos3.text="--/--",this._pos4.text="--/--",this._knockout.text="--/--",this._changci.text=o.toString(),this._shunwei.text="--/--";var l=0,c=0,p=0,u=0;if(r.round_end)for(var d=0;d<r.round_end.length;d++){l+=r.round_end[d].sum;var _=r.round_end[d].type;_==mjcore.E_Round_Result.zimo&&(p+=r.round_end[d].sum),_==mjcore.E_Round_Result.rong||_==mjcore.E_Round_Result.zimo?c+=r.round_end[d].sum:_==mjcore.E_Round_Result.fangchong&&(u+=r.round_end[d].sum)}l>0?(this._hupai.text=(c/l*100).toFixed(2).toString()+"%",this._fangchong.text=(u/l*100).toFixed(2).toString()+"%",this._fulu.text=(r.ming_count_sum/l*100).toFixed(2).toString()+"%",this._liqi.text=(r.liqi_count_sum/l*100).toFixed(2).toString()+"%"):(this._hupai.text="--/--",this._fangchong.text="--/--",this._fulu.text="--/--",this._liqi.text="--/--"),c>0?(this._dadian.text=(r.dadian_sum/c).toFixed(0),this._zimo.text=(p/c*100).toFixed(2).toString()+"%",this._hule.text=(r.xun_count_sum/c).toFixed(2)):(this._dadian.text="--/--",this._zimo.text="--/--",this._hule.text="--/--"),null!=r.highest_lianzhuang&&void 0!=r.highest_lianzhuang?this._lianzhuang.text=r.highest_lianzhuang:this._lianzhuang.text="--/--"}}}},t.prototype.reset=function(){this.container_detail.visible=!1,this.indetail=!1,this.me.height=this.btn.height,this.arrow.rotation=0,this.container_detail.alpha=1,this._pos1.text="--/--",this._pos2.text="--/--",this._pos3.text="--/--",this._pos4.text="--/--",this._knockout.text="--/--",this._changci.text="--/--",this._dadian.text="--/--",this._shunwei.text="--/--",this._lianzhuang.text="--/--",this._hule.text="--/--",this._hupai.text="--/--",this._zimo.text="--/--",this._fangchong.text="--/--",this._fulu.text="--/--",this._liqi.text="--/--"},t.prototype.switchState=function(){var e=this;this.indetail=!this.indetail,Laya.timer.clearAll(this),this.indetail?(this.me.height=this.h_detail,Laya.Tween.to(this.arrow,{rotation:-180},200,Laya.Ease.strongOut),Laya.timer.once(0,this,function(){e.container_detail.visible=!0})):(Laya.Tween.to(this.arrow,{rotation:0},200,Laya.Ease.strongOut),this.container_detail.visible=!1,this.me.height=this.h_hide)},t}(t),o=function(e){function t(t){var i=e.call(this,t)||this;i.item_height=50,i.btn=null,i.arrow=null,i.indetail=!1,i.container_detail=null,i.items=[],i.h_hide=0,i.h_detail=0,i.btn=i.me.getChildByName("btn"),i.btn.clickHandler=Laya.Handler.create(i,i.switchState,null,!1),i.arrow=i.btn.getChildByName("arrow"),i.container_detail=i.me.getChildByName("detail");var n=i.container_detail.getChildByName("templete");n.visible=!1,i.items=[];var a=10;return cfg.fan.fan.forEach(function(e){if(46!=e.id){if(35==e.id){var t=n.scriptMap["capsui.UICopy"].getNodeClone();t.y=a,a+=i.item_height;var r=t.getChildByName("fan"),o=t.getChildByName("count");Laya.timer.frameOnce(5,i,function(){r.text="流局满贯",o.text="0",t.visible=!0});var s={id:-1,count:0,label_count:o};i.items.push(s)}var h=n.scriptMap["capsui.UICopy"].getNodeClone();h.y=a,a+=i.item_height;var l=h.getChildByName("fan"),c=h.getChildByName("count");Laya.timer.frameOnce(5,i,function(){l.text=e.name,c.text="0",h.visible=!0}),i.items.push({id:e.id,count:0,label_count:c})}}),i.h_detail=a+80,i.h_hide=i.btn.height,i.container_detail.visible=!1,i.indetail=!1,i.me.height=i.btn.height,i.arrow.rotation=0,i}return __extends(t,e),t.prototype.reset=function(){this.container_detail.visible=!1,this.indetail=!1,this.me.height=this.btn.height,this.arrow.rotation=0;for(var e=0;e<this.items.length;e++)this.items[e].label_count.text="0";this.container_detail.alpha=1},t.prototype.show=function(e){this.changeCategory(e,2)},t.prototype.changeCategory=function(e,t){for(r=0;r<this.items.length;r++)this.items[r].label_count.text="0";var i=e.detail_data;if(i){var n=null;if(1==t?n=i.friend_room_statistic:2==t&&(n=i.rank_statistic.total_statistic.all_level_statistic),n){for(r=0;r<n.fan.length;r++)for(var a=0;a<this.items.length;a++)if(this.items[a].id==n.fan[r].fan_id){this.items[a].count=n.fan[r].sum,this.items[a].label_count.text=this.items[a].count.toString();break}if(null!=n.liujumanguan)for(var r=0;r<this.items.length;r++)if(-1==this.items[r].id){this.items[r].count=n.liujumanguan,this.items[r].label_count.text=this.items[r].count.toString();break}}}},t.prototype.switchState=function(){var e=this;this.indetail=!this.indetail,Laya.timer.clearAll(this),this.indetail?(this.me.height=this.h_detail,Laya.Tween.to(this.arrow,{rotation:-180},200,Laya.Ease.strongOut),Laya.timer.once(0,this,function(){e.container_detail.visible=!0})):(Laya.Tween.to(this.arrow,{rotation:0},200,Laya.Ease.strongOut),this.container_detail.visible=!1,this.me.height=this.h_hide)},t}(t),s=function(e){function t(t,i){var n=e.call(this,t)||this;return n.bg=null,n.btn_pipei=null,n.btn_friend=null,n.father=null,n.category=2,n.father=i,n.btn_pipei=t.getChildByName("btn_pipei"),n.btn_friend=t.getChildByName("btn_friend"),n.btn_pipei.clickHandler=Laya.Handler.create(n,function(){2!=n.category&&(n.btn_pipei.skin="myres/bothui/pi_choosed.png",n.btn_friend.skin="myres/bothui/pi_unchosen.png",n.father.onChangeCategory(2),n.category=2)},null,!1),n.btn_friend.clickHandler=Laya.Handler.create(n,function(){1!=n.category&&(n.btn_friend.skin="myres/bothui/pi_choosed.png",n.btn_pipei.skin="myres/bothui/pi_unchosen.png",n.father.onChangeCategory(1),n.category=1)},null,!1),n.bg=t.getChildByName("bg"),n}return __extends(t,e),t.prototype.reset=function(){this.category=2,this.btn_pipei.skin="myres/bothui/pi_choosed.png",this.btn_friend.skin="myres/bothui/pi_unchosen.png",this.bg.height=0},t.prototype.setH=function(e){this.bg.height=e-1030},t}(t),h=function(){function e(e){var h=this;this.me=null,this.panel=null,this._scrollbar=null,this._scrollpoint=null,this.blocks=[],this._data=null,this._last_time=0,this._drag_scroll=!1,this._container_tab=null,this.me=e,this.panel=this.me.getChildByName("content"),this.panel.vScrollBar.visible=!1,this.blocks.push(new i(this.panel.getChildByName("dahe"))),this.blocks.push(new n(this.panel.getChildByName("fengge"))),this.blocks.push(new a(this.panel.getChildByName("zoushi"))),this.blocks.push(this._container_tab=new s(this.panel.getChildByName("tabs"),this)),this.blocks.push(new r(this.panel.getChildByName("mode0"),0)),this.blocks.push(new r(this.panel.getChildByName("mode1"),1)),this.blocks.push(new r(this.panel.getChildByName("mode2"),2)),this.blocks.push(new o(this.panel.getChildByName("fan"))),this.blocks.push(new t(this.panel.getChildByName("blank"))),this._scrollbar=this.me.getChildByName("scrollbar"),this._scrollpoint=this._scrollbar.getChildByName("scrollpoint"),this._scrollbar&&(this._scrollbar.on("mousedown",this,function(){h._drag_scroll=!0;var e=h._scrollbar.mouseY/h._scrollbar.height;h.panel.vScrollBar.value=h.panel.vScrollBar.max*e}),this._scrollbar.on("mousemove",this,function(){if(h._drag_scroll){var e=h._scrollbar.mouseY/h._scrollbar.height;h.panel.vScrollBar.value=h.panel.vScrollBar.max*e}}),this._scrollbar.on("mouseup",this,function(){h._drag_scroll=!1}),this._scrollbar.on("mouseout",this,function(){h._drag_scroll=!1}))}return e.prototype.reset=function(){for(var e=0,t=0;t<this.blocks.length;t++)this.blocks[t].reset(),this.blocks[t].me.y=e,e+=this.blocks[t].me.height},e.prototype.show=function(e){this._data=e;var t=0;this.panel.vScrollBar.value=0,this.panel.vScrollBar.stopScroll();for(var i=0;i<this.blocks.length;i++)this.blocks[i].reset(),this.blocks[i].show(e),this.blocks[i].me.y=t,t+=this.blocks[i].me.height;this._last_time=Laya.timer.currTimer,Laya.timer.frameLoop(1,this,this.update,null,!0)},e.prototype.close=function(){Laya.timer.clearAll(this)},e.prototype.update=function(){var e=0,t=this.panel.vScrollBar.value/this.panel.vScrollBar.max;this._scrollpoint.y=this._scrollbar.height*t;for(var i=0;i<this.blocks.length;i++){var n=this.blocks[i].me.y,a=Math.abs(n-e);if(a<.001)this.blocks[i].me.y=e;else{var r=Math.sqrt(2*a/(1400/22500)),o=Laya.timer.currTimer-this._last_time;if(o>=r)this.blocks[i].me.y=e;else{var s=1400/22500*.5*(r-o)*(r-o);this.blocks[i].me.y=n<e?e-s:e+s}}e+=this.blocks[i].me.height}this._container_tab.setH(e),this.panel.refresh(),this._last_time=Laya.timer.currTimer},e.prototype.onChangeCategory=function(e){for(var t=0;t<this.blocks.length;t++)this.blocks[t]instanceof r&&this.blocks[t].changeCategory(this._data,e),this.blocks[t]instanceof o&&this.blocks[t].changeCategory(this._data,e)},e}();e.UI_PlayerData=h}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(){return function(e){this.me=e}}(),i=function(e){function t(t,i,n){var a=e.call(this,t)||this;a._on_change=null,a._current_index=0,a._toggles=[],a._on_change=n,a._current_index=i;for(var o=function(e){var t=s.me.getChildByName("toggle_"+e);if(!t)return"break";t.clickHandler=Laya.Handler.create(s,function(){a.change_index(e)},null,!1);var i=t.getChildAt(0);e==s._current_index?(t.skin=r.skin_choosed,i.color=r.color_choosed):(t.skin=r.skin_unchoose,i.color=r.color_unchoose),s._toggles.push({btn:t,label:i})},s=this,h=0;h<6;h++){if("break"===o(h))break}return a}return __extends(t,e),Object.defineProperty(t.prototype,"index",{get:function(){return this._current_index},enumerable:!0,configurable:!0}),t.prototype.change_index=function(e){if(this._current_index!=e){for(var t=0;t<this._toggles.length;t++)t==e?(this._toggles[t].btn.skin=r.skin_choosed,this._toggles[t].label.color=r.color_choosed):(this._toggles[t].btn.skin=r.skin_unchoose,this._toggles[t].label.color=r.color_unchoose);this._current_index=e,this._on_change&&this._on_change.runWith(e)}},t}(t),n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(t),a=function(t){function i(i,n,a){var r=t.call(this,i)||this;r._on_change=null,r._label=null,r._current_num=0,r._on_change=a;var o=r.me.getChildByName("btn");return o.clickHandler=Laya.Handler.create(r,function(){e.UI_NumberInput.Inst.show("输入数字",Laya.Handler.create(r,function(e){0!=e&&e!=r._current_num&&r._on_change&&r._on_change.runWith(e)}),null)},null,!1),r._label=o.getChildAt(1),r.change_num(n),r}return __extends(i,t),Object.defineProperty(i.prototype,"num",{get:function(){return this._current_num},enumerable:!0,configurable:!0}),i.prototype.change_num=function(e){this._current_num=e,this._label.text=e.toString()},i}(t),r=function(t){function r(){var e=t.call(this,new ui.lobby.create_roomUI)||this;return e.__moshi=null,e.__time=null,e.__bisai=null,e.__test_paipu=null,e.__test_paicount=null,e.__gaojishezhi=null,e.__split_line=null,e.__qishidianshu=null,e.__fandian=null,e.__chibaopai=null,e.__shiduan=null,e.__bianjietishi=null,e.__guanzhan=null,e.__ailevel=null,e.container_top=null,e.container_content=null,e.panel=null,e._scrollbar=null,e._scrollpoint=null,e.locking=!1,e._btn_create_cd=0,e.tournament_id=0,e._blocks=[],e._drag_scroll=!1,r.Inst=e,e}return __extends(r,t),r.Show=function(){this.Inst.show()},r.prototype.onCreate=function(){var t=this,r=this.me.getChildByName("container_create_room");this.container_top=r.getChildByName("top"),this.container_content=r.getChildByName("content"),this.panel=this.container_content.getChildByName("panel"),this.__moshi=new i(this.panel.getChildByName("moshi"),2,Laya.Handler.create(this,function(e){0==t.__bisai.index&&(0!=e&&3!=e||t.__guanzhan.change_index(0))},null,!1)),this.__time=new i(this.panel.getChildByName("time"),2,null),this.__bisai=new i(this.panel.getChildByName("bisai"),0,Laya.Handler.create(this,function(e){0==e?0!=t.__moshi.index&&3!=t.__moshi.index||t.__guanzhan.change_index(0):t.__guanzhan.change_index(1)},null,!1)),this.__test_paipu=new i(this.panel.getChildByName("test_paipu"),0,null),this.__test_paicount=new i(this.panel.getChildByName("test_paicount"),0,null),this.__gaojishezhi=new i(this.panel.getChildByName("gaojishezhi"),0,Laya.Handler.create(this,function(e){t.__qishidianshu.change_num(25e3),t.__fandian.change_num(3e4),t.__chibaopai.change_index(1),t.__shiduan.change_index(0),t.__bianjietishi.change_index(0),t.__ailevel.change_index(0),t.__guanzhan.change_index(0==t.__bisai.index?0:1),t.__split_line.me.visible=0!=e,t.__qishidianshu.me.visible=0!=e,t.__fandian.me.visible=0!=e,t.__chibaopai.me.visible=0!=e,t.__shiduan.me.visible=0!=e,t.__bianjietishi.me.visible=0!=e,t.__guanzhan.me.visible=0!=e,t.__ailevel.me.visible=0!=e,t._refreshShow()},null,!1)),this.__split_line=new n(this.panel.getChildByName("split_line")),this.__qishidianshu=new a(this.panel.getChildByName("qishidianshu"),25e3,Laya.Handler.create(this,function(e){(e=100*Math.ceil(e/100))<100&&(e=100),e>=2e5&&(e=2e5),e>t.__fandian.num&&t.__fandian.change_num(e),t.__qishidianshu.change_num(e)},null,!1)),this.__fandian=new a(this.panel.getChildByName("fandian"),3e4,Laya.Handler.create(this,function(e){(e=100*Math.ceil(e/100))<100&&(e=100),e>=2e5&&(e=2e5),e<t.__qishidianshu.num&&(e=t.__qishidianshu.num),t.__fandian.change_num(e)},null,!1)),this.__chibaopai=new i(this.panel.getChildByName("chibaopai"),1,null),this.__shiduan=new i(this.panel.getChildByName("shiduan"),0,null),this.__bianjietishi=new i(this.panel.getChildByName("bianjietishi"),0,null),this.__guanzhan=new i(this.panel.getChildByName("guanzhan"),0,Laya.Handler.create(this,function(e){1!=e||0!=t.__bisai.index||0!=t.__moshi.index&&3!=t.__moshi.index||t.__guanzhan.change_index(0)},null,!1)),this.__ailevel=new i(this.panel.getChildByName("ailevel"),0,Laya.Handler.create(this,function(e){},null,!1)),this.__shiduan.me.getChildByName("what").clickHandler=Laya.Handler.create(this,function(){e.UI_InfoLite.Inst.show(cfg.str.str.find(54).desc)},null,!1),this.__bianjietishi.me.getChildByName("what").clickHandler=Laya.Handler.create(this,function(){e.UI_InfoLite.Inst.show(cfg.str.str.find(53).desc)},null,!1),this._blocks.push(this.__moshi),this._blocks.push(this.__time),this._blocks.push(this.__bisai),this._blocks.push(this.__test_paipu),this._blocks.push(this.__test_paicount),this._blocks.push(this.__gaojishezhi),this._blocks.push(this.__split_line),this._blocks.push(this.__qishidianshu),this._blocks.push(this.__fandian),this._blocks.push(this.__chibaopai),this._blocks.push(this.__shiduan),this._blocks.push(this.__bianjietishi),this._blocks.push(this.__guanzhan),this._blocks.push(this.__ailevel),this.__test_paipu.me.visible=!GameMgr.inRelease,this.__test_paicount.me.visible=!GameMgr.inRelease,this.__split_line.me.visible=!1,this.__qishidianshu.me.visible=!1,this.__fandian.me.visible=!1,this.__chibaopai.me.visible=!1,this.__shiduan.me.visible=!1,this.__bianjietishi.me.visible=!1,this.__guanzhan.me.visible=!1,this.__ailevel.me.visible=!1,this.panel.vScrollBar.visible=!1,this.container_top.getChildByName("btn_cancel").clickHandler=Laya.Handler.create(this,function(){t.locking||t.hide(Laya.Handler.create(t,function(){e.UIMgr.Inst.showLobby()}))},null,!1),this.container_content.getChildByName("btn_create").clickHandler=Laya.Handler.create(this,this._btnCreateRoom,null,!1),this._scrollbar=this.container_content.getChildByName("scrollbar"),this._scrollpoint=this._scrollbar.getChildByName("scrollpoint"),this._scrollbar&&(this._scrollbar.on("mousedown",this,function(){t._drag_scroll=!0;var e=t._scrollbar.mouseY/t._scrollbar.height;t.panel.vScrollBar.value=t.panel.vScrollBar.max*e}),this._scrollbar.on("mousemove",this,function(){if(t._drag_scroll){var e=t._scrollbar.mouseY/t._scrollbar.height;t.panel.vScrollBar.value=t.panel.vScrollBar.max*e}}),this._scrollbar.on("mouseup",this,function(){t._drag_scroll=!1}),this._scrollbar.on("mouseout",this,function(){t._drag_scroll=!1})),Laya.timer.frameLoop(1,this,function(){if(t.enable&&t._scrollbar.visible){var e=t.panel.vScrollBar.max>0?t.panel.vScrollBar.value/t.panel.vScrollBar.max:0;t._scrollpoint.y=t._scrollbar.height*e}})},r.prototype.show=function(){var t=this;if(this.tournament_id=0,this._drag_scroll=!1,this.panel.vScrollBar.stopScroll(),cfg.tournament.tournaments.forEach(function(i){if(0==t.tournament_id){var n=e.UI_Bag.find_item(i.game_ticket_id);n&&n.count>0&&(t.tournament_id=i.id)}}),0!=this.tournament_id){this.__bisai.me.visible=!0;var i=this.__bisai.me.getChildByName("toggle_1").getChildAt(0),n="比赛",a=cfg.tournament.tournaments.get(this.tournament_id);a&&(n=a.name),i.text=n,n.length<=6?i.fontSize=40:n.length<=9?i.fontSize=70-5*i.leading:i.fontSize=25}else this.__bisai.me.visible=!1;this._refreshShow(),this.enable=!0,e.UIBase.anim_alpha_in(this.container_top,{y:-30},150),e.UIBase.anim_alpha_in(this.container_content,{y:30},150),this.locking=!0,Laya.timer.once(200,this,function(){t.locking=!1,t._btn_create_cd=0})},r.prototype.hide=function(t){var i=this;void 0===t&&(t=null),e.UIBase.anim_alpha_out(this.container_top,{y:-30},150),e.UIBase.anim_alpha_out(this.container_content,{y:30},150),this.locking=!0,Laya.timer.once(200,this,function(){i.locking=!1,i.enable=!1,t&&t.run()})},r.prototype._btnCreateRoom=function(){var t=this;if(!(this.locking||Laya.timer.currTimer<this._btn_create_cd)){this._btn_create_cd=Laya.timer.currTimer+5e3;var i=0;switch(this.__moshi.index){case 0:case 1:case 2:i=4;break;case 3:i=1;break;case 4:i=2;break;case 5:i=3}GameMgr.inRelease;var n={};switch(n.init_point=this.__qishidianshu.num,n.fandian=this.__fandian.num,n.dora_count=0==this.__chibaopai.index?0:1==this.__chibaopai.index?3:4,n.shiduan=0==this.__shiduan.index,n.bianjietishi=0==this.__bianjietishi.index,this.__time.index){case 0:n.time_fixed=3,n.time_add=5;break;case 1:n.time_fixed=5,n.time_add=10;break;case 2:n.time_fixed=5,n.time_add=20;break;case 3:n.time_fixed=60,n.time_add=0}n.ai_level=this.__ailevel.index+1;var a={};GameMgr.inRelease||(a.paixing=this.__test_paipu.index,a.left_count=this.__test_paicount.index);var r=1==this.__guanzhan.index,o=0==this.__bisai.index?0:this.tournament_id;!0,app.NetAgent.sendReq2Lobby("Lobby","createRoom",{player_count:i,mode:{mode:this.__moshi.index,ai:!0,detail_rule:n,testing_environment:a},public_live:r,tournament_id:o},function(i,n){t._btn_create_cd=Laya.timer.currTimer,i||n.error?e.UIMgr.Inst.showNetReqError("createRoom",i,n):t.hide(Laya.Handler.create(t,function(){e.UI_WaitingRoom.Inst.updateData(n.room),e.UIMgr.Inst.ShowWaitingRoom()}))})}},r.prototype._refreshShow=function(){for(var e=this.panel.vScrollBar.max>0?this.panel.vScrollBar.value/this.panel.vScrollBar.max:0,t=0,i=0;i<this._blocks.length;i++)this._blocks[i].me.visible?(this._blocks[i].me.y=t,t+=this._blocks[i].me.height):this._blocks[i].me.y=0;this.panel.refresh(),t<this.panel.height?(this.panel.vScrollBar.value=0,this._scrollbar.visible=!1):(this.panel.vScrollBar.value=this.panel.vScrollBar.max*e,this._scrollbar.visible=!0)},r.Inst=null,r.skin_unchoose="myres/room/btn_choosen_no.png",r.skin_choosed="myres/room/btn_choosen.png",r.color_unchoose="#c1ac8b",r.color_choosed="#894b4b",r.s_modes=[["一局胜负","四人东风","四人半庄","人机模式"],["正常","国士无双","顺子","四暗刻","三暗杠"],["正常","5张","12张"],["不允许","允许"],["普通对局","比赛"]],r}(e.UIBase);e.UI_Create_Room=r}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(){function e(t){this.me=null,this._container_c0=null,this._img_countdown_c0=[],this._container_c1=null,this._img_countdown_c1=[],this._img_countdown_plus=null,this._img_countdown_add=[],this._start=0,this._pre_sec=0,this._fix=0,this._add=0,e.Inst=this,this.me=t,this._container_c0=this.me.getChildByName("c0");for(i=0;i<2;i++)this._img_countdown_c0.push(this._container_c0.getChildByName("num"+i));this._container_c1=this.me.getChildByName("c1");for(i=0;i<2;i++)this._img_countdown_c1.push(this._container_c1.getChildByName("num"+i));for(var i=0;i<2;i++)this._img_countdown_add.push(this.me.getChildByName("plus").getChildByName("add_"+i));this._img_countdown_plus=this.me.getChildByName("plus"),this.me.visible=!1}return Object.defineProperty(e.prototype,"timeuse",{get:function(){return this.me.visible?Math.floor((Laya.timer.currTimer-this._start)/1e3):0},enumerable:!0,configurable:!0}),e.prototype.reset=function(){this.me.visible=!1,Laya.timer.clearAll(this)},e.prototype.showCD=function(e,t){this.me.visible=!0,this._start=Laya.timer.currTimer,this._fix=Math.floor(e/1e3),this._add=Math.floor(t/1e3),this._pre_sec=-1,this._show(),Laya.timer.frameLoop(1,this,this._show)},e.prototype.close=function(){this.reset()},e.prototype._show=function(){var e=this._fix+this._add-Math.floor((Laya.timer.currTimer-this._start)/1e3);if(e<=0)return view.DesktopMgr.Inst.OperationTimeOut(),void this.reset();if(e!=this._pre_sec){if(this._pre_sec=e,e>this._add){for(var t=(e-this._add).toString(),i=0;i<this._img_countdown_c0.length;i++){r=this._img_countdown_c0[i];i<t.length?(r.visible=!0,r.skin="myres/mjdesktop/t_"+t[t.length-i-1]+".png"):r.visible=!1}if(0!=this._add){this._img_countdown_plus.visible=!0;for(var n=this._add.toString(),i=0;i<this._img_countdown_add.length;i++){r=this._img_countdown_add[i];i<n.length?(r.visible=!0,r.skin="myres/mjdesktop/at_"+n[i]+".png"):r.visible=!1}}else{this._img_countdown_plus.visible=!1;for(i=0;i<this._img_countdown_add.length;i++)this._img_countdown_add[i].visible=!1}}else{this._img_countdown_plus.visible=!1;for(var t=e.toString(),i=0;i<this._img_countdown_c0.length;i++){var r=this._img_countdown_c0[i];i<t.length?(r.visible=!0,r.skin="myres/mjdesktop/at_"+t[t.length-1-i]+".png"):r.visible=!1}}if(e>3){this._container_c1.visible=!1;for(i=0;i<this._img_countdown_c0.length;i++)this._img_countdown_c0[i].alpha=1;this._img_countdown_plus.alpha=1,this._container_c0.alpha=1,this._container_c1.alpha=1}else{view.AudioMgr.PlayAudio(205),this._container_c1.visible=!0;for(i=0;i<this._img_countdown_c0.length;i++)this._img_countdown_c0[i].alpha=1;this._img_countdown_plus.alpha=1,this._container_c0.alpha=1,this._container_c1.alpha=1;for(i=0;i<this._img_countdown_c1.length;i++)this._img_countdown_c1[i].visible=this._img_countdown_c0[i].visible,this._img_countdown_c1[i].skin=this._img_countdown_c0[i].skin;a.Inst.me.cd1.play(0,!1)}}},e.Inst=null,e}(),i=function(){function e(e){this.timer_id=0,this.me=e}return e.prototype.begin_refresh=function(){this.timer_id&&clearTimeout(this.timer_id),this._loop_refresh_delay(),Laya.timer.clearAll(this),Laya.timer.loop(100,this,this._loop_show)},e.prototype.close_refresh=function(){this.timer_id&&(clearTimeout(this.timer_id),this.timer_id=0),Laya.timer.clearAll(this)},e.prototype._loop_refresh_delay=function(){var e=app.NetAgent.mj_network_delay,t=2e3;t=e<300?2e3:e<800?2500+e:4e3+.5*e,this.timer_id=setTimeout(this._loop_refresh_delay.bind(this),t),app.NetAgent.sendReq2MJ("FastTest","checkNetworkDelay",{},function(){})},e.prototype._loop_show=function(){var e=app.NetAgent.mj_network_delay;this.me.skin=e<300?"myres/mjdesktop/signal_good.png":e<800?"myres/mjdesktop/signal_normal.png":"myres/mjdesktop/signal_bad.png"},e}(),n=function(){function e(e,t){var i=this;this.enable=!1,this.emj_banned=!1,this.locking=!1,this.seat=t,this.me=e,this.btn_banemj=e.getChildByName("btn_banemj"),this.btn_banemj_origin_x=this.btn_banemj.x,this.btn_banemj_origin_y=this.btn_banemj.y,this.img_bannedemj=this.btn_banemj.getChildByName("banned"),this.btn_seeinfo=e.getChildByName("btn_seeinfo"),this.btn_seeinfo_origin_x=this.btn_seeinfo.x,this.btn_seeinfo_origin_y=this.btn_seeinfo.y,this.btn_change=e.getChildByName("btn_change"),this.btn_change_origin_x=this.btn_change.x,this.btn_change_origin_y=this.btn_change.y,this.btn_banemj.clickHandler=Laya.Handler.create(this,function(){i.locking||(i.emj_banned=!i.emj_banned,i.img_bannedemj.visible=!i.emj_banned,i.close())},null,!1),this.btn_seeinfo.clickHandler=Laya.Handler.create(this,function(){i.locking||(i.close(),a.Inst.btn_seeinfo(i.seat))},null,!1),this.btn_change.clickHandler=Laya.Handler.create(this,function(){i.locking||(i.close(),view.DesktopMgr.Inst.changeMainbody((i.seat+view.DesktopMgr.Inst.seat)%4))},null,!1),this.me.clickHandler=Laya.Handler.create(this,function(){i.locking||i.switch()},null,!1)}return e.prototype.reset=function(e,t,i){Laya.timer.clearAll(this),this.locking=!1,this.enable=!1,this.showinfo=e,this.showemj=t,this.showchange=i,this.emj_banned=!1,this.btn_banemj.visible=!1,this.btn_seeinfo.visible=!1,this.img_bannedemj.visible=!this.emj_banned,this.btn_change.visible=!1},e.prototype.onChangeSeat=function(e,t,i){this.showinfo=e,this.showemj=t,this.showchange=i},e.prototype.switch=function(){var e=this;this.locking||(this.enable?this.close():(this.enable=!0,this.locking=!0,this.showinfo?(this.btn_seeinfo.visible=!0,this.btn_seeinfo.scaleX=this.btn_seeinfo.scaleY=1,this.btn_seeinfo.x=this.btn_seeinfo_origin_x,this.btn_seeinfo.y=this.btn_seeinfo_origin_y,this.btn_seeinfo.alpha=1,Laya.Tween.from(this.btn_seeinfo,{x:80,y:80,scaleX:0,scaleY:0,alpha:0},150,Laya.Ease.backOut)):this.btn_seeinfo.visible=!1,this.showemj?(this.img_bannedemj.visible=!this.emj_banned,this.btn_banemj.visible=!0,this.btn_banemj.scaleX=this.btn_banemj.scaleY=1,this.btn_banemj.x=this.btn_banemj_origin_x,this.btn_banemj.y=this.btn_banemj_origin_y,this.btn_banemj.alpha=1,Laya.Tween.from(this.btn_banemj,{x:80,y:80,scaleX:0,scaleY:0,alpha:0},150,Laya.Ease.backOut)):this.btn_banemj.visible=!1,this.showchange?(this.btn_change.visible=!0,this.btn_change.scaleX=this.btn_change.scaleY=1,this.btn_change.x=this.btn_change_origin_x,this.btn_change.y=this.btn_change_origin_y,this.btn_change.alpha=1,Laya.Tween.from(this.btn_change,{x:80,y:80,scaleX:0,scaleY:0,alpha:0},150,Laya.Ease.backOut)):this.btn_change.visible=!1,Laya.timer.once(150,this,function(){e.locking=!1})))},e.prototype.close=function(){var e=this;this.enable=!1,this.locking=!0,Laya.Tween.to(this.btn_banemj,{x:80,y:80,scaleX:0,scaleY:0,alpha:0},150,Laya.Ease.backOut),Laya.Tween.to(this.btn_seeinfo,{x:80,y:80,scaleX:0,scaleY:0,alpha:0},150,Laya.Ease.backOut),Laya.Tween.to(this.btn_change,{x:80,y:80,scaleX:0,scaleY:0,alpha:0},150,Laya.Ease.backOut),Laya.timer.once(150,this,function(){e.locking=!1,e.btn_banemj.visible=!1,e.btn_seeinfo.visible=!1,e.btn_change.visible=!1})},e}(),a=function(a){function r(){var e=a.call(this,new ui.mj.desktopInfoUI)||this;return e.container_doras=null,e.doras=[],e.label_md5=null,e.container_gamemode=null,e.label_gamemode=null,e.btn_auto_moqie=null,e.btn_auto_nofulu=null,e.btn_auto_hule=null,e.img_zhenting=null,e.btn_double_pass=null,e._network_delay=null,e._timecd=null,e._player_infos=[],e._container_fun=null,e._container_chat=null,e._btn_chat=null,e._btn_emos=[],e.showscoredeltaing=!1,e.arrow=null,e._btn_leave=null,e._btn_fanzhong=null,app.NetAgent.AddListener2MJ("NotifyGameBroadcast",Laya.Handler.create(e,function(t){e.onGameBroadcast(t)})),app.NetAgent.AddListener2MJ("NotifyPlayerConnectionState",Laya.Handler.create(e,function(t){e.onPlayerConnectionState(t)})),e}return __extends(r,a),r.prototype.onCreate=function(){var a=this;r.Inst=this,this.doras=new Array;var o=this.me.getChildByName("container_lefttop"),s=o.getChildByName("container_doras");this.container_doras=s,this.container_gamemode=o.getChildByName("gamemode"),this.label_gamemode=this.container_gamemode.getChildByName("lb_mode"),this.label_md5=o.getChildByName("MD5"),o.getChildByName("btn_md5change").clickHandler=Laya.Handler.create(this,function(){if(a.label_md5.visible)Laya.timer.clearAll(a.label_md5),a.label_md5.visible=!1,a.container_doras.visible=!0;else{a.label_md5.visible=!0,a.label_md5.text="本局MD5码:"+view.DesktopMgr.Inst.md5,a.container_doras.visible=!1;var e=a;Laya.timer.once(5e3,a.label_md5,function(){e.label_md5.visible=!1,e.container_doras.visible=!0})}},null,!1);for(h=0;h<s.numChildren;h++)this.doras.push(s.getChildAt(h));for(var h=0;h<4;h++){var l=this.me.getChildByName("container_player_"+h),c={};c.container=l,c.head=new e.UI_Head(l.getChildByName("head")),c.face=l.getChildByName("head").getChildAt(0).getChildAt(0),c.face.visible=!1,c.name=l.getChildByName("container_name").getChildByName("label_name"),c.container_shout=l.getChildByName("container_shout"),c.container_shout.visible=!1,c.illust=c.container_shout.getChildByName("illust").getChildByName("illust"),c.illustrect=e.UIRect.CreateFromSprite(c.illust),c.shout_origin_x=c.container_shout.x,c.shout_origin_y=c.container_shout.y,c.container_emo=l.getChildByName("chat_bubble"),c.emo=new e.UI_Character_Emo(c.container_emo.getChildByName("content")),c.container_emo.visible=!1,c.disconnect=l.getChildByName("head").getChildAt(0).getChildByName("disconnect"),c.disconnect.visible=!1,c.title=new e.UI_PlayerTitle(l.getChildByName("title")),0==h?l.getChildByName("btn_seeinfo").clickHandler=Laya.Handler.create(this,function(){a.btn_seeinfo(0)},null,!1):c.headbtn=new n(l.getChildByName("btn_head"),h),this._player_infos.push(c)}this._timecd=new t(this.me.getChildByName("container_countdown")),this.img_zhenting=this.me.getChildByName("img_zhenting"),this.img_zhenting.visible=!1,this._initFunc(),this._initChat(),this.me.getChildByName("btn_change_score").clickHandler=Laya.Handler.create(this,this.onBtnShowScoreDelta,null,!1),this._btn_leave=this.me.getChildByName("container_righttop").getChildByName("btn_leave"),this.me.getChildByName("container_righttop").getChildByName("btn_leave").clickHandler=Laya.Handler.create(this,function(){view.DesktopMgr.Inst.mode==view.EMJMode.play?e.UI_SecondConfirm.Inst.show(cfg.str.str.get(21).desc,Laya.Handler.create(a,function(){for(var e=0,t=0;t<view.DesktopMgr.Inst.player_datas.length;t++){var i=view.DesktopMgr.Inst.player_datas[t];i&&null!=i.account_id&&0!=i.account_id&&e++}1==e?app.NetAgent.sendReq2MJ("FastTest","terminateGame",{},function(e,t){game.Scene_MJ.Inst.GameEnd()}):game.Scene_MJ.Inst.ForceOut()})):game.Scene_MJ.Inst.ForceOut()},null,!1),this.me.getChildByName("container_righttop").getChildByName("btn_set").clickHandler=Laya.Handler.create(this,function(){e.UI_Config.Inst.show()},null,!1),this._btn_fanzhong=this.me.getChildByName("container_righttop").getChildByName("btn_fanzhong"),this._btn_fanzhong.clickHandler=Laya.Handler.create(this,function(){e.UI_Rules.Inst.show()},null,!1),this.btn_double_pass=this.me.getChildByName("btn_double_pass"),this.btn_double_pass.visible=!1;var p=0;this.btn_double_pass.clickHandler=Laya.Handler.create(this,function(){if(view.DesktopMgr.double_click_pass){var t=Laya.timer.currTimer;if(p+300>t){if(e.UI_ChiPengHu.Inst.enable)e.UI_ChiPengHu.Inst.onDoubleClick();else{var i=view.DesktopMgr.Inst.mainrole.can_discard;e.UI_LiQiZiMo.Inst.enable&&(i=e.UI_LiQiZiMo.Inst.onDoubleClick(i)),i&&view.DesktopMgr.Inst.mainrole.onDoubleClick()}p=0}else p=t}},null,!1),this._network_delay=new i(this.me.getChildByName("img_signal"))},r.prototype.onGameBroadcast=function(e){app.Log.log("NotifyGameBroadcast "+JSON.stringify(e));var t=(e.seat-view.DesktopMgr.Inst.seat+4)%4,i=JSON.parse(e.content);null!=i.emo&&void 0!=i.emo&&this.onShowEmo(t,i.emo)},r.prototype.onPlayerConnectionState=function(e){app.Log.log("NotifyPlayerConnectionState msg: "+JSON.stringify(e));var t=e.seat;if(view.DesktopMgr.player_link_state||(view.DesktopMgr.player_link_state=[view.ELink_State.NULL,view.ELink_State.NULL,view.ELink_State.NULL,view.ELink_State.NULL]),view.DesktopMgr.player_link_state&&t<view.DesktopMgr.player_link_state.length&&(view.DesktopMgr.player_link_state[t]=e.state),this.enable){var i=(t-view.DesktopMgr.Inst.seat+4)%4;this._player_infos[i].disconnect.visible=e.state!=view.ELink_State.READY}},r.prototype._initFunc=function(){var e=this;this._container_fun=this.me.getChildByName("container_func");var t=this._container_fun.getChildByName("btn_func"),i=this._container_fun.getChildByName("btn_func2");t.clickHandler=i.clickHandler=new Laya.Handler(this,function(){var i=0;e._container_fun.x<-400?(i=-274,e.arrow.scaleX=1):(i=-528,e.arrow.scaleX=-1),Laya.Tween.to(e._container_fun,{x:i},200,Laya.Ease.strongOut,Laya.Handler.create(e,function(){t.disabled=!1}),0,!0,!0),t.disabled=!0},null,!1);var n=this._container_fun.getChildByName("btn_autolipai"),a=this._container_fun.getChildByName("btn_autolipai2");this.refreshFuncBtnShow(n,!0),n.clickHandler=a.clickHandler=Laya.Handler.create(this,function(){view.DesktopMgr.Inst.setAutoLiPai(!view.DesktopMgr.Inst.auto_liqi),e.refreshFuncBtnShow(n,view.DesktopMgr.Inst.auto_liqi),Laya.LocalStorage.setItem("autolipai",view.DesktopMgr.Inst.auto_liqi?"true":"false")},null,!1);var r=this._container_fun.getChildByName("btn_autohu"),o=this._container_fun.getChildByName("btn_autohu2");this.refreshFuncBtnShow(r,!1),r.clickHandler=o.clickHandler=Laya.Handler.create(this,function(){view.DesktopMgr.Inst.setAutoHule(!view.DesktopMgr.Inst.auto_hule),e.refreshFuncBtnShow(r,view.DesktopMgr.Inst.auto_hule)},null,!1);var s=this._container_fun.getChildByName("btn_autonoming"),h=this._container_fun.getChildByName("btn_autonoming2");this.refreshFuncBtnShow(s,!1),s.clickHandler=h.clickHandler=Laya.Handler.create(this,function(){view.DesktopMgr.Inst.setAutoNoFulu(!view.DesktopMgr.Inst.auto_nofulu),e.refreshFuncBtnShow(s,view.DesktopMgr.Inst.auto_nofulu)},null,!1);var l=this._container_fun.getChildByName("btn_automoqie"),c=this._container_fun.getChildByName("btn_automoqie2");this.refreshFuncBtnShow(l,!1),l.clickHandler=c.clickHandler=Laya.Handler.create(this,function(){view.DesktopMgr.Inst.setAutoMoQie(!view.DesktopMgr.Inst.auto_moqie),e.refreshFuncBtnShow(l,view.DesktopMgr.Inst.auto_moqie)},null,!1),Laya.Browser.onPC&&!GameMgr.inConch?(t.visible=!1,o.visible=!0,a.visible=!0,h.visible=!0,c.visible=!0):(t.visible=!0,o.visible=!1,a.visible=!1,h.visible=!1,c.visible=!1),this.arrow=this._container_fun.getChildByName("arrow"),this.arrow.scaleX=-1},r.prototype._initChat=function(){var e=this;this._container_chat=this.me.getChildByName("container_chat_choose"),this._btn_chat=this._container_chat.getChildByName("btn_chat"),this._btn_chat.clickHandler=new Laya.Handler(this,this._switchChat,null,!1);for(var t=this._container_chat.getChildByName("container"),i=[],n=function(n){var r=t.getChildByName("e"+n.toString());i.push(r);var o=n%3,s=Math.floor(n/3);r.width=150,r.height=150,r.x=o*r.width+10*o-460,r.y=s*r.height+10*s-32,r.clickHandler=Laya.Handler.create(a,function(){GameMgr.Inst.BehavioralStatistics(22),app.NetAgent.sendReq2MJ("FastTest","broadcastInGame",{content:JSON.stringify({emo:n}),except_self:!1},function(e,t){});for(var t=0;t<i.length;t++)i[t].disabled=!0;Laya.timer.once(4e3,e,function(){for(var e=0;e<i.length;e++)i[e].disabled=!1}),e._switchChat()},null,!1)},a=this,r=0;r<9;r++)n(r);this._btn_emos=i,this._container_chat.x=1903},r.prototype._switchChat=function(){var e=this,t=0;t=this._container_chat.x<1600?1903:1382,Laya.Tween.to(this._container_chat,{x:t},200,Laya.Ease.strongOut,Laya.Handler.create(this,function(){e._btn_chat.disabled=!1}),0,!0,!0),this._btn_chat.disabled=!0},r.prototype.noAutoLipai=function(){var e=this._container_fun.getChildByName("btn_autolipai");view.DesktopMgr.Inst.auto_liqi=!0,e.clickHandler.run()},r.prototype.resetFunc=function(){var e=Laya.LocalStorage.getItem("autolipai"),t=!0;t=!e||""==e||"true"==e;var i=this._container_fun.getChildByName("btn_autolipai");this.refreshFuncBtnShow(i,t),Laya.LocalStorage.setItem("autolipai",t?"true":"false"),view.DesktopMgr.Inst.setAutoLiPai(t);var n=this._container_fun.getChildByName("btn_autohu");this.refreshFuncBtnShow(n,view.DesktopMgr.Inst.auto_hule);var a=this._container_fun.getChildByName("btn_autonoming");this.refreshFuncBtnShow(a,view.DesktopMgr.Inst.auto_nofulu);var r=this._container_fun.getChildByName("btn_automoqie");this.refreshFuncBtnShow(r,view.DesktopMgr.Inst.auto_moqie),this._container_fun.x=-528,this.arrow.scaleX=-1},r.prototype.setDora=function(e,t){if(e<0||e>=this.doras.length)console.error("setDora pos错误");else{var i="myres2/mjp/"+GameMgr.Inst.mjp_view+"/ui/";this.doras[e].skin=i+t.toString()+".png"}},r.prototype.initRoom=function(){var e=this;if(view.DesktopMgr.Inst.mode==view.EMJMode.play||view.DesktopMgr.Inst.mode==view.EMJMode.live_broadcast){for(var t={},i=[],n=0;n<view.DesktopMgr.Inst.player_datas.length;n++){var a=view.DesktopMgr.Inst.player_datas[n].avatar_id,r=cfg.item_definition.skin.get(a).character_id;if(!t.hasOwnProperty(r.toString())){t[r.toString()]=1;for(var o=cfg.item_definition.character.find(r).emo,s=0;s<9;s++)i.push(o+"/"+s.toString()+".png")}}game.LoadMgr.loadResImage(i,Laya.Handler.create(this,function(){for(var t=e._container_chat.getChildByName("container"),i=cfg.item_definition.character.find(cfg.item_definition.skin.get(GameMgr.Inst.account_data.avatar_id).character_id).emo,n=0;n<9;n++){t.getChildByName("e"+n.toString()).skin=game.LoadMgr.getResImageSkin(i+"/"+n.toString()+".png")}}))}if(this._btn_leave.visible=!0,this._btn_fanzhong.visible=!1,view.DesktopMgr.Inst.mode==view.EMJMode.play){for(var h=0,n=0;n<view.DesktopMgr.Inst.player_datas.length;n++){(l=view.DesktopMgr.Inst.player_datas[n])&&null!=l.account_id&&0!=l.account_id&&h++}(h>1||4==view.DesktopMgr.Inst.game_config.category)&&(this._btn_leave.visible=!1,this._btn_fanzhong.visible=!0)}for(n=0;n<view.DesktopMgr.Inst.player_datas.length;n++){var l=view.DesktopMgr.Inst.player_datas[n];l&&null!=l.account_id&&0!=l.account_id&&0}if(this._container_chat.visible=view.DesktopMgr.Inst.mode==view.EMJMode.play,this._container_fun.visible=view.DesktopMgr.Inst.mode==view.EMJMode.play,this.enable=!0,this.setLiqibang(0),this.setBen(0),view.DesktopMgr.Inst.game_config){var c=view.DesktopMgr.Inst.game_config,p=game.Tools.get_room_desc(c);this.label_gamemode.text=p.text,this.label_gamemode.font=p.isSimhei?"SimHei":"hanyi",this.container_gamemode.visible=!0}else this.container_gamemode.visible=!1;this.btn_double_pass.visible=view.DesktopMgr.Inst.mode==view.EMJMode.play,view.DesktopMgr.Inst.mode==view.EMJMode.play?(this._network_delay.begin_refresh(),this._network_delay.me.visible=!0):this._network_delay.me.visible=!1},r.prototype.onCloseRoom=function(){this._network_delay.close_refresh()},r.prototype.refreshSeat=function(e){void 0===e&&(e=!1);for(var t=view.DesktopMgr.Inst.seat,i=view.DesktopMgr.Inst.player_datas,n=0;n<4;n++){var a=(n-t+4)%4;if(n<i.length?(this._player_infos[a].name.text=i[n].nickname,this._player_infos[a].head.id=i[n].avatar_id,this._player_infos[a].avatar=i[n].avatar_id):this._player_infos[a].name.text="电脑",this._player_infos[a].container.visible=!0,this._player_infos[a].head.setEmo(""),0!=a){var r=i[n].account_id&&0!=i[n].account_id&&view.DesktopMgr.Inst.mode!=view.EMJMode.paipu,o=i[n].account_id&&0!=i[n].account_id&&view.DesktopMgr.Inst.mode==view.EMJMode.play,s=view.DesktopMgr.Inst.mode!=view.EMJMode.play;e?this._player_infos[a].headbtn.onChangeSeat(r,o,s):this._player_infos[a].headbtn.reset(r,o,s)}i[n].title?this._player_infos[a].title.id=i[n].title:this._player_infos[a].title.id=0}},r.prototype.refreshLinks=function(){for(var e=view.DesktopMgr.Inst.seat,t=0;t<4;t++){var i=(e+t)%4;view.DesktopMgr.Inst.mode==view.EMJMode.play?this._player_infos[t].disconnect.visible=0!=t&&view.DesktopMgr.player_link_state[i]!=view.ELink_State.READY:view.DesktopMgr.Inst.mode==view.EMJMode.live_broadcast?0==view.DesktopMgr.Inst.player_datas[i].account_id?this._player_infos[t].disconnect.visible=!1:this._player_infos[t].disconnect.visible=view.DesktopMgr.player_link_state[i]!=view.ELink_State.READY:view.DesktopMgr.Inst.mode==view.EMJMode.paipu&&(this._player_infos[t].disconnect.visible=!1)}},r.prototype.setBen=function(e){e>99&&(e=99);var t=this.me.getChildByName("container_lefttop"),i=t.getChildByName("num_ben_0"),n=t.getChildByName("num_ben_1");e>=10?(i.skin="myres/mjdesktop/w_"+Math.floor(e/10).toString()+".png",n.skin="myres/mjdesktop/w_"+(e%10).toString()+".png",n.visible=!0):(i.skin="myres/mjdesktop/w_"+(e%10).toString()+".png",n.visible=!1)},r.prototype.setLiqibang=function(e){e>99&&(e=99);var t=this.me.getChildByName("container_lefttop"),i=t.getChildByName("num_lizhi_0"),n=t.getChildByName("num_lizhi_1");e>=10?(n.skin="myres/mjdesktop/w_"+(e%10).toString()+".png",i.skin="myres/mjdesktop/w_"+Math.floor(e/10).toString()+".png",n.visible=!0):(i.skin="myres/mjdesktop/w_"+e.toString()+".png",n.visible=!1)},r.prototype.reset_rounds=function(){this.closeCountDown(),this.showscoredeltaing=!1,view.DesktopMgr.Inst.setScoreDelta(!1);for(var e="myres2/mjp/"+GameMgr.Inst.mjp_view+"/ui/",t=0;t<this.doras.length;t++)this.doras[t].skin=e+"back.png";for(t=0;t<4;t++)this._player_infos[t].container_emo.visible=!1,this._player_infos[t].head.setEmo("");for(t=0;t<this._btn_emos.length;t++)this._btn_emos[t].disabled=!1;this._timecd.reset(),Laya.timer.clearAll(this),Laya.timer.clearAll(this.label_md5),this.container_doras.visible=!0,this.label_md5.visible=!1},r.prototype.showCountDown=function(e,t){this._timecd.showCD(e,t)},r.prototype.setZhenting=function(e){this.img_zhenting.visible=e},r.prototype.shout=function(e,t,i){app.Log.log("shout:"+e+" type:"+t);try{var n=this._player_infos[e],a=n.container_shout,r=a.getChildByName("img_content"),o=a.getChildByName("illust").getChildByName("illust");""==t?r.visible=!1:(r.visible=!0,r.skin="myres/mjdesktop/shout_"+t+".png");switch(t){case"chi":"emoji_1";break;case"peng":"emoji_3";break;case"gang":"emoji_5";break;case"lizhi":"emoji_9"}game.Tools.charaPart(i.avatar_id,o,"half",n.illustrect);var s=0,h=0;switch(e){case 0:s=-105,h=0;break;case 1:s=500,h=0;break;case 2:s=0,h=-300;break;default:s=-500,h=0}a.visible=!0,a.alpha=0,a.x=n.shout_origin_x+s,a.y=n.shout_origin_y+h,Laya.Tween.to(a,{alpha:1,x:n.shout_origin_x,y:n.shout_origin_y},70),Laya.Tween.to(a,{alpha:0},150,null,null,600),Laya.timer.once(800,this,function(){Laya.loader.clearTextureRes(o.skin),a.visible=!1})}catch(e){var l={};l.error=e.message,l.stack=e.stack,l.method="shout",l.class="UI_DesktopInfos",GameMgr.Inst.onFatalError(l)}},r.prototype.closeCountDown=function(){this._timecd.close()},r.prototype.refreshFuncBtnShow=function(e,t){var i=e.getChildByName("img_choosed");e.getChildByName("out").color=t?"#3bd647":"#7992b3",i.visible=t},r.prototype.onShowEmo=function(e,t){var i=this._player_infos[e];if(0==e||!i.headbtn.emj_banned){var n=i.container_emo,a=view.DesktopMgr.Inst.player_datas[(e+view.DesktopMgr.Inst.seat)%4].character.charid;i.emo.setSkin(a,t),n.visible=!0,n.scaleX=n.scaleY=0,Laya.Tween.to(n,{scaleX:1,scaleY:1},120,null,null,0,!0,!0),Laya.timer.once(3e3,this,function(){Laya.Tween.to(n,{scaleX:0,scaleY:0},120,null,null,0,!0,!0)}),Laya.timer.once(3500,this,function(){n.visible=!1})}},r.prototype.changeHeadEmo=function(e,t,i){var n=(e-view.DesktopMgr.Inst.seat+4)%4;this._player_infos[n]},r.prototype.onBtnShowScoreDelta=function(){var e=this;this.showscoredeltaing||(this.showscoredeltaing=!0,view.DesktopMgr.Inst.setScoreDelta(!0),Laya.timer.once(5e3,this,function(){e.showscoredeltaing=!1,view.DesktopMgr.Inst.setScoreDelta(!1)}))},r.prototype.btn_seeinfo=function(t){if(view.DesktopMgr.Inst.mode!=view.EMJMode.paipu&&view.DesktopMgr.Inst.gameing){var i=view.DesktopMgr.Inst.player_datas[(t+view.DesktopMgr.Inst.seat)%4].account_id;0!=i&&e.UI_OtherPlayerInfo.Inst.show(i)}},r.Inst=null,r}(e.UIBase);e.UI_DesktopInfo=a}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(t){function i(){var e=t.call(this,new ui.common.disconnectUI)||this;return e.root=null,e.txt_info=null,e.txt_dot=null,e.state=0,e.count=0,i.Inst=e,e}return __extends(i,t),i.prototype.onCreate=function(){this.root=this.me.getChildByName("root"),this.txt_info=this.root.getChildByName("text"),this.txt_dot=this.root.getChildByName("text_dot")},i.prototype.show=function(){1==this.state||(0==this.state?(this.enable=!0,Laya.timer.clearAll(this),this.refreshInfo(),e.UIBase.anim_pop_out(this.root,null),Laya.timer.loop(500,this,this.refreshInfo)):2==this.state?(Laya.timer.clearAll(this),this.refreshInfo(),Laya.timer.loop(500,this,this.refreshInfo)):3==this.state&&(Laya.timer.clearAll(this),this.refreshInfo(),this.root.scaleX=1,this.root.scaleY=1,this.root.alpha=1,e.UIBase.anim_pop_out(this.root,null),Laya.timer.loop(500,this,this.refreshInfo))),this.state=1,e.UIMgr.Inst.disableMouse()},i.prototype.hide=function(){var t=this;this.state=2,Laya.timer.clearAll(this),Laya.timer.once(1e3,this,function(){t.state=3,e.UIBase.anim_pop_hide(t.root,Laya.Handler.create(t,function(){t.state=0,t.enable=!1,e.UIMgr.Inst.enableMouse()}))})},i.prototype.refreshInfo=function(){this.count=(this.count+1)%4;for(var e="",t=0;t<this.count;t++)e+=".";game.LobbyNetMgr.Inst.connect_state==game.EConnectState.disconnect?(this.txt_info.text="连接已断，请重新登录",this.txt_dot.text=""):game.LobbyNetMgr.Inst.connect_state==game.EConnectState.reconnecting?(this.txt_info.text="断线了，正在努力重连",this.txt_dot.text=e):game.LobbyNetMgr.Inst.connect_state==game.EConnectState.none||game.LobbyNetMgr.Inst.connect_state==game.EConnectState.tryconnect?(this.txt_info.text="未知情况",this.txt_dot.text=""):game.LobbyNetMgr.Inst.connect_state==game.EConnectState.connecting&&(game.MJNetMgr.Inst.connect_state==game.EConnectState.none||game.MJNetMgr.Inst.connect_state==game.EConnectState.tryconnect||game.MJNetMgr.Inst.connect_state==game.EConnectState.connecting?(this.txt_info.text="重连成功",this.txt_dot.text="",this.hide()):game.MJNetMgr.Inst.connect_state==game.EConnectState.disconnect?(this.txt_info.text="连接已断，请重新登录",this.txt_dot.text=""):game.MJNetMgr.Inst.connect_state==game.EConnectState.reconnecting&&(this.txt_info.text="断线了，正在努力重连",this.txt_dot.text=e))},i.Inst=null,i}(e.UIBase);e.UI_Disconnect=t}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(){function e(e){this.scene_entrance="scene/entrance.ls",this.me=e}return e.prototype.show=function(){this.scene=Laya.loader.getRes(this.scene_entrance),this.me.addChild(this.scene),this.scene.visible=!0},e.prototype.close=function(){Laya.timer.clearAll(this),this.scene.visible=!1,this.scene.destroy(!0)},e}(),i=function(){function t(t,i){var n=this;this.btn_cd=0,this.root=t,this.connect_loading=i,this.connect_loading.visible=!1,this.round=this.connect_loading.getChildByName("loading").getChildByName("round"),this.content=this.root.getChildByName("content");var a=function(e){var t={container:e,input:e.getChildByName("txtinput"),lb:e.getChildByName("lb"),yes:e.getChildByName("yes"),no:e.getChildByName("no")};return t.input.text="",t.lb.visible=!0,t.yes.visible=!1,t.no.visible=!1,t.input.on("focus",n,function(){t.lb.visible=!1,t.yes.visible=!1,t.no.visible=!1}),t.input.on("blur",n,function(){t.lb.visible=!t.input.text||""==t.input.text}),t.input.on("input",n,function(){}),t};this.account=a(this.content.getChildByName("container_account")),this.password0=a(this.content.getChildByName("container_mima")),this.password1=a(this.content.getChildByName("container_mima2")),this.btn_close=this.content.getChildByName("btn_close"),this.btn_close.clickHandler=Laya.Handler.create(this,function(){n.locking||n.close()},null,!1),this.btn_regist=this.content.getChildByName("btn_regist"),this.btn_regist.clickHandler=Laya.Handler.create(this,function(){n.locking||n.onRegist()},null,!1),this.root.visible=!1,this.locking=!1,this.container_social=this.content.getChildByName("social"),this.content.getChildByName("social").getChildByName("btn_weibo").clickHandler=Laya.Handler.create(this,function(){s.trySocio(2)},null,!1),this.content.getChildByName("social").getChildByName("btn_weixin").clickHandler=Laya.Handler.create(this,function(){s.trySocio(1)},null,!1),this.content.getChildByName("social").getChildByName("btn_qq").clickHandler=Laya.Handler.create(this,function(){s.trySocio(3)},null,!1),this.container_checkbox=this.content.getChildByName("checkbox"),this.checkbox=this.container_checkbox.getChildByName("checkbox"),this.container_checkbox.getChildByName("btn_lock").clickHandler=Laya.Handler.create(this,function(){e.UI_User_Xieyi.Inst.show(Laya.Handler.create(n,function(){n.onchangecheck(!0)}))},null,!1),this.container_checkbox.getChildByName("btn_check").clickHandler=Laya.Handler.create(this,function(){n.onchangecheck(!n.checkbox.visible)},null,!1)}return t.prototype.close=function(){var t=this;this.locking=!0,e.UIBase.anim_pop_hide(this.content,Laya.Handler.create(this,function(){t.locking=!1,t.root.visible=!1})),Laya.timer.clearAll(this)},t.prototype.show=function(){var t=this;this.root.visible=!0,this.locking=!0,this.btn_cd=0,e.UIBase.anim_pop_out(this.content,Laya.Handler.create(this,function(){t.locking=!1})),this.account.input.text="",this.account.lb.visible=!0,this.account.yes.visible=!1,this.account.no.visible=!1,this.password0.input.text="",this.password0.lb.visible=!0,this.password0.yes.visible=!1,this.password0.no.visible=!1,this.password1.input.text="",this.password1.lb.visible=!0,this.password1.yes.visible=!1,this.password1.no.visible=!1,this.account.container.visible=!0,this.password0.container.visible=!0,this.password1.container.visible=!0,this.connect_loading.visible=!1;var i=Laya.timer.currTimer;Laya.timer.frameLoop(1,this,function(){t.round.rotation=(Laya.timer.currTimer-i)/2e3*360}),this.onchangecheck(!0)},t.prototype.onRegist=function(){var e=this;if(!(Laya.timer.currTimer<this.btn_cd)){var t=this.account.input.text,i=this.password0.input.text,n=this.password1.input.text;t.length<1?this.account.no.visible=!0:s.Accountforbidden(t)?this.account.no.visible=!0:!i||i.length<6?this.password0.no.visible=!0:n==i?(this.btn_cd=Laya.timer.currTimer+800,game.LobbyNetMgr.Inst.isOK?s.Inst._try_regist_account(t,i):(this.account.container.visible=!1,this.password0.container.visible=!1,this.password1.container.visible=!1,this.connect_loading.visible=!0,Laya.timer.once(500,this,function(){game.LobbyNetMgr.Inst.OpenConnect(Laya.Handler.create(e,function(n){n.open?s.Inst._try_regist_account(t,i):n.maintenance?s.Inst.showMaintenance(n.maintenance):s.Inst.showError(n.info),e.account.container.visible=!0,e.password0.container.visible=!0,e.password1.container.visible=!0,e.connect_loading.visible=!1}))}))):this.password1.no.visible=!0}},t.prototype.onchangecheck=function(e){this.checkbox.visible=e,this.btn_regist.visible=e,this.container_social.visible=e},t}(),n=function(){function t(e){var t=this;this.me=e,this.root=this.me.getChildByName("container"),this.info=this.root.getChildByName("text"),this.me.visible=!1,this.root.getChildByName("btn").clickHandler=Laya.Handler.create(this,function(){t.close()},null,!1)}return t.prototype.show=function(t){this.info.text=t,this.me.visible=!0,e.UIBase.anim_pop_out(this.root,null)},t.prototype.close=function(){var t=this;e.UIBase.anim_pop_hide(this.root,Laya.Handler.create(this,function(){t.me.visible=!1}))},t}(),a=function(){function t(e){var t=this;this.me=e,this.root=this.me.getChildByName("container"),this.info=this.root.getChildByName("text"),this.me.visible=!1,this.root.getChildByName("btn").clickHandler=Laya.Handler.create(this,function(){t.close()},null,!1)}return t.prototype.show=function(t){this.info.text=t,this.me.visible=!0,e.UIBase.anim_pop_out(this.root,null)},t.prototype.close=function(){var t=this;e.UIBase.anim_pop_hide(this.root,Laya.Handler.create(this,function(){t.me.visible=!1}))},t}(),r=function(){function t(e){var t=this;this.me=e,this.root=this.me.getChildByName("container"),this.info=this.root.getChildByName("text"),this.me.visible=!1,this.root.getChildByName("btn").clickHandler=Laya.Handler.create(this,function(){t.close()},null,!1)}return t.prototype.show=function(t){this.info.text=t,this.me.visible=!0,e.UIBase.anim_pop_out(this.root,null)},t.prototype.close=function(){var t=this;e.UIBase.anim_pop_hide(this.root,Laya.Handler.create(this,function(){t.me.visible=!1}))},t}(),o=function(){function e(e){this.me=e,this.round=this.me.getChildByName("round"),this.word=this.me.getChildByName("word"),this.icon=this.me.getChildByName("icon"),this.me.visible=!1}return e.prototype.show=function(e){var t=this;if(!this.me.visible){this.me.visible=!0;var i=Laya.timer.currTimer;if(Laya.timer.frameLoop(1,this,function(){t.round.rotation=(Laya.timer.currTimer-i)/2e3*360}),this.word.text="登入中",0==e)this.icon.visible=!1,this.word.y=120;else switch(this.icon.visible=!0,this.word.y=165,e){case 1:case 4:this.icon.skin="myres/entrance/weixin.png";break;case 2:case 5:this.icon.skin="myres/entrance/weibo.png";break;case 3:case 6:this.icon.skin="myres/entrance/QQ.png";break;default:this.icon.visible=!1}}},e.prototype.close=function(){Laya.timer.clearAll(this),this.me.visible=!1},e}(),s=function(s){function h(){var e=s.call(this,new ui.entrance.entranceUI)||this;return e.scene=null,e.txt_account=null,e.txt_password=null,e.btn_login_cd=0,e.login_loading=null,e.page_regist=null,e.container_extendInfo=null,e._errorinfo=null,e._prohibitionInfo=null,e._maintenanceInfo=null,h.Inst=e,e}return __extends(h,s),h.trySocio=function(e){if(GameMgr.inConch){var t=Laya.PlatformClass.createClass("layaair.majsoul.mjmgr");1==e?t.call("wxLogin"):2==e?t.call("weiboLogin"):3==e&&t.call("qqLogin")}else if(GameMgr.iniOSWebview){var i="";switch(e){case 1:i="wxLogin";break;case 2:i="wbLogin";break;case 3:i="qqLogin"}var n=this;Laya.Browser.window.wkbridge.callNative(i,"",function(t){n.onSocioBack(e+3,t)})}else{var a=window.location.href;if(-1!=a.indexOf("?")&&(a=a.split("?")[0]),1==e){r="https://open.weixin.qq.com/connect/qrconnect?";r+="appid=wx2a0c2449cab74448",r+="&response_type=code",r+="&redirect_uri="+encodeURI("http://www.majsoul.com/0?xdsfdl=1-"+a),r+="&scope=snsapi_login",Laya.Browser.window.location.href=r}else if(2==e){r="https://api.weibo.com/oauth2/authorize?";r+="client_id=399644784",r+="&redirect_uri=http://www.majsoul.com/0?xdsfdl=2-"+a,Laya.Browser.window.location.href=r}else if(3==e){var r="https://graph.qq.com/oauth2.0/authorize?";r+="response_type=code",r+="&client_id=101480027",r+="&redirect_uri="+encodeURI("http://www.majsoul.com/0"),r+="&state=xdsfdl3",Laya.Browser.window.location.href=r}}},h.onSocioBack=function(e,t){console.log("!!!!!!!!!!!!!!! "+e+" "+t),this.Inst&&this.Inst._onSocioBack(e,t)},h.prototype.onCreate=function(){var e=this,s=this.me.getChildByName("root");this.container_login=this.me.getChildByName("root").getChildByName("container_login");var l=function(t){var i={container:t,input:t.getChildByName("txtinput"),lb:t.getChildByName("lb")};return i.input.text="",i.lb.visible=!0,i.input.on("focus",e,function(){i.lb.visible=!1}),i.input.on("blur",e,function(){i.lb.visible=!i.input.text||""==i.input.text}),i.input.on("input",e,function(){}),i};this.txt_account=l(this.container_login.getChildByName("container_account")),this.txt_password=l(this.container_login.getChildByName("container_mima")),this.txt_account.input.on(laya.events.Event.KEY_DOWN,this.txt_account.input,function(t){t.keyCode===Laya.Keyboard.ENTER&&e._btn_login()}),this.txt_password.input.on(laya.events.Event.KEY_DOWN,this.txt_account.input,function(t){t.keyCode===Laya.Keyboard.ENTER&&e._btn_login()}),this.container_extendInfo=s.getChildByName("extendinfo"),this.container_extendInfo.visible=!1,this.container_login.getChildByName("btn_regist").clickHandler=Laya.Handler.create(this,function(){e.page_regist.show()},null,!1),this.container_login.getChildByName("btn_enter").clickHandler=Laya.Handler.create(this,this._btn_login,null,!1),this.login_loading=new o(s.getChildByName("loading_login")),this.page_regist=new i(this.me.getChildByName("page_regist"),this.me.getChildByName("regist_connecting")),this._errorinfo=new n(this.me.getChildByName("error")),this._prohibitionInfo=new a(this.me.getChildByName("Prohibition")),this._maintenanceInfo=new r(this.me.getChildByName("maintenance")),this.scene=new t(this.me.getChildByName("scene")),this.container_login.getChildByName("social").getChildByName("btn_weibo").clickHandler=Laya.Handler.create(this,function(){h.trySocio(2)},null,!1),this.container_login.getChildByName("social").getChildByName("btn_weixin").clickHandler=Laya.Handler.create(this,function(){h.trySocio(1)},null,!1),this.container_login.getChildByName("social").getChildByName("btn_qq").clickHandler=Laya.Handler.create(this,function(){h.trySocio(3)},null,!1),this.me.getChildByName("infos").getChildByName("btn").clickHandler=Laya.Handler.create(this,function(){GameMgr.inConch||game.Tools.open_new_window("http://sq.ccm.gov.cn/ccnt/sczr/service/business/emark/toDetail/2c1d78cce7104e28b8898e2c0fc3d803")},null,!1)},h.prototype.show=function(){var e=this;-1!=GameMgr.Inst.beinvited_roomid?(this.container_extendInfo.visible=!0,this.container_extendInfo.getChildAt(0).text="好友房:"+GameMgr.Inst.beinvited_roomid):""!=GameMgr.Inst.outsee_paipuid?(this.container_extendInfo.visible=!0,this.container_extendInfo.getChildAt(0).text="牌谱查阅"):this.container_extendInfo.visible=!1,this.me.getChildByName("root").getChildByName("version").text=game.ResourceVersion.version;var t=Laya.LocalStorage.getItem("_pre_sociotype"),i=Laya.LocalStorage.getItem("ssssoooodd");i||(i="");var n=-1;if(t&&""!=t&&(n=parseInt(t)),app.Log.log("sociotype:"+n),n<0||n>6)this._showContainerLogin();else if(0==n)""!=i?(Laya.timer.once(600,this,function(){e._try_socio_check(n,i)}),this._showLoginLoading(0)):this._showContainerLogin();else{var a=Laya.LocalStorage.getItem("_pre_code");a||(a=""),""!=a||""!=i?(this._showLoginLoading(n),Laya.timer.once(500,this,function(){a&&""!=a?(e._loginby_sociocode(n,a),Laya.LocalStorage.setItem("_pre_code","")):e._try_socio_check(n,i)})):this._showContainerLogin()}this.scene.show(),this.enable=!0},h.prototype._onSocioBack=function(e,t){var i=this;this._showLoginLoading(e),Laya.timer.once(500,this,function(){t&&""!=t?(i._loginby_sociocode(e,t),Laya.LocalStorage.setItem("_pre_code","")):i._showContainerLogin()})},h.prototype._showContainerLogin=function(){var e=Laya.LocalStorage.getItem("account"),t=Laya.LocalStorage.getItem("password");e&&""!=e?(this.txt_account.input.text=e,this.txt_account.lb.visible=!1):(this.txt_account.input.text="",this.txt_account.lb.visible=!0),t&&""!=t?(this.txt_password.input.text=t,this.txt_password.lb.visible=!1):(this.txt_password.input.text="",this.txt_password.lb.visible=!0),this.container_login.visible=!0,this.login_loading.close()},h.prototype._showLoginLoading=function(e){this.container_login.visible=!1,this.login_loading.show(e)},h.prototype._btn_login=function(){var e=this,t=this.txt_account.input.text,i=this.txt_password.input.text;t&&""!=t?i&&""!=i?Laya.timer.currTimer<this.btn_login_cd||(this.multiLogin()?this.showError("您的设备已有账号登录，请勿重复登录"):(this.btn_login_cd=Laya.timer.currTimer+3e3,this._showLoginLoading(0),game.LobbyNetMgr.Inst.isOK?h.Inst._try_login_account(t,i):game.LobbyNetMgr.Inst.OpenConnect(Laya.Handler.create(this,function(n){n.open?h.Inst._try_login_account(t,i):(n.maintenance?e.showMaintenance(n.maintenance):e.showError(n.info),e._showContainerLogin(),e.btn_login_cd=0)})))):this.showError("请输入密码"):this.showError("请输入账号")},h.prototype._try_regist_account=function(e,t){var i=this;app.NetAgent.sendReq2Lobby("Lobby","signup",{account:e,password:GameMgr.encodeP(t)},function(n,a){n?(i.showError("连接出错",n),app.Log.Error(n.message)):a.error?(i.showError("注册出错",a.error.code),app.Log.Error("注册出错，错误码"+JSON.stringify(a))):(Laya.LocalStorage.setItem("account",e),Laya.LocalStorage.setItem("password",t),i._try_login_account(e,t))})},h.prototype._try_login_account=function(e,t){var i=this;if(this.multiLogin())return this.showError("您的设备已有账号登录，请勿重复登录"),void this._showContainerLogin();var n={};GameMgr.inConch?n.device_type="app":(Laya.Browser.onPC&&(n.device_type="pc"),Laya.Browser.onIPad&&(n.device_type="ipad"),Laya.Browser.onMobile&&(n.device_type="mobile")),Laya.Browser.onMac&&(n.os="mac"),Laya.Browser.onIOS&&(n.os="ios"),(Laya.Browser.onAndriod||Laya.Browser.onAndroid)&&(n.os="android"),Laya.Browser.onWeiXin&&(n.browser="weixin"),Laya.Browser.onSafari&&(n.browser="safari"),Laya.Browser.onFirefox&&(n.browser="firefox"),Laya.Browser.onEdge&&(n.browser="edge"),Laya.Browser.onMiniGame&&(n.browser="minigame");var a=[];GameMgr.inGooglePlay&&a.push(1),GameMgr.inChina&&a.push(2),app.NetAgent.sendReq2Lobby("Lobby","login",{account:e,password:GameMgr.encodeP(t),reconnect:!1,device:n,random_key:GameMgr.device_id,client_version:game.ResourceVersion.version,gen_access_token:!0,currency_platforms:a},function(n,a){i.btn_login_cd=0,n?(i.showError("网络出错",n),i._showContainerLogin()):a.error?(503==a.error.code?i.showProhibition(a.error):i.showError("",a.error.code),i._showContainerLogin()):(Laya.LocalStorage.setItem("_pre_sociotype","0"),Laya.LocalStorage.setItem("account",e),Laya.LocalStorage.setItem("password",t),GameMgr.Inst.account=e,GameMgr.Inst.password=t,GameMgr.Inst.sociotype=0,i._onLoginSuccess(0,a))})},h.prototype._loginby_sociocode=function(e,t){var i=this;game.LobbyNetMgr.Inst.isOK?(app.Log.log("_loginby_sociocode sociotype"+e+" code:"+t),app.NetAgent.sendReq2Lobby("Lobby","oauth2Auth",{type:e,code:t},function(t,n){t?(i.showError("连接出错",t),app.Log.Error(t.message),i._showContainerLogin()):(app.Log.log("oauth2Auth res: "+JSON.stringify(n)),n.error?(i.showError("授权出错",n.error.code),i._showContainerLogin()):i._try_socio_check(e,n.access_token))})):game.LobbyNetMgr.Inst.OpenConnect(Laya.Handler.create(this,function(n){n.open?i._loginby_sociocode(e,t):(n.maintenance?i.showMaintenance(n.maintenance):i.showError(n.info),i._showContainerLogin())}))},h.prototype._try_socio_check=function(e,t){var i=this;if(this.multiLogin())return this.showError("您的设备已有账号登录，请勿重复登录"),void this._showContainerLogin();game.LobbyNetMgr.Inst.isOK?(app.Log.log("_try_socio_check sociotype"+e+" access_token:"+t),app.NetAgent.sendReq2Lobby("Lobby","oauth2Check",{type:e,access_token:t},function(n,a){n?(i.showError("连接出错",n),app.Log.Error(n.message),i._showContainerLogin()):(app.Log.log("oauth2Check res: "+JSON.stringify(a)),a.error?(i.showError("检测出错",a.error.code),i._showContainerLogin()):a.has_account?i._try_login_socio(e,t):i._try_regist_socio(e,t))})):game.LobbyNetMgr.Inst.OpenConnect(Laya.Handler.create(this,function(n){n.open?i._try_socio_check(e,t):(n.maintenance?i.showMaintenance(n.maintenance):i.showError(n.info),i._showContainerLogin())}))},h.prototype._try_regist_socio=function(e,t){var i=this;app.Log.log("_try_regist_socio sociotype"+e+" access_token:"+t),app.NetAgent.sendReq2Lobby("Lobby","oauth2Signup",{type:e,access_token:t},function(n,a){n?(i.showError("连接出错",n),app.Log.Error(n.message),i._showContainerLogin()):(app.Log.log("oauth2Signup res: "+JSON.stringify(a)),a.error?(i.showError("注册出错",a.error.code),app.Log.Error("注册出错，错误码"+JSON.stringify(a)),i._showContainerLogin()):i._try_login_socio(e,t))})},h.prototype._try_login_socio=function(e,t){var i=this;if(this.multiLogin())return this.showError("您的设备已有账号登录，请勿重复登录"),void this._showContainerLogin();app.Log.log("_try_login_socio sociotype"+e+" access_token:"+t);var n={};GameMgr.inConch?n.device_type="app":(Laya.Browser.onPC&&(n.device_type="pc"),Laya.Browser.onIPad&&(n.device_type="ipad"),Laya.Browser.onMobile&&(n.device_type="mobile")),Laya.Browser.onMac&&(n.os="mac"),Laya.Browser.onIOS&&(n.os="ios"),(Laya.Browser.onAndriod||Laya.Browser.onAndroid)&&(n.os="android"),Laya.Browser.onWeiXin&&(n.browser="weixin"),Laya.Browser.onSafari&&(n.browser="safari"),Laya.Browser.onFirefox&&(n.browser="firefox"),Laya.Browser.onEdge&&(n.browser="edge"),Laya.Browser.onMiniGame&&(n.browser="minigame");var a=[];GameMgr.inGooglePlay&&a.push(1),GameMgr.inChina&&a.push(2),app.NetAgent.sendReq2Lobby("Lobby","oauth2Login",{type:e,access_token:t,reconnect:!1,device:n,random_key:GameMgr.device_id,client_version:game.ResourceVersion.version,currency_platforms:a},function(n,a){i.btn_login_cd=0,n?(i.showError("网络出错",n),i._showContainerLogin()):(app.Log.log("oauth2Login res: "+JSON.stringify(a)),a.error?(503==a.error.code?i.showProhibition(a.error):i.showError("",a.error.code),i._showContainerLogin()):(Laya.LocalStorage.setItem("_pre_sociotype",e.toString()),Laya.LocalStorage.setItem("ssssoooodd",t),GameMgr.Inst.sociotype=e,GameMgr.Inst.access_token=t,i._onLoginSuccess(e,a)))})},h.prototype._onLoginSuccess=function(t,i){var n=this;if(app.Log.log("登陆："+JSON.stringify(i)),GameMgr.Inst.account_id=i.account_id,GameMgr.Inst.account_data=i.account,GameMgr.Inst.account_numerical_resource={},i.account.platform_diamond)for(var a=i.account.platform_diamond,r=0;r<a.length;r++)GameMgr.Inst.account_numerical_resource[a[r].id]=a[r].count;GameMgr.Inst.account_refresh_time=Laya.timer.currTimer,i.game_info&&(GameMgr.Inst.ingame=!0,GameMgr.Inst.mj_server_url=i.game_info.game_url,GameMgr.Inst.mj_game_token=i.game_info.connect_token,GameMgr.Inst.mj_game_uuid=i.game_info.game_uuid),i.access_token&&(Laya.LocalStorage.setItem("_pre_sociotype",t.toString()),Laya.LocalStorage.setItem("ssssoooodd",i.access_token),GameMgr.Inst.sociotype=t,GameMgr.Inst.access_token=i.access_token),e.UI_Loading.Inst.show("load_lobby"),this.enable=!1,this.scene.close(),this.page_regist.close(),this.login_loading.close(),e.UIMgr.Inst.openLobbyUI(Laya.Handler.create(this,function(){GameMgr.Inst.afterLogin(),GameMgr.Inst.account_data.anti_addiction&&e.UIMgr.Inst.ShowPreventAddiction(),n.destroy(),n.disposeRes()}),Laya.Handler.create(this,function(t){return e.UI_Loading.Inst.setProgressVal(.2*t)},null,!1))},h.prototype.showError=function(e,t){void 0===t&&(t=-1);var i="";e&&(i+=e),-1!=t&&(i.length>0&&(i+=","),cfg.info.error.get(t)?i+=cfg.info.error.get(t).chinese:i+="未知错误("+t+")"),this._errorinfo.show(i)},h.prototype.showProhibition=function(e){var t="你的账号因为违反相关游戏规定被封禁\n";if(e.u32_params&&e.u32_params.length>=2)if(0==e.u32_params[1])t+="永久封禁\n";else{var i=e.u32_params[0]+e.u32_params[1];t+="封禁至："+game.Tools.time2YearMounthDate(i)+" "+game.Tools.time2HourMinute(i)+"\n"}e.str_params&&e.str_params.length>0&&(t+="原因："+e.str_params[0]),this._prohibitionInfo.show(t)},h.prototype.showMaintenance=function(e){this._maintenanceInfo.show(e)},h.Accountforbidden=function(e){var t=!1;return cfg.info.forbidden.forEach(function(i,n){""!=i.word&&e.indexOf(i.word)>=0&&(t=!0)}),t},h.prototype.multiLogin=function(){var e=Laya.LocalStorage.getItem("dolllt");return!(!e||""==e)&&game.Tools.currentTime<parseFloat(e)+1.5},h.prototype.disposeRes=function(){Laya.Loader.clearTextureRes("res/atlas/myres/entrance.atlas"),Laya.loader.getRes("scene/Assets/Resource/entrance/icon_color.png").dispose(!0)},h.Inst=null,h}(e.UIBase);e.UI_Entrance=s}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(t){function i(){var e=t.call(this,new ui.common.errorinfoUI)||this;return e.locking=!1,e}return __extends(i,t),i.prototype.onCreate=function(){this.root=this.me.getChildByName("root"),this.info=this.root.getChildByName("text"),this.blackbg=this.me.getChildByName("blackbg"),this.btn_cancel=this.root.getChildByName("btn_cancel"),this.btn_restart=this.root.getChildByName("btn_restart"),this.btn_cancel.clickHandler=Laya.Handler.create(this,this.close,null,!1),this.btn_restart.clickHandler=Laya.Handler.create(this,function(){if(Laya.Browser.window.conch){Laya.PlatformClass.createClass("layaair.majsoul.mjmgr").call("restart")}else Laya.Browser.window.location.href=GameMgr.Inst.link_url},null,!1),this.btn_restart.visible=!1,this.btn_cancel.visible=!1,this.blackbg.visible=!1},i.prototype.showStr=function(e){this.btn_cancel.visible=!0,this.info.text=e,this._show()},i.prototype.showNetReqError=function(e,t,i){this.btn_cancel.visible=!0;var n="",a="",r=!0;if(GameMgr.inRelease||(n+="发送"+e+"出错\n"),t&&""!=t){var o="";if(o=t.message?t.message:t,a="错误："+o,"TIMEOUT"==o&&(o=cfg.str.str.get(11).desc),n+=o,!GameMgr.inRelease)switch(n+="\n",game.LobbyNetMgr.Inst.connect_state){case game.EConnectState.none:n+="服务器未连接";break;case game.EConnectState.tryconnect:n+="服务器正在尝试连接";break;case game.EConnectState.reconnecting:n+="服务器正在重连";break;case game.EConnectState.connecting:n+="服务器连接正常";break;case game.EConnectState.disconnect:n+="服务器断开连接"}}else if(i&&i.error&&i.error.code){r=!1;var s=i.error.code,h=cfg.info.error.get(s);h?(n+=h.chinese,a=h.chinese):(n+="一个未收录的异常："+s,a="一个未收录的异常："+s)}this.info.text=n,this._show();var l={};l.timestamp=Math.floor(Date.now()/1e3),l.fatal=!1,l.lobby_ip=app.NetAgent.lobby_ip,l.mj_ip=app.NetAgent.mj_ip,GameMgr.Inst&&(l.account_id=GameMgr.Inst.account_id),l.client_version=game.ResourceVersion.version,l.device=game.Tools.deviceInfo,l.method=e,l.send_info=a;var c={};if(c.standardinfo=l,GameMgr.inRelease){if(r){(new Laya.HttpRequest).send(GameMgr.error_url,"data="+JSON.stringify(c),"post")}}else app.Log.log(JSON.stringify(c))},i.prototype.showFatalError=function(){this.enable=!0,this.info.text=cfg.str.str.get(14).desc,this.blackbg.visible=!0,this.btn_restart.visible=!0},i.prototype._show=function(){var t=this;this.me.visible=!0,this.locking=!0,e.UIBase.anim_pop_out(this.root,Laya.Handler.create(this,function(){t.locking=!1}))},i.prototype.close=function(){var t=this;this.locking||(this.locking=!0,e.UIBase.anim_pop_hide(this.root,Laya.Handler.create(this,function(){t.locking=!1,t.me.visible=!1,t.me.destroy(!0)})))},i}(e.UIBase);e.UI_ErrorInfo=t}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t;!function(e){e[e.none=0]="none",e[e.build=1]="build",e[e.showing=2]="showing"}(t||(t={}));var i=function(i){function n(){var e=i.call(this,new ui.mj.fightbeginUI)||this;return e.cells=[],e.effect_winlose=null,e}return __extends(n,i),n.show=function(i){var a=this;app.Log.log("UI_FightBegin show"),null!=this._Inst&&this._Inst.destroy(),this._state=t.build;var r=new n;this._Inst=r,e.UIMgr.Inst.AddMJUI(r),Laya.timer.frameOnce(5,this,function(){i&&i.run(),a._state==t.build?(a._state=t.showing,r._onShow()):a._state==t.none&&r&&(r.destroy(),a._Inst=null)})},n.hide=function(){var e=this;if(app.Log.log("UI_FightBegin hide"),this._state==t.showing){var i=this._Inst._onHide();return Laya.timer.once(i,this,function(){e._Inst.destroy(),e._Inst=null}),this._state=t.none,i}return this._state=t.none,0},n.prototype.onCreate=function(){app.Log.log("UI_FightBegin onCreate");for(var t=0;t<4;t++){var i=this.me.getChildByName("container_"+t.toString());this.cells.push({container:i,body:i.getChildByName("illust").getChildByName("body"),rect:e.UIRect.CreateFromSprite(i.getChildByName("illust").getChildByName("body")),name:i.getChildByName("container_name").getChildByName("label_name"),x:i.x,y:i.y,rank:new e.UI_Level(i.getChildByName("container_name").getChildByName("rank")),title:new e.UI_PlayerTitle(i.getChildByName("container_name").getChildByName("title"))})}},n.prototype._onShow=function(){var e=this;this.enable=!0,app.Log.log("UI_FightBegin _onShow"),this.me.alpha=1;for(var t=function(e){var t=i.cells[e],n=view.DesktopMgr.Inst.player_datas[(view.DesktopMgr.Inst.seat+e)%4];t.name.text=n.nickname,1==e||3==e?game.Tools.charaPart(n.avatar_id,t.body,"full",t.rect):game.Tools.charaPart(n.avatar_id,t.body,"half",t.rect),t.rank.id=n.level.id,t.title.id=n.title;var a=0,r=0;switch(e){case 0:a=1491,r=860;break;case 1:a=2056,r=726;break;case 2:a=-757,r=-875;break;case 3:a=-1298,r=612}t.container.visible=!0,t.container.x=a,t.container.y=r,Laya.timer.once(500,i,function(){Laya.Tween.to(t.container,{x:t.x,y:t.y},400,Laya.Ease.strongIn)})},i=this,n=0;n<4;n++)t(n);Laya.timer.once(700,this,function(){view.AudioMgr.PlayAudio(225)}),Laya.timer.once(1200,this,function(){e.effect_winlose=game.FrontEffect.Inst.create_ui_effect(e.me.getChildByName("container_effect"),"scene/effect_winlose.lh",new Laya.Point(0,0),1)}),Laya.timer.once(2200,this,function(){view.AudioMgr.PlayCharactorSound(view.DesktopMgr.Inst.main_role_character_info,"game_start")})},n.prototype._onHide=function(){var e=this;Laya.timer.clearAll(this);var t="UI_FightBegin _onHide ";if(this.cells){t+="count="+this.cells.length;for(a=0;a<this.cells.length;a++)this.cells[a]?t+="T":t+="N"}else t+="nocells";app.Log.log(t);for(var i=function(e){var t=n.cells[e];if(!t)return"continue";var i=view.DesktopMgr.Inst.player_datas[(view.DesktopMgr.Inst.seat+e)%4];t.name.text=i.nickname;var a=0,r=0;switch(e){case 0:a=1491,r=860;break;case 1:a=2056,r=726;break;case 2:a=-757,r=-875;break;case 3:a=-1298,r=612}Laya.Tween.to(t.container,{x:a,y:r},400,Laya.Ease.strongIn),Laya.timer.once(500,n,function(){Laya.loader.clearTextureRes(t.body.skin),t.container.visible=!1})},n=this,a=0;a<4&&a<this.cells.length;a++)i(a);return this.effect_winlose&&this.effect_winlose.destory(),Laya.timer.once(100,this,function(){Laya.Tween.to(e.me,{alpha:0},300)}),Laya.timer.once(400,this,function(){e.enable=!1}),500},n._Inst=null,n._state=t.none,n}(e.UIBase);e.UI_FightBegin=i}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(){function t(e){var t=this;this.cells=[],this.fun_change=null,this.noinfo=null,this.sortlist=[],this.count_limit=null,this.me=e;var i=this.me.getChildByName("scrollview");this.nolimitlist=i.scriptMap["capsui.NoLimitList"],this.nolimitlist.init_nolimitlist(Laya.Handler.create(this,this._loadInfo,null,!1),Laya.Handler.create(this,function(e){t.setItem(e.index,e.container)},null,!1)),this.nolimitlist.reset(),this.fun_change=Laya.Handler.create(this,this.onListenerMsg,null,!1),this.noinfo=this.me.getChildByName("noinfo"),this.cells=[],this.count_limit=this.me.getChildByName("count_limit"),this.count_limit.text="--/--"}return t.prototype.show=function(){this.me.visible=!0,game.FriendMgr.addListener(this.fun_change),this.refresh()},t.prototype.close=function(){game.FriendMgr.removeListener(this.fun_change),this.me.visible=!1},t.prototype.findcell=function(e){for(var t=0;t<this.cells.length;t++)if(this.cells[t].container===e)return this.cells[t];return null},t.prototype.setItem=function(t,i){var n=this;if(this.me.visible){var r=this.findcell(i);null==r&&(r={container:i,head:new e.UI_Head(i.getChildByName("head")),level:new e.UI_Level(i.getChildByName("rank")),title:new e.UI_PlayerTitle(i.getChildByName("title")),btn_check:i.getChildByName("check"),btn_delete:i.getChildByName("delete"),btn_ob:i.getChildByName("ob"),name:i.getChildByName("name"),state:i.getChildByName("state"),account_id:0},this.cells.push(r));var o=game.FriendMgr.friend_list[this.sortlist[t]];r.head.id=o.base.avatar_id;var s=o.base.level||{id:10101,score:0};r.level.id=s.id,r.title.id=o.base.title,r.name.text=o.base.nickname;var h=r.state,l="";if(o.state.is_online){var c=game.Tools.playState2Desc(o.state.playing);""!=c?(h.text="正在"+c+"对战",h.color="#a9d94d",l=o.state.playing.game_uuid):(h.text="当前在线",h.color="#58c4db")}else h.text=game.Tools.time2Desc(o.state.logout_time)+"离线",h.color="#8c8c8c";var p=o.base.account_id;r.account_id=o.base.account_id,r.btn_check.clickHandler=Laya.Handler.create(this,function(){e.UI_OtherPlayerInfo.Inst.show(p)},null,!1),game.Tools.setGrayDisable(r.btn_delete,!1),r.btn_delete.clickHandler=Laya.Handler.create(this,function(){game.Tools.setGrayDisable(r.btn_delete,!0),e.UI_SecondConfirm.Inst.show("确定要删除好友 "+o.base.nickname+" 吗？",Laya.Handler.create(n,function(){app.NetAgent.sendReq2Lobby("Lobby","removeFriend",{target_id:p},function(t,i){game.Tools.setGrayDisable(r.btn_delete,!1),t||i.error?e.UIMgr.Inst.showNetReqError("removeFriend",t,i):game.FriendMgr.removeFriend(p)})}),Laya.Handler.create(n,function(){game.Tools.setGrayDisable(r.btn_delete,!1)},null,!1),1111,560)},null,!1);var u=r.btn_ob;if(""!=l){var d=0;u.clickHandler=Laya.Handler.create(this,function(){Laya.timer.currTimer<d||(d=Laya.timer.currTimer+1e3,e.UI_Live_Broadcast.fetchInfo(l,Laya.Handler.create(n,function(t){d=0,t.success&&a.Inst.close(Laya.Handler.create(n,function(){e.UI_Live_Broadcast.goToWatch(l,t.data,p)}))},null,!1)))},null,!1),game.Tools.setGrayDisable(u,!1)}else game.Tools.setGrayDisable(u,!0)}},t.prototype.onListenerMsg=function(e){var t=this.nolimitlist.rate;this.refresh(),this.nolimitlist.rate=t},t.prototype._loadInfo=function(e){this.nolimitlist.loadOver(!0,game.FriendMgr.friend_list.length-this.nolimitlist.value_count)},t.prototype.refresh=function(){this.sortlist=[];for(var e=game.FriendMgr.friend_list,t=0;t<e.length;t++)this.sortlist.push(t);this.sortlist=this.sortlist.sort(function(t,i){var n=e[t],a=0;if(n.state.is_online){a+=""!=(s=game.Tools.playState2Desc(n.state.playing))?6e10:3e10,a+=-n.state.login_time}else a+=n.state.logout_time;var r=e[i],o=0;if(r.state.is_online){var s=game.Tools.playState2Desc(r.state.playing);o+=""!=s?6e10:3e10,o+=-r.state.login_time}else o+=r.state.logout_time;return o-a}),this.nolimitlist.reset(),this.nolimitlist.total_count=game.FriendMgr.friend_list.length,this.noinfo.visible=0==this.nolimitlist.total_count,300==game.FriendMgr.friend_max_count?this.count_limit.visible=!1:(this.count_limit.text=e.length+"/"+game.FriendMgr.friend_max_count,this.count_limit.visible=!0)},t}(),i=function(){function t(e){var t=this;this.playerinfos=[],this.me=e;var i=this.me.getChildByName("scrollview");this.nolimitlist=i.scriptMap["capsui.NoLimitList"],this.nolimitlist.init_nolimitlist(Laya.Handler.create(this,this._loadInfo,null,!1),Laya.Handler.create(this,function(e){t.setItem(e.index,e.container,e.cache_data)},null,!1)),this.nolimitlist.reset(),this.noinfo=this.me.getChildByName("noinfo")}return t.prototype.onEnable=function(){this.me.visible=!0,this.refresh()},t.prototype.onDisable=function(){this.me.visible=!1},t.prototype.setItem=function(t,i,n){var a=this;if(this.me.visible){n.hasOwnProperty("name")||(n.head=new e.UI_Head(i.getChildByName("head")),n.level=new e.UI_Level(i.getChildByName("rank")),n.name=i.getChildByName("name"),n.state=i.getChildByName("state"),n.btn_check=i.getChildByName("check"),n.btn_agree=i.getChildByName("agree"),n.btn_reject=i.getChildByName("reject"),n.title=new e.UI_PlayerTitle(i.getChildByName("title")));var r=this.playerinfos[t];n.head.id=r.info.avatar_id,n.level.id=r.info.level.id,n.name.text=r.info.nickname,n.title.id=r.info.title;var o=r.account_id;n.state.text=game.Tools.time2Desc(r.apply_time),n.btn_check.clickHandler=Laya.Handler.create(this,function(){e.UI_OtherPlayerInfo.Inst.show(o)}),game.Tools.setGrayDisable(n.btn_agree,!1),n.btn_agree.clickHandler=Laya.Handler.create(this,function(){game.Tools.setGrayDisable(n.btn_agree,!0),app.NetAgent.sendReq2Lobby("Lobby","handleFriendApply",{target_id:o,method:1},function(t,i){game.Tools.setGrayDisable(n.btn_agree,!1),t||i.error?e.UIMgr.Inst.showNetReqError("handleFriendApply",t,i):a.removeItem(o)})},null,!1),game.Tools.setGrayDisable(n.btn_reject,!1),n.btn_reject.clickHandler=Laya.Handler.create(this,function(){game.Tools.setGrayDisable(n.btn_reject,!0),app.NetAgent.sendReq2Lobby("Lobby","handleFriendApply",{target_id:o,method:2},function(t,i){game.Tools.setGrayDisable(n.btn_reject,!1),t||i.error?e.UIMgr.Inst.showNetReqError("handleFriendApply",t,i):a.removeItem(o)})},null,!1)}},t.prototype.removeItem=function(e){for(var t=-1,i=0;i<this.playerinfos.length;i++)if(this.playerinfos[i].account_id==e){t=i;for(var n=i;n<this.playerinfos.length-1;n++)this.playerinfos[n]=this.playerinfos[n+1];this.playerinfos.pop();break}game.FriendMgr.delFriendApply(e),-1!=t&&this.nolimitlist.delItem(t),a.Inst.refreshRedpoint(),this.noinfo.visible=0==this.playerinfos.length},t.prototype._loadInfo=function(t){for(var i=this,n=[],a=0;a<20&&a+t<this.playerinfos.length;a++)n.push(this.playerinfos[t+a].account_id);0==n.length?(game.Tools.debugFetchMultiAccountBrief("apply_friend",t,this.nolimitlist.total_count,this.nolimitlist.value_count),this.nolimitlist.loadOver(!1,0)):app.NetAgent.sendReq2Lobby("Lobby","fetchMultiAccountBrief",{account_id_list:n},function(n,a){if(n||a.error)e.UIMgr.Inst.showNetReqError("fetchMultiAccountBrief",n,a),i.nolimitlist.loadOver(!1,0);else{for(var r=-1,o=0;o<a.players.length;o++){if(i.playerinfos[t+o].info=a.players[o],i.playerinfos[t+o].account_id!=a.players[o].account_id){r=t+o;break}i.playerinfos[t+o].info=a.players[o]}-1!=r?(e.UIMgr.Inst.ShowErrorInfo("加载第"+(r+1).toString()+"个数据时出错"),i.nolimitlist.loadOver(!1,0)):i.nolimitlist.loadOver(!0,a.players.length)}})},t.prototype.refresh=function(){this.nolimitlist.reset(),this.playerinfos=[],this.noinfo.visible=!1;for(var e=0;e<game.FriendMgr.friendapply_list.length;e++)this.playerinfos.push({account_id:game.FriendMgr.friendapply_list[e].account_id,apply_time:game.FriendMgr.friendapply_list[e].apply_time});this.nolimitlist.total_count=this.playerinfos.length,this.noinfo.visible=0==this.playerinfos.length},t}(),n=function(){function t(e){var t=this;this.playerinfos=[],this.searchend=!1,this.timecd={},this.searchnext=!1,this.me=e;var i=this.me.getChildByName("scrollview");this.nolimitlist=i.scriptMap["capsui.NoLimitList"],this.nolimitlist.init_nolimitlist(Laya.Handler.create(this,this._loadInfo,null,!1),Laya.Handler.create(this,function(e){t.setItem(e.index,e.container,e.cache_data)},null,!1)),this.nolimitlist.reset(),this.input=this.me.getChildByName("input").getChildAt(0),this.btn_search=this.me.getChildByName("search"),this.btn_search.clickHandler=Laya.Handler.create(this,function(){""!=t.input.text&&(t.playerinfos=[],t.nolimitlist.reset(),t.searchnext=!1,t.searchend=!1,t.nolimitlist.total_count=1,game.Tools.setGrayDisable(t.btn_search,!0),Laya.timer.once(3e3,t,function(){game.Tools.setGrayDisable(t.btn_search,!1)}))},null,!1)}return t.prototype.onEnable=function(){this.me.visible=!0,this.nolimitlist.reset(),this.playerinfos=[],this.input.text="",this.searchend=!0,this.timecd={},game.Tools.setGrayDisable(this.btn_search,!1)},t.prototype.onDisable=function(){this.me.visible=!1},t.prototype.setItem=function(t,i,n){var a=this;if(this.me.visible)for(var r=function(r){var s="p"+r;if(!n.hasOwnProperty(s)){var h={container:i.getChildByName(s),head:new e.UI_Head(i.getChildByName(s).getChildByName("head")),add_1:i.getChildByName(s).getChildByName("add_1"),btn_add:i.getChildByName(s).getChildByName("add"),name:i.getChildByName(s).getChildByName("name"),title:new e.UI_PlayerTitle(i.getChildByName(s).getChildByName("title"))};n[s]=h}var l=n[s],c=2*t+r;if(c>=o.playerinfos.length)l.container.visible=!1;else{l.container.visible=!0;var p=o.playerinfos[c];l.head.id=p.info.avatar_id,l.name.text=p.info.nickname,l.title.id=p.info.title;var u=p.account_id;if(game.FriendMgr.find(u))l.add_1.visible=!0,l.btn_add.visible=!1;else{l.add_1.visible=!1,l.btn_add.visible=!0;var d=0;o.timecd.hasOwnProperty(u.toString())&&(d=o.timecd[u.toString()]+1e4-Laya.timer.currTimer)<0&&(d=0);var _=l.btn_add;Laya.timer.clearAll(_),d>0&&(game.Tools.setGrayDisable(_,!0),Laya.timer.once(d,_,function(){game.Tools.setGrayDisable(_,!1)})),game.Tools.setGrayDisable(_,!1),_.clickHandler=Laya.Handler.create(o,function(){game.Tools.setGrayDisable(_,!0),Laya.timer.once(1e4,_,function(){game.Tools.setGrayDisable(_,!1)}),a.timecd[u.toString()]=Laya.timer.currTimer,app.NetAgent.sendReq2Lobby("Lobby","applyFriend",{target_id:u},function(t,i){(t||i.error)&&e.UIMgr.Inst.showNetReqError("applyFriend",t,i)})},null,!1)}}},o=this,s=0;s<2;s++)r(s)},t.prototype._loadInfo=function(t){var i=this;t>=50?this.nolimitlist.loadOver(!1,0):app.NetAgent.sendReq2Lobby("Lobby","searchAccountByPattern",{search_next:this.searchnext,pattern:this.input.text},function(n,a){if(n||a.error)return e.UIMgr.Inst.showNetReqError("fetchAccountState",n,a),void i.nolimitlist.loadOver(!1,0);var r=i.playerinfos.length;if(i.searchend=a.is_finished,i.searchend?i.nolimitlist.total_count=Math.ceil(i.playerinfos.length/2):(i.nolimitlist.total_count=Math.ceil(i.playerinfos.length/2)+1,i.searchnext=!0),a.match_accounts&&0!=a.match_accounts.length){var o=a.match_accounts;0==o.length?(game.Tools.debugFetchMultiAccountBrief("search_friend",t,i.nolimitlist.total_count,i.nolimitlist.value_count),i.nolimitlist.loadOver(!1,0)):app.NetAgent.sendReq2Lobby("Lobby","fetchMultiAccountBrief",{account_id_list:o},function(t,n){if(t||n.error)e.UIMgr.Inst.showNetReqError("fetchMultiAccountBrief",t,n),i.nolimitlist.loadOver(!1,0);else{for(var a=-1,s=0;s<n.players.length;s++){if(o[s]!=n.players[s].account_id){a=r+s;break}i.playerinfos.push({account_id:o[s],info:n.players[s]})}-1!=a?(e.UIMgr.Inst.ShowErrorInfo("加载第"+(a+1).toString()+"个数据时出错"),i.nolimitlist.loadOver(!1,0)):i.nolimitlist.loadOver(!0,Math.ceil(i.playerinfos.length/2)-i.nolimitlist.value_count)}})}else i.nolimitlist.loadOver(!0,0)})},t}(),a=function(a){function r(){var e=a.call(this,new ui.lobby.friendUI)||this;return e.page_friend=null,e.page_apply=null,e.page_search=null,e.root=null,e.top=null,e.tabs=[],e.redpoint=null,e.currentpage=-1,e.locking=!1,r.Inst=e,e}return __extends(r,a),r.prototype.onCreate=function(){var a=this;this.top=this.me.getChildByName("top"),this.root=this.me.getChildByName("root"),this.page_friend=new t(this.root.getChildByName("page_friend")),this.page_apply=new i(this.root.getChildByName("page_apply")),this.page_search=new n(this.root.getChildByName("page_find"));for(var r=0;r<this.root.getChildByName("tabs").numChildren;r++){var o=this.root.getChildByName("tabs").getChildAt(r);o.clickHandler=Laya.Handler.create(this,this.showpage,[r],!1),this.tabs.push(o)}this.redpoint=this.root.getChildByName("tabs").getChildByName("btn_applylist").getChildByName("redpoint"),this.redpoint.visible=!1,this.page_friend.me.visible=!1,this.page_apply.me.visible=!1,this.page_search.me.visible=!1,this.top.getChildByName("btn_back").clickHandler=Laya.Handler.create(this,function(){a.locking||a.close(Laya.Handler.create(a,function(){e.UIMgr.Inst.showLobby()}))},null,!1)},r.prototype.show=function(){var t=this;game.Scene_Lobby.Inst.change_bg("indoor",!1),this.currentpage=-1,this.locking=!0,this.enable=!0,e.UIBase.anim_alpha_in(this.top,{y:-30},200),e.UIBase.anim_alpha_in(this.root,{y:30},200),Laya.timer.once(200,this,function(){t.locking=!1,t.showpage(0)}),this.refreshRedpoint()},r.prototype.refreshRedpoint=function(){this.redpoint.visible=game.FriendMgr.friendapply_list&&game.FriendMgr.friendapply_list.length>0},r.prototype.close=function(t){var i=this;this.locking=!0,e.UIBase.anim_alpha_out(this.top,{y:-30},200),e.UIBase.anim_alpha_out(this.root,{y:30},200),Laya.timer.once(200,this,function(){i.locking=!1,i.enable=!1,t&&t.run()})},r.prototype.onDisable=function(){this.currentpage&&(this.tabs[this.currentpage].skin="myres/shop/tab_unchoose.png",this.currentpage=-1),this.page_friend.close(),this.page_apply.onDisable(),this.page_search.onDisable()},r.prototype.showpage=function(e){if(this.currentpage!=e){if(-1!=this.currentpage)switch(this.tabs[this.currentpage].skin="myres/shop/tab_unchoose.png",this.currentpage){case 0:this.page_friend.close();break;case 1:this.page_apply.onDisable();break;case 2:this.page_search.onDisable()}switch(this.currentpage=e,this.tabs[this.currentpage].skin="myres/shop/tab_choose.png",this.currentpage){case 0:this.page_friend.show();break;case 1:this.page_apply.onEnable();break;case 2:this.page_search.onEnable()}}},r}(e.UIBase);e.UI_Friend=a}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(){function e(e,t,i){this.me=e,this.anim_in=t,this.anim_out=i,this.img_title=this.me.getChildByName("img_title")}return e.prototype.show=function(e){this.img_title.skin=game.LoadMgr.getResImageSkin(cfg.achievement.achievement.find(e).icon),this.anim_in&&this.anim_in.play(0,!1)},e.prototype.hide=function(){this.anim_out.play(0,!1)},e}(),i=function(i){function n(){var e=i.call(this,new ui.mj.gameendUI)||this;return e.btn_next=null,e.players=[],e.root=null,e.illust=null,e.origin_illust_rect=null,e.step=0,e.second_step=0,e.locking=!1,e.page_gettitle=null,e.newachievements=[],e.duringshowing=!1,n.Inst=e,e}return __extends(n,i),n.prototype.onCreate=function(){var i=this;this.root=this.me.getChildByName("root"),this.illust=this.root.getChildByName("illust"),this.origin_illust_rect=e.UIRect.CreateFromSprite(this.illust),this.btn_next=this.root.getChildByName("btn_next"),this.btn_next.clickHandler=Laya.Handler.create(this,function(){i.onConfirm()},null,!1);for(var n=0;n<4;n++){var a=this.me.getChildByName("root").getChildByName("p"+n.toString());this.players.push({root:a,label_name:a.getChildByName("label_name"),label_score:a.getChildByName("val"),container_score:a.getChildByName("container_score"),label_g0:a.getChildByName("img_g0").getChildByName("val"),label_g1:a.getChildByName("img_g1").getChildByName("val"),x:a.x,img_mySelf:a.getChildByName("myself"),head:new e.UI_Head(a.getChildByName("head"))})}this.page_gettitle=new t(this.root.getChildByName("gettitle"),this.me.title_in,this.me.title_out)},n.prototype.show=function(){var t=this,i=view.DesktopMgr.Inst.gameEndResult;if(null==i)return e.UIMgr.Inst.ShowErrorInfo("未拿到最终数据"),void game.Scene_MJ.Inst.GameEnd();this.duringshowing=!0,this.page_gettitle.me.visible=!1,this.root.alpha=0,Laya.Tween.to(this.root,{alpha:1},1e3);for(s=0;s<this.players.length;s++)this.players[s].root.visible=!1;var n=[];n=i.players;var a=view.DesktopMgr.Inst.player_datas[n[0].seat];game.Tools.charaPart(a.avatar_id,this.illust,"full",this.origin_illust_rect),view.DesktopMgr.Inst.mode==view.EMJMode.play&&a.character&&Laya.timer.once(1800+800*n.length-500,this,function(){view.AudioMgr.PlayCharactorSound(a.character,"game_top")});for(var r=function(t){var i=n[t],a=o.players[t];i.gold>0?(a.label_g0.text="+"+i.gold,a.label_g0.color="#4ea583"):(a.label_g0.text=i.gold,a.label_g0.color="#ff3451"),i.grading_score>0?(a.label_g1.text="+"+i.grading_score,a.label_g1.color="#4ea583"):(a.label_g1.text=i.grading_score,a.label_g1.color="#ff3451"),a.label_g1.text=(i.grading_score>0?"+":"")+i.grading_score,a.label_name.text=view.DesktopMgr.Inst.player_datas[i.seat].nickname,a.head.id=view.DesktopMgr.Inst.player_datas[i.seat].avatar_id;var r=i.total_point/1e3;r>0?(a.label_score.text="+"+r.toString(),a.label_score.color="#45c36a"):(a.label_score.text=r.toString(),a.label_score.color="#f94538");for(var s=i.part_point_1.toString(),h=0;h<a.container_score.numChildren;h++)a.container_score.getChildAt(h).visible=!1;for(var l=0;l<s.length&&l<a.container_score.numChildren;l++){var c=a.container_score.getChildByName((a.container_score.numChildren-1-l).toString()),p=s.charAt(l);c.skin="-"==p?"myres/mjdesktop/ww_minus.png":"myres/mjdesktop/ww_"+p+".png",c.visible=!0}a.root.visible=!1,a.img_mySelf.visible=i.seat==view.DesktopMgr.Inst.seat,i.seat==view.DesktopMgr.Inst.seat&&(view.DesktopMgr.Inst.ptchange=i.grading_score),Laya.timer.once(1800+800*t,o,function(){a.root.visible=!0,e.UIBase.anim_alpha_in(a.root,{x:-200},200,0,null,Laya.Ease.strongIn),0==t?view.AudioMgr.PlayAudio(218):view.AudioMgr.PlayAudio(219)})},o=this,s=0;s<n.length;s++)r(s);this.locking=!0,this.btn_next.visible=!1,Laya.timer.once(1800+800*n.length,this,function(){t.locking=!1,t.btn_next.visible=!0}),this.enable=!0,Laya.timer.once(1e3,this,GameMgr.Inst.updateAccountInfo),4==view.DesktopMgr.Inst.game_config.category&&view.DesktopMgr.Inst.mode==view.EMJMode.play&&Laya.timer.once(1100,this,function(){GameMgr.Inst.custom_match_id=view.DesktopMgr.Inst.game_config.meta.customized_contest_uid}),this.step=0},n.prototype.onConfirm=function(){var t=this;if(!this.locking)if(0==this.step)this.step=30,this.onConfirm();else if(30==this.step)view.DesktopMgr.Inst.levelchangeinfo?(this.btn_next.visible=!1,this.closeRankList(Laya.Handler.create(this,function(){e.UI_RankChange.Inst.show(Laya.Handler.create(t,function(){t.step=31,t.btn_next.visible=!0}))}))):(this.step=50,this.onConfirm());else if(31==this.step)e.UI_RankChange.Inst.close(),this.step=50,this.onConfirm();else if(50==this.step)view.DesktopMgr.Inst.rewardinfo&&view.DesktopMgr.Inst.rewardinfo.main_character&&view.DesktopMgr.Inst.rewardinfo.match_chest?(this.btn_next.visible=!1,this.closeRankList(Laya.Handler.create(this,function(){e.UI_MJReward.Inst.show(Laya.Handler.create(t,function(){t.step=51,t.btn_next.visible=!0}))}))):(this.step=60,this.onConfirm());else if(51==this.step)e.UI_MJReward.Inst.close(),this.step=60,this.onConfirm();else if(60==this.step){var i=e.UI_MJTask_Progress.needShow();i.length>0?(this.btn_next.visible=!1,this.closeRankList(Laya.Handler.create(this,function(){e.UI_MJTask_Progress.Inst.show(i,Laya.Handler.create(t,function(){t.step=80,t.btn_next.visible=!0}))}))):(this.step=80,this.onConfirm())}else 80==this.step?(this.step=81,this.onConfirm()):81==this.step&&(this.enable=!1,Laya.loader.clearTextureRes(this.illust.skin),game.Scene_MJ.Inst.GameEnd())},n.prototype.forceclose=function(){this.enable=!1,Laya.timer.clearAll(this)},n.prototype.closeRankList=function(t){var i=this;if(this.duringshowing){this.duringshowing=!1;for(var n=0;n<this.players.length;n++)e.UIBase.anim_alpha_out(this.players[n].root,{x:100},200,0,null,Laya.Ease.backIn);e.UIBase.anim_alpha_out(this.illust,{},200,0,Laya.Handler.create(this,function(){Laya.loader.clearTextureRes(i.illust.skin),game.Tools.charaPart(GameMgr.Inst.account_data.avatar_id,i.illust,"full",i.origin_illust_rect),i.illust.getChildAt(0).visible=!1,e.UIBase.anim_alpha_in(i.illust,{},200,100)})),view.AudioMgr.PlayAudio(228),Laya.timer.once(500,this,function(){t.run()})}else t.run()},n.Inst=null,n}(e.UIBase);e.UI_GameEnd=i}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(t){function i(){var e=t.call(this,new ui.both_ui.getrewardUI)||this;return e.items=[],i.Inst=e,e}return __extends(i,t),i.prototype.onCreate=function(){var t=this;this.root=this.me.getChildByName("root");var i=this.root.getChildByName("items");this.container_items=i;for(var n=0;n<i.numChildren;n++){var a=i.getChildAt(n);this.items.push({container:a,icon:new e.UI_Item_Skin(a.getChildByName("icon")),count:a.getChildByName("count"),name:a.getChildByName("name")})}this.btn_close=this.me.getChildByName("btn_close"),this.btn_close.clickHandler=Laya.Handler.create(this,function(){t.locking||t.close()},null,!1)},i.prototype.show=function(e,t){var i=this;this.enable=!0,this.complete=t;for(var n=function(t){if(t<e.length){a.items[t].container.visible=!0;var n=game.GameUtility.get_item_view(e[t].id);a.items[t].icon.setSkin(n.icon),a.items[t].name.text=n.name,a.items[t].count.text=e[t].count.toString(),a.items[t].container.x=a.container_items.width/2-210*(e.length-1)/2+210*t,a.items[t].container.y=72,a.items[t].container.scaleX=0,a.items[t].container.scaleY=0,a.items[t].container.alpha=0,a.items[t].name.alpha=0,a.items[t].count.alpha=0,Laya.Tween.to(a.items[t].container,{scaleX:1,scaleY:1,alpha:1},200,Laya.Ease.backOut,Laya.Handler.create(a,function(){i.items[t].name.alpha=1,i.items[t].count.alpha=1}),150*t+400)}else a.items[t].container.visible=!1},a=this,r=0;r<this.items.length;r++)n(r);this.btn_close.visible=!1,this.root.alpha=1,this.root.scaleY=1,this.locking=!0,this.me.in.play(0,!1),Laya.timer.once(400+150*this.items.length,this,function(){i.locking=!1,i.btn_close.visible=!0})},i.prototype.close=function(){var e=this;this.locking=!0,this.me.out.play(0,!1),Laya.timer.once(200,this,function(){e.locking=!1,e.enable=!1,e.complete&&e.complete.run()})},i.Inst=null,i}(e.UIBase);e.UI_Getrewardextends=t}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(e){function t(){var i=e.call(this,new ui.both_ui.gettitleUI)||this;return t.Inst=i,i}return __extends(t,e),t.prototype.onCreate=function(){var e=this;this.root=this.me.getChildByName("root"),this.icon=this.root.getChildByName("icon"),this.btn_close=this.me.getChildByName("btn_close"),this.btn_close.clickHandler=Laya.Handler.create(this,function(){e.locking||e.close()},null,!1)},t.prototype.show=function(e,t){var i=this;this.enable=!0,this.complete=t,this.icon.skin=game.LoadMgr.getResImageSkin(cfg.item_definition.title.get(e).icon),this.btn_close.visible=!1,this.root.alpha=1,this.locking=!0,this.me.in.play(0,!1),Laya.timer.once(1e3,this,function(){i.locking=!1,i.btn_close.visible=!0})},t.prototype.close=function(){var e=this;this.locking=!0,this.me.out.play(0,!1),Laya.timer.once(200,this,function(){e.locking=!1,e.enable=!1,e.complete&&e.complete.run()})},t.Inst=null,t}(e.UIBase);e.UI_Gettitle=t}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(t){function i(){var e=t.call(this,new ui.both_ui.gitfcodeUI)||this;return i.Inst=e,e}return __extends(i,t),i.prototype.onCreate=function(){var t=this;this.root=this.me.getChildByName("root"),this.input=this.root.getChildByName("input"),this.root.getChildByName("btn_close").clickHandler=Laya.Handler.create(this,function(){t.locking||t.close()},null,!1),this.btn_confirm=this.root.getChildByName("btn_confirm"),this.btn_confirm.clickHandler=Laya.Handler.create(this,function(){t.locking||t.btn_cd>Laya.timer.currTimer||(t.btn_cd=Laya.timer.currTimer+1e3,app.NetAgent.sendReq2Lobby("Lobby","useGiftCode",{code:t.input.text},function(i,n){t.btn_cd=0,i||n.error?e.UIMgr.Inst.showNetReqError("useGiftCode",i,n):game.Tools.showRewards(n,null)}))},null,!1),this.input.on("input",this,function(){t.btn_confirm.visible=12==t.input.text.length})},i.prototype.show=function(){var t=this;this.enable=!0,this.locking=!0,this.input.text="",this.btn_cd=0,this.btn_confirm.visible=!1,e.UIBase.anim_pop_out(this.root,Laya.Handler.create(this,function(){t.locking=!1}))},i.prototype.close=function(){var t=this;this.locking=!0,e.UIBase.anim_pop_hide(this.root,Laya.Handler.create(this,function(){t.locking=!1,t.enable=!1}))},i.Inst=null,i}(e.UIBase);e.UI_Giftcode=t}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(t){function i(){var e=t.call(this,new ui.common.hangup_logoutUI)||this;return i.Inst=e,e}return __extends(i,t),i.prototype.onCreate=function(){this.root=this.me.getChildByName("root"),this.root.getChildByName("btn").clickHandler=Laya.Handler.create(this,this.hide,null,!1)},i.prototype.show=function(){this.me.visible=!0,app.Log.info_net("UI_Hanguplogout  close net"),game.LobbyNetMgr.Inst.Close(),game.MJNetMgr.Inst&&game.MJNetMgr.Inst.Close(),e.UIBase.anim_pop_out(this.root,null)},i.prototype.hide=function(){if(Laya.Browser.window.conch){Laya.PlatformClass.createClass("layaair.majsoul.mjmgr").call("restart")}else Laya.Browser.window.location.href=GameMgr.Inst.link_url},i.Inst=null,i}(e.UIBase);e.UI_Hanguplogout=t}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(t){function i(){var e=t.call(this,new ui.mj.hu_cutinUI)||this;return e.illust=null,e.rect=null,e.effect=null,e.secen=null,i.Inst=e,e}return __extends(i,t),i.show=function(t){var n=this;this.Inst&&this.Inst.destroy(),e.UIMgr.Inst.AddMJUI(this.Inst=new i);var a=Laya.timer.currFrame;Laya.loader.create("scene/hucutin.ls",Laya.Handler.create(this,function(){var e=5+a-Laya.timer.currFrame;e<0&&(e=1),Laya.timer.frameOnce(e,n,function(){n.Inst._onShow(t)})}))},i.prototype.onCreate=function(){this.illust=this.me.getChildByName("root").getChildByName("container_illust").getChildByName("illust"),this.rect=e.UIRect.CreateFromSprite(this.illust),this.effect=this.me.getChildByName("root").getChildByName("effect"),this.secen=Laya.loader.getRes("scene/hucutin.ls"),this.effect.addChild(this.secen),this.secen.visible=!0},i.prototype._onShow=function(e){var t=this;this.enable=!0,game.Tools.charaPart(e,this.illust,"half",this.rect),this.me.cutin.play(0,!1),view.AudioMgr.PlayAudio(206),Laya.timer.once(1100,this,function(){t.secen.visible=!1}),Laya.timer.once(1800,this,function(){t._onHide()})},i.prototype._onHide=function(){this.enable=!1,Laya.loader.clearTextureRes(this.illust.skin),this.destroy(),i.Inst=null},i.Inst=null,i}(e.UIBase);e.UI_HuCutIn=t}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(e){function t(){var i=e.call(this,new ui.mj.huleshowUI)||this;return i.black_mask=null,i.container_rong=null,i.container_zimo=null,i.container_liuju=null,t.Inst=i,i}return __extends(t,e),t.prototype.onCreate=function(){this.black_mask=this.me.getChildByName("black_mask"),this.container_rong=this.me.getChildByName("container_rong"),this.container_zimo=this.me.getChildByName("container_zimo"),this.container_liuju=this.me.getChildByName("container_liuju")},t.prototype.showRong=function(e){var t=this;this.container_liuju.visible=!1,this.container_zimo.visible=!1,this.container_rong.visible=!0;for(var i=[],n=0;n<4;n++)i.push(this.container_rong.getChildByName(n.toString())),i[n].visible=!1;this.black_mask.alpha=0;for(var a=function(t){var n=i[e[t]];n.visible=!0,n.alpha=0,n.scaleX=3,n.scaleY=3,Laya.Tween.to(n,{alpha:1,scaleX:1,scaleY:1},200,Laya.Ease.strongIn,null,300,!0),Laya.timer.once(300+30*t,r,function(){view.DesktopMgr.Inst.players[e[t]].PlaySound("act_ron")}),Laya.Tween.to(n,{alpha:0},0,Laya.Ease.strongIn,null,1200)},r=this,n=0;n<e.length;n++)a(n);Laya.timer.once(1200,this,function(){t.enable=!1}),this.enable=!0},t.prototype.showZimo=function(e){var t=this;this.container_liuju.visible=!1,this.container_rong.visible=!1,this.container_zimo.visible=!0;for(var i=[],n=0;n<4;n++)i.push(this.container_zimo.getChildByName(n.toString())),i[n].visible=!1;this.black_mask.alpha=0;for(var a=function(t){var n=i[e[t]];n.visible=!0,n.alpha=0,n.scaleX=3,n.scaleY=3,Laya.Tween.to(n,{alpha:1,scaleX:1,scaleY:1},200,Laya.Ease.strongIn,null,300,!0),Laya.timer.once(300,r,function(){view.DesktopMgr.Inst.players[e[t]].PlaySound("act_tumo")}),Laya.Tween.to(n,{alpha:0},0,Laya.Ease.strongIn,null,1200)},r=this,n=0;n<e.length;n++)a(n);Laya.timer.once(1200,this,function(){t.enable=!1}),this.enable=!0},t.prototype.showLiuJu=function(e){var t=this;this.container_liuju.visible=!0,this.container_zimo.visible=!1,this.container_rong.visible=!1;for(var i=[],n=[],a=0;a<4;a++)i.push(this.container_liuju.getChildByName(a.toString())),i[a].visible=!1,n.push(this.container_liuju.getChildByName("no"+a)),n[a].visible=!1;for(a=0;a<4;a++)this.container_liuju.getChildByName("t"+a).visible=!1;this.black_mask.alpha=0,Laya.Tween.to(this.black_mask,{alpha:.4},150);var r=this.container_liuju.getChildByName("title");r.alpha=0,Laya.Tween.to(r,{alpha:1},150);for(var o="myres2/mjp/"+GameMgr.Inst.mjp_view+"/ui/",s=function(t){var n=(t+view.DesktopMgr.Inst.index_ju)%4,a=(n-view.DesktopMgr.Inst.seat+4)%4,r=h.container_liuju.getChildByName("t"+a);if(e[n].tings&&e[n].tings.length>0){var s=i[a];r.visible=!0;for(var l=[],c=0;c<e[n].tings.length;c++)l.push(mjcore.MJPai.Create(e[n].tings[c].tile)),l[c].dora=!1;l=l.sort(mjcore.MJPai.Distance);for(c=0;c<r.numChildren;c++){var p=r.getChildAt(c);c<l.length?(p.visible=!0,p.skin=o+l[c].toString()+".png",p.x=17+66*c):p.visible=!1}var u=34+60*l.length+6*(l.length-1);if(r.width=u,r.width<350||2==a||0==a?r.x=s.x+s.width/2-u/2:1==a?r.x=s.x+350-u:3==a&&(r.x=s.x+s.width/2-175),r.alpha=0,Laya.Tween.to(r,{alpha:1},150,Laya.Ease.strongIn,null,300,!0),s.visible=!0,s.alpha=0,s.skin="myres/mjdesktop/show_tingpai.png",Laya.Tween.to(s,{alpha:1},150,Laya.Ease.strongIn,null,300,!0),n==view.DesktopMgr.Inst.seat){var d=game.Tools.get_chara_audio(view.DesktopMgr.Inst.player_datas[n].character,"gameend_tingpai");d&&Laya.timer.once(300,h,function(){view.AudioMgr.PlaySound(d.path,d.volume,null)})}}else if(r.visible=!1,n==view.DesktopMgr.Inst.seat){var _=game.Tools.get_chara_audio(view.DesktopMgr.Inst.player_datas[n].character,"gameend_noting");_&&Laya.timer.once(300,h,function(){view.AudioMgr.PlaySound(_.path,_.volume,null)})}},h=this,l=0;l<4;l++)s(l);Laya.timer.once(4500,this,function(){t.enable=!1}),this.enable=!0},t.Inst=null,t}(e.UIBase);e.UI_Huleshow=t}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(){function e(e){this.content=null,this.me=e,this.btn_open=this.me.getChildByName("btn_open"),this.title=this.btn_open.getChildByName("info_title"),this.arrow=this.me.getChildByName("btn_open").getChildByName("arrow"),this.container_content=this.btn_open.getChildByName("content"),this.content=this.container_content.getChildAt(0),this.new_flag=this.me.getChildByName("new"),this.btn_cd=0,this.isopen=!1,this.btn_open.clickHandler=Laya.Handler.create(this,this.switchShow,null,!1)}return Object.defineProperty(e.prototype,"h",{get:function(){var e=0;return this.isnew&&(e+=8),e+=90,this.isopen&&(e+=40,e+=this.content_h),e},enumerable:!0,configurable:!0}),e.prototype.onEnable=function(e,t,i){this.announcement_id=e.id,this.title.text=e.title,this.content.text=e.content,this.content_h=this.content.textHeight,this.isopen=i,this.isnew=t,this.btn_cd=0,this.isopen?(this.container_content.alpha=1,this.container_content.visible=!0,this.arrow.rotation=0):(this.container_content.visible=!1,this.arrow.rotation=-180),this.isnew?(this.new_flag.visible=!0,this.btn_open.y=8):(this.new_flag.visible=!1,this.btn_open.y=0),this.me.height=this.h},e.prototype.onDisable=function(){this.announcement_id>0&&this.isopen&&this.isnew&&(app.NetAgent.sendReq2Lobby("Lobby","readAnnouncement",{announcement_id:this.announcement_id},function(e,t){}),i.read_list.push(this.announcement_id),i.Inst.onReadStateChange()),this.announcement_id=-1,this.me.visible=!1},e.prototype.switchShow=function(){var e=this;Laya.timer.currTimer<this.btn_cd||(this.btn_cd=Laya.timer.currTimer+200,Laya.timer.clearAll(this),this.isopen=!this.isopen,this.isopen?(this.container_content.visible=!0,Laya.Tween.to(this.container_content,{alpha:1},200,null,null,0,!0),this.arrow.rotation=0):(this.isnew&&(this.isnew=!1,this.new_flag.visible=!1,Laya.Tween.to(this.btn_open,{y:0},100,Laya.Ease.strongOut),i.read_list.push(this.announcement_id),app.NetAgent.sendReq2Lobby("Lobby","readAnnouncement",{announcement_id:this.announcement_id},function(e,t){}),i.Inst.onReadStateChange()),Laya.Tween.to(this.container_content,{alpha:0},200,null,Laya.Handler.create(this,function(){e.container_content.visible=!1}),0,!0),this.arrow.scaleY=1,this.arrow.rotation=-180),this.me.height=this.h)},e}(),i=function(i){function n(){var e=i.call(this,new ui.lobby.infoUI)||this;return e.items=[],e._last_time=0,n.Inst=e,e}return __extends(n,i),n.lobbyPopout=function(){if(this.first&&this.announcements&&0!=this.announcements.length){for(var e=!1,t=[],i=0;i<n.announcements.length;i++)t.push(i);for(var a={},i=0;i<n.announcement_sort.length;i++)a[n.announcement_sort[i].toString()]=i;t=t.sort(function(e,t){var i=0,r=n.announcements[e].id.toString();i=a.hasOwnProperty(r)?a[r]:1e3+e;var o=0,s=n.announcements[t].id.toString();return o=a.hasOwnProperty(s)?a[s]:1e3+t,i-o}),this.announcements.length>0&&(e=!this.isAnnouncementReaded(this.announcements[t[0]].id)),e&&this.Inst.show()}},Object.defineProperty(n,"haveRedPoint",{get:function(){for(var e=0;e<this.announcements.length;e++)if(!this.isAnnouncementReaded(this.announcements[e].id))return!0;return!1},enumerable:!0,configurable:!0}),n.Init=function(){var t=this;this.read_list=[],app.NetAgent.sendReq2Lobby("Lobby","fetchAnnouncement",{},function(i,n){i||n.error?e.UIMgr.Inst.showNetReqError("fetchAnnouncement",i,n):t._refreshAnnouncements(n)}),app.NetAgent.AddListener2Lobby("NotifyAnnouncementUpdate",Laya.Handler.create(this,this._refreshAnnouncements,null,!1))},n._refreshAnnouncements=function(e){if(e.announcements&&(this.announcements=e.announcements),e.sort&&(this.announcement_sort=e.sort),e.read_list){this.read_list=[];for(var t=0;t<e.read_list.length;t++)this.read_list.push(e.read_list[t])}},n.isAnnouncementReaded=function(e){for(var t=0;t<this.read_list.length;t++)if(this.read_list[t]==e)return!0;return!1},n.prototype.onCreate=function(){var e=this;this.root=this.me.getChildByName("root"),this.root.getChildByName("btn_close").clickHandler=Laya.Handler.create(this,function(){e.locking||e.close()},null,!1),this.panel=this.root.getChildByName("info"),this.panel.vScrollBar.visible=!1,this.item_templete=this.panel.getChildByName("templete"),this.items=[],this.item_templete.visible=!1},n.prototype.show=function(){var i=this;this.enable=!0,this.locking=!0;var a=0;if(n.announcements.length>this.items.length){a=5;for(var r=this.items.length;r<n.announcements.length;r++){var o=this.item_templete.scriptMap["capsui.UICopy"].getNodeClone();this.items.push(new t(o))}}this.root.visible=!1,Laya.timer.frameOnce(a,this,function(){for(var t=[],a=0;a<n.announcements.length;a++)t.push(a);for(var r={},a=0;a<n.announcement_sort.length;a++)r[n.announcement_sort[a].toString()]=a;t=t.sort(function(e,t){var i=0,a=n.announcements[e].id.toString();i=r.hasOwnProperty(a)?r[a]:1e3+e;var o=0,s=n.announcements[t].id.toString();return o=r.hasOwnProperty(s)?r[s]:1e3+t,i-o});for(a=0;a<i.items.length;a++)if(a>=t.length)i.items[a].me.visible=!1;else{i.items[a].me.visible=!0;var o=n.announcements[t[a]];i.items[a].onEnable(o,!n.isAnnouncementReaded(o.id),0==a)}i.panel.vScrollBar.stopScroll(),i.panel.vScrollBar.value=0,i.panel.refresh(),i._last_time=0,i.duringshow=!0,i.panel.vScrollBar.value=0,i.root.visible=!0,e.UIBase.anim_pop_out(i.root,Laya.Handler.create(i,function(){i.locking=!1}))})},n.prototype.close=function(){var t=this;this.duringshow=!1,this.locking=!0,this.panel.vScrollBar.stopScroll(),e.UIBase.anim_pop_hide(this.root,Laya.Handler.create(this,function(){t.locking=!1,t.enable=!1}))},n.prototype.onDisable=function(){this.panel.vScrollBar.stopScroll();for(var e=0;e<this.items.length;e++)this.items[e].me.visible&&this.items[e].onDisable()},n.prototype.update=function(){if(this.duringshow){for(var e=0,t=(this.panel.vScrollBar.value,this.panel.vScrollBar.max,0);t<this.items.length;t++)if(this.items[t].me.visible){var i=this.items[t].me.y,n=Math.abs(i-e);if(n<.001)this.items[t].me.y=e;else{var a=Math.sqrt(2*n/(1400/22500)),r=Laya.timer.currTimer-this._last_time;if(r>=a)this.items[t].me.y=e;else{var o=1400/22500*.5*(a-r)*(a-r);this.items[t].me.y=i<e?e-o:e+o}}e+=this.items[t].h}this.panel.refresh(),this._last_time=Laya.timer.currTimer}},n.prototype.onReadStateChange=function(){e.UI_Lobby.Inst.top.refreshRedpoint()},n.Inst=null,n.announcements=[],n.announcement_sort=[],n.read_list=[],n.first=!0,n}(e.UIBase);e.UI_Info=i}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(t){function i(){var e=t.call(this,new ui.both_ui.infoliteUI)||this;return e.panel=null,e.desc=null,e.locking=!1,i.Inst=e,e}return __extends(i,t),i.prototype.onCreate=function(){var e=this;this.root=this.me.getChildByName("root"),this.panel=this.root.getChildByName("content"),this.panel.vScrollBar.visible=!1,this.desc=this.panel.getChildByName("desc"),this.locking=!1,this.root.getChildByName("btn_confirm").clickHandler=Laya.Handler.create(this,function(){e.close()},null,!1)},i.prototype.show=function(t){var i=this;this.me.visible=!0,this.panel.vScrollBar.value=0,this.desc.text=t,this.desc.height=this.desc.textField.textHeight,this.locking=!0,e.UIBase.anim_pop_out(this.root,Laya.Handler.create(this,function(){i.locking=!1}))},i.prototype.close=function(){var t=this;this.locking=!0,e.UIBase.anim_pop_hide(this.root,Laya.Handler.create(this,function(){t.locking=!1,t.me.visible=!1}))},i.Inst=null,i}(e.UIBase);e.UI_InfoLite=t}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(t){function i(){var e=t.call(this,new ui.mj.info_md5UI)||this;return i.Inst=e,e}return __extends(i,t),i.prototype.onCreate=function(){var e=this;this.root=this.me.getChildByName("root"),this.root.getChildByName("btn_close").clickHandler=Laya.Handler.create(this,function(){e.locking||e.close()},null,!1);var t=this.root.getChildByName("content");t.vScrollBarSkin="",t.refresh()},i.prototype.show=function(){var t=this;this.locking=!0,this.enable=!0,e.UIBase.anim_pop_out(this.root,Laya.Handler.create(this,function(){t.locking=!1}))},i.prototype.close=function(){var t=this;this.locking=!0,e.UIBase.anim_pop_hide(this.root,Laya.Handler.create(this,function(){t.locking=!1,t.enable=!1}))},i}(e.UIBase);e.UI_Info_MD5=t}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(t){function i(){var e=t.call(this,new ui.lobby.introduceUI)||this;return e._blackmask=null,e._root=null,e._content=null,e._locking=!1,e._cells=[],i.Inst=e,e}return __extends(i,t),i.prototype.onCreate=function(){var t=this;this._blackmask=new e.UI_BlackMask(this.me.getChildByName("bmask"),Laya.Handler.create(this,function(){return t._locking},null,!1),Laya.Handler.create(this,this.close,null,!1)),this._root=this.me.getChildByName("root"),this._content=this._root.getChildByName("content"),this._content.vScrollBar.visible=!1;var i=this._content.getChildByName("templete");i.visible=!1,this._cells=[],cfg.rank_introduce.rank.forEach(function(e,n){for(var a=0;a<e.info.length;a++){var r=i.scriptMap["capsui.UICopy"].getNodeClone();t._cells.push(r)}}),Laya.timer.frameOnce(5,this,function(){var e=0,i=[181,165,165,165],n=0,a=0;cfg.rank_introduce.rank.forEach(function(r,o){n=0;for(var s=0;s<r.info.length;s++){var h=t._cells[e++];h.x=n,h.y=a,h.width=i[s],h.height=76;var l=h.getChildByName("bound");l.x=0,l.y=0,l.width=h.width,l.height=h.height;var c=h.getChildByName("info");c.x=0,c.y=0,c.width=h.width/.7,c.height=h.height/.7,c.text=r.info[s],n+=h.width-3}a+=73}),t._content.refresh()})},i.prototype.show=function(){var t=this;this._locking=!0,this.enable=!0,this._blackmask.show(),this._content.vScrollBar.value=0,e.UIBase.anim_pop_out(this._root,Laya.Handler.create(this,function(){t._locking=!1}))},i.prototype.close=function(){var t=this;this._locking=!0,e.UIBase.anim_pop_hide(this._root,Laya.Handler.create(this,function(){t._locking=!1,t.enable=!1}))},i.Inst=null,i}(e.UIBase);e.UI_Introduce=t}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(){function t(t,n){var a=this;this.me=t,t.visible=!1,this.me.x=543,this.me.y=-260,this.data=n,Laya.timer.frameOnce(5,this,function(){a.locking=!0,a.me.visible=!0,Laya.Tween.to(a.me,{y:-44},150,Laya.Ease.strongInOut,Laya.Handler.create(a,function(){a.locking=!1})),a.me.getChildByName("name").text=n.nickname;var t="";switch(n.mode.mode){case 0:t+="一局制:";break;case 1:t+="四人东:";break;case 2:t+="四人南:"}t+=n.room_id.toString(),a.me.getChildByName("room").text=t,a.me.getChildByName("banned").clickHandler=Laya.Handler.create(a,function(){a.locking||(i.addBanned(n.account_id),a.close())},null,!1),a.me.getChildByName("cancel").clickHandler=Laya.Handler.create(a,function(){a.locking||(i.onCancel(n.account_id),a.close())},null,!1),a.me.getChildByName("join").clickHandler=Laya.Handler.create(a,function(){if(!a.locking){if(i.onCancel(n.account_id),game.Scene_MJ.Inst.active)GameMgr.Inst.beinvited_roomid=n.room_id,game.Scene_MJ.Inst.ForceOut(),e.UIMgr.Inst.closeUIWithTag_Lobby(),e.UIMgr.Inst.closeUIWithTag_Both();else{var t=!1,r=Laya.Handler.create(a,function(i){i?app.NetAgent.sendReq2Lobby("Lobby","joinRoom",{room_id:n.room_id},function(i,n){i||n.error?(e.UIMgr.Inst.showNetReqError("joinRoom",i,n),t&&(e.UI_Lobby.Inst.enable=!0)):(e.UIMgr.Inst.closeUIWithTag_Lobby(),e.UIMgr.Inst.closeUIWithTag_Both(),e.UI_WaitingRoom.Inst.updateData(n.room),e.UIMgr.Inst.ShowWaitingRoom())}):t&&(e.UI_Lobby.Inst.enable=!0)},null,!1);e.UI_WaitingRoom.Inst.enable?(t=!0,e.UI_WaitingRoom.Inst.tryToClose(r)):e.UI_PiPei.Inst.enable?e.UI_PiPei.Inst.tryToClose(r):r.runWith(!0)}a.close()}},null,!1),Laya.timer.once(n.time+18e4-Laya.timer.currTimer,a,function(){a.locking||(a.close(),i.onCancel(n.account_id))})})}return t.prototype.close=function(){var e=this;this.locking=!0,Laya.Tween.to(this.me,{y:-260},150,Laya.Ease.strongOut,Laya.Handler.create(this,function(){e.locking=!1,i.Inst.onBlockClose(e)}))},t.prototype.destory=function(){this.me.visible=!1,this.me.destroy(!0),Laya.timer.clearAll(this),Laya.Tween.clearAll(this)},t}(),i=function(i){function n(){var e=i.call(this,new ui.both_ui.inviteUI)||this;return e.templete=null,e._blocks=null,n.Inst=e,e}return __extends(n,i),n.onNewInvite=function(t){var i=JSON.parse(t),n=i.account_id;if(!(this._banneds.hasOwnProperty(n.toString())&&Laya.timer.currTimer<this._banneds[n.toString()]+3e5||e.UI_WaitingRoom.Inst&&e.UI_WaitingRoom.Inst.enable&&e.UI_WaitingRoom.Inst.room_id==i.room_id)){for(var a={time:Laya.timer.currTimer,room_id:i.room_id,mode:i.mode,account_id:i.account_id,nickname:i.nickname},r=0;r<this._invites.length;r++)if(this._invites[r].account_id==n){for(var o=r;o<this._invites.length-1;o++)this._invites[o]=this._invites[o+1];this._invites.pop();break}this._invites.push(a),this.Inst.enable&&this.Inst.popout(a)}},n.addBanned=function(e){this._banneds[e.toString()]=Laya.timer.currTimer,this.onCancel(e)},n.onCancel=function(e){for(var t=0;t<this._invites.length;t++)if(this._invites[t].account_id==e){for(var i=t;i<this._invites.length-1;i++)this._invites[i]=this._invites[i+1];this._invites.pop();break}},n.prototype.onCreate=function(){this.templete=this.me.getChildByName("templete"),this.templete.visible=!1},n.prototype.onEnable=function(){this._blocks=[];for(var e=n._invites,t=[],i=0;i<e.length;i++)Laya.timer.currTimer<e[i].time+12e4&&t.push(e[i]);e=n._invites=t;for(i=0;i<e.length;i++)this.popout(e[i])},n.prototype.onDisable=function(){for(var e=0;e<this._blocks.length;e++)this._blocks[e].destory();this._blocks=[]},n.prototype.popout=function(e){for(var i=[],n=0;n<this._blocks.length;n++)this._blocks[n].data.account_id==e.account_id&&i.push(this._blocks[n]);for(n=0;n<i.length;n++)this.onBlockClose(i[n]);var a=this.templete.scriptMap["capsui.UICopy"].getNodeClone();this._blocks.push(new t(a,e))},n.prototype.onBlockClose=function(e){for(var t=0;t<this._blocks.length;t++)if(e===this._blocks[t]){this._blocks[t]=this._blocks[this._blocks.length-1],e.destory(),this._blocks.pop();break}},n._invites=[],n._banneds={},n}(e.UIBase);e.UI_Invite=i}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(t){function i(){var e=t.call(this,new ui.entrance.ios_webview_updateUI)||this;return i.Inst=e,e}return __extends(i,t),i.show=function(t){var n=new i;e.UIMgr.Inst.AddLobbyUI(n),Laya.timer.frameOnce(5,this,function(){n._show(t)})},i.prototype._show=function(e){this.enable=!0,this.me.getChildByName("root").getChildByName("text").text=e},i}(e.UIBase);e.UI_IOS_Webview_Update=t}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(t){function i(){var e=t.call(this,new ui.both_ui.itemdetailUI)||this;return e.locking=!1,e.click_func=null,e.container_icon=null,i.Inst=e,e}return __extends(i,t),i.prototype.onCreate=function(){var t=this;this.root=this.me.getChildByName("root"),this.name=this.root.getChildByName("label_name"),this.desc=this.root.getChildByName("desc"),this.icon=new e.UI_Item_Skin(this.root.getChildByName("item").getChildByName("icon")),this.container_icon=this.root.getChildByName("item"),this.locking=!1,this.root.getChildByName("btn_close").clickHandler=Laya.Handler.create(this,function(){t.locking||t.close()},null,!1)},i.prototype.show=function(t){var i=this,n=game.GameUtility.get_item_view(t);this.name.text=n.name,this.desc.text=n.desc,this.icon.setSkin(n.icon),this.enable=!0,this.locking=!0,e.UIBase.anim_pop_out(this.root,Laya.Handler.create(this,function(){i.locking=!1}))},i.prototype.close=function(){var t=this;this.locking=!0,e.UIBase.anim_pop_hide(this.root,Laya.Handler.create(this,function(){t.locking=!1,t.enable=!1}))},i}(e.UIBase);e.UI_ItemDetail=t}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(e){function t(){var i=e.call(this,new ui.both_ui.light_tipsUI)||this;return i.locking=!1,t.Inst=i,i}return __extends(t,e),t.prototype.onCreate=function(){var e=this;this.root=this.me.getChildByName("root"),this.info=this.root.getChildByName("info"),this.me.getChildByName("btn_close").clickHandler=Laya.Handler.create(this,function(){e.locking||e.close()},null,!1)},t.prototype.show=function(e){var t=this;this.info.text=e,this.root.height=120+this.info.textField.textHeight,this.enable=!0,this.locking=!0,this.root.scaleY=0,Laya.timer.clearAll(this),Laya.Tween.to(this.root,{scaleY:1},150,null,Laya.Handler.create(this,function(){t.locking=!1})),Laya.timer.once(3e3,this,function(){t.close()})},t.prototype.close=function(){var e=this;this.locking=!0,Laya.timer.clearAll(this),Laya.Tween.to(this.root,{scaleY:0},150,null,Laya.Handler.create(this,function(){e.locking=!1,e.enable=!1}))},t}(e.UIBase);e.UI_LightTips=t}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t;!function(e){e[e.normal=0]="normal",e[e.detail=1]="detail",e[e.liqiing=2]="liqiing"}(t||(t={}));var i=function(i){function n(){var e=i.call(this)||this;return e.c_gang=null,e.com_add_gang=null,e.com_an_gang=null,e.liqi_data=null,e._oplist=[],e.state=t.normal,n.Inst=e,e}return __extends(n,i),n.prototype.show=function(e){this.com_add_gang=[],this.com_an_gang=[],this.liqi_data=[];for(var i=[],n=0;n<e.length;n++)switch(e[n].type){case mjcore.E_PlayOperation.add_gang:this.com_add_gang=e[n].combination;break;case mjcore.E_PlayOperation.an_gang:this.com_an_gang=e[n].combination;break;case mjcore.E_PlayOperation.liqi:i.push("btn_lizhi"),this.liqi_data=e[n].combination;break;case mjcore.E_PlayOperation.zimo:i.push("btn_zimo");break;case mjcore.E_PlayOperation.jiuzhongjiupai:i.push("btn_jiuzhongjiupai")}this.com_add_gang.length+this.com_an_gang.length>0&&i.push("btn_gang"),i.push("btn_cancel"),this._oplist=i,this.showOp(i),this.enable=!0,this.state=t.normal,view.AudioMgr.PlayAudio(202)},n.prototype.onClickOpBtn=function(e){if(view.DesktopMgr.Inst.mode==view.EMJMode.play)switch(view.AudioMgr.PlayAudio(101),e){case"btn_gang":this.onBtn_Gang();break;case"btn_lizhi":this.onBtn_Liqi();break;case"btn_zimo":this.onBtn_Zimo();break;case"btn_cancel":this.onBtn_Cancel();break;case"btn_jiuzhongjiupai":this.onBtn_Liuju()}},n.prototype.onDetailBack=function(){view.DesktopMgr.Inst.mode==view.EMJMode.play&&(this.showOp(this._oplist),view.AudioMgr.PlayAudio(101))},n.prototype.onClickDetail=function(t){view.AudioMgr.PlayAudio(101),this.enable=!1,t<this.com_add_gang.length?app.NetAgent.sendReq2MJ("FastTest","inputOperation",{type:mjcore.E_PlayOperation.add_gang,index:t,timeuse:e.UI_DesktopInfo.Inst._timecd.timeuse},function(e,t){}):app.NetAgent.sendReq2MJ("FastTest","inputOperation",{type:mjcore.E_PlayOperation.an_gang,index:t-this.com_add_gang.length,timeuse:e.UI_DesktopInfo.Inst._timecd.timeuse},function(e,t){}),view.DesktopMgr.Inst.WhenOperationEnd()},n.prototype.onBtn_Gang=function(){if(this.com_an_gang.length+this.com_add_gang.length==1)1==this.com_an_gang.length?app.NetAgent.sendReq2MJ("FastTest","inputOperation",{type:mjcore.E_PlayOperation.an_gang,index:0,timeuse:e.UI_DesktopInfo.Inst._timecd.timeuse},function(e,t){}):app.NetAgent.sendReq2MJ("FastTest","inputOperation",{type:mjcore.E_PlayOperation.add_gang,timeuse:e.UI_DesktopInfo.Inst._timecd.timeuse,index:0},function(e,t){}),this.enable=!1;else{for(var i=[],n=0;n<this.com_add_gang.length;n++)i.push(this.com_add_gang[n]);for(n=0;n<this.com_an_gang.length;n++)i.push(this.com_an_gang[n]);this.showDetail("请选择要杠的牌",i),this.state=t.detail}},n.prototype.onLiqiBack=function(){this.container_btns.visible=!0,this.btn_cancel.visible=!1,view.DesktopMgr.Inst.mainrole.LiQiSelect(null,!1),this.state=t.normal},n.prototype.onBtn_Liqi=function(){this.container_btns.visible=!1,this.btn_cancel.visible=!0,this.btn_cancel.clickHandler=Laya.Handler.create(this,this.onLiqiBack);for(var e=[],i=0;i<this.liqi_data.length;i++)e.push(mjcore.MJPai.Create(this.liqi_data[i]));view.DesktopMgr.Inst.mainrole.LiQiSelect(e,!0),this.state=t.liqiing},n.prototype.onBtn_Zimo=function(){app.NetAgent.sendReq2MJ("FastTest","inputOperation",{type:mjcore.E_PlayOperation.zimo,index:0,timeuse:e.UI_DesktopInfo.Inst._timecd.timeuse},function(e,t){}),view.DesktopMgr.Inst.WhenOperationEnd()},n.prototype.onBtn_Liuju=function(){app.NetAgent.sendReq2MJ("FastTest","inputOperation",{type:mjcore.E_PlayOperation.jiuzhongjiupai,index:0,timeuse:e.UI_DesktopInfo.Inst._timecd.timeuse},function(e,t){}),view.DesktopMgr.Inst.WhenOperationEnd()},n.prototype.onBtn_Cancel=function(){view.DesktopMgr.Inst.mainrole.can_discard||(app.NetAgent.sendReq2MJ("FastTest","inputOperation",{cancel_operation:!0,timeuse:e.UI_DesktopInfo.Inst._timecd.timeuse},function(e,t){}),view.DesktopMgr.Inst.WhenOperationEnd()),this.enable=!1},n.prototype.onDoubleClick=function(e){return this.state==t.detail?(this.onDetailBack(),!1):this.state==t.liqiing?(this.onLiqiBack(),!1):!!e||(this.onBtn_Cancel(),!1)},n.prototype.onDisable=function(){Laya.timer.clearAll(this)},n.Inst=null,n}(e.UI_PlayerOperation);e.UI_LiQiZiMo=i}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(t){function i(){var e=t.call(this,new ui.mj.liujuUI)||this;return e.root=null,e.img_title=null,e}return __extends(i,t),i.prototype.onCreate=function(){this.root=this.me.getChildByName("root"),this.img_title=this.root.getChildByName("title")},i.prototype.Show=function(e){var t=this;this.data=e;var i="",n="";switch(e.type){case mjcore.E_LiuJu.jiuzhongjiupai:i="jiuzhongjiupai",n="gameend_jiuzhongjiupai";break;case mjcore.E_LiuJu.sanjiahule:i="sanjiahule";break;case mjcore.E_LiuJu.sifenglianda:i="sifenglianda",n="gameend_sifenglianda";break;case mjcore.E_LiuJu.sijializhi:i="sijializhi";break;case mjcore.E_LiuJu.sigangsanle:i="sigangsanle",n="gameend_sigangliuju"}this.img_title.skin="myres/mjdesktop/"+i+".png",this.enable=!0,Laya.Tween.from(this.root,{alpha:0},500),""!=n&&view.AudioMgr.PlayCharactorSound(view.DesktopMgr.Inst.main_role_character_info,n),view.DesktopMgr.Inst.mode==view.EMJMode.play?Laya.timer.once(4e3,this,this.onBtnConfirm):Laya.timer.once(4e3,this,function(){t.enable=!1})},i.prototype.onDisable=function(){Laya.timer.clearAll(this)},i.prototype.onBtnConfirm=function(){null!=view.DesktopMgr.Inst.gameEndResult?(e.UIMgr.Inst.ShowGameEnd(),this.enable=!1):(view.DesktopMgr.Inst.Reset(),Laya.timer.once(200,this,function(){app.NetAgent.sendReq2MJ("FastTest","confirmNewRound",{},function(e,t){})}))},i}(e.UIBase);e.UI_LiuJu=t}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t,i=function(){function e(e){var t=this;this._show_hand=!1,this._show_paopai=!1,this.me=e,this._btn_out=this.me.getChildByName("btn_out"),this._btn_out.clickHandler=Laya.Handler.create(this,function(){t.switch()},null,!1),this.me.getChildByName("btn_shoupai").clickHandler=Laya.Handler.create(this,function(){t._show_hand=!t._show_hand,t._choosed_show_hand.visible=t._show_hand,view.DesktopMgr.Inst.onShowHandChange(t._show_hand)},null,!1),this._choosed_show_hand=this.me.getChildByName("btn_shoupai").getChildByName("choosed"),this._choosed_show_paopai=this.me.getChildByName("btn_paopai").getChildByName("choosed"),this.me.getChildByName("btn_paopai").clickHandler=Laya.Handler.create(this,function(){t._show_paopai=!t._show_paopai,t._choosed_show_paopai.visible=t._show_paopai,view.DesktopMgr.Inst.onShowPaopaiChange(t._show_paopai)},null,!1),this._choosed_show_paopai=this.me.getChildByName("btn_paopai").getChildByName("choosed")}return e.prototype.reset=function(){Laya.Tween.clearAll(this),this._show_hand=!1,this.me.x=-258,this._btn_out.disabled=!1,this._choosed_show_hand.visible=this._show_hand,this._show_paopai=!1,this._choosed_show_paopai.visible=this._show_paopai},e.prototype.switch=function(){var e=this,t=-258;this.me.x<-100&&(t=-5),this._btn_out.disabled=!0,Laya.Tween.to(this.me,{x:t},200,Laya.Ease.strongOut,Laya.Handler.create(this,function(){e._btn_out.disabled=!1}),0,!0,!0)},e}();!function(e){e[e.none=0]="none",e[e.gameing=1]="gameing",e[e.end=2]="end",e[e.interrupt=3]="interrupt"}(t||(t={}));var n=function(n){function a(){var e=n.call(this,new ui.mj.live_broadcastUI)||this;return e.state=t.none,e.segments=[],e._time0=0,e._time_start=0,e.segment_index=0,e.unit_index=0,e.during_asknew=!1,e.retry_loadtime=0,e.segment_end_millisecond=0,e.guanzhanconfig=null,e.do_unit_cd=0,a.Inst=e,e}return __extends(a,n),a.fetchInfo=function(t,i){app.NetAgent.sendReq2Lobby("Lobby","fetchGameLiveInfo",{game_uuid:t},function(n,a){n||a.error?(e.UIMgr.Inst.showNetReqError("fetchGameLiveInfo",n,a),i&&i.runWith({success:!1})):(app.Log.log("fetchGameLiveInfo res:"+JSON.stringify(a)),a.left_start_seconds?e.UI_WaitOb.Inst.show(t,a.left_start_seconds,i):i&&i.runWith({success:!0,data:a}))})},a.goToWatch=function(t,i,n){var r=this;app.Log.log("goToWatch res:"+JSON.stringify(i)),e.UI_Loading.Inst.show("enter_mj");for(var o=i.live_head,s=[null,null,null,null],h=0;h<o.players.length;h++){for(var l=-1,c=0;c<o.seat_list.length;c++)if(o.seat_list[c]==o.players[h].account_id){l=c;break}-1!=l?s[l]=o.players[h]:app.Log.Error("goToWatch "+JSON.stringify(o.players[h])+"未找到位置")}var p=o.game_config.mode;p.extendinfo,p.detail_rule&&p.detail_rule.ai_level&&(1===p.detail_rule.ai_level&&"电脑(简单)",p.detail_rule.ai_level);for(h=0;h<s.length;h++)null==s[h]&&(s[h]={nickname:"电脑",avatar_id:400101,level:{id:10101},character:{charid:200001,level:0,exp:0,views:[],skin:400101,is_upgraded:!1}});game.Scene_MJ.Inst.openMJRoom(s,Laya.Handler.create(this,function(){view.DesktopMgr.Inst.initRoom(o.game_config,s,n,view.EMJMode.live_broadcast),e.UI_Loading.Inst.setProgressVal(.7),Laya.timer.once(1e3,r,function(){GameMgr.Inst.EnterMJ(),e.UI_Loading.Inst.setProgressVal(.8),a.Inst.startLive(t,i)})}),Laya.Handler.create(this,function(t){return e.UI_Loading.Inst.setProgressVal(.7*t)},null,!1))},a.prototype.onCreate=function(){this.guanzhanconfig=new i(this.me.getChildByName("config"))},a.prototype.onDisable=function(){Laya.timer.clearAll(this)},a.prototype._doRecord=function(e,t,i){try{switch(view.DesktopMgr.Inst.WhenOperationEnd(),e){case"RecordNewRound":return view.ActionNewRound.record(t,i);case"RecordDiscardTile":return view.ActionDiscardTile.record(t,i);case"RecordDealTile":return view.ActionDealTile.record(t,i);case"RecordChiPengGang":return view.ActionChiPengGang.record(t,i);case"RecordAnGangAddGang":return view.ActionAnGangAddGang.record(t,i);case"RecordHule":return view.ActionHule.record(t);case"RecordLiuJu":return view.ActionLiuJu.record(t);case"RecordNoTile":return view.ActionNoTile.record(t)}}catch(i){var n={};return n.error=i.message,n.stack=i.stack,n.method="ui_live_broadcast doRecord",n.name=e,n.data=t,GameMgr.Inst.onFatalError(n),1e6}return 0},a.prototype._doFastRecord=function(e,t,i){try{switch(e){case"RecordNewRound":view.ActionNewRound.fastrecord(t,i);break;case"RecordDiscardTile":view.ActionDiscardTile.fastrecord(t,i);break;case"RecordDealTile":view.ActionDealTile.fastrecord(t,i);break;case"RecordChiPengGang":view.ActionChiPengGang.fastrecord(t,i);break;case"RecordAnGangAddGang":view.ActionAnGangAddGang.fastrecord(t,i);break;case"RecordHule":view.ActionHule.fastrecord(t);break;case"RecordLiuJu":view.ActionLiuJu.fastrecord(t);break;case"RecordNoTile":view.ActionNoTile.fastrecord(t)}}catch(i){var n={};return n.error=i.message,n.stack=i.stack,n.method="ui_live_broadcast doFastRecord",n.name=e,n.data=t,GameMgr.Inst.onFatalError(n),1e6}},a.prototype._doUnit=function(t,i,n){if(i){if(1==t.category)return this._doFastRecord(t.name,t.data,n),0;if("GameNewRoundState"==t.name){for(a=0;a<t.data.seat_states.length;a++)view.DesktopMgr.player_link_state[a]=t.data.seat_states[a];e.UI_DesktopInfo.Inst.refreshLinks()}else"NotifyGameEndResult"==t.name?(view.DesktopMgr.Inst.gameEndResult=t.data.result,this.enable=!1,e.UIMgr.Inst.ShowGameEnd()):"NotifyPlayerConnectionState"==t.name?e.UI_DesktopInfo.Inst.onPlayerConnectionState(t.data):"GameEndAction"==t.name&&3==t.data.state&&e.UI_Popout.PopOutNoTitle(cfg.str.str.get(16).desc,Laya.Handler.create(this,function(){game.Scene_MJ.Inst.ForceOut()}));return-1}if(1==t.category)return this._doRecord(t.name,t.data,n);if("GameNewRoundState"==t.name){for(var a=0;a<t.data.seat_states.length;a++)view.DesktopMgr.player_link_state[a]=t.data.seat_states[a];e.UI_DesktopInfo.Inst.refreshLinks()}else"NotifyGameEndResult"==t.name?(view.DesktopMgr.Inst.gameEndResult=t.data.result,this.enable=!1,e.UIMgr.Inst.ShowGameEnd()):"NotifyGameBroadcast"==t.name?e.UI_DesktopInfo.Inst.onGameBroadcast(t.data):"NotifyPlayerConnectionState"==t.name?e.UI_DesktopInfo.Inst.onPlayerConnectionState(t.data):"GameEndAction"==t.name&&3==t.data.state&&e.UI_Popout.PopOutNoTitle(cfg.str.str.get(16).desc,Laya.Handler.create(this,function(){game.Scene_MJ.Inst.ForceOut()}));return-1},a.prototype._parseUnit=function(e){var t=net.MessageWrapper.decodeMessage(e.action_data);return{timestamp:e.timestamp,category:e.action_category,name:t.$type.name,data:t}},a.prototype._loadUnit=function(e,t,i){var n=this,a=new Laya.HttpRequest;a.once(Laya.Event.COMPLETE,this,function(t){if(i){var a=new Laya.Byte;a.writeArrayBuffer(t);for(var r=net.MessageWrapper.decodeMessage(a.getUint8Array(0,a.length)),o=[],s=0;s<r.actions.length;s++)o.push(n._parseUnit(r.actions[s]));i.runWith({success:!0,id:e,units:o})}}),a.once(Laya.Event.ERROR,this,function(t){i&&i.runWith({success:!1,id:e})});a.send(t,"","get","arraybuffer",[])},a.prototype.startLive=function(t,i){var n=this;this.segment_index=0,this.segments=[],this._time0=i.now_millisecond;var a=0,r=!1;this.game_uuid=t,this.enable=!0,this.guanzhanconfig.reset(),this.do_unit_cd=0;for(var o=function(t){if(!r)if(t.success){for(var i=0;i<n.segments.length;i++)if(n.segments[i].segment_id==t.id){n.segments[i].units=t.units,n.segments[i].loaded=!0;break}a++,e.UI_Loading.Inst.setProgressVal(.8+a/n.segments.length*.2),a==n.segments.length&&n._onFirstLoadOver()}else r=!0,e.UIMgr.Inst.ShowErrorInfo(cfg.str.str.find(15).desc),n._forceQuit()},s=0;s<i.segments.length;s++){var h=i.segments[s].segment_id,l=i.segments[s].segment_uri;this.segments.push({segment_id:h,uri:l,units:[],loaded:!1}),this._loadUnit(h,l,Laya.Handler.create(this,o))}},a.prototype._onFirstLoadOver=function(){var i=this;if(this._fastSync()){e.UI_Loading.Inst.close(),this.state=t.gameing;var n=this.segments[this.segments.length-1].units,a=n[n.length-1].timestamp;this.segment_end_millisecond=a,Laya.timer.loop(100,this,function(){i._timeDoAction(!1)},null,!0),Laya.timer.loop(1700,this,function(){i._askNewSegment()},null,!1)}},a.prototype._unitIsTimeLast=function(e,t){if(e>=this.segments.length)return!0;var i=this.segments[e];if(!i.loaded)return!0;if(t++,i.units.length<=t){if(e++,t=0,e>=this.segments.length)return!0;if(!(i=this.segments[e]).loaded||0==i.units.length)return!0}var n=this._time0+Laya.timer.currTimer-this._time_start;return i.units[t].timestamp>n},a.prototype._timeDoAction=function(e){if(this.segment_index>=this.segments.length)return!1;var t=this.segments[this.segment_index];if(!t.loaded)return!1;if(this.segment_index==this.segments.length-1&&this.unit_index>=t.units.length)return!1;var i=t.units[this.unit_index],n=this._time0+Laya.timer.currTimer-this._time_start;if(i.timestamp>n)return!0;if("NotifyGameEndResult"==i.name)return!0;if(1==i.category&&Laya.timer.currTimer<this.do_unit_cd&&"RecordNewRound"!=i.name)return!0;var a=this._unitIsTimeLast(this.segment_index,this.unit_index);if(e)a?this._doUnit(i,!0,n-i.timestamp):this._doUnit(i,!0,-1);else{var r=this._doUnit(i,!1,n-i.timestamp);r>0&&(this.do_unit_cd=Laya.timer.currTimer+r)}return this.unit_index++,this.unit_index>=t.units.length&&(this.unit_index=0,this.segment_index++),this._timeDoAction(e)},a.prototype._askNewSegment=function(){var i=this;if(this.state==t.gameing&&!(this.during_asknew||this.retry_loadtime>=3)&&this.segments[this.segments.length-1].loaded){this._time0+Laya.timer.currTimer-this._time_start+15e3<this.segment_end_millisecond||(this.during_asknew=!0,app.NetAgent.sendReq2Lobby("Lobby","fetchGameLiveLeftSegment",{game_uuid:this.game_uuid,last_segment_id:this.segments[this.segments.length-1].segment_id},function(t,n){if(i.during_asknew=!1,t||n.error)i.retry_loadtime++,i.retry_loadtime>=3&&e.UIMgr.Inst.showNetReqError("fetchGameLiveLeftSegment",t,n);else{i.retry_loadtime=0,i.state=n.live_state;var a=n.segments;i.segment_end_millisecond=n.segment_end_millisecond;for(var r=function(e){if(e.success)for(var t=0;t<i.segments.length;t++)if(i.segments[t].segment_id==e.id){i.segments[t].units=e.units,i.segments[t].loaded=!0;break}},o=i.segments[i.segments.length-1].segment_id,s=0;s<a.length;s++){var h=a[s].segment_id,l=a[s].segment_uri;h<=o||(i.segments.push({segment_id:h,uri:l,units:[],loaded:!1}),i._loadUnit(h,l,Laya.Handler.create(i,r,null,!1)))}}}))}},a.prototype._forceQuit=function(){this.state=t.none,this.enable=!1,GameMgr.Inst.EnterLobby()},a.prototype._fastSync=function(){for(var t=-1,i=-1,n=0;n<this.segments.length;n++)for(var a=this.segments[n],r=0;r<a.units.length;r++)a.units[r].timestamp<=this._time0&&"RecordNewRound"==a.units[r].name&&(t=n,i=r);if(-1==t){t=0;for(var a=this.segments[0],r=0;r<a.units.length;r++)if("RecordNewRound"==a.units[r].name){t=0,i=r,this._time0=a.units[r].timestamp-50;break}}return-1==i?(app.Log.Error("给的数据没有RecordNewRound"),e.UIMgr.Inst.ShowErrorInfo(cfg.str.str.find(15).desc),this._forceQuit(),!1):(this.segment_index=t,this.unit_index=i,this._time_start=Laya.timer.currTimer,this._timeDoAction(!0),!0)},a.prototype.onChangeMainbody=function(){this._time0=this._time0+Laya.timer.currTimer-this._time_start,this._time_start=Laya.timer.currTimer,this.do_unit_cd=0,this._fastSync()},a.prototype.onScoreChangeConfirm=function(){if(this.do_unit_cd=0,this.segment_index>=this.segments.length)return!1;var t=this.segments[this.segment_index];if(!t.loaded)return!1;if(this.segment_index==this.segments.length-1&&this.unit_index>=t.units.length)return!1;var i=t.units[this.unit_index];"NotifyGameEndResult"==i.name&&(e.UI_ScoreChange.Inst.enable=!1,this._doUnit(i,!1,0))},a}(e.UIBase);e.UI_Live_Broadcast=n}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(t){function i(){var e=t.call(this,new ui.common.loadingUI)||this;return e.tips=[],e.tips_showindex=0,e.tips_changeCD=0,e.current_progress=0,e.pre_t=0,i.Inst=e,e}return __extends(i,t),i.prototype.onCreate=function(){var e=this;this.img_round=this.me.getChildByName("flower").getChildByName("round"),this.img_shine=this.me.getChildByName("flower").getChildByName("shine"),this.img_loading=this.me.getChildByName("flower").getChildByName("loading"),this.container_waitother=this.me.getChildByName("flower").getChildByName("waitother"),this.waitother_label0=this.container_waitother.getChildByName("count0"),this.waitother_label1=this.container_waitother.getChildByName("count1"),this.label_tips=this.me.getChildByName("tips"),this.progress_bar=this.me.getChildByName("progress"),this.progress_val=this.progress_bar.getChildByName("bar").mask,this.progress_head=this.progress_bar.getChildByName("bar").getChildByName("head"),this.progress_label=this.progress_head.getChildByName("v"),cfg.str.str.forEach(function(t){"fighttips"==t.type&&e.tips.push(t.desc)})},i.prototype.show=function(t){if(this.pre_t=Laya.timer.currTimer,this.current_progress=0,this.progress_val.width=0,this.progress_head.x=0,this.img_loading.skin="myres/necessary/"+t+".png",!this.enable){e.UIMgr.Inst.closeUIWithTag_Both(),this.enable=!0;for(var i=1;i<this.tips.length;i++){var n=Math.floor(Math.random()*(i+1)),a=this.tips[n];this.tips[n]=this.tips[i],this.tips[i]=a}this.tips_showindex=0,this.tips_changeCD=Laya.timer.currTimer+5e3,this.label_tips.text=this.tips[0],this.img_loading.visible=!0,this.container_waitother.visible=!1,this.starttime=Laya.timer.currTimer,this.me.getChildByName("black").visible=!0}},i.prototype.close=function(e){void 0===e&&(e=null),this.enable=!1,e&&e.run()},i.prototype.update=function(){var e=Laya.timer.currTimer-this.pre_t;this.pre_t=Laya.timer.currTimer,this.refresh_flower(),this.refresh_progress(e)},i.prototype.showLoadCount=function(e,t){this.img_loading.visible=!1,this.container_waitother.visible=!0,this.waitother_label0.text=e.toString(),this.waitother_label1.text=t.toString()},i.prototype.setProgressVal=function(e){this.current_progress=e},i.prototype.refresh_flower=function(){var e=Laya.timer.currTimer-this.starttime;e>2e3&&(e=0,this.starttime=Laya.timer.currTimer);var t=e/2e3;if(this.img_round.rotation=360*t,t<.5){i=2*t;this.img_shine.alpha=i*i}else{var i=2-2*t;this.img_shine.alpha=i*i}this.tips_changeCD<=Laya.timer.currTimer&&(this.tips_changeCD=Laya.timer.currTimer+5e3,this.tips_showindex=(this.tips_showindex+1)%this.tips.length,this.label_tips.text=this.tips[this.tips_showindex])},i.prototype.refresh_progress=function(e){var t=this.progress_bar.width*(.8*this.current_progress+.2);if(this.progress_val.width>=t)this.progress_val.width=t;else{var i=(t-this.progress_val.width)/this.progress_bar.width,n=Math.sqrt(4*i)*e/1e3;n>=i?this.progress_val.width=t:this.progress_val.width+=n*this.progress_bar.width}this.progress_head.x=this.progress_val.width,this.progress_label.text=(this.progress_val.width/this.progress_bar.width*100).toFixed(0)+"%"},i.Inst=null,i}(e.UIBase);e.UI_Loading=t}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(){function t(t){this.money=null,this.rank=null,this.me=t,this.label_name=t.getChildByName("label_name"),this.rank=new e.UI_Level(t.getChildByName("rank")),this.money=new e.UI_Money(t,Laya.Handler.create(s.Inst,s.Inst.Hide,null,!1),Laya.Handler.create(this,function(){return s.Inst.locking},null,!1)),this.title=new e.UI_PlayerTitle(t.getChildByName("img_title")),this.btn_playerinfo=t.getChildByName("btn_playerinfo"),this.btn_playerinfo.clickHandler=Laya.Handler.create(this,function(){e.UI_PlayerInfo.Inst.show(),GameMgr.Inst.BehavioralStatistics(13)},null,!1),t.getChildByName("btn_activity").clickHandler=Laya.Handler.create(this,function(){s.Inst.locking||(e.UI_Activity.Inst.show(),GameMgr.Inst.BehavioralStatistics(18))},null,!1),t.getChildByName("btn_rank").clickHandler=Laya.Handler.create(this,function(){s.Inst.locking||(e.UI_Rank.Inst.show(),GameMgr.Inst.BehavioralStatistics(18))},null,!1),t.getChildByName("btn_info").clickHandler=Laya.Handler.create(this,function(){s.Inst.locking||e.UI_Info.Inst.show()},null,!1),t.getChildByName("btn_set").clickHandler=Laya.Handler.create(this,function(){s.Inst.locking||e.UI_Config.Inst.show()},null,!1)}return t.prototype.refresh=function(){var e=GameMgr.Inst.account_data;this.label_name.text=e.nickname,this.title.id=e.title,this.rank.id=e.level.id,this.money.onEnable(),this.refreshRedpoint()},t.prototype.refreshRedpoint=function(){this.me.getChildByName("btn_activity").getChildByName("redpoint").visible=e.UI_Mail.haveRedPoint,this.me.getChildByName("btn_info").getChildByName("redpoint").visible=e.UI_Info.haveRedPoint},t}(),i=function(){function t(e){this.me=e,this.btn_dajiangsai=e.getChildByName("btn_dajiangsai"),this.btn_yibanchang=e.getChildByName("btn_yibanchang"),this.btn_yourenfang=e.getChildByName("btn_yourenfang"),this.btn_yibanchang.clickHandler=Laya.Handler.create(this,function(){s.Inst.setPage(1),GameMgr.Inst.BehavioralStatistics(1)},null,!1),this.btn_yourenfang.clickHandler=Laya.Handler.create(this,function(){s.Inst.setPage(2),GameMgr.Inst.BehavioralStatistics(2)},null,!1),this.btn_dajiangsai.clickHandler=Laya.Handler.create(this,function(){GameMgr.Inst.BehavioralStatistics(3),s.Inst.setPage(3)},null,!1)}return t.prototype.onEnable=function(e){var t=this;this.btn_yibanchang.visible=!1,this.btn_dajiangsai.visible=!1,this.btn_yourenfang.visible=!1,this.btn_yibanchang.alpha=1,this.btn_dajiangsai.alpha=1,this.btn_yourenfang.alpha=1,Laya.timer.once(e,this,function(){view.AudioMgr.PlayAudio(104),t.btn_yibanchang.x=700,t.btn_yibanchang.y=405,t.btn_yibanchang.scaleX=.2,t.btn_yibanchang.scaleY=.2,t.btn_yibanchang.visible=!0,t.btn_yibanchang.alpha=0,Laya.Tween.to(t.btn_yibanchang,{x:1183,y:368,scaleX:1.2,scaleY:1.2,alpha:1},233,function(e,t,i,n){return Laya.Ease.backOut(e,t,i,n,1)})}),Laya.timer.once(e+100,this,function(){view.AudioMgr.PlayAudio(104),t.btn_dajiangsai.x=700,t.btn_dajiangsai.y=530,t.btn_dajiangsai.scaleX=.2,t.btn_dajiangsai.scaleY=.2,t.btn_dajiangsai.visible=!0,t.btn_dajiangsai.alpha=0,Laya.Tween.to(t.btn_dajiangsai,{x:1110,y:547,scaleX:1.2,scaleY:1.2,alpha:1},233,function(e,t,i,n){return Laya.Ease.backOut(e,t,i,n,1)})}),Laya.timer.once(e+200,this,function(){view.AudioMgr.PlayAudio(104),t.btn_yourenfang.x=700,t.btn_yourenfang.y=634,t.btn_yourenfang.scaleX=.2,t.btn_yourenfang.scaleY=.2,t.btn_yourenfang.visible=!0,t.btn_yourenfang.alpha=0,Laya.Tween.to(t.btn_yourenfang,{x:1123,y:736,scaleX:1.2,scaleY:1.2,alpha:1},233,function(e,t,i,n){return Laya.Ease.backOut(e,t,i,n,1)})}),this.me.visible=!0},t.prototype.onDisable=function(t){var i=this;e.UIBase.anim_alpha_out(this.btn_yibanchang,{x:-500,y:450,scaleX:-1,scaleY:-1},200,t,null,Laya.Ease.backIn),e.UIBase.anim_alpha_out(this.btn_dajiangsai,{x:-500,y:150,scaleX:-1,scaleY:-1},200,t,null,Laya.Ease.backIn),e.UIBase.anim_alpha_out(this.btn_yourenfang,{x:-500,y:-150,scaleX:-1,scaleY:-1},200,t,null,Laya.Ease.backIn),Laya.timer.once(200+t,this,function(){i.me.visible=!1})},t}(),n=function(){function t(t){var i=this;this.locking=!1,this.current_choose_room=-1,this.list_room=[],this.list_mode=[],this.in0=!0,this._last_fetch_time=0,this._last_fetch_success=!1,this.me=t,this.btn_back=t.getChildByName("container_title").getChildByName("btn_back"),this.btn_back.clickHandler=Laya.Handler.create(this,function(){i.locking||(i.in0?s.Inst.setPage(0):i.toShow0())},null,!1),this.p0=t.getChildByName("p0"),this.p0.getChildByName("content").vScrollBar.visible=!1,this.content0=this.p0.getChildByName("content");for(var n=GameMgr.Inst.account_data,a=function(t){var a=r.p0.getChildByName("content").getChildByName("btn"+t),o=a.getChildByName("container"),s=o.getChildByName("btn"),h=a.getChildByName("stop"),l=1+3*t,c=cfg.desktop.matchmode.find(l);c.is_open?(s.mouseEnabled=!0,o.filters=[],h.visible=!1,s.clickHandler=Laya.Handler.create(r,function(){if(!i.locking){var a=!0,r="";a&&!c.is_open&&(a=!1,r=cfg.str.str.find(1306).desc),a&&c.glimit_floor&&n.gold<c.glimit_floor&&(a=!1,r=cfg.str.str.find(101).desc),a&&-1!==c.glimit_ceil&&n.gold>c.glimit_ceil&&(a=!1,r=cfg.str.str.find(102).desc),a&&c.level_limit&&n.level.id<c.level_limit&&(a=!1,r=cfg.str.str.find(103).desc),a?i.toShow1(t):e.UIMgr.Inst.ShowErrorInfo(r)}},null,!1)):(s.mouseEnabled=!1,o.filters=[new Laya.ColorFilter(e.GRAY_FILTER)],h.visible=!0),o.getChildByName("btn_tips").clickHandler=Laya.Handler.create(r,function(){i.locking||e.UI_InfoLite.Inst.show(cfg.str.str.find(4+t).desc)},null,!1)},r=this,o=0;o<4;o++)a(o);this.p1=t.getChildByName("p1"),this.p1.getChildByName("content").vScrollBar.visible=!1,this.content1=this.p1.getChildByName("content");for(var h=function(t){l.p1.getChildByName("content").getChildByName("btn"+t).getChildByName("btn").clickHandler=Laya.Handler.create(l,function(){i.locking||(e.UI_PiPei.Inst.show(i.list_mode[t].id),GameMgr.Inst.BehavioralStatistics(8+t))},null,!1),l.p1.getChildByName("content").getChildByName("btn"+t).getChildByName("btn_tips").clickHandler=Laya.Handler.create(l,function(){i.locking||e.UI_InfoLite.Inst.show(cfg.str.str.find(2+t).desc)},null,!1)},l=this,o=0;o<2;o++)h(o);this.onShow0(),this.title=t.getChildByName("container_title").getChildAt(0)}return t.prototype.onEnable=function(e){var t=this;this.content0.vScrollBar.value=0,this.content1.vScrollBar.value=0,view.AudioMgr.PlayAudio(102),Laya.timer.once(e,this,function(){t.me.visible=!0,t.p1.visible=!1,t.locking=!0,t.in0=!0,t.title.text="一般场",t.p0.alpha=1,t.p1.alpha=1,t.title.alpha=1,s.Inst.me.YBin.play(0,!1),t.p0.visible=!1,Laya.timer.once(100,t,function(){t.p0.visible=!0,s.Inst.me.YB2in.play(0,!1)}),Laya.timer.once(300,t,function(){t.locking=!1,t.reset()})});for(var i=0;i<2;i++)this.p1.getChildByName("content").getChildByName("btn"+i).getChildByName("count").text="--";Laya.timer.loop(1e3,this,this._fetchPlayerCount)},t.prototype.reset=function(){for(e=0;e<4;e++)this.p0.getChildByName("content").getChildByName("btn"+e).alpha=1;for(var e=0;e<2;e++)this.p1.getChildByName("content").getChildByName("btn"+e).alpha=1},t.prototype.onDisable=function(e){var t=this;this.locking=!0,Laya.timer.once(e,this,function(){s.Inst.me.YBout.play(0,!1),s.Inst.me.YB1out.play(0,!1),s.Inst.me.YB2out.play(0,!1)}),Laya.timer.once(e+200,this,function(){t.me.visible=!1,t.locking=!1,t.reset(),Laya.timer.clearAll(t)})},t.prototype.onShow0=function(){var e=[];cfg.desktop.matchmode.forEach(function(t,i){if(t.can_sumup){for(var n=!1,a=0;a<e.length;a++)if(e[a].room==t.room){n=!0;break}n||e.push({room:t.room,title:t.room_name})}}),this.list_room=e},t.prototype.onShow1=function(){var e=this;this.content1.vScrollBar.value=0;var t=[];cfg.desktop.matchmode.forEach(function(i,n){0!=i.mode&&e.current_choose_room==i.room&&t.push({mode:i.mode,id:i.id})}),this.list_mode=t,this._last_fetch_time=0,this._last_fetch_success=!0,this._fetchPlayerCount()},t.prototype.toShow0=function(){var e=this;this.locking=!0,this.title.text="一般场",this.in0=!0,s.Inst.me.YB1out.play(0,!1),Laya.timer.once(100,this,function(){view.AudioMgr.PlayAudio(102),e.p0.visible=!0,e.p1.visible=!1,e.p1.alpha=1,e.p0.alpha=1,s.Inst.me.YB2in.play(0,!1),e.onShow0(),e.locking=!1,Laya.timer.once(200,e,function(){e.reset()})})},t.prototype.toShow1=function(e){var t=this;this.locking=!0,this.current_choose_room=this.list_room[e].room,this.title.text=this.list_room[e].title,this.in0=!1,s.Inst.me.YB2out.play(0,!1),Laya.timer.once(100,this,function(){view.AudioMgr.PlayAudio(102),t.p1.visible=!0,t.p0.visible=!1,t.p1.alpha=1,t.p0.alpha=1,s.Inst.me.YB1in.play(0,!1),t.onShow1(),t.locking=!1,Laya.timer.once(200,t,function(){t.reset()})})},t.prototype._fetchPlayerCount=function(){var t=this;if(game.LobbyNetMgr.Inst.isOK&&!this.in0&&this._last_fetch_success&&!(Laya.timer.currTimer<this._last_fetch_time+7e3)){this._last_fetch_time=Laya.timer.currTimer;for(var i=[],n=0;n<this.list_mode.length;n++)i.push(this.list_mode[n].id);this._last_fetch_success=!1,app.NetAgent.sendReq2Lobby("Lobby","fetchCurrentMatchInfo",{mode_list:i},function(i,n){if(i||n.error){e.UIMgr.Inst.showNetReqError("fetchCurrentMatchInfo",i,n);for(a=0;a<2;a++)t.p1.getChildByName("content").getChildByName("btn"+a).getChildByName("count").text="--";t._last_fetch_success=!1}else try{app.Log.log(JSON.stringify(n));for(var a=0;a<n.matches.length;a++){for(var r=n.matches[a].mode_id,o=n.matches[a].playing_count,s=-1,h=0;h<t.list_mode.length;h++)if(t.list_mode[h].id==r){s=h;break}-1!=s&&(t.p1.getChildByName("content").getChildByName("btn"+s).getChildByName("count").text=o.toString())}t._last_fetch_success=!0}catch(i){}})}},t}(),a=function(){function t(t){var i=this;this.me=t,this.btn_back=t.getChildByName("title").getChildByName("btn_back"),this.btn_back.clickHandler=Laya.Handler.create(this,function(){s.Inst.setPage(0)},null,!1),this.btn_create_room=t.getChildByName("content").getChildByName("btn0").getChildByName("btn"),t.getChildByName("content").getChildByName("btn0").getChildByName("btn_tips").clickHandler=Laya.Handler.create(this,function(){e.UI_InfoLite.Inst.show(cfg.str.str.find(8).desc),GameMgr.Inst.BehavioralStatistics(10)},null,!1),this.btn_add_room=t.getChildByName("content").getChildByName("btn1").getChildByName("btn"),t.getChildByName("content").getChildByName("btn1").getChildByName("btn_tips").clickHandler=Laya.Handler.create(this,function(){e.UI_InfoLite.Inst.show(cfg.str.str.find(9).desc)},null,!1),this.btn_create_room.clickHandler=Laya.Handler.create(this,function(){s.Inst.locking||s.Inst.Hide(Laya.Handler.create(i,function(){e.UI_Create_Room.Show()}))},null,!1),this.btn_add_room.clickHandler=Laya.Handler.create(this,function(){e.UI_NumberInput.Inst.show("加入房间",Laya.Handler.create(i,function(t){app.NetAgent.sendReq2Lobby("Lobby","joinRoom",{room_id:t},function(t,i){t||i.error?e.UIMgr.Inst.showNetReqError("joinRoom",t,i):(s.Inst.enable=!1,e.UI_WaitingRoom.Inst.updateData(i.room),e.UIMgr.Inst.ShowWaitingRoom())})}),null),GameMgr.Inst.BehavioralStatistics(11)},null,!1)}return t.prototype.onEnable=function(e){var t=this;Laya.timer.once(e,this,function(){view.AudioMgr.PlayAudio(102),t.me.visible=!0,s.Inst.me.YRin.play(0,!1),t.btn_create_room.visible=!1,t.btn_add_room.visible=!1,t.reset(),t.btn_create_room.visible=!0,t.btn_add_room.visible=!0,s.Inst.me.YR1in.play(0,!1)})},t.prototype.reset=function(){this.btn_add_room.alpha=1,this.btn_create_room.alpha=1,this.me.getChildByName("title").alpha=1},t.prototype.onDisable=function(e){var t=this;s.Inst.me.YRout.play(0,!1),s.Inst.me.YR1out.play(0,!1),Laya.timer.once(200,this,function(){t.me.visible=!1})},t}(),r=function(){function t(t){var i=this;this.btns=[],this.me=t,this.btn_back=t.getChildByName("title").getChildByName("btn_back"),this.btn_back.clickHandler=Laya.Handler.create(this,function(){s.Inst.setPage(0)},null,!1),this.content=t.getChildByName("content");for(var n=function(t){var n=a.content.getChildByName("btn"+t);a.btns.push(n),n.getChildByName("container").getChildByName("btn").clickHandler=Laya.Handler.create(a,function(){s.Inst.locking||0==t&&s.Inst.Hide(Laya.Handler.create(i,function(){e.UI_Match_Lobby.Inst.show()}))},null,!1),n.getChildByName("container").getChildByName("btn_tips").clickHandler=Laya.Handler.create(a,function(){s.Inst.locking||e.UI_InfoLite.Inst.show(cfg.str.str.find(56).desc)},null,!1)},a=this,r=0;r<1;r++)n(r)}return t.prototype.onEnable=function(e){var t=this;Laya.timer.once(e,this,function(){view.AudioMgr.PlayAudio(102),t.me.visible=!0,t.reset(),s.Inst.me.BSin.play(0,!1),s.Inst.me.BS1in.play(0,!1)})},t.prototype.reset=function(){for(var e=0;e<this.btns.length;e++)this.btns[e].visible=!0,this.btns[e].alpha=1;this.me.getChildByName("title").alpha=1},t.prototype.onDisable=function(e){var t=this;s.Inst.me.BSout.play(0,!1),s.Inst.me.BS1out.play(0,!1),Laya.timer.once(200,this,function(){t.me.visible=!1})},t}(),o=function(){function t(t){var i=this;this.me=t;for(var n=function(n){t.getChildAt(n).clickHandler=Laya.Handler.create(a,function(){s.Inst.locking||(0==n?s.Inst.Hide(Laya.Handler.create(i,function(){e.UI_Sushe.Inst.show()})):5==n?s.Inst.Hide(Laya.Handler.create(i,function(){e.UI_Shop.Inst.show()})):3==n?s.Inst.Hide(Laya.Handler.create(i,function(){e.UI_PaiPu.Inst.show()})):1==n?s.Inst.Hide(Laya.Handler.create(i,function(){e.UI_Friend.Inst.show()})):2==n?s.Inst.Hide(Laya.Handler.create(i,function(){e.UI_Ob.Inst.show()})):4==n?s.Inst.Hide(Laya.Handler.create(i,function(){e.UI_Bag.Inst.show()})):6==n&&s.Inst.Hide(Laya.Handler.create(i,function(){e.UI_Treasure.Inst.show()})))},null,!1)},a=this,r=0;r<7;r++)n(r)}return t.prototype.onEnable=function(){this.me.getChildAt(1).getChildByName("redpoint").visible=game.FriendMgr.friendapply_list&&game.FriendMgr.friendapply_list.length>0},t}(),s=function(s){function h(){var e=s.call(this,new ui.lobby.lobbyUI)||this;return e.top=null,e.page0=null,e.page1=null,e.page2=null,e.page3=null,e.btns=null,e.chat_id=0,e.container_chat=null,e.chat_block=null,e.character_skin=null,e.nowpage=0,e.locking=!1,e.sound_channel=null,h.Inst=e,e}return __extends(h,s),h.prototype.onCreate=function(){var s=this;this.top=new t(this.me.getChildByName("container_top")),this.page0=new i(this.me.getChildByName("page0")),this.page1=new n(this.me.getChildByName("page1")),this.page2=new a(this.me.getChildByName("page2")),this.page3=new r(this.me.getChildByName("page3")),this.btns=new o(this.me.getChildByName("container_btns")),this.character_skin=new e.UI_Character_Skin(this.me.getChildByName("illust").getChildByName("illust")),this.container_chat=this.me.getChildByName("illust").getChildByName("chat"),this.container_chat.visible=!1,this.chat_block=new e.UI_Character_Chat(this.container_chat),this.me.getChildByName("illust").getChildByName("btn").clickHandler=Laya.Handler.create(this,function(){h.login_helloed&&(s.sound_channel?s.stopsay():s.say("lobby_normal"))},null,!1)},h.prototype.onEnable=function(){this.showEnter(),e.UI_TanfangRoot.Inst.beginload()},h.prototype.onDisable=function(){this.page0.onDisable(0),this.page1.onDisable(0),this.page2.onDisable(0),this.page3.onDisable(0),this.character_skin.clear(),this.stopsay()},h.prototype.showEnter=function(){var e=this;this.refreshInfo(),this.page0.me.visible=!0,this.page1.me.visible=!1,this.page2.me.visible=!1,this.page3.me.visible=!1,this.nowpage=0,this.locking=!0,this.me.in.play(0,!1),this.page0.onEnable(567),this.btns.onEnable(),Laya.timer.once(700,this,function(){e.locking=!1}),game.Scene_Lobby.Inst.change_bg("yard",!1),h.login_helloed||Laya.timer.once(500,this,function(){h.login_helloed=!0,e.say("lobby_playerlogin")})},h.prototype.refreshInfo=function(){GameMgr.Inst.account_data;this.top.refresh(),this.character_skin.setSkin(GameMgr.Inst.account_data.avatar_id,"full"),this.character_skin.me.visible=!0},h.prototype.getContainer=function(e){switch(e){case 0:return this.page0.me;case 1:return this.page1.me;case 2:return this.page2.me}return null},h.prototype.Hide=function(e){var t=this;this.locking=!0;this.getContainer(this.nowpage);switch(this.nowpage){case 0:this.page0.onDisable(0);break;case 1:this.page1.onDisable(0);break;case 2:this.page2.onDisable(0);break;case 3:this.page3.onDisable(0)}this.me.out.play(0,!1),Laya.timer.once(250,this,function(){t.locking=!1,t.enable=!1,e&&e.run()})},h.prototype.setPage=function(e){var t=this;if(!this.locking&&this.nowpage!=e){switch(this.locking=!0,this.nowpage){case 0:this.page0.onDisable(0);break;case 1:this.page1.onDisable(0);break;case 2:this.page2.onDisable(0);break;case 3:this.page3.onDisable(0)}this.nowpage=e;var i=750;switch(this.nowpage){case 0:this.page0.onEnable(200);break;case 1:this.page1.onEnable(200);break;case 2:this.page2.onEnable(200);break;case 3:this.page3.onEnable(200),i=500}Laya.timer.once(i,this,function(){t.locking=!1})}},h.prototype.say=function(t){var i=this,n=e.UI_Sushe.main_chara_info;this.chat_id++;var a=this.chat_id,r=view.AudioMgr.PlayCharactorSound(n,t,Laya.Handler.create(this,function(){Laya.timer.once(1e3,i,function(){i.chat_id==a&&i.stopsay()})}));r&&(this.chat_block.show(r.words),this.sound_channel=r.sound)},h.prototype.stopsay=function(){this.chat_block.close(!1),this.sound_channel&&(this.sound_channel.stop(),Laya.SoundManager.removeChannel(this.sound_channel),this.sound_channel=null)},h.Inst=null,h.login_helloed=!1,h}(e.UIBase);e.UI_Lobby=s}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t;!function(e){e[e.none=0]="none",e[e.channel=1]="channel",e[e.person=2]="person"}(t||(t={}));var i=function(e){function i(){var n=e.call(this,new ui.lobby.lobbychatUI)||this;return n.render_text=null,n.btn_switch=null,n.container_main=null,n.left_heads=null,n.chattype=t.none,n.chat_account_id=0,i.Inst=n,n}return __extends(i,e),i.prototype.onCreate=function(){},i.prototype.onShow=function(){},i.prototype.onHide=function(){},i.prototype.onReceivePersonMsg=function(e){},i.prototype.onReceiveWorldMsg=function(){},i.prototype.firstRefresh=function(){},i.Inst=null,i}(e.UIBase);e.UI_LobbyChat=i}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(){function t(e){var t=this;this.locking=!1,this.match_id=0,this.contest_id=0,this.me=e,this.root=e.getChildByName("root"),this.label_name=this.root.getChildByName("name"),this.label_starttime=this.root.getChildByName("starttime");var i=this.root.getChildByName("infos");this.panel=i.getChildByName("content"),this.panel.vScrollBarSkin="",this.label_info=this.panel.getChildByName("label_info"),this.scrollbar=i.getChildByName("scrollbar"),this.scrollpoint=this.scrollbar.getChildByName("scrollpoint"),this.panel.vScrollBar.on("change",this,function(){}),this.root.getChildByName("btn_close").clickHandler=Laya.Handler.create(this,function(){t.locking||t.close()},null,!1),this.root.getChildByName("btn_close1").clickHandler=Laya.Handler.create(this,function(){t.locking||t.close()},null,!1),this.root.getChildByName("btn_enter").clickHandler=Laya.Handler.create(this,function(){t.locking||(t.close(),n.Inst.enter_match(t.match_id,t.contest_id))},null,!1)}return t.prototype.show=function(t){var i=this;this.locking=!0,this.me.visible=!0,e.UIBase.anim_pop_out(this.root,Laya.Handler.create(this,function(){i.locking=!1})),this.label_name.text=t.contest_name,this.label_starttime.text=game.Tools.time2YearMounthDate(t.start_time)+" "+game.Tools.time2HourMinute(t.start_time,!0)+" 到 "+game.Tools.time2YearMounthDate(t.finish_time)+" "+game.Tools.time2HourMinute(t.finish_time,!0),this.match_id=t.unique_id,this.contest_id=t.contest_id,this.label_info.text=game.Tools.strWithoutForbidden(t.public_notice),this.label_info.height=this.label_info.textField.textHeight,this.panel.vScrollBar.value=0,this.panel.refresh(),this.scrollbar.visible=this.label_info.height>this.panel.height,this.refresh_scrollbar()},t.prototype.close=function(){var t=this;this.locking=!0,e.UIBase.anim_pop_hide(this.root,Laya.Handler.create(this,function(){t.locking=!1,t.me.visible=!1}))},t.prototype.refresh_scrollbar=function(){if(this.label_info.height>this.panel.height){var e=this.panel.vScrollBar.value/this.panel.vScrollBar.max;this.scrollpoint.height=this.scrollbar.height*this.panel.height/this.label_info.height,this.scrollpoint.y=e*this.scrollbar.height*(1-this.panel.height/this.label_info.height)}},t}(),i=function(){function t(t){var i=this;this.have_data=!1,this.match_infos={},this.match_ids=[],this.only_follow=!1,this.all_match_list=[],this.follow_changed=!1,this.me=t,t.getChildByName("btn_checkmatchID").clickHandler=Laya.Handler.create(this,function(){e.UI_NumberInput.Inst.show("进入赛事",Laya.Handler.create(i,function(t){for(var a=-1,r=0;r<i.all_match_list.length;r++)if(i.match_infos[i.all_match_list[r]].contest_id==t){a=i.all_match_list[r];break}-1!=a?n.Inst.enter_match(a,t):app.NetAgent.sendReq2Lobby("Lobby","fetchCustomizedContestByContestId",{contest_id:t},function(i,a){i||a.error?e.UIMgr.Inst.showNetReqError("fetchCustomizedContestByContestId",i,a):a.contest_info?n.Inst.enter_match(a.contest_info.unique_id,t):e.UIMgr.Inst.ShowErrorInfo("未找到比赛ID:"+t)})}))},null,!1),this.input=t.getChildByName("input").getChildByName("txtinput"),t.getChildByName("input").getChildByName("btn_searchname").clickHandler=Laya.Handler.create(this,function(){i.refresh_match_list(-1,i.input.text)},null,!1),this.input.on(laya.events.Event.KEY_DOWN,this,function(e){e.keyCode==Laya.Keyboard.ENTER&&i.refresh_match_list(-1,i.input.text)}),this.check_follow=t.getChildByName("check_follow").getChildByName("check"),t.getChildByName("check_follow").clickHandler=Laya.Handler.create(this,function(){i.check_follow.visible=!i.check_follow.visible,i.only_follow=i.check_follow.visible,i.refresh_match_list()},null,!1),this.noinfo=this.me.getChildByName("noinfo"),this.nolimitlist=t.scriptMap["capsui.NoLimitList"],this.nolimitlist.init_nolimitlist(new Laya.Handler(this,this.load_info),new Laya.Handler(this,this.render_item)),this.clearData()}return t.prototype.onShow=function(){var t=this;this.have_data?this.only_follow&&this.follow_changed?this.refresh_match_list():this.nolimitlist.wantToRefreshAll():app.NetAgent.sendReq2Lobby("Lobby","fetchCustomizedContestList",{start:0,count:100},function(i,n){if(i||n.error)e.UIMgr.Inst.showNetReqError("fetchCustomizedContestList",i,n);else{if(app.Log.log(JSON.stringify(n)),n=JSON.parse(JSON.stringify(n)),t.have_data=!0,n.contests)for(a=0;a<n.contests.length;a++){r=n.contests[a];t.match_infos[r.unique_id]||(t.all_match_list.push(r.unique_id),t.match_infos[r.unique_id]=r),t.match_infos[r.unique_id].follow=!1}if(n.follow_contests)for(var a=0;a<n.follow_contests.length;a++){var r=n.follow_contests[a];t.match_infos[r.unique_id]||(t.all_match_list.push(r.unique_id),t.match_infos[r.unique_id]=r),t.match_infos[r.unique_id].follow=!0}t.refresh_match_list()}}),this.follow_changed=!1},t.prototype.clearData=function(){this.have_data=!1,this.match_infos={},this.all_match_list=[],this.match_ids=[],this.only_follow=!1,this.check_follow.visible=!1,this.follow_changed=!1,this.nolimitlist.reset()},t.prototype.load_info=function(t){for(var i=this,n=[],a=0,r=0;r<20&&r+t<this.match_ids.length;r++){var o=this.match_ids[r+t];null==this.match_infos[o].public_notice&&n.push(o),a++}0==n.length?this.nolimitlist.loadOver(!0,a):app.NetAgent.sendReq2Lobby("Lobby","fetchCustomizedContestExtendInfo",{uid_list:n},function(t,a){if(t||a.error)e.UIMgr.Inst.showNetReqError("fetchCustomizedContestExtendInfo",t,a.error),i.nolimitlist.loadOver(!1,0);else{app.Log.log(JSON.stringify(a));var r=0;if(a.extend_list)for(var o=0;o<a.extend_list.length;o++){var s=a.extend_list[o];i.match_infos[s.unique_id].public_notice=s.public_notice,r++}r!=n.length?(i.nolimitlist.loadOver(!1,0),e.UIMgr.Inst.ShowErrorInfo("加载新数据出错，请稍后重试")):i.nolimitlist.loadOver(!0,r)}})},t.prototype.refresh_match_list=function(e,t){var i=this;if(void 0===e&&(e=-1),void 0===t&&(t=""),this.match_ids=[],-1!=e)this.match_ids.push(e);else for(var n=0;n<this.all_match_list.length;n++){var a=this.all_match_list[n],r=this.match_infos[a];if(!this.only_follow||r.follow){var o=!0;if(""!=t){var s=r.contest_name;game.Tools.stringContainerSub(s,t)||(o=!1)}o&&this.match_ids.push(a)}}this.match_ids=this.match_ids.sort(function(e,t){var n=i.match_infos[e],a=i.match_infos[t];if(n.state==a.state)return 1==n.state?n.start_time-a.start_time:2==n.state?n.finish_time-a.finish_time:a.finish_time-n.finish_time;return(2==n.state?-1:n.state)-(2==a.state?-1:a.state)}),this.nolimitlist.reset(),0==this.match_ids.length?-1!=e?this.show_noinfo("未找到比赛ID:"+e):this.only_follow?this.show_noinfo("无关注中的比赛"):this.show_noinfo("当前没有比赛信息"):(this.nolimitlist.total_count=this.match_ids.length,this.noinfo.visible=!1)},t.prototype.render_item=function(e){var t=e.index,i=e.container,a=this.match_ids[t],r=this.match_infos[a];i.getChildByName("follow").visible=r.follow,i.getChildByName("name").text=game.Tools.strWithoutForbidden(r.contest_name);var o=i.getChildByName("content"),s=game.Tools.strWithoutForbidden(r.public_notice);if(s&&s.length>0){if(o.text=s,o.textField.textHeight>110){for(var h=0,l=200<s.length?200:s.length,c=0;h<l;)c=(h+l)/2,o.text=s.substring(0,c)+"...",o.textField.textHeight<=110?h=c+1:l=c;o.text=s.substring(0,c-1)+"..."}}else o.text="";i.getChildByName("prepare").visible=!1,i.getChildByName("start").visible=!1,i.getChildByName("end").visible=!1,i.getChildByName("id").text="ID:"+r.contest_id;var p,u=0;switch(r.state){case 1:p=i.getChildByName("prepare"),u=r.start_time;break;case 2:p=i.getChildByName("start"),u=r.finish_time;break;case 3:p=i.getChildByName("end"),u=r.finish_time}p&&(p.visible=!0,p.getChildByName("time").text=game.Tools.time2YearMounthDate(u)+" "+game.Tools.time2HourMinute(u,!0)),i.getChildByName("check").clickHandler=Laya.Handler.create(this,function(){n.Inst.pop_out_notice(r)},null,!1),i.getChildByName("btn_enter").clickHandler=Laya.Handler.create(this,function(){n.Inst.enter_match(a,r.contest_id)},null,!1)},t.prototype.change_match_follow=function(e,t){this.match_infos[e]&&(this.match_infos[e].follow=t,this.follow_changed=!0)},t.prototype.show_noinfo=function(e){this.noinfo.text=e,this.noinfo.visible=!0},t.prototype.get_match_data=function(e){return this.match_infos[e]},t}(),n=function(n){function a(){var e=n.call(this,new ui.lobby.match_lobbyUI)||this;return e.locking=!1,a.Inst=e,e}return __extends(a,n),a.prototype.onCreate=function(){var n=this;this.container_top=this.me.getChildByName("top"),this.container_top.getChildByName("btn_back").clickHandler=Laya.Handler.create(this,function(){n.locking||(n.content.clearData(),n.close(),Laya.timer.once(200,n,function(){e.UI_Lobby.Inst.enable=!0}))},null,!1),this.content=new i(this.me.getChildByName("root")),this.pop_info=new t(this.me.getChildByName("pop_info"))},a.prototype.show=function(){var t=this;game.Scene_Lobby.Inst.change_bg("indoor",!1),this.locking=!0,this.enable=!0,this.pop_info.me.visible=!1,this.content.onShow(),e.UIBase.anim_alpha_in(this.container_top,{y:-30},150),e.UIBase.anim_alpha_in(this.content.me,{y:30},150),Laya.timer.once(200,this,function(){t.locking=!1})},a.prototype.close=function(){var t=this;this.locking=!0,e.UIBase.anim_alpha_out(this.container_top,{y:-30},150),e.UIBase.anim_alpha_out(this.content.me,{y:30},150),Laya.timer.once(200,this,function(){t.locking=!1,t.enable=!1})},a.prototype.enter_match=function(t,i){this.close(),Laya.timer.once(200,this,function(){e.UI_Match_Room.Inst.show(t)})},a.prototype.change_match_follow=function(e,t){this.content.change_match_follow(e,t)},a.prototype.clear_data=function(){this.content.clearData()},a.prototype.pop_out_notice=function(e){this.pop_info.show(e)},a}(e.UIBase);e.UI_Match_Lobby=n}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(){function t(e){var t=this;this.locking=!1,this.datas=[],this.me=e,this.root=e.getChildByName("root"),this.scrollview=this.root.getChildByName("container_infos").scriptMap["capsui.CScrollView"],this.scrollview.init_scrollview(new Laya.Handler(this,this.render_item)),this.light_scrollbar=this.root.getChildByName("container_infos").getChildByName("light_scrollbar"),this.scrollpoint=this.light_scrollbar.getChildByName("scrollpoint"),this.scrollview.me.on("ratechange",this,function(){t.refresh_scorllbar()}),this.root.getChildByName("btn_close").clickHandler=Laya.Handler.create(this,function(){t.locking||t.close()},null,!1),this.root.getChildByName("btn_close1").clickHandler=Laya.Handler.create(this,function(){t.locking||t.close()},null,!1)}return t.prototype.show=function(t){var i=this;switch(t=JSON.parse(JSON.stringify(t)),this.locking=!0,this.me.visible=!0,e.UIBase.anim_pop_out(this.root,Laya.Handler.create(this,function(){i.locking=!1})),this.scrollview.reset(),this.datas=[],t.mode){case 0:this.datas.push({name:"模式",infos:["一局胜负"],isdefault:[!0]});break;case 1:this.datas.push({name:"模式",infos:["四人东风"],isdefault:[!0]});break;case 2:this.datas.push({name:"模式",infos:["四人半庄"],isdefault:[!0]})}var n=t.detail_rule,a=null!=n.time_fixed?n.time_fixed:5,r=null!=n.time_add?n.time_add:20;this.datas.push({name:"长考时间",infos:[a.toString()+"+"+r.toString()+"秒"],isdefault:[!0]});var o="3";if(null!=n.dora_count)switch(n.dora_count){case 0:o="0";break;case 3:o="3";break;case 4:o="4"}this.datas.push({name:"赤宝牌数量",infos:[o],isdefault:["3"===o]}),this.datas.push({name:"食断",infos:[0===n.shiduan?"无":"有"],isdefault:[0!==n.shiduan]});var s=function(e,t,a,r,o){var s=a;null!=n[t]&&(s=n[t]),i.datas.push({name:e,infos:[s?r:o],isdefault:[s===a]})},h=function(e,t,a){var r=a;null!=n[t]&&(r=n[t]),i.datas.push({name:e,infos:[r.toString()],isdefault:[r===a]})};h("初始点数","init_point",25e3),h("一位必要点数","fandian",3e4),s("击飞","can_jifei",!0,"有","无"),h("天边","tianbian_value",0),h("立直棒点数","liqibang_value",1e3),h("场棒点数","changbang_value",300);var l=1e3,c=1500,p=3e3;null!=n.noting_fafu_1&&(l=n.noting_fafu_1),null!=n.noting_fafu_2&&(c=n.noting_fafu_2),null!=n.noting_fafu_3&&(p=n.noting_fafu_3),this.datas.push({name:"不听罚符",infos:[l.toString(),c.toString(),p.toString()],isdefault:[1e3===l,1500===c,3e3===p]}),h("精算原点","jingsuanyuandian",25e3);var u=null!=n.shunweima_2?n.shunweima_2:5,d=null!=n.shunweima_3?n.shunweima_3:-5,_=null!=n.shunweima_4?n.shunweima_4:-15,m=-(u+d+_);this.datas.push({name:"顺位马",infos:[(m>0?"+":"")+m.toString(),(u>0?"+":"")+u.toString(),(d>0?"+":"")+d.toString(),(_>0?"+":"")+_.toString()],isdefault:[15===m,5===u,-5===d,-15===_]}),s("便捷提示","bianjietishi",!0,"开启","关闭"),s("流局满贯","have_liujumanguan",!0,"有","无"),s("切上满贯","have_qieshangmanguan",!1,"有","无"),s("表宝牌","have_biao_dora",!0,"有","无"),s("杠表宝牌","have_gang_biao_dora",!0,"有","无"),s("里宝牌","have_li_dora",!0,"有","无"),s("杠里宝牌","have_gang_li_dora",!0,"有","无"),s("明杠宝牌即开","ming_dora_immediately_open",!1,"开启","关闭"),s("四风连打流局","have_sifenglianda",!0,"有","无"),s("四杠散了流局","have_sigangsanle",!0,"有","无"),s("四家立直流局","have_sijializhi",!0,"有","无"),s("九种九牌流局","have_jiuzhongjiupai",!0,"有","无"),s("三家和了流局","have_sanjiahele",!1,"有","无"),s("和牌头跳","have_toutiao",!1,"开启","关闭"),s("和牌连庄","have_helelianzhuang",!0,"有","无"),s("和了终局","have_helezhongju",!0,"有","无"),s("听牌连庄","have_tingpailianzhuang",!0,"有","无"),s("听牌终局","have_tingpaizhongju",!0,"有","无"),s("一发","have_yifa",!0,"有","无"),s("南入/西入","have_nanruxiru",!0,"有","无"),this.scrollview.reset(),this.scrollview.addItem(this.datas.length)},t.prototype.close=function(){var t=this;this.locking=!0,e.UIBase.anim_pop_hide(this.root,Laya.Handler.create(this,function(){t.locking=!1,t.me.visible=!1}))},t.prototype.render_item=function(e){var t=e.index,i=e.container;i.getChildByName("name").text=this.datas[t].name;for(var n=this.datas[t].infos,a=this.datas[t].isdefault,r=0;r<n.length&&r<4;r++){var o=i.getChildByName("item"+r);o.visible=!0,o.getChildByName("label_name").text=n[r],o.getChildByName("label_name").color=a[r]?"#402031":"#03751a"}for(r=n.length;r<4;r++)i.getChildByName("item"+r).visible=!1},t.prototype.refresh_scorllbar=function(){this.scrollview.need_scroll?(this.light_scrollbar.visible=!0,this.scrollpoint.height=this.light_scrollbar.height*this.scrollview.view_height/this.scrollview.total_height,this.scrollpoint.y=this.scrollview.rate*this.light_scrollbar.height*(1-this.scrollview.view_height/this.scrollview.total_height)):this.light_scrollbar.visible=!1},t}(),i=function(){function t(e){var t=this;this.locking=!1,this.me=e,this.root=e.getChildByName("root"),this.root.getChildByName("btn_close").clickHandler=Laya.Handler.create(this,function(){t.locking||t.close()},null,!1),this.root.getChildByName("btn_close1").clickHandler=Laya.Handler.create(this,function(){t.locking||t.close()},null,!1)}return t.prototype.show=function(){var t=this;this.locking=!0,this.me.visible=!0,e.UIBase.anim_pop_out(this.root,Laya.Handler.create(this,function(){t.locking=!1}))},t.prototype.close=function(){var t=this;this.locking=!0,e.UIBase.anim_pop_hide(this.root,Laya.Handler.create(this,function(){t.locking=!1,t.me.visible=!1}))},t}(),n=function(){function t(e){var t=this;this.me=e,this.root=this.me.getChildByName("root"),this.title=this.root.getChildByName("title"),this.input=this.root.getChildByName("input").getChildByName("txtinput"),this.btn_confirm=this.root.getChildByName("btn_confirm"),this.btn_cancel=this.root.getChildByName("btn_cancel"),this.me.visible=!1,this.btn_cancel.clickHandler=Laya.Handler.create(this,function(){t.hide(null)},null,!1)}return t.prototype.show_share=function(t){var i=this;this.title.text="牌谱链接",this.btn_confirm.visible=!1,this.btn_confirm.clickHandler=Laya.Handler.create(this,function(){},null,!1),this.input.editable=!1,this.input.text="雀魂牌谱: http://majsoul.union-game.com/0/?paipu="+t+"_0",this.me.visible=!0,this.locking=!0,e.UIBase.anim_pop_out(this.root,Laya.Handler.create(this,function(){i.locking=!1}))},t.prototype.show_check=function(){var t=this;this.title.text="输入牌谱链接",this.btn_confirm.visible=!0,this.btn_confirm.getChildAt(0).text="确定",this.btn_confirm.clickHandler=Laya.Handler.create(this,function(){t.hide(Laya.Handler.create(t,function(){var e=t.input.text.split("="),i=e[e.length-1].split("_"),n=0;i.length>1&&(n="a"==i[1].charAt(0)?game.Tools.decode_account_id(parseInt(i[1].substr(1))):parseInt(i[1]));var a=0;if(i.length>2){var r=parseInt(i[2]);r&&(a=r)}GameMgr.Inst.checkPaiPu(i[0],n,a)}))},null,!1),this.input.editable=!0,this.input.text="",this.me.visible=!0,this.locking=!0,e.UIBase.anim_pop_out(this.root,Laya.Handler.create(this,function(){t.locking=!1}))},t.prototype.hide=function(t){var i=this;this.locking=!0,e.UIBase.anim_pop_hide(this.root,Laya.Handler.create(this,function(){i.locking=!1,i.me.visible=!1,t&&t.run()}))},t}(),a=function(){function e(e){this.me=e}return e.prototype.onEnterRoom=function(){},e.prototype.show=function(){},e.prototype.close=function(){},e}(),r=function(){function t(t){var i=this;this.match_id=-1,this.infos=[],this.show_index=[],this.me=t,this.scrollview=this.me.scriptMap["capsui.CScrollView"],this.scrollview.init_scrollview(new Laya.Handler(this,this.render_item));var n=this.me.getChildByName("only_system");this.only_system_flag=n.getChildByName("check"),n.clickHandler=new Laya.Handler(this,function(){i.only_system_flag.visible=!i.only_system_flag.visible,i.refresh_all_info()}),this.txt_input=this.me.getChildByName("input").getChildByName("txtinput"),this.btn_send=this.me.getChildByName("send"),this.btn_send.clickHandler=Laya.Handler.create(this,function(){""!=i.txt_input.text&&(game.Tools.setGrayDisable(i.btn_send,!0),Laya.timer.once(5e3,i,function(){game.Tools.setGrayDisable(i.btn_send,!1)}),app.NetAgent.sendReq2Lobby("Lobby","sayChatMessage",{content:i.txt_input.text},function(t,i){(t||i.error)&&e.UIMgr.Inst.showNetReqError("sayChatMessage",t,i)}),i.txt_input.text="")},null,!1),this.txt_input.on(laya.events.Event.KEY_DOWN,this,function(t){if(t.keyCode==Laya.Keyboard.ENTER){if(!i.btn_send.mouseEnabled)return;if(""==i.txt_input.text)return;game.Tools.setGrayDisable(i.btn_send,!0),Laya.timer.once(5e3,i,function(){game.Tools.setGrayDisable(i.btn_send,!1)}),app.NetAgent.sendReq2Lobby("Lobby","sayChatMessage",{content:i.txt_input.text},function(t,i){(t||i.error)&&e.UIMgr.Inst.showNetReqError("sayChatMessage",t,i)}),i.txt_input.text=""}}),this.container_get_word_height=t.getChildByName("container_get_word_height"),this.test_height_div=new Laya.HTMLDivElement,this.container_get_word_height.addChild(this.test_height_div),this.test_height_div.pos(0,0),this.test_height_div.width=this.container_get_word_height.width,this.test_height_div.style.lineHeight=30,this.test_height_div.style.valign="top",this.test_height_div.style.width=this.container_get_word_height.width,this.test_height_div.style.align="left",app.NetAgent.AddListener2Lobby("NotifyCustomContestAccountMsg",Laya.Handler.create(this,function(e){e.unique_id==i.match_id&&i.addInfos(2,e)})),app.NetAgent.AddListener2Lobby("NotifyCustomContestSystemMsg",Laya.Handler.create(this,function(e){e.unique_id==i.match_id&&i.addInfos(1,e)})),this.scrollbar=this.me.getChildByName("scrollbar_light"),this.scrollpoint=this.scrollbar.getChildByName("scrollpoint"),this.scrollview.me.on("ratechange",this,function(){i.refresh_scrollbar()})}return t.prototype.on_enter_room=function(){var t=this;this.match_id=p.Inst.match_id,this.infos=[],this.show_index=[],this.scrollview.reset(),this.only_system_flag.visible=!1,this.txt_input.text="",app.NetAgent.sendReq2Lobby("Lobby","joinCustomizedContestChatRoom",{unique_id:this.match_id},function(i,n){if(i||n.error)e.UIMgr.Inst.ShowErrorInfo("连接聊天室失败");else if(n.chat_history)for(var a=n.chat_history.length-1;a>=0;a--){var r=n.chat_history[a],o=net.MessageWrapper.decodeMessage(r),s=o.$type.name;"NotifyCustomContestSystemMsg"==s?t.addInfos(1,o):"NotifyCustomContestAccountMsg"==s&&t.addInfos(2,o)}})},t.prototype.on_leave_room=function(){this.match_id=-1,this.show_index=[],this.infos=[],this.scrollview.reset(),app.NetAgent.sendReq2Lobby("Lobby","leaveCustomizedContestChatRoom",{},function(e,t){e||t.error})},t.prototype.addInfos=function(e,t){this.infos.push({type:e,content:t,height:0});var i=this.get_content_str(this.infos[this.infos.length-1]);this.test_height_div.innerHTML=i;var n=this.scrollview.near_bottom,a=this.test_height_div.contextHeight+10;this.infos[this.infos.length-1].height=a,1!=e&&0!=this.only_system_flag.visible||(this.show_index.push(this.infos.length-1),this.scrollview.addItem(1,a),n&&(this.scrollview.rate=1)),1==e&&(1==t.type?p.Inst.page_ob.setNeedFetch():2==t.type&&p.Inst.page_paipu.setNeedFetch())},t.prototype.refresh_all_info=function(){this.scrollview.reset(),this.show_index=[];for(var e=[],t=0;t<this.infos.length;t++)1!=this.infos[t].type&&0!=this.only_system_flag.visible||(this.show_index.push(t),e.push(this.infos[t].height));this.scrollview.addItems(e),this.scrollview.rate=1},t.prototype.get_content_str=function(e){var t="";if(1==e.type){if(t+="<span style='font:26px SimHei' color='#d4ac66'>",t+="〈系统〉",1==e.content.type){for(var i=e.content.game_start.players,n=0;n<i.length;n++)0!=n&&(n==i.length-1?t+="和":t+="、"),0===i[n].account_id?t+="电脑":t+=i[n].nickname;t+="对局开始了！"}else if(2==e.content.type){t+="对局结束：";for(var i=e.content.game_end.players,n=0;n<i.length;n++)0!=n&&(t+=","),t+="["+(n+1).toString()+"]",0===i[n].account_id?t+="电脑":t+=i[n].nickname,t+="("+(i[n].total_point>0?"+":"")+i[n].total_point/1e3+"点)"}t+="</span>"}else if(2==e.type){t+="<span style='font:26px SimHei' color='#8b8c98'>"+e.content.sender+":</span>";var a=e.content.content;t+="<span style='font:26px SimHei' color='#70d6ed'>"+(a=game.Tools.strWithoutForbidden(a))+"</span>"}return t},t.prototype.render_item=function(t){var i=t.index,n=t.container,a=n.getChildByName("container_content").getChildByName("content");null==a&&((a=new Laya.HTMLDivElement).name="content",n.getChildByName("container_content").addChild(a),a.pos(0,0),a.width=this.test_height_div.width,a.style.lineHeight=this.test_height_div.style.lineHeight,a.style.valign=this.test_height_div.style.valign,a.style.width=a.width,a.style.align=this.test_height_div.style.align);var r=this.infos[this.show_index[i]];n.height=r.height,a.innerHTML=this.get_content_str(r);var o=n.getChildByName("btn_click");1==r.type?o.clickHandler=null:(o.clickHandler=Laya.Handler.create(this,function(){r.content.account_id&&e.UI_OtherPlayerInfo.Inst.show(r.content.account_id)},null,!1),o.width=n.width,o.height=n.height,o.pos(0,0))},t.prototype.refresh_scrollbar=function(){if(this.scrollview.need_scroll){var e=this.scrollview.rate;this.scrollpoint.height=this.scrollbar.height*this.scrollview.view_height/this.scrollview.total_height,this.scrollpoint.y=e*this.scrollbar.height*(1-this.scrollview.view_height/this.scrollview.total_height),this.scrollbar.visible=!0}else this.scrollbar.visible=!1},t}(),o=function(){function e(e){var t=this;this.tab_index=0,this.me=e,this.chat=new r(e.getChildByName("chat")),this.btn_chat=e.getChildByName("btn_chat"),this.btn_chat.clickHandler=Laya.Handler.create(this,function(){1!=t.tab_index&&t.change_tab(1)},null,!1),this.btn_info=e.getChildByName("btn_info"),this.btn_info.clickHandler=Laya.Handler.create(this,function(){0!=t.tab_index&&t.change_tab(0)},null,!1),this.container_notice=e.getChildByName("notice"),this.panel=this.container_notice.getChildByName("panel"),this.panel.vScrollBarSkin="",this.label_content=this.panel.getChildByName("content"),this.scrollbar=this.container_notice.getChildByName("scrollbar"),this.scrollpoint=this.scrollbar.getChildByName("scrollpoint"),this.panel.vScrollBar.on("change",this,function(){t.refresh_scrollbar()})}return e.prototype.on_enter_room=function(){this.chat.on_enter_room()},e.prototype.on_leave_room=function(){this.chat.on_leave_room()},e.prototype.set_notice=function(e){this.label_content.text=game.Tools.strWithoutForbidden(e),this.label_content.height=this.label_content.textField.textHeight,this.panel.refresh(),this.scrollbar.visible=this.label_content.height>this.panel.height,this.panel.vScrollBar.value=0,this.refresh_scrollbar()},e.prototype.refresh_scrollbar=function(){if(this.label_content.height>this.panel.height){var e=this.panel.vScrollBar.value/this.panel.vScrollBar.max;this.scrollpoint.height=this.scrollbar.height*this.panel.height/this.label_content.height,this.scrollpoint.y=e*this.scrollbar.height*(1-this.panel.height/this.label_content.height)}},e.prototype.change_tab=function(e){this.tab_index=e,this.chat.me.visible=1==e,this.btn_chat.getChildByName("inchoose").visible=1==e,this.container_notice.visible=0==e,this.btn_info.getChildByName("inchoose").visible=0==e},e}(),s=function(){function t(t){var i=this;this.player_count=1,this.me=t,this.label_rank=t.getChildByName("rank"),this.label_my_near_point_word=t.getChildByName("my_near_point"),this.label_my_near_point_value=this.label_my_near_point_word.getChildByName("v"),this.label_my_near_rank_word=t.getChildByName("my_near_rank"),this.label_my_near_rank_value=this.label_my_near_rank_word.getChildByName("v"),this.btn_start=t.getChildByName("btn_start"),this.label_btn=this.btn_start.getChildByName("label_name"),this.btn_start.clickHandler=Laya.Handler.create(this,function(){game.Tools.setGrayDisable(i.btn_start,!0),p.Inst.during_waiting_match?app.NetAgent.sendReq2Lobby("Lobby","stopCustomizedContest",{},function(t,n){game.Tools.setGrayDisable(i.btn_start,!1),t||n.error?e.UIMgr.Inst.showNetReqError("stopCustomizedContest",t,n):(p.Inst.during_waiting_match=!1,i.refresh_start_btn())}):app.NetAgent.sendReq2Lobby("Lobby","startCustomizedContest",{unique_id:p.Inst.match_id},function(t,n){if(game.Tools.setGrayDisable(i.btn_start,!1),t)e.UIMgr.Inst.showNetReqError("startCustomizedContest",t,null);else if(n.error){2511==n.error.code?p.Inst.showNoAccess():e.UIMgr.Inst.showNetReqError("startCustomizedContest","",n)}else p.Inst.during_waiting_match=!0,i.refresh_start_btn()})},null,!1),this.label_online=t.getChildByName("count_online"),app.NetAgent.AddListener2Lobby("NotifyCustomContestState",new Laya.Handler(this,function(e){e.unique_id==p.Inst.match_id&&(p.Inst.match_data.state=e.state,i.refresh_start_btn())}))}return t.prototype.on_enter_room=function(){var e=this,t=p.Inst.match_data;p.Inst.player_report;this.me.getChildByName("starttime").getChildByName("date").text=game.Tools.time2YearMounthDate(t.start_time),this.me.getChildByName("starttime").getChildByName("time").text=game.Tools.time2HourMinute(t.start_time,!0),this.me.getChildByName("endtime").getChildByName("date").text=game.Tools.time2YearMounthDate(t.finish_time),this.me.getChildByName("endtime").getChildByName("time").text=game.Tools.time2HourMinute(t.finish_time,!0);var i=[];switch(t.game_mode.mode){case 0:i.push("一局胜负");break;case 1:i.push("四人东风");break;case 2:i.push("四人半庄")}if(t.game_mode.detail_rule){var n=t.game_mode.detail_rule;0===n.shiduan?i.push("无食断"):i.push("有食断");var a=null!=n.time_fixed?n.time_fixed:5,r=null!=n.time_add?n.time_add:20;i.push(a.toString()+"+"+r.toString()+"秒");switch(null!=n.dora_count?n.dora_count:3){case 0:i.push("无赤");break;case 3:i.push("3赤");break;case 4:i.push("4赤")}}else i.push("有食断"),i.push("5+20秒"),i.push("3赤");for(var o=0;o<4;o++){var s=this.me.getChildByName("rule"+o);o>=i.length?s.visible=!1:(s.visible=!0,s.getChildByName("label_name").text=i[o])}this.me.getChildByName("check_rule").clickHandler=new Laya.Handler(this,function(){p.Inst.show_rule()}),this.refresh_my_rank(),this.refresh_start_btn(),this.player_count=0,this.label_online.text="1",this.nxt_refresh_count_time=1,this.refresh_online(),Laya.timer.loop(3e3,this,function(){e.refresh_online()})},t.prototype.on_leave_room=function(){Laya.timer.clearAll(this)},t.prototype.refresh_my_rank=function(){var e=p.Inst.match_data,t=p.Inst.player_report,i=0;if(e.rank_rule&&(i=e.rank_rule),t){this.label_rank.text=null==t.rank||0==t.rank?"--":t.rank.toString(),this.label_my_near_point_value.text=null==t.point?"--":(t.point/1e3).toString();var n="",a=!1;if(t.recent_game_ranks)for(r=0;r<5;r++)""!=n&&(n+="/"),r<t.recent_game_ranks.length?(n+=t.recent_game_ranks[r].toString(),a=!0):n+="-";else for(r=0;r<5;r++)""!=n&&(n+="/"),n+="-";a||(this.label_my_near_point_value.text="--"),this.label_my_near_rank_value.text=n}else{this.label_rank.text="--",this.label_my_near_point_value.text="--";for(var n="",r=0;r<5;r++)""!=n&&(n+="/"),n+="-";this.label_my_near_rank_value.text=n}this.label_my_near_point_word.visible=!0,this.label_my_near_rank_word.visible=!0,2==i?this.label_my_near_point_word.text="最近5战总计精算点：":1==i?this.label_my_near_point_word.text="最近3战总计精算点：":0==i&&(this.label_my_near_point_word.text="最近-战总计精算点：")},t.prototype.refresh_online=function(){var e=this,t=this.player_count;t<=0?this.label_online.text="--":(t>50&&t<100?t+=Math.floor(10*Math.random()-5):t>=100&&(t=Math.floor(t*(.12*Math.random()+.94)+7*Math.random()-3)),this.label_online.text=t.toString()),Laya.timer.currTimer>=this.nxt_refresh_count_time&&(app.NetAgent.sendReq2Lobby("Lobby","fetchCustomizedContestOnlineInfo",{unique_id:p.Inst.match_id},function(t,i){t||i.error?e.player_count=1:e.player_count=i.online_player}),this.player_count<100?this.nxt_refresh_count_time=Laya.timer.currTimer+5e3:this.player_count<500?this.nxt_refresh_count_time=Laya.timer.currTimer+24e3*(this.player_count-100)/400:this.nxt_refresh_count_time=Laya.timer.currTimer+29e3)},t.prototype.refresh_start_btn=function(){var e=p.Inst.match_data;1==e.state?(game.Tools.setGrayDisable(this.btn_start,!0),this.label_btn.text="比赛尚未开启",this.btn_start.skin="myres/match_lobby/match_btn2.png"):2==e.state?(game.Tools.setGrayDisable(this.btn_start,!1),p.Inst.during_waiting_match?(this.label_btn.text="等待开始...",this.btn_start.skin="myres/match_lobby/match_btn3.png"):(this.label_btn.text="准备比赛",this.btn_start.skin="myres/match_lobby/match_btn2.png")):3==e.state&&(game.Tools.setGrayDisable(this.btn_start,!0),this.label_btn.text="比赛已经结束",this.btn_start.skin="myres/match_lobby/match_btn2.png")},t}(),h=function(t){function i(i){var n=t.call(this,i)||this;return n.label_name=i.getChildByName("name"),n.check_follow=i.getChildByName("check_follow"),n.label_follow=n.check_follow.getChildByName("word"),n.check_flag=n.check_follow.getChildByName("check"),n.check_follow.clickHandler=Laya.Handler.create(n,function(){p.Inst.follow=!p.Inst.follow,n.check_flag.visible=p.Inst.follow,n.label_follow.text=n.check_flag.visible?"已关注":"添加关注",e.UI_Match_Lobby.Inst.change_match_follow(p.Inst.match_id,p.Inst.follow);var t=n.check_flag.visible?"followCustomizedContest":"unfollowCustomizedContest";app.NetAgent.sendReq2Lobby("Lobby",t,{unique_id:p.Inst.match_id},function(){})},null,!1),n.container_left=new o(i.getChildByName("container_left")),n.container_right=new s(i.getChildByName("container_right")),n}return __extends(i,t),i.prototype.onEnterRoom=function(){var e=p.Inst.match_data;p.Inst.player_report;this.label_name.text=game.Tools.strWithoutForbidden(e.contest_name),this.container_left.set_notice(e.private_notice),this.container_left.change_tab(0),this.container_left.on_enter_room(),this.container_right.on_enter_room(),this.check_flag.visible=p.Inst.follow,this.label_follow.text=this.check_flag.visible?"已关注":"添加关注"},i.prototype.on_leave_room=function(){this.container_left.on_leave_room(),this.container_right.on_leave_room()},i.prototype.show=function(){this.me.visible=!0},i.prototype.close=function(){this.me.visible=!1},i}(a),l=function(t){function i(e){var i=t.call(this,e)||this;return i.next_index=-1,i.record_list=[],i.last_fetch_time=-1e8,i.nolimitlst=e.scriptMap["capsui.NoLimitList"],i.nolimitlst.init_nolimitlist(Laya.Handler.create(i,i.load_next,null,!1),Laya.Handler.create(i,i.render_item,null,!1)),i.me.getChildByName("checkother").clickHandler=Laya.Handler.create(i,function(){p.Inst.pop_check_paipu.show_check()},null,!1),i}return __extends(i,t),i.prototype.onEnterRoom=function(){this.last_fetch_time=-1e8,this.match_id=p.Inst.match_id,this.record_list=[],this.next_index=-1},i.prototype.show=function(){this.me.visible=!0,Laya.timer.currTimer>this.last_fetch_time+6e4&&(this.next_index=-1,this.record_list=[],this.nolimitlst.reset(),this.nolimitlst.total_count=1,this.last_fetch_time=Laya.timer.currTimer)},i.prototype.close=function(){this.me.visible=!1},i.prototype.setNeedFetch=function(){this.last_fetch_time=-1e8},i.prototype.load_next=function(){var t=this,i={unique_id:this.match_id};this.next_index>=0&&(i.last_index=this.next_index),app.NetAgent.sendReq2Lobby("Lobby","fetchCustomizedContestGameRecords",i,function(i,n){if(i||n.error)e.UIMgr.Inst.showNetReqError("fetchCustomizedContestGameRecords",i,n),t.nolimitlst.loadOver(!1,0);else{var a=0;if(n.record_list){a=n.record_list.length;for(var r=0;r<a;r++)t.record_list.push(n.record_list[r])}null!=n.next_index&&n.next_index>=0?(t.next_index=n.next_index,a>0?(t.nolimitlst.total_count=t.record_list.length+1,t.nolimitlst.loadOver(!0,a)):(t.nolimitlst.total_count=t.record_list.length,t.nolimitlst.loadOver(!0,a))):(t.nolimitlst.total_count=t.record_list.length,t.nolimitlst.loadOver(!0,a))}})},i.prototype.render_item=function(t){for(var i=this,n=t.index,a=t.container,r=this.record_list[n],o=0;o<4;o++){var s=a.getChildByName("p"+o.toString()),h=s.getChildByName("chosen"),l=s.getChildByName("rank"),c=s.getChildByName("rank_word"),u=s.getChildByName("name"),d=s.getChildByName("score"),_=r.result.players[o];d.text=_.part_point_1;for(var m="电脑",f=!1,g=0;g<r.accounts.length;g++)if(r.accounts[g].seat==_.seat){m=r.accounts[g].nickname,f=r.accounts[g].account_id==GameMgr.Inst.account_id;break}u.text=m,h.visible=f,d.color=f?"#ffc458":"#b98930",u.color=f?"#dfdfdf":"#a0a0a0",c.color=l.color=f?"#57bbdf":"#489dbc"}var y=new Date(1e3*r.end_time),v="";v+=y.getFullYear()+"/",v+=(y.getMonth()<9?"0":"")+(y.getMonth()+1).toString()+"/",v+=(y.getDate()<10?"0":"")+y.getDate()+" ",v+=(y.getHours()<10?"0":"")+y.getHours()+":",v+=(y.getMinutes()<10?"0":"")+y.getMinutes(),a.getChildByName("date").text=v,a.getChildByName("check").clickHandler=Laya.Handler.create(this,function(){i.locking||(p.Inst.during_waiting_match?e.UIMgr.Inst.ShowErrorInfo("您正在等待比赛，无法查看牌谱"):GameMgr.Inst.checkPaiPu(i.record_list[n].uuid,0,0))},null,!1),a.getChildByName("share").clickHandler=Laya.Handler.create(this,function(){i.locking||p.Inst.pop_check_paipu.show_share(i.record_list[n].uuid)},null,!1);var x=a.getChildByName("room"),b=game.Tools.get_room_desc(r.config);x.text=b.text,x.font=b.isSimhei?"SimHei":"fengyu"},i}(a),c=function(t){function i(e){var i=t.call(this,e)||this;return i.live_datas=[],i.last_fetch_time=-1e6,i.scrollview=i.me.getChildByName("scrollview").scriptMap["capsui.CScrollView"],i.scrollview.init_scrollview(Laya.Handler.create(i,i.render_scrollview,null,!1)),i}return __extends(i,t),i.prototype.onEnterRoom=function(){var e=p.Inst.match_data;this.match_id=e.unique_id,this.match_name=e.contest_name,this.last_fetch_time=-1e6},i.prototype.show=function(){var t=this;this.me.visible=!0,Laya.timer.currTimer>this.last_fetch_time+1e4&&(this.scrollview.reset(),this.live_datas=[],app.NetAgent.sendReq2Lobby("Lobby","fetchCustomizedContestGameLiveList",{unique_id:this.match_id},function(i,n){if(i||n.error)e.UIMgr.Inst.showNetReqError("fetchCustomizedContestGameLiveList",i,n);else{if(n.live_list)for(var a=0;a<n.live_list.length;a++)t.live_datas.push(n.live_list[a]);t.scrollview.addItem(t.live_datas.length),t.last_fetch_time=Laya.timer.currTimer}}))},i.prototype.close=function(){this.me.visible=!1},i.prototype.setNeedFetch=function(){this.last_fetch_time=-1e6},i.prototype.render_scrollview=function(t){var i=this,n=t.index,a=t.container,r=t.cache_data,o=this.live_datas[n];a.getChildByName("name").text=this.match_name;var s=new Date(1e3*o.start_time),h=s.getHours()+":";s.getMinutes()<10&&(h+="0"),h+=s.getMinutes().toString(),a.getChildByName("time").text=h;for(var l=0;l<4;l++){var c="p"+l,u=a.getChildByName(c);if(!r[c]){var d={};d.level=new e.UI_Level(u.getChildByName("rank")),d.title=new e.UI_PlayerTitle(u.getChildByName("title")),d.name=u.getChildByName("name"),r[c]=d}if(l<o.players.length){var _=o.players[l];r[c].level.id=_.level.id,r[c].title.id=_.title,r[c].name.text=_.nickname}else r[c].level.id=10101,r[c].title.id=0,r[c].name.text="电脑"}a.getChildByName("btn").clickHandler=Laya.Handler.create(this,function(){p.Inst.during_waiting_match?e.UIMgr.Inst.ShowErrorInfo("您正在匹配比赛，无法进行观战"):e.UI_Live_Broadcast.fetchInfo(o.uuid,Laya.Handler.create(i,function(t){t.success&&e.UI_Live_Broadcast.goToWatch(o.uuid,t.data,o.players[0].account_id)}))},null,!1)},i}(a),p=function(a){function r(){var e=a.call(this,new ui.lobby.match_roomUI)||this;return e.tabs=[],e.locking=!1,e.match_data=null,e.player_report=null,e.tab_index=-1,e.during_waiting_match=!1,r.Inst=e,game.LobbyNetMgr.Inst.add_connect_listener(new Laya.Handler(e,function(t){e.enable&&"reconnect_success"==t&&e.refresh_data()})),e}return __extends(r,a),r.prototype.onCreate=function(){var a=this;this.container_top=this.me.getChildByName("top"),this.label_match_id=this.container_top.getChildByName("id"),this.container_top.getChildByName("btn_back").clickHandler=Laya.Handler.create(this,function(){a.locking||(a.during_waiting_match?app.NetAgent.sendReq2Lobby("Lobby","stopCustomizedContest",{},function(t,i){t||i.error?e.UIMgr.Inst.showNetReqError("stopCustomizedContest",t,i):(r.Inst.during_waiting_match=!1,a.page_main.container_right.refresh_start_btn(),a.close())}):a.close())},null,!1),this.container_main=this.me.getChildByName("main"),this.tabs=[];for(var o=function(e){s.tabs.push(s.container_main.getChildByName("tabs").getChildAt(e)),s.tabs[e].clickHandler=Laya.Handler.create(s,function(){a.locking||a.tab_index!=e&&null!=a.match_data&&a.change_tab(e)},null,!1)},s=this,p=0;p<3;p++)o(p);this.page_main=new h(this.container_main.getChildByName("page_main")),this.page_paipu=new l(this.container_main.getChildByName("page_paipu")),this.page_ob=new c(this.container_main.getChildByName("page_ob")),this.pop_rule=new t(this.me.getChildByName("pop_rule")),this.pop_check_paipu=new n(this.me.getChildByName("pop_check_paipu")),this.pop_no_access=new i(this.me.getChildByName("pop_no_access")),app.NetAgent.AddListener2Lobby("NotifyRoomGameStart",Laya.Handler.create(this,function(e){a.enable&&(app.Log.log("NotifyRoomGameStart:"+JSON.stringify(e)),a.onGameStart(e))}))},r.prototype.show=function(e){this.match_id=e,GameMgr.Inst.custom_match_id=this.match_id,this.refresh_data()},r.prototype.refresh_data=function(){var t=this;this.page_main.me.visible=!1,this.page_paipu.me.visible=!1,this.page_ob.me.visible=!1,app.NetAgent.sendReq2Lobby("Lobby","enterCustomizedContest",{unique_id:this.match_id},function(i,n){i||n.error?e.UIMgr.Inst.showNetReqError("enterCustomizedContest",i,n):(app.Log.log(JSON.stringify(n)),t.match_data=n.detail_info,t.player_report=n.player_report,t.label_match_id.text="ID:"+t.match_data.contest_id,t.follow=n.is_followed,t.page_main.onEnterRoom(),t.page_ob.onEnterRoom(),t.page_paipu.onEnterRoom(),t.change_tab(0))}),this.change_tab(-1),this.pop_check_paipu.me.visible=!1,this.pop_no_access.me.visible=!1,this.pop_rule.me.visible=!1,this.enable=!0,this.locking=!0,e.UIBase.anim_alpha_in(this.container_top,{y:-30},200),e.UIBase.anim_alpha_in(this.container_main,{y:30},200),this.label_match_id.text="ID:--",Laya.timer.once(200,this,function(){t.locking=!1})},r.prototype.close=function(){var t=this;this.match_data=null,this.match_id=-1,GameMgr.Inst.custom_match_id=-1,this.locking=!0,e.UIBase.anim_alpha_out(this.container_top,{y:-30},200),e.UIBase.anim_alpha_out(this.container_main,{y:30},200),Laya.timer.once(200,this,function(){t.enable=!1,t.locking=!1,t.change_tab(-1),e.UI_Match_Lobby.Inst.show()}),app.NetAgent.sendReq2Lobby("Lobby","leaveCustomizedContest",{},function(){}),this.page_main.on_leave_room()},r.prototype.change_tab=function(e){switch(this.tab_index){case 0:this.page_main.close();break;case 1:this.page_paipu.close();break;case 2:this.page_ob.close()}switch(this.tab_index=e,this.tab_index){case 0:this.page_main.show();break;case 1:this.page_paipu.show();break;case 2:this.page_ob.show()}for(var t=0;t<this.tabs.length;t++)this.tabs[t].skin=e==t?"myres/shop/tab_choose.png":"myres/shop/tab_unchoose.png",this.tabs[t].getChildAt(0).color=e==t?"#d9b263":"#8cb65f"},r.prototype.show_rule=function(){this.pop_rule.show(this.match_data.game_mode)},r.prototype.onGameStart=function(t){this.match_data=null,this.enable=!1,this.during_waiting_match=!1,this.page_main.on_leave_room(),e.UI_Lobby.Inst.enable=!1,e.UI_Match_Lobby.Inst.clear_data(),game.MJNetMgr.Inst.OpenConnect(t.game_url,t.connect_token,t.game_uuid,!1,null)},r.prototype.showNoAccess=function(){this.pop_no_access.show()},r}(e.UIBase);e.UI_Match_Room=p}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t,i=function(){function e(e){this.cd=300,this.pre_t=0,this.items=[],this.me=e,this.templete=e.getChildByName("templete"),this.templete.visible=!1}return e.prototype.reset=function(){Laya.timer.clearAll(this);for(var e=0;e<this.items.length;e++)this.items[e].destroy(!0);this.items=[],this.pre_t=0},e.prototype.fly=function(e){var t=this,i=this.templete.scriptMap["capsui.UICopy"].getNodeClone(),n=i.getChildByName("icon"),a=i.getChildByName("count"),r=e.getChildByName("icon"),o=e.getChildByName("count");n.skin=r.skin,a.text=o.text,n.x=r.x,a.x=o.x,this.items.push(i);var s=this.pre_t+this.cd-Laya.timer.currTimer;s<120&&(s=120),i.visible=!1;var h=e.parent.localToGlobal(new Laya.Point(e.x,e.y));Laya.timer.once(s,this,function(){i.visible=!0,i.x=h.x,i.y=h.y,i.alpha=10;var e=Laya.timer.currTimer,n=t;Laya.timer.frameLoop(1,i,function(){var t=Laya.timer.currTimer-e;if(t>=600){for(var a=0;a<n.items.length;a++)if(n.items[a]===i){for(var r=a;r<n.items.length-1;r++)n.items[r]=n.items[r+1];break}i.destroy(!0),Laya.timer.clearAll(i)}else{var o=t/600;i.y=h.y-50*o,i.alpha=o<.7?1:(1-o)/.3}})}),this.pre_t=s+Laya.timer.currTimer},e}();!function(e){e[e.none=0]="none",e[e.small=1]="small",e[e.big=2]="big",e[e.passed=3]="passed"}(t||(t={}));var n=function(n){function a(){var t=n.call(this,new ui.lobby.match_shilianUI)||this;return t.container_top=null,t.money=null,t.root=null,t.container_step=null,t.steps=[],t.container_down=null,t.btn_start=null,t.btn_getreward=null,t.btn_rule=null,t.btn_quit=null,t.container_tips=null,t.rand_tips=[],t.container_result=null,t.shine=null,t._gray_filter=null,t.locking=!1,t.reward_fly=null,t._inmatch=!1,t._step_index=0,t._can_reward=!1,t._fail=!1,t._gray_filter=new Laya.ColorFilter(e.GRAY_FILTER),a.Inst=t,t}return __extends(a,n),a.prototype.onCreate=function(){var t=this;this.container_top=this.me.getChildByName("top"),this.btn_back=this.container_top.getChildByName("btn_back"),this.money=new e.UI_Money(this.container_top,Laya.Handler.create(this,this.close,null,!1),Laya.Handler.create(this,function(){return t.locking},null,!1)),this.btn_back.clickHandler=Laya.Handler.create(this,function(){t.close(Laya.Handler.create(t,function(){e.UI_Lobby.Inst.enable=!0}))},null,!1),this.root=this.me.getChildByName("root"),this.container_step=this.root.getChildByName("step");for(var n=cfg.match_shilian.shilian.find(1),a=function(e){var t=r.container_step.getChildByName("s"+e.toString()),i={root:t,passed:t.getChildByName("passed"),container_main:t.getChildByName("main"),container_info:t.getChildByName("main").getChildByName("info"),qidian:t.getChildByName("main").getChildByName("info").getChildByName("qidian"),fandian:t.getChildByName("main").getChildByName("info").getChildByName("fandian"),contianer_reward:t.getChildByName("main").getChildByName("info").getChildByName("container_reward"),rewards:[],star:t.getChildByName("main").getChildByName("info").getChildByName("star"),anim_big2small:capsui.UIAnim.createFrameAnimation(t,ui.lobby.match_shilianUI.uiView,"root/step/s1","s_big2small"),anim_small2big:capsui.UIAnim.createFrameAnimation(t,ui.lobby.match_shilianUI.uiView,"root/step/s1","s_small2big"),anim_middle2small:capsui.UIAnim.createFrameAnimation(t,ui.lobby.match_shilianUI.uiView,"root/step/s1","s_middle2small")};r.steps.push(i),i.fandian.text="返点 "+n.back_point,i.qidian.text="起点 "+n.init_point;var a=cfg.match_shilian.shilian_reward.findGroup(e),o=i.contianer_reward.getChildByName("reward");o.visible=!1;for(var s=function(e){var t=o.scriptMap["capsui.UICopy"].getNodeClone();Laya.timer.frameOnce(5,r,function(){t.visible=!0;var i=t.getChildByName("icon"),n=t.getChildByName("count");n.align="left",i.skin=game.LoadMgr.getItemSkin(a[e].reward_id);var r=a[e].reward_count.toString();n.text="×"+r;var o=30+15.5*r.length;i.x=t.width/2-.5*(i.width+o),n.x=i.x+i.width,t.y=40*e}),i.rewards.push(t)},h=0;h<a.length;h++)s(h)},r=this,o=1;o<=5;o++)a(o);this.container_down=this.root.getChildByName("down");var s=this.container_down.getChildByName("tips");this.container_tips=s;for(o=0;o<s.numChildren;o++)this.rand_tips.push(s.getChildAt(o));this.btn_start=this.container_down.getChildByName("btn_start"),this.btn_start.clickHandler=Laya.Handler.create(this,function(){t.locking||!t._inmatch||t._fail||t._can_reward||t._step_index<0||t._step_index>=t.steps.length||(t.enable=!1,Laya.timer.once(3e3,t,function(){t.show_backin(t._step_index,!0,!1)}))},null,!1),this.btn_getreward=this.container_down.getChildByName("btn_reward"),this.btn_getreward.clickHandler=Laya.Handler.create(this,function(){t.locking||!t._inmatch||t._fail||!t._can_reward||t._step_index<0||t._step_index>=t.steps.length||(t.btn_getreward.visible=!1,t.getRewardSuccess(t._step_index))},null,!1),this.btn_rule=this.container_down.getChildByName("btn_rule"),this.btn_rule.clickHandler=Laya.Handler.create(this,function(){!t.locking&&t._inmatch&&t._fail},null,!1),this.btn_quit=this.container_down.getChildByName("btn_quit"),this.btn_quit.clickHandler=Laya.Handler.create(this,function(){!t.locking&&t._inmatch&&t._fail},null,!1),this.container_result=this.root.getChildByName("result"),this.shine=this.root.getChildByName("shine"),this.reward_fly=new i(this.me.getChildByName("reward_fly"))},a.prototype.setStepState=function(e,i){var n=this.steps[e];i==t.none?(n.root.scaleX=n.root.scaleY=1,n.passed.visible=!1,n.container_info.y=98,n.qidian.visible=!1,n.fandian.visible=!1,n.contianer_reward.visible=!0,n.contianer_reward.alpha=1,n.star.visible=!1,n.container_main.filters=[]):i==t.big?(n.root.scaleX=n.root.scaleY=1.1,n.passed.visible=!1,n.container_info.y=144,n.qidian.visible=!0,n.qidian.alpha=1,n.fandian.visible=!0,n.qidian.alpha=1,n.contianer_reward.visible=!0,n.contianer_reward.alpha=1,n.star.visible=!1,n.container_main.filters=[]):i==t.small?(n.root.scaleX=n.root.scaleY=.85,n.passed.visible=!1,n.container_info.y=98,n.qidian.visible=!1,n.fandian.visible=!1,n.contianer_reward.visible=!1,n.star.visible=!0,n.star.alpha=1,n.container_main.filters=[]):i==t.passed&&(n.root.scaleX=n.root.scaleY=.85,n.passed.visible=!0,n.container_info.y=98,n.qidian.visible=!1,n.fandian.visible=!1,n.contianer_reward.visible=!1,n.star.visible=!0,n.star.alpha=1,n.container_main.filters=[this._gray_filter])},a.prototype.show_backin=function(e,i,n){var a=this;this.enable=!0,this.locking=!0,this._inmatch=!0,this._fail=n,this._can_reward=i,this._step_index=e;for(var r=0;r<this.steps.length;r++)r<e?this.setStepState(r,t.passed):r==e?this.setStepState(r,t.big):this.setStepState(r,t.small);this._show_init(),n?(this.btn_start.visible=!1,this.btn_quit.visible=!1,this.btn_getreward.visible=!1,this.shine.visible=!1,this.btn_rule.visible=!0,Laya.timer.once(500,this,function(){a.locking=!1,a.showResult(!1)})):(this.btn_start.visible=!i,this.btn_getreward.visible=i,this.btn_quit.visible=!0,this.container_result.visible=n,this.shine.visible=!1,this.btn_rule.visible=!0,Laya.timer.once(500,this,function(){a.locking=!1}))},a.prototype.show_newin=function(i,n,a,r){var o=this;this.locking=!0,this.enable=!0,this._inmatch=i,this._step_index=n,this._can_reward=a,this._fail=r;for(var s=0;s<this.steps.length;s++){i?s<n?this.setStepState(s,t.passed):s==n?this.setStepState(s,t.big):this.setStepState(s,t.small):this.setStepState(s,t.none);var h=this.steps[s];h.root.alpha=0,e.UIBase.anim_alpha_in(h.root,{y:150},200,60*s,null,Laya.Ease.strongOut)}this.btn_start.visible=i&&!a,this.btn_quit.visible=i,this.btn_getreward.visible=i&&a,this.container_result.visible=!1,this.btn_rule.visible=!0,this.shine.visible=!1,this._show_init(),this.container_top.alpha=1,this.root.alpha=1,this.container_down.alpha=1,e.UIBase.anim_alpha_in(this.container_top,{y:-30},200),e.UIBase.anim_alpha_in(this.container_down,{y:30},200),Laya.timer.once(800,this,function(){o.locking=!1,i||(i=!0,o.matchStart())})},a.prototype.matchStart=function(){this._inmatch=!0,this.btn_start.visible=!0,this.btn_start.alpha=0,Laya.Tween.to(this.btn_start,{alpha:1},200),this._step_index=0,this._can_reward=!1,this.btn_quit.visible=!0,this.btn_quit.alpha=0,Laya.Tween.to(this.btn_quit,{alpha:1},200),this.steps[0].anim_small2big.play(0,!1);for(var e=1;e<this.steps.length;e++)this.steps[e].anim_middle2small.play(0,!1)},a.prototype._show_init=function(){for(var e=this,t=0,i=0;i<this.rand_tips.length;i++)this.rand_tips[i].visible=i==t;Laya.timer.loop(8e3,this,function(){++t>=e.rand_tips.length&&(t=0);for(var i=0;i<e.rand_tips.length;i++)e.rand_tips[i].visible=i==t}),this.money.onEnable()},a.prototype.close=function(t){var i=this;this.locking=!0,this.reward_fly.reset(),e.UIBase.anim_alpha_out(this.container_top,{y:-30},200),e.UIBase.anim_alpha_out(this.root,{y:100},200),Laya.timer.once(300,this,function(){Laya.timer.clearAll(i),i.enable=!1,i.locking=!1,t&&t.run()})},a.prototype.showResult=function(t){var i=this;this.container_result.visible=!0;(t?this.me.success_in:this.me.fail_in).play(0,!1),this.container_result.getChildByName("success").visible=t,this.container_result.getChildByName("fail").visible=!t,this.container_result.getChildByName("btn").clickHandler=Laya.Handler.create(this,function(){var n=t?i.me.success_out:i.me.fail_out;i.locking=!0,n.play(0,!1),Laya.timer.once(300,i,function(){i.close(Laya.Handler.create(i,function(){e.UI_Lobby.Inst.enable=!0}))})},null,!1)},a.prototype.getRewardSuccess=function(e){var t=this,i=this.steps[e];this.locking=!0;for(var n=0;n<i.rewards.length;n++)this.reward_fly.fly(i.rewards[n]);e+1<this.steps.length?(this._step_index=e+1,this._can_reward=!1,i.anim_big2small.play(0,!1),Laya.timer.once(500,this,function(){i.container_main.filters=[t._gray_filter]}),Laya.timer.once(700,this,function(){t.steps[e+1].anim_small2big.play(0,!1),Laya.timer.once(500,t,function(){t.locking=!1,t.btn_start.visible=!0,t.btn_start.alpha=0,Laya.Tween.to(t.btn_start,{alpha:1},150)})})):(this._can_reward=!1,Laya.timer.once(300*i.rewards.length+200,this,function(){t.showResult(!0)}))},a.Inst=null,a}(e.UIBase);e.UI_Match_Shilian=n}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(){function e(e){this.me=e,this.title=e.getChildByName("title"),this.bar_v=e.getChildByName("bar").getChildByName("v").mask,this.label_add=e.getChildByName("bar").getChildByName("num"),this.icon=e.getChildByName("icon")}return e.prototype.show=function(){var e=view.DesktopMgr.Inst.rewardinfo.match_chest,t=cfg.desktop.chest.get(e.chest_id);this.bar_v.width=384*e.origin/t.exp_step,this.label_add.text="",this.title.text=t.name,game.LoadMgr.setImgSkin(this.icon,t.icon),this.me.visible=!0},e.prototype.doanim=function(e){var t=this,i=view.DesktopMgr.Inst.rewardinfo.match_chest,n=cfg.desktop.chest.get(i.chest_id),a=i.final-i.origin+(i.is_graded?n.exp_step:0);this.label_add.text="+"+a.toString(),this.label_add.scaleX=this.label_add.scaleY=0,Laya.Tween.to(this.label_add,{scaleX:1,scaleY:1},200,Laya.Ease.backOut);var r=i.is_graded?1:i.final/n.exp_step;Laya.timer.once(500,this,function(){var a=(r-i.origin/n.exp_step)/.001;Laya.Tween.to(t.bar_v,{width:384*r},a),Laya.timer.once(a+500,t,function(){i.is_graded?game.Tools.showRewards(i,Laya.Handler.create(t,function(){t.bar_v.width=0;var a=i.final/n.exp_step,r=a/.001;Laya.Tween.to(t.bar_v,{width:384*a},r),Laya.timer.once(r+200,t,function(){e.run()})})):e.run()})})},e.prototype.close=function(){this.me.visible=!1,game.LoadMgr.clearImgSkin(this.icon)},e}(),i=function(){function t(e){this.hearts=[],this.me=e,this.container_hearts=e.getChildByName("hearts");for(var t=0;t<this.container_hearts.numChildren;t++){var i=this.container_hearts.getChildAt(t);this.hearts.push({me:i,mask:i.getChildByName("v").mask})}this.label_num=e.getChildByName("num")}return t.prototype.show=function(){this.me.visible=!0;var t=view.DesktopMgr.Inst.rewardinfo;this.target_level=t.main_character.level,this.target_exp=t.main_character.exp;var i=e.UI_Sushe.main_chara_info;this.chara_info=i,this.current_exp=i.exp,this.current_level=i.level;for(var n=0;n<this.hearts.length;n++)n<i.level?this.hearts[n].mask.scaleY=1:n==i.level?this.hearts[n].mask.scaleY=i.exp/cfg.level_definition.character.get(i.level+1).exp*.82+.1:this.hearts[n].mask.scaleY=0,this.chara_info.is_upgraded?this.hearts[n].me.getChildByName("v").getChildByName("h").skin="myres/bothui/heart_gold.png":this.hearts[n].me.getChildByName("v").getChildByName("h").skin="myres/bothui/bf_heart.png";game.Tools.child_align_center(this.container_hearts,[10,10,10,10]),this.label_num.text="",this.chara_info.level=this.target_level,this.chara_info.exp=this.target_exp},t.prototype.doanim=function(e){var t=this,i=view.DesktopMgr.Inst.rewardinfo.main_character;i?(this.current_level<5?this.label_num.text="+"+i.add.toString():this.label_num.text="",this.label_num.scaleX=this.label_num.scaleY=0,Laya.Tween.to(this.label_num,{scaleX:1,scaleY:1},200,Laya.Ease.backOut),i.level<this.current_level?e.run():i.level==this.current_level&&i.exp<this.current_exp?e.run():(this.anim_complete=e,this.current_level<5?Laya.timer.once(300,this,function(){t._exp_up()}):this.anim_complete&&this.anim_complete.run())):e.run()},t.prototype._exp_up=function(){var t=this,i=this.current_level,n=this.current_exp/cfg.level_definition.character.get(i+1).exp,a=0;a=i!=this.target_level?1:this.target_exp/cfg.level_definition.character.get(this.target_level+1).exp;var r=this.hearts[i];r.mask.scaleY=n;var o=(a-n)/.0015;Laya.Tween.to(r.mask,{scaleY:.82*a+.1},o,null,Laya.Handler.create(this,function(){t.me.visible&&(i!=t.target_level?Laya.timer.once(500,t,function(){e.UI_Character_star_up.Inst.show(t.chara_info,null),Laya.timer.once(500,t,function(){for(var e=0;e<t.hearts.length;e++)e<t.target_level?t.hearts[e].mask.scaleY=1:e==t.target_level?t.hearts[e].mask.scaleY=t.target_exp/cfg.level_definition.character.get(t.target_level+1).exp*.92:t.hearts[e].mask.scaleY=0;t.anim_complete&&t.anim_complete.run()})}):t.anim_complete&&t.anim_complete.run())}))},t.prototype.close=function(){this.me.visible=!1},t}(),n=function(n){function a(){var e=n.call(this,new ui.mj.rewardprogressUI)||this;return a.Inst=e,e}return __extends(a,n),a.prototype.onCreate=function(){this.page_box=new t(this.me.getChildByName("container_box")),this.page_jiban=new i(this.me.getChildByName("container_jiban"))},a.prototype.show=function(t){var i=this;this.complete=t,this.page_box.show(),this.page_jiban.show(),e.UIBase.anim_alpha_in(this.page_box.me,{x:-50},150),e.UIBase.anim_alpha_in(this.page_jiban.me,{x:-50},150,60),Laya.timer.once(600,this,function(){i.page_box.doanim(Laya.Handler.create(i,function(){Laya.timer.once(500,i,function(){i.page_jiban.doanim(Laya.Handler.create(i,function(){t.run()}))})}))}),this.enable=!0},a.prototype.close=function(){this.page_box.close(),this.page_jiban.close(),this.enable=!1},a}(e.UIBase);e.UI_MJReward=n}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(t){function i(){var e=t.call(this,new ui.mj.task_progressUI)||this;return e.tasks=[],e.locking=!1,i.Inst=e,e}return __extends(i,t),i.record=function(){this.datas=[];for(var t=0;t<e.UI_Activity_Xuanshang.datas.length;t++)this.datas.push({id:e.UI_Activity_Xuanshang.datas[t].id,counter:e.UI_Activity_Xuanshang.datas[t].counter,achieved:e.UI_Activity_Xuanshang.datas[t].achieved})},i.needShow=function(){var t=[];if(view.DesktopMgr.Inst&&view.DesktopMgr.Inst.mode==view.EMJMode.play)for(var i=e.UI_Activity_Xuanshang.datas,n=0;n<this.datas.length;n++)if(!this.datas[n].achieved)for(var a=0;a<i.length;a++)if(i[a].id==this.datas[n].id){(i[a].achieved||i[a].counter!=this.datas[n].counter)&&t.push({id:this.datas[n].id,oc:this.datas[n].counter,nc:i[a].counter,achieved:i[a].achieved});break}return t},i.prototype.onCreate=function(){var e=this;this.root=this.me.getChildByName("root"),this.tasks=[];for(var t=0;t<3;t++){var i=this.root.getChildByName("task"+t);this.tasks.push({container:i,bg:i.getChildByName("bg"),item_icon:i.getChildByName("item"),item_name:i.getChildByName("item_name"),item_count:i.getChildByName("item_count"),desc:i.getChildByName("requirement"),progress_bar:i.getChildByName("bar").getChildByName("val"),progress_label:i.getChildByName("progress"),img_finish:i.getChildByName("finished")})}this.btn_close=this.me.getChildByName("btn_close"),this.btn_close.clickHandler=Laya.Handler.create(this,function(){e.locking||e.hide()},null,!1)},i.prototype.show=function(t,i){var n=this;this.enable=!0,this.locking=!0,this.compelte=i,Laya.timer.clearAll(this),this.btn_close.visible=!1,e.UIBase.anim_alpha_in(this.root,{x:0},200,0,Laya.Handler.create(this,function(){},null,!1));for(var a=0,r=function(){++a==t.length&&(n.locking=!1,n.btn_close.visible=!0,Laya.timer.once(2e3,n,function(){n.locking||(n.btn_close.visible=!1,n.hide())}))},o=function(e){var i=s.tasks[e];if(e<t.length){i.container.visible=!0;var a=cfg.events.dailyevent.get(t[e].id),o=cfg.item_definition.currency.get(a.reward_type);o&&(i.item_icon.skin=game.LoadMgr.getResImageSkin(o.icon),i.item_name.text=o.name);var h=cfg.item_definition.item.get(a.reward_type);h&&(i.item_icon.skin=game.LoadMgr.getResImageSkin(h.icon),i.item_name.text=h.name),i.desc.text=a.desc,i.item_count.text=a.reward_num.toString(),i.img_finish.visible=!1,i.progress_bar.scaleX=t[e].oc/a.target,i.progress_label.text=t[e].oc.toString()+"/"+a.target.toString();var l=0,c=((l=t[e].achieved?1:t[e].nc/a.target)-t[e].oc/a.target)/1*1e3;Laya.timer.once(600,s,function(){Laya.Tween.to(i.progress_bar,{scaleX:l},c,Laya.Ease.strongOut,Laya.Handler.create(n,function(){i.progress_label.text=t[e].nc.toString()+"/"+a.target.toString(),t[e].achieved?(i.img_finish.visible=!0,i.img_finish.alpha=0,i.img_finish.scaleX=i.img_finish.scaleY=2,Laya.timer.once(200,n,function(){Laya.Tween.to(i.img_finish,{alpha:1,scaleX:1,scaleY:1},120,Laya.Ease.strongIn,Laya.Handler.create(n,function(){r()}))})):r()}))})}else i.container.visible=!1},s=this,h=0;h<this.tasks.length;h++)o(h)},i.prototype.hide=function(){var t=this;this.locking=!0,e.UIBase.anim_alpha_out(this.root,{x:0},200,0,Laya.Handler.create(this,function(){t.enable=!1,Laya.timer.clearAll(t),t.compelte.run()}))},i.datas=[],i}(e.UIBase);e.UI_MJTask_Progress=t}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(t){function i(){var e=t.call(this,new ui.lobby.nicknameUI)||this;return e.locking=!1,e.btn_cd=0,e}return __extends(i,t),i.show=function(){var t=new i;e.UIMgr.Inst.AddLobbyUI(t),Laya.timer.frameOnce(5,this,function(){t.show()})},i.prototype.onCreate=function(){var t=this;this.root=this.me.getChildByName("root"),this.lb=this.root.getChildByName("lb"),this.input=this.root.getChildByName("txtinput"),this.yes=this.root.getChildByName("yes"),this.no=this.root.getChildByName("no"),this.btn_confirm=this.root.getChildByName("btn_confirm"),this.btn_confirm.clickHandler=Laya.Handler.create(this,this.onBtnConfrim,null,!1),this.input.on("focus",this,function(){t.lb.visible=!1,t.yes.visible=!1,t.no.visible=!1}),this.input.on("blur",this,function(){t.lb.visible=!t.input.text||""==t.input.text}),this.input.on("input",this,function(){if(t.input.text&&""!=t.input.text){for(var e=t.input.text,i=0,n=0,a=0;a<e.length;a++){if(e.charCodeAt(a)>255){if(i+2>16)break;i+=2}else{if(i+1>16)break;i+=1}n++}n!=e.length&&(t.input.text=e.substr(0,n))}}),this.root_xinshou=this.me.getChildByName("root_xinshou"),this.root_xinshou.getChildByName("btn_no").clickHandler=Laya.Handler.create(this,function(){t.locking||t.close_course()},null,!1),this.root_xinshou.getChildByName("btn_yes").clickHandler=Laya.Handler.create(this,function(){t.locking||(t.enable=!1,e.UI_Course.Inst.show(Laya.Handler.create(t,function(){t.destroy(),game.Scene_Lobby.Inst.pending_enter_event()})))},null,!1)},i.prototype.show=function(){var t=this;this.enable=!0,this.locking=!0,this.yes.visible=!1,this.no.visible=!1,this.root_xinshou.visible=!1,e.UIBase.anim_pop_out(this.root,Laya.Handler.create(this,function(){t.locking=!1}))},i.prototype.close_nickname=function(){var t=this;this.locking=!0,e.UIBase.anim_pop_hide(this.root,Laya.Handler.create(this,function(){t.locking=!1,t.root.visible=!1,t.show_course()}))},i.prototype.show_course=function(){var t=this;this.root_xinshou.visible=!0,this.root_xinshou.getChildByName("name").text=this.input.text+" 大人",this.locking=!0,e.UIBase.anim_pop_out(this.root_xinshou,Laya.Handler.create(this,function(){t.locking=!1}))},i.prototype.close_course=function(){var t=this;this.locking=!0,e.UIBase.anim_pop_hide(this.root_xinshou,Laya.Handler.create(this,function(){t.locking=!1,t.enable=!1,t.destroy(),game.Scene_Lobby.Inst.pending_enter_event()}))},i.prototype.onBtnConfrim=function(){var t=this;if(!this.locking&&""!=this.input.text){var i=this.input.text;if(e.UI_Entrance.Accountforbidden(i))this.no.visible=!0;else if(!(Laya.timer.currTimer<this.btn_cd)){this.btn_cd=Laya.timer.currTimer+700,app.NetAgent.sendReq2Lobby("Lobby","modifyNickname",{nickname:i},function(n,a){t.btn_cd=0,n||a.error?e.UIMgr.Inst.showNetReqError("modifyNickname",n,a):(GameMgr.Inst.account_data.nickname=i,GameMgr.Inst.fetch_login_info(),GameMgr.Inst.account_setting[game.EAccountSetKey.user_xieyi.toString()]=1,t.close_nickname())}),app.NetAgent.sendReq2Lobby("Lobby","updateAccountSettings",{setting:{key:game.EAccountSetKey.user_xieyi,value:1}},function(e,t){});var n=e.UI_Sushe.characters,a=Math.floor(Math.random()*n.length);e.UI_Sushe.main_character_id=e.UI_Sushe.characters[a].charid,app.NetAgent.sendReq2Lobby("Lobby","changeMainCharacter",{character_id:e.UI_Sushe.main_character_id},function(e,t){}),GameMgr.Inst.account_data.avatar_id=e.UI_Sushe.characters[a].skin}}},i}(e.UIBase);e.UI_Nickname=t}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(t){function i(){var e=t.call(this,new ui.lobby.number_inputUI)||this;return e.title=null,e.txtinput=null,e.locking=!1,e.root=null,e._when_inputed=null,e._when_cancel=null,i.Inst=e,e}return __extends(i,t),i.prototype.onCreate=function(){var e=this;this.root=this.me.getChildByName("root"),this.root.getChildByName("btn_cancel").clickHandler=Laya.Handler.create(this,function(){e._btn_cancel()},null,!1),this.root.getChildByName("btn_confirm").clickHandler=Laya.Handler.create(this,this._btn_confirm,null,!1),this.txtinput=this.root.getChildByName("input").getChildByName("txtinput"),this.title=this.root.getChildByName("title");for(var t=this.root.getChildByName("numpad"),i=function(i){var a=t.getChildByName("n"+i),r=a.getChildByName("s");r.alpha=0;var o=!1;a.on("mousedown",n,function(){r.alpha=0,o=!0,Laya.Tween.to(r,{alpha:1},50,null,null,0,!0,!0)}),a.on("mouseup",n,function(){Laya.Tween.to(r,{alpha:0},50,null,null,0,!0,!0),o&&e.txtinput.text.length<e.txtinput.maxChars&&(e.txtinput.text=e.txtinput.text+i.toString()),o=!1}),a.on("mouseout",n,function(){Laya.Tween.to(r,{alpha:0},50,null,null,0,!0,!0),o=!1})},n=this,a=0;a<10;a++)i(a);var r=(s=t.getChildByName("clear")).getChildByName("s");r.alpha=0;var o=!1;s.on("mousedown",this,function(){r.alpha=0,o=!0,Laya.Tween.to(r,{alpha:1},50,null,null,0,!0,!0)}),s.on("mouseup",this,function(){Laya.Tween.to(r,{alpha:0},50,null,null,0,!0,!0),o&&(e.txtinput.text=""),o=!1}),s.on("mouseout",this,function(){Laya.Tween.to(r,{alpha:0},50,null,null,0,!0,!0),o=!1});var s=t.getChildByName("del"),h=s.getChildByName("s");h.alpha=0;var l=!1;s.on("mousedown",this,function(){h.alpha=0,l=!0,Laya.Tween.to(h,{alpha:1},50,null,null,0,!0,!0)}),s.on("mouseup",this,function(){if(Laya.Tween.to(h,{alpha:0},50,null,null,0,!0,!0),l){var t=e.txtinput.text;t.length>0&&(t=t.substr(0,t.length-1)),e.txtinput.text=t}l=!1}),s.on("mouseout",this,function(){Laya.Tween.to(h,{alpha:0},50,null,null,0,!0,!0),l=!1})},i.prototype.show=function(t,i,n){var a=this;void 0===n&&(n=null),this.enable=!0,this.txtinput.text="",this.title.text=t,this._when_cancel=n,this._when_inputed=i,this.locking||(this.locking=!0,e.UIBase.anim_pop_out(this.root,Laya.Handler.create(this,function(){a.locking=!1})))},i.prototype._hide=function(t){var i=this;this.locking=!0,e.UIBase.anim_pop_hide(this.root,Laya.Handler.create(this,function(){i.locking=!1,i.enable=!1,t.run()}))},i.prototype._btn_confirm=function(){var e=this;this.locking||this._hide(Laya.Handler.create(this,function(){var t=e._when_inputed;e._when_inputed=null,e._when_cancel=null;var i=0;e.txtinput.text&&""!=e.txtinput.text&&(i=parseInt(e.txtinput.text)),i||(i=0),t&&t.runWith(i)}))},i.prototype._btn_cancel=function(){var e=this;this.locking||this._hide(Laya.Handler.create(this,function(){var t=e._when_cancel;e._when_inputed=null,e._when_cancel=null,t&&t.run()}))},i.Inst=null,i}(e.UIBase);e.UI_NumberInput=t}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(t){function i(){var e=t.call(this,new ui.lobby.obUI)||this;return e.modes=[],e.mode_index=0,e.mode0_list=[],e.mode1_list=[],e.live_datas=[],e.live_show_datas=[],e.fetch_id=0,i.Inst=e,e}return __extends(i,t),i.prototype.onCreate=function(){var t=this;this.container_top=this.me.getChildByName("top"),this.container_top.getChildByName("btn_back").clickHandler=Laya.Handler.create(this,function(){t._locking||t.hide(Laya.Handler.create(t,function(){e.UIMgr.Inst.showLobby()}))},null,!1),this.root=this.me.getChildByName("root"),this.scrollview=this.root.getChildByName("scrollview").scriptMap["capsui.CScrollView"],this.dropdown0=this.root.getChildByName("dropdown0").scriptMap["capsui.CDropdown"],this.dropdown1=this.root.getChildByName("dropdown1").scriptMap["capsui.CDropdown"],this.root.getChildByName("btn_dropdown0").clickHandler=Laya.Handler.create(this,function(){t._locking||t.dropdown0.locking||t.dropdown0.down()},null,!1),this.root.getChildByName("btn_dropdown1").clickHandler=Laya.Handler.create(this,function(){t._locking||t.dropdown1.locking||t.dropdown1.down()},null,!1),this.scrollview.init_scrollview(Laya.Handler.create(this,this.render_scrollview,null,!1)),this.dropdown0.init(Laya.Handler.create(this,this.render_dropdown0,null,!1),Laya.Handler.create(this,this.onDropdown0Change,null,!1)),this.dropdown1.init(Laya.Handler.create(this,this.render_dropdown1,null,!1),Laya.Handler.create(this,this.onDropdown1Change,null,!1)),this.modes=[],this.mode_index=0,cfg.game_live.select_filters.forEach(function(e){1==e.open&&(1==e.initial&&(t.mode_index=t.modes.length),t.modes.push({id:e.id,name0:e.name1,name1:e.name2}))}),this.btn_fresh=this.root.getChildByName("btn_refresh"),this.btn_fresh.clickHandler=Laya.Handler.create(this,function(){t._locking||(game.Tools.setGrayDisable(t.btn_fresh,!0),t.refresh_content(),Laya.timer.once(2e3,t,function(){game.Tools.setGrayDisable(t.btn_fresh,!1)}))},null,!1),this.check_friend=this.root.getChildByName("check_friend").getChildByName("checkbox"),this.check_friend.visible=!1,this.root.getChildByName("check_friend").clickHandler=Laya.Handler.create(this,function(){t._locking||(t.check_friend.visible=!t.check_friend.visible,t.onShowDataChange())},null,!1),this.noinfo=this.root.getChildByName("noinfo"),this.noinfo.visible=!1},i.prototype.show=function(){var t=this;game.Scene_Lobby.Inst.change_bg("indoor",!1),this._locking=!0,this.enable=!0,game.Tools.setGrayDisable(this.btn_fresh,!1),e.UIBase.anim_alpha_in(this.container_top,{y:-30},150),e.UIBase.anim_alpha_in(this.root,{y:30},150,0),Laya.timer.once(150,this,function(){t._locking=!1}),-1==this.mode_index&&(this.mode_index=0);var i=this.modes[this.mode_index].name0,n=this.modes[this.mode_index].name1;this.mode0_list=[],this.mode1_list=[];for(var a=0,r=0,o=0;o<this.modes.length;o++){for(var s=!1,h=0;h<this.mode0_list.length;h++)if(this.mode0_list[h]==this.modes[o].name0){s=!0;break}s||(this.modes[o].name0==i&&(a=this.mode0_list.length),this.mode0_list.push(this.modes[o].name0)),this.modes[o].name0==i&&(this.modes[o].name1==n&&(r=this.mode1_list.length),this.mode1_list.push(this.modes[o].name1))}this.dropdown0.reset_show(a,this.mode0_list.length),this.dropdown1.reset_show(r,this.mode1_list.length),this.refresh_content()},i.prototype.hide=function(t){var i=this;this._locking=!0,e.UIBase.anim_alpha_out(this.container_top,{y:-30},150),e.UIBase.anim_alpha_out(this.root,{y:30},150,0),Laya.timer.clearAll(this),Laya.timer.once(150,this,function(){i._locking=!1,i.enable=!1,t&&t.run()})},i.prototype.onDisable=function(){Laya.timer.clearAll(this)},i.prototype.render_dropdown0=function(e){var t=e.index;e.container.getChildAt(0).text=this.mode0_list[t]},i.prototype.onDropdown0Change=function(e){for(var t=[],i=this.mode0_list[e],n=this.mode1_list[this.dropdown1.choosed_index],a=0;a<this.modes.length;a++)this.modes[a].name0==i&&t.push(this.modes[a].name1);this.mode1_list=t;for(var r=-1,a=0;a<t.length;a++)if(t[a]==n){r=a;break}-1==r&&(r=0),this.dropdown1.reset_show(r,this.mode1_list.length),this.refresh_content()},i.prototype.render_dropdown1=function(e){var t=e.index;e.container.getChildAt(0).text=this.mode1_list[t]},i.prototype.onDropdown1Change=function(e){this.refresh_content()},i.prototype.render_scrollview=function(t){var i=this,n=t.index,a=t.container,r=t.cache_data,o=this.live_show_datas[n];a.getChildByName("mode").text=this.modes[this.mode_index].name0+"·"+this.modes[this.mode_index].name1;var s=new Date(1e3*o.start_time),h=s.getHours()+":";s.getMinutes()<10&&(h+="0"),h+=s.getMinutes().toString(),a.getChildByName("time").text=h;for(var l=0;l<4;l++){var c="p"+l,p=a.getChildByName(c);if(!r[c]){var u={};u.level=new e.UI_Level(p.getChildByName("rank")),u.title=new e.UI_PlayerTitle(p.getChildByName("title")),u.name=p.getChildByName("name"),r[c]=u}if(l<o.players.length){var d=o.players[l];r[c].level.id=d.level.id,r[c].title.id=d.title,r[c].name.text=d.nickname}else r[c].level.id=10101,r[c].title.id=0,r[c].name.text="电脑"}a.getChildByName("btn").clickHandler=Laya.Handler.create(this,function(){i._locking||e.UI_Live_Broadcast.fetchInfo(o.uuid,Laya.Handler.create(i,function(t){t.success&&e.UI_Live_Broadcast.goToWatch(o.uuid,t.data,o.players[0].account_id)}))},null,!1)},i.prototype.onShowDataChange=function(){this.scrollview.reset(),this.live_show_datas=[];for(var e=0;e<this.live_datas.length;e++)if(this.check_friend.visible){for(var t=!1,i=0;i<4;i++)if(!(i>=this.live_datas[e].players.length)){var n=this.live_datas[e].players[i].account_id;if(game.FriendMgr.find(n)){t=!0;break}}t&&this.live_show_datas.push(this.live_datas[e])}else this.live_show_datas.push(this.live_datas[e]);0==this.live_show_datas.length?this.noinfo.visible=!0:(this.noinfo.visible=!1,this.scrollview.addItem(this.live_show_datas.length))},i.prototype.refresh_content=function(){var t=this;this.scrollview.reset(),this.live_datas=[],this.mode_index=0;for(var i=this.mode0_list[this.dropdown0.choosed_index],n=this.mode1_list[this.dropdown1.choosed_index],a=0;a<this.modes.length;a++)this.modes[a].name0==i&&this.modes[a].name1==n&&(this.mode_index=a);var r=1e5*Math.random();this.fetch_id=r,app.NetAgent.sendReq2Lobby("Lobby","fetchGameLiveList",{filter_id:this.modes[this.mode_index].id},function(i,n){if(i||n.error)e.UIMgr.Inst.showNetReqError("fetchGameLiveList",i,n);else{if(t.fetch_id!=r)return;t.live_datas=[];for(var a=0;a<n.live_list.length;a++)t.live_datas.push(n.live_list[a]);t.onShowDataChange()}})},i}(e.UIBase);e.UI_Ob=t}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(t){function i(){var e=t.call(this,new ui.both_ui.otherplayerinfoUI)||this;return e.account_id=0,e.origin_x=0,e.origin_y=0,e.root=null,e.title=null,e.level=null,e.btn_addfriend=null,e.illust=null,e.label_name=null,e.detail_data=null,e.locking=!1,e.tab_info=null,e.tab_note=null,i.Inst=e,e}return __extends(i,t),i.prototype.onCreate=function(){var t=this;this.root=this.me.getChildByName("root"),this.origin_x=this.root.x,this.origin_y=this.root.y,this.container_info=this.root.getChildByName("container_info"),this.title=new e.UI_PlayerTitle(this.container_info.getChildByName("title")),this.label_name=this.container_info.getChildByName("ID"),this.level=new e.UI_Level(this.container_info.getChildByName("rank")),this.detail_data=new e.UI_PlayerData(this.container_info.getChildByName("data")),this.illust=new e.UI_Character_Skin(this.root.getChildByName("illust").getChildByName("illust")),this.btn_addfriend=this.container_info.getChildByName("btn_add"),this.btn_addfriend.clickHandler=Laya.Handler.create(this,function(){t.btn_addfriend.visible=!1,app.NetAgent.sendReq2Lobby("Lobby","applyFriend",{target_id:t.account_id},function(e,t){})},null,!1),this.root.getChildByName("btn_close").clickHandler=Laya.Handler.create(this,function(){t.close()},null,!1),this.note=new e.UI_PlayerNote(this.root.getChildByName("container_note"),null),this.tab_info=this.root.getChildByName("tab_info"),this.tab_info.clickHandler=Laya.Handler.create(this,function(){t.locking||t.container_info.visible||(t.container_info.visible=!0,t.tab_info.skin="myres/bothui/info_tab_chosen.png",t.tab_note.skin="myres/bothui/info_tab_dark.png",t.note.close())},null,!1),this.tab_note=this.root.getChildByName("tab_note"),this.tab_note.clickHandler=Laya.Handler.create(this,function(){t.locking||t.container_info.visible&&(t.container_info.visible=!1,t.tab_info.skin="myres/bothui/info_tab_dark.png",t.tab_note.skin="myres/bothui/info_tab_chosen.png",t.note.show())},null,!1),this.locking=!1},i.prototype.show=function(t){var i=this;GameMgr.Inst.BehavioralStatistics(14),this.account_id=t,this.enable=!0,this.locking=!0,game.Scene_MJ.Inst&&game.Scene_MJ.Inst.active?this.root.y=470:this.root.y=560,e.UIBase.anim_pop_out(this.root,Laya.Handler.create(this,function(){i.locking=!1})),this.detail_data.reset(),app.NetAgent.sendReq2Lobby("Lobby","fetchAccountStatisticInfo",{account_id:t},function(t,n){t||n.error?e.UIMgr.Inst.showNetReqError("fetchAccountStatisticInfo",t,n):(app.Log.log(JSON.stringify(n)),i.detail_data.show(n))}),this.tab_info.skin="myres/bothui/info_tab_chosen.png",this.tab_note.skin="myres/bothui/info_tab_dark.png",this.container_info.visible=!0,this.note.close(),this.note.init_data(t),this.refreshBaseInfo()},i.prototype.refreshBaseInfo=function(){var t=this;this.level.id=0,this.title.id=0,this.illust.me.visible=!1,this.label_name.text="",this.btn_addfriend.visible=!1,app.NetAgent.sendReq2Lobby("Lobby","fetchAccountInfo",{account_id:this.account_id},function(i,n){if(i||n.error)e.UIMgr.Inst.showNetReqError("fetchAccountInfo",i,n);else{var a=n.account;t.label_name.text=a.nickname,t.title.id=a.title,t.level.id=a.level.id,t.level.exp=a.level.score,t.illust.me.visible=!0,t.illust.setSkin(a.avatar_id,"waitingroom"),t.account_id==GameMgr.Inst.account_id||null!=game.FriendMgr.find(t.account_id)?t.btn_addfriend.visible=!1:t.btn_addfriend.visible=!0,t.note.sign.setSign(a.signature)}})},i.prototype.close=function(){var t=this;this.enable&&(this.locking||(this.locking=!0,this.detail_data.close(),e.UIBase.anim_pop_hide(this.root,Laya.Handler.create(this,function(){t.locking=!1,t.enable=!1}))))},i.prototype.onDisable=function(){this.detail_data.close(),this.illust.clear(),Laya.loader.clearTextureRes(this.level.icon.skin)},i.Inst=null,i}(e.UIBase);e.UI_OtherPlayerInfo=t}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(){function t(e){var t=this;this.me=e,this.title=this.me.getChildByName("title"),this.input=this.me.getChildByName("input").getChildByName("txtinput"),this.btn_confirm=this.me.getChildByName("btn_confirm"),this.btn_cancel=this.me.getChildByName("btn_cancel"),this.me.visible=!1,this.btn_cancel.clickHandler=Laya.Handler.create(this,function(){t.hide(null)},null,!1)}return t.prototype.show_share=function(t){var i=this;this.title.text="牌谱链接",GameMgr.inConch?(this.btn_confirm.visible=!0,this.btn_confirm.clickHandler=Laya.Handler.create(this,function(){Laya.PlatformClass.createClass("layaair.majsoul.mjmgr").call("setSysClipboardText",i.input.text),i.hide(null)},null,!1)):GameMgr.iniOSWebview?(this.btn_confirm.visible=!0,this.btn_confirm.clickHandler=Laya.Handler.create(this,function(){Laya.Browser.window.wkbridge.callNative("copy2clip",i.input.text,function(){}),i.hide(null)},null,!1)):(this.btn_confirm.visible=!1,this.btn_confirm.clickHandler=Laya.Handler.create(this,function(){},null,!1)),this.input.editable=!1;var n=game.Tools.encode_account_id(GameMgr.Inst.account_id);this.input.text="雀魂牌谱: http://majsoul.union-game.com/0/?paipu="+t+"_a"+n,this.me.visible=!0,this.locking=!0,e.UIBase.anim_pop_out(this.me,Laya.Handler.create(this,function(){i.locking=!1}))},t.prototype.show_check=function(){var t=this;this.title.text="输入牌谱链接",this.btn_confirm.visible=!0,this.btn_confirm.getChildAt(0).text="确定",this.btn_confirm.clickHandler=Laya.Handler.create(this,function(){t.hide(Laya.Handler.create(t,function(){var e=t.input.text.split("="),i=e[e.length-1].split("_"),n=0;i.length>1&&(n="a"==i[1].charAt(0)?game.Tools.decode_account_id(parseInt(i[1].substr(1))):parseInt(i[1]));var a=0;if(i.length>2){var r=parseInt(i[2]);r&&(a=r)}GameMgr.Inst.checkPaiPu(i[0],n,a)}))},null,!1),this.input.editable=!0,this.input.text="",this.me.visible=!0,this.locking=!0,e.UIBase.anim_pop_out(this.me,Laya.Handler.create(this,function(){t.locking=!1}))},t.prototype.hide=function(t){var i=this;this.locking=!0,e.UIBase.anim_pop_hide(this.me,Laya.Handler.create(this,function(){i.locking=!1,i.me.visible=!1,t&&t.run()}))},t}(),i=function(i){function n(){var e=i.call(this,new ui.lobby.paipuUI)||this;return e.top=null,e.container_scrollview=null,e.scrollview=null,e.loading=null,e.locking=!1,e._paipu_index=0,e._have_more_paipu=!0,e._paipu_step=10,e.record_list=[],e.pop=null,e.duringload=!1,n.Inst=e,e}return __extends(n,i),n.prototype.onCreate=function(){var i=this;this.top=this.me.getChildByName("top"),this.top.getChildByName("btn_back").clickHandler=Laya.Handler.create(this,function(){i.locking||i.close(Laya.Handler.create(i,function(){e.UIMgr.Inst.showLobby()}))},null,!1),this.container_scrollview=this.me.getChildByName("scrollview"),this.scrollview=this.container_scrollview.scriptMap["capsui.CScrollView"],this.scrollview.init_scrollview(Laya.Handler.create(this,function(e){i.setItemValue(e.index,e.container)},null,!1)),this.container_scrollview.on("ratechange",this,function(){i.loading.visible||i._have_more_paipu&&(i.duringload||(1-i.scrollview.rate)*i._paipu_index<3&&i._loadList())}),this.loading=this.container_scrollview.getChildByName("loading"),this.loading.visible=!1,this.pop=new t(this.me.getChildByName("pop")),this.container_scrollview.getChildByName("checkother").clickHandler=Laya.Handler.create(this,function(){i.pop.me.visible||i.pop.show_check()},null,!1)},n.prototype.show=function(){var t=this;GameMgr.Inst.BehavioralStatistics(20),game.Scene_Lobby.Inst.change_bg("indoor",!1),this.enable=!0,this.pop.me.visible=!1,e.UIBase.anim_alpha_in(this.top,{y:-30},200),e.UIBase.anim_alpha_in(this.container_scrollview,{y:30},200),this.locking=!0,this.duringload=!1,Laya.timer.once(200,this,function(){t.locking=!1}),this.record_list=[],this._paipu_index=0,this._have_more_paipu=!0,this.scrollview.reset()},n.prototype.close=function(t){var i=this;this.locking=!0,e.UIBase.anim_alpha_out(this.top,{y:-30},150),e.UIBase.anim_alpha_out(this.container_scrollview,{y:30},150),Laya.timer.once(150,this,function(){i.locking=!1,i.enable=!1,t&&t.run()})},n.prototype.setItemValue=function(e,t){var i=this;if(this.enable&&!(e>=this.record_list.length)){for(var n=this.record_list[e],a=0;a<4;a++){var r=t.getChildByName("p"+a.toString()),o=r.getChildByName("chosen"),s=r.getChildByName("rank"),h=r.getChildByName("rank_word"),l=r.getChildByName("name"),c=r.getChildByName("score"),p=n.result.players[a];c.text=p.part_point_1;for(var u="电脑",d=!1,_=0;_<n.accounts.length;_++)if(n.accounts[_].seat==p.seat){u=n.accounts[_].nickname,d=n.accounts[_].account_id==GameMgr.Inst.account_id;break}l.text=u,o.visible=d,c.color=d?"#ffc458":"#b98930",l.color=d?"#dfdfdf":"#a0a0a0",h.color=s.color=d?"#57bbdf":"#489dbc"}var m=new Date(1e3*n.end_time),f="";f+=m.getFullYear()+"/",f+=(m.getMonth()<9?"0":"")+(m.getMonth()+1).toString()+"/",f+=(m.getDate()<10?"0":"")+m.getDate()+" ",f+=(m.getHours()<10?"0":"")+m.getHours()+":",f+=(m.getMinutes()<10?"0":"")+m.getMinutes(),t.getChildByName("date").text=f,t.getChildByName("check").clickHandler=Laya.Handler.create(this,function(){i.locking||GameMgr.Inst.checkPaiPu(i.record_list[e].uuid,GameMgr.Inst.account_id,0)},null,!1),t.getChildByName("share").clickHandler=Laya.Handler.create(this,function(){i.locking||i.pop.me.visible||(i.pop.show_share(i.record_list[e].uuid),GameMgr.Inst.BehavioralStatistics(21))},null,!1);var g=t.getChildByName("room"),y=game.Tools.get_room_desc(n.config);g.text=y.text,g.font=y.isSimhei?"SimHei":"fengyu"}},n.prototype._loadList=function(){var t=this;if(!this.duringload&&!this.loading.visible&&this._have_more_paipu){this.duringload=!0;var i=this;app.NetAgent.sendReq2Lobby("Lobby","fetchGameRecordList",{start:this._paipu_index,count:this._paipu_step},function(n,a){if(t.duringload=!1,n||a.error)e.UIMgr.Inst.showNetReqError("fetchGameRecordList",n,a),i.loading.visible=!1;else if(app.Log.log(JSON.stringify(a)),a.record_list&&a.record_list.length>0){var r=a.record_list;i._paipu_index+=r.length;for(var o=0;o<r.length;o++)i.record_list.push(r[o]);i.scrollview.addItem(r.length),t.loading.visible=!1,t._have_more_paipu=!0}else t._have_more_paipu=!1}),Laya.timer.once(700,this,function(){t.duringload&&(t.loading.visible=!0)})}},n.Inst=null,n}(e.UIBase);e.UI_PaiPu=i}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t;!function(e){e[e.none=0]="none",e[e.during=1]="during",e[e.success=2]="success"}(t||(t={}));var i=function(i){function n(){var e=i.call(this,new ui.lobby.pipeiUI)||this;return e.state=t.none,n.Inst=e,app.NetAgent.AddListener2Lobby("NotifyRoomGameStart",Laya.Handler.create(e,function(t){e.enable&&(app.Log.log("NotifyRoomGameStart:"+JSON.stringify(t)),e.onGameStart(t))})),app.NetAgent.AddListener2Lobby("NotifyMatchTimeout",Laya.Handler.create(e,function(t){app.Log.log("NotifyMatchTimeout:"+JSON.stringify(t)),e.onMatchTimeout(t)})),e}return __extends(n,i),n.prototype.onCreate=function(){var t=this;this.root=this.me.getChildByName("root"),this.info=this.root.getChildByName("text"),this.title=this.root.getChildByName("ttt"),this.btn=this.root.getChildByName("btn"),this.btn.clickHandler=Laya.Handler.create(this,function(){t.locking||(t.btn.disabled=!0,app.NetAgent.sendReq2Lobby("Lobby","cancelMatch",{},function(i,n){i||n.error?e.UIMgr.Inst.showNetReqError("cancelMatch",i,n):t.close()}))},null,!1),this.btn.disabled=!1},n.prototype.tryToClose=function(i){var n=this;this.state==t.none?(this.enable=!1,i.runWith(!0)):this.state==t.during?app.NetAgent.sendReq2Lobby("Lobby","cancelMatch",{},function(t,a){t||a.error?(e.UIMgr.Inst.showNetReqError("cancelMatch",t,a),i.runWith(!1)):(n.enable=!1,i.runWith(!0),n.close())}):this.state==t.success&&i.runWith(!1)},n.prototype.show=function(i){var n=this;this.enable=!0,this.locking=!0,this.btn.disabled=!1,this.root.scaleX=this.root.scaleY=1,e.UIBase.anim_pop_out(this.root,Laya.Handler.create(this,function(){n.locking=!1})),Laya.timer.clearAll(this);var a=0;this.state=t.none,Laya.timer.loop(1e3,this,function(){var e="匹配对手中";a=(a+1)%4;for(var t=0;t<a;t++)e+=".";n.info.text=e}),Laya.timer.once(300,this,function(){n.state=t.during,n.enable&&!n.locking&&app.NetAgent.sendReq2Lobby("Lobby","matchGame",{match_mode:i},function(i,a){(i||a.error)&&(e.UIMgr.Inst.showNetReqError("matchGame",i,a),n.close(),n.state=t.none)})})},n.prototype.close=function(){var t=this;this.locking=!0,e.UIBase.anim_pop_hide(this.root,Laya.Handler.create(this,function(){t.locking=!1,t.enable=!1}))},n.prototype.onDisable=function(){Laya.timer.clearAll(this)},n.prototype.onGameStart=function(i){this.state=t.success,this.enable=!1,e.UI_Lobby.Inst.enable=!1,game.MJNetMgr.Inst.OpenConnect(i.game_url,i.connect_token,i.game_uuid,!1,null)},n.prototype.onMatchTimeout=function(i){this.close(),this.state=t.none,e.UI_Popout.PopOutNoTitle("没有找到合适的对手，请稍后重试",null)},n.Inst=null,n}(e.UIBase);e.UI_PiPei=i}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(){function e(t){var n=this;this.change_cd=0,e.Inst=this,this.me=t,this.input=t.getChildByName("input"),t.getChildByName("btn_confirm").clickHandler=Laya.Handler.create(this,function(){var e=n.input.text;e==GameMgr.Inst.account_data.signature||(GameMgr.Inst.account_data.signature=e,app.NetAgent.sendReq2Lobby("Lobby","modifySignature",{signature:e},function(e,t){}),n.change_cd=Laya.timer.currTimer+3e4,i.Inst.note.sign.setSign(e)),n.me.visible=!1},null,!1),this.input.on("input",this,function(){if(n.input.text&&""!=n.input.text){for(var e=n.input.text,t=0,i=0,a=0;a<e.length;a++){if(e.charCodeAt(a)>255){if(t+2>180)break;t+=2}else{if(t+1>180)break;t+=1}i++}i!=e.length&&(n.input.text=e.substr(0,i))}})}return e.prototype.show=function(){this.me.visible=!0,this.input.text=GameMgr.Inst.account_data.signature},e.Inst=null,e}();e.Sign_Input=t;var i=function(i){function n(){var e=i.call(this,new ui.lobby.playerinfoUI)||this;return e.origin_x=0,e.origin_y=0,e.root=null,e.title=null,e.level=null,e.input=null,e.label_name=null,e.detail_data=null,e.tab_info=null,e.tab_note=null,e.note_readpoint=null,e.locking=!1,e.havenewcomment=!1,n.Inst=e,e}return __extends(n,i),n.prototype.onCreate=function(){var i=this;this.root=this.me.getChildByName("root"),this.origin_x=this.root.x,this.origin_y=this.root.y,this.container_info=this.root.getChildByName("container_info"),this.title=new e.UI_PlayerTitle(this.container_info.getChildByName("title")),this.label_name=this.container_info.getChildByName("ID"),this.level=new e.UI_Level(this.container_info.getChildByName("rank")),this.detail_data=new e.UI_PlayerData(this.container_info.getChildByName("data")),this.root.getChildByName("btn_close").clickHandler=Laya.Handler.create(this,function(){i.close()},null,!1),this.container_info.getChildByName("btn_title").clickHandler=Laya.Handler.create(this,function(){e.UI_TitleBook.Inst.show()},null,!1),this.container_info.getChildByName("btn_changenickname").clickHandler=Laya.Handler.create(this,function(){e.UI_Change_Nickname.Inst.show()},null,!1),this.container_info.getChildByName("btn_rank").clickHandler=Laya.Handler.create(this,function(){e.UI_Introduce.Inst.show()},null,!1),this.tab_info=this.root.getChildByName("tab_info"),this.tab_info.clickHandler=Laya.Handler.create(this,function(){i.locking||i.container_info.visible||(i.container_info.visible=!0,i.tab_info.skin="myres/bothui/info_tab_chosen.png",i.tab_note.skin="myres/bothui/info_tab_dark.png",i.note.close())},null,!1),this.tab_note=this.root.getChildByName("tab_note"),this.tab_note.clickHandler=Laya.Handler.create(this,function(){i.locking||i.container_info.visible&&(i.container_info.visible=!1,i.tab_info.skin="myres/bothui/info_tab_dark.png",i.tab_note.skin="myres/bothui/info_tab_chosen.png",i.note.show())},null,!1),this.note_readpoint=this.tab_note.getChildByName("redpoint"),this.note_readpoint.visible=!1,this.note=new e.UI_PlayerNote(this.root.getChildByName("container_note"),this.note_readpoint),this.locking=!1,this.input=new t(this.me.getChildByName("container_sign_input")),this.input.me.visible=!1},n.prototype.show=function(){var t=this;this.locking||(this.enable=!0,this.root.alpha=0,this.root.y=this.origin_y+100,this.locking=!0,Laya.Tween.to(this.root,{alpha:1,y:this.origin_y},200,null,Laya.Handler.create(this,function(){t.locking=!1})),this.detail_data.reset(),app.NetAgent.sendReq2Lobby("Lobby","fetchAccountStatisticInfo",{account_id:GameMgr.Inst.account_id},function(i,n){i||n.error?e.UIMgr.Inst.showNetReqError("fetchAccountStatisticInfo",i,n):(app.Log.log(JSON.stringify(n)),t.detail_data.show(n))}),this.tab_info.skin="myres/bothui/info_tab_chosen.png",this.tab_note.skin="myres/bothui/info_tab_dark.png",this.container_info.visible=!0,this.note.close(),this.note.init_data(GameMgr.Inst.account_id),this.refreshBaseInfo(),this.input.me.visible=!1)},n.prototype.refreshBaseInfo=function(){var e=GameMgr.Inst.account_data;this.label_name.text=e.nickname,this.title.id=e.title,this.level.id=e.level.id,this.level.exp=e.level.score,this.note.sign.setSign(e.signature)},n.prototype.close=function(){var e=this;this.locking||(this.locking=!0,Laya.Tween.to(this.root,{alpha:0,y:this.origin_y+100},200,null,Laya.Handler.create(this,function(){e.locking=!1,e.enable=!1})))},n.prototype.onDisable=function(){this.detail_data.close()},n.Inst=null,n}(e.UIBase);e.UI_PlayerInfo=i}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(t){function i(){var e=t.call(this,new ui.lobby.popnoticeUI)||this;return e.contents=[],e}return __extends(i,t),i.Pop=function(t){var n=this;if(!this.during2show){var a=this;this.during2show=!0;var r=function(){if(a.info&&a.info.id){var r=!0,o=GameMgr.Inst.account_id;if(!t){var s=a.info.id;if(Laya.LocalStorage.getItem("popnotice_id_"+o)==s.toString()){var h=Laya.LocalStorage.getItem("popnotice_time_"+o),l=0;h&&""!=h&&(l=parseInt(h));Date.now()/1e3<l+86400&&(r=!1)}}if(r){var c=new i;e.UIMgr.Inst.AddLobbyUI(c),Laya.timer.frameOnce(5,n,function(){n.during2show=!1,c.show(a.info.title,a.info.content)}),Laya.LocalStorage.setItem("popnotice_id_"+o,a.info.id),Laya.LocalStorage.setItem("popnotice_time_"+o,Math.floor(Date.now()/1e3).toString())}else n.during2show=!1}else n.during2show=!1};!this.info||Laya.timer.currTimer>this.last_fetch_time+0?(this.last_fetch_time=Laya.timer.currTimer,app.NetAgent.sendReq2Lobby("Lobby","fetchAnnouncement",{},function(e,t){e||t.error?r():(n.info=t,r())})):r()}},i.prototype.onCreate=function(){this.root=this.me.getChildByName("root"),this.root.getChildByName("btn").clickHandler=Laya.Handler.create(this,this.hide,null,!1),this.title=this.root.getChildByName("title");var e=this.root.getChildByName("content");this.contents=[];for(var t=0;t<e.numChildren;t++)this.contents.push(e.getChildAt(t))},i.prototype.show=function(t,i){this.me.visible=!0,e.UIBase.anim_pop_out(this.root,null),this.title.text=t;for(var n=i.split("\n"),a=0;a<this.contents.length;a++)a<n.length?(this.contents[a].text=n[a],this.contents[a].visible=!0):this.contents[a].visible=!1},i.prototype.hide=function(){var t=this;e.UIBase.anim_pop_hide(this.root,Laya.Handler.create(this,function(){t.root.visible=!1,t.me.destroy(!0)}))},i.info=null,i.last_fetch_time=0,i.during2show=!1,i}(e.UIBase);e.UI_Popnotice=t}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(){function t(e){this.locking=!1,this.me=e,this.info=e.getChildByName("text"),e.getChildByName("btn").clickHandler=Laya.Handler.create(this,this.close,[1],!1),e.getChildByName("btn_cancel").clickHandler=Laya.Handler.create(this,this.close,[0],!1)}return t.prototype.show=function(t,i){var n=this;this.func_confirm=i,this.info.text=t,this.me.visible=!0,this.locking=!0,e.UIBase.anim_pop_out(this.me,Laya.Handler.create(this,function(){n.locking=!1}))},t.prototype.close=function(t){var i=this;this.locking||(this.locking=!0,e.UIBase.anim_pop_hide(this.me,Laya.Handler.create(this,function(){i.locking=!1,i.me.visible=!1,i.func_confirm&&i.func_confirm.runWith(t),i.func_confirm=null})))},t}(),i=function(){function t(e){this.locking=!1,this.me=e,this.info=e.getChildByName("text"),this.title=e.getChildByName("ttt"),e.getChildByName("btn").clickHandler=Laya.Handler.create(this,this.close,[1],!1),e.getChildByName("btn_cancel").clickHandler=Laya.Handler.create(this,this.close,[0],!1)}return t.prototype.show=function(t,i,n){var a=this;this.title.text=t,this.func_confirm=n,this.info.text=i,this.me.visible=!0,this.locking=!0,e.UIBase.anim_pop_out(this.me,Laya.Handler.create(this,function(){a.locking=!1}))},t.prototype.close=function(t){var i=this;this.locking||(this.locking=!0,e.UIBase.anim_pop_hide(this.me,Laya.Handler.create(this,function(){i.locking=!1,i.me.visible=!1,i.func_confirm&&i.func_confirm.runWith(t),i.func_confirm=null})))},t}(),n=function(e){function n(){var t=e.call(this,new ui.both_ui.popwindowUI)||this;return t.pop_notitle=null,t.pop_withtitle=null,n.Inst=t,t}return __extends(n,e),n.PopOutWithTitle=function(e,t,i){var n=this;this.Inst.enable=!0,this.Inst.pop_withtitle.show(e,t,Laya.Handler.create(this,function(e){n.Inst.enable=!1,i&&i.runWith(e)}))},n.PopOutNoTitle=function(e,t){var i=this;this.Inst.enable=!0,this.Inst.pop_notitle.show(e,Laya.Handler.create(this,function(e){i.Inst.enable=!1,t&&t.runWith(e)}))},n.prototype.onCreate=function(){this.pop_notitle=new t(this.me.getChildByName("notitle")),this.pop_withtitle=new i(this.me.getChildByName("title")),this.pop_notitle.me.visible=!1,this.pop_withtitle.me.visible=!1},n.Inst=null,n}(e.UIBase);e.UI_Popout=n}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(e){function t(){var t=e.call(this,new ui.common.preventaddictionUI)||this;return t.container_tips=null,t.container_time=null,t.label_time=null,t.next_show_tip_time=0,t.tips0=null,t.tips1=null,t.tips2=null,t}return __extends(t,e),t.prototype.onCreate=function(){this.container_tips=this.me.getChildByName("container_tips"),this.container_time=this.me.getChildByName("container_time"),this.label_time=this.container_time.getChildByName("time"),this.tips0=this.container_tips.getChildByName("l0"),this.tips1=this.container_tips.getChildByName("l1"),this.tips2=this.container_tips.getChildByName("l2"),Laya.timer.loop(1e3,this,this.timePass)},t.prototype.onEnable=function(){this.next_show_tip_time=0;var e=Math.ceil(((Laya.timer.currTimer-GameMgr.Inst.account_refresh_time)/1e3+GameMgr.Inst.account_data.anti_addiction.online_duration)/60);this.refreshTime(e),this.caluNextTipsTime(e),this.container_tips.visible=!1},t.prototype.timePass=function(){var e=Math.ceil(((Laya.timer.currTimer-GameMgr.Inst.account_refresh_time)/1e3+GameMgr.Inst.account_data.anti_addiction.online_duration)/60);this.refreshTime(e),e>=this.next_show_tip_time&&(this.tips0.visible=e<180,this.tips1.visible=e>=180&&e<300,this.tips2.visible=e>=300,e<180&&(this.tips0.text="您累计在线时间已满"+Math.floor(e/60)+"小时"),this.container_tips.visible=!0,this.caluNextTipsTime(e))},t.prototype.caluNextTipsTime=function(e){this.next_show_tip_time=e<180?60*Math.ceil((e+1)/60):e<300?30*Math.ceil((e-180+1)/30)+180:15*Math.ceil((e-300+1)/15)+300},t.prototype.refreshTime=function(e){var t=Math.floor(e/60),i=e%60,n="";t<10&&(n+="0"),n+=t.toString(),n+=":",i<10&&(n+="0"),n+=i,this.label_time.text=n},t}(e.UIBase);e.UI_PreventAddiction=t}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(t){function i(){var e=t.call(this,new ui.lobby.rankUI)||this;return e.root=null,e.nolimitlist=null,e.player_infos=[],e.self_rank=-1,e.locking=!1,e.usedskin=[],e.container_self=null,e.self_head=null,e.self_level=null,e.self_title=null,e.self_name=null,i.Inst=e,e}return __extends(i,t),i.prototype.onCreate=function(){var t=this;this.root=this.me.getChildByName("root"),this.nolimitlist=this.root.getChildByName("content").scriptMap["capsui.NoLimitList"],this.nolimitlist.init_nolimitlist(Laya.Handler.create(this,this._loadInfo,null,!1),Laya.Handler.create(this,function(e){t.setItemValue(e.index,e.container,e.cache_data)},null,!1)),this.root.getChildByName("btn_close").clickHandler=Laya.Handler.create(this,function(){t.locking||t.close(null)},null,!1),this.container_self=this.root.getChildByName("self"),this.self_head=new e.UI_Head(this.container_self.getChildByName("self").getChildByName("head")),this.self_level=new e.UI_Level(this.container_self.getChildByName("self").getChildByName("rank")),this.self_title=new e.UI_PlayerTitle(this.container_self.getChildByName("self").getChildByName("title")),this.self_name=this.container_self.getChildByName("self").getChildByName("name"),this.container_self.visible=!1},i.prototype.setItemValue=function(t,i,n){if(this.enable){var a=i.getChildByName("rank_img"),r=i.getChildByName("rankno");t<3?(r.visible=!1,a.visible=!0,a.skin="myres/lobby/rank_"+(t+1).toString()+".png"):(r.visible=!0,a.visible=!1,r.text=(t+1).toString());var o=this.player_infos[t];n.hasOwnProperty("head")||(n.head=new e.UI_Head(i.getChildByName("head"))),n.head.id=o.info.avatar_id,this._addusedskin(n.head.img_head.skin),n.hasOwnProperty("rank")||(n.level=new e.UI_Level(i.getChildByName("rank"))),n.level.id=o.level.id,this._addusedskin(n.level.icon.skin),n.hasOwnProperty("title")||(n.title=new e.UI_PlayerTitle(i.getChildByName("title"))),n.title.id=o.info.title,this._addusedskin(n.title.img.skin),i.getChildByName("rankscore").text=o.level.score,i.getChildByName("name").text=o.info.nickname,i.getChildByName("btn_see").clickHandler=Laya.Handler.create(this,function(){e.UI_OtherPlayerInfo.Inst.show(o.account_id)},null,!1)}},i.prototype.show=function(){var t=this;this.nolimitlist.reset(),this.enable=!0,this.locking=!0,this.usedskin=[],e.UIBase.anim_pop_out(this.root,Laya.Handler.create(this,function(){t.locking=!1,t.loadData()}))},i.prototype.close=function(t){var i=this;this.locking=!0,e.UIBase.anim_pop_hide(this.root,Laya.Handler.create(this,function(){i.locking=!1,i.enable=!1,t&&t.run()}))},i.prototype.onDisable=function(){for(var e=0;e<this.usedskin.length;e++)Laya.loader.clearTextureRes(this.usedskin[e]);this.usedskin=[],this.player_infos=[]},i.prototype.loadData=function(){var t=this;Laya.timer.currTimer;this.player_infos=[],this.nolimitlist.reset(),this.self_rank=-1,app.NetAgent.sendReq2Lobby("Lobby","fetchLevelLeaderboard",{},function(i,n){if(i||n.error)e.UIMgr.Inst.showNetReqError("fetchLevelLeaderboard",i,n);else{for(var a=n.items.length,r=0;r<a;r++)t.player_infos.push(n.items[r]);t.nolimitlist.total_count=t.player_infos.length,t.self_rank&&(t.self_rank=n.self_rank),t.setMeRank(),t.container_self.visible=!0}})},i.prototype._loadInfo=function(t){for(var i=this,n=[],a=0;a<20&&a+t<this.player_infos.length;a++)n.push(this.player_infos[t+a].account_id);0==n.length?(game.Tools.debugFetchMultiAccountBrief("rank",t,this.nolimitlist.total_count,this.nolimitlist.value_count),this.nolimitlist.loadOver(!1,0)):app.NetAgent.sendReq2Lobby("Lobby","fetchMultiAccountBrief",{account_id_list:n},function(n,a){if(n||a.error)e.UIMgr.Inst.showNetReqError("fetchMultiAccountBrief",n,a),i.nolimitlist.loadOver(!1,0);else{for(var r=-1,o=0;o<a.players.length;o++){if(i.player_infos[t+o].info=a.players[o],i.player_infos[t+o].account_id!=a.players[o].account_id){r=t+o;break}i.player_infos[t+o].info=a.players[o]}-1!=r?(e.UIMgr.Inst.ShowErrorInfo("加载第"+(r+1).toString()+"个数据时出错"),i.nolimitlist.loadOver(!1,0)):i.nolimitlist.loadOver(!0,a.players.length)}})},i.prototype._addusedskin=function(e){for(var t=!1,i=0;i<this.usedskin.length;i++)if(e==this.usedskin[i]){t=!0;break}t||this.usedskin.push(e)},i.prototype.setMeRank=function(){if(this.enable){this.container_self.visible=!0;var e=this.container_self.getChildByName("self").getChildByName("rank_img"),t=this.container_self.getChildByName("self").getChildByName("rankno");this.self_rank<=0?(t.visible=!1,e.visible=!1):this.self_rank<=3?(t.visible=!1,e.visible=!0,e.skin="myres/lobby/rank_"+this.self_rank.toString()+".png"):this.self_rank<=999?(t.visible=!0,e.visible=!1,t.text=this.self_rank.toString(),t.fontSize=60):(t.visible=!0,e.visible=!1,t.text="999+",t.fontSize=45),this.self_head.id=GameMgr.Inst.account_data.avatar_id,this.self_level.id=GameMgr.Inst.account_data.level.id,this.self_title.id=GameMgr.Inst.account_data.title,this.self_name.text=GameMgr.Inst.account_data.nickname,this.container_self.getChildByName("self").getChildByName("rankscore").text=GameMgr.Inst.account_data.level.score.toString()}},i.Inst=null,i}(e.UIBase);e.UI_Rank=t}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(){function e(e){this.stars=[],this.me=e,this.container_rank=e.getChildByName("rank"),this.icon_new=this.container_rank.getChildByName("icon_new"),this.icon_old=this.container_rank.getChildByName("icon_old");for(var t=1;t<=3;t++)this.stars.push(this.container_rank.getChildByName("star"+t).getChildAt(0));this.container_bar=this.me.getChildByName("bar"),this.barshine=this.container_bar.getChildByName("fullshine"),this.barval=this.container_bar.getChildByName("container").mask,this.scores=this.container_bar.getChildByName("score"),this.f_jinji=this.me.getChildByName("f_jinji"),this.f_jiangduan=this.me.getChildByName("f_jiangduan"),this.f_shengduan=this.me.getChildByName("f_shengduan"),this.continue_add=this.me.getChildByName("+"),this.label_add=this.continue_add.getChildByName("score"),this.continue_minus=this.me.getChildByName("-"),this.label_minus=this.continue_minus.getChildByName("score")}return e.prototype.reset=function(){this.icon_new.alpha=1,this.icon_new.visible=!1,this.icon_old.alpha=1,this.icon_old.visible=!1;for(var e=0;e<this.stars.length;e++)this.stars[e].scaleX=this.stars[e].scaleY=1,this.stars[e].alpha=1,this.stars[e].visible=!1;this.barshine.visible=!1,this.barshine.alpha=1,this.f_jinji.visible=!1,this.f_jiangduan.visible=!1,this.f_shengduan.visible=!1,this.scores.visible=!1},e.prototype.showInit=function(){this.reset(),this.me.visible=!0;var e=view.DesktopMgr.Inst.levelchangeinfo,t=e.origin.id,i=e.origin.score,a=e.final.id,r=(e.final.score,cfg.level_definition.level_definition.find(t)),o=cfg.level_definition.level_definition.find(a),s=i/r.end_point*.78;n.Inst.me,this.barval;this.barval.scaleY=s,this.icon_old.visible=!0,this.icon_old.skin=game.LoadMgr.getResImageSkin(r.primary_icon);for(var h=0;h<this.stars.length;h++)this.stars[h].visible=!0,this.stars[h].alpha=h<r.secondary_level?1:0;this.icon_new.visible=!1,this.icon_new.skin=game.LoadMgr.getResImageSkin(o.primary_icon),this.icon_old.scaleX=this.icon_old.scaleY=1,this.continue_add.visible=!1,this.continue_minus.visible=!1},e.prototype.showLevelChange=function(){var e=this,t=view.DesktopMgr.Inst.levelchangeinfo,i=t.origin.id,a=t.origin.score,r=t.final.id,o=t.final.score,s=cfg.level_definition.level_definition.find(i),h=cfg.level_definition.level_definition.find(r),l=a/s.end_point*.78,c=o/h.end_point*.78,p=n.Inst.me,u=this.barval,d=0;if(this.scores.text=o.toString()+"/"+h.end_point.toString(),this.scores.visible=!0,this.scores.alpha=0,u.scaleY=l,i==r){var _=Math.abs(l-c)/3e-4;_>50&&(Laya.timer.once(d,this,function(){Laya.Tween.to(u,{scaleY:c},_),e.play_exp_audio(_)}),d+=_),d+=100}else if(s.primary_level<h.primary_level){var m=(.78-l)/3e-4;Laya.timer.once(d,this,function(){Laya.Tween.to(u,{scaleY:.78},m),e.play_exp_audio(m)}),d+=m,Laya.timer.once(d,this,function(){e.barshine.visible=!0,p.ani0.play(0,!1)}),d+=p.ani0.count*p.ani0.interval,Laya.timer.once(d,this,function(){n.Inst.ShengDuan()}),d=-1}else if(s.primary_level>h.primary_level){this.icon_new.visible=!0,this.icon_new.alpha=0,this.icon_new.skin=game.LoadMgr.getResImageSkin(h.primary_icon);var f=l/3e-4;Laya.timer.once(d,this,function(){Laya.Tween.to(u,{scaleY:0},f),e.play_exp_audio(f)}),d+=f,Laya.timer.once(d,this,function(){var t=e.stars[0],i=game.FrontEffect.Inst.create_ui_effect(t.parent,"scene/effect_losestar.lh",new Laya.Point(0,0),1);Laya.timer.once(100,e,function(){t.alpha=0}),Laya.timer.once(2e3,e,function(){i.destory()})}),d+=1200,Laya.timer.once(d,this,function(){e.f_jiangduan.visible=!0,p.ani_jiangduan.play(0,!1)}),d+=2300;var g=(.78-c)/3e-4;Laya.timer.once(d,this,function(){u.scaleY=.78,Laya.Tween.to(u,{scaleY:c},g),e.play_exp_audio(g)}),d+=g}else if(s.secondary_level<h.secondary_level){var y=(.78-l)/3e-4;Laya.timer.once(d,this,function(){Laya.Tween.to(u,{scaleY:.78},y),e.play_exp_audio(y)}),d+=y,Laya.timer.once(d,this,function(){e.barshine.visible=!0,p.ani0.play(0,!1)}),d+=p.ani0.interval*p.ani0.count,Laya.timer.once(d,this,function(){e.f_jinji.visible=!0;var t=2==h.secondary_level?e.stars[1]:e.stars[2],i=game.FrontEffect.Inst.create_ui_effect(t.parent,"scene/effect_getstar.lh",new Laya.Point(0,0),1);view.AudioMgr.PlayAudio(218),Laya.timer.once(100,e,function(){t.alpha=1}),Laya.timer.once(1e3,e,function(){i.destory()})}),d+=1200;var v=c/3e-4;Laya.timer.once(d,this,function(){e.barshine.visible=!1,u.scaleY=0,Laya.Tween.to(u,{scaleY:c},v),e.play_exp_audio(v)}),d+=v}else if(s.secondary_level>h.secondary_level){var x=l/3e-4;Laya.timer.once(d,this,function(){Laya.Tween.to(u,{scaleY:0},x),e.play_exp_audio(x)}),d+=x,Laya.timer.once(d,this,function(){e.f_shengduan.visible=!0;var t=2==h.secondary_level?e.stars[2]:e.stars[1],i=game.FrontEffect.Inst.create_ui_effect(t.parent,"scene/effect_losestar.lh",new Laya.Point(0,0),1);Laya.timer.once(100,e,function(){t.alpha=0}),Laya.timer.once(2e3,e,function(){i.destory()})}),d+=1800;var b=(.78-c)/3e-4;Laya.timer.once(d,this,function(){u.scaleY=.78,Laya.Tween.to(u,{scaleY:c},b),e.play_exp_audio(b)}),d+=b}return d>=0&&(Laya.timer.once(d,this,function(){Laya.Tween.to(e.scores,{alpha:1},150),view.DesktopMgr.Inst.ptchange>0&&(e.label_add.text=view.DesktopMgr.Inst.ptchange.toString(),e.continue_add.visible=!0,e.continue_add.alpha=0,Laya.Tween.to(e.continue_add,{alpha:1},150)),view.DesktopMgr.Inst.ptchange<0&&(e.label_minus.text=view.DesktopMgr.Inst.ptchange.toString(),e.continue_minus.visible=!0,e.continue_minus.alpha=0,Laya.Tween.to(e.continue_minus,{alpha:1},150))}),d+=150),d},e.prototype.shengduanOver=function(){var e=view.DesktopMgr.Inst.levelchangeinfo,t=e.origin.id,i=e.origin.score,a=e.final.id,r=e.final.score,o=cfg.level_definition.level_definition.find(t),s=cfg.level_definition.level_definition.find(a),h=(o.end_point,r/s.end_point*.78);n.Inst.me,this.barval;this.f_jinji.visible=!1,this.icon_old.visible=!0,this.barshine.visible=!1,this.icon_old.skin=game.LoadMgr.getResImageSkin(s.primary_icon);for(var l=0;l<this.stars.length;l++)this.stars[l].visible=!0,this.stars[l].alpha=l<s.secondary_level?1:0;this.icon_new.visible=!1,this.barval.scaleY=h,this.scores.alpha=1},e.prototype.play_exp_audio=function(e){var t=this;e<0||(view.AudioMgr.PlayAudio(220),Laya.timer.once(150,this,function(){t.play_exp_audio(e-150)}))},e}(),i=function(){function e(e){this._effect_book=null,this.me=e,this._ui=n.Inst.me,this.black=this.me.getChildByName("black"),this.shine=this.me.getChildByName("shine"),this.book_shine=this.me.getChildByName("book_shine"),this.btn_open=this.me.getChildByName("btn_open"),this.container_main=this.me.getChildByName("main"),this.call=this.container_main.getChildByName("call"),this.contianer_name=this.container_main.getChildByName("name"),this.label_name=this.contianer_name.getChildByName("name"),this.label_time=this.container_main.getChildByName("time"),this.btn_close=this.container_main.getChildByName("btn_close"),this.rank=this.container_main.getChildByName("rankbg").getChildByName("rank")}return e.prototype.show=function(){var e=this;this.me.visible=!0,this.black.visible=!0,this.black.alpha=0,this._ui.ani1.play(0,!1),this.btn_open.visible=!1,Laya.timer.once(500,this,function(){view.AudioMgr.PlayAudio(105)}),Laya.timer.once(625,this,function(){e.btn_open.visible=!0,e._effect_book=game.FrontEffect.Inst.create_ui_effect(e.book_shine,"scene/effect_juanzhou.lh",new Laya.Point(0,0),1),Laya.timer.once(1e3,e,function(){e.btn_open.clickHandler=Laya.Handler.create(e,e.openBook)})})},e.prototype.openBook=function(){var e=this;this._effect_book&&this._effect_book.destory(),this.container_main.visible=!0;var t=view.DesktopMgr.Inst.levelchangeinfo,i=t.final.id,n=(t.final.score,new Date);this.label_time.text=n.getFullYear()+"."+(n.getMonth()+1).toString()+"."+n.getDate();var a=cfg.level_definition.level_definition.find(i),r=GameMgr.Inst.account_data.nickname;this.label_name.text=r,this.contianer_name.width=this.label_name.x+this.label_name.textWidth+34,this.call.x=30+this.contianer_name.x+this.contianer_name.width,this.rank.skin=game.LoadMgr.getResImageSkin(a.primary_icon),this._ui.ani2.play(0,!1),this.btn_close.clickHandler=null,Laya.timer.once(8/24*1e3,this,function(){view.AudioMgr.PlayAudio(228)});for(var o=[29,43,56,104],s=0;s<o.length;s++)Laya.timer.once(o[s]/24*1e3,this,function(){view.AudioMgr.PlayAudio(104)});Laya.timer.once(88/24*1e3,this,function(){var t=game.FrontEffect.Inst.create_ui_effect(e.rank.parent,"scene/effect_queshi_bang.lh",new Laya.Point(0,0),0);view.AudioMgr.PlayAudio(229),Laya.timer.once(1e3,e,function(){t.destory()})}),Laya.timer.once(this._ui.ani2.interval*this._ui.ani2.count,this,function(){e.btn_close.clickHandler=Laya.Handler.create(e,e.closeBook,null,!0)})},e.prototype.closeBook=function(){var e=this;view.AudioMgr.PlayAudio(228),n.Inst.pagerank.shengduanOver(),this.btn_close.visible=!1,this._ui.ani3.play(0,!1),Laya.timer.once(this._ui.ani3.interval*this._ui.ani3.count,this,function(){e.me.visible=!1,n.Inst.AnimOver()})},e}(),n=function(n){function a(){var e=n.call(this,new ui.mj.rankchangeUI)||this;return e.atlas="res/atlas/myres/mjdesktop/shengduan.atlas",a.Inst=e,e}return __extends(a,n),a.prototype.onCreate=function(){this.pagerank=new t(this.me.getChildByName("rank_change")),this.pagerankup=new i(this.me.getChildByName("rankup")),this.pagerank.me.visible=!1,this.pagerankup.me.visible=!1,Laya.loader.clearTextureRes(this.atlas)},a.prototype.show=function(t){var i=this;this.complete=t,this.enable=!0,this.pagerank.showInit(),this.pagerankup.me.visible=!1,Laya.timer.clearAll(this),e.UIBase.anim_alpha_in(this.pagerank.me,{x:0},100,0),Laya.timer.once(500,this,function(){var e=i.pagerank.showLevelChange();e>0&&Laya.timer.once(e,i,function(){i.AnimOver()})})},a.prototype.close=function(){this.enable=!1,Laya.loader.clearTextureRes(this.atlas)},a.prototype.ShengDuan=function(){this.pagerankup.show()},a.prototype.AnimOver=function(){Laya.loader.clearTextureRes(this.atlas),this.complete.run()},a.Inst=null,a}(e.UIBase);e.UI_RankChange=n}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(){function t(e){var t=this;this.me=e,this.root=this.me.getChildByName("root"),this.name=this.root.getChildByName("label_name"),this.desc=this.root.getChildByName("desc"),this.root.getChildByName("btn_close").clickHandler=Laya.Handler.create(this,function(){t.close()},null,!1),this.container_item=this.root.getChildByName("item"),this.buyed=this.container_item.getChildByName("buyed"),this.icon=this.container_item.getChildByName("icon"),this.container_price=this.root.getChildByName("price"),this.btn_buy=this.root.getChildByName("btn_buy")}return t.prototype.show_recharge=function(t,i){var n=this;this.me.visible=!0,e.UIBase.anim_pop_out(this.root,null);var a;cfg.mall.goods_shelves.getGroup(t).forEach(function(e){e.goods_id==i&&(a=e)});var o=cfg.mall.goods.get(i);this.name.text=o.name,this.desc.text=o.desc,game.LoadMgr.setImgSkin(this.icon,o.icon),this.container_price.getChildByName("icon").visible=!1;var s=null;r.Inst.app_shop&&(s=r.Inst.app_shop.getGoodsInfo(i)),this.container_price.getChildByName("count").text=s?s.price:a.price,game.Tools.child_align_center(this.container_price,[20]),this.buyed.visible=!1,game.Tools.setGrayDisable(this.container_item,!1),game.Tools.setGrayDisable(this.btn_buy,!1),this.btn_buy.clickHandler=Laya.Handler.create(this,function(){n.close(),game.Tools.setGrayDisable(n.btn_buy,!0),r.Inst.want_to_recharge(i)},null,!1)},t.prototype.show_exchange=function(t){var i=this;this.me.visible=!0,e.UIBase.anim_pop_out(this.root,null);var n=cfg.exchange.exchange.get(t);this.name.text=n.name,this.desc.text=n.desc,game.LoadMgr.setImgSkin(this.icon,n.icon),this.container_price.getChildByName("icon").skin=game.LoadMgr.getResImageSkin(cfg.item_definition.currency.get(n.source_currency).icon),this.container_price.getChildByName("icon").visible=!0;var a=e.UI_Bag.get_item_count(n.source_currency);this.buyed.visible=!1,game.Tools.setGrayDisable(this.container_item,!1),game.Tools.setGrayDisable(this.btn_buy,a<n.source_value);var o=this.container_price.getChildByName("count");o.text=n.source_value.toString(),o.color=a<n.source_value?"#ff0000":"#00ff00",game.Tools.child_align_center(this.container_price),this.btn_buy.clickHandler=Laya.Handler.create(this,function(){i.close(),game.Tools.setGrayDisable(i.btn_buy,!0),r.Inst.want_to_exchange(t)},null,!1)},t.prototype.close=function(){var t=this;e.UIBase.anim_pop_hide(this.root,Laya.Handler.create(this,function(){t.me.visible=!1}))},t}(),i=function(){function e(e){var t=this;this.current_id=0,this.me=e,this.current_title_big=e.getChildByName("current_title_big"),this.current_title_small=e.getChildByName("container_next").getChildByName("current_title_small"),this.next_title=e.getChildByName("container_next").getChildByName("next_title"),this.next_info=e.getChildByName("container_next").getChildByName("next_info"),this.label_infos=[];for(var i=e.getChildByName("container_infos"),n=0;n<i.numChildren;n++)this.label_infos.push(i.getChildAt(n));this.label_require=e.getChildByName("require"),this.label_value=e.getChildByName("value"),this.btn_left=e.getChildByName("btn_left"),this.btn_left.clickHandler=Laya.Handler.create(this,function(){t.current_id--,t.refresh()},null,!1),this.btn_right=e.getChildByName("btn_right"),this.btn_right.clickHandler=Laya.Handler.create(this,function(){t.current_id++,t.refresh()},null,!1),this.container_bar=e.getChildByName("bar").getChildByName("v"),this.bar_v=e.getChildByName("bar").getChildByName("v").mask}return e.prototype.show=function(){var e=this;this.me.visible=!0;var t=0;GameMgr.Inst.account_data.vip&&(t=GameMgr.Inst.account_data.vip),this.current_id=1,cfg.vip.vip.forEach(function(i){t>=i.charge&&(e.current_id=i.id)});var i=cfg.vip.vip.get(this.current_id);if(i){var n=cfg.vip.vip.get(this.current_id+1);n?(this.label_value.text=t.toString()+"/"+n.charge.toString(),this.bar_v.width=this.container_bar.width*t/n.charge,game.LoadMgr.setImgSkin(this.current_title_small,i.img),game.LoadMgr.setImgSkin(this.next_title,n.img),this.next_info.text="再充值"+(n.charge-t).toString()+"元即可升级为",this.next_info.visible=!0,this.next_title.visible=!0,game.Tools.child_align_center(this.me.getChildByName("container_next"),[0,30,0])):(this.label_value.text=t.toString(),this.bar_v.width=this.container_bar.width,game.LoadMgr.setImgSkin(this.current_title_small,i.img),this.next_info.visible=!1,this.next_title.visible=!1,game.Tools.child_align_center(this.me.getChildByName("container_next"),[0,30,0]))}else this.me.getChildByName("container_next").visible=!1;this.refresh()},e.prototype.close=function(){this.me.visible=!1},e.prototype.refresh=function(){var e=cfg.vip.vip.get(this.current_id);if(e){game.LoadMgr.setImgSkin(this.current_title_big,e.img),this.btn_left.visible=null!=cfg.vip.vip.get(this.current_id-1),this.btn_right.visible=null!=cfg.vip.vip.get(this.current_id+1),0==e.charge?this.label_require.text="":this.label_require.text="达成条件：充值"+e.charge+"元";for(var t=e.desc.split("\\n"),i=0;i<this.label_infos.length;i++)i<t.length?(this.label_infos[i].text=t[i],this.label_infos[i].visible=!0):this.label_infos[i].visible=!1}},e}(),n=function(){function t(i){var n=this;this.root=null,this.icon=null,this.label_title=null,this.label_price=null,this.label_method=null,this.loading=null,this.locking=!1,this.id=0,t.Inst=this,this.me=i,this.root=i.getChildByName("root"),this.icon=this.root.getChildByName("icon"),this.icon.skin="",this.root.getChildByName("btn_close").clickHandler=Laya.Handler.create(this,function(){n.locking||n.close()},null,!1),this.root.getChildByName("btn_close2").clickHandler=Laya.Handler.create(this,function(){n.locking||n.close()},null,!1),this.label_price=this.root.getChildByName("price").getChildByName("v"),this.label_title=this.root.getChildByName("title").getChildByName("v"),this.label_method=this.root.getChildByName("method"),this.loading=this.root.getChildByName("loading"),app.NetAgent.AddListener2Lobby("NotifyPayResult",Laya.Handler.create(this,function(t){app.Log.log("NotifyPayResult msg:"+JSON.stringify(t)+" this.me.visible:"+n.me.visible+" this.order_id:"+n.order_id+" =="+(n.order_id==t.order_id));var i="购买"+cfg.mall.goods.get(t.goods_id).name;0===t.pay_result?i+="成功":i+="失败",e.UI_LightTips.Inst.show(i),n.me.visible&&n.order_id==t.order_id&&n.close()},null,!1))}return t.prototype.show=function(t,i){var n=this;this.locking=!0,this.me.visible=!0,e.UIBase.anim_pop_out(this.root,Laya.Handler.create(this,function(){n.locking=!1})),this.loading.visible=!0,this.id++;var a=this.id,r=cfg.mall.goods.get(t);this.label_title.text=r.name,this.label_price.text=r.cny+"元";var o="";i?(this.label_method.text="微信",this.label_method.color="#44b44c",o="createWechatNativeOrder"):(this.label_method.text="支付宝",this.label_method.color="#00a9ec",o="createAlipayScanOrder"),app.NetAgent.sendReq2Lobby("Lobby",o,{goods_id:t,client_type:0,account_id:GameMgr.Inst.account_id},function(t,i){if(n.me.visible&&a==n.id)if(t||i.error)e.UIMgr.Inst.showNetReqError(o,t,i),n.close();else{app.Log.log(o+" "+JSON.stringify(i)),n.order_id=i.order_id;var r=i.qrcode_buffer;GameMgr.inConch,Laya.loader.load(r,Laya.Handler.create(n,function(){a==n.id&&n.me.visible?(n.icon.skin=r,n.loading.visible=!1):n.release_code(r)}))}})},t.prototype.release_code=function(e){var t=Laya.loader.getRes(e);t&&t.destroy()},t.prototype.close=function(){var t=this;app.Log.log("wxcode close"),this.locking=!0,this.order_id="",e.UIBase.anim_pop_hide(this.root,Laya.Handler.create(this,function(){t.me.visible=!1,t.locking=!1,""!=t.icon.skin&&(t.release_code(t.icon.skin),t.icon.skin="")}))},t}(),a=function(){function t(t){var i=this;this.me=t,this.root=t.getChildByName("root"),this.label_title=this.root.getChildByName("title"),this.label_price=this.root.getChildByName("price");var a=this.root.getChildByName("lst"),o=a.getChildByName("wx"),s=a.getChildByName("alipay"),h=a.getChildByName("alipay_code");o.clickHandler=Laya.Handler.create(this,function(){i.locking||(i.close(null),GameMgr.inChina&&(GameMgr.inConch?(r.Inst.container_loading.visible=!0,app.NetAgent.sendReq2Lobby("Lobby","createWechatAppOrder",{goods_id:i.goods_id,client_type:0,account_id:GameMgr.Inst.account_id},function(t,i){if(r.Inst.container_loading.visible=!1,t||i.error)e.UIMgr.Inst.showNetReqError("createWechatAppOrder",t,i);else{var n=i.call_wechat_app_param;Laya.PlatformClass.createClass("layaair.majsoul.mjmgr").call("onWechatAppOrder",n.appid,n.partnerid,n.prepayid,n.package,n.noncestr,n.timestamp,n.sign)}})):GameMgr.iniOSWebview?(r.Inst.container_loading.visible=!0,app.NetAgent.sendReq2Lobby("Lobby","createWechatAppOrder",{goods_id:i.goods_id,client_type:0,account_id:GameMgr.Inst.account_id},function(t,i){if(r.Inst.container_loading.visible=!1,t||i.error)e.UIMgr.Inst.showNetReqError("createWechatAppOrder",t,i);else{var n=i.call_wechat_app_param,a=n.partnerid+","+n.prepayid+","+n.package+","+n.noncestr+","+n.timestamp+","+n.sign;Laya.Browser.window.wkbridge.callNative("wxpay",a,function(){})}})):n.Inst.show(i.goods_id,!0)))},null,!1),s.clickHandler=Laya.Handler.create(this,function(){if(!i.locking&&(i.close(null),GameMgr.inChina))if(r.Inst.container_loading.visible=!0,1==r.alipay_type)app.NetAgent.sendReq2Lobby("Lobby","createAlipayScanOrder",{goods_id:i.goods_id,client_type:0,account_id:GameMgr.Inst.account_id},function(t,i){if(r.Inst.container_loading.visible=!1,t||i.error)e.UIMgr.Inst.showNetReqError("createAlipayScanOrder",t,i);else{var n=i.qr_code;if(GameMgr.inConch){Laya.PlatformClass.createClass("layaair.majsoul.mjmgr").call("onAlipay_Brower",n)}else GameMgr.iniOSWebview?Laya.Browser.window.wkbridge.callNative("alipay_brower",n,function(){}):Laya.Browser.window.location.href=n}});else{var t="";t=GameMgr.inConch||GameMgr.iniOSWebview?"APP":Laya.Browser.onPC?"PC_WEB":"MOBILE_WEB",app.NetAgent.sendReq2Lobby("Lobby","createAlipayOrder",{goods_id:i.goods_id,client_type:0,account_id:GameMgr.Inst.account_id,alipay_trade_type:t,return_url:GameMgr.Inst.link_url},function(t,i){if(r.Inst.container_loading.visible=!1,t||i.error)e.UIMgr.Inst.showNetReqError("createAlipayOrder",t,i);else{var n=i.alipay_url;if(GameMgr.inConch){a=n.split("?");Laya.PlatformClass.createClass("layaair.majsoul.mjmgr").call("onAlipay",a[a.length-1])}else if(GameMgr.iniOSWebview){var a=n.split("?");Laya.Browser.window.wkbridge.callNative("alipay",a[a.length-1],function(){})}else Laya.Browser.window.location.href=n}})}},null,!1),h.clickHandler=Laya.Handler.create(this,function(){i.locking||(i.close(null),GameMgr.inChina&&n.Inst.show(i.goods_id,!1))},null,!1),this.root.getChildByName("btn_close").clickHandler=Laya.Handler.create(this,function(){i.locking||i.close(null)},null,!1)}return t.prototype.show=function(t,i){var n=this;this.goods_id=t;var a=cfg.mall.goods.get(t);this.label_title.text=a.name,this.label_price.text=a.cny+"元",i||(i=""),this.root.getChildByName("extendinfo").text=i,this.locking=!0,this.me.visible=!0,e.UIBase.anim_pop_out(this.root,Laya.Handler.create(this,function(){n.locking=!1}));var o=this.root.getChildByName("lst"),s=o.getChildByName("wx"),h=o.getChildByName("alipay"),l=o.getChildByName("alipay_code"),c=[];if(r.open_wx&&(GameMgr.inConch||GameMgr.iniOSWebview||Laya.Browser.onPC)?(s.visible=!0,c.push(s)):s.visible=!1,r.open_alipay?(1==r.alipay_type?GameMgr.inConch||GameMgr.iniOSWebview||!Laya.Browser.onPC?(h.visible=!0,c.push(h)):h.visible=!1:(h.visible=!0,c.push(h)),1==r.alipay_type?(l.visible=!0,c.push(l)):l.visible=!1):(h.visible=!1,l.visible=!1),o.vScrollBarSkin="",c.length<=2)for(p=0;p<c.length;p++)c[p].y=50+144*p;else for(var p=0;p<c.length;p++)c[p].y=144*p;o.vScrollBar.value=0,o.refresh()},t.prototype.close=function(t){var i=this;this.locking=!0,e.UIBase.anim_pop_hide(this.root,Laya.Handler.create(this,function(){i.locking=!1,i.me.visible=!1,t&&t.run()}))},t}(),r=function(r){function o(){var e=r.call(this,new ui.lobby.rechargeUI)||this;return e.money=null,e.tabs=[],e.locking=!1,e.goods_sheleve_id="",e.tab_index=-1,e.items=[],e.app_shop=null,o.Inst=e,e}return __extends(o,r),o.on_new_recharge_refresh=function(t){if(t.new_recharged_list){for(var i=0;i<t.new_recharged_list.length;i++)e.UI_Recharge.new_recharge_list[t.new_recharged_list[i]]=1;this.Inst&&this.Inst.enable&&this.Inst.scrollview.wantToRefreshAll()}},o.prototype.onCreate=function(){var r=this;this.container_top=this.me.getChildByName("top"),this.container_top.getChildByName("btn_back").clickHandler=Laya.Handler.create(this,function(){r.locking||r.close(Laya.Handler.create(r,function(){e.UI_Lobby.Inst.enable=!0}))},null,!1),this.money=new e.UI_Money(this.container_top,null,Laya.Handler.create(this,function(){return r.locking},null,!1)),this.container_content=this.me.getChildByName("content"),this.container_tab=this.container_content.getChildByName("tabs"),this.tabs=[];for(var o=function(e){var t=s.container_tab.getChildAt(e);s.tabs.push(t),t.clickHandler=Laya.Handler.create(s,function(){r.tab_index!=e&&r.change_tab(e)},null,!1)},s=this,h=0;h<this.container_tab.numChildren;h++)o(h);var l=this.container_content.getChildByName("right");this.container_right=l,this.scrollview=l.scriptMap["capsui.CScrollView"],this.scrollview.init_scrollview(Laya.Handler.create(this,this.render_good_shelves,null,!1),-1,4),this.page_vip=new i(this.container_content.getChildByName("page_vip")),this.buy_single=new t(this.me.getChildByName("pop_buy_single")),this.container_loading=this.me.getChildByName("container_loading"),this.container_loading.visible=!1,GameMgr.inConch&&GameMgr.inGooglePlay&&(this.app_shop=new game.GooglePlayShop,this.app_shop.onGameStart()),this.page_wxcode=new n(this.me.getChildByName("wxcode")),this.page_wxcode.me.visible=!1,this.page_choose=new a(this.me.getChildByName("choose_method")),this.page_choose.me.visible=!1},o.prototype.show=function(t){var i=this;if(this.enable=!0,this.locking=!0,game.Scene_Lobby.Inst.change_bg("indoor",!1),e.UIBase.anim_alpha_in(this.container_top,{y:-30},150),e.UIBase.anim_alpha_in(this.container_content,{y:30},150),this.money.onEnable(),Laya.timer.once(150,this,function(){i.locking=!1}),GameMgr.config_data.goods_sheleve_id&&""!=GameMgr.config_data.goods_sheleve_id&&o.open_payment){this.goods_sheleve_id=GameMgr.config_data.goods_sheleve_id;for(n=0;n<this.tabs.length;n++)this.tabs[n].visible=n<3;this.tabs[0].getChildByName("label_name").text="辉玉屋",this.tabs[1].getChildByName("label_name").text="铜币屋",this.tabs[2].getChildByName("label_name").text="契约等级"}else{this.goods_sheleve_id="";for(var n=0;n<this.tabs.length;n++)this.tabs[n].visible=n<2;this.tabs[0].getChildByName("label_name").text="铜币屋",this.tabs[1].getChildByName("label_name").text="契约等级"}this.refresh_info(t)},o.prototype.close=function(t){var i=this;this.locking=!0,e.UIBase.anim_alpha_out(this.container_top,{y:-30},150),e.UIBase.anim_alpha_out(this.container_content,{y:30},150),Laya.timer.once(150,this,function(){i.locking=!1,i.enable=!1,i.tab_index=-1,t.run()})},o.prototype.refresh_info=function(e){this.buy_single.me.visible=!1,e?""==this.goods_sheleve_id?this.change_tab(0):this.change_tab(1):this.change_tab(0)},o.prototype.change_tab=function(e){var t=this;this.tab_index=e;for(var i=0;i<this.tabs.length;i++)this.tabs[i].skin=e==i?"myres/shop/tab_choose.png":"myres/shop/tab_unchoose.png",this.tabs[i].getChildAt(0).color=e==i?"#d9b263":"#8cb65f";this.container_right.visible=!1,this.page_vip.close(),this.items=[],this.scrollview.reset(),""!=this.goods_sheleve_id?0==e?(this.container_right.visible=!0,this.scrollview.change_render_handler(Laya.Handler.create(this,this.render_good_shelves,null,!1)),cfg.mall.goods_shelves.getGroup(this.goods_sheleve_id).forEach(function(e){t.items.push(e.goods_id)}),this.scrollview.addItem(this.items.length)):1==e?(this.container_right.visible=!0,this.scrollview.change_render_handler(Laya.Handler.create(this,this.render_recharge,null,!1)),cfg.exchange.exchange.forEach(function(e){t.items.push(e.id)}),this.scrollview.addItem(this.items.length)):this.page_vip.show():0==e?(this.container_right.visible=!0,this.scrollview.change_render_handler(Laya.Handler.create(this,this.render_recharge,null,!1)),cfg.exchange.exchange.forEach(function(e){t.items.push(e.id)}),this.scrollview.addItem(this.items.length)):this.page_vip.show()},o.prototype.render_recharge=function(e){var t=this,i=e.index,n=e.container,a=cfg.exchange.exchange.get(this.items[i]),r=n.getChildByName("btn");r.clickHandler=Laya.Handler.create(this,function(){t.buy_single.show_exchange(t.items[i])},null,!1),r.getChildByName("label_name").text=a.name,game.LoadMgr.setImgSkin(r.getChildByName("icon"),a.icon),r.filters=[],r.getChildByName("buyed").visible=!1,r.getChildByName("count").visible=!1;var o=r.getChildByName("btn_buy").getChildByName("currency");o.visible=!0,game.LoadMgr.setImgSkin(o,cfg.item_definition.currency.get(a.source_currency).icon),r.getChildByName("btn_buy").getChildByName("label_gold").text=a.source_value.toString(),game.Tools.child_align_center(r.getChildByName("btn_buy")),r.getChildByName("shouchong").visible=!1},o.prototype.render_good_shelves=function(t){var i,n=this,a=t.index,r=t.container.getChildByName("btn");cfg.mall.goods_shelves.getGroup(this.goods_sheleve_id).forEach(function(e){e.goods_id==n.items[a]&&(i=e)}),r.clickHandler=Laya.Handler.create(this,function(){if(n.app_shop&&(n.app_shop.recover_pre_order(n.items[a])?e.UI_LightTips.Inst.show("正在恢复上一笔订单"):n.buy_single.show_recharge(n.goods_sheleve_id,n.items[a])),GameMgr.iniOSWebview)e.UI_Popout.PopOutNoTitle("iOS版本暂不支持充值",null);else if(e.UI_ShiMingRenZheng.renzhenged||GameMgr.Inst.player_in_haiwai){var t="",i="";o.payment_info&&""!=o.payment_info&&(0==o.payment_info_show_type&&(t=o.payment_info),1==o.payment_info_show_type&&(i=o.payment_info)),t&&""!=t?e.UI_Popout.PopOutNoTitle(t,null):n.page_choose.show(n.items[a],i)}else e.UI_ShiMingRenZheng.Inst.show()},null,!1);var s=cfg.mall.goods.get(this.items[a]);r.getChildByName("label_name").text=s.name,game.LoadMgr.setImgSkin(r.getChildByName("icon"),s.icon),r.filters=[],r.getChildByName("buyed").visible=!1,r.getChildByName("count").visible=!1,r.getChildByName("btn_buy").getChildByName("currency").visible=!1;var h=null;this.app_shop&&(h=this.app_shop.getGoodsInfo(this.items[a])),r.getChildByName("btn_buy").getChildByName("label_gold").text=h?h.price:i.price,game.Tools.child_align_center(r.getChildByName("btn_buy")),o.new_recharge_list[s.cny]?r.getChildByName("shouchong").visible=!1:(r.getChildByName("shouchong").visible=!0,r.getChildByName("shouchong").getChildByName("desc_shouchong").text=s.first_desc)},o.prototype.want_to_exchange=function(t){app.NetAgent.sendReq2Lobby("Lobby","exchangeCurrency",{id:t},function(t,i){(t||i.error)&&e.UIMgr.Inst.showNetReqError("exchangeCurrency",t,i)})},o.prototype.want_to_recharge=function(e){var t=this;this.app_shop&&(this.container_loading.visible=!0,this.app_shop.want2BuyItem(e,Laya.Handler.create(this,function(){t.container_loading.visible=!1})))},o.open_payment=!1,o.payment_info_show_type=1,o.payment_info="",o.open_wx=!0,o.wx_type=0,o.open_alipay=!0,o.alipay_type=0,o.new_recharge_list={},o}(e.UIBase);e.UI_Recharge=r}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(e){function t(){var i=e.call(this,new ui.common.reconnectUI)||this;return t.Inst=i,i}return __extends(t,e),t.prototype.onCreate=function(){var e=this;this.me.getChildByName("btn_ok").clickHandler=Laya.Handler.create(this,function(){e.enable=!1,game.MJNetMgr.Inst.OpenConnect(GameMgr.Inst.mj_server_url,GameMgr.Inst.mj_game_token,GameMgr.Inst.mj_game_uuid,!0,null)},null,!1)},t.Inst=null,t}(e.UIBase);e.UI_Reconnect=t}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(e){function t(){var i=e.call(this,new ui.entrance.remindUI)||this;return i.process=null,i._created=!1,i._v=0,t.Inst=i,i}return __extends(t,e),t.prototype.onCreate=function(){this.process=this.me.getChildByName("process"),this.process.text=this._v.toString()+"/10",this._created=!0},t.prototype.setprocess=function(e){this._v=e,this._created&&(this.process.text=e.toString()+"/10")},t.Inst=null,t}(e.UIBase);e.UI_Remind=t}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(){function t(e){var t=this;this.rounds=[],this.locking=!1,this.enable=!1,this.me=e,this.me.visible=!1,this.scrollview=this.me.scriptMap["capsui.CScrollView"],this.scrollview.init_scrollview(Laya.Handler.create(this,this.renderInfo,null,!1)),this.btn_up=this.me.getChildByName("up"),this.btn_down=this.me.getChildByName("down"),this.btn_up.clickHandler=Laya.Handler.create(this,function(){t.locking||t.scrollview.scrollDelta(-100)},null,!1),this.btn_down.clickHandler=Laya.Handler.create(this,function(){t.locking||t.scrollview.scrollDelta(100)},null,!1),this.scrollview.me.on("ratechange",this,function(){t.btn_up.visible=t.scrollview.rate>0,t.btn_down.visible=t.scrollview.need_scroll&&t.scrollview.rate<1}),this.enable=!1}return t.prototype.show=function(t){var i=this;this.enable=!0,this.locking=!0,this.me.visible=!0,this.scrollview.reset(),this.rounds=t;for(var n=0;n<t.length;n++){var a=this.caluH(t[n]);a,this.scrollview.addItem(1,a)}e.UIBase.anim_alpha_in(this.me,{y:30},120,0,Laya.Handler.create(this,function(){i.locking=!1})),this.btn_up.visible=!1,this.btn_down.visible=this.scrollview.need_scroll},t.prototype.close=function(){var t=this;this.enable=!1,this.locking=!0,e.UIBase.anim_alpha_out(this.me,{y:30},120,0,Laya.Handler.create(this,function(){t.locking=!1,t.me.visible=!1}))},t.prototype.caluH=function(e){var t=e.actions[e.actions.length-1];if("RecordNoTile"==t.name){for(var i=t.data,n=[],a=0;a<4;a++)n.push({old_score:i.scores[0].old_scores[a],delta:0});for(a=0;a<i.scores.length;a++)for(var r=0;r<4;r++)n[r].delta+=i.scores[a].delta_scores[r];for(var o=[],a=0;a<n.length;a++)n[a].delta>0&&o.push(a);return 120+(0==o.length?0:40*(o.length-1))}return"RecordLiuJu"==t.name?120:t.data.hules[0].zimo?120:180+40*(t.data.hules.length-1)},t.prototype.renderInfo=function(e){for(var t=this,i=e.index,n=e.container,a=this.rounds[i],o=0;o<a.actions.length;o++)if("RecordNewRound"==a.actions[o].name){n.getChildByName("chang").text=["东","南","西","北"][a.actions[o].data.chang%4],n.getChildByName("ju").text=(a.actions[o].data.ju+1).toString(),n.getChildByName("ben").text=a.actions[o].data.ben.toString();break}var s=a.actions[a.actions.length-1],h=s.data,l=n,c=n.getChildByName("line"),p=n.getChildByName("liuju"),u=n.getChildByName("win"),d=n.getChildByName("lose");if(c.visible=!1,p.visible=!1,u.visible=!1,d.visible=!1,"RecordNoTile"==s.name){for(var _=[],o=0;o<4;o++)_.push({old_score:h.scores[0].old_scores[o],delta:0});for(o=0;o<h.scores.length;o++)for(x=0;x<4;x++)_[x].delta+=h.scores[o].delta_scores[x];for(var m=[],o=0;o<_.length;o++)_[o].delta>0&&m.push(o);if(l.height=120+(0==m.length?0:40*(m.length-1)),h.liujumanguan){u.visible=!0;(g=u.getChildByName("info")).text="流满",g.color="#8d8fac";for(var f=u.getChildByName("player"),o=0;o<f.numChildren;o++){y=f.getChildAt(o);o<m.length?(y.visible=!0,y.getChildByName("name").text=view.DesktopMgr.Inst.getPlayerName(m[o]),y.getChildByName("point").text="+"+_[m[o]].delta.toString()):y.visible=!1}}else if(u.visible=!0,u.getChildByName("info").text="",p.visible=!0,p.text="荒牌流局",h.scores)for(var f=u.getChildByName("player"),o=0;o<f.numChildren;o++){y=f.getChildAt(o);o<m.length?(y.visible=!0,y.getChildByName("name").text=view.DesktopMgr.Inst.getPlayerName(m[o]),y.getChildByName("point").text="+"+_[m[o]].delta.toString()):y.visible=!1}}else if("RecordLiuJu"==s.name){p.visible=!0,p.text=["","九种九牌","四风连打","四杠散了","四家立直","三家和了"][h.type],l.height=120}else if(s.data.hules[0].zimo){u.visible=!0;(g=u.getChildByName("info")).text="自摸",g.color="#ea3694";for(var f=u.getChildByName("player"),o=0;o<f.numChildren;o++){y=f.getChildAt(o);if(0==o){y.visible=!0;v=h.hules[0].seat;y.getChildByName("name").text=view.DesktopMgr.Inst.getPlayerName(v);b=h.delta_scores[v];y.getChildByName("point").text="+"+b.toString()}else y.visible=!1}l.height=120}else{u.visible=!0;(g=u.getChildByName("info")).text="荣和",g.color="#ef3538";for(var f=u.getChildByName("player"),o=0;o<f.numChildren;o++){y=f.getChildAt(o);if(o<h.hules.length){y.visible=!0;v=h.hules[o].seat;y.getChildByName("name").text=view.DesktopMgr.Inst.getPlayerName(v);b=h.delta_scores[v];y.getChildByName("point").text="+"+b.toString()}else y.visible=!1}c.visible=!0,c.y=80+40*h.hules.length,d.visible=!0,d.y=83+40*h.hules.length;for(var g=d.getChildByName("info"),f=d.getChildByName("player"),o=0;o<f.numChildren;o++){var y=f.getChildAt(o);if(0==o){y.visible=!0;for(var v=0,x=0;x<h.delta_scores.length;x++)h.delta_scores[x]<h.delta_scores[v]&&(v=x);y.getChildByName("name").text=view.DesktopMgr.Inst.getPlayerName(v);var b=h.delta_scores[v];y.getChildByName("point").text=b.toString()}else y.visible=!1}l.height=180+40*(s.data.hules.length-1)}l.clickHandler=Laya.Handler.create(this,function(){t.locking||(r.Inst.jumpRound(i),t.close())},null,!1),n.getChildByName("bg").height=n.height-4},t}(),i=function(){function t(e){var t=this;this.locking=!1,this.enable=!1,this.have0=!1,this.me=e,this.me.visible=!1,this.scrollview=this.me.scriptMap["capsui.CScrollView"],this.scrollview.init_scrollview(Laya.Handler.create(this,this.renderInfo,null,!1)),this.btn_up=this.me.getChildByName("up"),this.btn_down=this.me.getChildByName("down"),this.btn_up.clickHandler=Laya.Handler.create(this,function(){t.locking||t.scrollview.scrollDelta(-100)},null,!1),this.btn_down.clickHandler=Laya.Handler.create(this,function(){t.locking||t.scrollview.scrollDelta(100)},null,!1),this.scrollview.me.on("ratechange",this,function(){t.btn_up.visible=t.scrollview.rate>0,t.btn_down.visible=t.scrollview.need_scroll&&t.scrollview.rate<1}),this.enable=!1}return t.prototype.show=function(t,i){var n=this;this.enable=!0,this.locking=!0,this.have0=i,this.me.visible=!0,this.scrollview.reset(),this.scrollview.addItem(t+(i?1:0)),e.UIBase.anim_alpha_in(this.me,{y:30},100,0,Laya.Handler.create(this,function(){n.locking=!1})),this.btn_up.visible=!1,this.btn_down.visible=this.scrollview.need_scroll},t.prototype.close=function(){var t=this;this.enable=!1,this.locking=!0,e.UIBase.anim_alpha_out(this.me,{y:30},100,0,Laya.Handler.create(this,function(){t.locking=!1,t.me.visible=!1}))},t.prototype.renderInfo=function(e){var t=this,i=e.index,n=e.container;n.getChildByName("num").text=(i+(this.have0?0:1)).toString(),n.clickHandler=Laya.Handler.create(this,function(){t.locking||(r.Inst.jumpXun(i+(t.have0?0:1)),t.close())},null,!1)},t}(),n=function(){function e(e){var t=this;this._show_hand=!1,this._show_paopai=!1,this.me=e,this._btn_out=this.me.getChildByName("btn_out"),this._btn_out.clickHandler=Laya.Handler.create(this,function(){t.switch()},null,!1),this.me.getChildByName("btn_shoupai").clickHandler=Laya.Handler.create(this,function(){t._show_hand=!t._show_hand,t._choosed_show_hand.visible=t._show_hand,view.DesktopMgr.Inst.onShowHandChange(t._show_hand)},null,!1),this._choosed_show_paopai=this.me.getChildByName("btn_paopai").getChildByName("choosed"),this.me.getChildByName("btn_paopai").clickHandler=Laya.Handler.create(this,function(){t._show_paopai=!t._show_paopai,t._choosed_show_paopai.visible=t._show_paopai,view.DesktopMgr.Inst.onShowPaopaiChange(t._show_paopai)},null,!1),this._choosed_show_hand=this.me.getChildByName("btn_shoupai").getChildByName("choosed"),this._choosed_show_paopai=this.me.getChildByName("btn_paopai").getChildByName("choosed")}return e.prototype.reset=function(){Laya.Tween.clearAll(this),this._show_hand=!0,this.me.x=-258,this._btn_out.disabled=!1,this._choosed_show_hand.visible=this._show_hand,this._show_paopai=!0,this._choosed_show_paopai.visible=this._show_paopai},e.prototype.switch=function(){var e=this,t=-258;this.me.x<-100&&(t=-5),this._btn_out.disabled=!0,Laya.Tween.to(this.me,{x:t},200,Laya.Ease.strongOut,Laya.Handler.create(this,function(){e._btn_out.disabled=!1}),0,!0,!0)},e}(),a=function(){function t(t){var i=this;this.tiles=[],this.container_input=null,this.tile_count=0,this.gray_filter=null,this.dora_filter=null,this.lidora_filter=null,this.noinfo=!0,this.locking=!1,this.enable=!1,this.me=t,this.root=t.getChildByName("root"),this.content=this.root.getChildByName("content"),this.content.vScrollBarSkin="";var n=this.content.getChildByName("tile_templete");n.visible=!1;for(var a=0;a<100;a++){var r=n.scriptMap["capsui.UICopy"].getNodeClone();r.visible=!1,this.tiles.push(r)}this.container_input=this.content.getChildByName("input"),this.gray_filter=new Laya.ColorFilter([.6,0,0,0,0,0,.6,0,0,0,0,0,.6,0,0,0,0,0,1,0]),this.dora_filter=new Laya.ColorFilter([.35,0,0,0,0,0,.77,0,0,0,0,0,1,0,0,0,0,0,1,0]),this.lidora_filter=new Laya.ColorFilter([1,0,0,0,0,0,.64,0,0,0,0,0,.44,0,0,0,0,0,1,0]),this.container_input.getChildByName("btn_what").clickHandler=Laya.Handler.create(this,function(){i.locking||e.UI_Info_MD5.Inst.show()},null,!1)}return t.prototype.setTiles=function(e){this.tile_count=Math.floor(e.length/2);for(var t="myres2/mjp/"+GameMgr.Inst.mjp_view+"/ui/",i=0;2*i+1<e.length;i++)this.tiles[i].skin=t+e.charAt(2*i)+e.charAt(2*i+1)+".png",this.tiles[i].visible=!0;for(i=this.tile_count;i<this.tiles.length;i++)this.tiles[i].visible=!1;this.noinfo=!1,this.container_input.getChildByName("txtinput").text=e},t.prototype.refresh=function(){this.me.visible&&(this.noinfo||this.setInfo())},t.prototype.setInfo=function(){if(!this.noinfo){var e=view.DesktopMgr.Inst.left_tile_count,t=view.DesktopMgr.Inst.dora.length,i=view.DesktopMgr.Inst.get_gang_count(),n=0;i>0&&(n=view.DesktopMgr.Inst.waiting_gang_deal_tile?i-1:i);var a=this.tile_count-n-14;a<0&&(a=0);for(var r=this.tiles[0].width,o=this.tiles[0].height+10,s=0;s<a;s++)this.tiles[s].x=s%12*r+5*Math.floor(s%12/4),this.tiles[s].y=Math.floor(s/12)*o,this.tiles[s].filters=a-s<=e?[]:[this.gray_filter];for(var h=Math.ceil(a/12)*o+20,s=a;s<this.tile_count;s++){var l=this.tiles[s];l.x=(s-a)%12*r,l.y=Math.floor((s-a)/12)*o+h,l.filters=[]}for(s=0;s<t;s++)this.tiles[this.tile_count-5-2*s].filters=[this.dora_filter],this.tiles[this.tile_count-6-2*s].filters=[this.lidora_filter];for(s=0;s<n;s++)this.tiles[this.tile_count-1-s].filters=[this.gray_filter];h+=Math.ceil((this.tile_count-a)/12)*o,this.container_input.y=h+80,this.content.refresh()}},t.prototype.setNoInfo=function(){this.noinfo=!0},t.prototype.show=function(){var t=this;this.locking||(this.noinfo?e.UIMgr.Inst.ShowErrorInfo("牌山信息无效"):(this.locking=!0,this.me.visible=!0,this.refresh(),e.UIBase.anim_alpha_in(this.me,{y:30},120,0,Laya.Handler.create(this,function(){t.locking=!1}))))},t.prototype.close=function(){var t=this;this.locking||(this.locking=!0,e.UIBase.anim_alpha_out(this.me,{y:30},120,0,Laya.Handler.create(this,function(){t.locking=!1,t.me.visible=!1})))},t}(),r=function(r){function o(){var e=r.call(this,new ui.mj.replayUI)||this;return e.label_chang=null,e.label_ju=null,e.label_xun=null,e.img_play=null,e.img_stop=null,e.btn_preround=null,e.btn_nextround=null,e.page_chang=null,e.page_xun=null,e.btn_change_score=null,e.paipuconfig=null,e.page_paishan=null,e.data=null,e.gameResult=null,e.rounds=[],e.round_index=0,e.action_index=0,e.locking_time=0,e._auto_play=!1,o.Inst=e,e}return __extends(o,r),Object.defineProperty(o.prototype,"auto_play",{get:function(){return this._auto_play},set:function(e){this._auto_play=e,this.img_play.visible=!e,this.img_stop.visible=e},enumerable:!0,configurable:!0}),o.prototype.onCreate=function(){var r=this,o=this.me.getChildByName("root").getChildByName("round");o.clickHandler=Laya.Handler.create(this,function(){r.page_chang.locking||(r.auto_play&&(r.auto_play=!1),r.page_xun.enable&&r.page_xun.close(),r.page_paishan.me.visible&&r.page_paishan.close(),r.page_chang.enable?r.page_chang.close():r.page_chang.show(r.rounds))},null,!1),this.label_chang=o.getChildByName("chang"),this.label_ju=o.getChildByName("ju");var s=this.me.getChildByName("root").getChildByName("turn");this.label_xun=s.getChildByName("xun"),s.clickHandler=Laya.Handler.create(this,function(){r.page_xun.locking||(r.auto_play&&(r.auto_play=!1),r.page_chang.enable&&r.page_chang.close(),r.page_paishan.me.visible&&r.page_paishan.close(),r.page_xun.enable?r.page_xun.close():r.page_xun.show(r.rounds[r.round_index].xun.length,0!=r.rounds[r.round_index].xun[0]))},null,!1),this.me.getChildByName("root").getChildByName("paishan").clickHandler=Laya.Handler.create(this,function(){r.page_paishan.locking||(r.auto_play&&(r.auto_play=!1),r.page_chang.enable&&r.page_chang.close(),r.page_xun.enable&&r.page_xun.close(),r.page_paishan.me.visible?r.page_paishan.close():r.page_paishan.show())},null,!1),this.page_chang=new t(this.me.getChildByName("info_chang")),this.page_xun=new i(this.me.getChildByName("info_xun")),this.page_paishan=new a(this.me.getChildByName("info_paishan")),this.me.getChildByName("root").getChildByName("play").clickHandler=Laya.Handler.create(this,function(){r.auto_play=!r.auto_play},null,!1),this.me.getChildByName("root").getChildByName("nextstep").clickHandler=Laya.Handler.create(this,function(){r.locking_time>Laya.timer.currTimer?r.auto_play&&(r.auto_play=!1):r.nextStep()},null,!1),this.me.getChildByName("root").getChildByName("prestep").clickHandler=Laya.Handler.create(this,function(){r.preStep()},null,!1),this.me.getChildByName("root").getChildByName("nextturn").clickHandler=Laya.Handler.create(this,function(){r.nextXun()},null,!1),this.me.getChildByName("root").getChildByName("preturn").clickHandler=Laya.Handler.create(this,function(){r.preXun()},null,!1),this.btn_preround=this.me.getChildByName("root").getChildByName("preround"),this.btn_preround.clickHandler=Laya.Handler.create(this,function(){r.preRound()},null,!1),this.btn_nextround=this.me.getChildByName("root").getChildByName("nextround"),this.btn_nextround.clickHandler=Laya.Handler.create(this,function(){r.nextRound()},null,!1),this.img_play=this.me.getChildByName("root").getChildByName("play").getChildByName("play"),this.img_stop=this.me.getChildByName("root").getChildByName("play").getChildByName("pause"),this.btn_change_score=this.me.getChildByName("btn_change_score"),this.btn_change_score.clickHandler=Laya.Handler.create(this,function(){e.UI_DesktopInfo.Inst.onBtnShowScoreDelta()},null,!1),this.paipuconfig=new n(this.me.getChildByName("config"))},o.prototype.onEnable=function(){this.paipuconfig.reset(),e.UI_ReplayWheel.Inst.enable=!0},o.prototype.onDisable=function(){e.UI_ReplayWheel.Inst.enable=!1},o.prototype._isRoundEnd=function(e){return"RecordNoTile"==e||"RecordLiuJu"==e||"RecordHule"==e},o.prototype.initData=function(e){this.data=e;var t=e.game,i=e.record,n=null,a=0;this.rounds=[];for(var r=0;r<t.records.length;r++){a+=t.records[r].length;var o=net.MessageWrapper.decodeMessage(t.records[r]),s=o.$type.name,h={name:s,data:o};null==n&&(n={xun:[],actions:[]}),n.actions.push(h),this._isRoundEnd(s)&&(this.pengding_xun(n),this.rounds.push(n),n=null)}null!=n&&app.Log.Error("最后一份牌谱没有结束"),this.gameResult=i,this.action_index=-1,this.round_index=-1,this.label_chang.text="东",this.label_ju.text="1",this.label_xun.text="0",this.auto_play=!1,app.Log.log("牌谱大小："+a+"B")},o.prototype.reset=function(){this.auto_play=!1,this.page_chang.enable&&this.page_chang.close(),this.page_xun.enable&&this.page_xun.close(),this.page_paishan.me.visible&&(this.page_paishan.me.visible=!1)},o.prototype.pengding_xun=function(e){e.xun=[];for(var t=view.DesktopMgr.Inst.seat,i=!1,n=0;n<e.actions.length;n++){var a=e.actions[n];"RecordNewRound"==a.name?a.data.ju==t&&(i=!0,e.xun.push(n)):"RecordDealTile"==a.name||"RecordChiPengGang"==a.name?a.data.seat==t&&(i||(i=!0,e.xun.push(n))):"RecordDiscardTile"==a.name&&(i=!1)}},o.prototype.get_currentxun=function(){var e=this.rounds[this.round_index];if(0==e.xun.length)return 1;for(var t=e.xun.length,i=0;i<e.xun.length;i++)if(this.action_index<e.xun[i]){t=i;break}return t<0&&(t=0),t},o.prototype.nextStep=function(t){if(void 0===t&&(t=!1),(t||!(this.locking_time>Laya.timer.currTimer))&&!(this.round_index>=this.rounds.length)){if(this.round_index<0||this.rounds[this.round_index].actions.length<=this.action_index+1){if(this.round_index++,this.action_index=0,this.round_index==this.rounds.length)return view.DesktopMgr.Inst.gameEndResult=this.gameResult.result,this.enable=!1,void e.UIMgr.Inst.ShowGameEnd()}else this.action_index++;this.btn_nextround.visible=this.rounds.length>1,this.btn_preround.visible=this.rounds.length>1,this.locking_time=Laya.timer.currTimer+this.doRecord(this.rounds[this.round_index].actions[this.action_index]),this._refreshBarshow()}},o.prototype._refreshBarshow=function(){var e="";switch(view.DesktopMgr.Inst.index_change%4){case 0:e+="东";break;case 1:e+="南";break;case 2:e+="西";break;case 3:e+="北"}this.label_chang.text=e,this.label_ju.text=(view.DesktopMgr.Inst.index_ju+1).toString(),this.label_xun.text=this.get_currentxun().toString()},o.prototype.doRecord=function(e){try{var t=0;switch(e.name){case"RecordNewRound":t=view.ActionNewRound.record(e.data)+(this._auto_play,0);break;case"RecordDiscardTile":t=view.ActionDiscardTile.record(e.data)+(this._auto_play?500:0);break;case"RecordDealTile":t=view.ActionDealTile.record(e.data)+(this._auto_play?500:0);break;case"RecordChiPengGang":t=view.ActionChiPengGang.record(e.data)+(this._auto_play?500:0);break;case"RecordAnGangAddGang":t=view.ActionAnGangAddGang.record(e.data)+(this._auto_play?500:0);break;case"RecordHule":t=view.ActionHule.record(e.data);break;case"RecordLiuJu":t=view.ActionLiuJu.record(e.data);break;case"RecordNoTile":t=view.ActionNoTile.record(e.data)}return"RecordNewRound"!=e.name&&"RecordDealTile"!=e.name||this.page_paishan.refresh(),t}catch(t){var i={};return i.error=t.message,i.stack=t.stack,i.method="ui_replay doRecord",i.name=e.name,i.data=e.data,GameMgr.Inst.onFatalError(i),1e6}},o.prototype.doFastRecord=function(e){try{switch(e.name){case"RecordNewRound":view.ActionNewRound.fastrecord(e.data);break;case"RecordDiscardTile":view.ActionDiscardTile.fastrecord(e.data);break;case"RecordDealTile":view.ActionDealTile.fastrecord(e.data);break;case"RecordChiPengGang":view.ActionChiPengGang.fastrecord(e.data);break;case"RecordAnGangAddGang":view.ActionAnGangAddGang.fastrecord(e.data);break;case"RecordHule":view.ActionHule.fastrecord(e.data);break;case"RecordLiuJu":view.ActionLiuJu.fastrecord(e.data);break;case"RecordNoTile":view.ActionNoTile.fastrecord(e.data)}"RecordNewRound"!=e.name&&"RecordDealTile"!=e.name||this.page_paishan.refresh()}catch(i){var t={};return t.error=i.message,t.stack=i.stack,t.method="ui_replay doRecord",t.name=e.name,t.data=e.data,GameMgr.Inst.onFatalError(t),1e6}return 0},o.prototype.update=function(){!this.auto_play||this.locking_time>Laya.timer.currTimer||this.round_index>=0&&this.round_index<this.rounds.length&&this.action_index+1<this.rounds[this.round_index].actions.length&&this.nextStep()},o.prototype.jumpToLastRoundXun=function(){if(this.locking_time>Laya.timer.currTimer)this.auto_play&&(this.auto_play=!1);else{this.round_index=(this.round_index-1+this.rounds.length)%this.rounds.length;var e=this.rounds[this.round_index],t=e.actions.length-3;t<1&&(t=1);for(var i=0;i<t;i++)this.doFastRecord(e.actions[i]);this.action_index=t-1,this.nextStep()}},o.prototype.nextXun=function(){if(this.locking_time>Laya.timer.currTimer)this.auto_play&&(this.auto_play=!1);else if(!(this.round_index>=this.rounds.length||this.round_index<0)){var e=this.rounds[this.round_index];if(this.action_index!=e.actions.length-1){var t=0;if(0==e.xun.length)t=e.actions.length-1;else if(e.xun[0]>this.action_index)t=e.xun[0];else{var i=this.get_currentxun();t=i==e.xun.length?e.actions.length-1:e.xun[i]}for(var n=this.action_index+1;n<t;n++)this.doFastRecord(e.actions[n]);this.action_index=t-1,this.nextStep()}}},o.prototype.preXun=function(){if(this.locking_time>Laya.timer.currTimer)this.auto_play&&(this.auto_play=!1);else if(!(this.round_index>=this.rounds.length||this.round_index<0)){var e=this.rounds[this.round_index];if(0!=this.action_index){var t=0;if(0==e.xun.length)t=0;else if(e.xun[0]>this.action_index)t=0;else{var i=this.get_currentxun()-1;t=0==i?0:e.xun[i-1]}for(var n=0;n<t;n++)this.doFastRecord(e.actions[n]);this.action_index=t-1,this.nextStep()}else this.jumpToLastRoundXun()}},o.prototype.preStep=function(){if(this.locking_time>Laya.timer.currTimer)this.auto_play&&(this.auto_play=!1);else if(!(this.round_index>=this.rounds.length||this.round_index<0)){var e=this.rounds[this.round_index];if(0!=this.action_index){for(var t=this.action_index-1,i=0;i<t;i++)this.doFastRecord(e.actions[i]);this.action_index=t-1,this.nextStep()}else this.jumpToLastRoundXun()}},o.prototype.nextRound=function(){this.page_xun.enable&&this.page_xun.close(),this.locking_time>Laya.timer.currTimer?this.auto_play&&(this.auto_play=!1):(this.round_index=(this.round_index+1)%this.rounds.length,this.action_index=-1,this.nextStep())},o.prototype.preRound=function(){this.page_xun.enable&&this.page_xun.close(),this.locking_time>Laya.timer.currTimer?this.auto_play&&(this.auto_play=!1):(this.round_index=(this.round_index-1+this.rounds.length)%this.rounds.length,this.action_index=-1,this.nextStep())},o.prototype.jumpRound=function(e){this.page_xun.enable&&this.page_xun.close(),this.locking_time>Laya.timer.currTimer?this.auto_play&&(this.auto_play=!1):e<0||e>=this.rounds.length||(this.round_index=e,this.action_index=-1,this.nextStep())},o.prototype.jumpXun=function(e){if(this.locking_time>Laya.timer.currTimer)this.auto_play&&(this.auto_play=!1);else if(!(this.round_index>=this.rounds.length||this.round_index<0)){var t=this.rounds[this.round_index],i=0;i=0==t.xun.length?0:0==e?0:t.xun[e-1];for(var n=0;n<i;n++)this.doFastRecord(t.actions[n]);this.action_index=i-1,this.nextStep()}},o.prototype.onWheelClick=function(){if(!this.page_chang.locking&&!this.page_xun.locking)return this.page_chang.enable||this.page_xun.enable?(this.page_chang.enable&&this.page_chang.close(),void(this.page_xun.enable&&this.page_xun.close())):void this.nextStep()},o.prototype.onChangeMainBody=function(){var e=this.round_index,t=this.action_index;if(this.initData(this.data),this.reset(),!(e>=this.rounds.length||e<0)){for(var i=this.rounds[e],n=t,a=0;a<=n;a++)this.doFastRecord(i.actions[a]);this.round_index=e,this.action_index=n,this._refreshBarshow()}},o.Inst=null,o}(e.UIBase);e.UI_Replay=r}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(t){function i(){var e=t.call(this,new ui.mj.replay_whellUI)||this;return i.Inst=e,e}return __extends(i,t),i.prototype.onCreate=function(){var t=0;this.me.getChildByName("wheel").on(Laya.Event.MOUSE_WHEEL,this,function(i){!function(i){if(!(Laya.timer.currTimer<t)){t=Laya.timer.currTimer+50;var n=i.delta;n>0?e.UI_Replay.Inst.preXun():n<0&&e.UI_Replay.Inst.nextXun()}}(i)}),this.me.getChildByName("wheel").on(Laya.Event.MOUSE_DOWN,this,function(t){e.UI_Replay.Inst.onWheelClick()})},i}(e.UIBase);e.UI_ReplayWheel=t}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(e){function t(){var i=e.call(this,new ui.common.rollnoticeUI)||this;return i.speed=.18,t.Inst=i,i}return __extends(t,e),t.init=function(){var e=this;app.NetAgent.sendReq2Lobby("Lobby","fetchRollingNotice",{},function(t,i){t||i.error||e.receiveInfo(i.notice)}),app.NetAgent.AddListener2Lobby("NotifyRollingNotice",Laya.Handler.create(this,function(t){e.receiveInfo(t.notice)},null,!1))},t.receiveInfo=function(e){this.current_notice=e,this.try2Show()},t.try2Show=function(){var e=this;null!=this.current_notice&&(1e3*this.current_notice.end_time<Laya.timer.currTimer+GameMgr.Inst.server_time_delta?this.current_notice=null:this.Inst.enable||this.Inst.show(this.current_notice.content,Laya.Handler.create(this,function(){e.current_notice&&Laya.timer.once(1e3*e.current_notice.repeat_interval,e,e.try2Show)})))},t.prototype.onCreate=function(){this.root=this.me.getChildByName("root"),this.panel=this.root.getChildByName("content"),this.label=this.panel.getChildByName("label"),Laya.timer.once(3e3,this,function(){t.init()})},t.prototype.show=function(e,t){this.label.text=e,this.complete=t,Laya.timer.clearAll(this),this.root.visible=!0,this.origin_x=this.panel.width+500*this.speed,this.target_x=-(500*this.speed+this.label.textField.textWidth),this.start_time=Laya.timer.currTimer,Laya.timer.frameLoop(1,this,this.__update,null,!0),this.enable=!0},t.prototype.close=function(){this.complete&&this.complete.run(),Laya.timer.clearAll(this),this.enable=!1},t.prototype.__update=function(){var e=Laya.timer.currTimer-this.start_time;e>=(this.origin_x-this.target_x)/this.speed?(this.root.visible=!1,this.close()):this.label.x=this.origin_x-this.speed*e},t.Inst=null,t.current_notice=null,t}(e.UIBase);e.UI_RollNotice=t}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(t){function i(){var e=t.call(this,new ui.both_ui.rulesUI)||this;return e.tabs=[],e.scrollview=null,e.tab_index=-1,e.locking=!1,e._blackmask=null,i.Inst=e,e}return __extends(i,t),i.prototype.onCreate=function(){var t=this;this.root=this.me.getChildByName("root");for(var i=this.root.getChildByName("tabs"),n=1;n<=8;n++){var a=i.getChildByName("tab_"+n);this.tabs.push({choosed:a.getChildByName("unchoose"),unchoosed:a.getChildByName("choosed"),ids:[]}),a.clickHandler=Laya.Handler.create(this,this._changeTab,[n-1],!1)}cfg.fandesc.fandesc.forEach(function(e){var i=e.tag-1;i>=0&&i<t.tabs.length&&t.tabs[i].ids.push(e.id)}),this.scrollview=this.root.getChildByName("fans").scriptMap["capsui.CScrollView"],this.scrollview.init_scrollview(Laya.Handler.create(this,function(e){t._showItem(e.index,e.container)},null,!1)),this._blackmask=new e.UI_BlackMask(this.me.getChildByName("bmask"),Laya.Handler.create(this,function(){return t.locking},null,!1),Laya.Handler.create(this,this.close,null,!1))},i.prototype._changeTab=function(e){if(e!=this.tab_index){this.tab_index=e;for(var t=0;t<this.tabs.length;t++)this.tabs[t].choosed.visible=t==e,this.tabs[t].unchoosed.visible=t!=e;this.scrollview.reset(),this.scrollview.addItem(this.tabs[e].ids.length)}},i.prototype._showItem=function(e,t){var i=cfg.fandesc.fandesc.get(this.tabs[this.tab_index].ids[e]);t.getChildByName("name").text=i.name,t.getChildByName("decs").text=i.desc,t.getChildByName("limit").text=i.desc2;for(var n=t.getChildByName("tiles"),a=i.case,r=0,o=0,s="myres2/mjp/"+game.GameUtility.get_common_view_res_name(game.ECommonView.mjp)+"/ui/",h=0;h<n.numChildren;h++){var l=n.getChildAt(h);if(r>=a.length)l.visible=!1;else{var c="";"b"==a[r]?(c="back",r++):(c=a[r]+a[r+1],r+=2),l.skin=s+c+".png",l.visible=!0,l.x=o,l.y=0,o+=l.width}for(;r<a.length&&"|"==a[r];)o+=20,r++}},i.prototype.show=function(){var t=this;this.locking=!0,this.enable=!0,this.tab_index=-1,this._changeTab(0),e.UIBase.anim_pop_out(this.root,Laya.Handler.create(this,function(){t.locking=!1}))},i.prototype.close=function(){var t=this;this.locking=!0,e.UIBase.anim_pop_hide(this.root,Laya.Handler.create(this,function(){t.locking=!1,t.enable=!1}))},i.Inst=null,i}(e.UIBase);e.UI_Rules=t}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(t){function i(){var e=t.call(this,new ui.mj.scorechangeUI)||this;return e.black_mask=null,e.viewplayers=[],e.container_arrow=null,e.btn_confirm=null,e.count_down=null,e.label_waitingother=null,e.change_num=[],i.Inst=e,e}return __extends(i,t),i.prototype.onCreate=function(){this.black_mask=this.me.getChildByName("black_mask");for(var t=0;t<4;t++){for(var i=this.me.getChildByName("player_"+t),n=[],a=0;a<7;a++)n.push(i.getChildByName("container_score").getChildByName(a.toString()));var r={txt_name:i.getChildByName("label_name"),txt_delta:i.getChildByName("label_delta"),container_head:i.getChildByName("head"),container:i,x:i.x,y:i.y,rank_x:i.getChildByName("rank").x,rank_y:i.getChildByName("rank").y,head:new e.UI_Head(i.getChildByName("head")),container_rank0:i.getChildByName("rank"),rank0:i.getChildByName("rank").getChildByName("val"),rank0_wei:i.getChildByName("rank").getChildAt(1),container_rank1:i.getChildByName("rank1"),rank1:i.getChildByName("rank1").getChildByName("val"),rank1_wei:i.getChildByName("rank").getChildAt(1),img_scores:n};this.viewplayers.push(r)}this.container_arrow=this.me.getChildByName("container_arrow"),this.btn_confirm=this.me.getChildByName("btn_confirm"),this.count_down=this.btn_confirm.getChildByName("countdown"),this.btn_confirm.clickHandler=Laya.Handler.create(this,this.onBtnConfirm,null,!1);this.container_arrow.getChildByName("nums");this.label_waitingother=this.me.getChildByName("waitingother")},i.prototype.show=function(e){var t=this;if(view.DesktopMgr.Inst.mode!=view.EMJMode.paipu){this.enable=!0,this.black_mask.alpha=0,Laya.Tween.to(this.black_mask,{alpha:.5},120);var i=[0,1,2,3];i=i.sort(function(t,i){return 100*(e[i].old_score-e[t].old_score)+t-i});var n=[0,1,2,3];n=n.sort(function(t,i){return 100*(e[i].old_score+e[i].delta-e[t].old_score-e[t].delta)+t-i});for(var a=!1,r=function(r){var s=o.viewplayers[(r-view.DesktopMgr.Inst.seat+4)%4],h=0,l=0;switch((r-view.DesktopMgr.Inst.seat+4)%4){case 0:l=-80;break;case 1:h=-80;break;case 2:l=80;break;case 3:h=80}s.container.x=s.x+h,s.container.y=s.y+l,s.container.alpha=0,Laya.Tween.to(s.container,{alpha:1,x:s.x,y:s.y},100,null,null,120);var c=view.DesktopMgr.Inst.player_datas[r],p=e[r];s.txt_name.text=c.nickname,s.head.id=c.avatar_id,o.setScore(s.img_scores,p.old_score);for(var u=0,d=0;d<i.length;d++)if(i[d]==r){u=d+1;break}for(var _=0,d=0;d<n.length;d++)if(n[d]==r){_=d+1;break}s.container_rank0.visible=!0,s.container_rank0.x=s.rank_x,s.container_rank0.y=s.rank_y,s.rank0.skin="myres/mjdesktop/s_"+u.toString()+".png",s.rank0_wei.skin="myres/mjdesktop/s_"+u.toString()+"_"+u.toString()+".png",s.container_rank0.alpha=1,s.txt_delta.visible=!1,0!=p.delta&&(a=!0,p.delta>0?(s.txt_delta.text="+"+p.delta,s.txt_delta.color="#64cf42"):(s.txt_delta.text=p.delta.toString(),s.txt_delta.color="#d61111"),s.txt_delta.visible=!0,s.txt_delta.alpha=0,Laya.Tween.to(s.txt_delta,{alpha:1},100,null,null,250)),s.container_rank1.visible=!1,Laya.timer.once(2500,o,function(){a&&(Laya.Tween.to(s.container_rank0,{x:s.rank_x-50,alpha:0},70,Laya.Ease.strongIn),Laya.timer.once(300+300*(4-_),t,function(){s.rank0.skin="myres/mjdesktop/s_"+_.toString()+".png",s.rank0_wei.skin="myres/mjdesktop/s_"+_.toString()+"_"+_.toString()+".png",Laya.Tween.to(s.container_rank0,{x:s.rank_x,alpha:1},70,Laya.Ease.strongIn),1==_?(view.AudioMgr.PlayAudio(218),Laya.timer.once(70,t,function(){s.container_rank1.visible=!0,s.rank1.skin="myres/mjdesktop/s_1.png",s.rank1_wei.skin="myres/mjdesktop/s_1_1.png",s.container_rank1.x=s.rank_x,s.container_rank1.y=s.rank_y,s.container_rank1.scaleX=s.container_rank1.scaleY=s.container_rank0.scaleX,s.container_rank1.alpha=1,Laya.Tween.to(s.container_rank1,{scaleX:1.7,scaleY:1.7,alpha:0},500,Laya.Ease.strongOut)})):view.AudioMgr.PlayAudio(219)}))})},o=this,s=0;s<4;s++)r(s);this.container_arrow.visible=!0;for(s=0;s<4;s++)for(var h=s+1;h<4;h++)this.container_arrow.getChildByName(s.toString()+h.toString()).visible=!1,this.container_arrow.getChildByName(h.toString()+s.toString()).visible=!1;if(Laya.timer.once(250,this,function(){t.change_num=[];for(var i=t.calu_line(e),n=0;n<i.length;n++){var a=(i[n].b-view.DesktopMgr.Inst.seat+4)%4,r=(i[n].a-view.DesktopMgr.Inst.seat+4)%4,o=a.toString()+r.toString(),s=t.container_arrow.getChildByName(o);s.alpha=0,s.visible=!0,Laya.Tween.to(s,{alpha:1},100)}}),a)for(var l=0,s=0;s<33;s++)Laya.timer.once(1200+30*s,this,function(){l%5==0&&view.AudioMgr.PlayAudio(222);for(var i=++l/33,n=0;n<4;n++)if(0!=e[n].delta){var a=(n-view.DesktopMgr.Inst.seat+4)%4,r=Math.ceil(e[n].delta*i);if(33!=l){var o=e[n].delta-r;t.viewplayers[a].txt_delta.text=o>0?"+"+o:o.toString()}else t.viewplayers[a].txt_delta.visible=!1;t.setScore(t.viewplayers[a].img_scores,e[n].old_score+r)}});this.btn_confirm.visible=!1,this.label_waitingother.visible=!1;var c=a?4500:1200;Laya.timer.once(c,this,function(){t.btn_confirm.visible=!0,t.btn_confirm.alpha=0,Laya.Tween.to(t.btn_confirm,{alpha:1},100);for(var i=[],n=0;n<e.length;n++)i.push(e[n].delta+e[n].old_score);if(view.DesktopMgr.Inst.setScores(i),view.DesktopMgr.Inst.mode==view.EMJMode.play){t.count_down.text="(3)";for(var a=function(e){Laya.timer.once(1e3*e,t,function(){t.btn_confirm.visible&&(t.count_down.text="("+(3-e).toString()+")")})},n=0;n<3;n++)a(n);Laya.timer.once(3e3,t,function(){t.btn_confirm.visible&&t.onBtnConfirm()})}})}else this.onBtnConfirm()},i.prototype.setScore=function(e,t){for(var i=t.toString(),n=0;n<e.length;n++)e[n].visible=!1;for(n=0;n<i.length&&n<e.length;n++){var a=e[n];a.visible=!0;var r=i.charAt(i.length-1-n);a.skin="-"==r?"myres/mjdesktop/ww_minus.png":"myres/mjdesktop/ww_"+r+".png"}},i.prototype.calu_line=function(e){for(var t=[],i=[],n=0;n<e.length;n++)i.push(e[n].delta);for(;;){for(var a=-1,r=-1,o=-1,n=0;n<4;n++){var s=-1,h=-1;i[l=n]>0&&(i[s=(l-1+i.length)%i.length]<0&&(h=Math.min(i[l],-i[s]))>o&&(o=h,a=l,r=s),i[s=(l+1)%i.length]<0&&(h=Math.min(i[l],-i[s]))>o&&(o=h,a=l,r=s))}if(!(o>0))break;t.push({a:a,b:r,score:o}),i[a]-=o,i[r]+=o}for(;;){for(var a=-1,r=-1,o=-1,n=0;n<4;n++){var l=n,s=-1,h=-1;i[l]>0&&i[s=(l+2)%i.length]<0&&(h=Math.min(i[l],-i[s]))>o&&(o=h,a=l,r=s)}if(!(o>0))break;t.push({a:a,b:r,score:o}),i[a]-=o,i[r]+=o}return t},i.prototype.onBtnConfirm=function(){var t=this;if(this.btn_confirm.visible=!1,view.DesktopMgr.Inst.mode==view.EMJMode.play)if(null!=view.DesktopMgr.Inst.gameEndResult)e.UIMgr.Inst.ShowGameEnd(),this.enable=!1;else{view.DesktopMgr.Inst.Reset(),Laya.timer.once(200,this,function(){app.NetAgent.sendReq2MJ("FastTest","confirmNewRound",{},function(e,t){})}),this.label_waitingother.visible=!0;var i=0;Laya.timer.loop(500,this,function(){for(var e="等待其他玩家确认",n=0;n<i;n++)e+=".";i=(i+1)%4,t.label_waitingother.text=e})}else if(view.DesktopMgr.Inst.mode==view.EMJMode.paipu)e.UI_Replay.Inst.nextStep(!0),this.enable=!1;else if(view.DesktopMgr.Inst.mode==view.EMJMode.live_broadcast){e.UI_Live_Broadcast.Inst.onScoreChangeConfirm(),this.label_waitingother.visible=!0;var n=0;Laya.timer.loop(500,this,function(){for(var e="等待其他玩家确认",i=0;i<n;i++)e+=".";n=(n+1)%4,t.label_waitingother.text=e})}},i.prototype.onDisable=function(){Laya.timer.clearAll(this)},i.Inst=null,i}(e.UIBase);e.UI_ScoreChange=t}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(t){function i(){var e=t.call(this,new ui.both_ui.secondconfirmUI)||this;return e.func_cancel=null,e.func_confirm=null,e.locking=!1,i.Inst=e,e}return __extends(i,t),i.prototype.onCreate=function(){var e=this;this.root=this.me.getChildByName("root"),this.root.getChildByName("btn_confirm").clickHandler=Laya.Handler.create(this,function(){e.locking||(e.close(),e.func_confirm&&e.func_confirm.run(),e.func_cancel=null,e.func_confirm=null)},null,!1),this.root.getChildByName("btn_cancel").clickHandler=Laya.Handler.create(this,function(){e.locking||(e.close(),e.func_cancel&&e.func_cancel.run(),e.func_cancel=null,e.func_confirm=null)},null,!1),this.root.getChildByName("btn_cancel").filters=[new Laya.ColorFilter([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0])],this.desc=this.root.getChildByName("desc"),this.locking=!1},i.prototype.show=function(t,i,n,a,r){var o=this;void 0===i&&(i=null),void 0===n&&(n=null),void 0===a&&(a=960),void 0===r&&(r=560),this.func_cancel=n,this.func_confirm=i,this.desc.text=t,this.root.x=a,this.root.y=r,this.root.getChildByName("btn_confirm").x=114,this.root.getChildByName("btn_cancel").x=339,this.root.getChildByName("btn_cancel").visible=!0,this.locking=!0,this.enable=!0,e.UIBase.anim_pop_out(this.root,Laya.Handler.create(this,function(){o.locking=!1}))},i.prototype.show_only_confirm=function(t,i,n,a){var r=this;void 0===i&&(i=null),void 0===n&&(n=960),void 0===a&&(a=560),this.func_confirm=i,this.desc.text=t,this.root.x=n,this.root.y=a,this.root.getChildByName("btn_confirm").x=226,this.root.getChildByName("btn_cancel").visible=!1,this.locking=!0,this.enable=!0,e.UIBase.anim_pop_out(this.root,Laya.Handler.create(this,function(){r.locking=!1}))},i.prototype.close=function(){var t=this;this.locking=!0,e.UIBase.anim_pop_hide(this.root,Laya.Handler.create(this,function(){t.locking=!1,t.enable=!1}))},i.Inst=null,i}(e.UIBase);e.UI_SecondConfirm=t}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(t){function i(){var e=t.call(this,new ui.common.shimingrenzhengUI)||this;return i.Inst=e,e}return __extends(i,t),i.prototype.onCreate=function(){var e=this;this.root=this.me.getChildByName("root"),this.input_name=this.root.getChildByName("input_name").getChildByName("txtinput"),this.input_id=this.root.getChildByName("input_id").getChildByName("txtinput"),this.root.getChildByName("btn").clickHandler=Laya.Handler.create(this,function(){e.locking||e.renzheng()},null,!1),this.root.getChildByName("btn_close").clickHandler=Laya.Handler.create(this,function(){e.locking||e.close()},null,!1)},i.prototype.show=function(){var t=this;this.locking=!0,this.enable=!0,e.UIBase.anim_pop_out(this.root,Laya.Handler.create(this,function(){t.locking=!1}))},i.prototype.close=function(){var t=this;this.locking=!0,e.UIBase.anim_pop_hide(this.root,Laya.Handler.create(this,function(){t.locking=!1,t.enable=!1}))},i.prototype.testid=function(e){if(!/^(([1][1-5])|([2][1-3])|([3][1-7])|([4][1-6])|([5][0-4])|([6][1-5])|([7][1])|([8][1-2]))\d{4}(([1][9]\d{2})|([2]\d{3}))(([0][1-9])|([1][0-2]))(([0][1-9])|([1-2][0-9])|([3][0-1]))\d{3}[0-9xX]$/.test(e))return{status:0,msg:"身份证号码不合规"};var t=e.substr(6,4),i=e.substr(10,2),n=e.substr(12,2),a=Date.parse(i+"-"+n+"-"+t),r=Date.now(),o=new Date(t,i,0).getDate();if(a>r||n>o)return{status:0,msg:"出生日期不合规"};for(var s=new Array(7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2),h=new Array("1","0","X","9","8","7","6","5","4","3","2"),l=e.split(""),c=0,p=0;p<17;p++)c+=parseInt(l[p])*s[p];return l[17].toUpperCase()!=h[c%11].toUpperCase()?{status:0,msg:"身份证校验码不合规"}:{status:1,msg:"校验通过"}},i.prototype.renzheng=function(){if(/^[\u4e00-\u9fa5]{2,8}$/.test(this.input_name.text)){1==this.testid(this.input_id.text).status?(i.renzhenged=!0,app.NetAgent.sendReq2Lobby("Lobby","updateIDCardInfo",{fullname:this.input_name.text,card_no:this.input_id.text},function(){}),this.close(),e.UI_LightTips.Inst.show("认证成功")):e.UIMgr.Inst.ShowErrorInfo("身份证不合规")}else e.UIMgr.Inst.ShowErrorInfo("真实姓名填写有误")},i.renzhenged=!1,i}(e.UIBase);e.UI_ShiMingRenZheng=t}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(){function t(t){var i=this;this.me=t,this.root=this.me.getChildByName("root"),this.name=this.root.getChildByName("label_name"),this.desc=this.root.getChildByName("desc"),this.root.getChildByName("btn_close").clickHandler=Laya.Handler.create(this,function(){i.close()},null,!1),this.container_item=this.root.getChildByName("item"),this.buyed=this.container_item.getChildByName("buyed"),this.icon=new e.UI_Item_Skin(this.container_item.getChildByName("icon")),this.container_price=this.root.getChildByName("price"),this.btn_buy=this.root.getChildByName("btn_buy"),this.btn_buy.clickHandler=Laya.Handler.create(this,this.on_buy,null,!1)}return t.prototype.show=function(t,i,n){this.me.visible=!0,this.inzhp=t,e.UIBase.anim_pop_out(this.root,null),this.shop_item_id=i,this.buyed_count=n;var a;if(t)this.currency_icon=cfg.item_definition.currency.get(100002).icon,this.my_currency_num=GameMgr.Inst.account_data.gold,a=cfg.shops.zhp_goods.get(i);else{var r=(a=cfg.shops.goods.get(i)).currency;10==Math.floor(r/1e4)?this.currency_icon=cfg.item_definition.currency.get(r).icon:this.currency_icon=cfg.item_definition.item.get(r).icon_transparent,this.my_currency_num=e.UI_Bag.get_item_count(r)}var o=cfg.item_definition.item.get(a.item_id);this.name.text=o.name,this.desc.text=o.desc,this.icon.setSkin(a.icon),this.single_price=a.price,this.container_price.getChildByName("icon").skin=game.LoadMgr.getResImageSkin(this.currency_icon),this.refresh_cost(this.single_price);var s=a.buy_limit;null!=s&&s<0?(this.buyed.visible=!1,this.icon.me.filters=[],game.Tools.setGrayDisable(this.btn_buy,this.single_price>this.my_currency_num)):a.buy_limit<=n?(this.buyed.visible=!0,this.icon.me.filters=[new Laya.ColorFilter(e.DARK_FILTER)],game.Tools.setGrayDisable(this.btn_buy,!0)):(this.buyed.visible=!1,this.icon.me.filters=[],game.Tools.setGrayDisable(this.btn_buy,this.single_price>this.my_currency_num))},t.prototype.close=function(){var t=this;e.UIBase.anim_pop_hide(this.root,Laya.Handler.create(this,function(){t.me.visible=!1}))},t.prototype.refresh_cost=function(e){this.container_price.getChildByName("label0"),this.container_price.getChildByName("icon");var t=this.container_price.getChildByName("count");t.text=e.toString(),t.color=e<=this.my_currency_num?"#00ff00":"#ff0000",game.Tools.child_align_center(this.container_price,[10,5])},t.prototype.on_buy=function(){this.close(),game.Tools.setGrayDisable(this.btn_buy,!0),this.inzhp?n.Inst.want_to_buy_zhp(this.shop_item_id,1):n.Inst.want_to_buy_othershop(this.shop_item_id,1)},t}(),i=function(){function t(t){var i=this;this.mounthly=!1,this.me=t,this.root=this.me.getChildByName("root"),this.name=this.root.getChildByName("label_name"),this.desc=this.root.getChildByName("desc"),this.root.getChildByName("btn_close").clickHandler=Laya.Handler.create(this,function(){i.close()},null,!1),this.container_item=this.root.getChildByName("item"),this.buyed=this.container_item.getChildByName("buyed"),this.icon=new e.UI_Item_Skin(this.container_item.getChildByName("icon")),this.label_count=this.root.getChildByName("count"),this.container_danjia=this.root.getChildByName("danjia"),this.container_left_count=this.root.getChildByName("left"),this.label_refresh_info=this.root.getChildByName("refresh_info"),this.container_price=this.root.getChildByName("price"),this.btn_buy=this.root.getChildByName("btn_buy"),this.btn_buy.clickHandler=Laya.Handler.create(this,this.on_buy,null,!1);for(var n=["-10","-1","+1","+10"],a=function(e){var t=r.root.getChildByName(n[e]),a=t.getChildByName("s");a.alpha=0;var o=!1;t.on("mousedown",r,function(){a.alpha=0,o=!0,Laya.Tween.to(a,{alpha:1},50,null,null,0,!0,!0)}),t.on("mouseup",r,function(){if(Laya.Tween.to(a,{alpha:0},50,null,null,0,!0,!0),o)switch(e){case 0:i.on_num_change(-10);break;case 1:i.on_num_change(-1);break;case 2:i.on_num_change(1);break;case 3:i.on_num_change(10)}o=!1}),t.on("mouseout",r,function(){Laya.Tween.to(a,{alpha:0},50,null,null,0,!0,!0),o=!1})},r=this,o=0;o<n.length;o++)a(o)}return t.prototype.show=function(t,i,n){this.me.visible=!0,this.inzhp=t,this.buyed_count=n,this.shop_item_id=i,e.UIBase.anim_pop_out(this.root,null);var a;if(t)this.currency_icon=cfg.item_definition.currency.get(100002).icon,this.my_currency_num=GameMgr.Inst.account_data.gold,a=cfg.shops.zhp_goods.get(i),this.mounthly=!1;else{var r=(a=cfg.shops.goods.get(i)).currency;10==Math.floor(r/1e4)?this.currency_icon=cfg.item_definition.currency.get(r).icon:this.currency_icon=cfg.item_definition.item.get(r).icon_transparent,this.my_currency_num=e.UI_Bag.get_item_count(r),this.mounthly=4==a.category}this.shop_table=a,this.single_price=a.price,this.container_price.getChildByName("icon").skin=game.LoadMgr.getResImageSkin(this.currency_icon);var o=cfg.item_definition.item.get(a.item_id);this.name.text=o.name,this.desc.text=o.desc,this.icon.setSkin(a.icon),this.count=1,this.refresh(),this.label_refresh_info.visible=this.mounthly,null!=a.buy_limit&&a.buy_limit<0?(this.container_left_count.visible=!1,this.container_danjia.x=393):(this.container_left_count.visible=!0,this.container_danjia.x=300,this.container_left_count.getChildByName("count").text=(this.mounthly?"本月剩余:":"")+(a.buy_limit-n).toString()),this.container_danjia.getChildByName("icon").skin=game.LoadMgr.getResImageSkin(this.currency_icon),this.container_danjia.getChildByName("price").text=this.single_price.toString()},t.prototype.close=function(){var t=this;e.UIBase.anim_pop_hide(this.root,Laya.Handler.create(this,function(){t.me.visible=!1}))},t.prototype.on_buy=function(){this.close(),game.Tools.setGrayDisable(this.btn_buy,!0),this.inzhp?n.Inst.want_to_buy_zhp(this.shop_item_id,this.count):n.Inst.want_to_buy_othershop(this.shop_item_id,this.count)},t.prototype.on_num_change=function(e){this.count+=e,this.shop_table.buy_limit&&this.shop_table.buy_limit>=0&&this.count+this.buyed_count>this.shop_table.buy_limit&&(this.count=this.shop_table.buy_limit-this.buyed_count),this.count>=999&&(this.count=999),this.count<1&&(this.count=1),this.refresh()},t.prototype.refresh=function(){this.label_count.text=this.count.toString();var t=this.shop_table.buy_limit;null!=t&&t<0?(this.buyed.visible=!1,this.icon.me.filters=[],game.Tools.setGrayDisable(this.btn_buy,this.single_price*this.count>this.my_currency_num)):this.shop_table.buy_limit<=this.buyed_count?(this.buyed.visible=!0,this.icon.me.filters=[new Laya.ColorFilter(e.DARK_FILTER)],game.Tools.setGrayDisable(this.btn_buy,!0)):(this.buyed.visible=!1,this.icon.me.filters=[],game.Tools.setGrayDisable(this.btn_buy,this.single_price*this.count>this.my_currency_num)),this.refresh_cost(this.count*this.single_price)},t.prototype.refresh_cost=function(e){this.container_price.getChildByName("label0"),this.container_price.getChildByName("icon");var t=this.container_price.getChildByName("count");t.text=e.toString(),t.color=e<=this.my_currency_num?"#00ff00":"#ff0000",game.Tools.child_align_center(this.container_price,[10,5])},t}(),n=function(n){function a(){var e=n.call(this,new ui.lobby.shopUI)||this;return e.money=null,e.tabs=[],e.heads=[],e.currencys={},e.locking=!1,e.shop_index=-1,e.items=[],a.Inst=e,e}return __extends(a,n),a.init=function(){var t=this;app.NetAgent.sendReq2Lobby("Lobby","fetchShopInfo",{},function(i,n){i||n.error?e.UIMgr.Inst.showNetReqError("fetchShopInfo",i,n):t.shopinfo=JSON.parse(JSON.stringify(n)).shop_info}),app.NetAgent.AddListener2Lobby("NotifyShopUpdate",Laya.Handler.create(this,function(e){t.shopinfo=e.shop_info,t.Inst&&t.Inst.enable&&t.Inst.refresh_info()},null,!1))},a.prototype.onCreate=function(){var n=this;this.container_top=this.me.getChildByName("top"),this.container_top.getChildByName("btn_back").clickHandler=Laya.Handler.create(this,function(){n.locking||n.close(Laya.Handler.create(n,function(){e.UI_Lobby.Inst.enable=!0}))},null,!1),this.money=new e.UI_Money(this.container_top,Laya.Handler.create(this,function(e){n.close(e)},null,!1),Laya.Handler.create(this,function(){return n.locking},null,!1)),this.container_content=this.me.getChildByName("content"),this.container_tab=this.container_content.getChildByName("tabs"),this.tabs=[];for(var a=function(e){var t=r.container_tab.getChildAt(e);r.tabs.push(t),t.clickHandler=Laya.Handler.create(r,function(){n.shop_index!=e&&n.change_tab(e)},null,!1)},r=this,o=0;o<this.container_tab.numChildren;o++)a(o);var s=this.container_content.getChildByName("right");this.scrollview=s.scriptMap["capsui.CScrollView"],this.scrollview.init_scrollview(Laya.Handler.create(this,this.render_item,null,!1),-1,4),this.buy_single=new t(this.me.getChildByName("pop_buy_single")),this.buy_multi=new i(this.me.getChildByName("pop_buy_multi")),this.heads=[];for(o=0;o<4;o++)this.heads.push(this.container_content.getChildByName("right").getChildByName("head"+o));this.heads[0].getChildByName("refresh").clickHandler=Laya.Handler.create(this,function(){n.locking||n.refresh_zhp()},null,!1),e.UI_Bag.add_item_listener(302002,Laya.Handler.create(this,function(){1==n.shop_index&&n.refresh_head_show()},null,!1)),e.UI_Bag.add_item_listener(302003,Laya.Handler.create(this,function(){2==n.shop_index&&n.refresh_head_show()},null,!1)),e.UI_Bag.add_item_listener(302004,Laya.Handler.create(this,function(){3==n.shop_index&&n.refresh_head_show()},null,!1))},a.prototype.show=function(){var t=this;this.enable=!0,this.locking=!0,game.Scene_Lobby.Inst.change_bg("indoor",!1),e.UIBase.anim_alpha_in(this.container_top,{y:-30},150),e.UIBase.anim_alpha_in(this.container_content,{y:30},150),this.refresh_info(),this.money.onEnable(),Laya.timer.once(150,this,function(){t.locking=!1})},a.prototype.close=function(t){var i=this;this.locking=!0,e.UIBase.anim_alpha_out(this.container_top,{y:-30},150),e.UIBase.anim_alpha_out(this.container_content,{y:30},150),Laya.timer.once(150,this,function(){i.locking=!1,i.enable=!1,t&&t.run()})},a.prototype.onDisable=function(){this.shop_index=-1},a.prototype.refresh_info=function(){this.buy_single.me.visible=!1,this.buy_multi.me.visible=!1,a.shopinfo?this.change_tab(0):this.change_tab(-1)},a.prototype.change_tab=function(e){var t=this;a.shopinfo||(e=-1),this.shop_index=e;for(h=0;h<this.tabs.length;h++)this.tabs[h].skin=e==h?"myres/shop/tab_choose.png":"myres/shop/tab_unchoose.png",this.tabs[h].getChildAt(0).color=e==h?"#d9b263":"#8cb65f";if(this.refresh_head_show(),this.items=[],this.scrollview.reset(),0==this.shop_index){var i=a.shopinfo.zhp;if(i){if(i.goods)for(h=0;h<i.goods.length;h++)this.items.push({shop_item_id:i.goods[h],buyed_count:0});if(i.buy_records)for(h=0;h<i.buy_records.length;h++)for(var n=i.buy_records[h],r=0;r<this.items.length;r++)this.items[r].shop_item_id==n.id&&(this.items[r].buyed_count=n.count)}}else if(1==this.shop_index||2==this.shop_index){cfg.shops.goods.forEach(function(e){e.category==t.shop_index&&t.items.push({shop_item_id:e.id,buyed_count:0})});if((s=a.shopinfo).buy_records)for(h=0;h<s.buy_records.length;h++)for(var n=s.buy_records[h],o=0;o<this.items.length;o++)this.items[o].shop_item_id==n.id&&(this.items[o].buyed_count=n.count)}else if(3==this.shop_index){cfg.shops.goods.forEach(function(e){4==e.category&&t.items.push({shop_item_id:e.id,buyed_count:0})}),cfg.shops.goods.forEach(function(e){3==e.category&&t.items.push({shop_item_id:e.id,buyed_count:0})});var s=a.shopinfo;if(s.buy_records)for(var h=0;h<s.buy_records.length;h++)for(var n=s.buy_records[h],l=0;l<this.items.length;l++)this.items[l].shop_item_id==n.id&&(this.items[l].buyed_count=n.count)}this.scrollview.addItem(this.items.length)},a.prototype.refresh_head_show=function(){for(var t=0;t<this.heads.length;t++)this.heads[t].visible=this.shop_index==t;if(0==this.shop_index){var i=a.shopinfo.zhp;if(i){var n=this.heads[0].getChildByName("refresh"),r=this.heads[0].getChildByName("noinfo"),o=this.heads[0].getChildByName("count");if(n.visible=!1,r.visible=!1,o.text="",i.free_refresh&&i.free_refresh.count<i.free_refresh.limit)n.visible=!0,n.getChildByName("pay").visible=!1,n.getChildByName("free").visible=!0,n.getChildByName("free").text="立即刷新",o.text="剩余免费刷新次数:"+(i.free_refresh.limit-i.free_refresh.count);else if(i.cost_refresh&&i.cost_refresh.count<i.cost_refresh.limit){var s=cfg.shops.zhp_refresh_price.get(i.cost_refresh.count+1);if(s){n.visible=!0,n.getChildByName("free").visible=!1;var h=n.getChildByName("pay");h.visible=!0;var l=h.getChildByName("count"),c=h.getChildByName("icon"),p=h.getChildByName("money");l.text="刷新",o.text="剩余刷新次数:"+(i.cost_refresh.limit-i.cost_refresh.count),c.skin=game.LoadMgr.getResImageSkin(cfg.item_definition.currency.get(100001).icon),p.text="×"+s.refresh_price.toString(),game.Tools.child_align_center(n.getChildByName("pay"),[10])}else r.visible=!0}else r.visible=!0}else this.heads[0].visible=!1}else if(this.shop_index>=1&&this.shop_index<=3){var u=void 0;switch(this.shop_index){case 1:u=302002;break;case 2:u=302003;break;case 3:u=302004}var d=this.heads[this.shop_index];this.currencys[this.shop_index]||(this.currencys[this.shop_index]=new e.UI_Item_Skin(d.getChildByName("icon"))),this.currencys[this.shop_index].setSkin(cfg.item_definition.item.get(u).icon_transparent),d.getChildByName("count").text="×"+e.UI_Bag.get_item_count(u).toString()}},a.prototype.render_item=function(t){var i=this,n=t.index,a=t.container,r=t.cache_data;r.skin||(r.skin=new e.UI_Item_Skin(a.getChildByName("btn").getChildByName("icon")));var o,s,h=this.items[n];if(0==this.shop_index)s=cfg.item_definition.currency.get(100002).icon,o=cfg.shops.zhp_goods.get(h.shop_item_id);else{var l=(o=cfg.shops.goods.get(h.shop_item_id)).currency;s=10==Math.floor(l/1e4)?cfg.item_definition.currency.get(l).icon:cfg.item_definition.item.get(l).icon_transparent}var c=a.getChildByName("btn");if(c.clickHandler=Laya.Handler.create(this,function(){o.need_amount?i.buy_multi.show(0==i.shop_index,h.shop_item_id,h.buyed_count):i.buy_single.show(0==i.shop_index,h.shop_item_id,h.buyed_count)},null,!1),c.getChildByName("label_name").text=o.name,r.skin.setSkin(o.icon),o.buy_limit>=0)if(4==o.category)if(h.buyed_count>=o.buy_limit)c.getChildByName("buyed").visible=!0,c.getChildByName("icon").filters=[new Laya.ColorFilter(e.DARK_FILTER)],c.getChildByName("btn_buy").filters=[new Laya.ColorFilter(e.GRAY_FILTER)],c.getChildByName("count").visible=!0,c.getChildByName("count").text="本月剩余:0";else{c.getChildByName("icon").filters=[],c.getChildByName("btn_buy").filters=[],c.getChildByName("buyed").visible=!1,c.getChildByName("count").visible=!0;p=o.buy_limit-h.buyed_count;c.getChildByName("count").text="本月剩余:"+p}else if(h.buyed_count>=o.buy_limit)c.getChildByName("icon").filters=[new Laya.ColorFilter(e.DARK_FILTER)],c.getChildByName("btn_buy").filters=[new Laya.ColorFilter(e.GRAY_FILTER)],c.getChildByName("buyed").visible=!0,c.getChildByName("count").visible=!1;else{c.getChildByName("icon").filters=[],c.getChildByName("btn_buy").filters=[],c.getChildByName("buyed").visible=!1,c.getChildByName("count").visible=!0;var p=o.buy_limit-h.buyed_count;c.getChildByName("count").text=p>1?p.toString():""}else c.getChildByName("icon").filters=[],c.getChildByName("btn_buy").filters=[],c.getChildByName("buyed").visible=!1,c.getChildByName("count").visible=!1;c.getChildByName("btn_buy").getChildByName("currency").skin=game.LoadMgr.getResImageSkin(s),c.getChildByName("btn_buy").getChildByName("label_gold").text=o.price,game.Tools.child_align_center(c.getChildByName("btn_buy"))},a.prototype.want_to_buy_zhp=function(t,i){var n=this;app.NetAgent.sendReq2Lobby("Lobby","buyFromZHP",{goods_id:t,count:i},function(r,o){if(r||o.error)e.UIMgr.Inst.showNetReqError("buyFromZHP",r,o);else{if(e.UI_LightTips.Inst.show("购买成功"),view.AudioMgr.PlayAudio(106),0==n.shop_index)for(l=0;l<n.items.length;l++)if(n.items[l].shop_item_id==t){n.items[l].buyed_count+=i,n.scrollview.wantToRefreshItem(l);break}var s=a.shopinfo.zhp;if(s){s.buy_records||(s.buy_records=[]);for(var h=!1,l=0;l<s.buy_records.length;l++)if(s.buy_records[l].id==t){s.buy_records[l].count+=i,h=!0;break}h||s.buy_records.push({id:t,count:i})}}})},a.prototype.want_to_buy_othershop=function(t,i){var n=this;app.NetAgent.sendReq2Lobby("Lobby","buyFromShop",{goods_id:t,count:i},function(r,o){if(r||o.error)e.UIMgr.Inst.showNetReqError("buyFromShop",r,o);else{if(view.AudioMgr.PlayAudio(106),0!=n.shop_index)for(l=0;l<n.items.length;l++)if(n.items[l].shop_item_id==t){n.items[l].buyed_count+=i,n.scrollview.wantToRefreshItem(l);break}a.shopinfo.buy_records||(a.shopinfo.buy_records=[]);for(var s=a.shopinfo.buy_records,h=!1,l=0;l<s.length;l++)if(s[l].id==t){s[l].count+=i,h=!0;break}h||s.push({id:t,count:i}),o.rewards&&o.rewards.length>0?game.Tools.showRewards(o,null):e.UI_LightTips.Inst.show("购买成功")}})},a.prototype.refresh_zhp=function(){var t=this;app.NetAgent.sendReq2Lobby("Lobby","refreshZHPShop",{},function(i,n){if(i||n.error)e.UIMgr.Inst.showNetReqError("refreshZHPShop",i,n);else{a.shopinfo.zhp=JSON.parse(JSON.stringify(n.zhp));a.shopinfo.zhp;0==t.shop_index&&t.change_tab(0)}})},a.Inst=null,a.shopinfo=null,a}(e.UIBase);e.UI_Shop=n}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(){function t(e,t){var i=this;this.scale=1,this.during_move=!1,this.mouse_start_x=0,this.mouse_start_y=0,this.me=e,this.container_illust=t,this.illust=this.container_illust.getChildByName("illust"),this.container_move=e.getChildByName("move"),this.container_move.on("mousedown",this,function(){i.during_move=!0,i.mouse_start_x=i.container_move.mouseX,i.mouse_start_y=i.container_move.mouseY}),this.container_move.on("mousemove",this,function(){i.during_move&&(i.move(i.container_move.mouseX-i.mouse_start_x,i.container_move.mouseY-i.mouse_start_y),i.mouse_start_x=i.container_move.mouseX,i.mouse_start_y=i.container_move.mouseY)}),this.container_move.on("mouseup",this,function(){i.during_move=!1}),this.container_move.on("mouseout",this,function(){i.during_move=!1}),this.btn_big=e.getChildByName("btn_big"),this.btn_big.clickHandler=Laya.Handler.create(this,function(){i.locking||i.bigger()},null,!1),this.btn_small=e.getChildByName("btn_small"),this.btn_small.clickHandler=Laya.Handler.create(this,function(){i.locking||i.smaller()},null,!1),this.btn_close=e.getChildByName("btn_close"),this.btn_close.clickHandler=Laya.Handler.create(this,function(){i.locking||i.close()},null,!1)}return t.prototype.show=function(t){var n=this;this.locking=!0,this.when_close=t,this.illust_start_x=this.illust.x,this.illust_start_y=this.illust.y,this.illust_center_x=this.illust.x+984-446,this.illust_center_y=this.illust.y+11-84,this.container_illust.getChildByName("container_name").visible=!1,this.container_illust.getChildByName("btn").visible=!1,i.Inst.stopsay(),this.scale=1,Laya.Tween.to(this.illust,{x:this.illust_center_x,y:this.illust_center_y},200),e.UIBase.anim_pop_out(this.btn_big,null),e.UIBase.anim_pop_out(this.btn_small,null),e.UIBase.anim_pop_out(this.btn_close,null),this.during_move=!1,Laya.timer.once(250,this,function(){n.locking=!1}),this.me.visible=!0},t.prototype.close=function(){var t=this;this.locking=!0,this.container_illust.getChildByName("container_name").visible=!0,this.container_illust.getChildByName("btn").visible=!0,Laya.Tween.to(this.illust,{x:this.illust_start_x,y:this.illust_start_y,scaleX:1,scaleY:1},200),e.UIBase.anim_pop_hide(this.btn_big,null),e.UIBase.anim_pop_hide(this.btn_small,null),e.UIBase.anim_pop_hide(this.btn_close,null),Laya.timer.once(250,this,function(){t.locking=!1,t.me.visible=!1,t.when_close.run()})},t.prototype.bigger=function(){1.1*this.scale>1.5||(this.scale*=1.1,Laya.Tween.to(this.illust,{scaleX:this.scale,scaleY:this.scale},100,null,null,0,!0,!0))},t.prototype.smaller=function(){this.scale/1.1<.5||(this.scale/=1.1,Laya.Tween.to(this.illust,{scaleX:this.scale,scaleY:this.scale},100,null,null,0,!0,!0))},t.prototype.move=function(e,t){var i=this.illust.x+e,n=this.illust.y+t;i<this.illust_center_x-600?i=this.illust_center_x-600:i>this.illust_center_x+600&&(i=this.illust_center_x+600),n<this.illust_center_y-1200?n=this.illust_center_y-1200:n>this.illust_center_y+800&&(n=this.illust_center_y+800),this.illust.x=i,this.illust.y=n},t}(),i=function(i){function n(){var e=i.call(this,new ui.lobby.susheUI)||this;return e.contianer_illust=null,e.illust=null,e.label_name=null,e.label_cv=null,e.container_page=null,e.container_look_illust=null,e.page_select_character=null,e.page_visit_character=null,e.origin_illust_x=0,e.chat_id=0,e.select_index=0,e.container_chat=null,e.sound_channel=null,e.chat_block=null,n.Inst=e,e}return __extends(n,i),n.init=function(t){var i=this;app.NetAgent.sendReq2Lobby("Lobby","fetchCharacterInfo",{},function(n,a){if(n||a.error)e.UIMgr.Inst.showNetReqError("fetchCharacterInfo",n,a);else{if(app.Log.log("fetchCharacterInfo: "+JSON.stringify(a)),(a=JSON.parse(JSON.stringify(a))).main_character_id&&a.characters){if(i.characters=[],a.characters)for(r=0;r<a.characters.length;r++)i.characters.push(a.characters[r]);if(i.skin_map={},a.skins)for(var r=0;r<a.skins.length;r++)i.skin_map[a.skins[r]]=1;i.main_character_id=a.main_character_id}else i.characters=[],i.characters.push({charid:200001,level:0,exp:0,views:[],skin:400101,is_upgraded:!1}),i.characters.push({charid:200002,level:0,exp:0,views:[],skin:400201,is_upgraded:!1}),i.skin_map[400101]=1,i.skin_map[400201]=1,i.main_character_id=200001;i.send_gift_count=0,i.send_gift_limit=0,a.send_gift_count&&(i.send_gift_count=a.send_gift_count),a.send_gift_limit&&(i.send_gift_limit=a.send_gift_limit),t.run()}})},n.on_data_updata=function(e){if(e.character){var t=JSON.parse(JSON.stringify(e.character));if(t.characters)for(var i=t.characters,n=0;n<i.length;n++)this.characters.push(i[n]);if(t.skins)for(var a=t.skins,n=0;n<a.length;n++)this.skin_map[a[n]]=1}},n.chara_owned=function(e){for(var t=0;t<this.characters.length;t++)if(this.characters[t].charid==e)return!0;return!1},n.skin_owned=function(e){return this.skin_map.hasOwnProperty(e.toString())},Object.defineProperty(n,"main_chara_info",{get:function(){for(var e=0;e<this.characters.length;e++)if(this.characters[e].charid==this.main_character_id)return this.characters[e];return null},enumerable:!0,configurable:!0}),n.prototype.onCreate=function(){var i=this;this.contianer_illust=this.me.getChildByName("illust"),this.illust=new e.UI_Character_Skin(this.contianer_illust.getChildByName("illust").getChildByName("illust")),this.container_chat=this.contianer_illust.getChildByName("chat"),this.chat_block=new e.UI_Character_Chat(this.container_chat),this.contianer_illust.getChildByName("btn").clickHandler=Laya.Handler.create(this,function(){i.page_visit_character.me.visible&&i.page_visit_character.cannot_click_say||(i.sound_channel?i.stopsay():i.say("lobby_normal"))},null,!1),this.label_name=this.contianer_illust.getChildByName("container_name").getChildByName("label_name"),this.label_cv=this.contianer_illust.getChildByName("container_name").getChildByName("label_CV"),this.origin_illust_x=this.contianer_illust.x,this.container_page=this.me.getChildByName("container_page"),this.page_select_character=new e.UI_Sushe_Select,this.container_page.addChild(this.page_select_character.me),this.page_visit_character=new e.UI_Sushe_Visit,this.container_page.addChild(this.page_visit_character.me),this.container_look_illust=new t(this.me.getChildByName("look_illust"),this.contianer_illust)},n.prototype.show=function(){GameMgr.Inst.BehavioralStatistics(15),game.Scene_Lobby.Inst.change_bg("indoor",!1),this.enable=!0,this.page_visit_character.me.visible=!1;for(var e=0,t=0;t<n.characters.length;t++)if(n.characters[t].charid==n.main_character_id){e=t;break}this.change_select(e),this.show_page_select(),this.container_look_illust.me.visible=!1},n.prototype.starup_back=function(){this.enable=!0,this.change_select(this.select_index),this.show_page_visit(!0)},n.prototype.go2Lobby=function(){this.close(Laya.Handler.create(this,function(){e.UIMgr.Inst.showLobby()}))},n.prototype.close=function(t){var i=this;e.UIBase.anim_alpha_out(this.contianer_illust,{x:-30},150,0),Laya.timer.once(150,this,function(){i.enable=!1,t.run()})},n.prototype.onDisable=function(){this.illust.clear(),this.stopsay()},n.prototype.show_page_select=function(){this.page_select_character.show(this.select_index)},n.prototype.show_page_visit=function(e){this.page_visit_character.show(n.characters[this.select_index],e)},n.prototype.change_select=function(t){this.select_index=t,this.illust.clear();var i=n.characters[t];this.label_name.text=cfg.item_definition.character.get(i.charid).name,this.label_cv.text="CV"+cfg.item_definition.character.get(i.charid).desc_cv,this.illust.setSkin(i.skin,"full"),Laya.Tween.clearAll(this.contianer_illust),this.contianer_illust.x=this.origin_illust_x,this.contianer_illust.alpha=1,e.UIBase.anim_alpha_in(this.contianer_illust,{x:-30},230),this.stopsay()},n.prototype.onChangeSkin=function(e){n.characters[this.select_index].skin=e,this.change_select(this.select_index),n.characters[this.select_index].charid==n.main_character_id&&(GameMgr.Inst.account_data.avatar_id=e),app.NetAgent.sendReq2Lobby("Lobby","changeCharacterSkin",{character_id:n.characters[this.select_index].charid,skin:e},function(e,t){})},n.prototype.say=function(e){var t=this,i=n.characters[this.select_index];this.chat_id++;var a=this.chat_id,r=view.AudioMgr.PlayCharactorSound(i,e,Laya.Handler.create(this,function(){Laya.timer.once(1e3,t,function(){a==t.chat_id&&t.stopsay()})}));r&&(this.chat_block.show(r.words),this.sound_channel=r.sound)},n.prototype.stopsay=function(){this.chat_block.close(!1),this.sound_channel&&(this.sound_channel.stop(),Laya.SoundManager.removeChannel(this.sound_channel),this.sound_channel=null)},n.prototype.to_look_illust=function(){var e=this;this.container_look_illust.show(Laya.Handler.create(this,function(){e.page_select_character.show(e.select_index)}))},n.characters=[],n.skin_map={},n.main_character_id=0,n.send_gift_count=0,n.send_gift_limit=0,n.Inst=null,n}(e.UIBase);e.UI_Sushe=i}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(t){function i(){var e=t.call(this,new ui.lobby.sushe_selectUI)||this;return e.container_top=null,e.container_heads=null,e.scrollview=null,e.btn_visit=null,e.btn_look=null,e.select_index=0,e.locking=!1,e}return __extends(i,t),i.prototype.onCreate=function(){var t=this;this.container_top=this.me.getChildByName("top"),this.container_heads=this.me.getChildByName("heads"),this.scrollview=this.container_heads.scriptMap["capsui.CScrollView"],this.scrollview.init_scrollview(new Laya.Handler(this,this.render_character_cell),-1,3),this.btn_visit=this.me.getChildByName("heads").getChildByName("btn_visit"),this.btn_visit.clickHandler=Laya.Handler.create(this,function(){t.locking||(t.close(),Laya.timer.once(150,t,function(){e.UI_Sushe.Inst.show_page_visit(!1)}))},null,!1),this.btn_look=this.me.getChildByName("btn_look"),this.btn_look.clickHandler=Laya.Handler.create(this,function(){t.locking||(t.close(),Laya.timer.once(150,t,function(){e.UI_Sushe.Inst.to_look_illust()}))},null,!1),this.container_top.getChildByName("btn_back").clickHandler=Laya.Handler.create(this,function(){t.locking||(t.close(),e.UI_Sushe.Inst.go2Lobby())},null,!1)},i.prototype.show=function(t){var i=this;this.enable=!0,this.locking=!0,e.UIBase.anim_alpha_in(this.container_top,{y:-30},200),e.UIBase.anim_alpha_in(this.container_heads,{x:30},200),e.UIBase.anim_alpha_in(this.btn_look,{x:-30},200),Laya.timer.once(200,this,function(){i.locking=!1}),this.select_index=t,this.scrollview.reset(),this.scrollview.addItem(e.UI_Sushe.characters.length)},i.prototype.close=function(){var t=this;this.locking=!0,e.UIBase.anim_alpha_out(this.container_top,{y:-30},150),e.UIBase.anim_alpha_out(this.container_heads,{x:30},150,0),e.UIBase.anim_alpha_out(this.btn_look,{x:-30},150),Laya.timer.once(150,this,function(){t.locking=!1,t.enable=!1})},i.prototype.onDisable=function(){for(var t=0;t<e.UI_Sushe.characters.length;t++)Laya.loader.clearTextureRes(cfg.item_definition.skin.get(e.UI_Sushe.characters[t].skin)+"/bighead.png")},i.prototype.render_character_cell=function(t){var i=this,n=t.index,a=t.container,r=t.cache_data;r.index=n,r.inited||(r.inited=!0,a.getChildByName("btn").clickHandler=new Laya.Handler(this,function(){i.onClickAtHead(r.index)}),r.skin=new e.UI_Character_Skin(a.getChildByName("btn").getChildByName("head")));var o=a.getChildByName("btn");o.getChildByName("choose").visible=n==this.select_index,r.skin.setSkin(e.UI_Sushe.characters[n].skin,"bighead"),o.getChildByName("using").visible=e.UI_Sushe.characters[n].charid==e.UI_Sushe.main_character_id,o.getChildByName("label_name").text=cfg.item_definition.character.find(e.UI_Sushe.characters[n].charid).name},i.prototype.onClickAtHead=function(t){if(this.select_index==t){if(e.UI_Sushe.characters[t].charid!=e.UI_Sushe.main_character_id){var i=e.UI_Sushe.main_character_id;e.UI_Sushe.main_character_id=e.UI_Sushe.characters[t].charid,app.NetAgent.sendReq2Lobby("Lobby","changeMainCharacter",{character_id:e.UI_Sushe.main_character_id},function(e,t){}),GameMgr.Inst.account_data.avatar_id=e.UI_Sushe.characters[t].skin;for(var n=0;n<e.UI_Sushe.characters.length;n++)e.UI_Sushe.characters[n].charid==i&&this.scrollview.wantToRefreshItem(n);this.scrollview.wantToRefreshItem(t)}}else{var a=this.select_index;this.select_index=t,this.scrollview.wantToRefreshItem(a),this.scrollview.wantToRefreshItem(t),e.UI_Sushe.Inst.change_select(t)}},i}(e.UIBase);e.UI_Sushe_Select=t}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(){function e(e){this.speed=.001,this.hearts=[],this.heart_masks=[],this.exp_limits=[],this.preframe_time=0,this.heart_count=5,this.during_change=!1,this.me=e,this.container_hearts=this.me.getChildByName("hearts");for(i=0;i<5;i++){var t=this.container_hearts.getChildAt(i);this.hearts.push(t),this.heart_masks.push(t.getChildByName("v").mask)}this.bg_hearts=this.me.getChildByName("bg_hearts"),this.exp_limits=[];for(var i=0;i<5;i++)this.exp_limits.push(cfg.level_definition.character.find(i+1).exp)}return e.prototype.show=function(e){Laya.timer.clearAll(this),e.is_upgraded?this.bg_hearts.skin="myres/sushe/heart_full.png":this.bg_hearts.skin="myres/sushe/heart_normal.png",this.current_level=e.level,this.current_exp_rate=e.exp/this.exp_limits[this.current_level],this.isupgrad=e.is_upgraded,this.refresh_heart(this.current_level,this.current_exp_rate,e.is_upgraded),this.during_change=!1,this.preframe_time=Laya.timer.currTimer,Laya.timer.frameLoop(1,this,this.update)},e.prototype.update=function(){var e=Laya.timer.currTimer-this.preframe_time;this.preframe_time=Laya.timer.currTimer,this.during_change&&(this.target_level!=this.current_level?(this.during_change=!1,this.current_level=this.target_level,this.current_exp_rate=this.target_exp_rate,this.refresh_heart(this.target_level,this.target_exp_rate,this.isupgrad)):(this.current_exp_rate+=e*this.speed,this.target_exp_rate<this.current_exp_rate?(this.during_change=!1,this.current_level=this.target_level,this.current_exp_rate=this.target_exp_rate,this.refresh_heart(this.target_level,this.target_exp_rate,this.isupgrad)):this.refresh_heart(this.target_level,this.current_exp_rate,this.isupgrad)))},e.prototype.refresh_heart=function(e,t,i){for(var n=0;n<this.heart_count;n++){var a=this.heart_masks[n];this.current_level>n?a.scaleY=1:this.current_level==n?a.scaleY=.82*t+.1:a.scaleY=0,this.hearts[n].getChildByName("v").getChildByName("h").skin=i?"myres/bothui/heart_gold.png":"myres/bothui/bf_heart.png"}},e.prototype.close=function(){Laya.timer.clearAll(this)},e.prototype.after_give=function(e,t){var i=this,n=e.exp/this.exp_limits[e.level],a=game.FrontEffect.Inst.create_ui_effect(this.hearts[this.current_level],t?"scene/effect_heartup_favor.lh":"scene/effect_heartup.lh",new Laya.Point(0,0),1);if(Laya.timer.once(2e3,null,function(){a.destory()}),e.level>this.current_level){this.target_level=this.current_level,this.target_exp_rate=1,this.during_change=!0;var r=(1-this.current_exp_rate)/this.speed;Laya.timer.once(r+200,this,function(){var e=game.FrontEffect.Inst.create_ui_effect(i.hearts[i.current_level],"scene/effect_heartlevelup.lh",new Laya.Point(0,0),1);Laya.timer.once(2e3,null,function(){e.destory()}),view.AudioMgr.PlayAudio(111)})}else e.level==this.current_level&&n>this.current_exp_rate?(this.target_level=e.level,this.target_exp_rate=n,this.during_change=!0):Laya.timer.once(500,this,function(){i.target_level=e.level,i.target_exp_rate=n,i.during_change=!0})},e}(),i=function(){function t(e,t,i){var n=this;this.items=[],this.tab_index=0,this.gift_choose_index=-1,this.content_inshow=!1,this.give_cd=0,this.sound_channel=null,this.content=e,this.block_exp=i,this.container_tabs=t,this.btn_gift=this.container_tabs.getChildByName("send"),this.btn_gift.clickHandler=Laya.Handler.create(this,function(){2!=n.tab_index&&n.change_tab(2)},null,!1),this.btn_qiyue=this.container_tabs.getChildByName("sign"),this.btn_qiyue.clickHandler=Laya.Handler.create(this,function(){1!=n.tab_index&&n.change_tab(1)},null,!1),this.scrollview=this.content.scriptMap["capsui.CScrollView"],this.scrollview.init_scrollview(Laya.Handler.create(this,this.render_item,null,!1),-1,4),this.container_qiyue=this.content.getChildByName("page_qiyue"),this.container_gift=this.content.getChildByName("page_gift"),this.content.getChildByName("btn_close").clickHandler=Laya.Handler.create(this,function(){n.change_tab(0)},null,!1)}return t.prototype.reset=function(){this.content.visible=!1,this.content_inshow=!1,this.tab_index=0,this.gift_choose_index=-1},t.prototype.show=function(e){this.reset(),this.chara_info=e,this.btn_gift.visible=e.level<5;var t=cfg.item_definition.character.get(e.charid);this.btn_qiyue.visible=!e.is_upgraded&&t.can_marry>0,game.Tools.child_align_center(this.container_tabs,[7]),this.change_tab(0)},t.prototype.change_tab=function(t){var i=this;if(this.items=[],this.scrollview.reset(),this.container_gift.visible=!1,this.container_qiyue.visible=!1,this.tab_index=t,1==t){this.btn_qiyue.getChildByName("chosen").visible=!0,this.btn_qiyue.getChildByName("label").color="#000000";for(var n=cfg.item_definition.character.get(this.chara_info.charid).star_5_material.split(","),a=!0,r=0;r<n.length;r++){var o=n[r].split("-"),s=parseInt(o[0]),h=parseInt(o[1]),c=e.UI_Bag.get_item_count(s);h>c&&(a=!1),this.items.push({id:s,need:h,count:c})}if(this.container_qiyue.visible=!0,this.chara_info.level>=5){this.container_qiyue.getChildByName("nomet").visible=!1;var p=this.container_qiyue.getChildByName("container_tupo_btn"),u=p.getChildByName("send");u.clickHandler=Laya.Handler.create(this,this._tupo,null,!1),a?game.Tools.setGrayDisable(u,!1):game.Tools.setGrayDisable(u,!0),p.visible=!0}else this.container_qiyue.getChildByName("container_tupo_btn").visible=!1,this.container_qiyue.getChildByName("nomet").visible=!0}else this.btn_qiyue.getChildByName("chosen").visible=!1,this.btn_qiyue.getChildByName("label").color="#cfcdcc";if(2==t){this.btn_gift.getChildByName("chosen").visible=!0,this.btn_gift.getChildByName("label").color="#000000",this.items=e.UI_Bag.find_items_by_category(e.EItemCategory.gift),this.container_gift.visible=!0;this.container_gift.getChildByName("send").clickHandler=Laya.Handler.create(this,this._send_gift,null,!1),this.gift_choose_index=-1,this.refresh_gift_bottom_btns()}else this.btn_gift.getChildByName("chosen").visible=!1,this.btn_gift.getChildByName("label").color="#cfcdcc",this.sound_channel&&(this.sound_channel.stop(),Laya.SoundManager.removeChannel(this.sound_channel),this.sound_channel=null,l.Inst.closechat(!1));this.scrollview.addItem(this.items.length),1==t||2==t?this.content_inshow||(this.content_inshow=!0,this.content.visible=!0,Laya.Tween.clearAll(this.content),e.UIBase.anim_alpha_in(this.content,{y:-50},150,0,null,Laya.Ease.strongIn)):this.content_inshow&&(this.content_inshow=!1,Laya.Tween.clearAll(this.content),e.UIBase.anim_alpha_out(this.content,{y:-50},150,0,Laya.Handler.create(this,function(){i.content.visible=!1}),Laya.Ease.strongIn))},t.prototype.render_item=function(e){var t=e.index,i=e.container;2==this.tab_index?this.render_item_gift(t,i):1==this.tab_index&&this.render_item_qiyue(t,i)},t.prototype.render_item_qiyue=function(t,i){var n=this.items[t],a=cfg.item_definition.item.get(n.id);i.getChildByName("name").visible=!1;var r=i.getChildByName("counts");r.visible=!0,r.getChildByName("count_need").text="/"+n.need.toString();var o=r.getChildByName("count_have");o.text=n.count.toString(),o.color=n.count>=n.need?"#00ff00":"#ff0000",game.Tools.child_align_center(r);var s=i.getChildByName("btn");s.clickHandler=Laya.Handler.create(this,function(){e.UI_ItemDetail.Inst.show(n.id)},null,!1),s.getChildByName("choosed").visible=!1,game.LoadMgr.setImgSkin(s.getChildByName("icon"),a.icon),s.getChildByName("num").visible=!1},t.prototype.render_item_gift=function(t,i){var n=this,a=this.items[t].item_id,r=cfg.item_definition.item.get(a),o=i.getChildByName("name");o.text=r.name,o.visible=!0,i.getChildByName("counts").visible=!1;var s=i.getChildByName("btn"),h=s.getChildByName("choosed");h.visible=this.gift_choose_index==t,s.clickHandler=Laya.Handler.create(this,function(){if(n.gift_choose_index!=t){var i=n.gift_choose_index;n.gift_choose_index=t,h.visible=!0,i>=0&&i<n.items.length&&n.scrollview.wantToRefreshItem(i),n.refresh_gift_bottom_btns()}else e.UI_ItemDetail.Inst.show(a)},null,!1),game.LoadMgr.setImgSkin(s.getChildByName("icon"),r.icon);var l=s.getChildByName("num");this.items[t].count>1?(l.text=this.items[t].count.toString(),l.visible=!0):l.visible=!1},t.prototype.refresh_gift_bottom_btns=function(){var t=e.UI_Sushe.send_gift_limit-e.UI_Sushe.send_gift_count;t<0&&(t=0),this.container_gift.getChildByName("count").text=t.toString();var i=this.container_gift.getChildByName("send");game.Tools.setGrayDisable(i,0==t)},t.prototype._tupo=function(){var t=this,i=this.container_qiyue.getChildByName("container_tupo_btn").getChildByName("send");game.Tools.setGrayDisable(i,!0),app.NetAgent.sendReq2Lobby("Lobby","upgradeCharacter",{character_id:this.chara_info.charid},function(n,a){n||a.error?(e.UIMgr.Inst.showNetReqError("upgradeCharacter",n,a),game.Tools.setGrayDisable(i,!1)):(l.Inst.close(),Laya.timer.once(150,t,function(){t.chara_info.is_upgraded=!0,e.UI_Character_star_up.Inst.show(t.chara_info,Laya.Handler.create(t,function(){e.UI_Sushe.Inst.starup_back()}))}))})},t.prototype.close_audio=function(){this.sound_channel&&(this.sound_channel.stop(),Laya.SoundManager.removeChannel(this.sound_channel),this.sound_channel=null,l.Inst.closechat(!1))},t.prototype._send_gift=function(){var t=this;if(!(this.gift_choose_index<0||this.gift_choose_index>=this.items.length||Laya.timer.currTimer<this.give_cd)){this.give_cd=Laya.timer.currTimer+1e4;var i=this.container_gift.getChildByName("send");game.Tools.setGrayDisable(i,!0);var n=this.chara_info.charid,a=this.items[this.gift_choose_index].item_id;app.NetAgent.sendReq2Lobby("Lobby","sendGiftToCharacter",{character_id:n,gifts:[{item_id:a,count:1}]},function(r,o){if(r||o.error)game.Tools.setGrayDisable(i,!1),t.give_cd=0,e.UIMgr.Inst.showNetReqError("sendGiftToCharacter",r,o);else{if(app.Log.log("sendGiftToCharacter: "+JSON.stringify(o)),t.chara_info.charid==n){if(2==t.tab_index)for(_=0;_<t.items.length;_++)if(t.items[_].item_id==a){if(t.items[_].count<=1){for(var s=_;s<t.items.length-1;s++)t.items[s]=t.items[s+1];t.items.pop(),t.gift_choose_index=-1,t.scrollview.reset(),t.scrollview.addItem(t.items.length)}else t.items[_].count--,t.scrollview.wantToRefreshItem(_);break}var h=cfg.item_definition.item.get(a).type==cfg.item_definition.character.get(n).favorite;if(o.level>t.block_exp.current_level){l.Inst.locking=!0;var c=(1-t.block_exp.current_exp_rate)/t.block_exp.speed;t.block_exp.after_give(o,h),Laya.timer.once(c+600,t,function(){t.chara_info.level=o.level,t.chara_info.exp=o.exp,e.UI_Character_star_up.Inst.show(t.chara_info,Laya.Handler.create(t,function(){e.UI_Sushe.Inst.starup_back()})),Laya.timer.once(600,t,function(){l.Inst.close()}),t.give_cd=0});for(_=0;_<4;_++){var p=50*(_+1);Laya.timer.once(p+c+600,t,function(){t.sound_channel&&(t.sound_channel.volume*=.5)})}}else{if(t.block_exp.after_give(o,h),t.give_cd=0,game.Tools.setGrayDisable(i,!1),!t.sound_channel){var u="";u=cfg.item_definition.character.get(n).favorite==cfg.item_definition.item.get(a).type?"lobby_gift_favor":"lobby_gift";var d=view.AudioMgr.PlayCharactorSound(t.chara_info,u,Laya.Handler.create(t,function(){t.sound_channel=null,l.Inst.closechat(!1)}));l.Inst.chat(d.words),t.sound_channel=d.sound,e.UI_Sushe.Inst.stopsay()}t.chara_info.exp=o.exp}}else{for(var _=0;_<e.UI_Sushe.characters.length;_++)if(e.UI_Sushe.characters[_].charid==n){e.UI_Sushe.characters[_].level=o.level,e.UI_Sushe.characters[_].exp=o.exp;break}t.give_cd=0}e.UI_Sushe.send_gift_count++,t.refresh_gift_bottom_btns()}})}},t}(),n=function(){function n(n){var a=this;this.head=null,this.emos=[],this._scrollbar=null,this._scrollpoint=null,this._drag_scroll=!1,this.me=n,this.me.visible=!1,this.block_exp=new t(n.getChildByName("container_heart")),this.block_gift=new i(n.getChildByName("container_gift"),n.getChildByName("tabs"),this.block_exp),this.container_intro=n.getChildByName("intro"),this.content=this.container_intro.getChildByName("content"),this.content.vScrollBarSkin="",this.head=new e.UI_Character_Skin(this.container_intro.getChildByName("content").getChildByName("container_head").getChildByName("head"));var r=this.content.getChildByName("container_emj").getChildByName("container").getChildByName("emo_templete");r.visible=!1;for(var o=0;o<9;o++)this.emos.push(new e.UI_Character_Emo(r.scriptMap["capsui.UICopy"].getNodeClone())),this.emos[o].me.x=o%4*184,this.emos[o].me.y=184*Math.floor(o/4);this.content.getChildByName("container_emj").height=652,this.content.getChildByName("container_head").getChildByName("btn_skin").clickHandler=Laya.Handler.create(this,function(){l.Inst.open_skin(Laya.Handler.create(a,a.change_skin))},null,!1),this._scrollbar=this.container_intro.getChildByName("scrollbar"),this._scrollpoint=this._scrollbar.getChildByName("scrollpoint"),this._scrollbar&&(this._scrollbar.on("mousedown",this,function(){a._drag_scroll=!0;var e=a._scrollbar.mouseY/a._scrollbar.height;a.content.vScrollBar.value=a.content.vScrollBar.max*e}),this._scrollbar.on("mousemove",this,function(){if(a._drag_scroll){var e=a._scrollbar.mouseY/a._scrollbar.height;a.content.vScrollBar.value=a.content.vScrollBar.max*e}}),this._scrollbar.on("mouseup",this,function(){a._drag_scroll=!1}),this._scrollbar.on("mouseout",this,function(){a._drag_scroll=!1}),this.content.vScrollBar.on("change",this,function(){var e=a.content.vScrollBar.value/a.content.vScrollBar.max;a._scrollpoint.y=a._scrollbar.height*e}))}return n.prototype.show=function(e){var t=this.content.getChildByName("container_text"),i=cfg.item_definition.character.get(e.charid);t.getChildByName("height").text=i.desc_stature,t.getChildByName("birth").text=i.desc_birth,t.getChildByName("age").text=i.desc_age,t.getChildByName("bloodtype").text=i.desc_bloodtype,t.getChildByName("cv").text=i.desc_cv,t.getChildByName("hobby").text=i.desc_hobby,t.getChildByName("desc").text=i.desc,this.head.setSkin(e.skin,"smallhead");this.content.getChildByName("container_emj").y=t.getChildByName("desc").textField.textHeight+561-194;for(var n=0;n<this.emos.length;n++)this.emos[n].setSkin(e.charid,n),this.emos[n].me.getChildByName("lock").visible=!1;this.content.refresh(),this._drag_scroll=!1,this.block_exp.show(e),this.block_gift.show(e),this.me.visible=!0},n.prototype.change_skin=function(t){e.UI_Sushe.Inst.onChangeSkin(t),this.head.setSkin(t,"smallhead")},n.prototype.close=function(){this.me.visible=!1},n}(),a=function(){function e(e){var t=this;this.solts=[1,2,3],this.solt_btns=[],this.chara_info=null,this.me=e,this.me.visible=!1;for(var i=function(e){var i=n.me.getChildByName("slot"+e);n.solt_btns.push(i),i.clickHandler=Laya.Handler.create(n,function(){l.Inst.pop_effect_choose(1+e,Laya.Handler.create(t,function(i){t.on_change_view(1+e,i)}))},null,!1)},n=this,a=0;a<3;a++)i(a)}return e.prototype.render_item=function(e){var t=this.solts[e],i=-1;if(this.chara_info.views)for(var n=0;n<this.chara_info.views.length;n++)if(this.chara_info.views[n].slot==t){i=this.chara_info.views[n].item_id;break}var a=this.solt_btns[e];-1==i||0==i?(a.getChildByName("icon").skin="myres/sushe/bf_frame_anime.png",a.getChildByName("plus").visible=!0,a.getChildByName("desc").text=cfg.str.str.get(411+e).desc):(game.LoadMgr.setImgSkin(a.getChildByName("icon"),cfg.item_definition.item.get(i).icon),a.getChildByName("plus").visible=!1,a.getChildByName("desc").text=cfg.item_definition.item.get(i).desc)},e.prototype.on_change_view=function(e,t){var i=!1;if(this.chara_info.views)for(n=0;n<this.chara_info.views.length;n++)if(this.chara_info.views[n].slot==e){i=!0,this.chara_info.views[n].item_id==t?(this.chara_info.views[n].item_id=0,t=0):this.chara_info.views[n].item_id=t;break}i||(this.chara_info.views||(this.chara_info.views=[]),this.chara_info.views.push({slot:e,item_id:t})),app.NetAgent.sendReq2Lobby("Lobby","changeCharacterView",{character_id:this.chara_info.charid,slot:e,item_id:t},function(e,t){});for(var n=0;n<this.solts.length;n++)this.render_item(n)},e.prototype.show=function(e){this.chara_info=e;for(var t=0;t<3;t++)this.render_item(t);this.me.visible=!0},e.prototype.close=function(){this.me.visible=!1},e}(),r=function(){function t(e){this.sounds=[],this.chara_info=null,this.current_play_index=-1,this.current_soundchannel=null,this.volume_fixed=0,this.me=e,this.me.visible=!1,this.scrollview=this.me.scriptMap["capsui.CScrollView"],this.scrollview.init_scrollview(Laya.Handler.create(this,this.render_item,null,!1))}return t.prototype.show=function(t){this.chara_info=t,this.sounds=[];for(var i=cfg.voice.sound.getGroup(cfg.item_definition.character.get(t.charid).sound),n=0;n<i.length;n++)this.sounds.push(i[n]);this.volume_fixed=cfg.item_definition.character.get(t.charid).sound_volume,this.scrollview.reset(),this.scrollview.addItem(this.sounds.length),this.me.visible=!0,view.AudioMgr.refresh_music_volume(!0),this.current_play_index=-1,e.UI_Sushe.Inst.stopsay()},t.prototype.close=function(){this.me.visible&&(this.me.visible=!1,view.AudioMgr.refresh_music_volume(!1),this.current_soundchannel&&(this.current_soundchannel.stop(),Laya.SoundManager.removeChannel(this.current_soundchannel),this.current_soundchannel=null,this.current_play_index=-1,l.Inst.closechat(!1)))},t.prototype.render_item=function(e){var t=this,i=e.index,n=e.container,a=this.sounds[i];n.getChildByName("desc").text=a.name;var r=n.getChildByName("btn_play"),o=r.getChildByName("img");o.skin=this.current_play_index==i?"myres/sushe/bf_pause.png":"myres/sushe/bf_play.png",r.clickHandler=Laya.Handler.create(this,function(){if(t.current_play_index==i)t.current_soundchannel&&(t.current_soundchannel.stop(),Laya.SoundManager.removeChannel(t.current_soundchannel),t.current_soundchannel=null),l.Inst.closechat(!1),o.skin="myres/sushe/bf_play.png",t.current_play_index=-1;else{var e=t.current_play_index;t.current_play_index=i,e>=0&&e<t.sounds.length&&t.scrollview.wantToRefreshItem(e),t.current_soundchannel&&(Laya.SoundManager.removeChannel(t.current_soundchannel),t.current_soundchannel.stop(),t.current_soundchannel=null),o.skin="myres/sushe/bf_pause.png",t.current_soundchannel=Laya.SoundManager.playSound(a.path+view.AudioMgr.suffix,1,new Laya.Handler(t,function(){if(t.current_soundchannel){t.current_soundchannel=null;var e=t.current_play_index;t.current_play_index=-1,e>=0&&e<t.sounds.length&&t.scrollview.wantToRefreshItem(e),l.Inst.closechat(!1)}})),t.current_soundchannel.volume=view.AudioMgr.soundMuted?0:view.AudioMgr.soundVolume*t.volume_fixed,l.Inst.chat(a.words)}},null,!1);var s=n.getChildByName("lock");this.chara_info.level>=a.level_limit?(s.visible=!1,r.visible=!0):(s.visible=!0,r.visible=!1,s.getChildByName("info").text="羁绊lv"+a.level_limit+"解锁")},t}(),o=function(){function t(e){var t=this;this.items=[],this.current_using_item_id=-1,this.me=e,this.root=e.getChildByName("root"),this.title=this.root.getChildByName("title"),this.root.getChildByName("btn_close").clickHandler=Laya.Handler.create(this,function(){t.close()},null,!1),this.scrollview=this.root.scriptMap["capsui.CScrollView"],this.scrollview.init_scrollview(Laya.Handler.create(this,this.render_item,null,!1),-1,3)}return t.prototype.show=function(t,i,n){this.me.visible=!0,this.root.scaleX=this.root.scaleY=1,e.UIBase.anim_pop_out(this.root,null),this.chara_info=t,this.slot_id=i,this.when_change=n,this.items=[];for(var a=e.UI_Bag.find_items_by_category(e.EItemCategory.character_view),r=0;r<a.length;r++){cfg.item_definition.item.get(a[r].item_id).type==i&&this.items.push(a[r].item_id)}if(this.current_using_item_id=-1,t.views)for(r=0;r<t.views.length;r++)if(t.views[r].slot==this.slot_id){this.current_using_item_id=t.views[r].item_id;break}switch(this.title.text="",i){case 1:this.title.text="立直棒";break;case 2:this.title.text="和牌特效";break;case 3:this.title.text="立直特效"}this.root.getChildByName("no_info").visible=0==this.items.length,this.scrollview.reset(),this.scrollview.addItem(this.items.length)},t.prototype.close=function(){var t=this;this.when_change=null,e.UIBase.anim_pop_hide(this.root,Laya.Handler.create(this,function(){t.me.visible=!1}))},t.prototype.render_item=function(t){var i=this,n=t.index,a=t.container,r=t.cache_data,o=a.getChildByName("btn");o.clickHandler=Laya.Handler.create(this,function(){i.when_change&&i.when_change.runWith(i.items[n]),i.close()},null,!1),r.icon||(r.icon=new e.UI_Item_Skin(o.getChildByName("icon"))),r.icon.setSkin(cfg.item_definition.item.get(this.items[n]).icon);a.getChildByName("using").visible=this.current_using_item_id==this.items[n]},t}(),s=function(){function t(e){var t=this;this.skins=[],this.me=e,this.root=e.getChildByName("root"),this.root.getChildByName("btn_close").clickHandler=Laya.Handler.create(this,function(){t.close()},null,!1),this.scrollview=this.root.scriptMap["capsui.CScrollView"],this.scrollview.init_scrollview(Laya.Handler.create(this,this.render_item,null,!1),-1,3)}return t.prototype.show=function(t,i){this.me.visible=!0,e.UIBase.anim_pop_out(this.root,null),this.chara_info=t,this.when_change=i,this.skins=[];var n=cfg.item_definition.character.get(t.charid);if(this.skins.push(n.init_skin),n.can_marry&&this.skins.push(n.full_fetter_skin),n.skin_lib)for(var a=0;a<n.skin_lib.length;a++)n.skin_lib[a]&&this.skins.push(n.skin_lib[a]);this.scrollview.reset(),this.scrollview.addItem(this.skins.length)},t.prototype.close=function(){var t=this;this.when_change=null,e.UIBase.anim_pop_hide(this.root,Laya.Handler.create(this,function(){t.me.visible=!1}))},t.prototype.render_item=function(t){var i=this,n=t.index,a=t.container,r=t.cache_data,o=a.getChildByName("btn");r.skin||(r.skin=new e.UI_Character_Skin(o.getChildByName("icon")));a.getChildByName("using").visible=this.skins[n]==this.chara_info.skin;var s=cfg.item_definition.skin.get(this.skins[n]);r.skin.setSkin(this.skins[n],"smallhead");var h=o.getChildByName("locked");e.UI_Sushe.skin_owned(this.skins[n])?(h.visible=!1,o.clickHandler=Laya.Handler.create(this,function(){i.skins[n]!=i.chara_info.skin&&i.when_change&&i.when_change.runWith(i.skins[n]),i.close()},null,!1)):(h.visible=!0,h.getChildByName("info").text=s.lock_tips,o.clickHandler=null)},t}(),h=function(){function e(e){var t=this;this.locking=!1,this.me=e,this.info=this.me.getChildByName("info"),this.me.on("mousedown",this,function(){t.locking||t.close()})}return e.prototype.show=function(e){var t=this;this.info.text=e,this.me.height=120+this.info.textField.textHeight,this.me.visible=!0,this.locking=!0,this.me.scaleY=0,Laya.timer.clearAll(this),Laya.Tween.to(this.me,{scaleY:1},150,null,Laya.Handler.create(this,function(){t.locking=!1})),Laya.timer.once(3e3,this,function(){t.close()})},e.prototype.close=function(){var e=this;this.locking=!0,Laya.timer.clearAll(this),Laya.Tween.to(this.me,{scaleY:0},150,null,Laya.Handler.create(this,function(){e.locking=!1,e.me.visible=!1}))},e}(),l=function(t){function i(){var e=t.call(this,new ui.lobby.visitUI)||this;return e.tabs=[],e.page_intro=null,e.page_effect=null,e.page_sound=null,e.block_chat=null,e.pop_effect=null,e.pop_skin=null,e.locking=!1,e.current_page=-1,e.chara_info=null,i.Inst=e,e}return __extends(i,t),Object.defineProperty(i.prototype,"cannot_click_say",{get:function(){return 1==this.current_page||null!=this.page_intro.block_gift.sound_channel},enumerable:!0,configurable:!0}),i.prototype.onCreate=function(){var t=this;this.container_top=this.me.getChildByName("top"),this.container_top.getChildByName("btn_back").clickHandler=Laya.Handler.create(this,function(){t.locking||t.back2select()},null,!1),this.container_right=this.me.getChildByName("right");for(var i=function(e){l.tabs.push(l.container_right.getChildByName("btn_page"+e)),l.tabs[e].clickHandler=Laya.Handler.create(l,function(){t.locking||t.current_page!=e&&t.change_page(e)},null,!1)},l=this,c=0;c<3;c++)i(c);this.page_intro=new n(this.container_right.getChildByName("page_intro")),this.page_effect=new a(this.container_right.getChildByName("effect")),this.page_sound=new r(this.container_right.getChildByName("sound")),this.block_chat=new e.UI_Character_Chat(this.me.getChildByName("chat")),this.block_chat.me.visible=!1,this.pop_effect=new o(this.me.getChildByName("pop_effect")),this.pop_skin=new s(this.me.getChildByName("pop_skin")),this.info_levelup=new h(this.me.getChildByName("levelup"))},i.prototype.show=function(t,i){var n=this;this.chara_info=t;for(var a=0;a<this.tabs.length;a++)this.tabs[a].skin="myres/sushe/bf_unchooesd.png";this.page_intro.close(),this.page_effect.close(),this.page_sound.close(),this.current_page=-1,this.change_page(0),this.block_chat.me.visible=!1,this.pop_effect.me.visible=!1,this.pop_skin.me.visible=!1,this.info_levelup.me.visible=!1,this.me.visible=!0,this.locking=!0,e.UIBase.anim_alpha_in(this.container_top,{y:-30},150),e.UIBase.anim_alpha_in(this.container_right,{x:30},150),e.UIBase.anim_alpha_in(this.block_chat.me,{y:30},150),Laya.timer.once(150,this,function(){n.locking=!1}),i&&Laya.timer.once(150,this,function(){n.chara_info.is_upgraded?n.info_levelup.show("获得了新的形象"):n.info_levelup.show(cfg.level_definition.character.get(n.chara_info.level).unlock_desc)})},i.prototype.close=function(){var t=this;this.locking=!0,e.UIBase.anim_alpha_out(this.container_top,{y:-30},150),e.UIBase.anim_alpha_out(this.container_right,{x:30},150),e.UIBase.anim_alpha_out(this.block_chat.me,{y:30},150),Laya.timer.once(150,this,function(){t.locking=!1,t.me.visible=!1,t.page_sound.me.visible&&t.page_sound.close(),t.page_intro.block_gift.close_audio()})},i.prototype.back2select=function(){this.close(),Laya.timer.once(150,this,function(){e.UI_Sushe.Inst.show_page_select()})},i.prototype.change_page=function(e){if(this.current_page>=0)switch(this.tabs[this.current_page].skin="myres/sushe/bf_unchooesd.png",this.current_page){case 0:this.page_intro.close();break;case 1:this.page_sound.close();break;case 2:this.page_effect.close()}if(this.current_page=e,this.current_page>=0)switch(this.tabs[this.current_page].skin="myres/sushe/bf_chosen.png",this.current_page){case 0:this.page_intro.show(this.chara_info);break;case 1:this.page_sound.show(this.chara_info);break;case 2:this.page_effect.show(this.chara_info)}},i.prototype.open_skin=function(e){this.pop_skin.show(this.chara_info,e)},i.prototype.pop_effect_choose=function(e,t){this.pop_effect.show(this.chara_info,e,t)},i.prototype.chat=function(e){this.block_chat.show(e)},i.prototype.closechat=function(e){this.block_chat.close(e)},i}(e.UIBase);e.UI_Sushe_Visit=l}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(){function t(t,i){var n=this;this.me=t,this.effect_root=i,this.btn_next=t.getChildByName("btn_next"),this.btn_next.clickHandler=Laya.Handler.create(this,this.close,[!1],!1),this.bg_sakura=t.getChildByName("bg_sakura"),this.container_item=t.getChildByName("item");var a=this.container_item.getChildByName("btn");a.clickHandler=Laya.Handler.create(this,function(){e.UI_ItemDetail.Inst.show(n.item_id)},null,!1),this.icon=new e.UI_Item_Skin(a.getChildByName("icon_origin")),this.label_count=this.icon.me.getChildByName("count"),this.label_name=this.container_item.getChildByName("name_origin")}return t.prototype.show=function(t,i){var n=this;this.item_id=t;var r=cfg.item_definition.item.get(t);this.icon.setSkin(r.icon),r.category==e.EItemCategory.common_view||r.category==e.EItemCategory.character_view?(this.bg_sakura.visible=!0,Laya.timer.once(250,this,function(){var e=game.FrontEffect.Inst.create_ui_effect(n.effect_root,"scene/effect_get_zhuangban.lh",new Laya.Point(0,0),1);Laya.timer.once(2e3,null,function(){e.destory()}),view.AudioMgr.PlayAudio(110)})):(this.bg_sakura.visible=!1,Laya.timer.once(250,this,function(){view.AudioMgr.PlayAudio(109)})),i>1?(this.label_count.visible=!0,this.label_count.text=i.toString()):this.label_count.visible=!1,this.label_name.text=r.name,this.me.visible=!0,this.me.alpha=1,this.me.y=574,a.Inst.me.WPin.play(0,!1),this.btn_next.visible=!1,Laya.timer.once(10/24*1e3+200,this,function(){n.btn_next.visible=!0,a.Inst.btn_pass.visible=!0,a.Inst.btn_pass.clickHandler=Laya.Handler.create(n,function(){a.Inst.btn_pass.visible=!1,n.close(!0)},null,!1)})},t.prototype.close=function(e){var t=this;a.Inst.btn_pass.visible=!1,this.btn_next.visible=!1,a.Inst.me.WPout.play(0,!1),Laya.timer.once(5/24*1e3+500,this,function(){t.me.visible=!1,e?a.Inst.show_result():a.Inst.show_next()})},t}(),i=function(){function t(t,i){this.me=t,this.effect_root=i,this.btn_next=this.me.getChildByName("btn_next"),this.btn_next.clickHandler=Laya.Handler.create(this,this.close,[!1],!1);var n=t.getChildByName("jianying");this.jianying_girl=n.getChildByName("jianying_girl"),this.jianying_boy=n.getChildByName("jianying_boy");var a=t.getChildByName("container_illust");this.illust=new e.UI_Character_Skin(a.getChildByName("illust")),this.label_name=a.getChildByName("label_name"),this.label_cv=a.getChildByName("label_cv"),this.chat=new e.UI_Character_Chat(a.getChildByName("chat"))}return t.prototype.close_sound=function(){this.sound_channel&&(this.sound_channel.stop(),Laya.SoundManager.removeChannel(this.sound_channel),this.sound_channel=null)},t.prototype.show=function(e){var t=this;this.character_id=e;var i=cfg.item_definition.character.get(e);this.illust.setSkin(i.init_skin,"full"),this.label_name.text=i.name,this.label_cv.text="cv:"+i.desc_cv,this.chat.close(!0),this.jianying_boy.visible=2==i.sex,this.jianying_girl.visible=1==i.sex,this.close_sound(),this.btn_next.visible=!1,this.illust.me.parent.alpha=1,this.illust.me.parent.y=-8,this.me.visible=!0,a.Inst.me.JSin.play(0,!1),Laya.timer.once(100/24*1e3,this,function(){t.effect=game.FrontEffect.Inst.create_ui_effect(t.effect_root,"scene/effect_get_character.lh",new Laya.Point(0,0),1),view.AudioMgr.PlayAudio(107)}),Laya.timer.once(6450,this,function(){var e="",n="",r=0;cfg.voice.sound.getGroup(i.sound).forEach(function(t){"lobby_selfintro"==t.type&&(e=t.path,n=t.words,r=t.time_length)}),""!=e&&(t.sound_channel=view.AudioMgr.PlaySound(e,i.sound_volume,Laya.Handler.create(t,function(){t.sound_channel=null}))),""!=n&&t.chat.show(n),t.btn_next.visible=!0,a.Inst.btn_pass.visible=!0,a.Inst.btn_pass.clickHandler=Laya.Handler.create(t,function(){a.Inst.btn_pass.visible=!1,t.close(!0)},null,!1)})},t.prototype.close=function(e){var t=this;a.Inst.btn_pass.visible=!1,this.btn_next.visible=!1,a.Inst.me.JSout.play(0,!1),this.chat.close(!1),this.close_sound(),Laya.timer.once(800,this,function(){t.me.visible=!1,t.illust.clear(),e?a.Inst.show_result():a.Inst.show_next()}),this.effect&&(this.effect.destory(),this.effect=null)},t}(),n=function(){function t(e){var t=this;this.effects=[],this.me=e;var i=e.getChildByName("tubiao");this.single_item=i.getChildByName("item1"),this.container10=i.getChildByName("container10"),this.btn_confirm=e.getChildByName("confirm"),this.btn_confirm.clickHandler=Laya.Handler.create(this,function(){t.close(),a.Inst.close()},null,!1)}return t.prototype.show=function(e){if(Laya.timer.clearAll(this),1==e.length)this.single_item.visible=!0,this.container10.visible=!1,this.render_item(e[0],this.single_item);else{this.single_item.visible=!1,this.container10.visible=!0;for(var t=0;t<this.container10.numChildren;t++){var i=this.container10.getChildAt(t);t<e.length?(i.visible=!0,this.render_item(e[t],i)):i.visible=!1}}this.me.visible=!0,a.Inst.me.XMJGin.play(0,!1)},t.prototype.close=function(){Laya.timer.clearAll(this),this.me.visible=!1;for(var e=0;e<this.effects.length;e++)this.effects[e].destory();this.effects=[]},t.prototype.render_item=function(t,i){var n=this,a=i.getChildByName("btn");a.clickHandler=Laya.Handler.create(this,function(){30==Math.floor(t.reward.id/1e4)&&e.UI_ItemDetail.Inst.show(t.reward.id)},null,!1);var r=a.getChildByName("icon_origin"),o=a.getChildByName("icon_final"),s=i.getChildByName("name_orgin"),h=i.getChildByName("name_final"),l=a.getChildByName("gold_bg");if(l.visible=!1,20==Math.floor(t.reward.id/1e4)){var c=cfg.item_definition.character.get(t.reward.id),p=cfg.item_definition.skin.get(c.init_skin);game.LoadMgr.setImgSkin(r,p.path+"/smallhead.png"),r.getChildByName("count").visible=!1,s.text=c.name,Laya.timer.once(10/24*1e3,this,function(){l.visible=!0,n.effects.push(game.FrontEffect.Inst.create_ui_effect(l,n.container10.visible?"scene/effect_item_shine.lh":"scene/effect_item_shine_big.lh",new Laya.Point(0,0),1,!0))})}else{u=cfg.item_definition.item.get(t.reward.id);game.LoadMgr.setImgSkin(r,u.icon);d=r.getChildByName("count");t.reward.count>1?(d.visible=!0,d.text=t.reward.count.toString()):d.visible=!1,s.text=u.name,l.visible=!1}if(t.replace){if(o.visible=!0,h.visible=!0,20==Math.floor(t.replace.id/1e4)){var c=cfg.item_definition.character.get(t.replace.id),p=cfg.item_definition.skin.get(c.init_skin);game.LoadMgr.setImgSkin(o,p.path+"/smallhead.png"),o.getChildByName("count").visible=!1,h.text=c.name}else{var u=cfg.item_definition.item.get(t.replace.id);game.LoadMgr.setImgSkin(o,u.icon);var d=o.getChildByName("count");t.replace.count>1?(d.visible=!0,d.text=t.replace.count.toString()):d.visible=!1,h.text=u.name}var _=Laya.timer.currTimer;r.alpha=s.alpha=1,o.alpha=h.alpha=0,Laya.timer.frameLoop(1,this,function(){var e=Laya.timer.currTimer-_;if((e-=2600*Math.floor(e/2600))<800)r.alpha=s.alpha=1,o.alpha=h.alpha=0;else if(e<1300){t=(e-800)/500;r.alpha=s.alpha=1-t,o.alpha=h.alpha=t}else if(e<2100)r.alpha=s.alpha=0,o.alpha=h.alpha=1;else{var t=(e-800-500-800)/500;r.alpha=s.alpha=t,o.alpha=h.alpha=1-t}})}else o.visible=!1,h.visible=!1,r.alpha=1,s.alpha=1},t}(),a=function(a){function r(){var e=a.call(this,new ui.lobby.tangfang1UI)||this;return r.Inst=e,e}return __extends(r,a),r.prototype.onCreate=function(){var e=this;this.btn_next=this.me.getChildByName("btn_next"),this.btn_next.clickHandler=Laya.Handler.create(this,function(){e.show_next()},null,!1),this.tf_wupin=new t(this.me.getChildByName("tanfang_wupin"),this.me.getChildByName("effect_wuping")),this.tf_juese=new i(this.me.getChildByName("tanfang_juese"),this.me.getChildByName("effect_juese")),this.btn_pass=this.me.getChildByName("btn_pass"),this.btn_pass.clickHandler=Laya.Handler.create(this,function(){e.show_result()},null,!1),this.final_result=new n(this.me.getChildByName("container_final_info")),this.left_tree=this.me.getChildByName("left_tree"),this.right_tree=this.me.getChildByName("right_tree"),this.container_liuxing=this.me.getChildByName("container_scene").getChildByName("liuxing"),this.container_jianying_sakura=this.me.getChildByName("tanfang_juese").getChildByName("jianying").getChildByName("scene_jianying_sakura")},r.prototype.show=function(e){var t=this;this.results=e;for(r=1;r<this.results.length;r++){var i=Math.floor(Math.random()*(r+1)),n=this.results[r];this.results[r]=this.results[i],this.results[i]=n}for(var a=!1,r=0;r<this.results.length;r++)if(20==Math.floor(this.results[r].reward.id/1e4)){a=!0;break}if(this.enable=!0,this.tf_wupin.me.visible=!1,this.tf_juese.me.visible=!1,this.final_result.me.visible=!1,this.left_tree.visible=!0,this.right_tree.visible=!0,this.btn_next.visible=!1,this.btn_pass.visible=!1,this.index=0,this.me.XMin_new.play(0,!1),Laya.timer.once(1250,this,function(){t.btn_next.visible=!0,t.btn_pass.visible=!0}),Laya.timer.once(20/24*1e3,this,function(){view.AudioMgr.PlayAudio(108)}),this.me.getChildByName("container_scene").getChildByName("light").visible=!1,Laya.timer.once(1200,this,function(){t.me.getChildByName("container_scene").getChildByName("light").visible=!0,t.me.light.play(0,!0)}),a&&Math.random()<.8){var o="scene/scene_tanfang_liuxing.ls";Laya.loader.create(o,Laya.Handler.create(this,function(){Laya.timer.once(1500,t,function(){t._scene_liuxing=Laya.loader.getRes(o),t.container_liuxing.addChild(t._scene_liuxing),t._scene_liuxing.visible=!0})}))}var s="scene/scene_jianying_sakura.ls";Laya.loader.create(s,Laya.Handler.create(this,function(){t._scene_jianying_sakura=Laya.loader.getRes(s),t.container_jianying_sakura.addChild(t._scene_jianying_sakura),t._scene_jianying_sakura.visible=!1}))},r.prototype.close=function(){this.enable=!1,e.UI_TanfangRoot.Inst.close(),this._scene_liuxing&&(this._scene_liuxing.destroy(!0),this._scene_liuxing=null),this._scene_jianying_sakura&&(this._scene_jianying_sakura.destroy(!0),this._scene_jianying_sakura=null),this.me.light.stop(),e.UI_Treasure.Inst.refresh_show()},r.prototype.show_next=function(){var e=this;this.btn_next.visible=!1,this.btn_pass.visible=!1,this.index<this.results.length?(20==Math.floor(this.results[this.index].reward.id/1e4)?(this.tf_juese.show(this.results[this.index].reward.id),Laya.timer.once(400,this,function(){e._scene_jianying_sakura&&(e._scene_jianying_sakura.visible=!0,Laya.timer.once(2500,e,function(){e._scene_jianying_sakura.visible=!1}))})):this.tf_wupin.show(this.results[this.index].reward.id,this.results[this.index].reward.count),this.index++):this.show_result()},r.prototype.show_result=function(){this.btn_next.visible=!1,this.btn_pass.visible=!1,this.index=this.results.length,this.final_result.show(this.results)},r}(e.UIBase);e.UI_Tanfang=a}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(t){function i(){var e=t.call(this,new ui.lobby.tanfang0UI)||this;return e.urls=["res/atlas/tanfang.atlas"],e.need_show_loading=!1,e.loadover=!1,e.waiting_to_show=!1,e.results=null,i.Inst=e,e}return __extends(i,t),i.prototype.onCreate=function(){this.loading=this.me.getChildByName("loading"),this.root=this.me.getChildByName("root")},i.prototype.beginload=function(){var t=this;this.loadover||Laya.loader.create(this.urls,Laya.Handler.create(this,function(){t.root.addChild((new e.UI_Tanfang).me),Laya.timer.frameOnce(8,t,function(){t.loadover=!0,t.waiting_to_show&&t.show_result()})}))},i.prototype.show=function(t,i,n){var a=this;this.loading.visible=!1,this.need_show_loading=!0,Laya.timer.clearAll(this),Laya.timer.once(500,this,function(){a.need_show_loading&&(a.loading.visible=!0)}),this.waiting_to_show=!1,app.NetAgent.sendReq2Lobby("Lobby","openChest",{chest_id:t,count:i,use_ticket:n},function(i,n){i||n.error?(e.UIMgr.Inst.showNetReqError("openChest",i,n),a.close()):(a.results=n.results,e.UI_Treasure.on_chest_count_change([{chest_id:t,total_open_count:n.total_open_count}]),a.loadover?a.show_result():a.waiting_to_show=!0)}),this.enable=!0},i.prototype.test=function(){var e=this;this.loading.visible=!1,this.need_show_loading=!0,Laya.timer.clearAll(this),Laya.timer.once(500,this,function(){e.need_show_loading&&(e.loading.visible=!0)}),this.waiting_to_show=!1,this._test10(),this.loadover?this.show_result():this.waiting_to_show=!0,Laya.timer.once(1e3,this,function(){e.beginload()}),this.enable=!0},i.prototype.close=function(){this.need_show_loading=!1,this.loading.visible=!1;for(var e=0;e<this.urls.length;e++)Laya.loader.clearTextureRes(this.urls[e].url);this.enable=!1,view.AudioMgr.PlayMusic("music/lobby.mp3")},i.prototype.show_result=function(){this.need_show_loading=!1,this.loading.visible=!1,e.UI_Tanfang.Inst.show(this.results),view.AudioMgr.StopMusic()},i.prototype._test10=function(){this.results=[{reward:{id:200001,count:1}},{reward:{id:200001,count:1},replace:{id:302002,count:75}},{reward:{id:200002,count:1}},{reward:{id:302007,count:3}},{reward:{id:302012,count:7}},{reward:{id:303041,count:10}},{reward:{id:305007,count:1}},{reward:{id:305002,count:1}},{reward:{id:305013,count:1}},{reward:{id:305017,count:1}}]},i.prototype._test1=function(){this.results=[{reward:{id:200001,count:1}}]},i}(e.UIBase);e.UI_TanfangRoot=t}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(e){function t(){var i=e.call(this,new ui.mj.tingpaiUI)||this;return i.container_tiles=null,i.root=null,i.items=[],i.bg=null,i.btn_show=null,i.state=-1,i.zhengting=!1,i.tingPaiDiscardInfos=[],i.tingPaiInfos=[],i.mousedowned=!1,t.Inst=i,i}return __extends(t,e),t.prototype.onCreate=function(){this.root=this.me.getChildByName("root"),this.container_tiles=this.root.getChildByName("container_tiles");for(var e=0;e<this.container_tiles.numChildren;e++){var t=this.container_tiles.getChildAt(e);this.items.push({container:t,tile:t,zhengting:t.getChildByName("flag_zhenting"),container_left:t.getChildByName("container_left"),count:t.getChildByName("container_left").getChildAt(0),noyi:t.getChildByName("noyi")}),this.items[e].container.visible=!1}this.bg={bg:this.root.getChildByName("bg0"),bound:this.root.getChildByName("bound"),mask:this.root.getChildByName("bg0").mask,right:this.root.getChildByName("bg0").getChildByName("right"),bar:this.root.getChildByName("bg0").getChildByName("bar")},this.btn_show=this.me.getChildByName("btn_show"),this.btn_show.on("mousedown",this,this._setMouseDown,[!0]),this.btn_show.on("mouseup",this,this._setMouseDown,[!1]),this.btn_show.on("mouseout",this,this._setMouseDown,[!1]),this.btn_show.visible=!1,this.reset()},t.prototype.reset=function(){this.root.visible=!1,this.btn_show.visible=!1,this.mousedowned=!1,this.zhengting=!1,this.state=-1,this.tingPaiDiscardInfos=[],this.tingPaiInfos=[]},t.prototype.setData0=function(e){if(view.DesktopMgr.bianjietishi)if(e.tingpais&&e.tingpais.length>0){this.btn_show.visible=1==e.tingpais.length,this.tingPaiDiscardInfos=[];for(var t=0;t<e.tingpais.length;t++){for(var i=[],n=0;n<e.tingpais[t].infos.length;n++)i.push({tile:mjcore.MJPai.Create(e.tingpais[t].infos[n].tile),haveyi:e.tingpais[t].infos[n].haveyi});this.tingPaiDiscardInfos.push({tile:mjcore.MJPai.Create(e.tingpais[t].tile),zhengting:e.tingpais[t].zhenting,infos:i})}this.state=0}else this.btn_show.visible=!1,this.state=-1},t.prototype.setData1=function(e){if(view.DesktopMgr.bianjietishi)if(e.tingpais&&e.tingpais.length>0){this.btn_show.visible=!0,this.tingPaiInfos=[];for(var t=0;t<e.tingpais.length;t++)this.tingPaiInfos.push({tile:mjcore.MJPai.Create(e.tingpais[t].tile),haveyi:e.tingpais[t].haveyi});this.state=1}else this.btn_show.visible=!1,this.state=-1},t.prototype._show=function(e,t){for(n=0;n<this.items.length;n++)this.items[n].container.visible=!1;e=e.sort(function(e,t){return mjcore.MJPai.Distance(e.tile,t.tile)});for(var i="myres2/mjp/"+GameMgr.Inst.mjp_view+"/ui/",n=0;n<e.length;n++){this.items[n].container.visible=!0,this.items[n].zhengting.visible=t,this.items[n].tile.skin=i+e[n].tile.toString()+".png",this.items[n].count.text=view.DesktopMgr.Inst.getPaiLeft(e[n].tile).toString()+"张",this.items[n].zhengting.visible=t,this.items[n].container.x=80+120*n,this.items[n].container.y=45;var a=e[n].haveyi;view.DesktopMgr.Inst.mainrole.during_liqi&&(a=!0),this.items[n].noyi.visible=!a,this.items[n].container_left.visible=a}var r=210+80*e.length+40*(e.length-1);this.bg.bg.width=r,this.bg.bound.width=r,this.bg.bar.width=r+80,this.bg.mask.width=r,this.bg.right.x=r-20,this.root.x=960-r/2,this.root.visible=!0},t.prototype.onChooseTile=function(e){if(0==this.state&&e&&this.tingPaiDiscardInfos){for(var t=-1,i=0;i<this.tingPaiDiscardInfos.length;i++)if(0==mjcore.MJPai.Distance(this.tingPaiDiscardInfos[i].tile,e)){t=i;break}-1==t?this.root.visible=!1:this._show(this.tingPaiDiscardInfos[t].infos,this.tingPaiDiscardInfos[t].zhengting)}else this.root.visible=!1},t.prototype._setMouseDown=function(e){app.Log.log("_setMouseDown "+e),this.mousedowned!=e&&(this.mousedowned=e,e?1==this.state&&this.tingPaiInfos&&this.tingPaiInfos.length>0?this._show(this.tingPaiInfos,this.zhengting):0==this.state&&this.tingPaiDiscardInfos&&1==this.tingPaiDiscardInfos.length?this._show(this.tingPaiDiscardInfos[0].infos,this.tingPaiDiscardInfos[0].zhengting):this.root.visible=!1:this.root.visible=!1)},t.prototype.setZhengting=function(e){this.zhengting=e},t.Inst=null,t}(e.UIBase);e.UI_TingPai=t}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(t){function i(){var e=t.call(this,new ui.lobby.titlebookUI)||this;return e._root=null,e._scrollview=null,e._blackmask=null,e._locking=!1,e._showindexs=[],i.Inst=e,e}return __extends(i,t),i.Init=function(){var t=this;app.NetAgent.sendReq2Lobby("Lobby","fetchTitleList",{},function(i,n){if(i||n.error)e.UIMgr.Inst.showNetReqError("fetchTitleList",i,n);else{t.owned_title=[];for(var a=0;a<n.title_list.length;a++)t.owned_title.push(n.title_list[a])}})},i.addTitle=function(e){for(var t=0;t<e.new_titles.length;t++)this.owned_title.push(e.new_titles[t])},i.prototype.onCreate=function(){var t=this;this._root=this.me.getChildByName("root"),this._blackmask=new e.UI_BlackMask(this.me.getChildByName("bmask"),Laya.Handler.create(this,function(){return t._locking},null,!1),Laya.Handler.create(this,this.close,null,!1)),this._scrollview=this._root.getChildByName("content").scriptMap["capsui.CScrollView"],this._scrollview.init_scrollview(Laya.Handler.create(this,function(e){t.setItemValue(e.index,e.container)},null,!1)),this._root.getChildByName("btn_close").clickHandler=Laya.Handler.create(this,function(){t._locking||(t._blackmask.hide(),t.close())},null,!1),this._noinfo=this._root.getChildByName("noinfo")},i.prototype.show=function(){var t=this;if(this._locking=!0,this.enable=!0,this._blackmask.show(),i.owned_title.length>0){this._showindexs=[];for(var n=0;n<i.owned_title.length;n++)this._showindexs.push(n);this._showindexs=this._showindexs.sort(function(e,t){var n=e,a=cfg.item_definition.title.get(i.owned_title[e]);a&&(n+=1e3*a.priority);var r=t,o=cfg.item_definition.title.get(i.owned_title[t]);return o&&(r+=1e3*o.priority),r-n}),this._scrollview.reset(),this._scrollview.addItem(i.owned_title.length),this._scrollview.me.visible=!0,this._noinfo.visible=!1}else this._noinfo.visible=!0,this._scrollview.me.visible=!1;e.UIBase.anim_pop_out(this._root,Laya.Handler.create(this,function(){t._locking=!1}))},i.prototype.close=function(){var t=this;this._locking=!0,e.UIBase.anim_pop_hide(this._root,Laya.Handler.create(this,function(){t._locking=!1,t.enable=!1}))},i.prototype.onDisable=function(){this._scrollview.reset()},i.prototype.setItemValue=function(e,t){var n=this;if(this.enable){var a=i.owned_title[this._showindexs[e]],r=cfg.item_definition.title.find(a);game.LoadMgr.setImgSkin(t.getChildByName("img_title"),r.icon),t.getChildByName("using").visible=a==GameMgr.Inst.account_data.title,t.getChildByName("desc").text=r.desc;t.getChildByName("btn").clickHandler=Laya.Handler.create(this,function(){a!=GameMgr.Inst.account_data.title?(n.changeTitle(e),t.getChildByName("using").visible=!0):(n.changeTitle(-1),t.getChildByName("using").visible=!1)},null,!1)}},i.prototype.changeTitle=function(t){var n=this,a=GameMgr.Inst.account_data.title,r=0;r=t>=0&&t<this._showindexs.length?i.owned_title[this._showindexs[t]]:600001,GameMgr.Inst.account_data.title=r;for(var o=-1,s=0;s<this._showindexs.length;s++)if(a==i.owned_title[this._showindexs[s]]){o=s;break}e.UI_Lobby.Inst.enable&&e.UI_Lobby.Inst.top.refresh(),e.UI_PlayerInfo.Inst.enable&&e.UI_PlayerInfo.Inst.refreshBaseInfo(),-1!=o&&this._scrollview.wantToRefreshItem(o),app.NetAgent.sendReq2Lobby("Lobby","useTitle",{title:600001==r?0:r},function(i,r){(i||r.error)&&(e.UIMgr.Inst.showNetReqError("useTitle",i,r),GameMgr.Inst.account_data.title=a,e.UI_Lobby.Inst.enable&&e.UI_Lobby.Inst.top.refresh(),e.UI_PlayerInfo.Inst.enable&&e.UI_PlayerInfo.Inst.refreshBaseInfo(),n.enable&&(t>=0&&t<n._showindexs.length&&n._scrollview.wantToRefreshItem(t),o>=0&&o<n._showindexs.length&&n._scrollview.wantToRefreshItem(o)))})},i.Inst=null,i.owned_title=[],i}(e.UIBase);e.UI_TitleBook=t}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(){function t(e){var t=this;this.me=e,this.root=e.getChildByName("root"),this.panel=this.root.getChildByName("content"),this.label_info=this.panel.getChildByName("info"),this.panel.vScrollBarSkin="",this.me.getChildByName("btn_close").clickHandler=Laya.Handler.create(this,function(){t.close()},null,!1)}return t.prototype.show=function(t){var i=cfg.chest.chest.get(t);this.label_info.text=i.desc,this.label_info.height=this.label_info.textField.textHeight,this.panel.refresh(),this.me.visible=!0,e.UIBase.anim_alpha_in(this.root,{y:30},150)},t.prototype.showinfo=function(t){this.label_info.text=t,this.label_info.height=this.label_info.textField.textHeight,this.panel.refresh(),this.me.visible=!0,e.UIBase.anim_alpha_in(this.root,{y:30},150)},t.prototype.close=function(){var t=this;e.UIBase.anim_alpha_out(this.root,{y:30},150,0,Laya.Handler.create(this,function(){t.me.visible=!1}))},t}(),i=function(){function t(e){var t=this;this.me=e,this.me.visible=!1,this.root=this.me.getChildByName("root"),this.name=this.root.getChildByName("label_name"),this.desc=this.root.getChildByName("desc"),this.root.getChildByName("btn_close").clickHandler=Laya.Handler.create(this,function(){t.close()},null,!1),this.container_item=this.root.getChildByName("item"),this.buyed=this.container_item.getChildByName("buyed"),this.icon=this.container_item.getChildByName("icon"),this.container_price=this.root.getChildByName("price"),this.btn_buy=this.root.getChildByName("btn_buy"),this.btn_buy.clickHandler=Laya.Handler.create(this,this.on_buy,null,!1)}return t.prototype.show=function(t,i,n){this.chest_shop_item_id=t,this.my_currency_num=n,this.me.visible=!0,e.UIBase.anim_pop_out(this.root,null);var a=cfg.chest.chest_shop.get(t);this.my_currency_num=n;var r=game.GameUtility.get_item_view(a.item_id);this.name.text=r.name,this.desc.text=r.desc,game.LoadMgr.setImgSkin(this.icon,a.icon),this.single_price=a.price,this.refresh_cost(this.single_price),i?(this.buyed.visible=!0,this.icon.filters=[new Laya.ColorFilter(e.DARK_FILTER)],game.Tools.setGrayDisable(this.btn_buy,!0)):(this.buyed.visible=!1,this.icon.filters=[],game.Tools.setGrayDisable(this.btn_buy,this.single_price>this.my_currency_num))},t.prototype.close=function(){var t=this;e.UIBase.anim_pop_hide(this.root,Laya.Handler.create(this,function(){t.me.visible=!1}))},t.prototype.refresh_cost=function(e){this.container_price.getChildByName("label0"),this.container_price.getChildByName("icon");var t=this.container_price.getChildByName("count");t.text=e.toString(),t.color=e<=this.my_currency_num?"#00ff00":"#ff0000",game.Tools.child_align_center(this.container_price,[10,5])},t.prototype.on_buy=function(){this.close(),game.Tools.setGrayDisable(this.btn_buy,!0);var t=this.chest_shop_item_id;app.NetAgent.sendReq2Lobby("Lobby","buyFromChestShop",{goods_id:this.chest_shop_item_id,count:1},function(i,n){if(i||n.error)e.UIMgr.Inst.showNetReqError("buyFromChestShop",i,n);else{var a=cfg.chest.chest_shop.get(t);e.UI_LightTips.Inst.show("购买"+a.name+"成功"),r.on_chest_count_change([{chest_id:n.chest_id,consume_count:n.consume_count}]),r.Inst.xy.want_refresh()}})},t}(),n=function(){function t(e){var t=this;this.me=e,this.me.visible=!1,this.root=this.me.getChildByName("root"),this.name=this.root.getChildByName("label_name"),this.desc=this.root.getChildByName("desc"),this.root.getChildByName("btn_close").clickHandler=Laya.Handler.create(this,function(){t.close()},null,!1),this.container_item=this.root.getChildByName("item"),this.buyed=this.container_item.getChildByName("buyed"),this.icon=this.container_item.getChildByName("icon"),this.label_count=this.root.getChildByName("count"),this.container_danjia=this.root.getChildByName("danjia"),this.container_left_count=this.root.getChildByName("left"),this.label_refresh_info=this.root.getChildByName("refresh_info"),this.container_price=this.root.getChildByName("price"),this.btn_buy=this.root.getChildByName("btn_buy"),this.btn_buy.clickHandler=Laya.Handler.create(this,this.on_buy,null,!1);for(var i=["-10","-1","+1","+10"],n=function(e){var n=a.root.getChildByName(i[e]),r=n.getChildByName("s");r.alpha=0;var o=!1;n.on("mousedown",a,function(){r.alpha=0,o=!0,Laya.Tween.to(r,{alpha:1},50,null,null,0,!0,!0)}),n.on("mouseup",a,function(){if(Laya.Tween.to(r,{alpha:0},50,null,null,0,!0,!0),o)switch(e){case 0:t.on_num_change(-10);break;case 1:t.on_num_change(-1);break;case 2:t.on_num_change(1);break;case 3:t.on_num_change(10)}o=!1}),n.on("mouseout",a,function(){Laya.Tween.to(r,{alpha:0},50,null,null,0,!0,!0),o=!1})},a=this,r=0;r<i.length;r++)n(r)}return t.prototype.show=function(t,i){this.chest_shop_item_id=t,this.my_currency_num=i,this.me.visible=!0,e.UIBase.anim_pop_out(this.root,null);var n=cfg.chest.chest_shop.get(t);this.single_price=n.price;var a=game.GameUtility.get_item_view(n.item_id);this.name.text=a.name,this.desc.text=a.desc,game.LoadMgr.setImgSkin(this.icon,n.icon),this.count=1,this.refresh(),this.label_refresh_info.visible=!1,this.container_left_count.visible=!1,this.container_danjia.x=393,this.container_danjia.getChildByName("price").text=this.single_price.toString()},t.prototype.close=function(){var t=this;e.UIBase.anim_pop_hide(this.root,Laya.Handler.create(this,function(){t.me.visible=!1}))},t.prototype.on_buy=function(){this.close(),game.Tools.setGrayDisable(this.btn_buy,!0);var t=this.chest_shop_item_id,i=this.count;app.NetAgent.sendReq2Lobby("Lobby","buyFromChestShop",{goods_id:this.chest_shop_item_id,count:this.count},function(n,a){if(n||a.error)e.UIMgr.Inst.showNetReqError("buyFromChestShop",n,a);else{var o=cfg.chest.chest_shop.get(t);e.UI_LightTips.Inst.show("购买"+o.name+"x"+i+"成功"),r.on_chest_count_change([{chest_id:a.chest_id,consume_count:a.consume_count}]),r.Inst.xy.want_refresh()}})},t.prototype.on_num_change=function(e){this.count+=e,this.count>=999&&(this.count=999),this.count<1&&(this.count=1),this.refresh()},t.prototype.refresh=function(){this.label_count.text=this.count.toString(),this.buyed.visible=!1,game.Tools.setGrayDisable(this.container_item,!1),game.Tools.setGrayDisable(this.btn_buy,this.single_price*this.count>this.my_currency_num),this.refresh_cost(this.count*this.single_price)},t.prototype.refresh_cost=function(e){this.container_price.getChildByName("label0"),this.container_price.getChildByName("icon");var t=this.container_price.getChildByName("count");t.text=e.toString(),t.color=e<=this.my_currency_num?"#00ff00":"#ff0000",game.Tools.child_align_center(this.container_price,[10,5])},t}(),a=function(){function t(e,t,a){var r=this;this.me=e,this.buy_single=new i(t),this.buy_multi=new n(a),this.label_count=e.getChildByName("count"),this.scrollview=this.me.scriptMap["capsui.CScrollView"],this.scrollview.init_scrollview(Laya.Handler.create(this,this.render_item,null,!1),-1,4),this.me.visible=!1,this.me.getChildByName("btn_close").clickHandler=Laya.Handler.create(this,function(){r.locking||r.close()},null,!1)}return t.prototype.show=function(e){var t=this;this.chest_id=e,this.locking=!0,this.me.visible=!0,this.me.alpha=0,Laya.Tween.to(this.me,{alpha:1},150,null,Laya.Handler.create(this,function(){t.locking=!1})),this.items=[],cfg.chest.chest_shop.forEach(function(i){i.chest_id==e&&t.items.push(i.id)}),this.refresh_currency(),this.scrollview.reset(),this.scrollview.addItem(this.items.length)},t.prototype.want_refresh=function(){this.scrollview.wantToRefreshAll()},t.prototype.close=function(){var e=this;this.locking=!0,Laya.Tween.to(this.me,{alpha:0},150,null,Laya.Handler.create(this,function(){e.locking=!1,e.me.visible=!1}))},t.prototype.render_item=function(t){var i=this,n=t.index,a=t.container,r=(t.cache_data,this.items[n]),o=cfg.chest.chest_shop.get(r),s=!1;game.GameUtility.get_id_type(o.item_id)==game.EIDType.character&&e.UI_Sushe.chara_owned(o.item_id)&&(s=!0);var h=a.getChildByName("btn");h.clickHandler=Laya.Handler.create(this,function(){o.need_amount?i.buy_multi.show(r,i.currency_count):i.buy_single.show(r,s,i.currency_count)},null,!1),h.getChildByName("label_name").text=o.name,game.LoadMgr.setImgSkin(a.getChildByName("btn").getChildByName("icon"),o.icon),s?(h.getChildByName("buyed").visible=!0,h.getChildByName("icon").filters=[new Laya.ColorFilter(e.DARK_FILTER)],h.getChildByName("btn_buy").filters=[new Laya.ColorFilter(e.GRAY_FILTER)]):(h.getChildByName("buyed").visible=!1,h.getChildByName("icon").filters=[],h.getChildByName("btn_buy").filters=[]),h.getChildByName("btn_buy").getChildByName("label_gold").text=o.price.toString(),game.Tools.child_align_center(h.getChildByName("btn_buy"))},t.prototype.refresh_currency=function(){this.currency_count=r.get_chest_currency(this.chest_id),this.label_count.text=this.currency_count.toString()},t}(),r=function(i){function n(){var e=i.call(this,new ui.lobby.treasureUI)||this;return n.Inst=e,e}return __extends(n,i),n.on_chest_count_change=function(e){for(var t=0;t<e.length;t++)this.chest_count[e[t].chest_id]||(this.chest_count[e[t].chest_id]={total:0,consume:0}),e[t].consume_count&&(this.chest_count[e[t].chest_id].consume=e[t].consume_count),e[t].total_open_count&&(this.chest_count[e[t].chest_id].total=e[t].total_open_count);this.Inst&&this.Inst.enable&&this.Inst.refresh_currency()},n.get_chest_currency=function(e){if(!this.chest_count[e])return 0;var t=this.chest_count[e].total-this.chest_count[e].consume;return t<0&&(t=0),t},n.prototype.onCreate=function(){var i=this;this.contianer_content=this.me.getChildByName("content"),this.img_head=this.contianer_content.getChildByName("head"),this.contianer_content.getChildByName("btn_xiangqing").clickHandler=Laya.Handler.create(this,function(){i.tips.show(1e3)},null,!1),this.container_top=this.me.getChildByName("top"),this.container_top.getChildByName("btn_back").clickHandler=Laya.Handler.create(this,function(){i.locking||i.close(Laya.Handler.create(i,function(){e.UI_Lobby.Inst.enable=!0}))},null,!1),this.money=new e.UI_Money(this.container_top,Laya.Handler.create(this,this.close,null,!1),Laya.Handler.create(this,function(){return i.locking},null,!1)),this.tips=new t(this.me.getChildByName("tips")),this.xy=new a(this.me.getChildByName("xy"),this.me.getChildByName("pop_buy_single"),this.me.getChildByName("pop_buy_multi"));var n=this.contianer_content.getChildByName("container_shop");this.label_currency=n.getChildByName("btn_shop").getChildByName("count"),n.getChildByName("btn_shop").clickHandler=Laya.Handler.create(this,function(){i.locking||i.xy.show(i.chest_id)},null,!1),n.getChildByName("btn_what").clickHandler=Laya.Handler.create(this,function(){i.tips.showinfo(cfg.str.str.get(55).desc)},null,!1),this.locking=!1},n.prototype.show=function(){var t=this;this.enable=!0,this.locking=!0,e.UIBase.anim_alpha_in(this.contianer_content,{y:30},150),e.UIBase.anim_alpha_in(this.container_top,{y:-30},150),this.tips.me.visible=!1,this.money.onEnable(),Laya.timer.once(150,this,function(){t.locking=!1}),this.refresh_show(),this.xy.me.visible=!1},n.prototype.refresh_show=function(){this.chest_id=1e3,this.label_currency.text=n.get_chest_currency(this.chest_id).toString();var t=cfg.chest.chest.get(1e3);game.LoadMgr.setImgSkin(this.img_head,t.img);var i=t.ticket_id,a=0;i&&(a=e.UI_Bag.get_item_count(i));var r=this.contianer_content.getChildByName("container1");if(a>=1){s=r.getChildByName("btn_tanfang").getChildByName("price");game.LoadMgr.setImgSkin(s.getChildByName("icon"),cfg.item_definition.item.get(i).icon_transparent),s.getChildByName("count").text="x1",game.Tools.child_align_center(s)}else{(s=r.getChildByName("btn_tanfang").getChildByName("price")).getChildByName("icon").skin=game.LoadMgr.getItemSkin(t.currency),s.getChildByName("count").text="x"+t.price,game.Tools.child_align_center(s)}r.getChildByName("btn_tanfang").clickHandler=Laya.Handler.create(this,function(){e.UI_TanfangRoot.Inst.show(1e3,1,a>=1)},null,!1);var o=this.contianer_content.getChildByName("container10");if(a>=10){s=o.getChildByName("btn_tanfang").getChildByName("price");game.LoadMgr.setImgSkin(s.getChildByName("icon"),cfg.item_definition.item.get(i).icon_transparent),s.getChildByName("count").text="x10",game.Tools.child_align_center(s)}else{var s;(s=o.getChildByName("btn_tanfang").getChildByName("price")).getChildByName("icon").skin=game.LoadMgr.getItemSkin(t.currency),s.getChildByName("count").text="x"+t.price10,game.Tools.child_align_center(s)}o.getChildByName("btn_tanfang").clickHandler=Laya.Handler.create(this,function(){e.UI_TanfangRoot.Inst.show(1e3,10,a>=10)},null,!1)},n.prototype.close=function(t){var i=this;this.locking=!0,e.UIBase.anim_alpha_out(this.contianer_content,{y:30},150),e.UIBase.anim_alpha_out(this.container_top,{y:-30},150),this.tips.me.visible=!1,Laya.timer.once(150,this,function(){i.locking=!1,i.enable=!1,t&&t.run()})},n.prototype.onDisable=function(){Laya.loader.clearTextureRes(this.img_head.skin),game.LoadMgr.clearImgSkin(this.img_head),this.img_head.skin=""},n.prototype.refresh_currency=function(){this.label_currency.text=n.get_chest_currency(this.chest_id).toString(),this.xy.me.visible&&this.xy.refresh_currency()},n.chest_count={},n}(e.UIBase);e.UI_Treasure=r}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(t){function i(){var e=t.call(this,new ui.common.user_xieyiUI)||this;e.current_index=0,i.Inst=e;for(var n=[],a=0;a<15;a++)n.push("user_xieyi/"+(a+1)+".txt");return Laya.loader.load(n),e}return __extends(i,t),i.prototype.onCreate=function(){var e=this;this.root=this.me.getChildByName("root"),this.info=this.root.getChildByName("info"),this.root.getChildByName("btn").clickHandler=Laya.Handler.create(this,function(){e.close()},null,!1),this.btn_left=this.root.getChildByName("left"),this.btn_left.clickHandler=Laya.Handler.create(this,function(){e.current_index<=1||(e.current_index--,e.refresh())},null,!1),this.btn_right=this.root.getChildByName("right"),this.btn_right.clickHandler=Laya.Handler.create(this,function(){e.current_index>=15||(e.current_index++,e.refresh())},null,!1)},i.prototype.show=function(t){this.complete=t,this.enable=!0,e.UIBase.anim_pop_out(this.root,null),this.current_index=1,this.refresh()},i.prototype.refresh=function(){var e=Laya.loader.getRes("user_xieyi/"+this.current_index+".txt");this.info.text=e||"此页还在加载中...",this.btn_left.visible=this.current_index>1,this.btn_right.visible=this.current_index<15},i.prototype.close=function(){var t=this;e.UIBase.anim_pop_hide(this.root,Laya.Handler.create(this,function(){t.enable=!1,t.info.text="",t.complete&&t.complete.run()}))},i.prototype.onDestroy=function(){i.Inst=null,this.info.textField.destroy(!0),this.info.destroy(!0)},i}(e.UIBase);e.UI_User_Xieyi=t}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(){function t(e){var t=this;this.friends=[],this.sortlist=[],this.me=e,this.me.visible=!1,this.blackbg=e.getChildByName("blackbg"),this.blackbg.clickHandler=Laya.Handler.create(this,function(){t.locking||t.close()},null,!1),this.root=e.getChildByName("root"),this.scrollview=this.root.scriptMap["capsui.CScrollView"],this.scrollview.init_scrollview(Laya.Handler.create(this,this.render_item,null,!1)),this.noinfo=this.root.getChildByName("noinfo")}return t.prototype.show=function(){var t=this;this.locking=!0,this.me.visible=!0,this.scrollview.reset(),this.friends=[],this.sortlist=[];for(var i=game.FriendMgr.friend_list,n=0;n<i.length;n++)this.sortlist.push(n);this.sortlist=this.sortlist.sort(function(e,t){var n=i[e],a=0;if(n.state.is_online){a+=""!=(s=game.Tools.playState2Desc(n.state.playing))?3e10:6e10,a+=-n.state.login_time}else a+=n.state.logout_time;var r=i[t],o=0;if(r.state.is_online){var s=game.Tools.playState2Desc(r.state.playing);o+=""!=s?3e10:6e10,o+=-r.state.login_time}else o+=r.state.logout_time;return o-a});for(n=0;n<i.length;n++)this.friends.push({f:i[n],invited:!1});this.noinfo.visible=0==this.friends.length,this.scrollview.addItem(this.friends.length),e.UIBase.anim_pop_out(this.root,Laya.Handler.create(this,function(){t.locking=!1}))},t.prototype.close=function(){var t=this;this.locking=!0,e.UIBase.anim_pop_hide(this.root,Laya.Handler.create(this,function(){t.locking=!1,t.me.visible=!1}))},t.prototype.render_item=function(t){var n=t.index,a=t.container,r=t.cache_data;r.head||(r.head=new e.UI_Head(a.getChildByName("head")),r.name=a.getChildByName("label_name"),r.state=a.getChildByName("label_state"),r.btn=a.getChildByName("btn_invite"),r.invited=a.getChildByName("invited"));var o=this.friends[this.sortlist[n]];r.head.id=o.f.base.avatar_id,r.name.text=o.f.base.nickname;var s=!1;if(o.f.state.is_online){var h=game.Tools.playState2Desc(o.f.state.playing);""!=h?(r.state.text="正在"+h+"对战",r.state.color="#a9d94d",r.name.color="#a9d94d"):(r.state.text="当前在线",r.state.color="#58c4db",r.name.color="#58c4db",s=!0)}else r.state.text="离线",r.state.color="#8c8c8c",r.name.color="#8c8c8c";o.invited?(r.btn.visible=!1,r.invited.visible=!0):(r.btn.visible=!0,r.invited.visible=!1,game.Tools.setGrayDisable(r.btn,!s),s&&(r.btn.clickHandler=Laya.Handler.create(this,function(){game.Tools.setGrayDisable(r.btn,!0);var t={room_id:i.Inst.room_id,mode:i.Inst.room_mode,nickname:GameMgr.Inst.account_data.nickname,account_id:GameMgr.Inst.account_id};app.NetAgent.sendReq2Lobby("Lobby","sendClientMessage",{target_id:o.f.base.account_id,type:game.EFriendMsgType.room_invite,content:JSON.stringify(t)},function(t,i){t||i.error?(game.Tools.setGrayDisable(r.btn,!1),e.UIMgr.Inst.showNetReqError("sendClientMessage",t,i)):(r.btn.visible=!1,r.invited.visible=!0,o.invited=!0)})},null,!1)))},t}(),i=function(i){function n(){var t=i.call(this,new ui.lobby.waitingroomUI)||this;return t.skin_ready="myres/room/btn_ready.png",t.skin_cancel="myres/room/btn_cancel.png",t.skin_start="myres/room/btn_start.png",t.skin_start_no="myres/room/btn_start_no.png",t.label_rommid=null,t.player_cells=[],t.btn_ok=null,t.btn_invite_friend=null,t.btn_add_robot=null,t.beReady=!1,t.room_id=-1,t.owner_id=-1,t.tournament_id=0,t.max_player_count=0,t.players=[],t.container_rules=null,t.container_top=null,t.container_right=null,t.locking=!1,t.mousein_copy=!1,t.popout=null,t.room_link=null,t.last_start_room=0,t.invitefriend=null,t.pre_choose=null,t.ai_name="电脑(简单)",n.Inst=t,app.NetAgent.AddListener2Lobby("NotifyRoomPlayerReady",Laya.Handler.create(t,function(e){app.Log.log("NotifyRoomPlayerReady:"+JSON.stringify(e)),t.onReadyChange(e.account_id,e.ready)})),app.NetAgent.AddListener2Lobby("NotifyRoomPlayerUpdate",Laya.Handler.create(t,function(e){app.Log.log("NotifyRoomPlayerUpdate:"+JSON.stringify(e)),t.onPlayerChange(e)})),app.NetAgent.AddListener2Lobby("NotifyRoomGameStart",Laya.Handler.create(t,function(e){t.enable&&(app.Log.log("NotifyRoomGameStart:"+JSON.stringify(e)),t.onGameStart(e))})),app.NetAgent.AddListener2Lobby("NotifyRoomKickOut",Laya.Handler.create(t,function(e){app.Log.log("NotifyRoomKickOut:"+JSON.stringify(e)),t.onBeKictOut()})),game.LobbyNetMgr.Inst.add_connect_listener(Laya.Handler.create(t,function(){t.enable&&t.hide(Laya.Handler.create(t,function(){e.UI_Lobby.Inst.enable=!0}))},null,!1)),t}return __extends(n,i),Object.defineProperty(n.prototype,"inRoom",{get:function(){return-1!=this.room_id},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"robot_count",{get:function(){for(var e=0,t=0;t<this.players.length;t++)2==this.players[t].category&&e++;return e},enumerable:!0,configurable:!0}),n.prototype.resetData=function(){this.room_id=-1,this.owner_id=-1,this.room_mode={},this.max_player_count=0,this.players=[]},n.prototype.updateData=function(e){if(e){this.room_id=e.room_id,this.owner_id=e.owner_id,this.room_mode=e.mode,this.public_live=e.public_live,this.tournament_id=0,e.tournament_id&&(this.tournament_id=e.tournament_id),this.ai_name="电脑(简单)",this.room_mode.detail_rule&&(1===this.room_mode.detail_rule.ai_level&&(this.ai_name="电脑(简单)"),2===this.room_mode.detail_rule.ai_level&&(this.ai_name="电脑(普通)")),this.max_player_count=e.max_player_count,this.players=[];for(i=0;i<e.persons.length;i++){var t=e.persons[i];t.ready=!1,t.cell_index=-1,t.category=1,this.players.push(t)}for(i=0;i<e.robot_count;i++)this.players.push({category:2,cell_index:-1,account_id:0,level:{id:10101,score:0},nickname:this.ai_name,ready:!0,title:0,avatar_id:400101});for(var i=0;i<e.ready_list.length;i++)for(var n=0;n<this.players.length;n++)if(this.players[n].account_id==e.ready_list[i]){this.players[n].ready=!0;break}}else this.resetData()},n.prototype.onReadyChange=function(e,t){for(var i=0;i<this.players.length;i++)if(this.players[i].account_id==e){this.players[i].ready=t,this._onPlayerReadyChange(this.players[i]);break}},n.prototype.onPlayerChange=function(e){e=e.toJSON();for(var t=[],i=0;i<this.players.length;i++)0!=this.players[i].category&&t.push(this.players[i]);if(this.players=t,e.update_list)for(i=0;i<e.update_list.length;i++){for(var n=e.update_list[i],a=n.account_id,r=!0,o=0;o<this.players.length;o++)if(this.players[o]&&this.players[o].account_id==a){n.avatar_id&&(this.players[o].avatar_id=n.avatar_id),n.title&&(this.players[o].avatar_id=n.title),n.nickname&&(this.players[o].avatar_id=n.nickname),n.level&&(this.players[o].level=n.level),this._refreshPlayerInfo(this.players[o]),r=!1;break}if(r){var s=-1;if(this.enable){for(var h=[!1,!1,!1,!1],l=0;l<this.players.length;l++)h[this.players[l].cell_index]=!0;for(o=0;o<this.max_player_count;o++)if(!h[o]){s=o;break}}n.cell_index=s,n.ready=!1,n.category=1,this.players.push(n),this._refreshPlayerInfo(this.players[this.players.length-1])}}if(e.remove_list)for(i=0;i<e.remove_list.length;i++)for(var a=e.remove_list[i],o=0;o<this.players.length;o++)if(this.players[o]&&this.players[o].account_id==a){for(var c=this.players[o].cell_index,p=o;p<this.players.length-1;p++)this.players[p]=this.players[p+1];this.players.pop(),this._clearCell(c);break}if(null!=e.robot_count&&void 0!=e.robot_count){var u=e.robot_count;u<this.robot_count&&this.pre_choose&&2==this.pre_choose.category&&(this.pre_choose.category=0,this._clearCell(this.pre_choose.cell_index),this.pre_choose=null);for(i=0;i<this.players.length;i++){var d=this.players[i];2==d.category&&(0==u?(this.players[i].category=0,this._clearCell(d.cell_index)):u--)}for(;u>0;){for(var _=-1,i=0;i<this.players.length;i++)if(0==this.players[i].category){_=i;break}if(-1==_){if(!(this.players.length<this.max_player_count)){app.Log.Error("同步机器人数量有问题");break}u--;for(var c=-1,h=[!1,!1,!1,!1],i=0;i<this.players.length;i++)h[this.players[i].cell_index]=!0;for(o=0;o<this.max_player_count;o++)if(!h[o]){c=o;break}this.players.push({category:2,cell_index:c,account_id:0,level:{id:10101,score:0},nickname:this.ai_name,ready:!0,title:0,avatar_id:400101}),this._refreshPlayerInfo(this.players[this.players.length-1])}else u--,this.players[_].category=2,this.players[_].cell_index=_,this.players[_].account_id=0,this.players[_].level={id:10101,score:0},this.players[_].nickname=this.ai_name,this.players[_].ready=!0,this.players[_].title=0,this.players[_].avatar_id=400101,this._refreshPlayerInfo(this.players[_])}}if(e.owner_id){if(this.owner_id=e.owner_id,this.enable)if(this.owner_id==GameMgr.Inst.account_id)this.refreshAsOwner();else for(o=0;o<this.players.length;o++)if(this.players[o]&&this.players[o].account_id==this.owner_id){this._refreshPlayerInfo(this.players[o]);break}}else if(this.enable)if(this.owner_id==GameMgr.Inst.account_id)this.refreshAsOwner();else for(o=0;o<this.players.length;o++)if(this.players[o]&&this.players[o].account_id==this.owner_id){this._refreshPlayerInfo(this.players[o]);break}},n.prototype.onBeKictOut=function(){this.resetData(),this.enable&&(this.enable=!1,e.UI_Lobby.Inst.enable=!0,e.UIMgr.Inst.ShowErrorInfo(cfg.str.str.find(52).desc))},n.prototype.onCreate=function(){var i=this;this.last_start_room=0;var n=this.me.getChildByName("root");this.container_top=n.getChildByName("top"),this.container_right=n.getChildByName("right"),this.label_rommid=this.container_top.getChildByName("label_roomid");for(var a=function(t){var a=n.getChildByName("player_"+t.toString()),o={};o.index=t,o.container=a,o.container_flag=a.getChildByName("flag"),o.container_name=a.getChildByName("container_name"),o.name=a.getChildByName("container_name").getChildByName("label_name"),o.btn_t=a.getChildByName("btn_t"),o.container_illust=a.getChildByName("container_illust"),o.illust=new e.UI_Character_Skin(a.getChildByName("container_illust").getChildByName("illust")),o.host=a.getChildByName("host"),o.title=new e.UI_PlayerTitle(a.getChildByName("container_name").getChildByName("title")),o.rank=new e.UI_Level(a.getChildByName("container_name").getChildByName("rank")),o.is_robot=!1;var s=0;o.btn_t.clickHandler=Laya.Handler.create(r,function(){if(!(i.locking||Laya.timer.currTimer<s)){s=Laya.timer.currTimer+500;for(var e=0;e<i.players.length;e++)if(i.players[e].cell_index==t){i.kickPlayer(e);break}}},null,!1),o.btn_info=a.getChildByName("btn_info"),o.btn_info.clickHandler=Laya.Handler.create(r,function(){if(!i.locking)for(var n=0;n<i.players.length;n++)if(i.players[n].cell_index==t){i.players[n].account_id&&i.players[n].account_id>0&&e.UI_OtherPlayerInfo.Inst.show(i.players[n].account_id);break}},null,!1),r.player_cells.push(o)},r=this,o=0;o<4;o++)a(o);this.btn_ok=n.getChildByName("btn_ok"),this.btn_ok.clickHandler=Laya.Handler.create(this,function(){i.owner_id==GameMgr.Inst.account_id?i.getStart():i.switchReady()},null,!1),this.container_top.getChildByName("btn_leave").clickHandler=Laya.Handler.create(this,function(){i.leaveRoom()},null,!1),this.btn_invite_friend=this.container_right.getChildByName("btn_friend"),this.btn_invite_friend.clickHandler=Laya.Handler.create(this,function(){i.locking||i.invitefriend.show()},null,!1),this.btn_add_robot=this.container_right.getChildByName("btn_robot");var s=0;this.btn_add_robot.clickHandler=Laya.Handler.create(this,function(){i.locking||Laya.timer.currTimer<s||(s=Laya.timer.currTimer+1e3,app.NetAgent.sendReq2Lobby("Lobby","modifyRoom",{robot_count:i.robot_count+1},function(t,i){(t||i.error&&1111!=i.error.code)&&e.UIMgr.Inst.showNetReqError("modifyRoom_add",t,i),s=0}))},null,!1);var h=this.container_right.getChildByName("btn_copy");h.on("mouseover",this,function(){i.mousein_copy=!0}),h.on("mouseout",this,function(){i.mousein_copy=!1}),h.clickHandler=Laya.Handler.create(this,function(){i.popout.visible||(GameMgr.Inst.BehavioralStatistics(12),i.popout.visible=!0,e.UIBase.anim_pop_out(i.popout,null))},null,!1),this.container_rules=this.container_right.getChildByName("container_rules"),this.container_rules.visible=!0,this.popout=this.me.getChildByName("pop"),this.room_link=this.popout.getChildByName("input").getChildByName("txtinput"),this.room_link.editable=!1,this.popout.visible=!1,this.popout.getChildByName("btn_cancel").clickHandler=Laya.Handler.create(this,function(){e.UIBase.anim_pop_hide(i.popout,Laya.Handler.create(i,function(){i.popout.visible=!1}))},null,!1),this.invitefriend=new t(this.me.getChildByName("invite_friend"))},n.prototype.show=function(){var t=this;game.Scene_Lobby.Inst.change_bg("indoor",!1),this.mousein_copy=!1,this.beReady=!1,this.invitefriend.me.visible=!1,this.btn_add_robot.visible=!1,this.btn_invite_friend.visible=!1,this.pre_choose=null;for(l=0;l<4;l++)this.player_cells[l].container.visible=l<this.max_player_count;for(l=0;l<this.max_player_count;l++)this._clearCell(l);for(l=0;l<this.players.length;l++)this.players[l].cell_index=l,this._refreshPlayerInfo(this.players[l]);this.owner_id==GameMgr.Inst.account_id?(this.btn_ok.skin=this.skin_start,this.refreshAsOwner()):(this.btn_ok.skin=this.skin_ready,game.Tools.setGrayDisable(this.btn_ok,!1)),this.label_rommid.text=this.room_id.toString(),this.container_rules.visible=!0;for(l=0;l<this.container_rules.numChildren;l++)this.container_rules.getChildAt(l).visible=!1;var i=[];i.push(e.UI_Create_Room.s_modes[0][this.room_mode.mode]);var n=this.room_mode.detail_rule;if(n){var a=5,r=20;if(null!=n.time_fixed&&(a=n.time_fixed),null!=n.time_add&&(r=n.time_add),i.push(a.toString()+"+"+r.toString()+"秒"),0!=this.tournament_id){var o=cfg.tournament.tournaments.get(this.tournament_id);o&&i.push(o.name)}if(null!=n.init_point&&25e3!=n.init_point&&i.push("起："+n.init_point),null!=n.fandian&&3e4!=n.fandian&&i.push("一位必要点数：\n"+n.fandian),null!=n.dora_count&&3!=n.dora_count)switch(n.dora_count){case 0:i.push("无赤");break;case 4:i.push("4赤")}null!=n.shiduan&&1!=n.shiduan&&i.push("无食断"),null!=n.bianjietishi&&1!=n.bianjietishi&&i.push("便捷提示关")}this.public_live&&i.push("可观战");for(l=0;l<i.length;l++){var s=this.container_rules.getChildAt(l);s.visible=!0,s.x=6,s.y=334-68*(i.length-1-l);var h=s.getChildAt(0);h.fontSize=40,h.text=i[l]}this.enable=!0,this.locking=!0,e.UIBase.anim_alpha_in(this.container_top,{y:-30},200);for(var l=0;l<this.player_cells.length;l++)e.UIBase.anim_alpha_in(this.player_cells[l].container,{x:80},150,150+50*l,null,Laya.Ease.backOut);e.UIBase.anim_alpha_in(this.btn_ok,{},100,600),e.UIBase.anim_alpha_in(this.container_right,{x:20},100,500),Laya.timer.once(600,this,function(){t.locking=!1});var c="";switch(this.room_mode.mode){case 0:c="一局";break;case 1:c="东风";break;case 2:c="南风"}this.room_link.text="雀魂友人房"+this.room_id.toString(),""!=c&&(this.room_link.text+="("+c+")"),this.room_link.text+=": http://majsoul.union-game.com/0/?room="+this.room_id},n.prototype.onCopy=function(){if(e.UI_WaitingRoom.Inst.mousein_copy||Laya.Browser.onMobile){document.getElementById("copytext").select();var t=document.execCommand("Copy");Laya.Browser.onMobile||e.UI_WaitingRoom.Inst.mousein_copy&&(t?e.UI_Popout.PopOutNoTitle("复制成功",null):e.UI_Popout.PopOutNoTitle("复制失败",null))}},n.prototype.leaveRoom=function(){var t=this;this.locking||app.NetAgent.sendReq2Lobby("Lobby","leaveRoom",{},function(i,n){i||n.error?e.UIMgr.Inst.showNetReqError("leaveRoom",i,n):t.hide(Laya.Handler.create(t,function(){e.UI_Lobby.Inst.enable=!0}))})},n.prototype.tryToClose=function(t){var i=this;app.NetAgent.sendReq2Lobby("Lobby","leaveRoom",{},function(n,a){n||a.error?(e.UIMgr.Inst.showNetReqError("leaveRoom",n,a),t.runWith(!1)):(i.enable=!1,t.runWith(!0))})},n.prototype.hide=function(t){var i=this;this.locking=!0,e.UIBase.anim_alpha_out(this.container_top,{y:-30},150);for(var n=0;n<this.player_cells.length;n++)e.UIBase.anim_alpha_out(this.player_cells[n].container,{x:80},150,0,null);e.UIBase.anim_alpha_out(this.btn_ok,{},150),e.UIBase.anim_alpha_out(this.container_right,{x:20},150),Laya.timer.once(200,this,function(){i.locking=!1,i.enable=!1,t&&t.run()}),document.getElementById("layaCanvas").onclick=null},n.prototype.onDisbale=function(){Laya.timer.clearAll(this);for(var e=0;e<this.player_cells.length;e++)Laya.loader.clearTextureRes(this.player_cells[e].illust.skin);document.getElementById("layaCanvas").onclick=null},n.prototype.switchReady=function(){this.owner_id!=GameMgr.Inst.account_id&&(this.beReady=!this.beReady,this.btn_ok.skin=this.beReady?this.skin_cancel:this.skin_ready,app.NetAgent.sendReq2Lobby("Lobby","readyPlay",{ready:this.beReady},function(e,t){}))},n.prototype.getStart=function(){this.owner_id==GameMgr.Inst.account_id&&(Laya.timer.currTimer<this.last_start_room+2e3||(this.last_start_room=Laya.timer.currTimer,app.NetAgent.sendReq2Lobby("Lobby","startRoom",{},function(t,i){(t||i.error)&&e.UIMgr.Inst.showNetReqError("startRoom",t,i)})))},n.prototype.kickPlayer=function(t){if(this.owner_id==GameMgr.Inst.account_id){var i=this.players[t];1==i.category?app.NetAgent.sendReq2Lobby("Lobby","kickPlayer",{account_id:this.players[t].account_id},function(e,t){}):2==i.category&&(this.pre_choose=i,app.NetAgent.sendReq2Lobby("Lobby","modifyRoom",{robot_count:this.robot_count-1},function(t,i){(t||i.error)&&e.UIMgr.Inst.showNetReqError("modifyRoom_minus",t,i)}))}},n.prototype._clearCell=function(e){if(!(e<0||e>=this.player_cells.length)){var t=this.player_cells[e];t.container_flag.visible=!1,t.container_illust.visible=!1,t.name.visible=!1,t.container_name.visible=!1,t.btn_t.visible=!1,t.host.visible=!1}},n.prototype._refreshPlayerInfo=function(e){var t=e.cell_index;if(!(t<0||t>=this.player_cells.length)){var i=this.player_cells[t];i.container_illust.visible=!0,i.container_name.visible=!0,i.name.visible=!0,i.name.text=e.nickname,i.btn_t.visible=this.owner_id==GameMgr.Inst.account_id&&e.account_id!=GameMgr.Inst.account_id,this.owner_id==e.account_id&&(i.container_flag.visible=!0,i.host.visible=!0),i.illust.setSkin(e.avatar_id,"waitingroom"),i.title.id=e.title,i.rank.id=e.level.id,this._onPlayerReadyChange(e)}},n.prototype._onPlayerReadyChange=function(e){var t=e.cell_index;if(!(t<0||t>=this.player_cells.length)){var i=this.player_cells[t];this.owner_id==e.account_id?i.container_flag.visible=!0:i.container_flag.visible=e.ready,this.refreshStart()}},n.prototype.refreshAsOwner=function(){if(this.owner_id==GameMgr.Inst.account_id){for(var e=0,t=0;t<this.players.length;t++)0!=this.players[t].category&&(this._refreshPlayerInfo(this.players[t]),e++);this.btn_add_robot.visible=!0,this.btn_invite_friend.visible=!0,game.Tools.setGrayDisable(this.btn_add_robot,e==this.max_player_count),this.refreshStart()}},n.prototype.refreshStart=function(){if(this.owner_id==GameMgr.Inst.account_id){this.btn_ok.skin=this.skin_start;for(var e=0,t=0;t<this.players.length;t++)if(0!=this.players[t].category&&(!this.players[t]||this.players[t].account_id!=this.owner_id)){if(!this.players[t]||null==this.players[t].ready||void 0==this.players[t].ready||!this.players[t].ready)return void game.Tools.setGrayDisable(this.btn_ok,!0);e++}game.Tools.setGrayDisable(this.btn_ok,e+1!=this.max_player_count)}},n.prototype.onGameStart=function(e){game.Tools.setGrayDisable(this.btn_ok,!0),this.enable=!1,game.MJNetMgr.Inst.OpenConnect(e.game_url,e.connect_token,e.game_uuid,!1,null)},n.Inst=null,n}(e.UIBase);e.UI_WaitingRoom=i}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(t){function i(){var e=t.call(this,new ui.lobby.waitobUI)||this;return e._sec=0,e._start_time=0,i.Inst=e,e}return __extends(i,t),i.prototype.onCreate=function(){var e=this;this.root=this.me.getChildByName("root"),this.label_sec=this.root.getChildByName("sec"),this.root.getChildByName("btn_confirm").clickHandler=Laya.Handler.create(this,function(){e.locking||e.close(Laya.Handler.create(e,function(){e._func&&e._func.runWith({success:!1})}))},null,!1)},i.prototype.show=function(t,i,n){var a=this;this._func=n,this.label_sec.text=i.toString(),this._sec=i,this.locking=!0,this.enable=!0,e.UIBase.anim_pop_out(this.root,Laya.Handler.create(this,function(){a.locking=!1,a._start_time=Laya.timer.currTimer,Laya.timer.loop(100,a,function(){var i=Math.ceil((1e3*a._sec-(Laya.timer.currTimer-a._start_time))/1e3);i<=0&&(i=0),a.label_sec.text=i.toString(),0==i&&a.close(Laya.Handler.create(a,function(){e.UI_Live_Broadcast.fetchInfo(t,n)}))})}))},i.prototype.close=function(t){var i=this;Laya.timer.clearAll(this),this.locking=!0,e.UIBase.anim_pop_hide(this.root,Laya.Handler.create(this,function(){i.locking=!1,i.enable=!1,t&&t.run()}))},i.prototype.onDisable=function(){Laya.timer.clearAll(this)},i}(e.UIBase);e.UI_WaitOb=t}(uiscript||(uiscript={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uiscript;!function(e){var t=function(){return function(){}}(),i=function(i){function n(){var e=i.call(this,new ui.mj.winUI)||this;return e.root=null,e.label_chang=null,e.label_winner_name=null,e.img_mode=null,e.container_hand=null,e.img_hands=[],e.container_dora=null,e.img_doras=[],e.container_lidora=null,e.img_lidoras=[],e.container_fan_yiman=null,e.container_fan_liuju=null,e.container_fan_8=null,e.container_fan_12=null,e.container_fan_15=null,e.fan_imgs=[],e.fu_imgs=[],e.img_yiman=null,e.score_imgs=[],e.title_imgs=[],e.btn_confirm=null,e.container_title=null,e.container_score=null,e.container_fan=null,e.container_fu=null,e.count_down=null,e.illust=null,e.illust_rect=null,e.liujumanguan=!1,e.data=null,e.current_index=0,e.effect_yiman=null,n.Inst=e,e}return __extends(n,i),n.prototype.onCreate=function(){this.root=this.me.getChildByName("root"),this.label_winner_name=this.root.getChildByName("container_name").getChildAt(0),this.img_mode=this.root.getChildByName("he"),this.container_hand=this.root.getChildByName("container_hand"),this.illust=this.root.getChildByName("xiaojiejie"),this.illust_rect=e.UIRect.CreateFromSprite(this.illust),this.img_hands=[];for(i=0;i<this.container_hand.numChildren;i++){(t=this.container_hand.getChildAt(i)).visible=!1,this.img_hands.push(t)}this.container_dora=this.root.getChildByName("container_dora"),this.img_doras=[];for(i=0;i<5;i++){t=this.container_dora.getChildByName("img"+i);this.img_doras.push(t)}this.container_lidora=this.root.getChildByName("container_lidora"),this.img_lidoras=[];for(i=0;i<5;i++){var t=this.container_lidora.getChildByName("img"+i);this.img_lidoras.push(t)}this.container_fan_yiman=this.root.getChildByName("container_fan_yiman"),this.container_fan_liuju=this.root.getChildByName("container_fan_liuju"),this.container_fan_8=this.root.getChildByName("container_fan_8"),this.container_fan_12=this.root.getChildByName("container_fan_12"),this.container_fan_15=this.root.getChildByName("container_fan_15"),this.btn_confirm=this.root.getChildByName("btn_confirm"),this.count_down=this.btn_confirm.getChildByName("countdown"),this.container_title=this.root.getChildByName("container_title");for(i=0;i<4;i++)this.title_imgs.push(this.container_title.getChildByName(i.toString()));this.container_score=this.root.getChildByName("container_score");for(i=0;i<6;i++)this.score_imgs.push(this.container_score.getChildByName("s"+i.toString()));this.img_yiman=this.root.getChildByName("container_fanfu").getChildByName("yiman"),this.container_fan=this.root.getChildByName("container_fanfu").getChildByName("fan");for(i=0;i<2;i++)this.fan_imgs.push(this.container_fan.getChildByName(i.toString()));this.container_fu=this.root.getChildByName("container_fanfu").getChildByName("fu");for(var i=0;i<3;i++)this.fu_imgs.push(this.container_fu.getChildByName(i.toString()));this.btn_confirm.clickHandler=new laya.utils.Handler(this,this.onConfirm)},n.prototype.show=function(e,t){this.liujumanguan=t,this.data=e,this.current_index=0,this.liujumanguan?this._showLiuJuManGuan(e[0]):this._showHule(e.hules[0]),this.enable=!0},n.prototype.onConfirm=function(){if(Laya.timer.clearAll(this),this.btn_confirm.disabled=!0,Laya.loader.clearTextureRes(this.illust.skin),this.effect_yiman&&(this.effect_yiman.destory(),this.effect_yiman=null),this.liujumanguan)if(this.current_index<this.data.length-1)this.current_index++,this._showLiuJuManGuan(this.data[this.current_index]);else{this.enable=!1;for(var t=[],i=0;i<4;i++)t.push({old_score:this.data[0].old_scores[i],delta:0});for(i=0;i<this.data.length;i++)for(var n=0;n<4;n++)t[n].delta+=this.data[i].delta_scores[n];e.UI_ScoreChange.Inst.show(t)}else if(this.current_index<this.data.hules.length-1)this.current_index++,this._showHule(this.data.hules[this.current_index]);else{this.enable=!1,e.UI_DesktopInfo.Inst.setLiqibang(0);for(var t=[],i=0;i<4;i++)t.push({old_score:this.data.old_scores[i],delta:this.data.delta_scores[i]});e.UI_ScoreChange.Inst.show(t)}},n.prototype.setTitle=function(e){var t=[];switch(e){case"满贯":t=["","","man","guan"];break;case"跳满":t=["","","tiao","man"];break;case"倍满":t=["","","bei","man"];break;case"三倍满":t=["","san","bei","man"];break;case"累积役满":t=["lei","ji","yi","man"];break;case"役满":t=["","","yi","man"];break;case"两倍役满":t=["liang","bei","yi","man"];break;case"三倍役满":t=["san","bei","yi","man"];break;case"四倍役满":t=["si","bei","yi","man"];break;case"五倍役满":t=["wu","bei","yi","man"];break;case"六倍役满":t=["liu","bei","yi","man"]}for(i=0;i<this.title_imgs.length;i++)this.title_imgs[i].visible=!1;for(var i=0;i<t.length;i++)if(""!=t[i]){var n=this.title_imgs[i];n.visible=!0,n.skin="myres/word_"+t[i]+".png"}},n.prototype.setFanFu=function(e,t){this.container_fan.visible=this.container_fu.visible=!0,this.container_fan.alpha=this.container_fu.alpha=0;for(i=0;i<2;i++)if(0==e)this.fan_imgs[i].visible=!1;else{n=e%10;e=Math.floor(e/10),this.fan_imgs[i].visible=!0,this.fan_imgs[i].skin="myres/mjdesktop/h_"+n.toString()+".png"}for(var i=0;i<3;i++)if(0==t)this.fu_imgs[i].visible=!1;else{var n=t%10;t=Math.floor(t/10),this.fu_imgs[i].visible=!0,this.fu_imgs[i].skin="myres/mjdesktop/ww_"+n.toString()+".png"}Laya.Tween.to(this.container_fan,{alpha:1},200),Laya.Tween.to(this.container_fu,{alpha:1},200)},n.prototype._showInfo_mj=function(e){var t=this;this.root.alpha=0,Laya.Tween.to(this.root,{alpha:1},500);this.label_winner_name.text=view.DesktopMgr.Inst.player_datas[e.seat].nickname;var i=view.DesktopMgr.Inst.player_datas[e.seat].character;game.Tools.charaPart(view.DesktopMgr.Inst.player_datas[e.seat].avatar_id,this.illust,"full",this.illust_rect),2==e.mode?this.img_mode.visible=!1:(this.img_mode.visible=!0,0==e.mode?this.img_mode.skin="myres/mjdesktop/pg_zimo.png":this.img_mode.skin="myres/mjdesktop/pg_he.png");for(var n="myres2/mjp/"+GameMgr.Inst.mjp_view+"/ui/",a=this.img_hands[0].width,r=.5*a,o=0;o<this.img_hands.length;o++)this.img_hands[o].visible=!1;for(var s=0,h=0,o=0;o<e.hand.length;o++)this.img_hands[s].skin=n+e.hand[o]+".png",this.img_hands[s].x=h,this.img_hands[s].y=0,h+=a,this.img_hands[s].visible=!0,s++;if(e.ming&&e.ming.length>0){h+=r;for(o=0;o<e.ming.length;o++){var l=e.ming[o];if(")"!=l.charAt(l.length-1)){if(1==(p=l.split("|")).length){_=p[0].charAt(1);"0"==(d=p[0].charAt(0))&&(d="5");for(y=0;y<4;y++){x="";x=0==y||3==y?"back":1==y&&"5"==d&&"z"!=_?"0"+_:d+_,this.img_hands[s].skin=n+x+".png",this.img_hands[s].x=h,this.img_hands[s].y=0,h+=a,this.img_hands[s].visible=!0,s++}}else for(y=0;y<p.length;y++){x=p[y].toString();this.img_hands[s].skin=n+x+".png",this.img_hands[s].x=h,this.img_hands[s].y=0,h+=a,this.img_hands[s].visible=!0,s++}}else{for(var c="",p=[],u=0;u<l.length;u++)if("("==l.charAt(u)){c=l.substring(0,u),p=l.substring(u+1,l.length-1).split(",");break}if("angang"==c){for(var d=p[0].charAt(0),_=p[0].charAt(1),m=0,f=0;f<p.length;f++)"0"==p[f].charAt(0)&&m++;m>0&&(d="5");for(var g=0;g<p.length;g++){x="";x=0==g||3==g?"back":g<=m?"0"+_:d+_,this.img_hands[s].skin=n+x+".png",this.img_hands[s].x=h,this.img_hands[s].y=0,h+=a,this.img_hands[s].visible=!0,s++}}else for(var y=0;y<p.length;y++){x=p[y];this.img_hands[s].skin=n+x+".png",this.img_hands[s].x=h,this.img_hands[s].y=0,h+=a,this.img_hands[s].visible=!0,s++}}}}h+=r,2!=e.mode&&(this.img_hands[s].skin=n+e.hupai+".png",this.img_hands[s].x=h,this.img_hands[s].y=0,h+=a,this.img_hands[s].visible=!0,s++);var v=(.72-.92)*(s-14)/4+.92;this.container_hand.scaleX=this.container_hand.scaleY=v;for(o=0;o<5;o++){x="back";o<e.doras.length&&(x=e.doras[o]),this.img_doras[o].skin=n+x+".png",this.img_doras[o].x=o*a,this.img_doras[o].y=0}if(e.lidoras&&2!=e.mode){this.container_lidora.visible=!0;for(o=0;o<5;o++){x="back";o<e.lidoras.length&&(x=e.lidoras[o]),this.img_lidoras[o].skin=n+x+".png",this.img_lidoras[o].x=o*a,this.img_lidoras[o].y=0}}else{this.container_lidora.visible=!0;for(o=0;o<5;o++){var x="back";this.img_lidoras[o].skin=n+x+".png",this.img_lidoras[o].x=o*a,this.img_lidoras[o].y=0}}var b=e.fan_names.length,w=100;this.container_fan_yiman.visible=!1,this.container_fan_8.visible=!1,this.container_fan_15.visible=!1,this.container_fan_12.visible=!1,this.container_fan_liuju.visible=!1,this.container_fan_yiman.visible=!1,this.container_fan_8.visible=!1,this.container_fan_15.visible=!1,this.container_fan_12.visible=!1,this.container_fan_liuju.visible=!1;var S=null;(S=2==e.mode?this.container_fan_liuju:e.yiman?this.container_fan_yiman:b<=8?this.container_fan_8:b<=12?this.container_fan_12:this.container_fan_15).visible=!0;for(o=0;o<S.numChildren;o++)S.getChildAt(o).visible=!1;for(var I=[],M=function(t){var i=e.fan_names[t],n=0,a=-1;cfg.fan.fan.forEach(function(e){e.name==i&&(n=e.show_index,a=e.id)});var r={name:i,index:n};if(e.fan_value&&e.fan_value.length>t&&(r.value=e.fan_value[t]),10==a)switch((e.seat-view.DesktopMgr.Inst.index_ju+4)%4){case 0:r.sound="fan_dong";break;case 1:r.sound="fan_nan";break;case 2:r.sound="fan_xi";break;case 3:r.sound="fan_bei"}else if(11==a)if(view.DesktopMgr.Inst.index_change%4==(e.seat-view.DesktopMgr.Inst.index_ju+4)%4)switch(view.DesktopMgr.Inst.index_change%4){case 0:r.sound="fan_doubledong";break;case 1:r.sound="fan_doublenan";break;case 2:r.sound="fan_doublexi";break;case 3:r.sound="fan_doublebei"}else switch(view.DesktopMgr.Inst.index_change%4){case 0:r.sound="fan_dong";break;case 1:r.sound="fan_nan";break;case 2:r.sound="fan_xi";break;case 3:r.sound="fan_bei"}else if(a>=31&&a<=34){var o=r.value;o>13&&(o=13),r.sound=0==o?"":"fan_dora"+o}else a>=0&&(r.sound=cfg.fan.fan.get(a).sound);"流局满贯"==i&&(r.sound="fan_liujumanguan"),I.push(r)},o=0;o<e.fan_names.length;o++)M(o);I=I.sort(function(e,t){return e.index-t.index}),w+=500;for(var C=function(e){var t=game.Tools.get_chara_audio(i,I[e].sound);Laya.timer.once(w,k,function(){var i=S.getChildAt(e);if(i.getChildByName("l_name").text=I[e].name,void 0!==I[e].value&&null!==I[e].value){i.getChildAt(2).visible=!0;var n=I[e].value.toString();2==n.length?(i.getChildAt(3).skin="myres/mjdesktop/h_"+n[1]+".png",i.getChildAt(3).visible=!0,i.getChildAt(4).skin="myres/mjdesktop/h_"+n[0]+".png",i.getChildAt(4).visible=!0):(i.getChildAt(3).skin="myres/mjdesktop/h_"+n[0]+".png",i.getChildAt(3).visible=!0,i.getChildAt(4).visible=!1)}i.visible=!0,Laya.Tween.from(i,{x:169,y:184,alpha:0},100,Laya.Ease.strongOut),t?(view.AudioMgr.PlaySound(t.path,t.volume),view.AudioMgr.PlayAudio(211,1,.5)):view.AudioMgr.PlayAudio(211,1,1)}),w+=t&&t.time_length>500?t.time_length:500},k=this,o=0;o<b&&o<S.numChildren;o++)C(o);this.container_fan.visible=!1,this.container_fu.visible=!1,this.img_yiman.visible=!1,e.fan&&e.fu?(w+=300,Laya.timer.once(w,this,function(){view.AudioMgr.PlayAudio(208),t.setFanFu(e.fan,e.fu)})):e.yiman&&(w+=700,Laya.timer.once(w,this,function(){view.AudioMgr.PlayAudio(208),t.img_yiman.alpha=0,t.img_yiman.visible=!0,Laya.Tween.to(t.img_yiman,{alpha:1},200)})),this.container_score.alpha=0;for(o=0;o<this.score_imgs.length;o++)this.score_imgs[o].visible=!1;if(w+=700,this.container_score.scaleX=this.container_score.scaleY=2,Laya.timer.once(w,this,function(){for(var i=0,n=e.score;0!=n;){var a=n%10;if(n=Math.floor(n/10),t.score_imgs[i].skin="myres/mjdesktop/ww_"+a.toString()+".png",t.score_imgs[i].visible=!0,++i>=t.score_imgs.length)break}Laya.Tween.to(t.container_score,{alpha:1,scaleX:1.2,scaleY:1.2},200,Laya.Ease.strongIn),view.AudioMgr.PlayAudio(221)}),this.container_title.visible=!1,null==e.title||void 0==e.title||""==e.title);else{w+=700;var E=0,T=0,L="";switch(e.title){case"满贯":L="gameend_manguan",E=214;break;case"跳满":L="gameend_tiaoman",E=214;break;case"倍满":L="gameend_beiman",E=201;break;case"三倍满":L="gameend_sanbeiman",E=201;break;case"累积役满":L="gameend_leijiyiman",T=2,E=226;break;case"役满":L="gameend_yiman1",T=1,E=226;break;case"两倍役满":L="gameend_yiman2",T=2,E=226;break;case"三倍役满":L="gameend_yiman3",T=2,E=226;break;case"四倍役满":L="gameend_yiman4",T=2,E=226;break;case"五倍役满":L="gameend_yiman5",T=2,E=226;break;case"六倍役满":case"七倍役满":case"八倍役满":case"九倍役满":L="gameend_yiman6",T=2,E=226}var D=game.Tools.get_chara_audio(i,L);Laya.timer.once(w,this,function(){t.setTitle(e.title),t.container_title.visible=!0,t.container_title.alpha=0,t.container_title.scaleX=t.container_title.scaleY=3,Laya.Tween.to(t.container_title,{alpha:1,scaleX:1.2,scaleY:1.2},300,Laya.Ease.strongIn),Laya.timer.once(300,t,function(){0!=E&&view.AudioMgr.PlayAudio(E)}),D&&Laya.timer.once(500,t,function(){view.AudioMgr.PlaySound(D.path,D.volume)}),0!=T&&Laya.timer.once(300,t,function(){var e,i;1==T?(e=t.root.getChildByName("effect_yiman"),i="scene/effect_yiman.lh"):(e=t.root.getChildByName("effect_yiman2"),i="scene/effect_yiman2.lh"),t.effect_yiman=game.FrontEffect.Inst.create_ui_effect(e,i,new Laya.Point(0,0),25)})}),(e.yiman||"累积役满"==e.title)&&(w+=500)}this.btn_confirm.visible=!1,w+=300,this.btn_confirm.disabled=!0,Laya.timer.once(w,this,function(){t.btn_confirm.visible=!0,t.btn_confirm.alpha=1,Laya.Tween.from(t.btn_confirm,{alpha:0},200),t.btn_confirm.disabled=!1;for(var e=function(e){Laya.timer.once(1e3*e,t,function(){t.btn_confirm.disabled||(t.count_down.text="("+(3-e).toString()+")")})},i=0;i<3;i++)e(i);Laya.timer.once(3e3,t,function(){t.btn_confirm.disabled||t.onConfirm()})})},n.prototype._showInfo_record=function(e){this.root.alpha=0,Laya.Tween.to(this.root,{alpha:1},300);this.label_winner_name.text=view.DesktopMgr.Inst.player_datas[e.seat].nickname,game.Tools.charaPart(view.DesktopMgr.Inst.player_datas[e.seat].avatar_id,this.illust,"full",this.illust_rect),2==e.mode?this.img_mode.visible=!1:(this.img_mode.visible=!0,0==e.mode?this.img_mode.skin="myres/mjdesktop/pg_zimo.png":this.img_mode.skin="myres/mjdesktop/pg_he.png");for(var t="myres2/mjp/"+GameMgr.Inst.mjp_view+"/ui/",i=this.img_hands[0].width,n=.5*i,a=0;a<this.img_hands.length;a++)this.img_hands[a].visible=!1;for(var r=0,o=0,a=0;a<e.hand.length;a++)this.img_hands[r].skin=t+e.hand[a]+".png",this.img_hands[r].x=o,this.img_hands[r].y=0,o+=i,this.img_hands[r].visible=!0,r++;if(e.ming&&e.ming.length>0){o+=n;for(a=0;a<e.ming.length;a++){var s=e.ming[a];if(")"!=s.charAt(s.length-1)){if(1==(l=s.split("|")).length){u=l[0].charAt(1);"0"==(p=l[0].charAt(0))&&(p="5");for(f=0;f<4;f++){y="";y=0==f||3==f?"back":1==f&&"5"==p&&"z"!=u?"0"+u:p+u,this.img_hands[r].skin=t+y+".png",this.img_hands[r].x=o,this.img_hands[r].y=0,o+=i,this.img_hands[r].visible=!0,r++}}else for(f=0;f<l.length;f++){y=l[f].toString();this.img_hands[r].skin=t+y+".png",this.img_hands[r].x=o,this.img_hands[r].y=0,o+=i,this.img_hands[r].visible=!0,r++}}else{for(var h="",l=[],c=0;c<s.length;c++)if("("==s.charAt(c)){h=s.substring(0,c),l=s.substring(c+1,s.length-1).split(",");break}if("angang"==h){for(var p=l[0].charAt(0),u=l[0].charAt(1),d=0,_=0;_<l.length;_++)"0"==l[_].charAt(0)&&d++;d>0&&(p="5");for(var m=0;m<l.length;m++){y="";y=0==m||3==m?"back":m<=d?"0"+u:p+u,this.img_hands[r].skin=t+y+".png",this.img_hands[r].x=o,this.img_hands[r].y=0,o+=i,this.img_hands[r].visible=!0,r++}}else for(var f=0;f<l.length;f++){y=l[f];this.img_hands[r].skin=t+y+".png",this.img_hands[r].x=o,this.img_hands[r].y=0,o+=i,this.img_hands[r].visible=!0,r++}}}}o+=n,2!=e.mode&&(this.img_hands[r].skin=t+e.hupai+".png",this.img_hands[r].x=o,this.img_hands[r].y=0,o+=i,this.img_hands[r].visible=!0,r++);var g=(.72-.92)*(r-14)/4+.92;this.container_hand.scaleX=this.container_hand.scaleY=g;for(a=0;a<5;a++){y="back";a<e.doras.length&&(y=e.doras[a]),this.img_doras[a].skin=t+y+".png",this.img_doras[a].x=a*i,this.img_doras[a].y=0}if(e.lidoras&&2!=e.mode){this.container_lidora.visible=!0;for(a=0;a<5;a++){y="back";a<e.lidoras.length&&(y=e.lidoras[a]),this.img_lidoras[a].skin=t+y+".png",this.img_lidoras[a].x=a*i,this.img_lidoras[a].y=0}}else{this.container_lidora.visible=!0;for(a=0;a<5;a++){var y="back";this.img_lidoras[a].skin=t+y+".png",this.img_lidoras[a].x=a*i,this.img_lidoras[a].y=0}}var v=e.fan_names.length;this.container_fan_yiman.visible=!1,this.container_fan_8.visible=!1,this.container_fan_15.visible=!1,this.container_fan_12.visible=!1,this.container_fan_liuju.visible=!1,this.container_fan_yiman.visible=!1,this.container_fan_8.visible=!1,this.container_fan_15.visible=!1,this.container_fan_12.visible=!1,this.container_fan_liuju.visible=!1;var x=null;(x=2==e.mode?this.container_fan_liuju:e.yiman?this.container_fan_yiman:v<=8?this.container_fan_8:v<=12?this.container_fan_12:this.container_fan_15).visible=!0;for(a=0;a<x.numChildren;a++)x.getChildAt(a).visible=!1;for(var b=[],w=function(t){var i=e.fan_names[t],n=0;cfg.fan.fan.forEach(function(e){e.name==i&&(n=e.show_index)});var a={name:i,index:n};e.fan_value&&e.fan_value.length>t&&(a.value=e.fan_value[t]),b.push(a)},a=0;a<e.fan_names.length;a++)w(a);b=b.sort(function(e,t){return e.index-t.index});for(a=0;a<v&&a<x.numChildren;a++){var S=x.getChildAt(a);if(S.getChildByName("l_name").text=b[a].name,void 0!==b[a].value&&null!==b[a].value){S.getChildAt(2).visible=!0;var I=b[a].value.toString();2==I.length?(S.getChildAt(3).skin="myres/mjdesktop/h_"+I[1]+".png",S.getChildAt(3).visible=!0,S.getChildAt(4).skin="myres/mjdesktop/h_"+I[0]+".png",S.getChildAt(4).visible=!0):(S.getChildAt(3).skin="myres/mjdesktop/h_"+I[0]+".png",S.getChildAt(3).visible=!0,S.getChildAt(4).visible=!1)}S.visible=!0}this.container_fan.visible=!1,this.container_fu.visible=!1,this.img_yiman.visible=!1,e.fan&&e.fu?this.setFanFu(e.fan,e.fu):e.yiman&&(this.img_yiman.alpha=0,this.img_yiman.visible=!0,Laya.Tween.to(this.img_yiman,{alpha:1},200));for(a=0;a<this.score_imgs.length;a++)this.score_imgs[a].visible=!1;for(var M=e.score.toString(),a=0;a<M.length&&!(a>=this.score_imgs.length);a++)this.score_imgs[a].skin="myres/mjdesktop/ww_"+M.charAt(M.length-1-a)+".png",this.score_imgs[a].visible=!0;this.container_score.alpha=1,this.container_score.scaleX=this.container_score.scaleY=1.2,this.container_title.visible=!1,null==e.title||void 0==e.title||""==e.title||(this.setTitle(e.title),this.container_title.visible=!0,this.container_title.alpha=1,this.container_title.scaleX=this.container_title.scaleY=1.2),this.count_down.text="",this.btn_confirm.visible=!0,this.btn_confirm.disabled=!1,this.btn_confirm.alpha=1},n.prototype._showHule=function(e){var i=new t;if(i.seat=e.seat,i.hand=e.hand,e.ming&&(i.ming=e.ming),i.hupai=e.hu_tile,i.mode=e.zimo?0:1,i.fan_names=[],e.yiman){for(var n=e.fans,a=0;a<n.length;a++)i.fan_names.push(n[a].name);i.fan=0,i.fu=0,i.yiman=!0}else{i.fan_value=[];for(var n=e.fans,a=0;a<n.length;a++)i.fan_names.push(n[a].name),i.fan_value.push(n[a].val);i.fan=e.count,i.fu=e.fu,i.yiman=!1}var r=0;r=e.zimo?e.qinjia?3*e.point_zimo_xian:e.point_zimo_qin+2*e.point_zimo_xian:e.point_rong,i.score=r,e.title&&""!=e.title&&(i.title=e.title),i.doras=e.doras,e.liqi&&(i.lidoras=e.li_doras),view.DesktopMgr.Inst.mode==view.EMJMode.play?this._showInfo_mj(i):view.DesktopMgr.Inst.mode==view.EMJMode.paipu?(1&view.DesktopMgr.Inst.paipu_config)>0?this._showInfo_mj(i):this._showInfo_record(i):view.DesktopMgr.Inst.mode==view.EMJMode.live_broadcast&&this._showInfo_mj(i)},n.prototype._showLiuJuManGuan=function(e){var i=new t;i.seat=e.seat,i.hand=e.hand,i.ming=e.ming,i.mode=2,i.fan_names=["流局满贯"],i.fan=i.fu=0,i.score=e.score,i.title="满贯",i.doras=e.doras,i.yiman=!1,view.DesktopMgr.Inst.mode==view.EMJMode.play?this._showInfo_mj(i):view.DesktopMgr.Inst.mode==view.EMJMode.paipu?this._showInfo_record(i):view.DesktopMgr.Inst.mode==view.EMJMode.live_broadcast&&this._showInfo_mj(i)},n.prototype.onDisable=function(){Laya.timer.clearAll(this)},n}(e.UIBase);e.UI_Win=i}(uiscript||(uiscript={}));var GameMgr=function(){function e(){var t=this;this.stage=null,this.uimgr=null,this.root_ui=null,this.root_scene=null,this.root_front_scene_effect=null,this.root_front_effect=null,this.logined=!1,this.link_url="",this.account="",this.password="",this.sociotype=0,this.player_name="",this.access_token="",this.account_id=-1,this.account_setting={},this.account_data=null,this.account_numerical_resource=null,this.player_in_haiwai=!1,this.commonview_slot={},this.mjp_view="",this.mj_server_url="",this.mj_game_token="",this.mj_game_uuid="",this.ingame=!1,this.beinvited_roomid=-1,this.outsee_paipuid="",this.custom_match_id=0,this.account_refresh_time=0,this._current_scene=null,this._scene_lobby=null,this._scene_mj=null,this.duringPaipu=!1,this._statisticinfo={},this._last_heatbeat_time=0,this._pre_mouse_point=new Laya.Point(0,0),this._fastin=!1,this.comment_allow=0,this.server_time_delta=0,e.Inst=this,e._inRelease=!!Laya.Browser.window.conch||(!document.getElementById("environment")||"dev"!=document.getElementById("environment").innerText),Laya3D.init(1920,1080,!0),Laya.stage.scaleMode=Laya.Stage.SCALE_SHOWALL,Laya.Browser.onMobile?Laya.stage.screenMode=Laya.Stage.SCREEN_HORIZONTAL:Laya.stage.screenMode=Laya.Stage.SCREEN_NONE,Laya.stage.alignH=Laya.Stage.ALIGN_CENTER,Laya.stage.alignV=Laya.Stage.ALIGN_MIDDLE,Laya.stage.bgColor="#000000",e._inRelease||Laya.Stat.show(),this.pendinglink()?Laya.Browser.window.location.href=this.link_url:(this.init(),this.load0(),this._statisticinfo={},Laya.timer.loop(1e4,this,function(){if(game.LobbyNetMgr.Inst.connect_state==game.EConnectState.connecting){var e=[];for(var i in t._statisticinfo)e.push({key:parseInt(i),value:t._statisticinfo[i]});e.length>0&&(app.NetAgent.sendReq2Lobby("Lobby","plusWorldClientStatistic",{datas:e},function(e,t){}),t._statisticinfo={})}},null,!1))}return Object.defineProperty(e,"inRelease",{get:function(){return this._inRelease},enumerable:!0,configurable:!0}),Object.defineProperty(e,"inConch",{get:function(){return Laya.Browser.window.conch},enumerable:!0,configurable:!0}),Object.defineProperty(e,"iniOSWebview",{get:function(){return Laya.Browser.window.wkbridge},enumerable:!0,configurable:!0}),Object.defineProperty(e,"inHttps",{get:function(){return this.iniOSWebview||"https:"==Laya.Browser.window.location.protocol},enumerable:!0,configurable:!0}),Object.defineProperty(e,"inChina",{get:function(){return this._in_china},enumerable:!0,configurable:!0}),Object.defineProperty(e,"inGooglePlay",{get:function(){return this._in_google_play},enumerable:!0,configurable:!0}),e.encodeP=function(e){return CryptoJS.HmacSHA256(e,"lailai").toString()},e.prototype.init=function(){var t=Laya.LocalStorage.getItem("fpsmode");t&&""!=t||(t=!Laya.Browser.onMobile||e.inConch||e.iniOSWebview?"fast":"slow",Laya.LocalStorage.setItem("fpsmode",t)),Laya.stage.frameRate=t;var i=Laya.LocalStorage.getItem("dddddcv");if(i&&""!=i||(i=game.Tools.generateUUID(),Laya.LocalStorage.setItem("dddddcv",i)),e.device_id=i,!e.inConch){var n=document.documentElement;n.requestFullscreen?n.requestFullscreen():n.webkitRequestFullscreen&&n.webkitRequestFullscreen()}Laya.Browser.window.onerror=this.handleWindowError,this.root_scene=new Laya.Sprite,this.root_ui=new Laya.Sprite,this.root_front_effect=new Laya.Sprite,Laya.stage.addChild(this.root_scene),Laya.stage.addChild(this.root_ui),Laya.stage.addChild(this.root_front_effect),this.logined=!1,this._current_scene=null,this.duringPaipu=!1,this._scene_lobby=new game.Scene_Lobby,this._scene_mj=new game.Scene_MJ,view.AudioMgr.init();var a=Laya.LocalStorage.getItem("click_prefer");view.DesktopMgr.click_prefer=a&&"1"==a?1:0;var r=Laya.LocalStorage.getItem("double_click_pass");view.DesktopMgr.double_click_pass=r&&"1"==r?1:0;var o=Laya.LocalStorage.getItem("_pre_room");o&&""!=o&&(this.beinvited_roomid=parseInt(o)),this.outsee_paipuid=Laya.LocalStorage.getItem("_pre_paipu"),this.outsee_paipuid||(this.outsee_paipuid="");(s=Laya.LocalStorage.getItem("_pre_st"))&&""!=s&&(this._fastin=!0,Laya.LocalStorage.setItem("_pre_sociotype",s),Laya.LocalStorage.setItem("_pre_st",""));var s=Laya.LocalStorage.getItem("_pre_xdsfdl");s&&""!=s&&(this._fastin=!0,Laya.LocalStorage.setItem("_pre_sociotype",s),Laya.LocalStorage.setItem("_pre_xdsfdl",""));var h=Laya.LocalStorage.getItem("_pre_state");if(h&&""!=h&&"xdsfdl3"==h&&(this._fastin=!0,Laya.LocalStorage.setItem("_pre_sociotype","3"),Laya.LocalStorage.setItem("_pre_st","")),Laya.LocalStorage.setItem("_pre_state",""),Laya.Browser.window.conch){var l=Laya.PlatformClass.createClass("layaair.majsoul.mjmgr"),c=l.newObject();c.callWithBack(function(e){var t=JSON.parse(e);t.type&&(this._fastin=!0,Laya.LocalStorage.setItem("_pre_sociotype",t.type),Laya.LocalStorage.setItem("_pre_code",t.code)),Laya.LocalStorage.setItem("_pre_st","")},"getSocioCode"),l.call("clearSocioCode"),l.call("initWXPay","wxa81767d38cb2f4ff"),c.callWithBack(function(t){e._in_china=!0,"ingoogleplay"==t&&(e._in_google_play=!0,e._in_china=!1)},"getAppConfig")}},e.prototype.load0=function(){var t=this;window&&window.conch&&window.loadingView.loading(30),e.iniOSWebview&&Laya.Browser.window.wkbridge.callNative("setloadrate","30",function(){}),game.ResourceVersion.init(Laya.Handler.create(this,function(){console.log("resource version 加载成功"),window&&window.conch&&window.loadingView.loading(40),e.iniOSWebview&&Laya.Browser.window.wkbridge.callNative("setloadrate","40",function(){}),Laya.loader.create("res/atlas/bitmapfont.atlas",Laya.Handler.create(t,function(){for(var i=["fengyu","hanyi","haolong","youyuan","youyuan_bold"],n=0,a=function(a){var r=new Laya.BitmapFont;r.loadFont("bitmapfont/"+i[a]+".fnt",Laya.Handler.create(t,function(){r.setSpaceWidth(10),Laya.Text.registerBitmapFont(i[a],r),n++,window&&window.conch&&window.loadingView.loading(Math.floor(40+n/i.length*20)),e.iniOSWebview&&Laya.Browser.window.wkbridge.callNative("setloadrate",Math.floor(40+n/i.length*20).toString(),function(){}),n==i.length&&(console.log("字体加载结束"),Laya.timer.frameOnce(2,t,t.load1))}))},r=0;r<i.length;r++)a(r)}))}))},e.prototype.load1=function(){var t=this;game.LoadMgr.httpload("config.json","json",!0,Laya.Handler.create(this,function(i){if(window&&window.conch&&window.loadingView.loading(70),e.iniOSWebview&&Laya.Browser.window.wkbridge.callNative("setloadrate","70",function(){}),i.success){var n=i.data;e.config_data=n,Laya.loader.load("res/proto/liqi.json",new Laya.Handler(t,function(){window&&window.conch&&window.loadingView.loading(80),e.iniOSWebview&&Laya.Browser.window.wkbridge.callNative("setloadrate","80",function(){});var i=Laya.loader.getRes("res/proto/liqi.json");i?(net.ProtobufManager.loadProto(i),net.MessageWrapper.initWrapper(),app.NetAgent.init(),window&&window.conch&&window.loadingView.loading(85),e.iniOSWebview&&Laya.Browser.window.wkbridge.callNative("setloadrate","85",function(){}),(new caps.ShaderInitor).init(Laya.Handler.create(t,function(){window&&window.conch&&window.loadingView.loading(100),e.iniOSWebview&&Laya.Browser.window.wkbridge.callNative("setloadrate","100",function(){}),t.initUIRoot()}))):console.error("load protobuf failed: liqiDescriptor is null")}))}else app.Log.Error("未找到配置文件：config.json")}))},e.prototype.loadExcel=function(e){var t=this;Laya.loader.load("res/proto/config.proto",new Laya.Handler(this,function(){uiscript.UI_Remind.Inst&&uiscript.UI_Remind.Inst.setprocess(1);Laya.loader.load("res/config/lqc.lqbin",new Laya.Handler(t,function(){uiscript.UI_Remind.Inst&&uiscript.UI_Remind.Inst.setprocess(2);var t=Laya.loader.getRes("res/proto/config.proto");if(t){uiscript.UI_Remind.Inst&&uiscript.UI_Remind.Inst.setprocess(3);var i=Laya.loader.getRes("res/config/lqc.lqbin");if(i){uiscript.UI_Remind.Inst&&uiscript.UI_Remind.Inst.setprocess(4);var n=new Laya.Byte;n.writeArrayBuffer(i);var a=new bin.BinParser;a.parseSync(t,n.getUint8Array(0,n.length)),uiscript.UI_Remind.Inst&&uiscript.UI_Remind.Inst.setprocess(5);var r=new bin.TSDataFormat(a.exportSchema(),a.exportData());cfg.load(r.toFormat()),uiscript.UI_Remind.Inst&&uiscript.UI_Remind.Inst.setprocess(6),e&&e.run()}else console.error("load bincontent failed: bindata is null")}else console.error("load configProto failed: configProto is null")}),null,Laya.Loader.BUFFER)}))},e.prototype.pendinglink=function(){var t=Laya.Browser.window.location.href;if(!e.inConch&&e.inRelease&&-1==t.indexOf("union-game")&&-1!=t.indexOf("majsoul")){var i=Laya.LocalStorage.getItem("_pre_sociotype"),n=Laya.LocalStorage.getItem("ssssoooodd"),a=Laya.LocalStorage.getItem("account"),r=Laya.LocalStorage.getItem("password"),o=!1;return-1==t.indexOf("?")?(t="http://majsoul.union-game.com/0/",o=!0):t="http://majsoul.union-game.com/0/"+t.substr(t.indexOf("?")),i&&""!=i&&(t+=o?"?":"&",o=!1,t+="mv_sociotype="+game.Tools.encode_str(i)),n&&""!=n&&(t+=o?"?":"&",o=!1,t+="mv_ssoodd="+game.Tools.encode_str(n)),a&&""!=a&&(t+=o?"?":"&",o=!1,t+="mv_at="+game.Tools.encode_str(a)),r&&""!=r&&(t+=o?"?":"&",o=!1,t+="mv_pd="+game.Tools.encode_str(r)),Laya.LocalStorage.setItem("mved","1"),Laya.LocalStorage.setItem("_pre_sociotype",""),Laya.LocalStorage.setItem("ssssoooodd",""),Laya.LocalStorage.setItem("account",""),Laya.LocalStorage.setItem("password",""),Laya.Browser.window.location.href=t,!1}var s={};if(t){var h=t.indexOf("?");if(h>=0){this.link_url=t.substring(0,h);for(var l=t.substring(h+1,t.length).split("&"),c=0;c<l.length;c++)if((h=l[c].indexOf("="))>0){var p=l[c].substring(0,h),u=l[c].substring(h+1,l[c].length);s[p]=u}}else this.beinvited_roomid=-1,this.outsee_paipuid="",this.link_url=t}var d=!1;for(var _ in s){if("mv_"==_.substr(0,3))switch(_){case"mv_sociotype":Laya.LocalStorage.setItem("_pre_sociotype",game.Tools.decode_str(s[_]));case"mv_ssoodd":Laya.LocalStorage.setItem("ssssoooodd",game.Tools.decode_str(s[_]));case"mv_at":Laya.LocalStorage.setItem("account",game.Tools.decode_str(s[_]));case"mv_pd":Laya.LocalStorage.setItem("password",game.Tools.decode_str(s[_]))}else Laya.LocalStorage.setItem("_pre_"+_,s[_]);d=!0}return d},e.prototype.addScene=function(e){this.root_scene.addChild(e)},e.prototype.addUI=function(e){this.root_ui.addChild(e)},e.prototype.initUIRoot=function(){if(this.uimgr=new uiscript.UIMgr,this.uimgr.init(),e.iniOSWebview){var t=this;Laya.Browser.window.wkbridge.callNative("getappversion","",function(e){game.LoadMgr.httpload("iOSver","text",!0,Laya.Handler.create(t,function(i){Laya.Browser.window.wkbridge.callNative("closeloadview","",function(){}),i.success?parseInt(e)<parseInt(i.data)?uiscript.UI_IOS_Webview_Update.show("iOS有新的更新版本，请前去官网下载"):t.showEntrance():uiscript.UI_IOS_Webview_Update.show("获取版本信息失败，请检查网络")}))})}else this.showEntrance()},e.prototype.showEntrance=function(){var e=this;uiscript.UI_ChooseServer.show(Laya.Handler.create(this,function(){if(e._fastin)e.loadExcel(Laya.Handler.create(e,function(){game.LoadMgr.loadRes(game.E_LoadType.entrance,Laya.Handler.create(e,function(){e.uimgr.showEntrance(),game.LoadMgr.loadConfig(),e._scene_lobby.init(null)}))}));else{e.uimgr.showRemind();var t=Laya.timer.currTimer;e.loadExcel(Laya.Handler.create(e,function(){uiscript.UI_Remind.Inst&&uiscript.UI_Remind.Inst.setprocess(7),game.LoadMgr.loadRes(game.E_LoadType.entrance,Laya.Handler.create(e,function(){uiscript.UI_Remind.Inst&&uiscript.UI_Remind.Inst.setprocess(8);var i=t+3e3-Laya.timer.currTimer;i<=60&&(i=60),Laya.timer.once(i,e,function(){uiscript.UI_Remind.Inst&&uiscript.UI_Remind.Inst.setprocess(9),e.uimgr.showEntrance(),game.LoadMgr.loadConfig(),e._scene_lobby.init(null)})}))}))}}))},e.prototype.fetch_login_info=function(){var e=this;game.FriendMgr.init(),uiscript.UI_Mail.Init(),uiscript.UI_Activity_Xuanshang.Init(),uiscript.UI_Activity_Jiuji.Init(),uiscript.UI_TitleBook.Init(),uiscript.UI_Bag.init(),uiscript.UI_Shop.init(),app.NetAgent.sendReq2Lobby("Lobby","fetchCommentSetting",{},function(t,i){t||i.error?uiscript.UIMgr.Inst.showNetReqError("fetchCommentSetting",t,i):e.comment_allow=i.comment_allow}),this.commonview_slot={},app.NetAgent.sendReq2Lobby("Lobby","fetchCommonView",{},function(t,i){if(t||i.error)uiscript.UIMgr.Inst.showNetReqError("fetchCommonView",t,i);else{if(i.slots)for(var n=0;n<i.slots.length;n++)e.commonview_slot[i.slots[n].slot]=i.slots[n].value;var a=0;e.commonview_slot.hasOwnProperty(game.ECommonView.mjp.toString())&&(a=e.commonview_slot[game.ECommonView.mjp.toString()]),e.load_mjp_view(a)}}),app.NetAgent.sendReq2Lobby("Lobby","fetchAccountSettings",{},function(t,i){if(t||i.error);else if(e.account_setting=[],i.settings)for(var n=0;n<i.settings.length;n++)e.account_setting[i.settings[n].key]=i.settings[n].value}),this.last_mod_name_time=0,app.NetAgent.sendReq2Lobby("Lobby","fetchModNicknameTime",{},function(t,i){t||i.error||i.last_mod_time&&(e.last_mod_name_time=i.last_mod_time)}),app.NetAgent.sendReq2Lobby("Lobby","fetchMisc",{},function(e,t){if(e||t.error)cfg.mall.goods.forEach(function(e){uiscript.UI_Recharge.new_recharge_list[e.cny]=1});else{if(t.recharged_list)for(var i=0;i<t.recharged_list.length;i++)uiscript.UI_Recharge.new_recharge_list[t.recharged_list[i]]=1;t.chests&&uiscript.UI_Treasure.on_chest_count_change(t.chests)}}),app.NetAgent.sendReq2Lobby("Lobby","fetchIDCardInfo",{},function(t,i){t||i.error?uiscript.UI_ShiMingRenZheng.renzhenged=!1:"CN"==i.country?(e.player_in_haiwai=!1,uiscript.UI_ShiMingRenZheng.renzhenged=i.is_authed):(e.player_in_haiwai=!0,uiscript.UI_ShiMingRenZheng.renzhenged=!0)})},e.prototype.gameInit=function(){var e=this;app.NetAgent.sendReq2Lobby("Lobby","fetchServerTime",{},function(t,i){t||i.error?uiscript.UIMgr.Inst.showNetReqError("fetchServerTime",t,i):e.server_time_delta=1e3*i.server_time-Laya.timer.currTimer}),app.NetAgent.sendReq2Lobby("Lobby","fetchServerSettings",{},function(e,t){if(e||t.error)uiscript.UIMgr.Inst.showNetReqError("fetchServerSettings",e,t);else if(uiscript.UI_Recharge.open_payment=!1,uiscript.UI_Recharge.payment_info="",uiscript.UI_Recharge.open_wx=!0,uiscript.UI_Recharge.wx_type=0,uiscript.UI_Recharge.open_alipay=!0,uiscript.UI_Recharge.alipay_type=0,t.settings&&t.settings.payment_setting){var i=t.settings.payment_setting;i.open_payment&&(uiscript.UI_Recharge.open_payment=!0),null!=i.payment_info_show_type&&(uiscript.UI_Recharge.payment_info_show_type=i.payment_info_show_type),null!=i.payment_info&&(uiscript.UI_Recharge.payment_info=i.payment_info),i.wechat&&(i.wechat.disable_create&&(uiscript.UI_Recharge.open_wx=!1),null!=i.wechat.payment_source_platform&&(uiscript.UI_Recharge.wx_type=i.wechat.payment_source_platform)),i.alipay&&(i.alipay.disable_create&&(uiscript.UI_Recharge.open_alipay=!1),null!=i.alipay.payment_source_platform&&(uiscript.UI_Recharge.alipay_type=i.alipay.payment_source_platform))}}),this.account_data.nickname&&this.fetch_login_info(),uiscript.UI_Info.Init(),app.NetAgent.AddListener2Lobby("NotifyAccountUpdate",Laya.Handler.create(this,function(t){var i=t.update;if(i){if(i.numerical)for(var n=0;n<i.numerical.length;n++){var a=i.numerical[n].id,r=i.numerical[n].final;switch(a){case 100001:e.account_data.diamond=r;break;case 100002:e.account_data.gold=r;break;case 100099:e.account_data.vip=r}(a>=101001||a<=101999)&&(e.account_numerical_resource[a]=r)}uiscript.UI_Sushe.on_data_updata(i),i.daily_task&&uiscript.UI_Activity_Xuanshang.dataUpdate(i.daily_task),i.title&&uiscript.UI_TitleBook.addTitle(i.title),i.new_recharged_list&&uiscript.UI_Recharge.on_new_recharge_refresh(i)}},null,!1)),app.NetAgent.AddListener2Lobby("NotifyAnotherLogin",Laya.Handler.create(this,function(e){uiscript.UI_AnotherLogin.Inst.show()})),app.NetAgent.AddListener2Lobby("NotifyAccountLogout",Laya.Handler.create(this,function(e){uiscript.UI_Hanguplogout.Inst.show()})),app.NetAgent.AddListener2Lobby("NotifyClientMessage",Laya.Handler.create(this,function(e){app.Log.log("收到消息："+JSON.stringify(e)),e.type==game.EFriendMsgType.room_invite&&uiscript.UI_Invite.onNewInvite(e.content)})),app.NetAgent.AddListener2Lobby("NotifyServerSetting",Laya.Handler.create(this,function(e){if(uiscript.UI_Recharge.open_payment=!1,uiscript.UI_Recharge.payment_info="",uiscript.UI_Recharge.open_wx=!0,uiscript.UI_Recharge.wx_type=0,uiscript.UI_Recharge.open_alipay=!0,uiscript.UI_Recharge.alipay_type=0,e.settings&&e.settings.payment_setting){var t=e.settings.payment_setting;t.open_payment&&(uiscript.UI_Recharge.open_payment=!0),null!=t.payment_info_show_type&&(uiscript.UI_Recharge.payment_info_show_type=t.payment_info_show_type),null!=t.payment_info&&(uiscript.UI_Recharge.payment_info=t.payment_info),t.wechat&&(t.wechat.disable_create&&(uiscript.UI_Recharge.open_wx=!1),null!=t.wechat.payment_source_platform&&(uiscript.UI_Recharge.wx_type=t.wechat.payment_source_platform)),t.alipay&&(t.alipay.disable_create&&(uiscript.UI_Recharge.open_alipay=!1),null!=t.alipay.payment_source_platform&&(uiscript.UI_Recharge.alipay_type=t.alipay.payment_source_platform))}})),app.NetAgent.AddListener2Lobby("NotifyVipLevelChange",Laya.Handler.create(this,function(e){uiscript.UI_Sushe.send_gift_limit=e.gift_limit,game.FriendMgr.friend_max_count=e.friend_max_count,uiscript.UI_Shop.shopinfo.zhp.free_refresh.limit=e.zhp_free_refresh_limit,uiscript.UI_Shop.shopinfo.zhp.cost_refresh.limit=e.zhp_cost_refresh_limit})),Laya.timer.loop(36e4,this,function(){if(game.LobbyNetMgr.Inst.isOK){var t=(Laya.timer.currTimer-e._last_heatbeat_time)/1e3;app.NetAgent.sendReq2Lobby("Lobby","heatbeat",{no_operation_counter:t},function(){}),t>=3e3&&uiscript.UI_Hanguplogout.Inst.show()}}),Laya.timer.loop(1e3,this,function(){var t=Laya.stage.getMousePoint();t.x==e._pre_mouse_point.x&&t.y==e._pre_mouse_point.y||(e.clientHeatBeat(),e._pre_mouse_point.x=t.x,e._pre_mouse_point.y=t.y)}),Laya.timer.loop(1e3,this,function(){Laya.LocalStorage.setItem("dolllt",game.Tools.currentTime.toString())})},e.prototype.afterLogin=function(){var e=this;this.gameInit(),this.logined=!0;Laya.LocalStorage.setItem("_pre_room",""),Laya.LocalStorage.setItem("_pre_paipu",""),this._scene_lobby.addLoadListenter(Laya.Handler.create(this,function(){game.FrontEffect.init(),uiscript.UI_Sushe.init(Laya.Handler.create(e,function(){uiscript.UI_Loading.Inst.setProgressVal(1),Laya.timer.once(500,e,function(){e.EnterLobby()})}))}),Laya.Handler.create(this,function(e){return uiscript.UI_Loading.Inst.setProgressVal(.2+.7*e)},null,!1))},e.prototype.updateAccountInfo=function(){var t=this;app.NetAgent.sendReq2Lobby("Lobby","fetchAccountInfo",{},function(i,n){if(i||n.error)uiscript.UIMgr.Inst.showNetReqError("fetchAccountInfo",i,n);else{app.Log.log("UpdateAccount: "+JSON.stringify(n)),e.Inst.account_refresh_time=Laya.timer.currTimer;for(var a in n.account)if(e.Inst.account_data[a]=n.account[a],"platform_diamond"==a)for(var r=n.account[a],o=0;o<r.length;o++)t.account_numerical_resource[r[o].id]=r[o].count;uiscript.UI_Lobby.Inst.refreshInfo(),n.account.room_id&&e.Inst.updateRoom()}})},e.prototype.updateRoom=function(){app.NetAgent.sendReq2Lobby("Lobby","fetchRoom",{},function(e,t){e||t.error?uiscript.UIMgr.Inst.showNetReqError("fetchRoom",e,t):uiscript.UI_WaitingRoom.Inst.updateData(t.room)})},e.prototype.EnterMJ=function(){this._current_scene!==this._scene_mj&&(this._current_scene&&(this._current_scene.active=!1),this._current_scene=this._scene_mj,this._current_scene.active=!0)},e.prototype.EnterLobby=function(){var e=this;this._current_scene!==this._scene_lobby?(this._current_scene&&(this._current_scene.active=!1),this._current_scene=this._scene_lobby,uiscript.UI_Loading.Inst.show("enter_lobby"),this._scene_lobby.buildScene(Laya.Handler.create(this,function(){uiscript.UI_Loading.Inst.close(),e._current_scene.active=!0,game.Scene_MJ.Inst.load_common_texture2d()}),Laya.Handler.create(this,function(e){return uiscript.UI_Loading.Inst.setProgressVal(e)},null,!1))):(uiscript.UI_Loading.Inst.close(),this._current_scene.active=!0)},e.prototype.checkPaiPu=function(e,t,i){var n=this;app.Log.log("checkPaiPu game_uuid:"+e+" account_id:"+t.toString()+" paipu_config:"+i),this.duringPaipu?app.Log.Error("已经在看牌谱了"):(this.duringPaipu=!0,uiscript.UI_Loading.Inst.show("enter_mj"),app.NetAgent.sendReq2Lobby("Lobby","fetchGameRecord",{game_uuid:e},function(e,a){if(e||a.error)uiscript.UIMgr.Inst.showNetReqError("fetchGameRecord",e,a),uiscript.UI_Loading.Inst.close(null),uiscript.UIMgr.Inst.showLobby(),n.duringPaipu=!1;else{uiscript.UI_Loading.Inst.setProgressVal(.1);var r=a.record,o=[null,null,null,null],s="电脑(简单)",h=r.config.mode;h.extendinfo&&(s="电脑(普通)"),h.detail_rule&&h.detail_rule.ai_level&&(1===h.detail_rule.ai_level&&(s="电脑(简单)"),2===h.detail_rule.ai_level&&(s="电脑(普通)"));for(c=0;c<r.accounts.length;c++){var l=r.accounts[c];l.character?o[l.seat]=l:(l.character={charid:l.avatar_id,level:0,exp:0,views:[],skin:cfg.item_definition.character.get(l.avatar_id).init_skin,is_upgraded:!1},l.avatar_id=l.character.skin,o[l.seat]=l)}for(var c=0;c<o.length;c++)null==o[c]&&(o[c]={nickname:s,avatar_id:400101,level:{id:10101},character:{charid:200001,level:0,exp:0,views:[],skin:400101,is_upgraded:!1}});game.Scene_MJ.Inst.openMJRoom(o,Laya.Handler.create(n,function(){n.duringPaipu=!1,view.DesktopMgr.Inst.initRoom(r.config,o,t,view.EMJMode.paipu),view.DesktopMgr.Inst.paipu_config=i,uiscript.UI_Replay.Inst.initData(a),uiscript.UI_Replay.Inst.enable=!0,Laya.timer.once(1e3,n,function(){n.EnterMJ()}),Laya.timer.once(1500,n,function(){view.DesktopMgr.player_link_state=[view.ELink_State.READY,view.ELink_State.READY,view.ELink_State.READY,view.ELink_State.READY],uiscript.UI_DesktopInfo.Inst.refreshLinks(),uiscript.UI_Loading.Inst.close()}),Laya.timer.once(1e3,n,function(){uiscript.UI_Replay.Inst.nextStep(!0)})}),Laya.Handler.create(n,function(e){return uiscript.UI_Loading.Inst.setProgressVal(.1+.9*e)},null,!1))}}))},e.prototype.BehavioralStatistics=function(e,t){void 0===t&&(t=1);var i=e.toString();this._statisticinfo.hasOwnProperty[i]||(this._statisticinfo[i]=0),this._statisticinfo[i]+=t},e.prototype.clientHeatBeat=function(){(Laya.timer.currTimer-this._last_heatbeat_time)/1e3>2400&&game.LobbyNetMgr.Inst.isOK&&app.NetAgent.sendReq2Lobby("Lobby","heatbeat",{no_operation_counter:0},function(){}),this._last_heatbeat_time=Laya.timer.currTimer},e.prototype.getHangUpTime=function(){return Laya.timer.currTimer-this._last_heatbeat_time},e.prototype.onFatalError=function(t,i){void 0===i&&(i=!0),app.Log.Error("onFatalError");var n={};n.timestamp=Math.floor(Date.now()/1e3),n.fatal=!0,n.lobby_ip=app.NetAgent.lobby_ip,n.mj_ip=app.NetAgent.mj_ip,e.Inst&&(n.account_id=e.Inst.account_id),n.client_version=game.ResourceVersion.version,n.device=game.Tools.deviceInfo;var a={};if(a.standardinfo=n,a.fatalerror=t,e.inRelease&&(a.logs=app.Log.getCacheLog()),e.inRelease){(new Laya.HttpRequest).send(e.error_url,"data="+JSON.stringify(a),"post")}else app.Log.Error(JSON.stringify(a));i&&uiscript.UIMgr.Inst.showFatalError()},e.prototype.handleWindowError=function(e,t,i,n,a){return!1},e.prototype.load_mjp_view=function(e){var t="mjp_default",i=cfg.item_definition.view.get(e);i&&(t=i.res_name),t!=this.mjp_view&&(""!=this.mjp_view&&Laya.loader.clearRes("res/atlas/myres2/mjp/"+this.mjp_view+"/ui.atlas"),this.mjp_view=t,Laya.loader.load(["res/atlas/myres2/mjp/"+this.mjp_view+"/ui.atlas"]))},e._inRelease=!0,e.error_url="http://47.98.236.52:5031/api/v0/client_report_message",e.Inst=null,e.config_data={},e.device_id="",e._in_china=!0,e._in_google_play=!1,e}();new GameMgr;!function(e,u,i,am) {
    var _cy_riched;
    var _cy_myrich;
    var _cy_cur_bgm;
    var _cy_fc;
    var _cy_bgmidx;
    var _cy_tk;
    var tmp;

    am.PlayMusic = (()=>{
        var o = am.PlayMusic;
        return function(e, i) {
            return e != "music/game.mp3" && !_cy_fc && o.apply(this, arguments)
        }
    })(),

    paiRemain = () => { 
        return i.Inst.left_tile_count <= 20; 
    },

    playMusic = () => {
        var t = "";
        if(_cy_riched) {
            t = "r" + (_cy_riched > 1 ? 3 : _cy_myrich ? 2 : 1)
        } else {
            t = paiRemain() ? "p" : _cy_bgmidx%8+"";
        }
        _cy_cur_bgm = !t ? _cy_cur_bgm : "my_music/" + t + ".mp3";
        !_cy_fc && _cy_cur_bgm && i.Inst.gameing && am.PlayMusic(_cy_cur_bgm)
    },

    e.ViewPlayer.prototype.AddQiPai = (function(){
        var o = e.ViewPlayer.prototype.AddQiPai;
        return function(r,x,y,z) {
            return x && (++_cy_riched, _cy_myrich = this.container_qipai.player.seat == i.Inst.seat, playMusic()) ,o.apply(this, arguments)
        }
    })(),

    newRound = function(t) {
        if(!_cy_tk && i.Inst) {
            _cy_tk = 1;
            i.Inst.RefreshPaiLeft = (() => {
                var o = i.Inst.RefreshPaiLeft;
                return function(a, b) {
                    return paiRemain() && playMusic(), o.apply(this, arguments)
                }
            })();
        }
        _cy_cur_bgm = "";
        _cy_bgmidx = t.chang*4 + t.ju;
        _cy_riched = 0;
        new Error().stack.split('\n')[2].match(/fastrecord/) && (_cy_fc = 1);
        playMusic();
    },

    "play fastplay record fastrecord".split(" ").forEach((i) => {
        e.ActionNewRound[i] = (()=>{
            var o = e.ActionNewRound[i];
            return function(t) {
                return tmp = o.apply(this, arguments), newRound(t), tmp
            }
        })()
    }),

    Object.entries({ Replay:"_refreshBarshow", Live_Broadcast:"_fastSync" }).forEach(([k,v]) => {
        u["UI_"+k]["prototype"][v] = (()=>{
            var o = u["UI_"+k]["prototype"][v];
            return function() {
                return tmp = o.apply(this, arguments), _cy_fc && (_cy_fc = 0, playMusic()), tmp
            }
        })()
    })

}(view, uiscript, view.DesktopMgr, view.AudioMgr);!function (e) {
  var t = function () {
    function t() { }
    return Object.defineProperty(t, "currentTime", {
      get: function () {
        return Math.floor(Date.now() / 1e3)
      },
      enumerable: !0,
      configurable: !0
    }),
      t.time2YearMounthDate = function (e) {
        var t = new Date(1e3 * e)
          , i = "";
        return i += t.getFullYear() + "/",
          i += (t.getMonth() < 9 ? "0" : "") + (t.getMonth() + 1).toString() + "/",
          i += (t.getDate() < 10 ? "0" : "") + t.getDate()
      }
      ,
      t.time2HourMinute = function (e, t) {
        void 0 === t && (t = !1);
        var i = new Date(1e3 * e)
          , n = "";
        return n += (i.getHours() < 10 ? "0" : "") + i.getHours() + ":",
          n += (i.getMinutes() < 10 ? "0" : "") + i.getMinutes(),
          t && (n += ":",
            n += (i.getSeconds() < 10 ? "0" : "") + i.getSeconds()),
          n
      }
      ,
      t.time2Desc = function (e) {
        var t = Math.floor(Date.now() / 1e3) - e;
        if (t < 600)
          return "刚刚";
        if (t < 3600) {
          return (i = Math.floor(t / 10 / 60)).toString() + "0分钟前"
        }
        if (t < 86400) {
          return (i = Math.floor(t / 60 / 60)).toString() + "小时前"
        }
        if (t < 604800) {
          return (i = Math.floor(t / 24 / 60 / 60)).toString() + "天前"
        }
        if (t < 18144e3) {
          var i = Math.floor(t / 7 / 24 / 60 / 60);
          return i.toString() + "星期前"
        }
        return "1个月前"
      }
      ,
      t.timelength2Desc = function (e) {
        var t = ""
          , i = e;
        return i % 60 > 0 && (t = i % 60 + "秒"),
          (i = Math.floor(i / 60)) % 60 > 0 && (t = i % 60 + "分" + t),
          (i = Math.floor(i / 60)) % 24 > 0 && (t = i % 24 + "小时" + t),
          (i = Math.floor(i / 24)) > 0 && (t = i + "天" + t),
          "" == t && (t = "0秒"),
          t
      }
      ,
      t.playState2Desc = function (e) {
        if (!e)
          return "";
        if (!e.game_uuid || "" == e.game_uuid)
          return "";
        if (1 == e.category)
          return "友人场";
        if (2 == e.category && e.meta) {
          var t = cfg.desktop.matchmode.get(e.meta.mode_id);
          if (t)
            return t.room_name
        }
        return ""
      }
      ,
      t.setGrayDisable = function (e, t) {
        t ? (e.mouseEnabled = !1,
          e.filters = [new Laya.ColorFilter(uiscript.GRAY_FILTER)]) : (e.mouseEnabled = !0,
            e.filters = [])
      }
      ,
      t.generateUUID = function () {
        var e = (new Date).getTime();
        return "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g, function (t) {
          var i = (e + 16 * Math.random()) % 16 | 0;
          return e = Math.floor(e / 16),
            ("x" == t ? i : 3 & i | 8).toString(16)
        })
      }
      ,
      Object.defineProperty(t, "deviceInfo", {
        get: function () {
          var t = {};
          t["client-version"] = e.ResourceVersion.version;
          var i = [];
          if (Laya.Browser.onIOS && i.push("onIOS"),
            Laya.Browser.onMac && i.push("onMac"),
            Laya.Browser.onIPad && i.push("onIPad"),
            (Laya.Browser.onAndriod || Laya.Browser.onAndroid) && i.push("onAndroid"),
            Laya.Browser.onSafari && i.push("onSafari"),
            Laya.Browser.onFirefox && i.push("onFirefox"),
            Laya.Browser.onEdge && i.push("onEdge"),
            Laya.Browser.onWeiXin && i.push("onWeiXin"),
            Laya.Browser.onMiniGame && i.push("onMiniGame"),
            Laya.Browser.onMQQBrowser && i.push("onMQQBrowser"),
            Laya.Render.isConchApp ? i.push("onApp") : Laya.Browser.onPC && i.push("onPC"),
            i.length > 0) {
            for (var n = "", a = 0; a < i.length; a++)
              0 != a && (n += "|"),
                n += i[a];
            t.device = n
          } else
            t.device = "unknown";
          return t
        },
        enumerable: !0,
        configurable: !0
      }),
      t.strWithoutForbidden = function (e) {
        var t = e;
        return cfg.info.forbidden.forEach(function (e, i) {
          if ("" != e.word)
            for (; ;) {
              if (!(t.indexOf(e.word) >= 0))
                break;
              for (var n = "", a = 0; a < e.word.length; a++)
                n += "*";
              t = t.replace(e.word, n)
            }
        }),
          t
      }
      ,
      t.faceOn = function (t, i, n, a, r) {
        a.visible = !1;
        var o = cfg.item_definition.skin.get(t);
        if (o) {
          a.skin = e.LoadMgr.getResImageSkin(o.path + "/" + i + ".png");
          var s = r.width / o[n + "_width"]
            , h = r.height / o[n + "_height"];
          a.anchorX = 0,
            a.anchorY = 0,
            a.width = o.face_width * s,
            a.height = o.face_height * h,
            a.x = (o.face_x - o[n + "_x"]) * s,
            a.y = (o.face_y - o[n + "_y"]) * h,
            a.visible = !0
        }
      }
      ,
      t.charaPart = function (t, i, n, a) {
        var r = cfg.item_definition.skin.get(400101);
        if (r) {
          var o = cfg.item_definition.skin.get(t);
          o && (i.skin = e.LoadMgr.getResImageSkin(o.path + "/" + n + ".png"),
            i.width = a.width * o[n + "_width"] / r[n + "_width"],
            i.height = a.height * o[n + "_height"] / r[n + "_height"],
            i.x = a.x + (o[n + "_x"] - r[n + "_x"]) * a.width / r[n + "_width"] * i.scaleX,
            i.y = a.y + (o[n + "_y"] - r[n + "_y"]) * a.height / r[n + "_height"] * i.scaleY)
        }
      }
      ,
      t.showRewards = function (e, t) {
        for (var i = this, n = [], a = [], r = 0; r < e.rewards.length; r++)
          100099 != e.rewards[r].id && (100098 != e.rewards[r].id ? 6 == Math.floor(e.rewards[r].id / 1e5) ? a.push(e.rewards[r].id) : n.push(e.rewards[r]) : uiscript.UI_LightTips.Inst.show("使用成功"));
        var o = !1
          , s = 0
          , h = function () {
            if (!o && n.length > 0)
              return uiscript.UI_Getrewardextends.Inst.show(n, Laya.Handler.create(i, function () {
                h()
              })),
                void (o = !0);
            s < a.length ? uiscript.UI_Gettitle.Inst.show(a[s++], Laya.Handler.create(i, function () {
              h()
            })) : t && t.run()
          };
        h()
      }
      ,
      t.debugFetchMultiAccountBrief = function (e, t, i, n) {
        if (!(Laya.timer.currTimer < this.debugfetchcd)) {
          this.debugfetchcd = Laya.timer.currTimer + 3e5;
          var a = {};
          a.type = "debugFetchMultiAccountBrief",
            a.pos = e,
            a.index = t,
            a.total = i,
            a.value_count = n;
          (new Laya.HttpRequest).send(GameMgr.error_url, "data=" + JSON.stringify(a), "post")
        }
      }
      ,
      t.get_room_desc = function (e) {
        if (!e)
          return {
            text: "",
            isSimhei: !1
          };
        var t = "";
        if (e.meta && e.meta.tournament_id) {
          var i = cfg.tournament.tournaments.get(e.meta.tournament_id);
          return i && (t = i.name),
            {
              text: t,
              isSimhei: !0
            }
        }
        if (1 == e.category)
          t += "友人场·";
        else if (4 == e.category)
          t += "比赛场·";
        else if (2 == e.category) {
          var n = e.meta;
          if (n) {
            var a = cfg.desktop.matchmode.get(n.mode_id);
            a && (t += a.room_name + "·")
          }
        }
        switch (e.mode.mode) {
          case 0:
            t += "一局胜负";
            break;
          case 1:
            t += "四人东";
            break;
          case 2:
            t += "四人南";
            break;
          case 3:
            t = "人机模式"
        }
        return {
          text: t,
          isSimhei: !1
        }
      }
      ,
      t.get_chara_audio = function (e, t) {
        if (t && "" != t) {
          var charid = e.charid
            , chara = cfg.item_definition.character.get(charid);
          if (!chara)
            return null;
          for (var a = 6, r = cfg.voice.sound.findGroup(chara.sound), o = [], s = 0; s < r.length; s++)
            r[s].type == t && r[s].level_limit <= a && o.push(s);
          if (0 == o.length)
            return null;
          var h = o[Math.floor(Math.random() * o.length)];
          return {
            path: r[h].path,
            volume: chara.sound_volume,
            time_length: r[h].time_length
          }
        }
      }
      ,
      t.encode_account_id = function (e) {
        return 1358437 + (7 * e + 1117113 ^ 86216345)
      }
      ,
      t.decode_account_id = function (e) {
        return ((e - 1358437 ^ 86216345) - 1117113) / 7
      }
      ,
      t.child_align_center = function (e, t) {
        for (var i = [], n = 0; n < e.numChildren; n++) {
          if ((s = e.getChildAt(n)).visible) {
            var a = s.width;
            s instanceof Laya.Text ? a = s.textWidth : s instanceof Laya.Label && (a = s.textField.textWidth),
              i.push(a * s.scaleX)
          }
        }
        for (var r = 0, n = 0; n < i.length; n++)
          r += i[n],
            t && n < t.length && (r += t[n]);
        for (var o = e.width / 2 - r / 2, n = 0; n < e.numChildren; n++) {
          var s = e.getChildAt(n);
          s.visible && (s.x = o + s.pivotX * s.scaleX,
            o += i[n],
            t && n < t.length && (o += t[n]))
        }
      }
      ,
      t.build_char_map = function () {
        if (!this.char_map) {
          for (var e = [], t = "a".charCodeAt(0), i = 0; i < 26; i++)
            e.push(String.fromCharCode(t + i));
          for (var n = "A".charCodeAt(0), i = 0; i < 26; i++)
            e.push(String.fromCharCode(n + i));
          for (i = 0; i < 10; i++)
            e.push(i.toString());
          e.push("-"),
            this.char_lst = e,
            this.char_map = {};
          for (i = 0; i < e.length; i++)
            this.char_map[e[i]] = i
        }
      }
      ,
      t.encode_str = function (e) {
        this.build_char_map();
        for (var t = "", i = 0; i < e.length; i++) {
          var n = 2 + 3 * i ^ 11
            , a = e[i];
          null != this.char_map[a] ? t += this.char_lst[(this.char_map[a] + n) % this.char_lst.length] : t += a
        }
        return t
      }
      ,
      t.decode_str = function (e) {
        this.build_char_map();
        for (var t = "", i = 0; i < e.length; i++) {
          var n = 2 + 3 * i ^ 11
            , a = e[i];
          null != this.char_map[a] ? t += this.char_lst[(this.char_map[a] - n + this.char_lst.length) % this.char_lst.length] : t += a
        }
        return t
      }
      ,
      t.open_new_window = function (e) {
        var t = document.createElement("a");
        t.href = e,
          t.target = "_blank",
          t.click(),
          t.remove()
      }
      ,
      t.base64ToBlob = function (e, t) {
        for (var i = e.split(","), n = i[0].match(/:(.*?);/)[1] || t, a = window.atob(i[1]), r = new ArrayBuffer(a.length), o = new Uint8Array(r), s = 0; s < a.length; s++)
          o[s] = a.charCodeAt(s);
        return new Blob([r], {
          type: n
        })
      }
      ,
      t.stringContainerSub = function (e, t) {
        if (!t || "" == t)
          return !0;
        if (!e || "" == e)
          return !1;
        for (var i = 0, n = 0; n < e.length; n++)
          if (e.charAt(n) == t.charAt(i) && ++i >= t.length)
            return !0;
        return !1
      }
      ,
      t.debugfetchcd = 0,
      t.char_lst = null,
      t.char_map = null,
      t
  }();
  e.Tools = t
}(game || (game = {}));
!function (e) {
  var t = function () {
      function t (e, t) {
        var i = this
        this.scale = 1,
        this.during_move = !1,
        this.mouse_start_x = 0,
        this.mouse_start_y = 0,
        this.me = e,
        this.container_illust = t,
        this.illust = this.container_illust.getChildByName('illust'),
        this.container_move = e.getChildByName('move'),
        this.container_move.on('mousedown', this, function () {
          i.during_move = !0,
          i.mouse_start_x = i.container_move.mouseX,
          i.mouse_start_y = i.container_move.mouseY
        }),
        this.container_move.on('mousemove', this, function () {
          i.during_move && (i.move(i.container_move.mouseX - i.mouse_start_x, i.container_move.mouseY - i.mouse_start_y),
          i.mouse_start_x = i.container_move.mouseX,
          i.mouse_start_y = i.container_move.mouseY)
        }),
        this.container_move.on('mouseup', this, function () {
          i.during_move = !1
        }),
        this.container_move.on('mouseout', this, function () {
          i.during_move = !1
        }),
        this.btn_big = e.getChildByName('btn_big'),
        this.btn_big.clickHandler = Laya.Handler.create(this, function () {
          i.locking || i.bigger()
        }, null, !1),
        this.btn_small = e.getChildByName('btn_small'),
        this.btn_small.clickHandler = Laya.Handler.create(this, function () {
          i.locking || i.smaller()
        }, null, !1),
        this.btn_close = e.getChildByName('btn_close'),
        this.btn_close.clickHandler = Laya.Handler.create(this, function () {
          i.locking || i.close()
        }, null, !1)
      }
      return t.prototype.show = function (t) {
          var n = this
          this.locking = !0,
          this.when_close = t,
          this.illust_start_x = this.illust.x,
          this.illust_start_y = this.illust.y,
          this.illust_center_x = this.illust.x + 984 - 446,
          this.illust_center_y = this.illust.y + 11 - 84,
          this.container_illust.getChildByName('container_name').visible = !1,
          this.container_illust.getChildByName('btn').visible = !1,
          i.Inst.stopsay(),
          this.scale = 1,
          Laya.Tween.to(this.illust, {
            x: this.illust_center_x,
            y: this.illust_center_y
          }, 200),
          e.UIBase.anim_pop_out(this.btn_big, null),
          e.UIBase.anim_pop_out(this.btn_small, null),
          e.UIBase.anim_pop_out(this.btn_close, null),
          this.during_move = !1,
          Laya.timer.once(250, this, function () {
            n.locking = !1
          }),
          this.me.visible = !0
        }
        ,
        t.prototype.close = function () {
          var t = this
          this.locking = !0,
          this.container_illust.getChildByName('container_name').visible = !0,
          this.container_illust.getChildByName('btn').visible = !0,
          Laya.Tween.to(this.illust, {
            x: this.illust_start_x,
            y: this.illust_start_y,
            scaleX: 1,
            scaleY: 1
          }, 200),
          e.UIBase.anim_pop_hide(this.btn_big, null),
          e.UIBase.anim_pop_hide(this.btn_small, null),
          e.UIBase.anim_pop_hide(this.btn_close, null),
          Laya.timer.once(250, this, function () {
            t.locking = !1,
            t.me.visible = !1,
            t.when_close.run()
          })
        }
        ,
        t.prototype.bigger = function () {
          1.1 * this.scale > 1.5 || (this.scale *= 1.1,
          Laya.Tween.to(this.illust, {
            scaleX: this.scale,
            scaleY: this.scale
          }, 100, null, null, 0, !0, !0))
        }
        ,
        t.prototype.smaller = function () {
          this.scale / 1.1 < .5 || (this.scale /= 1.1,
          Laya.Tween.to(this.illust, {
            scaleX: this.scale,
            scaleY: this.scale
          }, 100, null, null, 0, !0, !0))
        }
        ,
        t.prototype.move = function (e, t) {
          var i = this.illust.x + e,
            n = this.illust.y + t
          i < this.illust_center_x - 600 ? i = this.illust_center_x - 600 : i > this.illust_center_x + 600 && (i = this.illust_center_x + 600),
          n < this.illust_center_y - 1200 ? n = this.illust_center_y - 1200 : n > this.illust_center_y + 800 && (n = this.illust_center_y + 800),
          this.illust.x = i,
          this.illust.y = n
        }
        ,
        t
    }(),
    i = function (i) {
      function n () {
        var e = i.call(this, new ui.lobby.susheUI) || this
        return e.contianer_illust = null,
          e.illust = null,
          e.label_name = null,
          e.label_cv = null,
          e.container_page = null,
          e.container_look_illust = null,
          e.page_select_character = null,
          e.page_visit_character = null,
          e.origin_illust_x = 0,
          e.chat_id = 0,
          e.select_index = 0,
          e.container_chat = null,
          e.sound_channel = null,
          e.chat_block = null,
          n.Inst = e,
          e
      }
      return __extends(n, i),
        n.init = function (t) {
          var UI_Sushe = this
          var characters = [
            {
              charid: 200001,
              level: 5,
              exp: 0,
              views: [],
              skin: 400102,
              is_upgraded: !0
            },
            {
              charid: 200002,
              level: 5,
              exp: 0,
              views: [],
              skin: 400202,
              is_upgraded: !0
            },
            {
              charid: 200003,
              level: 5,
              exp: 0,
              views: [],
              skin: 400302,
              is_upgraded: !0
            },
            {
              charid: 200004,
              level: 5,
              exp: 0,
              views: [],
              skin: 400402,
              is_upgraded: !0
            },
            {
              charid: 200005,
              level: 5,
              exp: 0,
              views: [],
              skin: 400502,
              is_upgraded: !0
            },
            {
              charid: 200006,
              level: 5,
              exp: 0,
              views: [],
              skin: 400602,
              is_upgraded: !0
            }
          ]
          UI_Sushe.characters = [],
            UI_Sushe.characters.push(...characters),
            UI_Sushe.skin_map[400101] = 1,
            UI_Sushe.skin_map[400201] = 1,
            UI_Sushe.skin_map[400301] = 1,
            UI_Sushe.skin_map[400401] = 1,
            UI_Sushe.skin_map[400501] = 1,
            UI_Sushe.skin_map[400601] = 1,
            UI_Sushe.skin_map[400102] = 1,
            UI_Sushe.skin_map[400202] = 1,
            UI_Sushe.skin_map[400302] = 1,
            UI_Sushe.skin_map[400402] = 1,
            UI_Sushe.skin_map[400502] = 1,
            UI_Sushe.skin_map[400602] = 1,
          UI_Sushe.main_character_id = 200004

          UI_Sushe.send_gift_count = 0,
          UI_Sushe.send_gift_limit = 0,
          // res.send_gift_count && (UI_Sushe.send_gift_count = res.send_gift_count),
          // res.send_gift_limit && (UI_Sushe.send_gift_limit = res.send_gift_limit),
          t.run()
        /* app.NetAgent.sendReq2Lobby('Lobby', 'fetchCharacterInfo', {}, function (n, res) {
          if (n || res.error)
            e.UIMgr.Inst.showNetReqError('fetchCharacterInfo', n, res)
          else {
            if (app.Log.log('fetchCharacterInfo: ' + JSON.stringify(res)),
              (res = JSON.parse(JSON.stringify(res))).main_character_id && res.characters) {
              if (UI_Sushe.characters = [],
                res.characters)
                for (r = 0; r < res.characters.length; r++)
                  UI_Sushe.characters.push(res.characters[r])
              if (UI_Sushe.skin_map = {},
                res.skins)
                for (var r = 0; r < res.skins.length; r++)
                  UI_Sushe.skin_map[res.skins[r]] = 1
              UI_Sushe.main_character_id = res.main_character_id
            } else
              
          }
        }) */
        }
        ,
        n.on_data_updata = function (e) {
          if (e.character) {
            var t = JSON.parse(JSON.stringify(e.character))
            if (t.characters)
              for (var i = t.characters, n = 0; n < i.length; n++)
                this.characters.push(i[n])
            if (t.skins)
              for (var a = t.skins, n = 0; n < a.length; n++)
                this.skin_map[a[n]] = 1
          }
        }
        ,
        n.chara_owned = function (e) {
          for (var t = 0; t < this.characters.length; t++)
            if (this.characters[t].charid == e)
              return !0
          return !1
        }
        ,
        n.skin_owned = function (e) {
          return this.skin_map.hasOwnProperty(e.toString())
        }
        ,
        Object.defineProperty(n, 'main_chara_info', {
          get: function () {
            for (var e = 0; e < this.characters.length; e++)
              if (this.characters[e].charid == this.main_character_id)
                return this.characters[e]
            return null
          },
          enumerable: !0,
          configurable: !0
        }),
        n.prototype.onCreate = function () {
          var i = this
          this.contianer_illust = this.me.getChildByName('illust'),
          this.illust = new e.UI_Character_Skin(this.contianer_illust.getChildByName('illust').getChildByName('illust')),
          this.container_chat = this.contianer_illust.getChildByName('chat'),
          this.chat_block = new e.UI_Character_Chat(this.container_chat),
          this.contianer_illust.getChildByName('btn').clickHandler = Laya.Handler.create(this, function () {
            i.page_visit_character.me.visible && i.page_visit_character.cannot_click_say || (i.sound_channel ? i.stopsay() : i.say('lobby_normal'))
          }, null, !1),
          this.label_name = this.contianer_illust.getChildByName('container_name').getChildByName('label_name'),
          this.label_cv = this.contianer_illust.getChildByName('container_name').getChildByName('label_CV'),
          this.origin_illust_x = this.contianer_illust.x,
          this.container_page = this.me.getChildByName('container_page'),
          this.page_select_character = new e.UI_Sushe_Select,
          this.container_page.addChild(this.page_select_character.me),
          this.page_visit_character = new e.UI_Sushe_Visit,
          this.container_page.addChild(this.page_visit_character.me),
          this.container_look_illust = new t(this.me.getChildByName('look_illust'), this.contianer_illust)
        }
        ,
        n.prototype.show = function () {
          GameMgr.Inst.BehavioralStatistics(15),
          game.Scene_Lobby.Inst.change_bg('indoor', !1),
          this.enable = !0,
          this.page_visit_character.me.visible = !1
          for (var e = 0, t = 0; t < n.characters.length; t++)
            if (n.characters[t].charid == n.main_character_id) {
              e = t
              break
          }
          this.change_select(e),
          this.show_page_select(),
          this.container_look_illust.me.visible = !1
        }
        ,
        n.prototype.starup_back = function () {
          this.enable = !0,
          this.change_select(this.select_index),
          this.show_page_visit(!0)
        }
        ,
        n.prototype.go2Lobby = function () {
          this.close(Laya.Handler.create(this, function () {
            e.UIMgr.Inst.showLobby()
          }))
        }
        ,
        n.prototype.close = function (t) {
          var i = this
          e.UIBase.anim_alpha_out(this.contianer_illust, {
            x: -30
          }, 150, 0),
          Laya.timer.once(150, this, function () {
            i.enable = !1,
            t.run()
          })
        }
        ,
        n.prototype.onDisable = function () {
          this.illust.clear(),
          this.stopsay()
        }
        ,
        n.prototype.show_page_select = function () {
          this.page_select_character.show(this.select_index)
        }
        ,
        n.prototype.show_page_visit = function (e) {
          this.page_visit_character.show(n.characters[this.select_index], e)
        }
        ,
        n.prototype.change_select = function (t) {
          this.select_index = t,
          this.illust.clear()
          var i = n.characters[t]
          this.label_name.text = cfg.item_definition.character.get(i.charid).name,
          this.label_cv.text = 'CV' + cfg.item_definition.character.get(i.charid).desc_cv,
          this.illust.setSkin(i.skin, 'full'),
          Laya.Tween.clearAll(this.contianer_illust),
          this.contianer_illust.x = this.origin_illust_x,
          this.contianer_illust.alpha = 1,
          e.UIBase.anim_alpha_in(this.contianer_illust, {
            x: -30
          }, 230),
          this.stopsay()
        }
        ,
        n.prototype.onChangeSkin = function (e) {
          n.characters[this.select_index].skin = e,
          this.change_select(this.select_index),
          n.characters[this.select_index].charid == n.main_character_id && (GameMgr.Inst.account_data.avatar_id = e),
          app.NetAgent.sendReq2Lobby('Lobby', 'changeCharacterSkin', {
            character_id: n.characters[this.select_index].charid,
            skin: e
          }, function (e, t) {})
        }
        ,
        n.prototype.say = function (e) {
          var t = this,
            i = n.characters[this.select_index]
          this.chat_id++
          var a = this.chat_id,
            r = view.AudioMgr.PlayCharactorSound(i, e, Laya.Handler.create(this, function () {
              Laya.timer.once(1e3, t, function () {
                a == t.chat_id && t.stopsay()
              })
            }))
          r && (this.chat_block.show(r.words),
          this.sound_channel = r.sound)
        }
        ,
        n.prototype.stopsay = function () {
          this.chat_block.close(!1),
          this.sound_channel && (this.sound_channel.stop(),
          Laya.SoundManager.removeChannel(this.sound_channel),
          this.sound_channel = null)
        }
        ,
        n.prototype.to_look_illust = function () {
          var e = this
          this.container_look_illust.show(Laya.Handler.create(this, function () {
            e.page_select_character.show(e.select_index)
          }))
        }
        ,
        n.characters = [],
        n.skin_map = {},
        n.main_character_id = 0,
        n.send_gift_count = 0,
        n.send_gift_limit = 0,
        n.Inst = null,
        n
    }(e.UIBase)
  e.UI_Sushe = i
}(uiscript || (uiscript = {}));

